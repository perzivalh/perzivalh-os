(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var Dd={exports:{}},$i={},Md={exports:{}},ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var va=Symbol.for("react.element"),Hp=Symbol.for("react.portal"),qp=Symbol.for("react.fragment"),Qp=Symbol.for("react.strict_mode"),Gp=Symbol.for("react.profiler"),Yp=Symbol.for("react.provider"),Kp=Symbol.for("react.context"),Xp=Symbol.for("react.forward_ref"),Jp=Symbol.for("react.suspense"),Zp=Symbol.for("react.memo"),em=Symbol.for("react.lazy"),iu=Symbol.iterator;function tm(e){return e===null||typeof e!="object"?null:(e=iu&&e[iu]||e["@@iterator"],typeof e=="function"?e:null)}var Id={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bd=Object.assign,zd={};function vr(e,t,n){this.props=e,this.context=t,this.refs=zd,this.updater=n||Id}vr.prototype.isReactComponent={};vr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};vr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function $d(){}$d.prototype=vr.prototype;function tc(e,t,n){this.props=e,this.context=t,this.refs=zd,this.updater=n||Id}var nc=tc.prototype=new $d;nc.constructor=tc;Bd(nc,vr.prototype);nc.isPureReactComponent=!0;var lu=Array.isArray,Ud=Object.prototype.hasOwnProperty,sc={current:null},Vd={key:!0,ref:!0,__self:!0,__source:!0};function Fd(e,t,n){var r,a={},i=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)Ud.call(t,r)&&!Vd.hasOwnProperty(r)&&(a[r]=t[r]);var o=arguments.length-2;if(o===1)a.children=n;else if(1<o){for(var c=Array(o),f=0;f<o;f++)c[f]=arguments[f+2];a.children=c}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)a[r]===void 0&&(a[r]=o[r]);return{$$typeof:va,type:e,key:i,ref:l,props:a,_owner:sc.current}}function nm(e,t){return{$$typeof:va,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function rc(e){return typeof e=="object"&&e!==null&&e.$$typeof===va}function sm(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ou=/\/+/g;function yl(e,t){return typeof e=="object"&&e!==null&&e.key!=null?sm(""+e.key):t.toString(36)}function Za(e,t,n,r,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case va:case Hp:l=!0}}if(l)return l=e,a=a(l),e=r===""?"."+yl(l,0):r,lu(a)?(n="",e!=null&&(n=e.replace(ou,"$&/")+"/"),Za(a,t,n,"",function(f){return f})):a!=null&&(rc(a)&&(a=nm(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(ou,"$&/")+"/")+e)),t.push(a)),1;if(l=0,r=r===""?".":r+":",lu(e))for(var o=0;o<e.length;o++){i=e[o];var c=r+yl(i,o);l+=Za(i,t,n,c,a)}else if(c=tm(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=r+yl(i,o++),l+=Za(i,t,n,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Oa(e,t,n){if(e==null)return e;var r=[],a=0;return Za(e,r,"","",function(i){return t.call(n,i,a++)}),r}function rm(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var vt={current:null},ei={transition:null},am={ReactCurrentDispatcher:vt,ReactCurrentBatchConfig:ei,ReactCurrentOwner:sc};function Wd(){throw Error("act(...) is not supported in production builds of React.")}ue.Children={map:Oa,forEach:function(e,t,n){Oa(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Oa(e,function(){t++}),t},toArray:function(e){return Oa(e,function(t){return t})||[]},only:function(e){if(!rc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ue.Component=vr;ue.Fragment=qp;ue.Profiler=Gp;ue.PureComponent=tc;ue.StrictMode=Qp;ue.Suspense=Jp;ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=am;ue.act=Wd;ue.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Bd({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=sc.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Ud.call(t,c)&&!Vd.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){o=Array(c);for(var f=0;f<c;f++)o[f]=arguments[f+2];r.children=o}return{$$typeof:va,type:e.type,key:a,ref:i,props:r,_owner:l}};ue.createContext=function(e){return e={$$typeof:Kp,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Yp,_context:e},e.Consumer=e};ue.createElement=Fd;ue.createFactory=function(e){var t=Fd.bind(null,e);return t.type=e,t};ue.createRef=function(){return{current:null}};ue.forwardRef=function(e){return{$$typeof:Xp,render:e}};ue.isValidElement=rc;ue.lazy=function(e){return{$$typeof:em,_payload:{_status:-1,_result:e},_init:rm}};ue.memo=function(e,t){return{$$typeof:Zp,type:e,compare:t===void 0?null:t}};ue.startTransition=function(e){var t=ei.transition;ei.transition={};try{e()}finally{ei.transition=t}};ue.unstable_act=Wd;ue.useCallback=function(e,t){return vt.current.useCallback(e,t)};ue.useContext=function(e){return vt.current.useContext(e)};ue.useDebugValue=function(){};ue.useDeferredValue=function(e){return vt.current.useDeferredValue(e)};ue.useEffect=function(e,t){return vt.current.useEffect(e,t)};ue.useId=function(){return vt.current.useId()};ue.useImperativeHandle=function(e,t,n){return vt.current.useImperativeHandle(e,t,n)};ue.useInsertionEffect=function(e,t){return vt.current.useInsertionEffect(e,t)};ue.useLayoutEffect=function(e,t){return vt.current.useLayoutEffect(e,t)};ue.useMemo=function(e,t){return vt.current.useMemo(e,t)};ue.useReducer=function(e,t,n){return vt.current.useReducer(e,t,n)};ue.useRef=function(e){return vt.current.useRef(e)};ue.useState=function(e){return vt.current.useState(e)};ue.useSyncExternalStore=function(e,t,n){return vt.current.useSyncExternalStore(e,t,n)};ue.useTransition=function(){return vt.current.useTransition()};ue.version="18.3.1";Md.exports=ue;var m=Md.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var im=m,lm=Symbol.for("react.element"),om=Symbol.for("react.fragment"),cm=Object.prototype.hasOwnProperty,um=im.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dm={key:!0,ref:!0,__self:!0,__source:!0};function Hd(e,t,n){var r,a={},i=null,l=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)cm.call(t,r)&&!dm.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:lm,type:e,key:i,ref:l,props:a,_owner:um.current}}$i.Fragment=om;$i.jsx=Hd;$i.jsxs=Hd;Dd.exports=$i;var s=Dd.exports,qd={exports:{}},It={},Qd={exports:{}},Gd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(B,H){var b=B.length;B.push(H);e:for(;0<b;){var W=b-1>>>1,Y=B[W];if(0<a(Y,H))B[W]=H,B[b]=Y,b=W;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var H=B[0],b=B.pop();if(b!==H){B[0]=b;e:for(var W=0,Y=B.length,Z=Y>>>1;W<Z;){var C=2*(W+1)-1,ee=B[C],V=C+1,U=B[V];if(0>a(ee,b))V<Y&&0>a(U,ee)?(B[W]=U,B[V]=b,W=V):(B[W]=ee,B[C]=b,W=C);else if(V<Y&&0>a(U,b))B[W]=U,B[V]=b,W=V;else break e}}return H}function a(B,H){var b=B.sortIndex-H.sortIndex;return b!==0?b:B.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],f=[],x=1,g=null,j=3,T=!1,y=!1,A=!1,w=typeof setTimeout=="function"?setTimeout:null,d=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(B){for(var H=n(f);H!==null;){if(H.callback===null)r(f);else if(H.startTime<=B)r(f),H.sortIndex=H.expirationTime,t(c,H);else break;H=n(f)}}function S(B){if(A=!1,v(B),!y)if(n(c)!==null)y=!0,pe(P);else{var H=n(f);H!==null&&Oe(S,H.startTime-B)}}function P(B,H){y=!1,A&&(A=!1,d(E),E=-1),T=!0;var b=j;try{for(v(H),g=n(c);g!==null&&(!(g.expirationTime>H)||B&&!te());){var W=g.callback;if(typeof W=="function"){g.callback=null,j=g.priorityLevel;var Y=W(g.expirationTime<=H);H=e.unstable_now(),typeof Y=="function"?g.callback=Y:g===n(c)&&r(c),v(H)}else r(c);g=n(c)}if(g!==null)var Z=!0;else{var C=n(f);C!==null&&Oe(S,C.startTime-H),Z=!1}return Z}finally{g=null,j=b,T=!1}}var N=!1,D=null,E=-1,$=5,F=-1;function te(){return!(e.unstable_now()-F<$)}function he(){if(D!==null){var B=e.unstable_now();F=B;var H=!0;try{H=D(!0,B)}finally{H?xe():(N=!1,D=null)}}else N=!1}var xe;if(typeof p=="function")xe=function(){p(he)};else if(typeof MessageChannel<"u"){var Be=new MessageChannel,we=Be.port2;Be.port1.onmessage=he,xe=function(){we.postMessage(null)}}else xe=function(){w(he,0)};function pe(B){D=B,N||(N=!0,xe())}function Oe(B,H){E=w(function(){B(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(B){B.callback=null},e.unstable_continueExecution=function(){y||T||(y=!0,pe(P))},e.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<B?Math.floor(1e3/B):5},e.unstable_getCurrentPriorityLevel=function(){return j},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(B){switch(j){case 1:case 2:case 3:var H=3;break;default:H=j}var b=j;j=H;try{return B()}finally{j=b}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(B,H){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var b=j;j=B;try{return H()}finally{j=b}},e.unstable_scheduleCallback=function(B,H,b){var W=e.unstable_now();switch(typeof b=="object"&&b!==null?(b=b.delay,b=typeof b=="number"&&0<b?W+b:W):b=W,B){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=b+Y,B={id:x++,callback:H,priorityLevel:B,startTime:b,expirationTime:Y,sortIndex:-1},b>W?(B.sortIndex=b,t(f,B),n(c)===null&&B===n(f)&&(A?(d(E),E=-1):A=!0,Oe(S,b-W))):(B.sortIndex=Y,t(c,B),y||T||(y=!0,pe(P))),B},e.unstable_shouldYield=te,e.unstable_wrapCallback=function(B){var H=j;return function(){var b=j;j=H;try{return B.apply(this,arguments)}finally{j=b}}}})(Gd);Qd.exports=Gd;var hm=Qd.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fm=m,Mt=hm;function M(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Yd=new Set,ea={};function Rs(e,t){ur(e,t),ur(e+"Capture",t)}function ur(e,t){for(ea[e]=t,e=0;e<t.length;e++)Yd.add(t[e])}var Pn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zl=Object.prototype.hasOwnProperty,pm=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cu={},uu={};function mm(e){return Zl.call(uu,e)?!0:Zl.call(cu,e)?!1:pm.test(e)?uu[e]=!0:(cu[e]=!0,!1)}function gm(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function vm(e,t,n,r){if(t===null||typeof t>"u"||gm(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function xt(e,t,n,r,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){rt[e]=new xt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];rt[t]=new xt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){rt[e]=new xt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){rt[e]=new xt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){rt[e]=new xt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){rt[e]=new xt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){rt[e]=new xt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){rt[e]=new xt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){rt[e]=new xt(e,5,!1,e.toLowerCase(),null,!1,!1)});var ac=/[\-:]([a-z])/g;function ic(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ac,ic);rt[t]=new xt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ac,ic);rt[t]=new xt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ac,ic);rt[t]=new xt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){rt[e]=new xt(e,1,!1,e.toLowerCase(),null,!1,!1)});rt.xlinkHref=new xt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){rt[e]=new xt(e,1,!1,e.toLowerCase(),null,!0,!0)});function lc(e,t,n,r){var a=rt.hasOwnProperty(t)?rt[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(vm(t,n,a,r)&&(n=null),r||a===null?mm(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Bn=fm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ra=Symbol.for("react.element"),qs=Symbol.for("react.portal"),Qs=Symbol.for("react.fragment"),oc=Symbol.for("react.strict_mode"),eo=Symbol.for("react.profiler"),Kd=Symbol.for("react.provider"),Xd=Symbol.for("react.context"),cc=Symbol.for("react.forward_ref"),to=Symbol.for("react.suspense"),no=Symbol.for("react.suspense_list"),uc=Symbol.for("react.memo"),Qn=Symbol.for("react.lazy"),Jd=Symbol.for("react.offscreen"),du=Symbol.iterator;function Lr(e){return e===null||typeof e!="object"?null:(e=du&&e[du]||e["@@iterator"],typeof e=="function"?e:null)}var Me=Object.assign,jl;function $r(e){if(jl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);jl=t&&t[1]||""}return`
`+jl+e}var Nl=!1;function wl(e,t){if(!e||Nl)return"";Nl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var r=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){r=f}e.call(t.prototype)}else{try{throw Error()}catch(f){r=f}e()}}catch(f){if(f&&r&&typeof f.stack=="string"){for(var a=f.stack.split(`
`),i=r.stack.split(`
`),l=a.length-1,o=i.length-1;1<=l&&0<=o&&a[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(a[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||a[l]!==i[o]){var c=`
`+a[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{Nl=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?$r(e):""}function xm(e){switch(e.tag){case 5:return $r(e.type);case 16:return $r("Lazy");case 13:return $r("Suspense");case 19:return $r("SuspenseList");case 0:case 2:case 15:return e=wl(e.type,!1),e;case 11:return e=wl(e.type.render,!1),e;case 1:return e=wl(e.type,!0),e;default:return""}}function so(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Qs:return"Fragment";case qs:return"Portal";case eo:return"Profiler";case oc:return"StrictMode";case to:return"Suspense";case no:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Xd:return(e.displayName||"Context")+".Consumer";case Kd:return(e._context.displayName||"Context")+".Provider";case cc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case uc:return t=e.displayName||null,t!==null?t:so(e.type)||"Memo";case Qn:t=e._payload,e=e._init;try{return so(e(t))}catch{}}return null}function ym(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return so(t);case 8:return t===oc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function cs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Zd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function jm(e){var t=Zd(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){r=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Pa(e){e._valueTracker||(e._valueTracker=jm(e))}function eh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Zd(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function mi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ro(e,t){var n=t.checked;return Me({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function hu(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=cs(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function th(e,t){t=t.checked,t!=null&&lc(e,"checked",t,!1)}function ao(e,t){th(e,t);var n=cs(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?io(e,t.type,n):t.hasOwnProperty("defaultValue")&&io(e,t.type,cs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function fu(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function io(e,t,n){(t!=="number"||mi(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ur=Array.isArray;function rr(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+cs(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function lo(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(M(91));return Me({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function pu(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(M(92));if(Ur(n)){if(1<n.length)throw Error(M(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:cs(n)}}function nh(e,t){var n=cs(t.value),r=cs(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function mu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function sh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oo(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?sh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Da,rh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Da=Da||document.createElement("div"),Da.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Da.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ta(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Hr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nm=["Webkit","ms","Moz","O"];Object.keys(Hr).forEach(function(e){Nm.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Hr[t]=Hr[e]})});function ah(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Hr.hasOwnProperty(e)&&Hr[e]?(""+t).trim():t+"px"}function ih(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=ah(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var wm=Me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function co(e,t){if(t){if(wm[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(M(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(M(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(M(61))}if(t.style!=null&&typeof t.style!="object")throw Error(M(62))}}function uo(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ho=null;function dc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var fo=null,ar=null,ir=null;function gu(e){if(e=ja(e)){if(typeof fo!="function")throw Error(M(280));var t=e.stateNode;t&&(t=Hi(t),fo(e.stateNode,e.type,t))}}function lh(e){ar?ir?ir.push(e):ir=[e]:ar=e}function oh(){if(ar){var e=ar,t=ir;if(ir=ar=null,gu(e),t)for(e=0;e<t.length;e++)gu(t[e])}}function ch(e,t){return e(t)}function uh(){}var _l=!1;function dh(e,t,n){if(_l)return e(t,n);_l=!0;try{return ch(e,t,n)}finally{_l=!1,(ar!==null||ir!==null)&&(uh(),oh())}}function na(e,t){var n=e.stateNode;if(n===null)return null;var r=Hi(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(M(231,t,typeof n));return n}var po=!1;if(Pn)try{var Or={};Object.defineProperty(Or,"passive",{get:function(){po=!0}}),window.addEventListener("test",Or,Or),window.removeEventListener("test",Or,Or)}catch{po=!1}function _m(e,t,n,r,a,i,l,o,c){var f=Array.prototype.slice.call(arguments,3);try{t.apply(n,f)}catch(x){this.onError(x)}}var qr=!1,gi=null,vi=!1,mo=null,Sm={onError:function(e){qr=!0,gi=e}};function km(e,t,n,r,a,i,l,o,c){qr=!1,gi=null,_m.apply(Sm,arguments)}function bm(e,t,n,r,a,i,l,o,c){if(km.apply(this,arguments),qr){if(qr){var f=gi;qr=!1,gi=null}else throw Error(M(198));vi||(vi=!0,mo=f)}}function Ps(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function hh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function vu(e){if(Ps(e)!==e)throw Error(M(188))}function Cm(e){var t=e.alternate;if(!t){if(t=Ps(e),t===null)throw Error(M(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return vu(a),e;if(i===r)return vu(a),t;i=i.sibling}throw Error(M(188))}if(n.return!==r.return)n=a,r=i;else{for(var l=!1,o=a.child;o;){if(o===n){l=!0,n=a,r=i;break}if(o===r){l=!0,r=a,n=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===n){l=!0,n=i,r=a;break}if(o===r){l=!0,r=i,n=a;break}o=o.sibling}if(!l)throw Error(M(189))}}if(n.alternate!==r)throw Error(M(190))}if(n.tag!==3)throw Error(M(188));return n.stateNode.current===n?e:t}function fh(e){return e=Cm(e),e!==null?ph(e):null}function ph(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ph(e);if(t!==null)return t;e=e.sibling}return null}var mh=Mt.unstable_scheduleCallback,xu=Mt.unstable_cancelCallback,Em=Mt.unstable_shouldYield,Tm=Mt.unstable_requestPaint,$e=Mt.unstable_now,Am=Mt.unstable_getCurrentPriorityLevel,hc=Mt.unstable_ImmediatePriority,gh=Mt.unstable_UserBlockingPriority,xi=Mt.unstable_NormalPriority,Lm=Mt.unstable_LowPriority,vh=Mt.unstable_IdlePriority,Ui=null,vn=null;function Om(e){if(vn&&typeof vn.onCommitFiberRoot=="function")try{vn.onCommitFiberRoot(Ui,e,void 0,(e.current.flags&128)===128)}catch{}}var an=Math.clz32?Math.clz32:Dm,Rm=Math.log,Pm=Math.LN2;function Dm(e){return e>>>=0,e===0?32:31-(Rm(e)/Pm|0)|0}var Ma=64,Ia=4194304;function Vr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function yi(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,l=n&268435455;if(l!==0){var o=l&~a;o!==0?r=Vr(o):(i&=l,i!==0&&(r=Vr(i)))}else l=n&~a,l!==0?r=Vr(l):i!==0&&(r=Vr(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-an(t),a=1<<n,r|=e[n],t&=~a;return r}function Mm(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Im(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-an(i),o=1<<l,c=a[l];c===-1?(!(o&n)||o&r)&&(a[l]=Mm(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function go(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function xh(){var e=Ma;return Ma<<=1,!(Ma&4194240)&&(Ma=64),e}function Sl(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xa(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-an(t),e[t]=n}function Bm(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-an(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}function fc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-an(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var be=0;function yh(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var jh,pc,Nh,wh,_h,vo=!1,Ba=[],es=null,ts=null,ns=null,sa=new Map,ra=new Map,Kn=[],zm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yu(e,t){switch(e){case"focusin":case"focusout":es=null;break;case"dragenter":case"dragleave":ts=null;break;case"mouseover":case"mouseout":ns=null;break;case"pointerover":case"pointerout":sa.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ra.delete(t.pointerId)}}function Rr(e,t,n,r,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},t!==null&&(t=ja(t),t!==null&&pc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function $m(e,t,n,r,a){switch(t){case"focusin":return es=Rr(es,e,t,n,r,a),!0;case"dragenter":return ts=Rr(ts,e,t,n,r,a),!0;case"mouseover":return ns=Rr(ns,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return sa.set(i,Rr(sa.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,ra.set(i,Rr(ra.get(i)||null,e,t,n,r,a)),!0}return!1}function Sh(e){var t=_s(e.target);if(t!==null){var n=Ps(t);if(n!==null){if(t=n.tag,t===13){if(t=hh(n),t!==null){e.blockedOn=t,_h(e.priority,function(){Nh(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ti(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=xo(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);ho=r,n.target.dispatchEvent(r),ho=null}else return t=ja(n),t!==null&&pc(t),e.blockedOn=n,!1;t.shift()}return!0}function ju(e,t,n){ti(e)&&n.delete(t)}function Um(){vo=!1,es!==null&&ti(es)&&(es=null),ts!==null&&ti(ts)&&(ts=null),ns!==null&&ti(ns)&&(ns=null),sa.forEach(ju),ra.forEach(ju)}function Pr(e,t){e.blockedOn===t&&(e.blockedOn=null,vo||(vo=!0,Mt.unstable_scheduleCallback(Mt.unstable_NormalPriority,Um)))}function aa(e){function t(a){return Pr(a,e)}if(0<Ba.length){Pr(Ba[0],e);for(var n=1;n<Ba.length;n++){var r=Ba[n];r.blockedOn===e&&(r.blockedOn=null)}}for(es!==null&&Pr(es,e),ts!==null&&Pr(ts,e),ns!==null&&Pr(ns,e),sa.forEach(t),ra.forEach(t),n=0;n<Kn.length;n++)r=Kn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Kn.length&&(n=Kn[0],n.blockedOn===null);)Sh(n),n.blockedOn===null&&Kn.shift()}var lr=Bn.ReactCurrentBatchConfig,ji=!0;function Vm(e,t,n,r){var a=be,i=lr.transition;lr.transition=null;try{be=1,mc(e,t,n,r)}finally{be=a,lr.transition=i}}function Fm(e,t,n,r){var a=be,i=lr.transition;lr.transition=null;try{be=4,mc(e,t,n,r)}finally{be=a,lr.transition=i}}function mc(e,t,n,r){if(ji){var a=xo(e,t,n,r);if(a===null)Pl(e,t,r,Ni,n),yu(e,r);else if($m(a,e,t,n,r))r.stopPropagation();else if(yu(e,r),t&4&&-1<zm.indexOf(e)){for(;a!==null;){var i=ja(a);if(i!==null&&jh(i),i=xo(e,t,n,r),i===null&&Pl(e,t,r,Ni,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else Pl(e,t,r,null,n)}}var Ni=null;function xo(e,t,n,r){if(Ni=null,e=dc(r),e=_s(e),e!==null)if(t=Ps(e),t===null)e=null;else if(n=t.tag,n===13){if(e=hh(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ni=e,null}function kh(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Am()){case hc:return 1;case gh:return 4;case xi:case Lm:return 16;case vh:return 536870912;default:return 16}default:return 16}}var Jn=null,gc=null,ni=null;function bh(){if(ni)return ni;var e,t=gc,n=t.length,r,a="value"in Jn?Jn.value:Jn.textContent,i=a.length;for(e=0;e<n&&t[e]===a[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===a[i-r];r++);return ni=a.slice(e,1<r?1-r:void 0)}function si(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function za(){return!0}function Nu(){return!1}function Bt(e){function t(n,r,a,i,l){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?za:Nu,this.isPropagationStopped=Nu,this}return Me(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=za)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=za)},persist:function(){},isPersistent:za}),t}var xr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vc=Bt(xr),ya=Me({},xr,{view:0,detail:0}),Wm=Bt(ya),kl,bl,Dr,Vi=Me({},ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Dr&&(Dr&&e.type==="mousemove"?(kl=e.screenX-Dr.screenX,bl=e.screenY-Dr.screenY):bl=kl=0,Dr=e),kl)},movementY:function(e){return"movementY"in e?e.movementY:bl}}),wu=Bt(Vi),Hm=Me({},Vi,{dataTransfer:0}),qm=Bt(Hm),Qm=Me({},ya,{relatedTarget:0}),Cl=Bt(Qm),Gm=Me({},xr,{animationName:0,elapsedTime:0,pseudoElement:0}),Ym=Bt(Gm),Km=Me({},xr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Xm=Bt(Km),Jm=Me({},xr,{data:0}),_u=Bt(Jm),Zm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ng(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=tg[e])?!!t[e]:!1}function xc(){return ng}var sg=Me({},ya,{key:function(e){if(e.key){var t=Zm[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=si(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?eg[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xc,charCode:function(e){return e.type==="keypress"?si(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?si(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),rg=Bt(sg),ag=Me({},Vi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Su=Bt(ag),ig=Me({},ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xc}),lg=Bt(ig),og=Me({},xr,{propertyName:0,elapsedTime:0,pseudoElement:0}),cg=Bt(og),ug=Me({},Vi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),dg=Bt(ug),hg=[9,13,27,32],yc=Pn&&"CompositionEvent"in window,Qr=null;Pn&&"documentMode"in document&&(Qr=document.documentMode);var fg=Pn&&"TextEvent"in window&&!Qr,Ch=Pn&&(!yc||Qr&&8<Qr&&11>=Qr),ku=" ",bu=!1;function Eh(e,t){switch(e){case"keyup":return hg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Th(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Gs=!1;function pg(e,t){switch(e){case"compositionend":return Th(t);case"keypress":return t.which!==32?null:(bu=!0,ku);case"textInput":return e=t.data,e===ku&&bu?null:e;default:return null}}function mg(e,t){if(Gs)return e==="compositionend"||!yc&&Eh(e,t)?(e=bh(),ni=gc=Jn=null,Gs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ch&&t.locale!=="ko"?null:t.data;default:return null}}var gg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!gg[e.type]:t==="textarea"}function Ah(e,t,n,r){lh(r),t=wi(t,"onChange"),0<t.length&&(n=new vc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gr=null,ia=null;function vg(e){Uh(e,0)}function Fi(e){var t=Xs(e);if(eh(t))return e}function xg(e,t){if(e==="change")return t}var Lh=!1;if(Pn){var El;if(Pn){var Tl="oninput"in document;if(!Tl){var Eu=document.createElement("div");Eu.setAttribute("oninput","return;"),Tl=typeof Eu.oninput=="function"}El=Tl}else El=!1;Lh=El&&(!document.documentMode||9<document.documentMode)}function Tu(){Gr&&(Gr.detachEvent("onpropertychange",Oh),ia=Gr=null)}function Oh(e){if(e.propertyName==="value"&&Fi(ia)){var t=[];Ah(t,ia,e,dc(e)),dh(vg,t)}}function yg(e,t,n){e==="focusin"?(Tu(),Gr=t,ia=n,Gr.attachEvent("onpropertychange",Oh)):e==="focusout"&&Tu()}function jg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Fi(ia)}function Ng(e,t){if(e==="click")return Fi(t)}function wg(e,t){if(e==="input"||e==="change")return Fi(t)}function _g(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var on=typeof Object.is=="function"?Object.is:_g;function la(e,t){if(on(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!Zl.call(t,a)||!on(e[a],t[a]))return!1}return!0}function Au(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Lu(e,t){var n=Au(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Au(n)}}function Rh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Rh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ph(){for(var e=window,t=mi();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=mi(e.document)}return t}function jc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Sg(e){var t=Ph(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Rh(n.ownerDocument.documentElement,n)){if(r!==null&&jc(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=Lu(n,i);var l=Lu(n,r);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var kg=Pn&&"documentMode"in document&&11>=document.documentMode,Ys=null,yo=null,Yr=null,jo=!1;function Ou(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;jo||Ys==null||Ys!==mi(r)||(r=Ys,"selectionStart"in r&&jc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Yr&&la(Yr,r)||(Yr=r,r=wi(yo,"onSelect"),0<r.length&&(t=new vc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ys)))}function $a(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ks={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionend:$a("Transition","TransitionEnd")},Al={},Dh={};Pn&&(Dh=document.createElement("div").style,"AnimationEvent"in window||(delete Ks.animationend.animation,delete Ks.animationiteration.animation,delete Ks.animationstart.animation),"TransitionEvent"in window||delete Ks.transitionend.transition);function Wi(e){if(Al[e])return Al[e];if(!Ks[e])return e;var t=Ks[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Dh)return Al[e]=t[n];return e}var Mh=Wi("animationend"),Ih=Wi("animationiteration"),Bh=Wi("animationstart"),zh=Wi("transitionend"),$h=new Map,Ru="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ds(e,t){$h.set(e,t),Rs(t,[e])}for(var Ll=0;Ll<Ru.length;Ll++){var Ol=Ru[Ll],bg=Ol.toLowerCase(),Cg=Ol[0].toUpperCase()+Ol.slice(1);ds(bg,"on"+Cg)}ds(Mh,"onAnimationEnd");ds(Ih,"onAnimationIteration");ds(Bh,"onAnimationStart");ds("dblclick","onDoubleClick");ds("focusin","onFocus");ds("focusout","onBlur");ds(zh,"onTransitionEnd");ur("onMouseEnter",["mouseout","mouseover"]);ur("onMouseLeave",["mouseout","mouseover"]);ur("onPointerEnter",["pointerout","pointerover"]);ur("onPointerLeave",["pointerout","pointerover"]);Rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Eg=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fr));function Pu(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,bm(r,t,void 0,e),e.currentTarget=null}function Uh(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var l=r.length-1;0<=l;l--){var o=r[l],c=o.instance,f=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;Pu(a,o,f),i=c}else for(l=0;l<r.length;l++){if(o=r[l],c=o.instance,f=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;Pu(a,o,f),i=c}}}if(vi)throw e=mo,vi=!1,mo=null,e}function Ae(e,t){var n=t[ko];n===void 0&&(n=t[ko]=new Set);var r=e+"__bubble";n.has(r)||(Vh(t,e,2,!1),n.add(r))}function Rl(e,t,n){var r=0;t&&(r|=4),Vh(n,e,r,t)}var Ua="_reactListening"+Math.random().toString(36).slice(2);function oa(e){if(!e[Ua]){e[Ua]=!0,Yd.forEach(function(n){n!=="selectionchange"&&(Eg.has(n)||Rl(n,!1,e),Rl(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ua]||(t[Ua]=!0,Rl("selectionchange",!1,t))}}function Vh(e,t,n,r){switch(kh(t)){case 1:var a=Vm;break;case 4:a=Fm;break;default:a=mc}n=a.bind(null,t,n,e),a=void 0,!po||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Pl(e,t,n,r,a){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var o=r.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(l===4)for(l=r.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;l=l.return}for(;o!==null;){if(l=_s(o),l===null)return;if(c=l.tag,c===5||c===6){r=i=l;continue e}o=o.parentNode}}r=r.return}dh(function(){var f=i,x=dc(n),g=[];e:{var j=$h.get(e);if(j!==void 0){var T=vc,y=e;switch(e){case"keypress":if(si(n)===0)break e;case"keydown":case"keyup":T=rg;break;case"focusin":y="focus",T=Cl;break;case"focusout":y="blur",T=Cl;break;case"beforeblur":case"afterblur":T=Cl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":T=wu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":T=qm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":T=lg;break;case Mh:case Ih:case Bh:T=Ym;break;case zh:T=cg;break;case"scroll":T=Wm;break;case"wheel":T=dg;break;case"copy":case"cut":case"paste":T=Xm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":T=Su}var A=(t&4)!==0,w=!A&&e==="scroll",d=A?j!==null?j+"Capture":null:j;A=[];for(var p=f,v;p!==null;){v=p;var S=v.stateNode;if(v.tag===5&&S!==null&&(v=S,d!==null&&(S=na(p,d),S!=null&&A.push(ca(p,S,v)))),w)break;p=p.return}0<A.length&&(j=new T(j,y,null,n,x),g.push({event:j,listeners:A}))}}if(!(t&7)){e:{if(j=e==="mouseover"||e==="pointerover",T=e==="mouseout"||e==="pointerout",j&&n!==ho&&(y=n.relatedTarget||n.fromElement)&&(_s(y)||y[Dn]))break e;if((T||j)&&(j=x.window===x?x:(j=x.ownerDocument)?j.defaultView||j.parentWindow:window,T?(y=n.relatedTarget||n.toElement,T=f,y=y?_s(y):null,y!==null&&(w=Ps(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(T=null,y=f),T!==y)){if(A=wu,S="onMouseLeave",d="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(A=Su,S="onPointerLeave",d="onPointerEnter",p="pointer"),w=T==null?j:Xs(T),v=y==null?j:Xs(y),j=new A(S,p+"leave",T,n,x),j.target=w,j.relatedTarget=v,S=null,_s(x)===f&&(A=new A(d,p+"enter",y,n,x),A.target=v,A.relatedTarget=w,S=A),w=S,T&&y)t:{for(A=T,d=y,p=0,v=A;v;v=Ws(v))p++;for(v=0,S=d;S;S=Ws(S))v++;for(;0<p-v;)A=Ws(A),p--;for(;0<v-p;)d=Ws(d),v--;for(;p--;){if(A===d||d!==null&&A===d.alternate)break t;A=Ws(A),d=Ws(d)}A=null}else A=null;T!==null&&Du(g,j,T,A,!1),y!==null&&w!==null&&Du(g,w,y,A,!0)}}e:{if(j=f?Xs(f):window,T=j.nodeName&&j.nodeName.toLowerCase(),T==="select"||T==="input"&&j.type==="file")var P=xg;else if(Cu(j))if(Lh)P=wg;else{P=jg;var N=yg}else(T=j.nodeName)&&T.toLowerCase()==="input"&&(j.type==="checkbox"||j.type==="radio")&&(P=Ng);if(P&&(P=P(e,f))){Ah(g,P,n,x);break e}N&&N(e,j,f),e==="focusout"&&(N=j._wrapperState)&&N.controlled&&j.type==="number"&&io(j,"number",j.value)}switch(N=f?Xs(f):window,e){case"focusin":(Cu(N)||N.contentEditable==="true")&&(Ys=N,yo=f,Yr=null);break;case"focusout":Yr=yo=Ys=null;break;case"mousedown":jo=!0;break;case"contextmenu":case"mouseup":case"dragend":jo=!1,Ou(g,n,x);break;case"selectionchange":if(kg)break;case"keydown":case"keyup":Ou(g,n,x)}var D;if(yc)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Gs?Eh(e,n)&&(E="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Ch&&n.locale!=="ko"&&(Gs||E!=="onCompositionStart"?E==="onCompositionEnd"&&Gs&&(D=bh()):(Jn=x,gc="value"in Jn?Jn.value:Jn.textContent,Gs=!0)),N=wi(f,E),0<N.length&&(E=new _u(E,e,null,n,x),g.push({event:E,listeners:N}),D?E.data=D:(D=Th(n),D!==null&&(E.data=D)))),(D=fg?pg(e,n):mg(e,n))&&(f=wi(f,"onBeforeInput"),0<f.length&&(x=new _u("onBeforeInput","beforeinput",null,n,x),g.push({event:x,listeners:f}),x.data=D))}Uh(g,t)})}function ca(e,t,n){return{instance:e,listener:t,currentTarget:n}}function wi(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=na(e,n),i!=null&&r.unshift(ca(e,i,a)),i=na(e,t),i!=null&&r.push(ca(e,i,a))),e=e.return}return r}function Ws(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Du(e,t,n,r,a){for(var i=t._reactName,l=[];n!==null&&n!==r;){var o=n,c=o.alternate,f=o.stateNode;if(c!==null&&c===r)break;o.tag===5&&f!==null&&(o=f,a?(c=na(n,i),c!=null&&l.unshift(ca(n,c,o))):a||(c=na(n,i),c!=null&&l.push(ca(n,c,o)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var Tg=/\r\n?/g,Ag=/\u0000|\uFFFD/g;function Mu(e){return(typeof e=="string"?e:""+e).replace(Tg,`
`).replace(Ag,"")}function Va(e,t,n){if(t=Mu(t),Mu(e)!==t&&n)throw Error(M(425))}function _i(){}var No=null,wo=null;function _o(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var So=typeof setTimeout=="function"?setTimeout:void 0,Lg=typeof clearTimeout=="function"?clearTimeout:void 0,Iu=typeof Promise=="function"?Promise:void 0,Og=typeof queueMicrotask=="function"?queueMicrotask:typeof Iu<"u"?function(e){return Iu.resolve(null).then(e).catch(Rg)}:So;function Rg(e){setTimeout(function(){throw e})}function Dl(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),aa(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);aa(t)}function ss(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Bu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var yr=Math.random().toString(36).slice(2),gn="__reactFiber$"+yr,ua="__reactProps$"+yr,Dn="__reactContainer$"+yr,ko="__reactEvents$"+yr,Pg="__reactListeners$"+yr,Dg="__reactHandles$"+yr;function _s(e){var t=e[gn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Dn]||n[gn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Bu(e);e!==null;){if(n=e[gn])return n;e=Bu(e)}return t}e=n,n=e.parentNode}return null}function ja(e){return e=e[gn]||e[Dn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Xs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(M(33))}function Hi(e){return e[ua]||null}var bo=[],Js=-1;function hs(e){return{current:e}}function Le(e){0>Js||(e.current=bo[Js],bo[Js]=null,Js--)}function Te(e,t){Js++,bo[Js]=e.current,e.current=t}var us={},ct=hs(us),kt=hs(!1),Es=us;function dr(e,t){var n=e.type.contextTypes;if(!n)return us;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function bt(e){return e=e.childContextTypes,e!=null}function Si(){Le(kt),Le(ct)}function zu(e,t,n){if(ct.current!==us)throw Error(M(168));Te(ct,t),Te(kt,n)}function Fh(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(M(108,ym(e)||"Unknown",a));return Me({},n,r)}function ki(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||us,Es=ct.current,Te(ct,e),Te(kt,kt.current),!0}function $u(e,t,n){var r=e.stateNode;if(!r)throw Error(M(169));n?(e=Fh(e,t,Es),r.__reactInternalMemoizedMergedChildContext=e,Le(kt),Le(ct),Te(ct,e)):Le(kt),Te(kt,n)}var Tn=null,qi=!1,Ml=!1;function Wh(e){Tn===null?Tn=[e]:Tn.push(e)}function Mg(e){qi=!0,Wh(e)}function fs(){if(!Ml&&Tn!==null){Ml=!0;var e=0,t=be;try{var n=Tn;for(be=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Tn=null,qi=!1}catch(a){throw Tn!==null&&(Tn=Tn.slice(e+1)),mh(hc,fs),a}finally{be=t,Ml=!1}}return null}var Zs=[],er=0,bi=null,Ci=0,Ht=[],qt=0,Ts=null,Ln=1,On="";function Ns(e,t){Zs[er++]=Ci,Zs[er++]=bi,bi=e,Ci=t}function Hh(e,t,n){Ht[qt++]=Ln,Ht[qt++]=On,Ht[qt++]=Ts,Ts=e;var r=Ln;e=On;var a=32-an(r)-1;r&=~(1<<a),n+=1;var i=32-an(t)+a;if(30<i){var l=a-a%5;i=(r&(1<<l)-1).toString(32),r>>=l,a-=l,Ln=1<<32-an(t)+a|n<<a|r,On=i+e}else Ln=1<<i|n<<a|r,On=e}function Nc(e){e.return!==null&&(Ns(e,1),Hh(e,1,0))}function wc(e){for(;e===bi;)bi=Zs[--er],Zs[er]=null,Ci=Zs[--er],Zs[er]=null;for(;e===Ts;)Ts=Ht[--qt],Ht[qt]=null,On=Ht[--qt],Ht[qt]=null,Ln=Ht[--qt],Ht[qt]=null}var Dt=null,Pt=null,Re=!1,rn=null;function qh(e,t){var n=Gt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Uu(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Dt=e,Pt=ss(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Dt=e,Pt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ts!==null?{id:Ln,overflow:On}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Gt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Dt=e,Pt=null,!0):!1;default:return!1}}function Co(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eo(e){if(Re){var t=Pt;if(t){var n=t;if(!Uu(e,t)){if(Co(e))throw Error(M(418));t=ss(n.nextSibling);var r=Dt;t&&Uu(e,t)?qh(r,n):(e.flags=e.flags&-4097|2,Re=!1,Dt=e)}}else{if(Co(e))throw Error(M(418));e.flags=e.flags&-4097|2,Re=!1,Dt=e}}}function Vu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Dt=e}function Fa(e){if(e!==Dt)return!1;if(!Re)return Vu(e),Re=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!_o(e.type,e.memoizedProps)),t&&(t=Pt)){if(Co(e))throw Qh(),Error(M(418));for(;t;)qh(e,t),t=ss(t.nextSibling)}if(Vu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(M(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Pt=ss(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Pt=null}}else Pt=Dt?ss(e.stateNode.nextSibling):null;return!0}function Qh(){for(var e=Pt;e;)e=ss(e.nextSibling)}function hr(){Pt=Dt=null,Re=!1}function _c(e){rn===null?rn=[e]:rn.push(e)}var Ig=Bn.ReactCurrentBatchConfig;function Mr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(M(309));var r=n.stateNode}if(!r)throw Error(M(147,e));var a=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=a.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(M(284));if(!n._owner)throw Error(M(290,e))}return e}function Wa(e,t){throw e=Object.prototype.toString.call(t),Error(M(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Fu(e){var t=e._init;return t(e._payload)}function Gh(e){function t(d,p){if(e){var v=d.deletions;v===null?(d.deletions=[p],d.flags|=16):v.push(p)}}function n(d,p){if(!e)return null;for(;p!==null;)t(d,p),p=p.sibling;return null}function r(d,p){for(d=new Map;p!==null;)p.key!==null?d.set(p.key,p):d.set(p.index,p),p=p.sibling;return d}function a(d,p){return d=ls(d,p),d.index=0,d.sibling=null,d}function i(d,p,v){return d.index=v,e?(v=d.alternate,v!==null?(v=v.index,v<p?(d.flags|=2,p):v):(d.flags|=2,p)):(d.flags|=1048576,p)}function l(d){return e&&d.alternate===null&&(d.flags|=2),d}function o(d,p,v,S){return p===null||p.tag!==6?(p=Fl(v,d.mode,S),p.return=d,p):(p=a(p,v),p.return=d,p)}function c(d,p,v,S){var P=v.type;return P===Qs?x(d,p,v.props.children,S,v.key):p!==null&&(p.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Qn&&Fu(P)===p.type)?(S=a(p,v.props),S.ref=Mr(d,p,v),S.return=d,S):(S=ui(v.type,v.key,v.props,null,d.mode,S),S.ref=Mr(d,p,v),S.return=d,S)}function f(d,p,v,S){return p===null||p.tag!==4||p.stateNode.containerInfo!==v.containerInfo||p.stateNode.implementation!==v.implementation?(p=Wl(v,d.mode,S),p.return=d,p):(p=a(p,v.children||[]),p.return=d,p)}function x(d,p,v,S,P){return p===null||p.tag!==7?(p=Cs(v,d.mode,S,P),p.return=d,p):(p=a(p,v),p.return=d,p)}function g(d,p,v){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Fl(""+p,d.mode,v),p.return=d,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Ra:return v=ui(p.type,p.key,p.props,null,d.mode,v),v.ref=Mr(d,null,p),v.return=d,v;case qs:return p=Wl(p,d.mode,v),p.return=d,p;case Qn:var S=p._init;return g(d,S(p._payload),v)}if(Ur(p)||Lr(p))return p=Cs(p,d.mode,v,null),p.return=d,p;Wa(d,p)}return null}function j(d,p,v,S){var P=p!==null?p.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return P!==null?null:o(d,p,""+v,S);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Ra:return v.key===P?c(d,p,v,S):null;case qs:return v.key===P?f(d,p,v,S):null;case Qn:return P=v._init,j(d,p,P(v._payload),S)}if(Ur(v)||Lr(v))return P!==null?null:x(d,p,v,S,null);Wa(d,v)}return null}function T(d,p,v,S,P){if(typeof S=="string"&&S!==""||typeof S=="number")return d=d.get(v)||null,o(p,d,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ra:return d=d.get(S.key===null?v:S.key)||null,c(p,d,S,P);case qs:return d=d.get(S.key===null?v:S.key)||null,f(p,d,S,P);case Qn:var N=S._init;return T(d,p,v,N(S._payload),P)}if(Ur(S)||Lr(S))return d=d.get(v)||null,x(p,d,S,P,null);Wa(p,S)}return null}function y(d,p,v,S){for(var P=null,N=null,D=p,E=p=0,$=null;D!==null&&E<v.length;E++){D.index>E?($=D,D=null):$=D.sibling;var F=j(d,D,v[E],S);if(F===null){D===null&&(D=$);break}e&&D&&F.alternate===null&&t(d,D),p=i(F,p,E),N===null?P=F:N.sibling=F,N=F,D=$}if(E===v.length)return n(d,D),Re&&Ns(d,E),P;if(D===null){for(;E<v.length;E++)D=g(d,v[E],S),D!==null&&(p=i(D,p,E),N===null?P=D:N.sibling=D,N=D);return Re&&Ns(d,E),P}for(D=r(d,D);E<v.length;E++)$=T(D,d,E,v[E],S),$!==null&&(e&&$.alternate!==null&&D.delete($.key===null?E:$.key),p=i($,p,E),N===null?P=$:N.sibling=$,N=$);return e&&D.forEach(function(te){return t(d,te)}),Re&&Ns(d,E),P}function A(d,p,v,S){var P=Lr(v);if(typeof P!="function")throw Error(M(150));if(v=P.call(v),v==null)throw Error(M(151));for(var N=P=null,D=p,E=p=0,$=null,F=v.next();D!==null&&!F.done;E++,F=v.next()){D.index>E?($=D,D=null):$=D.sibling;var te=j(d,D,F.value,S);if(te===null){D===null&&(D=$);break}e&&D&&te.alternate===null&&t(d,D),p=i(te,p,E),N===null?P=te:N.sibling=te,N=te,D=$}if(F.done)return n(d,D),Re&&Ns(d,E),P;if(D===null){for(;!F.done;E++,F=v.next())F=g(d,F.value,S),F!==null&&(p=i(F,p,E),N===null?P=F:N.sibling=F,N=F);return Re&&Ns(d,E),P}for(D=r(d,D);!F.done;E++,F=v.next())F=T(D,d,E,F.value,S),F!==null&&(e&&F.alternate!==null&&D.delete(F.key===null?E:F.key),p=i(F,p,E),N===null?P=F:N.sibling=F,N=F);return e&&D.forEach(function(he){return t(d,he)}),Re&&Ns(d,E),P}function w(d,p,v,S){if(typeof v=="object"&&v!==null&&v.type===Qs&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Ra:e:{for(var P=v.key,N=p;N!==null;){if(N.key===P){if(P=v.type,P===Qs){if(N.tag===7){n(d,N.sibling),p=a(N,v.props.children),p.return=d,d=p;break e}}else if(N.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Qn&&Fu(P)===N.type){n(d,N.sibling),p=a(N,v.props),p.ref=Mr(d,N,v),p.return=d,d=p;break e}n(d,N);break}else t(d,N);N=N.sibling}v.type===Qs?(p=Cs(v.props.children,d.mode,S,v.key),p.return=d,d=p):(S=ui(v.type,v.key,v.props,null,d.mode,S),S.ref=Mr(d,p,v),S.return=d,d=S)}return l(d);case qs:e:{for(N=v.key;p!==null;){if(p.key===N)if(p.tag===4&&p.stateNode.containerInfo===v.containerInfo&&p.stateNode.implementation===v.implementation){n(d,p.sibling),p=a(p,v.children||[]),p.return=d,d=p;break e}else{n(d,p);break}else t(d,p);p=p.sibling}p=Wl(v,d.mode,S),p.return=d,d=p}return l(d);case Qn:return N=v._init,w(d,p,N(v._payload),S)}if(Ur(v))return y(d,p,v,S);if(Lr(v))return A(d,p,v,S);Wa(d,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,p!==null&&p.tag===6?(n(d,p.sibling),p=a(p,v),p.return=d,d=p):(n(d,p),p=Fl(v,d.mode,S),p.return=d,d=p),l(d)):n(d,p)}return w}var fr=Gh(!0),Yh=Gh(!1),Ei=hs(null),Ti=null,tr=null,Sc=null;function kc(){Sc=tr=Ti=null}function bc(e){var t=Ei.current;Le(Ei),e._currentValue=t}function To(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function or(e,t){Ti=e,Sc=tr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(St=!0),e.firstContext=null)}function Kt(e){var t=e._currentValue;if(Sc!==e)if(e={context:e,memoizedValue:t,next:null},tr===null){if(Ti===null)throw Error(M(308));tr=e,Ti.dependencies={lanes:0,firstContext:e}}else tr=tr.next=e;return t}var Ss=null;function Cc(e){Ss===null?Ss=[e]:Ss.push(e)}function Kh(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,Cc(t)):(n.next=a.next,a.next=n),t.interleaved=n,Mn(e,r)}function Mn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Gn=!1;function Ec(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Xh(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Rn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function rs(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Mn(e,n)}return a=r.interleaved,a===null?(t.next=t,Cc(r)):(t.next=a.next,a.next=t),r.interleaved=t,Mn(e,n)}function ri(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,fc(e,n)}}function Wu(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=l:i=i.next=l,n=n.next}while(n!==null);i===null?a=i=t:i=i.next=t}else a=i=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ai(e,t,n,r){var a=e.updateQueue;Gn=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,f=c.next;c.next=null,l===null?i=f:l.next=f,l=c;var x=e.alternate;x!==null&&(x=x.updateQueue,o=x.lastBaseUpdate,o!==l&&(o===null?x.firstBaseUpdate=f:o.next=f,x.lastBaseUpdate=c))}if(i!==null){var g=a.baseState;l=0,x=f=c=null,o=i;do{var j=o.lane,T=o.eventTime;if((r&j)===j){x!==null&&(x=x.next={eventTime:T,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=e,A=o;switch(j=t,T=n,A.tag){case 1:if(y=A.payload,typeof y=="function"){g=y.call(T,g,j);break e}g=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=A.payload,j=typeof y=="function"?y.call(T,g,j):y,j==null)break e;g=Me({},g,j);break e;case 2:Gn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,j=a.effects,j===null?a.effects=[o]:j.push(o))}else T={eventTime:T,lane:j,tag:o.tag,payload:o.payload,callback:o.callback,next:null},x===null?(f=x=T,c=g):x=x.next=T,l|=j;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;j=o,o=j.next,j.next=null,a.lastBaseUpdate=j,a.shared.pending=null}}while(!0);if(x===null&&(c=g),a.baseState=c,a.firstBaseUpdate=f,a.lastBaseUpdate=x,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Ls|=l,e.lanes=l,e.memoizedState=g}}function Hu(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(M(191,a));a.call(r)}}}var Na={},xn=hs(Na),da=hs(Na),ha=hs(Na);function ks(e){if(e===Na)throw Error(M(174));return e}function Tc(e,t){switch(Te(ha,t),Te(da,e),Te(xn,Na),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oo(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=oo(t,e)}Le(xn),Te(xn,t)}function pr(){Le(xn),Le(da),Le(ha)}function Jh(e){ks(ha.current);var t=ks(xn.current),n=oo(t,e.type);t!==n&&(Te(da,e),Te(xn,n))}function Ac(e){da.current===e&&(Le(xn),Le(da))}var Pe=hs(0);function Li(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Il=[];function Lc(){for(var e=0;e<Il.length;e++)Il[e]._workInProgressVersionPrimary=null;Il.length=0}var ai=Bn.ReactCurrentDispatcher,Bl=Bn.ReactCurrentBatchConfig,As=0,De=null,Ye=null,et=null,Oi=!1,Kr=!1,fa=0,Bg=0;function it(){throw Error(M(321))}function Oc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!on(e[n],t[n]))return!1;return!0}function Rc(e,t,n,r,a,i){if(As=i,De=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ai.current=e===null||e.memoizedState===null?Vg:Fg,e=n(r,a),Kr){i=0;do{if(Kr=!1,fa=0,25<=i)throw Error(M(301));i+=1,et=Ye=null,t.updateQueue=null,ai.current=Wg,e=n(r,a)}while(Kr)}if(ai.current=Ri,t=Ye!==null&&Ye.next!==null,As=0,et=Ye=De=null,Oi=!1,t)throw Error(M(300));return e}function Pc(){var e=fa!==0;return fa=0,e}function mn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return et===null?De.memoizedState=et=e:et=et.next=e,et}function Xt(){if(Ye===null){var e=De.alternate;e=e!==null?e.memoizedState:null}else e=Ye.next;var t=et===null?De.memoizedState:et.next;if(t!==null)et=t,Ye=e;else{if(e===null)throw Error(M(310));Ye=e,e={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},et===null?De.memoizedState=et=e:et=et.next=e}return et}function pa(e,t){return typeof t=="function"?t(e):t}function zl(e){var t=Xt(),n=t.queue;if(n===null)throw Error(M(311));n.lastRenderedReducer=e;var r=Ye,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var o=l=null,c=null,f=i;do{var x=f.lane;if((As&x)===x)c!==null&&(c=c.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),r=f.hasEagerState?f.eagerState:e(r,f.action);else{var g={lane:x,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};c===null?(o=c=g,l=r):c=c.next=g,De.lanes|=x,Ls|=x}f=f.next}while(f!==null&&f!==i);c===null?l=r:c.next=o,on(r,t.memoizedState)||(St=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do i=a.lane,De.lanes|=i,Ls|=i,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function $l(e){var t=Xt(),n=t.queue;if(n===null)throw Error(M(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(a!==null){n.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);on(i,t.memoizedState)||(St=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Zh(){}function ef(e,t){var n=De,r=Xt(),a=t(),i=!on(r.memoizedState,a);if(i&&(r.memoizedState=a,St=!0),r=r.queue,Dc(sf.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||et!==null&&et.memoizedState.tag&1){if(n.flags|=2048,ma(9,nf.bind(null,n,r,a,t),void 0,null),tt===null)throw Error(M(349));As&30||tf(n,t,a)}return a}function tf(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=De.updateQueue,t===null?(t={lastEffect:null,stores:null},De.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function nf(e,t,n,r){t.value=n,t.getSnapshot=r,rf(t)&&af(e)}function sf(e,t,n){return n(function(){rf(t)&&af(e)})}function rf(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!on(e,n)}catch{return!0}}function af(e){var t=Mn(e,1);t!==null&&ln(t,e,1,-1)}function qu(e){var t=mn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:e},t.queue=e,e=e.dispatch=Ug.bind(null,De,e),[t.memoizedState,e]}function ma(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=De.updateQueue,t===null?(t={lastEffect:null,stores:null},De.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function lf(){return Xt().memoizedState}function ii(e,t,n,r){var a=mn();De.flags|=e,a.memoizedState=ma(1|t,n,void 0,r===void 0?null:r)}function Qi(e,t,n,r){var a=Xt();r=r===void 0?null:r;var i=void 0;if(Ye!==null){var l=Ye.memoizedState;if(i=l.destroy,r!==null&&Oc(r,l.deps)){a.memoizedState=ma(t,n,i,r);return}}De.flags|=e,a.memoizedState=ma(1|t,n,i,r)}function Qu(e,t){return ii(8390656,8,e,t)}function Dc(e,t){return Qi(2048,8,e,t)}function of(e,t){return Qi(4,2,e,t)}function cf(e,t){return Qi(4,4,e,t)}function uf(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function df(e,t,n){return n=n!=null?n.concat([e]):null,Qi(4,4,uf.bind(null,t,e),n)}function Mc(){}function hf(e,t){var n=Xt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Oc(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function ff(e,t){var n=Xt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Oc(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function pf(e,t,n){return As&21?(on(n,t)||(n=xh(),De.lanes|=n,Ls|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,St=!0),e.memoizedState=n)}function zg(e,t){var n=be;be=n!==0&&4>n?n:4,e(!0);var r=Bl.transition;Bl.transition={};try{e(!1),t()}finally{be=n,Bl.transition=r}}function mf(){return Xt().memoizedState}function $g(e,t,n){var r=is(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},gf(e))vf(t,n);else if(n=Kh(e,t,n,r),n!==null){var a=gt();ln(n,e,r,a),xf(n,t,r)}}function Ug(e,t,n){var r=is(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(gf(e))vf(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,n);if(a.hasEagerState=!0,a.eagerState=o,on(o,l)){var c=t.interleaved;c===null?(a.next=a,Cc(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}n=Kh(e,t,a,r),n!==null&&(a=gt(),ln(n,e,r,a),xf(n,t,r))}}function gf(e){var t=e.alternate;return e===De||t!==null&&t===De}function vf(e,t){Kr=Oi=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function xf(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,fc(e,n)}}var Ri={readContext:Kt,useCallback:it,useContext:it,useEffect:it,useImperativeHandle:it,useInsertionEffect:it,useLayoutEffect:it,useMemo:it,useReducer:it,useRef:it,useState:it,useDebugValue:it,useDeferredValue:it,useTransition:it,useMutableSource:it,useSyncExternalStore:it,useId:it,unstable_isNewReconciler:!1},Vg={readContext:Kt,useCallback:function(e,t){return mn().memoizedState=[e,t===void 0?null:t],e},useContext:Kt,useEffect:Qu,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ii(4194308,4,uf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ii(4194308,4,e,t)},useInsertionEffect:function(e,t){return ii(4,2,e,t)},useMemo:function(e,t){var n=mn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=mn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=$g.bind(null,De,e),[r.memoizedState,e]},useRef:function(e){var t=mn();return e={current:e},t.memoizedState=e},useState:qu,useDebugValue:Mc,useDeferredValue:function(e){return mn().memoizedState=e},useTransition:function(){var e=qu(!1),t=e[0];return e=zg.bind(null,e[1]),mn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=De,a=mn();if(Re){if(n===void 0)throw Error(M(407));n=n()}else{if(n=t(),tt===null)throw Error(M(349));As&30||tf(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,Qu(sf.bind(null,r,i,e),[e]),r.flags|=2048,ma(9,nf.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=mn(),t=tt.identifierPrefix;if(Re){var n=On,r=Ln;n=(r&~(1<<32-an(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=fa++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Bg++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Fg={readContext:Kt,useCallback:hf,useContext:Kt,useEffect:Dc,useImperativeHandle:df,useInsertionEffect:of,useLayoutEffect:cf,useMemo:ff,useReducer:zl,useRef:lf,useState:function(){return zl(pa)},useDebugValue:Mc,useDeferredValue:function(e){var t=Xt();return pf(t,Ye.memoizedState,e)},useTransition:function(){var e=zl(pa)[0],t=Xt().memoizedState;return[e,t]},useMutableSource:Zh,useSyncExternalStore:ef,useId:mf,unstable_isNewReconciler:!1},Wg={readContext:Kt,useCallback:hf,useContext:Kt,useEffect:Dc,useImperativeHandle:df,useInsertionEffect:of,useLayoutEffect:cf,useMemo:ff,useReducer:$l,useRef:lf,useState:function(){return $l(pa)},useDebugValue:Mc,useDeferredValue:function(e){var t=Xt();return Ye===null?t.memoizedState=e:pf(t,Ye.memoizedState,e)},useTransition:function(){var e=$l(pa)[0],t=Xt().memoizedState;return[e,t]},useMutableSource:Zh,useSyncExternalStore:ef,useId:mf,unstable_isNewReconciler:!1};function tn(e,t){if(e&&e.defaultProps){t=Me({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Ao(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Me({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Gi={isMounted:function(e){return(e=e._reactInternals)?Ps(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=gt(),a=is(e),i=Rn(r,a);i.payload=t,n!=null&&(i.callback=n),t=rs(e,i,a),t!==null&&(ln(t,e,a,r),ri(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=gt(),a=is(e),i=Rn(r,a);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=rs(e,i,a),t!==null&&(ln(t,e,a,r),ri(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=gt(),r=is(e),a=Rn(n,r);a.tag=2,t!=null&&(a.callback=t),t=rs(e,a,r),t!==null&&(ln(t,e,r,n),ri(t,e,r))}};function Gu(e,t,n,r,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,l):t.prototype&&t.prototype.isPureReactComponent?!la(n,r)||!la(a,i):!0}function yf(e,t,n){var r=!1,a=us,i=t.contextType;return typeof i=="object"&&i!==null?i=Kt(i):(a=bt(t)?Es:ct.current,r=t.contextTypes,i=(r=r!=null)?dr(e,a):us),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Gi,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Yu(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Gi.enqueueReplaceState(t,t.state,null)}function Lo(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Ec(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Kt(i):(i=bt(t)?Es:ct.current,a.context=dr(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Ao(e,t,i,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Gi.enqueueReplaceState(a,a.state,null),Ai(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function mr(e,t){try{var n="",r=t;do n+=xm(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Ul(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Oo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Hg=typeof WeakMap=="function"?WeakMap:Map;function jf(e,t,n){n=Rn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Di||(Di=!0,Vo=r),Oo(e,t)},n}function Nf(e,t,n){n=Rn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){Oo(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Oo(e,t),typeof r!="function"&&(as===null?as=new Set([this]):as.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function Ku(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Hg;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=av.bind(null,e,t,n),t.then(e,e))}function Xu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ju(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Rn(-1,1),t.tag=2,rs(n,t,1))),n.lanes|=1),e)}var qg=Bn.ReactCurrentOwner,St=!1;function mt(e,t,n,r){t.child=e===null?Yh(t,null,n,r):fr(t,e.child,n,r)}function Zu(e,t,n,r,a){n=n.render;var i=t.ref;return or(t,a),r=Rc(e,t,n,r,i,a),n=Pc(),e!==null&&!St?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,In(e,t,a)):(Re&&n&&Nc(t),t.flags|=1,mt(e,t,r,a),t.child)}function ed(e,t,n,r,a){if(e===null){var i=n.type;return typeof i=="function"&&!Wc(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,wf(e,t,i,r,a)):(e=ui(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(n=n.compare,n=n!==null?n:la,n(l,r)&&e.ref===t.ref)return In(e,t,a)}return t.flags|=1,e=ls(i,r),e.ref=t.ref,e.return=t,t.child=e}function wf(e,t,n,r,a){if(e!==null){var i=e.memoizedProps;if(la(i,r)&&e.ref===t.ref)if(St=!1,t.pendingProps=r=i,(e.lanes&a)!==0)e.flags&131072&&(St=!0);else return t.lanes=e.lanes,In(e,t,a)}return Ro(e,t,n,r,a)}function _f(e,t,n){var r=t.pendingProps,a=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Te(sr,Rt),Rt|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Te(sr,Rt),Rt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Te(sr,Rt),Rt|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Te(sr,Rt),Rt|=r;return mt(e,t,a,n),t.child}function Sf(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ro(e,t,n,r,a){var i=bt(n)?Es:ct.current;return i=dr(t,i),or(t,a),n=Rc(e,t,n,r,i,a),r=Pc(),e!==null&&!St?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,In(e,t,a)):(Re&&r&&Nc(t),t.flags|=1,mt(e,t,n,a),t.child)}function td(e,t,n,r,a){if(bt(n)){var i=!0;ki(t)}else i=!1;if(or(t,a),t.stateNode===null)li(e,t),yf(t,n,r),Lo(t,n,r,a),r=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var c=l.context,f=n.contextType;typeof f=="object"&&f!==null?f=Kt(f):(f=bt(n)?Es:ct.current,f=dr(t,f));var x=n.getDerivedStateFromProps,g=typeof x=="function"||typeof l.getSnapshotBeforeUpdate=="function";g||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==r||c!==f)&&Yu(t,l,r,f),Gn=!1;var j=t.memoizedState;l.state=j,Ai(t,r,l,a),c=t.memoizedState,o!==r||j!==c||kt.current||Gn?(typeof x=="function"&&(Ao(t,n,x,r),c=t.memoizedState),(o=Gn||Gu(t,n,o,r,j,c,f))?(g||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),l.props=r,l.state=c,l.context=f,r=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,Xh(e,t),o=t.memoizedProps,f=t.type===t.elementType?o:tn(t.type,o),l.props=f,g=t.pendingProps,j=l.context,c=n.contextType,typeof c=="object"&&c!==null?c=Kt(c):(c=bt(n)?Es:ct.current,c=dr(t,c));var T=n.getDerivedStateFromProps;(x=typeof T=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==g||j!==c)&&Yu(t,l,r,c),Gn=!1,j=t.memoizedState,l.state=j,Ai(t,r,l,a);var y=t.memoizedState;o!==g||j!==y||kt.current||Gn?(typeof T=="function"&&(Ao(t,n,T,r),y=t.memoizedState),(f=Gn||Gu(t,n,f,r,j,y,c)||!1)?(x||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,y,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,y,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&j===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&j===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=y),l.props=r,l.state=y,l.context=c,r=f):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&j===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&j===e.memoizedState||(t.flags|=1024),r=!1)}return Po(e,t,n,r,i,a)}function Po(e,t,n,r,a,i){Sf(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return a&&$u(t,n,!1),In(e,t,i);r=t.stateNode,qg.current=t;var o=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=fr(t,e.child,null,i),t.child=fr(t,null,o,i)):mt(e,t,o,i),t.memoizedState=r.state,a&&$u(t,n,!0),t.child}function kf(e){var t=e.stateNode;t.pendingContext?zu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&zu(e,t.context,!1),Tc(e,t.containerInfo)}function nd(e,t,n,r,a){return hr(),_c(a),t.flags|=256,mt(e,t,n,r),t.child}var Do={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function bf(e,t,n){var r=t.pendingProps,a=Pe.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Te(Pe,a&1),e===null)return Eo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,i?(r=t.mode,i=t.child,l={mode:"hidden",children:l},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Xi(l,r,0,null),e=Cs(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Mo(n),t.memoizedState=Do,e):Ic(t,l));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return Qg(e,t,l,r,o,a,n);if(i){i=r.fallback,l=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:r.children};return!(l&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=ls(a,c),r.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=ls(o,i):(i=Cs(i,l,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,l=e.child.memoizedState,l=l===null?Mo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=Do,r}return i=e.child,e=i.sibling,r=ls(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Ic(e,t){return t=Xi({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ha(e,t,n,r){return r!==null&&_c(r),fr(t,e.child,null,n),e=Ic(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Qg(e,t,n,r,a,i,l){if(n)return t.flags&256?(t.flags&=-257,r=Ul(Error(M(422))),Ha(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=Xi({mode:"visible",children:r.children},a,0,null),i=Cs(i,a,l,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&fr(t,e.child,null,l),t.child.memoizedState=Mo(l),t.memoizedState=Do,i);if(!(t.mode&1))return Ha(e,t,l,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var o=r.dgst;return r=o,i=Error(M(419)),r=Ul(i,r,void 0),Ha(e,t,l,r)}if(o=(l&e.childLanes)!==0,St||o){if(r=tt,r!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Mn(e,a),ln(r,e,a,-1))}return Fc(),r=Ul(Error(M(421))),Ha(e,t,l,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=iv.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Pt=ss(a.nextSibling),Dt=t,Re=!0,rn=null,e!==null&&(Ht[qt++]=Ln,Ht[qt++]=On,Ht[qt++]=Ts,Ln=e.id,On=e.overflow,Ts=t),t=Ic(t,r.children),t.flags|=4096,t)}function sd(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),To(e.return,t,n)}function Vl(e,t,n,r,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Cf(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(mt(e,t,r.children,n),r=Pe.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&sd(e,n,t);else if(e.tag===19)sd(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Te(Pe,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&Li(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Vl(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Li(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Vl(t,!0,n,null,i);break;case"together":Vl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function li(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function In(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ls|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(M(153));if(t.child!==null){for(e=t.child,n=ls(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ls(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Gg(e,t,n){switch(t.tag){case 3:kf(t),hr();break;case 5:Jh(t);break;case 1:bt(t.type)&&ki(t);break;case 4:Tc(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Te(Ei,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Te(Pe,Pe.current&1),t.flags|=128,null):n&t.child.childLanes?bf(e,t,n):(Te(Pe,Pe.current&1),e=In(e,t,n),e!==null?e.sibling:null);Te(Pe,Pe.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Cf(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Te(Pe,Pe.current),r)break;return null;case 22:case 23:return t.lanes=0,_f(e,t,n)}return In(e,t,n)}var Ef,Io,Tf,Af;Ef=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Io=function(){};Tf=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,ks(xn.current);var i=null;switch(n){case"input":a=ro(e,a),r=ro(e,r),i=[];break;case"select":a=Me({},a,{value:void 0}),r=Me({},r,{value:void 0}),i=[];break;case"textarea":a=lo(e,a),r=lo(e,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=_i)}co(n,r);var l;n=null;for(f in a)if(!r.hasOwnProperty(f)&&a.hasOwnProperty(f)&&a[f]!=null)if(f==="style"){var o=a[f];for(l in o)o.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(ea.hasOwnProperty(f)?i||(i=[]):(i=i||[]).push(f,null));for(f in r){var c=r[f];if(o=a!=null?a[f]:void 0,r.hasOwnProperty(f)&&c!==o&&(c!=null||o!=null))if(f==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(i||(i=[]),i.push(f,n)),n=c;else f==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(f,c)):f==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(f,""+c):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(ea.hasOwnProperty(f)?(c!=null&&f==="onScroll"&&Ae("scroll",e),i||o===c||(i=[])):(i=i||[]).push(f,c))}n&&(i=i||[]).push("style",n);var f=i;(t.updateQueue=f)&&(t.flags|=4)}};Af=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ir(e,t){if(!Re)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function lt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Yg(e,t,n){var r=t.pendingProps;switch(wc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(t),null;case 1:return bt(t.type)&&Si(),lt(t),null;case 3:return r=t.stateNode,pr(),Le(kt),Le(ct),Lc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Fa(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,rn!==null&&(Ho(rn),rn=null))),Io(e,t),lt(t),null;case 5:Ac(t);var a=ks(ha.current);if(n=t.type,e!==null&&t.stateNode!=null)Tf(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(M(166));return lt(t),null}if(e=ks(xn.current),Fa(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[gn]=t,r[ua]=i,e=(t.mode&1)!==0,n){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(a=0;a<Fr.length;a++)Ae(Fr[a],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":hu(r,i),Ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ae("invalid",r);break;case"textarea":pu(r,i),Ae("invalid",r)}co(n,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?r.textContent!==o&&(i.suppressHydrationWarning!==!0&&Va(r.textContent,o,e),a=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Va(r.textContent,o,e),a=["children",""+o]):ea.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&Ae("scroll",r)}switch(n){case"input":Pa(r),fu(r,i,!0);break;case"textarea":Pa(r),mu(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=_i)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sh(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[gn]=t,e[ua]=r,Ef(e,t,!1,!1),t.stateNode=e;e:{switch(l=uo(n,r),n){case"dialog":Ae("cancel",e),Ae("close",e),a=r;break;case"iframe":case"object":case"embed":Ae("load",e),a=r;break;case"video":case"audio":for(a=0;a<Fr.length;a++)Ae(Fr[a],e);a=r;break;case"source":Ae("error",e),a=r;break;case"img":case"image":case"link":Ae("error",e),Ae("load",e),a=r;break;case"details":Ae("toggle",e),a=r;break;case"input":hu(e,r),a=ro(e,r),Ae("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Me({},r,{value:void 0}),Ae("invalid",e);break;case"textarea":pu(e,r),a=lo(e,r),Ae("invalid",e);break;default:a=r}co(n,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?ih(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&rh(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ta(e,c):typeof c=="number"&&ta(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ea.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ae("scroll",e):c!=null&&lc(e,i,c,l))}switch(n){case"input":Pa(e),fu(e,r,!1);break;case"textarea":Pa(e),mu(e);break;case"option":r.value!=null&&e.setAttribute("value",""+cs(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?rr(e,!!r.multiple,i,!1):r.defaultValue!=null&&rr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=_i)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return lt(t),null;case 6:if(e&&t.stateNode!=null)Af(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(M(166));if(n=ks(ha.current),ks(xn.current),Fa(t)){if(r=t.stateNode,n=t.memoizedProps,r[gn]=t,(i=r.nodeValue!==n)&&(e=Dt,e!==null))switch(e.tag){case 3:Va(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Va(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[gn]=t,t.stateNode=r}return lt(t),null;case 13:if(Le(Pe),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Re&&Pt!==null&&t.mode&1&&!(t.flags&128))Qh(),hr(),t.flags|=98560,i=!1;else if(i=Fa(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(M(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(M(317));i[gn]=t}else hr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;lt(t),i=!1}else rn!==null&&(Ho(rn),rn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Pe.current&1?Ke===0&&(Ke=3):Fc())),t.updateQueue!==null&&(t.flags|=4),lt(t),null);case 4:return pr(),Io(e,t),e===null&&oa(t.stateNode.containerInfo),lt(t),null;case 10:return bc(t.type._context),lt(t),null;case 17:return bt(t.type)&&Si(),lt(t),null;case 19:if(Le(Pe),i=t.memoizedState,i===null)return lt(t),null;if(r=(t.flags&128)!==0,l=i.rendering,l===null)if(r)Ir(i,!1);else{if(Ke!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Li(e),l!==null){for(t.flags|=128,Ir(i,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Te(Pe,Pe.current&1|2),t.child}e=e.sibling}i.tail!==null&&$e()>gr&&(t.flags|=128,r=!0,Ir(i,!1),t.lanes=4194304)}else{if(!r)if(e=Li(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ir(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!Re)return lt(t),null}else 2*$e()-i.renderingStartTime>gr&&n!==1073741824&&(t.flags|=128,r=!0,Ir(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(n=i.last,n!==null?n.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=$e(),t.sibling=null,n=Pe.current,Te(Pe,r?n&1|2:n&1),t):(lt(t),null);case 22:case 23:return Vc(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Rt&1073741824&&(lt(t),t.subtreeFlags&6&&(t.flags|=8192)):lt(t),null;case 24:return null;case 25:return null}throw Error(M(156,t.tag))}function Kg(e,t){switch(wc(t),t.tag){case 1:return bt(t.type)&&Si(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pr(),Le(kt),Le(ct),Lc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ac(t),null;case 13:if(Le(Pe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(M(340));hr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Le(Pe),null;case 4:return pr(),null;case 10:return bc(t.type._context),null;case 22:case 23:return Vc(),null;case 24:return null;default:return null}}var qa=!1,ot=!1,Xg=typeof WeakSet=="function"?WeakSet:Set,q=null;function nr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ie(e,t,r)}else n.current=null}function Bo(e,t,n){try{n()}catch(r){Ie(e,t,r)}}var rd=!1;function Jg(e,t){if(No=ji,e=Ph(),jc(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var l=0,o=-1,c=-1,f=0,x=0,g=e,j=null;t:for(;;){for(var T;g!==n||a!==0&&g.nodeType!==3||(o=l+a),g!==i||r!==0&&g.nodeType!==3||(c=l+r),g.nodeType===3&&(l+=g.nodeValue.length),(T=g.firstChild)!==null;)j=g,g=T;for(;;){if(g===e)break t;if(j===n&&++f===a&&(o=l),j===i&&++x===r&&(c=l),(T=g.nextSibling)!==null)break;g=j,j=g.parentNode}g=T}n=o===-1||c===-1?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(wo={focusedElem:e,selectionRange:n},ji=!1,q=t;q!==null;)if(t=q,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,q=e;else for(;q!==null;){t=q;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var A=y.memoizedProps,w=y.memoizedState,d=t.stateNode,p=d.getSnapshotBeforeUpdate(t.elementType===t.type?A:tn(t.type,A),w);d.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(M(163))}}catch(S){Ie(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,q=e;break}q=t.return}return y=rd,rd=!1,y}function Xr(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Bo(t,n,i)}a=a.next}while(a!==r)}}function Yi(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function zo(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Lf(e){var t=e.alternate;t!==null&&(e.alternate=null,Lf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[gn],delete t[ua],delete t[ko],delete t[Pg],delete t[Dg])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Of(e){return e.tag===5||e.tag===3||e.tag===4}function ad(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Of(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $o(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=_i));else if(r!==4&&(e=e.child,e!==null))for($o(e,t,n),e=e.sibling;e!==null;)$o(e,t,n),e=e.sibling}function Uo(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Uo(e,t,n),e=e.sibling;e!==null;)Uo(e,t,n),e=e.sibling}var nt=null,nn=!1;function qn(e,t,n){for(n=n.child;n!==null;)Rf(e,t,n),n=n.sibling}function Rf(e,t,n){if(vn&&typeof vn.onCommitFiberUnmount=="function")try{vn.onCommitFiberUnmount(Ui,n)}catch{}switch(n.tag){case 5:ot||nr(n,t);case 6:var r=nt,a=nn;nt=null,qn(e,t,n),nt=r,nn=a,nt!==null&&(nn?(e=nt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):nt.removeChild(n.stateNode));break;case 18:nt!==null&&(nn?(e=nt,n=n.stateNode,e.nodeType===8?Dl(e.parentNode,n):e.nodeType===1&&Dl(e,n),aa(e)):Dl(nt,n.stateNode));break;case 4:r=nt,a=nn,nt=n.stateNode.containerInfo,nn=!0,qn(e,t,n),nt=r,nn=a;break;case 0:case 11:case 14:case 15:if(!ot&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Bo(n,t,l),a=a.next}while(a!==r)}qn(e,t,n);break;case 1:if(!ot&&(nr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ie(n,t,o)}qn(e,t,n);break;case 21:qn(e,t,n);break;case 22:n.mode&1?(ot=(r=ot)||n.memoizedState!==null,qn(e,t,n),ot=r):qn(e,t,n);break;default:qn(e,t,n)}}function id(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Xg),t.forEach(function(r){var a=lv.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function en(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:nt=o.stateNode,nn=!1;break e;case 3:nt=o.stateNode.containerInfo,nn=!0;break e;case 4:nt=o.stateNode.containerInfo,nn=!0;break e}o=o.return}if(nt===null)throw Error(M(160));Rf(i,l,a),nt=null,nn=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(f){Ie(a,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Pf(t,e),t=t.sibling}function Pf(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(en(t,e),pn(e),r&4){try{Xr(3,e,e.return),Yi(3,e)}catch(A){Ie(e,e.return,A)}try{Xr(5,e,e.return)}catch(A){Ie(e,e.return,A)}}break;case 1:en(t,e),pn(e),r&512&&n!==null&&nr(n,n.return);break;case 5:if(en(t,e),pn(e),r&512&&n!==null&&nr(n,n.return),e.flags&32){var a=e.stateNode;try{ta(a,"")}catch(A){Ie(e,e.return,A)}}if(r&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=n!==null?n.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&th(a,i),uo(o,l);var f=uo(o,i);for(l=0;l<c.length;l+=2){var x=c[l],g=c[l+1];x==="style"?ih(a,g):x==="dangerouslySetInnerHTML"?rh(a,g):x==="children"?ta(a,g):lc(a,x,g,f)}switch(o){case"input":ao(a,i);break;case"textarea":nh(a,i);break;case"select":var j=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var T=i.value;T!=null?rr(a,!!i.multiple,T,!1):j!==!!i.multiple&&(i.defaultValue!=null?rr(a,!!i.multiple,i.defaultValue,!0):rr(a,!!i.multiple,i.multiple?[]:"",!1))}a[ua]=i}catch(A){Ie(e,e.return,A)}}break;case 6:if(en(t,e),pn(e),r&4){if(e.stateNode===null)throw Error(M(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(A){Ie(e,e.return,A)}}break;case 3:if(en(t,e),pn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{aa(t.containerInfo)}catch(A){Ie(e,e.return,A)}break;case 4:en(t,e),pn(e);break;case 13:en(t,e),pn(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||($c=$e())),r&4&&id(e);break;case 22:if(x=n!==null&&n.memoizedState!==null,e.mode&1?(ot=(f=ot)||x,en(t,e),ot=f):en(t,e),pn(e),r&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!x&&e.mode&1)for(q=e,x=e.child;x!==null;){for(g=q=x;q!==null;){switch(j=q,T=j.child,j.tag){case 0:case 11:case 14:case 15:Xr(4,j,j.return);break;case 1:nr(j,j.return);var y=j.stateNode;if(typeof y.componentWillUnmount=="function"){r=j,n=j.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(A){Ie(r,n,A)}}break;case 5:nr(j,j.return);break;case 22:if(j.memoizedState!==null){od(g);continue}}T!==null?(T.return=j,q=T):od(g)}x=x.sibling}e:for(x=null,g=e;;){if(g.tag===5){if(x===null){x=g;try{a=g.stateNode,f?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=g.stateNode,c=g.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=ah("display",l))}catch(A){Ie(e,e.return,A)}}}else if(g.tag===6){if(x===null)try{g.stateNode.nodeValue=f?"":g.memoizedProps}catch(A){Ie(e,e.return,A)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;x===g&&(x=null),g=g.return}x===g&&(x=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:en(t,e),pn(e),r&4&&id(e);break;case 21:break;default:en(t,e),pn(e)}}function pn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Of(n)){var r=n;break e}n=n.return}throw Error(M(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(ta(a,""),r.flags&=-33);var i=ad(e);Uo(e,i,a);break;case 3:case 4:var l=r.stateNode.containerInfo,o=ad(e);$o(e,o,l);break;default:throw Error(M(161))}}catch(c){Ie(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Zg(e,t,n){q=e,Df(e)}function Df(e,t,n){for(var r=(e.mode&1)!==0;q!==null;){var a=q,i=a.child;if(a.tag===22&&r){var l=a.memoizedState!==null||qa;if(!l){var o=a.alternate,c=o!==null&&o.memoizedState!==null||ot;o=qa;var f=ot;if(qa=l,(ot=c)&&!f)for(q=a;q!==null;)l=q,c=l.child,l.tag===22&&l.memoizedState!==null?cd(a):c!==null?(c.return=l,q=c):cd(a);for(;i!==null;)q=i,Df(i),i=i.sibling;q=a,qa=o,ot=f}ld(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,q=i):ld(e)}}function ld(e){for(;q!==null;){var t=q;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ot||Yi(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!ot)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:tn(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Hu(t,i,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Hu(t,l,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var x=f.memoizedState;if(x!==null){var g=x.dehydrated;g!==null&&aa(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(M(163))}ot||t.flags&512&&zo(t)}catch(j){Ie(t,t.return,j)}}if(t===e){q=null;break}if(n=t.sibling,n!==null){n.return=t.return,q=n;break}q=t.return}}function od(e){for(;q!==null;){var t=q;if(t===e){q=null;break}var n=t.sibling;if(n!==null){n.return=t.return,q=n;break}q=t.return}}function cd(e){for(;q!==null;){var t=q;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Yi(4,t)}catch(c){Ie(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(c){Ie(t,a,c)}}var i=t.return;try{zo(t)}catch(c){Ie(t,i,c)}break;case 5:var l=t.return;try{zo(t)}catch(c){Ie(t,l,c)}}}catch(c){Ie(t,t.return,c)}if(t===e){q=null;break}var o=t.sibling;if(o!==null){o.return=t.return,q=o;break}q=t.return}}var ev=Math.ceil,Pi=Bn.ReactCurrentDispatcher,Bc=Bn.ReactCurrentOwner,Yt=Bn.ReactCurrentBatchConfig,ve=0,tt=null,Fe=null,st=0,Rt=0,sr=hs(0),Ke=0,ga=null,Ls=0,Ki=0,zc=0,Jr=null,_t=null,$c=0,gr=1/0,En=null,Di=!1,Vo=null,as=null,Qa=!1,Zn=null,Mi=0,Zr=0,Fo=null,oi=-1,ci=0;function gt(){return ve&6?$e():oi!==-1?oi:oi=$e()}function is(e){return e.mode&1?ve&2&&st!==0?st&-st:Ig.transition!==null?(ci===0&&(ci=xh()),ci):(e=be,e!==0||(e=window.event,e=e===void 0?16:kh(e.type)),e):1}function ln(e,t,n,r){if(50<Zr)throw Zr=0,Fo=null,Error(M(185));xa(e,n,r),(!(ve&2)||e!==tt)&&(e===tt&&(!(ve&2)&&(Ki|=n),Ke===4&&Xn(e,st)),Ct(e,r),n===1&&ve===0&&!(t.mode&1)&&(gr=$e()+500,qi&&fs()))}function Ct(e,t){var n=e.callbackNode;Im(e,t);var r=yi(e,e===tt?st:0);if(r===0)n!==null&&xu(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&xu(n),t===1)e.tag===0?Mg(ud.bind(null,e)):Wh(ud.bind(null,e)),Og(function(){!(ve&6)&&fs()}),n=null;else{switch(yh(r)){case 1:n=hc;break;case 4:n=gh;break;case 16:n=xi;break;case 536870912:n=vh;break;default:n=xi}n=Ff(n,Mf.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Mf(e,t){if(oi=-1,ci=0,ve&6)throw Error(M(327));var n=e.callbackNode;if(cr()&&e.callbackNode!==n)return null;var r=yi(e,e===tt?st:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ii(e,r);else{t=r;var a=ve;ve|=2;var i=Bf();(tt!==e||st!==t)&&(En=null,gr=$e()+500,bs(e,t));do try{sv();break}catch(o){If(e,o)}while(!0);kc(),Pi.current=i,ve=a,Fe!==null?t=0:(tt=null,st=0,t=Ke)}if(t!==0){if(t===2&&(a=go(e),a!==0&&(r=a,t=Wo(e,a))),t===1)throw n=ga,bs(e,0),Xn(e,r),Ct(e,$e()),n;if(t===6)Xn(e,r);else{if(a=e.current.alternate,!(r&30)&&!tv(a)&&(t=Ii(e,r),t===2&&(i=go(e),i!==0&&(r=i,t=Wo(e,i))),t===1))throw n=ga,bs(e,0),Xn(e,r),Ct(e,$e()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(M(345));case 2:ws(e,_t,En);break;case 3:if(Xn(e,r),(r&130023424)===r&&(t=$c+500-$e(),10<t)){if(yi(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){gt(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=So(ws.bind(null,e,_t,En),t);break}ws(e,_t,En);break;case 4:if(Xn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var l=31-an(r);i=1<<l,l=t[l],l>a&&(a=l),r&=~i}if(r=a,r=$e()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ev(r/1960))-r,10<r){e.timeoutHandle=So(ws.bind(null,e,_t,En),r);break}ws(e,_t,En);break;case 5:ws(e,_t,En);break;default:throw Error(M(329))}}}return Ct(e,$e()),e.callbackNode===n?Mf.bind(null,e):null}function Wo(e,t){var n=Jr;return e.current.memoizedState.isDehydrated&&(bs(e,t).flags|=256),e=Ii(e,t),e!==2&&(t=_t,_t=n,t!==null&&Ho(t)),e}function Ho(e){_t===null?_t=e:_t.push.apply(_t,e)}function tv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!on(i(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xn(e,t){for(t&=~zc,t&=~Ki,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-an(t),r=1<<n;e[n]=-1,t&=~r}}function ud(e){if(ve&6)throw Error(M(327));cr();var t=yi(e,0);if(!(t&1))return Ct(e,$e()),null;var n=Ii(e,t);if(e.tag!==0&&n===2){var r=go(e);r!==0&&(t=r,n=Wo(e,r))}if(n===1)throw n=ga,bs(e,0),Xn(e,t),Ct(e,$e()),n;if(n===6)throw Error(M(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ws(e,_t,En),Ct(e,$e()),null}function Uc(e,t){var n=ve;ve|=1;try{return e(t)}finally{ve=n,ve===0&&(gr=$e()+500,qi&&fs())}}function Os(e){Zn!==null&&Zn.tag===0&&!(ve&6)&&cr();var t=ve;ve|=1;var n=Yt.transition,r=be;try{if(Yt.transition=null,be=1,e)return e()}finally{be=r,Yt.transition=n,ve=t,!(ve&6)&&fs()}}function Vc(){Rt=sr.current,Le(sr)}function bs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Lg(n)),Fe!==null)for(n=Fe.return;n!==null;){var r=n;switch(wc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Si();break;case 3:pr(),Le(kt),Le(ct),Lc();break;case 5:Ac(r);break;case 4:pr();break;case 13:Le(Pe);break;case 19:Le(Pe);break;case 10:bc(r.type._context);break;case 22:case 23:Vc()}n=n.return}if(tt=e,Fe=e=ls(e.current,null),st=Rt=t,Ke=0,ga=null,zc=Ki=Ls=0,_t=Jr=null,Ss!==null){for(t=0;t<Ss.length;t++)if(n=Ss[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var l=i.next;i.next=a,r.next=l}n.pending=r}Ss=null}return e}function If(e,t){do{var n=Fe;try{if(kc(),ai.current=Ri,Oi){for(var r=De.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Oi=!1}if(As=0,et=Ye=De=null,Kr=!1,fa=0,Bc.current=null,n===null||n.return===null){Ke=1,ga=t,Fe=null;break}e:{var i=e,l=n.return,o=n,c=t;if(t=st,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var f=c,x=o,g=x.tag;if(!(x.mode&1)&&(g===0||g===11||g===15)){var j=x.alternate;j?(x.updateQueue=j.updateQueue,x.memoizedState=j.memoizedState,x.lanes=j.lanes):(x.updateQueue=null,x.memoizedState=null)}var T=Xu(l);if(T!==null){T.flags&=-257,Ju(T,l,o,i,t),T.mode&1&&Ku(i,f,t),t=T,c=f;var y=t.updateQueue;if(y===null){var A=new Set;A.add(c),t.updateQueue=A}else y.add(c);break e}else{if(!(t&1)){Ku(i,f,t),Fc();break e}c=Error(M(426))}}else if(Re&&o.mode&1){var w=Xu(l);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Ju(w,l,o,i,t),_c(mr(c,o));break e}}i=c=mr(c,o),Ke!==4&&(Ke=2),Jr===null?Jr=[i]:Jr.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var d=jf(i,c,t);Wu(i,d);break e;case 1:o=c;var p=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(as===null||!as.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var S=Nf(i,o,t);Wu(i,S);break e}}i=i.return}while(i!==null)}$f(n)}catch(P){t=P,Fe===n&&n!==null&&(Fe=n=n.return);continue}break}while(!0)}function Bf(){var e=Pi.current;return Pi.current=Ri,e===null?Ri:e}function Fc(){(Ke===0||Ke===3||Ke===2)&&(Ke=4),tt===null||!(Ls&268435455)&&!(Ki&268435455)||Xn(tt,st)}function Ii(e,t){var n=ve;ve|=2;var r=Bf();(tt!==e||st!==t)&&(En=null,bs(e,t));do try{nv();break}catch(a){If(e,a)}while(!0);if(kc(),ve=n,Pi.current=r,Fe!==null)throw Error(M(261));return tt=null,st=0,Ke}function nv(){for(;Fe!==null;)zf(Fe)}function sv(){for(;Fe!==null&&!Em();)zf(Fe)}function zf(e){var t=Vf(e.alternate,e,Rt);e.memoizedProps=e.pendingProps,t===null?$f(e):Fe=t,Bc.current=null}function $f(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Kg(n,t),n!==null){n.flags&=32767,Fe=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ke=6,Fe=null;return}}else if(n=Yg(n,t,Rt),n!==null){Fe=n;return}if(t=t.sibling,t!==null){Fe=t;return}Fe=t=e}while(t!==null);Ke===0&&(Ke=5)}function ws(e,t,n){var r=be,a=Yt.transition;try{Yt.transition=null,be=1,rv(e,t,n,r)}finally{Yt.transition=a,be=r}return null}function rv(e,t,n,r){do cr();while(Zn!==null);if(ve&6)throw Error(M(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(M(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(Bm(e,i),e===tt&&(Fe=tt=null,st=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Qa||(Qa=!0,Ff(xi,function(){return cr(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Yt.transition,Yt.transition=null;var l=be;be=1;var o=ve;ve|=4,Bc.current=null,Jg(e,n),Pf(n,e),Sg(wo),ji=!!No,wo=No=null,e.current=n,Zg(n),Tm(),ve=o,be=l,Yt.transition=i}else e.current=n;if(Qa&&(Qa=!1,Zn=e,Mi=a),i=e.pendingLanes,i===0&&(as=null),Om(n.stateNode),Ct(e,$e()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Di)throw Di=!1,e=Vo,Vo=null,e;return Mi&1&&e.tag!==0&&cr(),i=e.pendingLanes,i&1?e===Fo?Zr++:(Zr=0,Fo=e):Zr=0,fs(),null}function cr(){if(Zn!==null){var e=yh(Mi),t=Yt.transition,n=be;try{if(Yt.transition=null,be=16>e?16:e,Zn===null)var r=!1;else{if(e=Zn,Zn=null,Mi=0,ve&6)throw Error(M(331));var a=ve;for(ve|=4,q=e.current;q!==null;){var i=q,l=i.child;if(q.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var f=o[c];for(q=f;q!==null;){var x=q;switch(x.tag){case 0:case 11:case 15:Xr(8,x,i)}var g=x.child;if(g!==null)g.return=x,q=g;else for(;q!==null;){x=q;var j=x.sibling,T=x.return;if(Lf(x),x===f){q=null;break}if(j!==null){j.return=T,q=j;break}q=T}}}var y=i.alternate;if(y!==null){var A=y.child;if(A!==null){y.child=null;do{var w=A.sibling;A.sibling=null,A=w}while(A!==null)}}q=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,q=l;else e:for(;q!==null;){if(i=q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Xr(9,i,i.return)}var d=i.sibling;if(d!==null){d.return=i.return,q=d;break e}q=i.return}}var p=e.current;for(q=p;q!==null;){l=q;var v=l.child;if(l.subtreeFlags&2064&&v!==null)v.return=l,q=v;else e:for(l=p;q!==null;){if(o=q,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Yi(9,o)}}catch(P){Ie(o,o.return,P)}if(o===l){q=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,q=S;break e}q=o.return}}if(ve=a,fs(),vn&&typeof vn.onPostCommitFiberRoot=="function")try{vn.onPostCommitFiberRoot(Ui,e)}catch{}r=!0}return r}finally{be=n,Yt.transition=t}}return!1}function dd(e,t,n){t=mr(n,t),t=jf(e,t,1),e=rs(e,t,1),t=gt(),e!==null&&(xa(e,1,t),Ct(e,t))}function Ie(e,t,n){if(e.tag===3)dd(e,e,n);else for(;t!==null;){if(t.tag===3){dd(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(as===null||!as.has(r))){e=mr(n,e),e=Nf(t,e,1),t=rs(t,e,1),e=gt(),t!==null&&(xa(t,1,e),Ct(t,e));break}}t=t.return}}function av(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=gt(),e.pingedLanes|=e.suspendedLanes&n,tt===e&&(st&n)===n&&(Ke===4||Ke===3&&(st&130023424)===st&&500>$e()-$c?bs(e,0):zc|=n),Ct(e,t)}function Uf(e,t){t===0&&(e.mode&1?(t=Ia,Ia<<=1,!(Ia&130023424)&&(Ia=4194304)):t=1);var n=gt();e=Mn(e,t),e!==null&&(xa(e,t,n),Ct(e,n))}function iv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Uf(e,n)}function lv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(M(314))}r!==null&&r.delete(t),Uf(e,n)}var Vf;Vf=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||kt.current)St=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return St=!1,Gg(e,t,n);St=!!(e.flags&131072)}else St=!1,Re&&t.flags&1048576&&Hh(t,Ci,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;li(e,t),e=t.pendingProps;var a=dr(t,ct.current);or(t,n),a=Rc(null,t,r,e,a,n);var i=Pc();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,bt(r)?(i=!0,ki(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Ec(t),a.updater=Gi,t.stateNode=a,a._reactInternals=t,Lo(t,r,e,n),t=Po(null,t,r,!0,i,n)):(t.tag=0,Re&&i&&Nc(t),mt(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(li(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=cv(r),e=tn(r,e),a){case 0:t=Ro(null,t,r,e,n);break e;case 1:t=td(null,t,r,e,n);break e;case 11:t=Zu(null,t,r,e,n);break e;case 14:t=ed(null,t,r,tn(r.type,e),n);break e}throw Error(M(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:tn(r,a),Ro(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:tn(r,a),td(e,t,r,a,n);case 3:e:{if(kf(t),e===null)throw Error(M(387));r=t.pendingProps,i=t.memoizedState,a=i.element,Xh(e,t),Ai(t,r,null,n);var l=t.memoizedState;if(r=l.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=mr(Error(M(423)),t),t=nd(e,t,r,n,a);break e}else if(r!==a){a=mr(Error(M(424)),t),t=nd(e,t,r,n,a);break e}else for(Pt=ss(t.stateNode.containerInfo.firstChild),Dt=t,Re=!0,rn=null,n=Yh(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(hr(),r===a){t=In(e,t,n);break e}mt(e,t,r,n)}t=t.child}return t;case 5:return Jh(t),e===null&&Eo(t),r=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,_o(r,a)?l=null:i!==null&&_o(r,i)&&(t.flags|=32),Sf(e,t),mt(e,t,l,n),t.child;case 6:return e===null&&Eo(t),null;case 13:return bf(e,t,n);case 4:return Tc(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=fr(t,null,r,n):mt(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:tn(r,a),Zu(e,t,r,a,n);case 7:return mt(e,t,t.pendingProps,n),t.child;case 8:return mt(e,t,t.pendingProps.children,n),t.child;case 12:return mt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,Te(Ei,r._currentValue),r._currentValue=l,i!==null)if(on(i.value,l)){if(i.children===a.children&&!kt.current){t=In(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var c=o.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Rn(-1,n&-n),c.tag=2;var f=i.updateQueue;if(f!==null){f=f.shared;var x=f.pending;x===null?c.next=c:(c.next=x.next,x.next=c),f.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),To(i.return,n,t),o.lanes|=n;break}c=c.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(M(341));l.lanes|=n,o=l.alternate,o!==null&&(o.lanes|=n),To(l,n,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}mt(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,or(t,n),a=Kt(a),r=r(a),t.flags|=1,mt(e,t,r,n),t.child;case 14:return r=t.type,a=tn(r,t.pendingProps),a=tn(r.type,a),ed(e,t,r,a,n);case 15:return wf(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:tn(r,a),li(e,t),t.tag=1,bt(r)?(e=!0,ki(t)):e=!1,or(t,n),yf(t,r,a),Lo(t,r,a,n),Po(null,t,r,!0,e,n);case 19:return Cf(e,t,n);case 22:return _f(e,t,n)}throw Error(M(156,t.tag))};function Ff(e,t){return mh(e,t)}function ov(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gt(e,t,n,r){return new ov(e,t,n,r)}function Wc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function cv(e){if(typeof e=="function")return Wc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===cc)return 11;if(e===uc)return 14}return 2}function ls(e,t){var n=e.alternate;return n===null?(n=Gt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ui(e,t,n,r,a,i){var l=2;if(r=e,typeof e=="function")Wc(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Qs:return Cs(n.children,a,i,t);case oc:l=8,a|=8;break;case eo:return e=Gt(12,n,t,a|2),e.elementType=eo,e.lanes=i,e;case to:return e=Gt(13,n,t,a),e.elementType=to,e.lanes=i,e;case no:return e=Gt(19,n,t,a),e.elementType=no,e.lanes=i,e;case Jd:return Xi(n,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Kd:l=10;break e;case Xd:l=9;break e;case cc:l=11;break e;case uc:l=14;break e;case Qn:l=16,r=null;break e}throw Error(M(130,e==null?e:typeof e,""))}return t=Gt(l,n,t,a),t.elementType=e,t.type=r,t.lanes=i,t}function Cs(e,t,n,r){return e=Gt(7,e,r,t),e.lanes=n,e}function Xi(e,t,n,r){return e=Gt(22,e,r,t),e.elementType=Jd,e.lanes=n,e.stateNode={isHidden:!1},e}function Fl(e,t,n){return e=Gt(6,e,null,t),e.lanes=n,e}function Wl(e,t,n){return t=Gt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function uv(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sl(0),this.expirationTimes=Sl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sl(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Hc(e,t,n,r,a,i,l,o,c){return e=new uv(e,t,n,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Gt(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ec(i),e}function dv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qs,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Wf(e){if(!e)return us;e=e._reactInternals;e:{if(Ps(e)!==e||e.tag!==1)throw Error(M(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(bt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(M(171))}if(e.tag===1){var n=e.type;if(bt(n))return Fh(e,n,t)}return t}function Hf(e,t,n,r,a,i,l,o,c){return e=Hc(n,r,!0,e,a,i,l,o,c),e.context=Wf(null),n=e.current,r=gt(),a=is(n),i=Rn(r,a),i.callback=t??null,rs(n,i,a),e.current.lanes=a,xa(e,a,r),Ct(e,r),e}function Ji(e,t,n,r){var a=t.current,i=gt(),l=is(a);return n=Wf(n),t.context===null?t.context=n:t.pendingContext=n,t=Rn(i,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=rs(a,t,l),e!==null&&(ln(e,a,l,i),ri(e,a,l)),l}function Bi(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function qc(e,t){hd(e,t),(e=e.alternate)&&hd(e,t)}function hv(){return null}var qf=typeof reportError=="function"?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}Zi.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(M(409));Ji(e,t,null,null)};Zi.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Os(function(){Ji(null,e,null,null)}),t[Dn]=null}};function Zi(e){this._internalRoot=e}Zi.prototype.unstable_scheduleHydration=function(e){if(e){var t=wh();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Kn.length&&t!==0&&t<Kn[n].priority;n++);Kn.splice(n,0,e),n===0&&Sh(e)}};function Gc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function el(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function fd(){}function fv(e,t,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var f=Bi(l);i.call(f)}}var l=Hf(t,r,e,0,null,!1,!1,"",fd);return e._reactRootContainer=l,e[Dn]=l.current,oa(e.nodeType===8?e.parentNode:e),Os(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var o=r;r=function(){var f=Bi(c);o.call(f)}}var c=Hc(e,0,!1,null,null,!1,!1,"",fd);return e._reactRootContainer=c,e[Dn]=c.current,oa(e.nodeType===8?e.parentNode:e),Os(function(){Ji(t,c,n,r)}),c}function tl(e,t,n,r,a){var i=n._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var o=a;a=function(){var c=Bi(l);o.call(c)}}Ji(t,l,e,a)}else l=fv(n,t,e,a,r);return Bi(l)}jh=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Vr(t.pendingLanes);n!==0&&(fc(t,n|1),Ct(t,$e()),!(ve&6)&&(gr=$e()+500,fs()))}break;case 13:Os(function(){var r=Mn(e,1);if(r!==null){var a=gt();ln(r,e,1,a)}}),qc(e,1)}};pc=function(e){if(e.tag===13){var t=Mn(e,134217728);if(t!==null){var n=gt();ln(t,e,134217728,n)}qc(e,134217728)}};Nh=function(e){if(e.tag===13){var t=is(e),n=Mn(e,t);if(n!==null){var r=gt();ln(n,e,t,r)}qc(e,t)}};wh=function(){return be};_h=function(e,t){var n=be;try{return be=e,t()}finally{be=n}};fo=function(e,t,n){switch(t){case"input":if(ao(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Hi(r);if(!a)throw Error(M(90));eh(r),ao(r,a)}}}break;case"textarea":nh(e,n);break;case"select":t=n.value,t!=null&&rr(e,!!n.multiple,t,!1)}};ch=Uc;uh=Os;var pv={usingClientEntryPoint:!1,Events:[ja,Xs,Hi,lh,oh,Uc]},Br={findFiberByHostInstance:_s,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mv={bundleType:Br.bundleType,version:Br.version,rendererPackageName:Br.rendererPackageName,rendererConfig:Br.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Bn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=fh(e),e===null?null:e.stateNode},findFiberByHostInstance:Br.findFiberByHostInstance||hv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ga=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ga.isDisabled&&Ga.supportsFiber)try{Ui=Ga.inject(mv),vn=Ga}catch{}}It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pv;It.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gc(t))throw Error(M(200));return dv(e,t,null,n)};It.createRoot=function(e,t){if(!Gc(e))throw Error(M(299));var n=!1,r="",a=qf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Hc(e,1,!1,null,null,n,!1,r,a),e[Dn]=t.current,oa(e.nodeType===8?e.parentNode:e),new Qc(t)};It.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(M(188)):(e=Object.keys(e).join(","),Error(M(268,e)));return e=fh(t),e=e===null?null:e.stateNode,e};It.flushSync=function(e){return Os(e)};It.hydrate=function(e,t,n){if(!el(t))throw Error(M(200));return tl(null,e,t,!0,n)};It.hydrateRoot=function(e,t,n){if(!Gc(e))throw Error(M(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",l=qf;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=Hf(t,null,e,1,n??null,a,!1,i,l),e[Dn]=t.current,oa(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Zi(t)};It.render=function(e,t,n){if(!el(t))throw Error(M(200));return tl(null,e,t,!1,n)};It.unmountComponentAtNode=function(e){if(!el(e))throw Error(M(40));return e._reactRootContainer?(Os(function(){tl(null,null,e,!1,function(){e._reactRootContainer=null,e[Dn]=null})}),!0):!1};It.unstable_batchedUpdates=Uc;It.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!el(n))throw Error(M(200));if(e==null||e._reactInternals===void 0)throw Error(M(38));return tl(e,t,n,!1,r)};It.version="18.3.1-next-f1338f8080-20240426";function Qf(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Qf)}catch(e){console.error(e)}}Qf(),qd.exports=It;var gv=qd.exports,Gf,pd=gv;Gf=pd.createRoot,pd.hydrateRoot;const vv="http://localhost:3000";let qo=localStorage.getItem("token");function Hs(e){qo=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}async function wa(e,t={}){const n={"Content-Type":"application/json",...t.headers||{}};qo&&(n.Authorization=`Bearer ${qo}`);const r=await fetch(`${vv}${e}`,{...t,headers:n});if(!r.ok){const i=(await r.json().catch(()=>({}))).error||"request_failed";throw new Error(i)}return r.json()}function ce(e){return wa(e,{method:"GET"})}function ke(e,t){return wa(e,{method:"POST",body:JSON.stringify(t||{})})}function Ge(e,t){return wa(e,{method:"PATCH",body:JSON.stringify(t||{})})}function Qo(e,t){return wa(e,{method:"PUT",body:JSON.stringify(t||{})})}function Yn(e){return wa(e,{method:"DELETE"})}const jn=Object.create(null);jn.open="0";jn.close="1";jn.ping="2";jn.pong="3";jn.message="4";jn.upgrade="5";jn.noop="6";const di=Object.create(null);Object.keys(jn).forEach(e=>{di[jn[e]]=e});const Go={type:"error",data:"parser error"},Yf=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Kf=typeof ArrayBuffer=="function",Xf=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Yc=({type:e,data:t},n,r)=>Yf&&t instanceof Blob?n?r(t):md(t,r):Kf&&(t instanceof ArrayBuffer||Xf(t))?n?r(t):md(new Blob([t]),r):r(jn[e]+(t||"")),md=(e,t)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];t("b"+(r||""))},n.readAsDataURL(e)};function gd(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Hl;function xv(e,t){if(Yf&&e.data instanceof Blob)return e.data.arrayBuffer().then(gd).then(t);if(Kf&&(e.data instanceof ArrayBuffer||Xf(e.data)))return t(gd(e.data));Yc(e,!1,n=>{Hl||(Hl=new TextEncoder),t(Hl.encode(n))})}const vd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wr=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<vd.length;e++)Wr[vd.charCodeAt(e)]=e;const yv=e=>{let t=e.length*.75,n=e.length,r,a=0,i,l,o,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const f=new ArrayBuffer(t),x=new Uint8Array(f);for(r=0;r<n;r+=4)i=Wr[e.charCodeAt(r)],l=Wr[e.charCodeAt(r+1)],o=Wr[e.charCodeAt(r+2)],c=Wr[e.charCodeAt(r+3)],x[a++]=i<<2|l>>4,x[a++]=(l&15)<<4|o>>2,x[a++]=(o&3)<<6|c&63;return f},jv=typeof ArrayBuffer=="function",Kc=(e,t)=>{if(typeof e!="string")return{type:"message",data:Jf(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:Nv(e.substring(1),t)}:di[n]?e.length>1?{type:di[n],data:e.substring(1)}:{type:di[n]}:Go},Nv=(e,t)=>{if(jv){const n=yv(e);return Jf(n,t)}else return{base64:!0,data:e}},Jf=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Zf="",wv=(e,t)=>{const n=e.length,r=new Array(n);let a=0;e.forEach((i,l)=>{Yc(i,!1,o=>{r[l]=o,++a===n&&t(r.join(Zf))})})},_v=(e,t)=>{const n=e.split(Zf),r=[];for(let a=0;a<n.length;a++){const i=Kc(n[a],t);if(r.push(i),i.type==="error")break}return r};function Sv(){return new TransformStream({transform(e,t){xv(e,n=>{const r=n.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const i=new DataView(a.buffer);i.setUint8(0,126),i.setUint16(1,r)}else{a=new Uint8Array(9);const i=new DataView(a.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(a[0]|=128),t.enqueue(a),t.enqueue(n)})}})}let ql;function Ya(e){return e.reduce((t,n)=>t+n.length,0)}function Ka(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let a=0;a<t;a++)n[a]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function kv(e,t){ql||(ql=new TextDecoder);const n=[];let r=0,a=-1,i=!1;return new TransformStream({transform(l,o){for(n.push(l);;){if(r===0){if(Ya(n)<1)break;const c=Ka(n,1);i=(c[0]&128)===128,a=c[0]&127,a<126?r=3:a===126?r=1:r=2}else if(r===1){if(Ya(n)<2)break;const c=Ka(n,2);a=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(Ya(n)<8)break;const c=Ka(n,8),f=new DataView(c.buffer,c.byteOffset,c.length),x=f.getUint32(0);if(x>Math.pow(2,21)-1){o.enqueue(Go);break}a=x*Math.pow(2,32)+f.getUint32(4),r=3}else{if(Ya(n)<a)break;const c=Ka(n,a);o.enqueue(Kc(i?c:ql.decode(c),t)),r=0}if(a===0||a>e){o.enqueue(Go);break}}}})}const ep=4;function We(e){if(e)return bv(e)}function bv(e){for(var t in We.prototype)e[t]=We.prototype[t];return e}We.prototype.on=We.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};We.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};We.prototype.off=We.prototype.removeListener=We.prototype.removeAllListeners=We.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,a=0;a<n.length;a++)if(r=n[a],r===t||r.fn===t){n.splice(a,1);break}return n.length===0&&delete this._callbacks["$"+e],this};We.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,a=n.length;r<a;++r)n[r].apply(this,t)}return this};We.prototype.emitReserved=We.prototype.emit;We.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};We.prototype.hasListeners=function(e){return!!this.listeners(e).length};const nl=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),Qt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Cv="arraybuffer";function tp(e,...t){return t.reduce((n,r)=>(e.hasOwnProperty(r)&&(n[r]=e[r]),n),{})}const Ev=Qt.setTimeout,Tv=Qt.clearTimeout;function sl(e,t){t.useNativeTimers?(e.setTimeoutFn=Ev.bind(Qt),e.clearTimeoutFn=Tv.bind(Qt)):(e.setTimeoutFn=Qt.setTimeout.bind(Qt),e.clearTimeoutFn=Qt.clearTimeout.bind(Qt))}const Av=1.33;function Lv(e){return typeof e=="string"?Ov(e):Math.ceil((e.byteLength||e.size)*Av)}function Ov(e){let t=0,n=0;for(let r=0,a=e.length;r<a;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function np(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Rv(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function Pv(e){let t={},n=e.split("&");for(let r=0,a=n.length;r<a;r++){let i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class Dv extends Error{constructor(t,n,r){super(t),this.description=n,this.context=r,this.type="TransportError"}}class Xc extends We{constructor(t){super(),this.writable=!1,sl(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,r){return super.emitReserved("error",new Dv(t,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=Kc(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=Rv(t);return n.length?"?"+n:""}}class Mv extends Xc{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};_v(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,wv(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=np()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let sp=!1;try{sp=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Iv=sp;function Bv(){}class zv extends Mv{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,n){const r=this.request({method:"POST",data:t});r.on("success",n),r.on("error",(a,i)=>{this.onError("xhr post error",a,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=t}}class yn extends We{constructor(t,n,r){super(),this.createRequest=t,sl(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const n=tp(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&r.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var a;r.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=yn.requestsCount++,yn.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Bv,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete yn.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}yn.requestsCount=0;yn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",xd);else if(typeof addEventListener=="function"){const e="onpagehide"in Qt?"pagehide":"unload";addEventListener(e,xd,!1)}}function xd(){for(let e in yn.requests)yn.requests.hasOwnProperty(e)&&yn.requests[e].abort()}const $v=function(){const e=rp({xdomain:!1});return e&&e.responseType!==null}();class Uv extends zv{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=$v&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new yn(rp,this.uri(),t)}}function rp(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Iv))return new XMLHttpRequest}catch{}if(!t)try{return new Qt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const ap=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Vv extends Xc{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,r=ap?{}:tp(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,r)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;Yc(r,this.supportsBinary,i=>{try{this.doWrite(r,i)}catch{}a&&nl(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=np()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const Ql=Qt.WebSocket||Qt.MozWebSocket;class Fv extends Vv{createSocket(t,n,r){return ap?new Ql(t,n,r):n?new Ql(t,n):new Ql(t)}doWrite(t,n){this.ws.send(n)}}class Wv extends Xc{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=kv(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),a=Sv();a.readable.pipeTo(t.writable),this._writer=a.writable.getWriter();const i=()=>{r.read().then(({done:o,value:c})=>{o||(this.onPacket(c),i())}).catch(o=>{})};i();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;this._writer.write(r).then(()=>{a&&nl(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const Hv={websocket:Fv,webtransport:Wv,polling:Uv},qv=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Qv=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Yo(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");n!=-1&&r!=-1&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let a=qv.exec(e||""),i={},l=14;for(;l--;)i[Qv[l]]=a[l]||"";return n!=-1&&r!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=Gv(i,i.path),i.queryKey=Yv(i,i.query),i}function Gv(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function Yv(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,a,i){a&&(n[a]=i)}),n}const Ko=typeof addEventListener=="function"&&typeof removeEventListener=="function",hi=[];Ko&&addEventListener("offline",()=>{hi.forEach(e=>e())},!1);class os extends We{constructor(t,n){if(super(),this.binaryType=Cv,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const r=Yo(t);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=Yo(n.host).host);sl(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const a=r.prototype.name;this.transports.push(a),this._transportsByName[a]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Pv(this.opts.query)),Ko&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},hi.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=ep,n.transport=t,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&os.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",os.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const a=this.writeBuffer[r].data;if(a&&(n+=Lv(a)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,nl(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,r){return this._sendPacket("message",t,n,r),this}send(t,n,r){return this._sendPacket("message",t,n,r),this}_sendPacket(t,n,r,a){if(typeof n=="function"&&(a=n,n=void 0),typeof r=="function"&&(a=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:t,data:n,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(os.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ko&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=hi.indexOf(this._offlineEventListener);r!==-1&&hi.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}os.protocol=ep;class Kv extends os{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),r=!1;os.priorWebsocketSuccess=!1;const a=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",g=>{if(!r)if(g.type==="pong"&&g.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;os.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(x(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const j=new Error("probe error");j.transport=n.name,this.emitReserved("upgradeError",j)}}))};function i(){r||(r=!0,x(),n.close(),n=null)}const l=g=>{const j=new Error("probe error: "+g);j.transport=n.name,i(),this.emitReserved("upgradeError",j)};function o(){l("transport closed")}function c(){l("socket closed")}function f(g){n&&g.name!==n.name&&i()}const x=()=>{n.removeListener("open",a),n.removeListener("error",l),n.removeListener("close",o),this.off("close",c),this.off("upgrading",f)};n.once("open",a),n.once("error",l),n.once("close",o),this.once("close",c),this.once("upgrading",f),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}let Xv=class extends Kv{constructor(t,n={}){const r=typeof t=="object"?t:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(a=>Hv[a]).filter(a=>!!a)),super(t,r)}};function Jv(e,t="",n){let r=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),r=Yo(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}const Zv=typeof ArrayBuffer=="function",ex=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,ip=Object.prototype.toString,tx=typeof Blob=="function"||typeof Blob<"u"&&ip.call(Blob)==="[object BlobConstructor]",nx=typeof File=="function"||typeof File<"u"&&ip.call(File)==="[object FileConstructor]";function Jc(e){return Zv&&(e instanceof ArrayBuffer||ex(e))||tx&&e instanceof Blob||nx&&e instanceof File}function fi(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(fi(e[n]))return!0;return!1}if(Jc(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return fi(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&fi(e[n]))return!0;return!1}function sx(e){const t=[],n=e.data,r=e;return r.data=Xo(n,t),r.attachments=t.length,{packet:r,buffers:t}}function Xo(e,t){if(!e)return e;if(Jc(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=Xo(e[r],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=Xo(e[r],t));return n}return e}function rx(e,t){return e.data=Jo(e.data,t),delete e.attachments,e}function Jo(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=Jo(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Jo(e[n],t));return e}const lp=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],ax=5;var oe;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(oe||(oe={}));class ix{constructor(t){this.replacer=t}encode(t){return(t.type===oe.EVENT||t.type===oe.ACK)&&fi(t)?this.encodeAsBinary({type:t.type===oe.EVENT?oe.BINARY_EVENT:oe.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===oe.BINARY_EVENT||t.type===oe.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=sx(t),r=this.encodeAsString(n.packet),a=n.buffers;return a.unshift(r),a}}class Zc extends We{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const r=n.type===oe.BINARY_EVENT;r||n.type===oe.BINARY_ACK?(n.type=r?oe.EVENT:oe.ACK,this.reconstructor=new lx(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(Jc(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const r={type:Number(t.charAt(0))};if(oe[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===oe.BINARY_EVENT||r.type===oe.BINARY_ACK){const i=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const l=t.substring(i,n);if(l!=Number(l)||t.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(l)}if(t.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););r.nsp=t.substring(i,n)}else r.nsp="/";const a=t.charAt(n+1);if(a!==""&&Number(a)==a){const i=n+1;for(;++n;){const l=t.charAt(n);if(l==null||Number(l)!=l){--n;break}if(n===t.length)break}r.id=Number(t.substring(i,n+1))}if(t.charAt(++n)){const i=this.tryParse(t.substr(n));if(Zc.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case oe.CONNECT:return zi(n);case oe.DISCONNECT:return n===void 0;case oe.CONNECT_ERROR:return typeof n=="string"||zi(n);case oe.EVENT:case oe.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&lp.indexOf(n[0])===-1);case oe.ACK:case oe.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class lx{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=rx(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function ox(e){return typeof e=="string"}const cx=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};function ux(e){return e===void 0||cx(e)}function zi(e){return Object.prototype.toString.call(e)==="[object Object]"}function dx(e,t){switch(e){case oe.CONNECT:return t===void 0||zi(t);case oe.DISCONNECT:return t===void 0;case oe.EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&lp.indexOf(t[0])===-1);case oe.ACK:return Array.isArray(t);case oe.CONNECT_ERROR:return typeof t=="string"||zi(t);default:return!1}}function hx(e){return ox(e.nsp)&&ux(e.id)&&dx(e.type,e.data)}const fx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Zc,Encoder:ix,get PacketType(){return oe},isPacketValid:hx,protocol:ax},Symbol.toStringTag,{value:"Module"}));function sn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const px=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class op extends We{constructor(t,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[sn(t,"open",this.onopen.bind(this)),sn(t,"packet",this.onpacket.bind(this)),sn(t,"error",this.onerror.bind(this)),sn(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var r,a,i;if(px.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const l={type:oe.EVENT,data:n};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const x=this.ids++,g=n.pop();this._registerAckCallback(x,g),l.id=x}const o=(a=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||a===void 0?void 0:a.writable,c=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!o||(c?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(t,n){var r;const a=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(a===void 0){this.acks[t]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);n.call(this,new Error("operation has timed out"))},a),l=(...o)=>{this.io.clearTimeoutFn(i),n.apply(this,o)};l.withError=!0,this.acks[t]=l}emitWithAck(t,...n){return new Promise((r,a)=>{const i=(l,o)=>l?a(l):r(o);i.withError=!0,n.push(i),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((a,...i)=>(this._queue[0],a!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(a)):(this._queue.shift(),n&&n(null,...i)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:oe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case oe.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case oe.EVENT:case oe.BINARY_EVENT:this.onevent(t);break;case oe.ACK:case oe.BINARY_ACK:this.onack(t);break;case oe.DISCONNECT:this.ondisconnect();break;case oe.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let r=!1;return function(...a){r||(r=!0,n.packet({type:oe.ACK,id:t,data:a}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:oe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,t.data)}}}function jr(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}jr.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};jr.prototype.reset=function(){this.attempts=0};jr.prototype.setMin=function(e){this.ms=e};jr.prototype.setMax=function(e){this.max=e};jr.prototype.setJitter=function(e){this.jitter=e};class Zo extends We{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,sl(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new jr({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const a=n.parser||fx;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Xv(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const a=sn(n,"open",function(){r.onopen(),t&&t()}),i=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),t?t(o):this.maybeReconnectOnOpen()},l=sn(n,"error",i);if(this._timeout!==!1){const o=this._timeout,c=this.setTimeoutFn(()=>{a(),i(new Error("timeout")),n.close()},o);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(a),this.subs.push(l),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(sn(t,"ping",this.onping.bind(this)),sn(t,"data",this.ondata.bind(this)),sn(t,"error",this.onerror.bind(this)),sn(t,"close",this.onclose.bind(this)),sn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){nl(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new op(this,t,n),this.nsps[t]=r),r}_destroy(t){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let r=0;r<n.length;r++)this.engine.write(n[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(a=>{a?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",a)):t.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const zr={};function pi(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=Jv(e,t.path||"/socket.io"),r=n.source,a=n.id,i=n.path,l=zr[a]&&i in zr[a].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||l;let c;return o?c=new Zo(r,t):(zr[a]||(zr[a]=new Zo(r,t)),c=zr[a]),n.query&&!t.query&&(t.query=n.queryKey),c.socket(n.path,t)}Object.assign(pi,{Manager:Zo,Socket:op,io:pi,connect:pi});const mx="http://localhost:3000";function gx(e){return pi(mx,{auth:{token:e}})}const cp=m.createContext(null);function vx({children:e}){const[t,n]=m.useState([]),r=m.useRef(new Map),a=o=>{n(f=>f.filter(x=>x.id!==o));const c=r.current.get(o);c&&(clearTimeout(c),r.current.delete(o))},i=({message:o,type:c="success",actionLabel:f,onAction:x,duration:g=6e3})=>{const j=`${Date.now()}-${Math.random().toString(36).slice(2,8)}`;if(n(T=>[...T,{id:j,message:o,type:c,actionLabel:f,onAction:x,duration:g}]),g>0){const T=setTimeout(()=>a(j),g);r.current.set(j,T)}return j},l=o=>o==="error"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 4.5c.5 0 .95.26 1.2.68l6.5 11.25a1.35 1.35 0 0 1-1.2 2.02H5.5a1.35 1.35 0 0 1-1.2-2.02L10.8 5.18c.25-.42.7-.68 1.2-.68Zm0 4.25a.9.9 0 0 0-.9.9v5.5a.9.9 0 1 0 1.8 0v-5.5a.9.9 0 0 0-.9-.9Zm0 8.3a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Z",fill:"currentColor"})}):o==="info"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 3.5a8.5 8.5 0 1 1 0 17 8.5 8.5 0 0 1 0-17Zm0 3.9a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Zm-1.2 4.2h2.4v6.1h-2.4v-6.1Z",fill:"currentColor"})}):s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M9.5 16.6 5.6 12.7a1 1 0 1 1 1.4-1.4l2.5 2.5 7.5-7.5a1 1 0 1 1 1.4 1.4l-8.9 8.9a1 1 0 0 1-1.4 0Z",fill:"currentColor"})});return s.jsxs(cp.Provider,{value:{pushToast:i,removeToast:a},children:[e,s.jsx("div",{className:"toast-container",children:t.map(o=>s.jsxs("div",{className:`toast toast-${o.type}`,style:{"--toast-duration":`${o.duration}ms`},children:[s.jsx("div",{className:"toast-icon",children:l(o.type)}),s.jsx("div",{className:"toast-message",children:o.message}),o.actionLabel&&s.jsx("button",{className:"toast-action",type:"button",onClick:()=>{o.onAction&&Promise.resolve(o.onAction()).catch(()=>{}),a(o.id)},children:o.actionLabel}),s.jsx("button",{className:"toast-close",type:"button",onClick:()=>a(o.id),children:"x"}),o.duration>0&&s.jsx("div",{className:`toast-progress toast-progress-${o.type}`})]},o.id))})]})}function eu(){const e=m.useContext(cp);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function xx({user:e,isOpen:t,onToggle:n,onLogout:r,onReturnToSuperadmin:a,showReturnToSuperadmin:i,getInitial:l}){return s.jsxs("div",{className:"rail-profile",children:[s.jsx("button",{className:`profile-button ${t?"active":""}`,type:"button",onClick:n,title:"Perfil","aria-label":"Perfil",children:s.jsx("span",{children:l(e.name)})}),t&&s.jsxs("div",{className:"profile-card",children:[s.jsx("div",{className:"profile-title",children:e.name}),s.jsx("div",{className:"profile-meta",children:e.email||"Sin correo"}),s.jsx("div",{className:"profile-role",children:e.role}),i?s.jsx("button",{className:"ghost",type:"button",onClick:a,children:"Volver a superadmin"}):null,s.jsx("button",{className:"primary",type:"button",onClick:r,children:"Salir"})]})]})}function yx({navItems:e,view:t,onSetView:n,theme:r,onToggleTheme:a,user:i,logoUrl:l,brandName:o,isProfileOpen:c,onToggleProfile:f,onLogout:x,onReturnToSuperadmin:g,showReturnToSuperadmin:j,getInitial:T,SunIcon:y,MoonIcon:A}){const w=(o||"P").trim().charAt(0)||"P";return s.jsxs("aside",{className:"nav-rail",children:[s.jsx("button",{className:"rail-logo",type:"button",title:"Perzivalh",children:l?s.jsx("img",{src:l,alt:o||"Logo"}):s.jsx("span",{className:"logo-mark",children:w})}),s.jsx("nav",{className:"rail-nav",children:e.map(d=>{const p=d.icon;return s.jsx("button",{className:`rail-button ${t===d.id?"active":""}`,onClick:()=>d.enabled&&n(d.id),title:d.label,"aria-label":d.label,type:"button",disabled:!d.enabled,children:s.jsx(p,{className:"rail-icon"})},d.id)})}),s.jsx("div",{className:"rail-spacer"}),s.jsx("button",{className:"rail-button",type:"button",onClick:a,title:r==="dark"?"Tema claro":"Tema oscuro","aria-label":r==="dark"?"Tema claro":"Tema oscuro",children:r==="dark"?s.jsx(y,{className:"rail-icon"}):s.jsx(A,{className:"rail-icon"})}),s.jsx(xx,{user:i,isOpen:c,onToggle:f,onLogout:x,onReturnToSuperadmin:g,showReturnToSuperadmin:j,getInitial:T})]})}function jx({activeConversation:e,conversations:t,channels:n,brandName:r,lastReadMap:a,filters:i,showFilters:l,users:o,tags:c,statusOptions:f,statusLabels:x,formatListTime:g,formatCompactDate:j,messageBlocks:T,messageDraft:y,messageMode:A,quickActions:w,tagInput:d,noteInput:p,notesList:v,latestNote:S,loadingConversation:P,isInfoOpen:N,hasUnread:D,activeName:E,activePhone:$,activeStatusLabel:F,canManageStatus:te,currentUser:he,messageInputRef:xe,chatBodyRef:Be,setShowFilters:we,setFilters:pe,loadConversation:Oe,handleBackToList:B,setIsInfoOpen:H,handleChatScroll:b,handleAssignSelf:W,handleStatusChange:Y,handleToggleTag:Z,handleAddTag:C,setNoteInput:ee,handleAddNote:V,reassignUserId:U,setReassignUserId:re,handleReassignConversation:me,handleOpenTagManager:de,handleCloseTagManager:ye,showTagManager:Xe,tagManagerForm:Je,setTagManagerForm:at,handleCreateTag:Et,handleDeleteTag:Ue,handleQuickAction:Ve,handleSendMessage:He,setMessageMode:Jt,setMessageDraft:Tt,scrollChatToBottom:K,getInitial:Ce,PlusIcon:yt,SearchIcon:ut,VideoIcon:Nn,PhoneIcon:Ze,InfoIcon:wn,SendIcon:zn}){const Zt=new Map((n||[]).map(L=>[L.phone_number_id,L.display_name||(L.phone_number_id?`Linea ${String(L.phone_number_id).slice(-4)}`:"")])),Ee=(e==null?void 0:e.assigned_user_id)&&e.assigned_user_id!==(he==null?void 0:he.id);function zt(L){if(!L)return"Sin mensajes";const Se=L.last_message_preview||L.last_message_text||L.last_message||"";return Se||(L.last_message_type?`[${L.last_message_type}]`:"Sin mensajes")}return s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:`chat-shell ${e?"has-active":""}`,children:[s.jsxs("aside",{className:"chat-list-panel",children:[s.jsxs("div",{className:"chat-list-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"list-title",children:(r||"Perzivalh").toUpperCase()}),s.jsx("div",{className:"list-subtitle",children:"Chats"})]}),s.jsx("button",{className:"icon-button add-chat",type:"button",title:"Nuevo chat",children:s.jsx(yt,{className:"icon"})})]}),s.jsxs("div",{className:"chat-search",children:[s.jsx(ut,{className:"search-icon"}),s.jsx("input",{type:"text",placeholder:"Buscar pacientes o mensajes",value:i.search,onFocus:()=>we(!0),onClick:()=>we(!0),onChange:L=>pe(Se=>({...Se,search:L.target.value}))}),l&&s.jsx("button",{className:"search-close",type:"button",onClick:()=>we(!1),"aria-label":"Cerrar filtros",children:"x"})]}),l&&s.jsxs("div",{className:"chat-filters",children:[s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Status"}),s.jsxs("select",{value:i.status,onChange:L=>pe(Se=>({...Se,status:L.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),f.map(L=>s.jsx("option",{value:L,children:x[L]||L},L))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Asignado"}),s.jsxs("select",{value:i.assigned_user_id,onChange:L=>pe(Se=>({...Se,assigned_user_id:L.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"unassigned",children:"Sin asignar"}),o.map(L=>s.jsx("option",{value:L.id,children:L.name},L.id))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Tags"}),s.jsxs("select",{value:i.tag,onChange:L=>pe(Se=>({...Se,tag:L.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),c.map(L=>s.jsx("option",{value:L.name,children:L.name},L.id))]})]})]}),s.jsxs("div",{className:"list-header",children:[s.jsxs("select",{className:"line-filter",value:i.phone_number_id,onChange:L=>pe(Se=>({...Se,phone_number_id:L.target.value})),children:[s.jsx("option",{value:"",children:"Todas las lineas"}),(n||[]).map(L=>s.jsx("option",{value:L.phone_number_id,children:L.display_name||`Linea ${String(L.phone_number_id).slice(-4)}`},L.id))]}),s.jsx("span",{children:t.length})]}),s.jsx("div",{className:"conversation-list",children:t.map((L,Se)=>{var Ut,ne,X;const ps=(e==null?void 0:e.id)===L.id,cn=L.status==="pending"&&!L.assigned_user_id,$t=L.display_name||L.phone_e164||L.wa_id||"Sin nombre",_=zt(L),z=Number(L.unread_count||L.unread_messages||L.unread||0),Q=((ne=(Ut=L.tags)==null?void 0:Ut[0])==null?void 0:ne.name)||"",se=(X=L.assigned_user)!=null&&X.name?`Tomada por ${L.assigned_user.name}`:"",je=L.phone_number_id?Zt.get(L.phone_number_id)||`Linea ${String(L.phone_number_id).slice(-4)}`:"",Ne=(a==null?void 0:a[L.id])||null,dt=L.last_message_at,qe=dt&&(!Ne||new Date(dt).getTime()>new Date(Ne).getTime())&&L.last_message_direction==="in";return s.jsxs("button",{className:`conversation-item ${ps?"active":""}`,onClick:()=>Oe(L.id),style:{animationDelay:`${Math.min(Se,6)*60}ms`},children:[s.jsxs("div",{className:"avatar",children:[s.jsx("span",{children:Ce($t)}),cn&&s.jsx("span",{className:"presence-dot"})]}),s.jsxs("div",{className:"conversation-body",children:[s.jsxs("div",{className:"conversation-row",children:[s.jsx("span",{className:"conversation-name",children:$t}),s.jsxs("div",{className:"conversation-right",children:[s.jsx("span",{className:"conversation-time",children:g(L.last_message_at)}),z>0&&s.jsx("span",{className:"conversation-unread",children:z})]})]}),s.jsx("div",{className:`conversation-preview ${qe?"unread":""}`,children:_}),s.jsxs("div",{className:"conversation-meta",children:[je&&s.jsx("span",{className:"status-pill line-pill",children:je}),se&&s.jsx("span",{className:"status-pill assignee-pill",children:se}),Q&&s.jsx("span",{className:"status-pill tag-pill",children:Q})]})]})]},L.id)})})]}),s.jsxs("div",{className:`chat-view ${N?"info-open":"info-closed"}`,children:[s.jsx("div",{className:"chat-main",children:s.jsxs("div",{className:"chat-card",children:[s.jsxs("header",{className:"chat-topbar",children:[s.jsxs("div",{className:"chat-title",children:[e&&s.jsx("button",{className:"back-button",type:"button",onClick:B,children:"Chats"}),s.jsx("div",{className:"chat-avatar",children:s.jsx("span",{children:Ce(E)})}),s.jsxs("div",{children:[s.jsx("div",{className:"chat-name",children:E}),e?s.jsx("div",{className:"chat-status",children:F}):s.jsx("div",{className:"chat-status muted",children:"Elige una conversacion"})]})]}),s.jsxs("div",{className:"chat-actions",children:[s.jsx("button",{className:"icon-button",type:"button",title:"Video",children:s.jsx(Nn,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Llamar",children:s.jsx(Ze,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Buscar",children:s.jsx(ut,{className:"icon"})}),s.jsx("button",{className:`icon-button ${N?"active":""}`,type:"button",title:"Info",onClick:()=>H(L=>!L),children:s.jsx(wn,{className:"icon"})})]})]}),s.jsxs("div",{className:"chat-body",ref:Be,onScroll:b,children:[P&&s.jsx("div",{className:"empty",children:"Cargando..."}),!P&&!e&&s.jsx("div",{className:"empty",children:"Selecciona una conversacion"}),!P&&e&&s.jsxs(s.Fragment,{children:[T.length?T:s.jsx("div",{className:"empty-state",children:"Sin mensajes"}),s.jsx("div",{className:"chat-encryption",children:"Los mensajes estan cifrados de extremo a extremo."})]})]}),D&&s.jsx("button",{className:"new-message-banner",type:"button",onClick:K,children:"Nuevos mensajes"}),s.jsxs("form",{className:"chat-composer",onSubmit:He,children:[Ee&&s.jsx("div",{className:"assign-warning",children:"Conversacion tomada por otro operador."}),s.jsx("div",{className:"quick-actions",children:w.map(L=>s.jsx("button",{className:"quick-action",type:"button",onClick:()=>Ve(L),disabled:Ee,children:L},L))}),s.jsxs("div",{className:"composer-row",children:[s.jsxs("select",{className:"message-mode",value:A,onChange:L=>Jt(L.target.value),disabled:Ee,children:[s.jsx("option",{value:"text",children:"WhatsApp"}),s.jsx("option",{value:"note",children:"Nota interna"})]}),s.jsx("input",{ref:xe,type:"text",placeholder:"Escribe un mensaje...",value:y,onChange:L=>Tt(L.target.value),disabled:Ee}),s.jsx("button",{className:"send-button",type:"submit",disabled:Ee,children:s.jsx(zn,{className:"icon"})})]})]})]})}),s.jsxs("aside",{className:"chat-info",children:[s.jsxs("div",{className:"info-card",children:[s.jsx("div",{className:"info-avatar",children:s.jsx("span",{children:Ce(E)})}),s.jsx("div",{className:"info-name",children:E}),s.jsx("div",{className:"info-phone",children:$||"Sin telefono"}),s.jsx("button",{className:"primary",type:"button",children:"Abrir en Odoo"})]}),s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Informacion del paciente"}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{children:"Ultima visita"}),s.jsx("span",{children:j((e==null?void 0:e.last_visit_at)||(e==null?void 0:e.last_visit))})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{children:"Tratamiento actual"}),s.jsx("span",{children:(e==null?void 0:e.current_treatment)||(e==null?void 0:e.treatment)||"-"})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{children:"Alergias"}),s.jsx("span",{children:(e==null?void 0:e.allergies)||"Ninguna reportada"})]})]}),s.jsxs("div",{className:"info-section",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("div",{className:"section-title",children:"Etiquetas"}),s.jsx("button",{className:"link-button",type:"button",onClick:de,children:"Gestionar"})]}),s.jsx("div",{className:"tag-list",children:((e==null?void 0:e.tags)||[]).length?e.tags.map(L=>s.jsxs("span",{className:"tag-chip",children:[s.jsx("span",{className:"tag-chip-label",children:L.name}),s.jsx("button",{className:"tag-remove",type:"button",title:"Quitar etiqueta",onClick:()=>Z(L.name),children:"x"})]},L.name)):s.jsx("div",{className:"empty-state",children:"Sin etiquetas"})}),s.jsxs("form",{className:"tag-form",onSubmit:C,children:[s.jsxs("select",{value:d,onChange:L=>setTagInput(L.target.value),children:[s.jsx("option",{value:"",children:"Selecciona etiqueta..."}),c.filter(L=>!((e==null?void 0:e.tags)||[]).some(Se=>Se.name===L.name)).map(L=>s.jsx("option",{value:L.name,children:L.name},L.id))]}),s.jsx("button",{className:"icon-button",type:"submit",title:"Agregar",children:s.jsx(yt,{className:"icon"})})]})]}),s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Notas internas"}),v!=null&&v.length?s.jsx("div",{className:"notes-stack",children:v.slice(-5).map(L=>s.jsx("div",{className:"note-card",children:L.text},L.id))}):s.jsx("div",{className:"empty-state",children:"Sin notas internas"}),s.jsxs("form",{className:"note-form",onSubmit:V,children:[s.jsx("input",{type:"text",placeholder:"Agregar nota interna...",value:p,onChange:L=>ee(L.target.value),disabled:!e}),s.jsx("button",{className:"icon-button",type:"submit",title:"Guardar nota",children:s.jsx(yt,{className:"icon"})})]})]}),e&&s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Acciones"}),s.jsxs("div",{className:"action-stack",children:[s.jsx("button",{className:"ghost",type:"button",onClick:W,disabled:Ee,children:"Tomar conversacion"}),te&&s.jsxs("div",{className:"reassign-row",children:[s.jsxs("select",{value:U,onChange:L=>re(L.target.value),children:[s.jsx("option",{value:"",children:"Reasignar a..."}),o.map(L=>s.jsx("option",{value:L.id,children:L.name},L.id))]}),s.jsx("button",{className:"ghost",type:"button",onClick:me,disabled:!U,children:"Reasignar"})]}),te&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"ghost",type:"button",onClick:()=>Y("open"),children:"Reactivar bot"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>Y("pending"),children:"Liberar para otro operador"})]})]})]})]})]})]}),Xe&&s.jsx("div",{className:"modal-overlay",onClick:ye,children:s.jsxs("div",{className:"modal-card",onClick:L=>L.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Gestion de etiquetas"}),s.jsx("button",{className:"modal-close",type:"button",onClick:ye,children:"x"})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("form",{className:"tag-manager-form",onSubmit:Et,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:Je.name,onChange:L=>at(Se=>({...Se,name:L.target.value})),placeholder:"Nombre de etiqueta"})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Color"}),s.jsx("input",{type:"color",value:Je.color,onChange:L=>at(Se=>({...Se,color:L.target.value}))})]}),s.jsx("div",{className:"modal-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Crear etiqueta"})})]}),s.jsx("div",{className:"tag-manager-list",children:(c||[]).map(L=>s.jsxs("div",{className:"tag-manager-row",children:[s.jsx("span",{className:"tag-chip",style:{borderColor:L.color||"#cbd5f5"},children:s.jsx("span",{className:"tag-chip-label",children:L.name})}),s.jsx("div",{className:"tag-manager-actions",children:s.jsx("button",{className:"danger soft",type:"button",onClick:()=>Ue(L.id,L.name),children:"Eliminar"})})]},L.id))})]})]})})]})}const Nx=[{day:"2024-01-01",in_count:210,out_count:90},{day:"2024-01-04",in_count:280,out_count:120},{day:"2024-01-07",in_count:240,out_count:110},{day:"2024-01-10",in_count:320,out_count:140},{day:"2024-01-13",in_count:300,out_count:130},{day:"2024-01-17",in_count:310,out_count:135},{day:"2024-01-20",in_count:290,out_count:120},{day:"2024-01-24",in_count:260,out_count:115},{day:"2024-01-27",in_count:330,out_count:150},{day:"2024-01-30",in_count:340,out_count:160}];function wx(e){const t=e?new Date(e):null;if(!t||Number.isNaN(t.getTime()))return"--";const n=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];return`${String(t.getDate()).padStart(2,"0")} ${n[t.getMonth()].toUpperCase()}`}function yd(e){return e.length?e.map((t,n)=>`${n===0?"M":"L"}${t.x} ${t.y}`).join(" "):""}function _x({statusCounts:e,metrics:t,onRefresh:n}){var P;const r=(e.open||0)+(e.pending||0),a=t!=null&&t.avg_first_reply_seconds?Number(t.avg_first_reply_seconds)/60:null,i=a?`${a.toFixed(1)}m`:"-",l=(t==null?void 0:t.conversion_rate)??(t==null?void 0:t.conversion_rate_percent)??null,c=`${(l==null?18.4:l>1?l:l*100).toFixed(1)}%`,f=((P=t==null?void 0:t.message_volume)==null?void 0:P.length)>0?t.message_volume.slice(-10):Nx,x=Math.max(...f.map(N=>N.in_count+N.out_count),1),g=f.length*42+30,j=220,T=150,y=180,A=f.map((N,D)=>{const $=(N.in_count+N.out_count)/x*T,F=N.in_count/x*T,te=N.out_count/x*T;return{x:22+D*42,totalHeight:$,inHeight:F,outHeight:te}}),w=yd(A.map((N,D)=>({x:N.x+10,y:y-N.inHeight}))),d=yd(A.map(N=>({x:N.x+10,y:y-N.outHeight}))),p=Array.from(new Set([0,Math.floor(f.length/3),Math.floor(2*f.length/3),f.length-1])),v=Math.round((t==null?void 0:t.team_efficiency)||94),S=((t==null?void 0:t.top_tags)||[]).slice(0,3);return s.jsxs("section",{className:"dashboard-layout",children:[s.jsxs("div",{className:"dashboard-main",children:[s.jsxs("header",{className:"dashboard-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dashboard-kicker",children:"PODOPIE Enterprise"}),s.jsx("h2",{className:"dashboard-title",children:"Dashboard"}),s.jsx("div",{className:"dashboard-subtitle",children:"Marketing Analytics & WhatsApp CRM Overview"})]}),s.jsxs("div",{className:"dashboard-actions",children:[s.jsxs("button",{className:"dash-filter",type:"button",children:[s.jsx("span",{className:"dash-filter-icon","aria-hidden":"true"}),"Ultimos 30 dias"]}),s.jsx("button",{className:"primary",type:"button",onClick:n,children:"Generar Reporte"})]})]}),s.jsxs("div",{className:"dashboard-kpis",children:[s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Conversaciones activas"}),s.jsx("div",{className:"dash-kpi-value",children:r.toLocaleString()})]}),s.jsx("div",{className:"dash-kpi-icon",children:"C"})]}),s.jsx("div",{className:"dash-kpi-change up",children:"+12.5%"})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tiempo de respuesta"}),s.jsx("div",{className:"dash-kpi-value",children:i})]}),s.jsx("div",{className:"dash-kpi-icon",children:"T"})]}),s.jsx("div",{className:"dash-kpi-change down",children:"-0.8m"})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tasa de conversion"}),s.jsx("div",{className:"dash-kpi-value",children:c})]}),s.jsx("div",{className:"dash-kpi-icon",children:"%"})]}),s.jsx("div",{className:"dash-kpi-change up",children:"+2.1%"})]})]}),s.jsxs("div",{className:"dash-card dash-chart-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-card-title",children:"Flujo de Mensajes"}),s.jsx("div",{className:"dash-card-subtitle",children:"Volumen diario"})]}),s.jsxs("div",{className:"dash-legend",children:[s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot in"})," Entrantes"]}),s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot out"})," Salientes"]})]})]}),s.jsx("div",{className:"dash-chart",children:s.jsxs("svg",{className:"dash-chart-svg",viewBox:`0 0 ${g} ${j}`,preserveAspectRatio:"none",children:[s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"60",x2:g,y2:"60"}),s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"120",x2:g,y2:"120"}),A.map((N,D)=>s.jsxs("g",{children:[s.jsx("rect",{className:"dash-bar in",x:N.x,y:y-N.inHeight,width:"20",height:N.inHeight,rx:"6"}),s.jsx("rect",{className:"dash-bar out",x:N.x,y:y-N.inHeight-N.outHeight,width:"20",height:N.outHeight,rx:"6"})]},`bar-${D}`)),s.jsx("path",{className:"dash-line in",d:w}),s.jsx("path",{className:"dash-line out",d})]})}),s.jsx("div",{className:"dash-chart-labels",children:p.map(N=>{var D;return s.jsx("span",{children:wx((D=f[N])==null?void 0:D.day)},`label-${N}`)})})]}),s.jsxs("div",{className:"dashboard-lower",children:[s.jsxs("div",{className:"dash-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsx("div",{className:"dash-card-title",children:"Ultimas etiquetas detectadas"}),s.jsx("button",{className:"link-button",type:"button",children:"Ver todo"})]}),s.jsxs("div",{className:"dash-tag-table",children:[s.jsxs("div",{className:"dash-tag-head",children:[s.jsx("span",{children:"Etiqueta"}),s.jsx("span",{children:"Frecuencia"}),s.jsx("span",{children:"Accion"})]}),S.map(N=>s.jsxs("div",{className:"dash-tag-row",children:[s.jsx("span",{className:"dash-tag-chip",children:N.name}),s.jsx("span",{className:"dash-tag-count",children:N.count}),s.jsx("span",{className:"dash-tag-action",children:">"})]},N.name)),!S.length&&s.jsx("div",{className:"empty-state",children:"Sin etiquetas recientes"})]})]}),s.jsxs("div",{className:"dash-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsx("div",{className:"dash-card-title",children:"Actividad de Campana"}),s.jsx("span",{className:"dash-pill",children:"Monitor"})]}),s.jsxs("div",{className:"dash-campaign",children:[s.jsx("div",{className:"dash-campaign-title",children:'Campana de Verano "Pies Sanos"'}),s.jsxs("div",{className:"dash-campaign-meta",children:[s.jsx("span",{className:"dash-pill solid",children:"84% enviado"}),s.jsx("span",{className:"dash-muted",children:"Hace 2 horas"})]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:"84%"}})}),s.jsx("div",{className:"dash-muted",children:"1,240 destinatarios"})]})]})]})]}),s.jsxs("aside",{className:"dashboard-side",children:[s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Performance de Operadores"}),s.jsx("div",{className:"dash-card-subtitle",children:"Top 5 leaderboard - hoy"}),s.jsx("div",{className:"dash-operator-list",children:[{name:"Lucia Fernandez",role:"Especialista CRM",resolved:84,pending:3},{name:"Ricardo Gomez",role:"Atencion Pacientes",resolved:71,pending:8},{name:"Ana Martinez",role:"Soporte Medico",resolved:65,pending:12}].map(N=>s.jsxs("div",{className:"dash-operator",children:[s.jsx("div",{className:"dash-operator-avatar",children:N.name[0]}),s.jsxs("div",{className:"dash-operator-meta",children:[s.jsx("div",{className:"dash-operator-name",children:N.name}),s.jsx("div",{className:"dash-operator-role",children:N.role}),s.jsxs("div",{className:"dash-operator-stats",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Resueltos"}),s.jsx("div",{className:"dash-stat-value",children:N.resolved})]}),s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Pendientes"}),s.jsx("div",{className:"dash-stat-value danger",children:N.pending})]})]})]})]},N.name))})]}),s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Eficiencia de Equipo"}),s.jsxs("div",{className:"dash-efficiency",children:[s.jsxs("div",{className:"dash-efficiency-value",children:[v,"%"]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:`${v}%`}})}),s.jsx("div",{className:"dash-muted",children:"Objetivo diario: 500 conversiones"})]})]})]})]})}const jd={draft:"BORRADOR",scheduled:"PROGRAMADA",sending:"ENVIANDO",sent:"FINALIZADA",failed:"ERROR"},Xa={APPROVED:{label:"APROBADA",className:"approved"},PENDING:{label:"PENDIENTE",className:"pending"},REJECTED:{label:"RECHAZADA",className:"rejected"},DRAFT:{label:"BORRADOR",className:"draft"},PAUSED:{label:"PAUSADA",className:"pending"},DISABLED:{label:"DESHABILITADA",className:"draft"}},Nd={MARKETING:"MARKETING",UTILITY:"UTILIDAD",AUTHENTICATION:"AUTENTICACION"},Ja=[{id:"audiences",label:"Audiencias",title:"PERZIVALH Audiencias",subtitle:"MDULO DE GESTIN Y CAMPAAS"},{id:"templates",label:"Biblioteca de Plantillas",title:"Biblioteca de Plantillas",subtitle:"Consulta y gestiona las plantillas de mensajes autorizadas por WhatsApp."},{id:"new",label:"Campaas",title:"Gestin de Campaas",subtitle:"Historial de envos y difusin WhatsApp"}],Sx={audiencias:"audiences",audiences:"audiences",templates:"templates",plantillas:"templates",biblioteca:"templates",nueva:"new",campaign:"new",campaigns:"new",nueva_campana:"new",history:"new",historial:"new"},Gl=[{id:"dynamic",label:"Audiencias Dinmicas",title:"Automatizacin de Audiencias y Tags",subtitle:"Unificacin de flujos de datos Perzivalh CRM",actionLabel:"Guardar Configuracin"},{id:"excel",label:"Importar Excel",title:"Importacin de Contactos Excel",subtitle:"Gestin de base de datos externa Perzivalh CRM",actionLabel:"Iniciar Importacin"},{id:"odoo",label:"Importar de Odoo",title:"Sincronizacin Inteligente Odoo",subtitle:"Automatizacin de audiencias Perzivalh OS",actionLabel:"Actualizar Lista Odoo"}],kx=[{value:"phone",label:"Telfono"},{value:"name",label:"Nombre Completo"},{value:"city",label:"Ciudad"},{value:"tags",label:"Etiquetas"},{value:"ignore",label:"Sin Mapear"}];function bx({campaignForm:e,setCampaignForm:t,campaignFilter:n,setCampaignFilter:r,templates:a,campaigns:i,selectedCampaignId:l,campaignMessages:o,users:c,tags:f,selectedTemplate:x,statusOptions:g,onCreateCampaign:j,onLoadCampaigns:T,onLoadCampaignMessages:y,onSendCampaign:A,formatDate:w}){var Ta;const[d,p]=m.useState(""),[v,S]=m.useState("all"),[P,N]=m.useState(!1),[D,E]=m.useState(null),[$,F]=m.useState(""),[te,he]=m.useState(!1),[xe,Be]=m.useState(""),[we,pe]=m.useState("all"),[Oe,B]=m.useState(!1),[H,b]=m.useState(e.send_now===!1||e.scheduled_for?"schedule":"now"),[W,Y]=m.useState(1),[Z]=m.useState(6),{pushToast:C}=eu(),ee=m.useRef(null),[V,U]=m.useState(!1),[re,me]=m.useState("dynamic"),[de,ye]=m.useState({enabled:!1,phone_number_id:null}),[Xe,Je]=m.useState(!1),[at,Et]=m.useState([]),[Ue,Ve]=m.useState(!1),[He,Jt]=m.useState(!1),[Tt,K]=m.useState(""),[Ce,yt]=m.useState(null),[ut,Nn]=m.useState(""),[Ze,wn]=m.useState(null),[zn,Zt]=m.useState([]),[Ee,zt]=m.useState({targetMode:"new",listName:"",targetSegmentId:"",prefix:"",ignoreDuplicates:!0}),[L,Se]=m.useState(null),[ps,cn]=m.useState(!1),[$t,_]=m.useState({connected:!1}),[z,Q]=m.useState(!1),[se,je]=m.useState(!1),[Ne,dt]=m.useState(()=>{if(typeof window>"u")return"templates";const R=new URLSearchParams(window.location.search).get("tab");return R?Sx[R]||R:"templates"}),[qe,Ut]=m.useState(null),[ne,X]=m.useState(null),[$n,un]=m.useState([]),[_n,dn]=m.useState(0),[Ds,ms]=m.useState(!1),[Ms,gs]=m.useState(""),[ht,vs]=m.useState(1),[Un]=m.useState(10),[Vt,rl]=m.useState({tag:"Todas",date:"Cualquier fecha",status:"Activos"}),[al,Nr]=m.useState(null);m.useEffect(()=>{const u=e.send_now===!1||e.scheduled_for?"schedule":"now";b(u)},[e.send_now,e.scheduled_for]);const[_a,tu]=m.useState([]);m.useEffect(()=>{Vn(),il()},[]),m.useEffect(()=>{V&&(nu(),wr(),Is())},[V]),m.useEffect(()=>{!V||re!=="odoo"||Is()},[re,V]),m.useEffect(()=>{Ja.find(u=>u.id===Ne)||dt("templates")},[Ne]),m.useEffect(()=>{if(typeof window>"u")return;const u=new URLSearchParams(window.location.search);u.set("tab",Ne);const R=`${window.location.pathname}?${u.toString()}`;window.history.replaceState({},"",R)},[Ne]);async function Vn(){try{const u=await ce("/api/audiences?with_counts=true");u&&u.segments&&tu(u.segments)}catch(u){console.error("Failed to load segments",u)}}async function il(){try{const u=await ce("/api/contacts/stats");Ut(u||null)}catch(u){console.error("Failed to load Odoo stats",u),Ut(null)}}async function nu(){Je(!0);try{const u=await ce("/api/audiences/automation-settings");ye((u==null?void 0:u.settings)||{enabled:!1,phone_number_id:null})}catch(u){console.error("Failed to load automation settings",u)}finally{Je(!1)}}async function wr(){Ve(!0);try{const u=await ce("/api/audiences/dynamic-tags");Et((u==null?void 0:u.items)||[])}catch(u){console.error("Failed to load dynamic audiences",u)}finally{Ve(!1)}}async function At(u=de.enabled){try{const R=await ke("/api/audiences/automation-settings",{enabled:u});ye((R==null?void 0:R.settings)||{...de,enabled:u}),C({message:"Configuracin guardada"})}catch(R){C({type:"error",message:R.message||"No se pudo guardar"})}}async function Sa(u){ye(R=>({...R,enabled:u})),await At(u)}async function jt(){Jt(!0);try{await ke("/api/audiences/sync-historical",{}),await wr(),await Vn(),C({message:"Sincronizacin completa"})}catch(u){C({type:"error",message:u.message||"Error al sincronizar"})}finally{Jt(!1)}}async function _r(){const u=Tt.trim();if(u)try{await ke("/api/audiences/dynamic-tags",{name:u}),K(""),await wr(),await Vn(),C({message:"Etiqueta creada correctamente"})}catch(R){C({type:"error",message:R.message||"No se pudo crear etiqueta"})}}async function Is(){Q(!0);try{const u=await ce("/api/contacts/odoo-status");_(u||{connected:!1})}catch(u){console.error("Failed to load Odoo status",u),_({connected:!1})}finally{Q(!1)}}async function Fn(){je(!0);try{await ke("/api/contacts/refresh-odoo",{}),await il(),C({message:"Lista Odoo actualizada"})}catch(u){C({type:"error",message:u.message||"Error al actualizar Odoo"})}finally{je(!1)}}async function ft(u){return new Promise((R,G)=>{const ae=new FileReader;ae.onload=()=>{const ze=(ae.result||"").toString().split(",")[1]||"";R(ze)},ae.onerror=()=>G(ae.error),ae.readAsDataURL(u)})}async function ka(u){var G;const R=(G=u.target.files)==null?void 0:G[0];if(R){yt(R),Se(null);try{const ae=await ft(R);Nn(ae);const ie=await ke("/api/audiences/import-preview",{file_base64:ae,filename:R.name});wn(ie),Zt((ie==null?void 0:ie.mapping)||[])}catch(ae){wn(null),Zt([]),C({type:"error",message:ae.message||"No se pudo leer el archivo"})}}}async function Bs(){if(!Ce||!ut){C({type:"error",message:"Selecciona un archivo vlido"});return}cn(!0);try{const u={file_base64:ut,filename:Ce.name,mapping:zn,options:{baseTagName:Ee.listName,targetSegmentId:Ee.targetMode==="existing"?Ee.targetSegmentId:"",prefix:Ee.prefix,ignoreDuplicates:Ee.ignoreDuplicates}},R=await ke("/api/audiences/import-excel",u);Se(R),await Vn(),await wr(),C({message:"Importacin completada"})}catch(u){C({type:"error",message:u.message||"Error al importar"})}finally{cn(!1)}}async function zs(u,R={}){if(!u){un([]),dn(0);return}const G=R.page||1,ae=R.search||"";ms(!0);try{if(u.type==="odoo"){const kn=(G-1)*Un,hn=await ce(`/api/contacts?search=${encodeURIComponent(ae)}&offset=${kn}&limit=${Un}`);let fn=(hn==null?void 0:hn.contacts)||[];Vt.tag!=="Todas"&&(fn=fn.filter(Wn=>{const Ot=Wn.tags_json||[];return Vt.tag==="Con etiquetas"?Array.isArray(Ot)&&Ot.length>0:Vt.tag==="Sin etiquetas"?!Array.isArray(Ot)||Ot.length===0:!0})),Vt.status!=="Activos"&&(fn=fn.filter(Wn=>{const Ot=(Wn.status||"ACTIVO").toUpperCase();return Vt.status==="Activos"?Ot==="ACTIVO":Ot!=="ACTIVO"})),un(fn),dn((hn==null?void 0:hn.total)||fn.length);return}const ie=await ce(`/api/audiences/${u.id}/preview?limit=200`),ze=(ie==null?void 0:ie.recipients)||[],Nt=ae.trim().toLowerCase();let Sn=Nt?ze.filter(kn=>{var Wn,Ot;const hn=((Wn=kn.name)==null?void 0:Wn.toLowerCase())||"",fn=((Ot=kn.phone_e164)==null?void 0:Ot.toLowerCase())||"";return hn.includes(Nt)||fn.includes(Nt)}):ze;Vt.tag==="Sin etiquetas"&&(Sn=Sn.filter(kn=>!kn.tags||kn.tags.length===0));const Vs=(ie==null?void 0:ie.total)||Sn.length,Aa=(G-1)*Un,vl=Sn.slice(Aa,Aa+Un);un(vl),dn(Vs)}catch(ie){console.error("Failed to load audience contacts",ie),un([]),dn(0)}finally{ms(!1)}}function ll(u){X((u==null?void 0:u.id)||null),vs(1)}async function ol(){try{await ke("/api/audiences/refresh-counts",{}),await Vn(),xs&&await zs(xs,{page:ht,search:Ms}),C({message:"Conteos actualizados"})}catch(u){C({type:"error",message:u.message||"No se pudo actualizar"})}}async function cl(u){if(!(!u||u.type==="odoo"||u.isDefault||!window.confirm(`Eliminar la audiencia "${u.name}"? Esta accin la desactiva y no borra contactos.`)))try{await Yn(`/api/audiences/${u.id}`),await Vn(),ne===u.id&&X(null),Nr(null),C({message:"Audiencia eliminada"})}catch(G){C({type:"error",message:G.message||"No se pudo eliminar"})}}async function ul(u){if(!u||u.type==="odoo"||u.isDefault)return;const R=window.prompt("Nuevo nombre de la audiencia:",u.name);if(!(!R||!R.trim()))try{await Qo(`/api/audiences/${u.id}`,{name:R.trim()}),await Vn(),Nr(null),C({message:"Audiencia renombrada"})}catch(G){C({type:"error",message:G.message||"No se pudo renombrar"})}}function Qe(u,R){rl(G=>{const ae=G[u],ie=R.indexOf(ae),ze=R[(ie+1)%R.length];return{...G,[u]:ze}})}function ba(){if(re==="dynamic"){At();return}if(re==="excel"){Bs();return}re==="odoo"&&Fn()}const _e=m.useMemo(()=>{const u={id:"odoo",name:"odoo",subtitle:"Origen: Odoo",count:(qe==null?void 0:qe.total)||0,type:"odoo"},R=_a.map(G=>({id:G.id,name:G.name,subtitle:G.description||"Segmento personalizado",count:G.estimated_count||0,type:"segment",isDefault:(G.name||"").toUpperCase().startsWith("DEFAULT")}));return[u,...R]},[_a,qe]),Sr=m.useMemo(()=>{const u=$.trim().toLowerCase();return u?_e.filter(R=>{var ie,ze;const G=((ie=R.name)==null?void 0:ie.toLowerCase())||"",ae=((ze=R.subtitle)==null?void 0:ze.toLowerCase())||"";return G.includes(u)||ae.includes(u)}):_e},[_e,$]),xs=m.useMemo(()=>_e.find(u=>u.id===ne),[_e,ne]),ys=m.useMemo(()=>Math.max(1,Math.ceil(_n/Un)),[_n,Un]),dl=m.useMemo(()=>{const u=[],R=Math.max(1,ht-1),G=Math.min(ys,R+2);for(let ae=R;ae<=G;ae+=1)u.push(ae);return u},[ht,ys]),js=m.useMemo(()=>{const u={all:i.length,sent:0,scheduled:0,draft:0,failed:0};return i.forEach(R=>{R.status==="sent"&&(u.sent+=1),R.status==="scheduled"&&(u.scheduled+=1),R.status==="draft"&&(u.draft+=1),R.status==="failed"&&(u.failed+=1)}),u},[i]),Lt=m.useMemo(()=>{const u=xe.trim().toLowerCase();return i.filter(R=>{const G=!u||(R.name||"").toLowerCase().includes(u),ae=we==="all"||R.status===we;return G&&ae})},[i,xe,we]),kr=m.useMemo(()=>{const u=[],R=Math.max(1,Math.ceil(i.length/Z)),G=Math.max(1,W-1),ae=Math.min(R,G+2);for(let ie=G;ie<=ae;ie+=1)u.push(ie);return{pages:u,totalPages:R}},[i.length,W,Z]);m.useEffect(()=>{Ne==="audiences"&&!ne&&_e.length&&X(_e[0].id)},[_e,Ne,ne]),m.useEffect(()=>{Ne!=="new"&&Oe&&B(!1)},[Ne,Oe]),m.useEffect(()=>{Ne==="audiences"&&zs(xs,{page:ht,search:Ms})},[ne,ht,Ms,Ne,xs,Vt]);const hl=m.useMemo(()=>{const u=new Set;return(a||[]).forEach(R=>{R.category&&u.add(R.category)}),Array.from(u)},[a]),Ca=m.useMemo(()=>{const u=d.trim().toLowerCase(),R=v==="all"?"":v.toLowerCase();return(a||[]).filter(G=>{var Sn,Vs;const ae=((Sn=G.name)==null?void 0:Sn.toLowerCase())||"",ie=((Vs=G.category)==null?void 0:Vs.toLowerCase())||"";return(!u||ae.includes(u)||ie.includes(u))&&(!R||ie===R)})},[d,v,a]),br=m.useMemo(()=>n.segment_id?_e.find(u=>u.id===n.segment_id)||null:n.tag&&_e.find(u=>u.name===n.tag)||null,[_e,n.segment_id,n.tag]),fl=m.useMemo(()=>n.segment_id?`segment:${n.segment_id}`:n.tag?`tag:${n.tag}`:n.assigned_user_id?`assigned:${n.assigned_user_id}`:n.status?`status:${n.status}`:n.verified_only?"verified":"",[n.segment_id,n.tag,n.assigned_user_id,n.status,n.verified_only]);function $s(u){r(R=>{const G={...R,status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""};if(u.startsWith("segment:")){const ae=u.slice(8),ie=_e.find(ze=>ze.id===ae);G.segment_id=ae,G.segment_name=(ie==null?void 0:ie.name)||""}else u.startsWith("tag:")?G.tag=u.slice(4):u.startsWith("status:")?G.status=u.slice(7):u.startsWith("assigned:")?G.assigned_user_id=u.slice(9):u==="verified"&&(G.verified_only=!0);return G})}function pl(u){t(R=>({...R,template_id:u}))}function ml(u){E(u),N(!0)}const gl=Ja.find(u=>u.id===Ne)||Ja[1],Us={title:"PERZIVALH Campaas",subtitle:"CONFIGURACIN DE NUEVO ENVO MASIVO"},Cr=Gl.find(u=>u.id===re)||Gl[0],Ea=V?Cr:Ne==="new"&&Oe?Us:gl;return s.jsxs("section",{className:"campaigns-page",children:[s.jsxs("div",{className:"campaigns-shell",children:[s.jsxs("header",{className:"campaigns-header",children:[s.jsxs("div",{className:"campaigns-title-block",children:[s.jsxs("div",{className:"campaigns-title-row",children:[V&&s.jsx("button",{className:"campaigns-back",type:"button",onClick:()=>U(!1),"aria-label":"Volver",children:"<"}),s.jsx("span",{className:"campaigns-heading",children:Ea.title})]}),s.jsx("div",{className:`campaigns-subtitle ${V?"campaigns-subtitle--upper":""}`,children:Ea.subtitle})]}),s.jsxs("div",{className:"campaigns-actions",children:[V&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>U(!1),children:re==="excel"?"Cancelar":"Descartar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:ba,disabled:re==="excel"&&(ps||!ut||Ee.targetMode==="new"&&!Ee.listName.trim()||Ee.targetMode==="existing"&&!Ee.targetSegmentId)||re==="odoo"&&se,children:Cr.actionLabel})]}),!V&&Ne==="audiences"&&s.jsxs("button",{className:"campaigns-primary campaigns-primary--dropdown",type:"button",onClick:()=>{U(!0),me("dynamic")},children:[s.jsx("span",{className:"campaigns-primary-icon",children:"+"}),"Nueva Audiencia"]}),!V&&Ne==="new"&&s.jsx(s.Fragment,{children:Oe?s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>B(!1),children:"Cancelar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>{var u,R;return(R=(u=ee.current)==null?void 0:u.requestSubmit)==null?void 0:R.call(u)},children:"Lanzar Campaa"})]}):s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>B(!0),children:"+ Lanzar Campaa"})})]})]}),!V&&s.jsx("nav",{className:"campaigns-tabs",role:"tablist","aria-label":"Secciones de Campaas",children:Ja.map(u=>s.jsx("button",{type:"button",role:"tab","aria-selected":Ne===u.id,className:`campaigns-tab ${Ne===u.id?"active":""}`,onClick:()=>dt(u.id),children:u.label},u.id))}),s.jsx("div",{className:"campaigns-tab-panel",children:V?s.jsxs("section",{className:"audience-flow",children:[s.jsx("nav",{className:"audience-flow-tabs",role:"tablist","aria-label":"Flujo de nueva audiencia",children:Gl.map(u=>s.jsx("button",{type:"button",role:"tab","aria-selected":re===u.id,className:`audience-flow-tab ${re===u.id?"active":""}`,onClick:()=>me(u.id),children:u.label},u.id))}),s.jsxs("div",{className:"audience-flow-panel",children:[re==="dynamic"&&s.jsxs("div",{className:"audience-flow-content",children:[s.jsxs("div",{className:"audience-hero",children:[s.jsxs("div",{className:"audience-hero-main",children:[s.jsx("div",{className:"audience-hero-title",children:"Sincronizacin Automtica Total"}),s.jsx("div",{className:"audience-hero-subtitle",children:"Vincula tus etiquetas directamente con Audiencias Dinmicas. La lgica del sistema es 1 Tag = 1 Audiencia."})]}),s.jsxs("label",{className:"audience-switch",children:[s.jsx("span",{children:"Estado"}),s.jsx("input",{type:"checkbox",checked:de.enabled,onChange:u=>Sa(u.target.checked),disabled:Xe}),s.jsx("span",{children:de.enabled?"ACTIVO":"INACTIVO"})]})]}),s.jsxs("div",{className:"audience-rule-card",children:[s.jsx("div",{className:"audience-rule-title",children:"Regla de Automatizacin unificada"}),s.jsx("p",{children:"Cuando un operador o bot etiqueta a un contacto en el CRM, este se aade instantneamente a la lista de audiencia correspondiente. No requiere intervencin manual adicional."})]}),s.jsxs("div",{className:"audience-section-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audience-section-title",children:"Gestin de Etiquetas dinmicas"}),s.jsx("div",{className:"audience-section-subtitle",children:"Administra las etiquetas vinculadas que alimentan tus listas de envo en tiempo real."})]}),s.jsxs("div",{className:"audience-section-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:jt,disabled:He,children:He?"Sincronizando...":"Sincronizar Datos Histricos"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:_r,disabled:!Tt.trim(),children:"Nueva Etiqueta / Audiencia"})]})]}),s.jsxs("div",{className:"audience-tags-grid",children:[Ue&&s.jsx("div",{className:"empty-state",children:"Cargando etiquetas..."}),!Ue&&at.length===0&&s.jsx("div",{className:"empty-state",children:"No hay etiquetas dinmicas an."}),!Ue&&at.map(u=>{var R,G,ae,ie;return s.jsxs("div",{className:`audience-tag-card ${u.is_default?"default":""}`,children:[s.jsxs("div",{className:"audience-tag-head",children:[s.jsx("div",{className:"audience-tag-name",children:u.is_default?"DEFAULT":((R=u.tag)==null?void 0:R.name)||((G=u.segment)==null?void 0:G.name)}),s.jsx("div",{className:"audience-tag-count",children:((ae=u.segment)==null?void 0:ae.estimated_count)||0})]}),s.jsxs("div",{className:"audience-tag-meta",children:["Audiencia: ",((ie=u.segment)==null?void 0:ie.estimated_count)||0," contactos"]}),s.jsxs("div",{className:"audience-tag-status",children:[s.jsx("span",{className:"dot"}),"Sincronizado",s.jsx("span",{className:"audience-tag-time",children:u.last_synced_at?`  ${w(u.last_synced_at)}`:""})]})]},u.id)}),s.jsx("div",{className:"audience-tag-card add",children:s.jsxs("div",{className:"audience-tag-add",children:[s.jsx("div",{className:"audience-tag-add-icon",children:"+"}),s.jsx("input",{type:"text",placeholder:"Crear nueva etiqueta",value:Tt,onChange:u=>K(u.target.value)}),s.jsx("button",{type:"button",className:"campaigns-primary",onClick:_r,disabled:!Tt.trim(),children:"Crear"})]})})]})]}),re==="excel"&&s.jsxs("div",{className:"audience-flow-content",children:[s.jsx("div",{className:"excel-dropzone",children:s.jsxs("div",{className:"excel-dropzone-inner",children:[s.jsx("div",{className:"excel-dropzone-icon",children:"?"}),s.jsx("div",{className:"excel-dropzone-title",children:"Sube tu archivo de Excel"}),s.jsxs("div",{className:"excel-dropzone-subtitle",children:["Arrastra y suelta tu archivo .xlsx o .csv aqu o"," ",s.jsxs("label",{className:"excel-link",children:["explora tus archivos",s.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:ka})]})]}),s.jsxs("div",{className:"excel-dropzone-tags",children:[s.jsx("span",{children:"Mximo 50MB"}),s.jsx("span",{children:"Hasta 50,000 filas"})]}),Ce&&s.jsx("div",{className:"excel-file-name",children:Ce.name})]})}),s.jsxs("div",{className:"excel-grid",children:[s.jsxs("div",{className:"excel-card",children:[s.jsx("div",{className:"excel-card-title",children:"Configuracin de Importacin"}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista de destino"}),s.jsxs("select",{value:Ee.targetMode,onChange:u=>zt(R=>({...R,targetMode:u.target.value})),children:[s.jsx("option",{value:"new",children:"Crear Nueva Lista"}),s.jsx("option",{value:"existing",children:"Elegir Lista Existente"})]})]}),Ee.targetMode==="new"?s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Nombre de la nueva lista"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO",value:Ee.listName,onChange:u=>zt(R=>({...R,listName:u.target.value}))})]}):s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista existente"}),s.jsxs("select",{value:Ee.targetSegmentId,onChange:u=>zt(R=>({...R,targetSegmentId:u.target.value})),children:[s.jsx("option",{value:"",children:"Selecciona una lista"}),_a.map(u=>s.jsx("option",{value:u.id,children:u.name},u.id))]})]}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Prefijo de etiqueta (opcional)"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO_",value:Ee.prefix,onChange:u=>zt(R=>({...R,prefix:u.target.value}))})]}),s.jsxs("label",{className:"excel-checkbox",children:[s.jsx("input",{type:"checkbox",checked:Ee.ignoreDuplicates,onChange:u=>zt(R=>({...R,ignoreDuplicates:u.target.checked}))}),"Ignorar contactos duplicados"]}),L&&s.jsxs("div",{className:"excel-summary",children:["Procesadas: ",L.processed,"  Nuevos:"," ",L.created,"  Duplicados:"," ",L.skipped,"  Errores: ",L.errors]})]}),s.jsxs("div",{className:"excel-card",children:[s.jsxs("div",{className:"excel-card-title",children:["Vista previa de mapeo",s.jsxs("span",{className:"excel-pill",children:["Columnas detectadas: ",((Ta=Ze==null?void 0:Ze.columns)==null?void 0:Ta.length)||0]})]}),s.jsxs("div",{className:"excel-map-table",children:[s.jsxs("div",{className:"excel-map-head",children:[s.jsx("span",{children:"Columna Excel"}),s.jsx("span",{children:"Mapeo CRM"}),s.jsx("span",{children:"Ejemplo"})]}),((Ze==null?void 0:Ze.columns)||[]).map((u,R)=>{var G,ae;return s.jsxs("div",{className:"excel-map-row",children:[s.jsx("span",{children:u}),s.jsx("select",{value:zn[R]||"ignore",onChange:ie=>Zt(ze=>{const Nt=[...ze];return Nt[R]=ie.target.value,Nt}),children:kx.map(ie=>s.jsx("option",{value:ie.value,children:ie.label},ie.value))}),s.jsx("span",{children:((ae=(G=Ze==null?void 0:Ze.previewRows)==null?void 0:G[0])==null?void 0:ae[R])||"--"})]},`${u}-${R}`)}),!Ze&&s.jsx("div",{className:"empty-state",children:"Sube un archivo para ver el mapeo."})]})]})]})]}),re==="odoo"&&s.jsxs("div",{className:"audience-flow-content odoo-flow",children:[s.jsxs("div",{className:"odoo-status",children:[s.jsx("span",{className:`odoo-indicator ${$t.connected?"on":"off"}`}),"Estado: ",$t.connected?"Odoo conectado":"Odoo no conectado"]}),s.jsxs("div",{className:"odoo-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:Is,disabled:z,children:z?"Validando...":"Validar Conexin"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:Fn,disabled:se,children:se?"Actualizando...":"Actualizar Lista Odoo"})]}),s.jsx("div",{className:"odoo-note",children:"Se importarn contactos y se crearn audiencias por etiqueta Automticamente."})]})]})]}):s.jsxs(s.Fragment,{children:[Ne==="templates"&&s.jsxs("section",{className:"campaigns-panel templates-panel",children:[s.jsxs("div",{className:"templates-toolbar",children:[s.jsxs("label",{className:"templates-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar por nombre de plantilla...",value:d,onChange:u=>p(u.target.value)})]}),s.jsxs("select",{className:"templates-select",value:v,onChange:u=>S(u.target.value),children:[s.jsx("option",{value:"all",children:"Todas las categorias"}),hl.map(u=>s.jsx("option",{value:u.toLowerCase(),children:Nd[u]||u},u))]})]}),s.jsxs("div",{className:"template-grid template-grid--library",children:[Ca.map(u=>{const R=(u.status||(u.is_active?"APPROVED":"PENDING")).toUpperCase(),G=Xa[R]||Xa.PENDING,ae=Nd[u.category]||u.category||"GENERAL",ie=u.id===e.template_id,ze=u.rejection_reason||u.rejectionReason||u.rejection_message||"",Nt=R==="REJECTED"?"Ver detalles":"Previsualizar";return s.jsxs("div",{className:`template-card ${ie?"selected":""}`,children:[s.jsxs("div",{className:"template-head",children:[s.jsx("div",{className:"template-name",title:u.name,children:u.name}),s.jsx("span",{className:`template-status ${G.className}`,children:G.label})]}),s.jsx("div",{className:"template-category",children:ae}),s.jsx("div",{className:`template-preview ${R==="REJECTED"?"rejected":""}`,children:u.body_preview||u.body_text||"Sin preview"}),R==="REJECTED"&&ze&&s.jsxs("div",{className:"template-rejection",children:["Rechazada por Meta: ",ze]}),s.jsxs("div",{className:"template-footer",children:[s.jsx("button",{className:"template-action",type:"button",onClick:()=>ml(u),children:Nt}),s.jsx("button",{className:"template-menu",type:"button","aria-label":"Mas opciones",children:"..."})]})]},u.id)}),!Ca.length&&s.jsx("div",{className:"empty-state",children:"Sin plantillas disponibles"})]})]}),Ne==="audiences"&&s.jsx("section",{className:"campaigns-panel audiences-panel",children:s.jsxs("div",{className:"audiences-layout",children:[s.jsxs("div",{className:"audiences-list",children:[s.jsxs("label",{className:"audiences-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar lista...",value:$,onChange:u=>F(u.target.value)})]}),s.jsxs("div",{className:"audience-list",children:[Sr.map(u=>{var R;return s.jsxs("button",{type:"button",className:`audience-card ${ne===u.id?"active":""}`,onClick:()=>ll(u),children:[s.jsxs("div",{className:"audience-title",children:[s.jsx("span",{children:u.name}),s.jsxs("div",{className:"audience-title-actions",children:[s.jsx("span",{className:"audience-count",children:((R=u.count)==null?void 0:R.toLocaleString("es-PE"))||0}),!u.isDefault&&u.type!=="odoo"&&s.jsxs("div",{className:"audience-menu-wrapper",children:[s.jsx("button",{className:"audience-menu",type:"button","aria-label":"Opciones de audiencia",onClick:G=>{G.stopPropagation(),Nr(ae=>ae===u.id?null:u.id)},children:"..."}),al===u.id&&s.jsxs("div",{className:"audience-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>ul(u),children:"Renombrar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>cl(u),children:"Eliminar"})]})]})]})]}),s.jsx("div",{className:"audience-subtitle",children:u.subtitle})]},u.id)}),!Sr.length&&s.jsx("div",{className:"empty-state",children:"Sin audiencias disponibles"})]})]}),s.jsxs("div",{className:"audiences-table-panel",children:[s.jsxs("div",{className:"audiences-filters",children:[s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ETIQUETA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>Qe("tag",["Todas","Con etiquetas","Sin etiquetas"]),children:Vt.tag})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"FECHA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>Qe("date",["Cualquier fecha","ltimos 30 das"]),children:Vt.date})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ESTADO:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>Qe("status",["Activos","Inactivos"]),children:Vt.status})]}),s.jsxs("div",{className:"audiences-filter-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Descargar",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Actualizar",onClick:ol,children:""})]})]}),s.jsxs("div",{className:"audiences-search-row",children:[s.jsxs("label",{className:"audiences-search-field",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar contacto en esta lista...",value:Ms,onChange:u=>{gs(u.target.value),vs(1)}})]}),s.jsxs("div",{className:"audiences-total",children:[_n.toLocaleString("es-PE")," contactos en total"]})]}),s.jsxs("div",{className:"audiences-table",children:[s.jsxs("div",{className:"audiences-table-head",children:[s.jsx("span",{}),s.jsx("span",{children:"CONTACTO"}),s.jsx("span",{children:"WHATSAPP"}),s.jsx("span",{children:"ETIQUETAS"}),s.jsx("span",{children:"FECHA REGISTRO"}),s.jsx("span",{children:"ESTADO"}),s.jsx("span",{})]}),Ds&&s.jsx("div",{className:"loading",children:"Cargando contactos..."}),!Ds&&$n.length===0&&s.jsx("div",{className:"empty-state",children:"No hay contactos en esta audiencia."}),!Ds&&$n.map(u=>{const R=u.name||"Sin nombre",G=u.email||"",ae=u.phone_e164||u.phone||"-",ie=Array.isArray(u.tags)?u.tags:u.tags?[u.tags]:[],ze=R.trim().slice(0,1).toUpperCase();return s.jsxs("div",{className:"audiences-table-row",children:[s.jsx("input",{type:"checkbox","aria-label":"Seleccionar contacto"}),s.jsxs("div",{className:"audiences-contact",children:[s.jsx("div",{className:"audiences-avatar",children:ze}),s.jsxs("div",{className:"audiences-contact-info",children:[s.jsx("div",{className:"audiences-contact-name",children:R}),G&&s.jsx("div",{className:"audiences-contact-email",children:G})]})]}),s.jsx("div",{children:ae}),s.jsx("div",{className:"audiences-tags",children:ie.length?ie.map(Nt=>s.jsx("span",{className:"audiences-tag",children:Nt},`${u.id}-${Nt}`)):s.jsx("span",{className:"audiences-tag empty",children:""})}),s.jsx("div",{children:u.created_at?w(u.created_at):""}),s.jsx("div",{className:"audiences-status",children:(u.status||"ACTIVO").toUpperCase()}),s.jsx("button",{className:"audiences-menu",type:"button","aria-label":"Opciones",children:"..."})]},u.id||ae)})]}),s.jsxs("div",{className:"audiences-pagination",children:[s.jsxs("div",{className:"audiences-page-info",children:["Pgina ",ht," de ",ys]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:ht<=1,onClick:()=>vs(u=>Math.max(1,u-1)),children:"<"}),dl.map(u=>s.jsx("button",{className:`audiences-page-btn ${u===ht?"active":""}`,type:"button",onClick:()=>vs(u),children:u},`aud-page-${u}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:ht>=ys,onClick:()=>vs(u=>Math.min(ys,u+1)),children:">"})]})]})]})]})}),Ne==="new"&&s.jsx("section",{className:"campaigns-panel campaigns-module",children:Oe?s.jsxs("div",{className:"campaigns-launch",children:[s.jsxs("form",{className:"campaigns-launch-form",ref:ee,onSubmit:j,children:[s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"1"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Nombre de la Campaa"}),s.jsx("input",{type:"text",placeholder:"Ej: Promocin Black Friday 2024",value:e.name,onChange:u=>t(R=>({...R,name:u.target.value}))})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"2"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Seleccionar Audiencia"}),s.jsxs("select",{value:fl,onChange:u=>$s(u.target.value),children:[s.jsx("option",{value:"",children:"Selecciona un segmento..."}),_e.filter(u=>u.type!=="odoo").map(u=>s.jsx("option",{value:`segment:${u.id}`,children:u.name},`seg-${u.id}`)),s.jsx("option",{value:"verified",children:"Solo verificados"}),s.jsx("option",{value:"assigned:unassigned",children:"Sin asignar"})]})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"3"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Elegir Plantilla de Meta"}),s.jsx("div",{className:"launch-templates",children:a.map(u=>{const R=u.status||"APPROVED",G=Xa[R]||Xa.APPROVED,ae=e.template_id===u.id;return s.jsxs("button",{className:`launch-template ${ae?"selected":""}`,type:"button",onClick:()=>pl(u.id),children:[s.jsx("div",{className:"launch-template-icon"}),s.jsx("div",{className:"launch-template-title",children:u.name}),s.jsx("div",{className:"launch-template-preview",children:u.body_preview||u.body_text||"Sin preview"}),s.jsx("span",{className:`launch-template-status ${G.className}`,children:G.label})]},u.id)})})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"4"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Programacin"}),s.jsxs("div",{className:"launch-schedule",children:[s.jsx("button",{className:`launch-schedule-option ${H==="now"?"active":""}`,type:"button",onClick:()=>{b("now"),t(u=>({...u,scheduled_for:"",send_now:!0}))},children:"Enviar Ahora"}),s.jsx("button",{className:`launch-schedule-option ${H==="schedule"?"active":""}`,type:"button",onClick:()=>{b("schedule"),t(u=>({...u,send_now:!1}))},children:"Programar Envo"})]}),H==="schedule"&&s.jsx("input",{type:"datetime-local",value:e.scheduled_for,onChange:u=>t(R=>({...R,scheduled_for:u.target.value,send_now:!1}))})]})]})]}),s.jsxs("aside",{className:"campaigns-launch-preview",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:"Nombre del Cliente"}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(x==null?void 0:x.body_preview)||(x==null?void 0:x.body_text)||"Selecciona una plantilla para ver el contenido."}),s.jsxs("div",{className:"preview-actions",children:[s.jsx("button",{type:"button",children:"Ver Tutorial"}),s.jsx("button",{type:"button",children:"Hablar con Soporte"})]}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Destinatarios"}),s.jsx("strong",{children:(br==null?void 0:br.count)||0})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:(x==null?void 0:x.name)||"Sin plantilla"})]})]})]})]}):s.jsxs("div",{className:"campaigns-dashboard",children:[s.jsxs("aside",{className:"campaigns-sidebar",children:[s.jsxs("label",{className:"campaigns-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar campaa...",value:xe,onChange:u=>Be(u.target.value)})]}),s.jsxs("div",{className:"campaigns-filters-list",children:[s.jsxs("button",{className:`campaigns-filter-item ${we==="all"?"active":""}`,type:"button",onClick:()=>pe("all"),children:[s.jsx("span",{children:"Todas las Campaas"}),s.jsx("span",{className:"campaigns-filter-count",children:js.all})]}),s.jsxs("button",{className:`campaigns-filter-item ${we==="sent"?"active":""}`,type:"button",onClick:()=>pe("sent"),children:[s.jsx("span",{children:"Enviadas"}),s.jsx("span",{className:"campaigns-filter-count",children:js.sent})]}),s.jsxs("button",{className:`campaigns-filter-item ${we==="scheduled"?"active":""}`,type:"button",onClick:()=>pe("scheduled"),children:[s.jsx("span",{children:"Programadas"}),s.jsx("span",{className:"campaigns-filter-count",children:js.scheduled})]}),s.jsxs("button",{className:`campaigns-filter-item ${we==="draft"?"active":""}`,type:"button",onClick:()=>pe("draft"),children:[s.jsx("span",{children:"Borradores"}),s.jsx("span",{className:"campaigns-filter-count",children:js.draft})]}),s.jsxs("button",{className:`campaigns-filter-item ${we==="failed"?"active":""}`,type:"button",onClick:()=>pe("failed"),children:[s.jsx("span",{children:"Fallidas"}),s.jsx("span",{className:"campaigns-filter-count",children:js.failed})]})]}),s.jsxs("div",{className:"campaigns-quota",children:[s.jsx("div",{className:"campaigns-quota-title",children:"Cuota de mensajes"}),s.jsx("div",{className:"campaigns-quota-bar",children:s.jsx("div",{className:"campaigns-quota-fill",style:{width:"65%"}})}),s.jsx("div",{className:"campaigns-quota-meta",children:"65% usado"})]})]}),s.jsxs("div",{className:"campaigns-table-panel",children:[s.jsxs("div",{className:"campaigns-table-filters",children:[s.jsx("div",{className:"campaigns-filter-chip",children:"Canal: WhatsApp Business"}),s.jsx("div",{className:"campaigns-filter-chip",children:"Periodo: ltimos 30 das"}),s.jsxs("div",{className:"campaigns-table-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button",onClick:()=>T(1,Z),children:""})]})]}),s.jsxs("div",{className:"campaigns-table",children:[s.jsxs("div",{className:"campaigns-table-head",children:[s.jsx("span",{children:"Campaa"}),s.jsx("span",{children:"Fecha"}),s.jsx("span",{children:"Audiencia"}),s.jsx("span",{children:"Enviados"}),s.jsx("span",{children:"Ledos"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{})]}),Lt.map(u=>{const R=u.messages_count||u.audience_count||"--",G=u.read_count||"--",ae=u.reply_count||"--",ie=jd[u.status]||u.status;return s.jsxs("div",{className:"campaigns-table-row",children:[s.jsxs("div",{className:"campaigns-table-title",children:[s.jsx("div",{className:"campaigns-table-name",children:u.name}),s.jsxs("div",{className:"campaigns-table-ref",children:["Ref: ",u.id.slice(0,10)]})]}),s.jsx("div",{className:"campaigns-table-date",children:w(u.created_at)}),s.jsx("div",{className:"campaigns-table-tags",children:s.jsx("span",{className:"campaigns-pill",children:u.audience_label||"Base General"})}),s.jsx("div",{className:"campaigns-metric",children:R}),s.jsx("div",{className:"campaigns-metric",children:G}),s.jsx("div",{className:"campaigns-metric",children:ae}),s.jsx("div",{className:`campaigns-status ${u.status}`,children:ie}),s.jsx("button",{className:"campaigns-row-action",type:"button",children:"..."})]},u.id)}),!Lt.length&&s.jsx("div",{className:"empty-state",children:"Sin campaas registradas"})]}),s.jsxs("div",{className:"campaigns-table-footer",children:[s.jsxs("span",{children:["Mostrando ",Lt.length," de ",i.length," campaas"]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:W<=1,onClick:()=>{const u=Math.max(1,W-1);Y(u),T(u,Z)},children:"<"}),kr.pages.map(u=>s.jsx("button",{className:`audiences-page-btn ${u===W?"active":""}`,type:"button",onClick:()=>{Y(u),T(u,Z)},children:u},`camp-page-${u}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:W>=kr.totalPages,onClick:()=>{const u=Math.min(kr.totalPages,W+1);Y(u),T(u,Z)},children:">"})]})]})]})]})}),Ne==="history"&&s.jsxs("section",{className:"campaigns-panel campaigns-history",children:[s.jsxs("div",{className:"campaigns-history-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"campaigns-history-title",children:"Historial de Envos"}),s.jsx("div",{className:"campaigns-history-subtitle",children:"ltimos 30 das"})]}),s.jsx("button",{className:"campaigns-link",type:"button",onClick:T,children:"Ver todo el historial"})]}),s.jsxs("div",{className:"history-table history-table--main",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"Campaa / Fecha"}),s.jsx("span",{children:"Alcance"}),s.jsx("span",{children:"Tasa de lectura"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),i.map(u=>{const R=jd[u.status]||u.status,G=u.audience_count||u.messages_count||u.total||"--";return s.jsxs("div",{className:"history-row",children:[s.jsxs("div",{className:"history-title",children:[s.jsx("div",{className:"history-name",children:u.name}),s.jsx("div",{className:"history-date",children:w(u.created_at)})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:G}),s.jsx("div",{className:"history-label",children:"contactos"})]}),s.jsxs("div",{className:"history-meter",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-bar",children:s.jsx("div",{className:"history-bar-fill",style:{width:"0%"}})})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-label",children:"mensajes"})]}),s.jsx("div",{className:`history-status ${u.status}`,children:R}),s.jsxs("div",{className:"history-actions",children:[s.jsx("button",{className:"campaigns-ghost small",type:"button",onClick:()=>y(u.id),children:"Ver mensajes"}),s.jsx("button",{className:"campaigns-danger small",type:"button",onClick:()=>A(u.id),disabled:u.status==="sending",children:"Enviar"})]})]},u.id)}),!i.length&&s.jsx("div",{className:"empty-state",children:"Sin Campaas registradas"})]}),l&&s.jsxs("div",{className:"campaigns-messages",children:[s.jsx("div",{className:"campaigns-history-title",children:"Mensajes"}),s.jsxs("div",{className:"history-table history-table--messages",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"WA"}),s.jsx("span",{children:"Status"}),s.jsx("span",{children:"Enviado"})]}),o.map(u=>s.jsxs("div",{className:"history-row",children:[s.jsx("span",{children:u.wa_id}),s.jsx("span",{children:u.status}),s.jsx("span",{children:w(u.sent_at)})]},u.id))]})]})]})]})})]}),P&&s.jsx("div",{className:"modal-overlay",onClick:()=>N(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:u=>u.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Previsualizar plantilla"}),s.jsx("button",{className:"modal-close",onClick:()=>N(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsx("div",{className:"preview-phone",children:s.jsx("div",{className:"preview-phone-body",children:s.jsx("div",{className:"preview-bubble",children:(D==null?void 0:D.body_preview)||(D==null?void 0:D.body_text)||"Sin previsualizacin disponible."})})})})]})})]})}const Cx={admin:{title:"Administrador",subtitle:"Acceso total",tone:"alert"},recepcion:{title:"Operador",subtitle:"Atencion al cliente",tone:"info"},caja:{title:"Supervisor",subtitle:"Auditoria y gestion",tone:"dark"},marketing:{title:"Marketing",subtitle:"Crecimiento y campanas",tone:"info"},doctor:{title:"Doctor",subtitle:"Atencion al cliente",tone:"dark"}},wd=[{id:"chat",label:"Chat"},{id:"dashboard",label:"Dashboard"},{id:"campaigns",label:"Campanas"}],_d=[{id:"general",label:"General"},{id:"users",label:"Gestion de Usuarios"},{id:"bot",label:"Configuracion de Bot"},{id:"templates",label:"Plantillas de Meta"},{id:"audit",label:"Registros / Auditoria"},{id:"odoo",label:"Integracion Odoo"}];function Sd(e){return Cx[e]||{title:e,subtitle:"Acceso personalizado",tone:"info"}}function Ex({settingsTab:e,setSettingsTab:t,rolePermissions:n,setRolePermissions:r,isAdmin:a,adminUsers:i,userForm:l,setUserForm:o,roleOptions:c,handleUserSubmit:f,handleUserDelete:x,defaultRolePermissions:g,handleRoleDelete:j}){const[T,y]=m.useState(""),[A,w]=m.useState(!1),[d,p]=m.useState(""),[v,S]=m.useState(null),[P,N]=m.useState(!1),[D,E]=m.useState("create"),[$,F]=m.useState("recepcion"),[te,he]=m.useState({modules:{},settings:{}}),xe=m.useMemo(()=>{const C=T.trim().toLowerCase(),ee=i||[];return C?ee.filter(V=>{var me,de;const U=((me=V.name)==null?void 0:me.toLowerCase())||"",re=((de=V.email)==null?void 0:de.toLowerCase())||"";return U.includes(C)||re.includes(C)}):ee},[i,T]);function Be(C){const ee=(n==null?void 0:n[C])||(g==null?void 0:g[C])||{modules:{},settings:{}};return{modules:{...ee.modules||{}},settings:{...ee.settings||{}}}}function we(C,ee="edit"){E(ee),F(C),he(Be(C)),N(!0)}function pe(C,ee,V){he(U=>{const re={...U},me={...re[C]||{}},de={...me[ee]||{}},ye=!de[V];return de[V]=ye,V==="write"&&ye&&(de.read=!0),V==="read"&&!ye&&(de.write=!1),me[ee]=de,re[C]=me,re})}function Oe(){$&&(r(C=>({...C,[$]:te})),N(!1))}function B(){$&&j&&j($),N(!1)}function H(C,ee,V,U){a&&r(re=>{var at,Et;const me={...re},de={modules:{...(at=me[C])==null?void 0:at.modules},settings:{...(Et=me[C])==null?void 0:Et.settings}},ye={...de[ee]},Xe={...ye[V]},Je=!Xe[U];return Xe[U]=Je,U==="write"&&Je&&(Xe.read=!0),U==="read"&&!Je&&(Xe.write=!1),ye[V]=Xe,de[ee]=ye,me[C]=de,me})}function b(C){return Sd(C).title.toUpperCase()}function W(C,ee){return C!=null&&C.id?`OP-${C.id.slice(-4).toUpperCase()}`:`OP-${String(ee+1).padStart(4,"0")}`}function Y(C){o({id:C.id,name:C.name,email:C.email,role:C.role,password:"",is_active:C.is_active}),w(!0)}function Z(){o({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),w(!0)}return s.jsxs("div",{className:"users-page",children:[s.jsxs("header",{className:"users-header",children:[s.jsxs("div",{className:"users-title-row",children:[s.jsx("span",{className:"users-kicker"}),s.jsxs("div",{children:[s.jsx("div",{className:"users-title",children:"Gestion de Usuarios"}),s.jsx("div",{className:"users-subtitle",children:"Administra los accesos y roles de los operadores de tu empresa."})]})]}),s.jsxs("div",{className:"users-actions",children:[e==="list"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"users-search",children:[s.jsx("span",{className:"users-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar usuario...",value:T,onChange:C=>y(C.target.value)})]}),s.jsx("button",{className:"settings-primary",type:"button",onClick:Z,children:"Nuevo Usuario"})]}),e==="roles"&&s.jsx("button",{className:"settings-primary",type:"button",onClick:()=>we("recepcion","create"),children:"+ Nuevo Rol"})]})]}),s.jsxs("div",{className:"users-tabs",children:[s.jsx("button",{className:`users-tab ${e==="list"?"active":""}`,type:"button",onClick:()=>t("list"),children:"Lista de Usuarios"}),s.jsx("button",{className:`users-tab ${e==="roles"?"active":""}`,type:"button",onClick:()=>t("roles"),children:"Roles y Permisos"})]}),e==="list"&&s.jsxs("div",{className:"users-table",children:[s.jsxs("div",{className:"users-table-head",children:[s.jsx("span",{children:"Nombre / Usuario"}),s.jsx("span",{children:"Email"}),s.jsx("span",{children:"Rol"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),xe.map((C,ee)=>{var V;return s.jsxs("div",{className:"users-row",children:[s.jsxs("div",{className:"users-cell user-name",children:[s.jsx("div",{className:"user-avatar",children:((V=C.name)==null?void 0:V[0])||"?"}),s.jsxs("div",{children:[s.jsx("div",{className:"user-title",children:C.name}),s.jsx("div",{className:"user-id",children:W(C,ee)})]})]}),s.jsx("div",{className:"users-cell",children:C.email}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`role-pill ${C.role}`,children:b(C.role)})}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`status-pill ${C.is_active?"active":"inactive"}`,children:C.is_active?"Activo":"Inactivo"})}),s.jsx("div",{className:"users-cell",children:s.jsxs("div",{className:"users-actions-menu",children:[s.jsx("button",{className:"users-action",type:"button",onClick:()=>p(U=>U===C.id?"":C.id),children:"..."}),d===C.id&&s.jsxs("div",{className:"users-menu",children:[s.jsx("button",{type:"button",onClick:()=>{p(""),Y(C)},children:"Editar"}),s.jsx("button",{type:"button",onClick:()=>{p(""),S(C)},children:"Eliminar"})]})]})})]},C.id)}),!xe.length&&s.jsx("div",{className:"empty-state",children:"Sin usuarios para mostrar"})]}),e==="roles"&&s.jsx("div",{className:"roles-grid",children:c.map(C=>{const ee=Sd(C),V=n==null?void 0:n[C];return s.jsxs("div",{className:"role-card",children:[s.jsxs("div",{className:"role-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"role-title",children:ee.title}),s.jsx("div",{className:`role-subtitle ${ee.tone}`,children:ee.subtitle})]}),s.jsx("button",{className:"role-edit",type:"button",onClick:()=>we(C,"edit"),children:"edit"})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),wd.map(U=>{var re,me,de,ye;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((me=(re=V==null?void 0:V.modules)==null?void 0:re[U.id])==null?void 0:me.read)||!1,disabled:!a,onChange:()=>H(C,"modules",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ye=(de=V==null?void 0:V.modules)==null?void 0:de[U.id])==null?void 0:ye.write)||!1,disabled:!a,onChange:()=>H(C,"modules",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsx("div",{className:"role-settings-title",children:"Configuracion"}),_d.map(U=>{var re,me,de,ye;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((me=(re=V==null?void 0:V.settings)==null?void 0:re[U.id])==null?void 0:me.read)||!1,disabled:!a,onChange:()=>H(C,"settings",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ye=(de=V==null?void 0:V.settings)==null?void 0:de[U.id])==null?void 0:ye.write)||!1,disabled:!a,onChange:()=>H(C,"settings",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]})]},C)})}),A&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:l.id?"Editar usuario":"Crear usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>w(!1),children:"x"})]}),s.jsxs("form",{className:"form-grid",onSubmit:async C=>{await f(C),w(!1)},children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:C=>o(ee=>({...ee,name:C.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:l.email,onChange:C=>o(ee=>({...ee,email:C.target.value})),disabled:!!l.id})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),s.jsx("select",{value:l.role,onChange:C=>o(ee=>({...ee,role:C.target.value})),children:c.map(C=>s.jsx("option",{value:C,children:C},C))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:l.password,onChange:C=>o(ee=>({...ee,password:C.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:C=>o(ee=>({...ee,is_active:C.target.checked}))}),"Activo"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"primary",type:"submit",children:l.id?"Guardar cambios":"Crear"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>w(!1),children:"Cancelar"})]})]})]})}),v&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Eliminar usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>S(null),children:"x"})]}),s.jsxs("p",{className:"modal-text",children:["Vas a desactivar a ",s.jsx("strong",{children:v.email}),". Continuar?"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"danger",type:"button",onClick:()=>{x==null||x(v.id),S(null)},children:"Eliminar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>S(null),children:"Cancelar"})]})]})}),P&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card modal-lg",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:D==="create"?"Nuevo rol":"Editar rol"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>N(!1),children:"x"})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),D==="edit"?s.jsx("select",{value:$,disabled:!0,children:c.map(C=>s.jsx("option",{value:C,children:C},C))}):s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"text",list:"role-options",placeholder:"nuevo-rol",value:$,onChange:C=>F(C.target.value)}),s.jsx("datalist",{id:"role-options",children:c.map(C=>s.jsx("option",{value:C},C))})]})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Modulos"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),wd.map(C=>{var ee,V,U,re;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:C.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((V=(ee=te==null?void 0:te.modules)==null?void 0:ee[C.id])==null?void 0:V.read)||!1,onChange:()=>pe("modules",C.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((re=(U=te==null?void 0:te.modules)==null?void 0:U[C.id])==null?void 0:re.write)||!1,onChange:()=>pe("modules",C.id,"write")}),s.jsx("span",{})]})]},C.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Configuracion"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),_d.map(C=>{var ee,V,U,re;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:C.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((V=(ee=te==null?void 0:te.settings)==null?void 0:ee[C.id])==null?void 0:V.read)||!1,onChange:()=>pe("settings",C.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((re=(U=te==null?void 0:te.settings)==null?void 0:U[C.id])==null?void 0:re.write)||!1,onChange:()=>pe("settings",C.id,"write")}),s.jsx("span",{})]})]},C.id)})]})]}),s.jsxs("div",{className:"form-actions",children:[D==="edit"&&s.jsx("button",{className:"danger",type:"button",onClick:B,children:"Eliminar rol"}),s.jsx("button",{className:"primary",type:"button",onClick:Oe,disabled:!$,children:"Guardar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>N(!1),children:"Cancelar"})]})]})})]})}function Tx({branches:e,branchForm:t,setBranchForm:n,handleBranchSubmit:r,handleBranchDisable:a,services:i,serviceForm:l,setServiceForm:o,handleServiceSubmit:c,handleServiceDisable:f,handleServiceBranchToggle:x,tenantChannels:g,channelForm:j,setChannelForm:T,handleChannelSelect:y,handleChannelSubmit:A}){return s.jsxs("div",{className:"page-grid",children:[s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Sucursales"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Nombre"}),s.jsx("span",{children:"Codigo"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Accion"})]}),e.map(w=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:w.name}),s.jsx("span",{children:w.code}),s.jsx("span",{children:w.is_active?"Activa":"Inactiva"}),s.jsxs("div",{className:"row-actions",children:[s.jsx("button",{className:"ghost",onClick:()=>n({id:w.id,code:w.code,name:w.name,address:w.address,lat:w.lat,lng:w.lng,hours_text:w.hours_text,phone:w.phone||"",is_active:w.is_active}),children:"Editar"}),s.jsx("button",{className:"danger",onClick:()=>a(w.id),children:"Desactivar"})]})]},w.id))]}),s.jsx("div",{className:"panel-title",children:t.id?"Editar sucursal":"Crear sucursal"}),s.jsxs("form",{className:"form-grid",onSubmit:r,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Codigo"}),s.jsx("input",{type:"text",value:t.code,onChange:w=>n(d=>({...d,code:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:t.name,onChange:w=>n(d=>({...d,name:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Direccion"}),s.jsx("input",{type:"text",value:t.address,onChange:w=>n(d=>({...d,address:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Lat"}),s.jsx("input",{type:"number",value:t.lat,onChange:w=>n(d=>({...d,lat:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Lng"}),s.jsx("input",{type:"number",value:t.lng,onChange:w=>n(d=>({...d,lng:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Telefono"}),s.jsx("input",{type:"text",value:t.phone,onChange:w=>n(d=>({...d,phone:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Horarios"}),s.jsx("textarea",{rows:"3",value:t.hours_text,onChange:w=>n(d=>({...d,hours_text:w.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:t.is_active,onChange:w=>n(d=>({...d,is_active:w.target.checked}))}),"Activa"]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Guardar"})})]})]}),s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Servicios"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Servicio"}),s.jsx("span",{children:"Precio"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Accion"})]}),i.map(w=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:w.name}),s.jsxs("span",{children:["Bs ",w.price_bob]}),s.jsx("span",{children:w.is_active?"Activo":"Inactivo"}),s.jsxs("div",{className:"row-actions",children:[s.jsx("button",{className:"ghost",onClick:()=>o({id:w.id,code:w.code,name:w.name,subtitle:w.subtitle||"",description:w.description,price_bob:w.price_bob,duration_min:w.duration_min||"",image_url:w.image_url||"",is_featured:w.is_featured,is_active:w.is_active}),children:"Editar"}),s.jsx("button",{className:"danger",onClick:()=>f(w.id),children:"Desactivar"})]})]},w.id))]}),s.jsx("div",{className:"panel-title",children:l.id?"Editar servicio":"Crear servicio"}),s.jsxs("form",{className:"form-grid",onSubmit:c,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Codigo"}),s.jsx("input",{type:"text",value:l.code,onChange:w=>o(d=>({...d,code:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:w=>o(d=>({...d,name:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Subtitulo"}),s.jsx("input",{type:"text",value:l.subtitle,onChange:w=>o(d=>({...d,subtitle:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Descripcion"}),s.jsx("textarea",{rows:"3",value:l.description,onChange:w=>o(d=>({...d,description:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Precio (Bs)"}),s.jsx("input",{type:"number",value:l.price_bob,onChange:w=>o(d=>({...d,price_bob:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Duracion (min)"}),s.jsx("input",{type:"number",value:l.duration_min,onChange:w=>o(d=>({...d,duration_min:w.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Imagen URL"}),s.jsx("input",{type:"text",value:l.image_url,onChange:w=>o(d=>({...d,image_url:w.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_featured,onChange:w=>o(d=>({...d,is_featured:w.target.checked}))}),"Destacado"]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:w=>o(d=>({...d,is_active:w.target.checked}))}),"Activo"]}),l.id&&s.jsxs("div",{className:"field",children:[s.jsx("span",{children:"Disponibilidad por sucursal"}),s.jsx("div",{className:"chip-grid",children:e.map(w=>{var v,S;const d=(S=(v=i.find(P=>P.id===l.id))==null?void 0:v.branches)==null?void 0:S.find(P=>{var D;return(((D=P.branch)==null?void 0:D.id)||P.branch_id)===w.id}),p=(d==null?void 0:d.is_available)||!1;return s.jsxs("label",{className:"chip",children:[s.jsx("input",{type:"checkbox",checked:p,onChange:P=>x(i.find(N=>N.id===l.id),w.id,P.target.checked)}),w.name]},w.id)})})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Guardar"})})]})]}),s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Lineas de WhatsApp"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Nombre"}),s.jsx("span",{children:"Phone ID"}),s.jsx("span",{children:"Accion"})]}),(g||[]).map(w=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:w.display_name||"Linea sin nombre"}),s.jsx("span",{children:w.phone_number_id}),s.jsx("button",{className:"ghost",onClick:()=>y(w),children:"Renombrar"})]},w.id)),!(g!=null&&g.length)&&s.jsx("div",{className:"empty-state",children:"Sin lineas registradas"})]}),s.jsx("div",{className:"panel-title",children:j.id?"Editar linea":"Selecciona una linea"}),s.jsxs("form",{className:"form-grid",onSubmit:A,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre visible"}),s.jsx("input",{type:"text",value:j.display_name,onChange:w=>T(d=>({...d,display_name:w.target.value})),disabled:!j.id})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",disabled:!j.id,children:"Guardar"})})]})]})]})}function Ax(){var y,A,w,d,p,v,S,P,N,D;const[e,t]=m.useState([]),[n,r]=m.useState(null),[a,i]=m.useState(!0),[l,o]=m.useState("");m.useEffect(()=>{c()},[]);async function c(){i(!0);try{const[E,$]=await Promise.all([ce("/api/admin/bots"),ce("/api/admin/bots/metrics")]);t(E.bots||[]),r($.metrics),o("")}catch(E){console.error(E),o(E.message||"Error al cargar datos")}finally{i(!1)}}async function f(E,$){try{await Ge(`/api/admin/bots/${E}`,{is_active:$}),t(F=>F.map(te=>te.id===E?{...te,is_active:$}:te))}catch(F){o(F.message||"Error al cambiar estado")}}const x=E=>{if(!E)return"Sin actividad reciente";const $=new Date(E),te=new Date-$,he=Math.floor(te/6e4);if(he<1)return"Hace un momento";if(he<60)return`ltima actividad: hace ${he} min`;const xe=Math.floor(he/60);return xe<24?`ltima actividad: hace ${xe}h`:`ltima actividad: ${$.toLocaleDateString()}`},g=e.filter(E=>E.is_active).length,j=g>0?"ACTIVO":"INACTIVO",T=g>0?"active":"inactive";return s.jsxs("div",{className:"bot-section",children:[s.jsxs("div",{className:"bot-section-header",children:[s.jsxs("div",{className:"bot-section-title-area",children:[s.jsx("div",{className:"bot-section-icon",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"bot-section-title",children:"Gestin de Bots"}),s.jsx("p",{className:"bot-section-subtitle",children:"Administra los flujos automatizados y el rendimiento tcnico."})]})]}),s.jsxs("div",{className:"bot-section-global-toggle",children:[s.jsx("span",{className:"bot-toggle-label",children:"ESTADO DEL BOT:"}),s.jsxs("div",{className:`bot-toggle-pill ${T}`,children:[s.jsx("span",{className:"bot-toggle-dot"}),s.jsx("span",{children:j})]})]})]}),l&&s.jsx("div",{className:"bot-error",children:l}),s.jsxs("div",{className:"bot-section-content",children:[s.jsxs("div",{className:"bot-flows-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MONITOREO DE FLUJOS"})}),a?s.jsx("div",{className:"bot-loading",children:"Cargando bots..."}):e.length===0?s.jsxs("div",{className:"bot-empty",children:[s.jsx("p",{children:"No hay bots asignados a tu cuenta."}),s.jsx("p",{className:"bot-empty-hint",children:"Contacta con soporte si necesitas activar un bot."})]}):s.jsx("div",{className:"bot-flows-list",children:e.map(E=>s.jsxs("div",{className:"bot-flow-card",children:[s.jsxs("div",{className:"bot-flow-info",children:[s.jsx("span",{className:"bot-flow-icon",children:E.flow_icon||""}),s.jsxs("div",{children:[s.jsx("div",{className:"bot-flow-name",children:E.flow_name}),s.jsxs("div",{className:`bot-flow-status ${E.is_active?"active":"inactive"}`,children:[" ",E.is_active?"ACTIVO":"INACTIVO"]})]})]}),s.jsx("div",{className:"bot-flow-actions",children:s.jsxs("label",{className:"bot-toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:E.is_active,onChange:()=>f(E.id,!E.is_active)}),s.jsx("span",{className:"bot-toggle-slider"})]})}),s.jsx("div",{className:"bot-flow-meta",children:x(E.updated_at)}),E.flow_description&&s.jsx("div",{className:"bot-flow-desc",children:E.flow_description})]},E.id))})]}),s.jsxs("div",{className:"bot-metrics-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MTRICAS DE EFICACIA DETALLADAS"})}),s.jsxs("div",{className:"bot-metrics-grid",children:[s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:`bot-metric-badge ${((y=n==null?void 0:n.interactions)==null?void 0:y.change)>=0?"positive":"neutral"}`,children:[((A=n==null?void 0:n.interactions)==null?void 0:A.change)>0?"+":"",(w=n==null?void 0:n.interactions)==null?void 0:w.change,"% ",(d=n==null?void 0:n.interactions)==null?void 0:d.label]}),s.jsx("div",{className:"bot-metric-label",children:"INTERACCIONES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.interactions.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"Total de sesiones iniciadas hoy"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge neutral",children:["Objetivo: ",(p=n==null?void 0:n.resolution)==null?void 0:p.target,"%"]}),s.jsx("div",{className:"bot-metric-label",children:"RESOLUCIN FINAL"}),s.jsxs("div",{className:"bot-metric-value",children:[n?n.resolution.value:"--","%"]}),s.jsx("div",{className:"bot-metric-progress",children:s.jsx("div",{className:"bot-metric-progress-fill",style:{width:`${n?n.resolution.value:0}%`}})})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge sla",children:[" ",(v=n==null?void 0:n.uptime)==null?void 0:v.status]}),s.jsx("div",{className:"bot-metric-label",children:"VIDA DEL PROCESO"}),s.jsx("div",{className:"bot-metric-value",children:n?n.uptime.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"UPTIME SISTEMA"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:`bot-metric-icon ${((S=n==null?void 0:n.errors)==null?void 0:S.value)>0?"error":""}`,children:""}),s.jsx("div",{className:`bot-metric-badge ${((P=n==null?void 0:n.errors)==null?void 0:P.value)===0?"stable":"neutral"}`,children:(N=n==null?void 0:n.errors)==null?void 0:N.status}),s.jsx("div",{className:"bot-metric-label",children:"ERRORES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.errors.value:"--"}),s.jsxs("div",{className:`bot-metric-sub ${((D=n==null?void 0:n.errors)==null?void 0:D.critical)>0?"error-sub":""}`,children:["CRTICOS: ",n?n.errors.critical:0]})]})]})]})]})]})}const kd={DRAFT:{bg:"#e3e8ef",text:"#475569",label:"BORRADOR"},PENDING:{bg:"#fef3c7",text:"#d97706",label:"PENDIENTE"},APPROVED:{bg:"#d1fae5",text:"#059669",label:"APROBADA"},REJECTED:{bg:"#fee2e2",text:"#dc2626",label:"RECHAZADA"},PAUSED:{bg:"#fef3c7",text:"#d97706",label:"PAUSADA"},DISABLED:{bg:"#e5e7eb",text:"#6b7280",label:"DESHABILITADA"}},Lx=[{value:"UTILITY",label:"Utility"},{value:"MARKETING",label:"Marketing"},{value:"AUTHENTICATION",label:"Authentication"}],Ox=[{value:"es",label:"Espaol (ES)"},{value:"en",label:"English (EN)"}];function Rx({templates:e=[],templateForm:t,setTemplateForm:n,handleTemplateSubmit:r,handleTemplateSubmitToMeta:a,handleTemplateDelete:i,handleSyncTemplates:l,onLoadTemplates:o}){const[c,f]=m.useState("list"),[x,g]=m.useState(null),[j,T]=m.useState(""),[y,A]=m.useState(!1),[w,d]=m.useState(""),[p,v]=m.useState(!1),[S,P]=m.useState(null),[N,D]=m.useState({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),[E,$]=m.useState([]);m.useEffect(()=>{o&&o()},[]),m.useEffect(()=>{if(!S)return;const b=W=>{W.target.closest(".template-card-menu")||P(null)};return document.addEventListener("click",b),()=>document.removeEventListener("click",b)},[S]);const F=async()=>{A(!0);try{await l()}finally{A(!1)}},te=()=>{g(null),D({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),$([]),f("editor")},he=b=>{g(b),D({name:b.name||"",category:b.category||"UTILITY",language:b.language||"es",body_text:b.body_text||b.body_preview||"",header_type:b.header_type||"",header_content:b.header_content||"",footer_text:b.footer_text||"",buttons:b.buttons_json||[]}),$(b.variable_mappings||[]),f("editor")},xe=async b=>{!(b!=null&&b.id)||!i||!window.confirm(`Eliminar la plantilla "${b.name}"? Esta accin la ocultar localmente y la eliminar de Meta si aplica.`)||(await i(b.id),P(null))},Be=async b=>{b.preventDefault();const W={...N,id:x==null?void 0:x.id,variable_mappings:E};if(n&&n(W),r){const Y=await r(null,W);Y&&g(Y)}},we=async()=>{if(a){v(!0);try{let b=x==null?void 0:x.id;if(!b){const W={...N,variable_mappings:E},Y=await r(null,W);b=Y==null?void 0:Y.id,Y&&g(Y)}b&&(await a(b),f("list"),g(null))}finally{v(!1)}}},pe=()=>{f("list"),g(null)},B=(b=>{const W=b.match(/\{\{(\d+)\}\}/g)||[];return[...new Set(W)].map(Y=>parseInt(Y.replace(/[{}]/g,"")))})(N.body_text),H=e.filter(b=>{var Z;const W=!j||((Z=b.name)==null?void 0:Z.toLowerCase().includes(j.toLowerCase()))||(b.body_text||b.body_preview||"").toLowerCase().includes(j.toLowerCase()),Y=!w||b.status===w;return W&&Y});return c==="list"?s.jsxs("div",{className:"templates-section",children:[s.jsxs("div",{className:"templates-header",children:[s.jsxs("div",{className:"templates-title-row",children:[s.jsx("h1",{children:"Plantillas de Meta"}),s.jsxs("span",{className:"meta-connected-badge",children:[s.jsx("span",{className:"status-dot"}),"CONECTADO A META API"]})]}),s.jsxs("div",{className:"templates-actions",children:[s.jsx("div",{className:"search-input-wrap",children:s.jsx("input",{type:"text",placeholder:"Buscar plantillas...",value:j,onChange:b=>T(b.target.value)})}),s.jsxs("select",{value:w,onChange:b=>d(b.target.value),className:"status-filter-select",children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"APPROVED",children:"Aprobadas"}),s.jsx("option",{value:"PENDING",children:"Pendientes"}),s.jsx("option",{value:"REJECTED",children:"Rechazadas"}),s.jsx("option",{value:"DRAFT",children:"Borradores"})]}),s.jsx("button",{className:"btn-sync",onClick:F,disabled:y,children:y?" Sincronizando...":" Sincronizar"}),s.jsxs("button",{className:"btn-create-template",onClick:te,children:[s.jsx("span",{children:"+"})," Crear Nueva Plantilla"]})]})]}),s.jsxs("div",{className:"templates-grid",children:[H.map(b=>{var Y;const W=kd[b.status]||kd.DRAFT;return s.jsxs("div",{className:"template-card",onClick:()=>he(b),children:[s.jsxs("div",{className:"template-card-head",children:[s.jsx("div",{className:"template-category-icon",children:b.category==="MARKETING"?"":b.category==="UTILITY"?"":""}),s.jsx("span",{className:"template-status-badge",style:{backgroundColor:W.bg,color:W.text},children:W.label})]}),s.jsx("h3",{className:"template-card-name",children:b.name}),s.jsxs("div",{className:"template-card-meta",children:[s.jsx("span",{className:"tag-category",children:b.category}),s.jsx("span",{className:"tag-language",children:b.language==="es"?"ESPAOL (ES)":(Y=b.language)==null?void 0:Y.toUpperCase()})]}),(b.body_text||b.body_preview)&&s.jsxs("p",{className:"template-card-preview",children:[(b.body_text||b.body_preview).slice(0,80),"..."]}),s.jsxs("div",{className:"template-card-actions",children:[s.jsx("button",{className:"btn-preview",onClick:Z=>{Z.stopPropagation(),he(b)},children:" Previsualizar"}),s.jsxs("div",{className:"template-card-menu",onClick:Z=>Z.stopPropagation(),children:[s.jsx("button",{className:"btn-more",type:"button",onClick:()=>P(Z=>Z===b.id?null:b.id),children:""}),S===b.id&&s.jsxs("div",{className:"template-menu-dropdown",children:[s.jsx("button",{type:"button",className:"menu-item",onClick:()=>he(b),children:"Editar"}),s.jsx("button",{type:"button",className:"menu-item danger",onClick:()=>xe(b),children:"Eliminar"})]})]})]})]},b.id)}),s.jsxs("div",{className:"template-card template-card-create",onClick:te,children:[s.jsx("div",{className:"create-icon",children:"+"}),s.jsx("h3",{children:"Crear nueva plantilla"}),s.jsx("p",{children:"Empieza a disear tu flujo de WhatsApp"})]})]}),H.length===0&&!j&&s.jsx("div",{className:"templates-empty",children:s.jsx("p",{children:"No hay plantillas. Crea una nueva o sincroniza desde Meta."})})]}):s.jsxs("div",{className:"template-editor",children:[s.jsxs("div",{className:"editor-header",children:[s.jsxs("div",{className:"editor-breadcrumb",children:[s.jsx("button",{className:"btn-back",onClick:pe,children:" Volver"}),s.jsx("span",{className:"breadcrumb-sep",children:"/"}),s.jsx("span",{children:x?"Editar Plantilla":"Nueva Plantilla"})]}),s.jsxs("div",{className:"editor-actions",children:[s.jsx("button",{className:"btn-save-draft",onClick:Be,children:" Guardar Borrador"}),((x==null?void 0:x.status)==="DRAFT"||(x==null?void 0:x.status)==="REJECTED"||!x)&&s.jsx("button",{className:"btn-primary",onClick:we,disabled:p||!N.name||!N.body_text,children:p?"Enviando...":"Enviar a Meta"}),s.jsx("button",{className:"btn-discard",onClick:pe,children:" Descartar"})]})]}),s.jsxs("div",{className:"editor-layout",children:[s.jsxs("div",{className:"editor-form-panel",children:[s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" General Settings"}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Template Name"}),s.jsx("input",{type:"text",placeholder:"patient_appointment_reminder",value:N.name,onChange:b=>D({...N,name:b.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")})})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Category"}),s.jsx("select",{value:N.category,onChange:b=>D({...N,category:b.target.value}),children:Lx.map(b=>s.jsx("option",{value:b.value,children:b.label},b.value))})]}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Language"}),s.jsx("select",{value:N.language,onChange:b=>D({...N,language:b.target.value}),children:Ox.map(b=>s.jsx("option",{value:b.value,children:b.label},b.value))})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("div",{className:"form-section-header",children:[s.jsx("h3",{children:" Message Body"}),s.jsx("button",{className:"btn-insert-var",type:"button",onClick:()=>{const b=B.length+1;D({...N,body_text:N.body_text+`{{${b}}}`})},children:"+ Insert Variable"})]}),s.jsx("textarea",{rows:"6",placeholder:"Hola {{1}}, te recordamos tu cita en PODOPIE para el da {{2}} a las {{3}}. Por favor, confirma tu asistencia.",value:N.body_text,onChange:b=>D({...N,body_text:b.target.value})}),s.jsxs("div",{className:"char-count",children:[N.body_text.length," / 1024"]})]})]}),s.jsxs("div",{className:"editor-preview-panel",children:[s.jsxs("div",{className:"phone-frame",children:[s.jsxs("div",{className:"phone-header",children:[s.jsx("span",{className:"phone-back",children:""}),s.jsxs("div",{className:"phone-contact",children:[s.jsx("div",{className:"phone-avatar",children:""}),s.jsx("div",{className:"phone-name",children:"PODOPIE Clinic"})]}),s.jsx("div",{className:"phone-icons",children:" "})]}),s.jsxs("div",{className:"phone-body",children:[s.jsx("div",{className:"phone-date-label",children:"TODAY"}),s.jsxs("div",{className:"phone-message",children:[s.jsx("div",{className:"message-bubble",children:N.body_text||"Tu mensaje aparecer aqu..."}),s.jsx("div",{className:"message-time",children:"10:42 AM"})]}),N.buttons&&N.buttons.length>0&&s.jsx("div",{className:"phone-buttons",children:N.buttons.map((b,W)=>s.jsx("button",{className:"phone-action-btn",children:b.text||`Button ${W+1}`},W))})]})]}),s.jsx("div",{className:"preview-label",children:" High-fidelity dynamic preview"})]}),s.jsxs("div",{className:"editor-mapping-panel",children:[s.jsxs("div",{className:"mapping-tabs",children:[s.jsx("button",{className:"tab active",children:"VARIABLES"}),s.jsx("button",{className:"tab",children:"BUTTONS"})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsx("h4",{children:"ODOO FIELD MAPPING"}),B.length===0?s.jsxs("p",{className:"mapping-empty",children:["Agrega variables ","{{1}}",", ","{{2}}","... en tu mensaje"]}):B.map(b=>{const W=E.find(Y=>Y.var_index===b)||{};return s.jsxs("div",{className:"mapping-item",children:[s.jsxs("div",{className:"mapping-var-badge",children:[`{{${b}}}`," Variable"]}),s.jsxs("select",{value:W.source_path||"",onChange:Y=>{const Z=E.filter(C=>C.var_index!==b);Z.push({var_index:b,source_type:"odoo",source_path:Y.target.value}),$(Z)},children:[s.jsx("option",{value:"",children:"Select Odoo Field..."}),s.jsx("option",{value:"partner_id.name",children:"patient_id.name"}),s.jsx("option",{value:"start_date",children:"start_date (Formatted)"}),s.jsx("option",{value:"start_time",children:"start_time"}),s.jsx("option",{value:"partner_id.phone",children:"patient_phone"})]}),s.jsx("span",{className:`mapping-status ${W.source_path?"linked":"needs"}`,children:W.source_path?" Linked":" Needs mapping"})]},b)})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsxs("div",{className:"mapping-section-header",children:[s.jsx("h4",{children:"ACTION BUTTONS"}),s.jsx("button",{className:"btn-add-button",onClick:()=>{D({...N,buttons:[...N.buttons||[],{type:"QUICK_REPLY",text:""}]})},children:"+ Add Button"})]}),(N.buttons||[]).map((b,W)=>s.jsxs("div",{className:"button-item",children:[s.jsx("span",{className:"button-icon",children:""}),s.jsx("input",{type:"text",placeholder:"Button text",value:b.text||"",onChange:Y=>{const Z=[...N.buttons];Z[W]={...Z[W],text:Y.target.value},D({...N,buttons:Z})}}),s.jsx("button",{className:"btn-remove",onClick:()=>{const Y=N.buttons.filter((Z,C)=>C!==W);D({...N,buttons:Y})},children:""})]},W))]}),s.jsxs("div",{className:"mapping-tip",children:[s.jsx("span",{className:"tip-icon",children:""}),s.jsx("span",{children:"Tip: Asegrate de que tus variables estn correctamente mapeadas a campos de Odoo antes de enviar."})]})]})]})]})}const bd={campaigns:"",users:"",bot:"",chat:"",templates:"",audience:"",system:""},Px={"user.created":"USUARIO CREADO","user.updated":"USUARIO EDITADO","user.disabled":"USUARIO ELIMINADO",template_draft_created:"PLANTILLA CREADA",template_draft_updated:"PLANTILLA EDITADA",template_submitted:"PLANTILLA ENVIADA",template_deleted:"PLANTILLA ELIMINADA",template_restored:"PLANTILLA RESTAURADA",audience_created:"SEGMENTO CREADO",audience_updated:"SEGMENTO EDITADO",audience_deleted:"SEGMENTO ELIMINADO","campaign.created":"CAMPAA CREADA","campaign.queued":"CAMPAA EN COLA","campaign.sending":"CAMPAA LANZADA","settings.updated":"CONFIG ACTUALIZADA","role_permissions.updated":"PERMISOS CAMBIADOS","role_permissions.deleted":"ROL ELIMINADO","conversation.status_changed":"CHAT ACTUALIZADO","conversation.tag_added":"TAG AGREGADO","conversation.tag_removed":"TAG ELIMINADO"};function up(e){var r;const t=((r=e==null?void 0:e.data_json)==null?void 0:r.entity)||"";if(t==="template")return"templates";if(t==="audience")return"audience";if(t==="campaign")return"campaigns";if(t==="conversation")return"chat";const n=(e==null?void 0:e.action)||"";return n.includes("user")?"users":n.includes("campaign")?"campaigns":n.includes("template")?"templates":n.includes("audience")?"audience":n.includes("bot")?"bot":n.includes("conversation")?"chat":"system"}function Yl(e){if(!e)return{date:"--",time:"--"};const t=new Date(e);return Number.isNaN(t.getTime())?{date:"--",time:"--"}:{date:t.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}),time:t.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}}function Dx(e,t="csv"){const r=[["timestamp","usuario","email","accion","modulo","data"].join(",")];e.forEach(f=>{var y,A;const x=((y=f.user)==null?void 0:y.name)||"Sistema",g=((A=f.user)==null?void 0:A.email)||"",j=up(f),T=[new Date(f.created_at).toISOString(),x,g,f.action,j,JSON.stringify(f.data_json||{})];r.push(T.map(w=>`"${String(w).replace(/"/g,'""')}"`).join(","))});const a=r.join(`
`),i=t==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv;charset=utf-8;",l=t==="excel"?"audit_logs.xlsx":"audit_logs.csv",o=new Blob([a],{type:i}),c=document.createElement("a");c.href=URL.createObjectURL(o),c.download=l,document.body.appendChild(c),c.click(),document.body.removeChild(c)}function Mx(){var N,D;const[e,t]=m.useState(""),[n,r]=m.useState(""),[a,i]=m.useState(""),[l,o]=m.useState(1),[c]=m.useState(6),[f,x]=m.useState(0),[g,j]=m.useState([]),[T,y]=m.useState(!1),[A,w]=m.useState(null),d=Math.max(1,Math.ceil(f/c)),p=async({pageOverride:E}={})=>{y(!0);try{const $=new URLSearchParams;$.set("page",String(E||l)),$.set("page_size",String(c)),e.trim()&&$.set("q",e.trim()),n&&$.set("from",n),a&&$.set("to",a);const F=await ce(`/api/admin/audit?${$.toString()}`);j(F.logs||[]),x(F.total||0)}finally{y(!1)}};m.useEffect(()=>{p()},[l]);const v=()=>{o(1),p({pageOverride:1})},S=async(E="csv")=>{const $=new URLSearchParams;$.set("page","1"),$.set("page_size","1000"),e.trim()&&$.set("q",e.trim()),n&&$.set("from",n),a&&$.set("to",a);const F=await ce(`/api/admin/audit?${$.toString()}`);Dx(F.logs||[],E)},P=m.useMemo(()=>{const E=[],$=Math.max(1,l-1),F=Math.min(d,$+2);for(let te=$;te<=F;te+=1)E.push(te);return E},[l,d]);return s.jsxs("div",{className:"audit-module",children:[s.jsxs("div",{className:"audit-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-title",children:"Registros / Auditoria"}),s.jsx("div",{className:"audit-subtitle",children:"Monitorea acciones de usuarios y eventos del sistema"})]}),s.jsxs("div",{className:"audit-export-group",children:[s.jsx("button",{className:"audit-export",type:"button",onClick:()=>S("excel"),children:" Exportar Excel"}),s.jsx("button",{className:"audit-export outline",type:"button",onClick:()=>S("csv"),children:" Exportar CSV"})]})]}),s.jsxs("div",{className:"audit-filters",children:[s.jsxs("div",{className:"audit-search",children:[s.jsx("span",{className:"audit-search-icon"}),s.jsx("input",{type:"text",placeholder:"Filtrar por usuario o accion..",value:e,onChange:E=>t(E.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Desde"}),s.jsx("input",{type:"date",value:n,onChange:E=>r(E.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Hasta"}),s.jsx("input",{type:"date",value:a,onChange:E=>i(E.target.value)})]}),s.jsx("button",{className:"audit-filter-btn",type:"button",onClick:v,children:"Filtrar"})]}),s.jsxs("div",{className:"audit-card",children:[s.jsxs("div",{className:"audit-table-head",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("span",{children:"Usuario"}),s.jsx("span",{children:"Accion"}),s.jsx("span",{children:"Modulo"})]}),T&&s.jsx("div",{className:"audit-empty",children:"Cargando registros..."}),!T&&!g.length&&s.jsx("div",{className:"audit-empty",children:"Sin registros para mostrar"}),!T&&g.map(E=>{var Be,we;const $=Yl(E.created_at),F=up(E),te=Px[E.action]||E.action,he=((Be=E.user)==null?void 0:Be.name)||"System Bot",xe=((we=E.user)==null?void 0:we.email)||"automated@service";return s.jsxs("button",{type:"button",className:"audit-row",onClick:()=>w(E),children:[s.jsxs("div",{className:"audit-cell time",children:[s.jsx("div",{children:$.date}),s.jsx("div",{className:"audit-time",children:$.time})]}),s.jsxs("div",{className:"audit-cell user",children:[s.jsx("div",{className:"audit-avatar",children:(he==null?void 0:he[0])||"S"}),s.jsxs("div",{children:[s.jsx("div",{className:"audit-user-name",children:he}),s.jsx("div",{className:"audit-user-email",children:xe})]})]}),s.jsx("div",{className:"audit-cell action",children:s.jsx("span",{className:"audit-action-pill",children:te})}),s.jsxs("div",{className:"audit-cell module",children:[s.jsx("span",{className:"audit-module-icon",children:bd[F]||bd.system}),F.charAt(0).toUpperCase()+F.slice(1)]})]},E.id)})]}),s.jsxs("div",{className:"audit-footer",children:[s.jsxs("div",{children:["Mostrando ",g.length," de ",f," registros"]}),s.jsxs("div",{className:"audit-pagination",children:[s.jsx("button",{type:"button",disabled:l<=1,onClick:()=>o(E=>Math.max(1,E-1)),children:""}),P.map(E=>s.jsx("button",{type:"button",className:E===l?"active":"",onClick:()=>o(E),children:E},E)),s.jsx("button",{type:"button",disabled:l>=d,onClick:()=>o(E=>Math.min(d,E+1)),children:""})]})]}),A&&s.jsx("div",{className:"audit-modal",children:s.jsxs("div",{className:"audit-modal-card",children:[s.jsxs("div",{className:"audit-modal-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-modal-title",children:"Detalle del registro"}),s.jsx("div",{className:"audit-modal-subtitle",children:A.action})]}),s.jsx("button",{type:"button",onClick:()=>w(null),children:""})]}),s.jsxs("div",{className:"audit-modal-body",children:[s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Usuario"}),s.jsx("strong",{children:((N=A.user)==null?void 0:N.name)||"System Bot"}),s.jsx("small",{children:((D=A.user)==null?void 0:D.email)||"automated@service"})]}),s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("strong",{children:Yl(A.created_at).date}),s.jsx("small",{children:Yl(A.created_at).time})]}),s.jsxs("div",{className:"audit-detail full",children:[s.jsx("span",{children:"Data"}),s.jsx("pre",{children:JSON.stringify(A.data_json||{},null,2)})]})]})]})})]})}function Ix(){return s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Integracion Odoo"}),s.jsx("div",{className:"empty-state",children:"Seccion en construccion"})]})}function Bx(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("line",{x1:"4",y1:"6",x2:"20",y2:"6",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"6",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"18",x2:"20",y2:"18",strokeWidth:"2"}),s.jsx("circle",{cx:"11",cy:"18",r:"2",strokeWidth:"2"})]})}function zx(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"9",cy:"8",r:"3",strokeWidth:"2"}),s.jsx("path",{d:"M4 20c0-3 2.7-5.5 6-5.5s6 2.5 6 5.5",strokeWidth:"2"}),s.jsx("circle",{cx:"17",cy:"9",r:"2",strokeWidth:"2"}),s.jsx("path",{d:"M14 20c0-1.8 1.4-3.4 3.2-4",strokeWidth:"2"})]})}function $x(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"2"})]})}function Ux(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"4",width:"12",height:"16",rx:"2",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"9",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"13",x2:"15",y2:"13",strokeWidth:"2"})]})}function Vx(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"5",width:"12",height:"15",rx:"2",strokeWidth:"2"}),s.jsx("path",{d:"M9 5h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 10h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 14h6",strokeWidth:"2"})]})}function Fx(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M8 4h4a2 2 0 1 1 0 4h-1v2h2a2 2 0 1 1 0 4h-2v2H8a2 2 0 1 1-4 0V8a2 2 0 1 1 4 0z",strokeWidth:"2"})})}function Wx({settingsSection:e,setSettingsSection:t,settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,currentRole:l,isAdmin:o,adminUsers:c,userForm:f,setUserForm:x,roleOptions:g,handleUserSubmit:j,settings:T,setSettings:y,handleSaveSettings:A,branches:w,services:d,branchForm:p,setBranchForm:v,handleBranchSubmit:S,handleBranchDisable:P,serviceForm:N,setServiceForm:D,handleServiceSubmit:E,handleServiceDisable:$,handleServiceBranchToggle:F,templates:te,templateForm:he,setTemplateForm:xe,handleTemplateSubmit:Be,handleTemplateSubmitToMeta:we,handleTemplateDelete:pe,handleSyncTemplates:Oe,auditLogs:B,formatDate:H,planName:b,tenantChannels:W,channelForm:Y,setChannelForm:Z,handleChannelSelect:C,handleChannelSubmit:ee,handleUserDelete:V,defaultRolePermissions:U,handleRoleDelete:re,useShellLayout:me=!1,pageError:de}){const ye=a==null?void 0:a[l],Xe=[{title:"Principal",items:[{id:"general",label:"General",icon:Bx},{id:"users",label:"Gestion de Usuarios",icon:zx},{id:"bot",label:"Configuracion de Bot",icon:$x}]},{title:"Canales e Integraciones",items:[{id:"templates",label:"Plantillas de Meta",icon:Ux},{id:"audit",label:"Registros / Auditoria",icon:Vx},{id:"odoo",label:"Integracion Odoo",icon:Fx}]}];function Je(Ue){var Ve,He;return!!((He=(Ve=ye==null?void 0:ye.settings)==null?void 0:Ve[Ue])!=null&&He.read)}function at(Ue){Je(Ue)&&t(Ue)}const Et=s.jsxs(s.Fragment,{children:[s.jsxs("aside",{className:"settings-sidebar",children:[s.jsxs("div",{className:"settings-header",children:[s.jsx("div",{className:"settings-title",children:"CONFIGURACION"}),s.jsx("div",{className:"settings-version",children:"PODOPIE OS V2.0"})]}),Xe.map(Ue=>s.jsxs("div",{className:"settings-group",children:[s.jsx("div",{className:"settings-group-title",children:Ue.title}),s.jsx("div",{className:"settings-group-list",children:Ue.items.map(Ve=>{const He=!Je(Ve.id),Jt=Ve.icon;return s.jsxs("button",{className:`settings-item ${e===Ve.id?"active":""}`,type:"button",onClick:()=>at(Ve.id),disabled:He,children:[s.jsx("span",{className:"settings-icon","aria-hidden":"true",children:s.jsx(Jt,{className:"settings-icon-svg"})}),Ve.label]},Ve.id)})})]},Ue.title)),s.jsxs("div",{className:"settings-plan",children:[s.jsx("div",{className:"settings-plan-label",children:"Plan actual"}),s.jsx("div",{className:"settings-plan-name",children:b||"Sin plan"})]})]}),s.jsxs("div",{className:"settings-content",children:[e==="users"&&s.jsx(Ex,{settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,isAdmin:o,adminUsers:c,userForm:f,setUserForm:x,roleOptions:g,handleUserSubmit:j,handleUserDelete:V,defaultRolePermissions:U,handleRoleDelete:re}),e==="general"&&s.jsx(Tx,{branches:w,branchForm:p,setBranchForm:v,handleBranchSubmit:S,handleBranchDisable:P,services:d,serviceForm:N,setServiceForm:D,handleServiceSubmit:E,handleServiceDisable:$,handleServiceBranchToggle:F,tenantChannels:W,channelForm:Y,setChannelForm:Z,handleChannelSelect:C,handleChannelSubmit:ee}),e==="bot"&&s.jsx(Ax,{settings:T,setSettings:y,handleSaveSettings:A}),e==="templates"&&s.jsx(Rx,{templates:te,templateForm:he,setTemplateForm:xe,handleTemplateSubmit:Be,handleTemplateSubmitToMeta:we,handleTemplateDelete:pe,handleSyncTemplates:Oe}),e==="audit"&&s.jsx(Mx,{auditLogs:B,formatDate:H}),e==="odoo"&&s.jsx(Ix,{}),de&&s.jsx("div",{className:"error-banner",children:de})]})]});return me?Et:s.jsx("section",{className:"settings-layout",children:Et})}function Hx(){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"1.8"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"1.8"})]})}function qx({tenantId:e,tenantBots:t,availableFlows:n,loading:r,onAddBot:a,onRemoveBot:i}){const[l,o]=m.useState(""),c=new Set(t.map(g=>g.flow_id)),f=n.filter(g=>!c.has(g.id));function x(){l&&(a(l),o(""))}return s.jsxs("section",{className:"sa-bot-card","data-tenant":e||"",children:[s.jsxs("header",{className:"sa-bot-header",children:[s.jsx("div",{className:"sa-bot-icon-large","aria-hidden":"true",children:s.jsx(Hx,{})}),s.jsxs("div",{className:"sa-bot-title-group",children:[s.jsx("h3",{children:"Asignacion de Bots"}),s.jsx("p",{children:"Selecciona que flujos estaran disponibles para este cliente. Los flujos asignados apareceran inmediatamente en el panel del usuario."})]})]}),s.jsx("div",{className:"sa-bot-body",children:r?s.jsx("div",{className:"sa-bot-loading",children:"Cargando asignaciones..."}):t.length===0?s.jsxs("div",{className:"sa-bot-empty",children:[s.jsx("div",{className:"sa-bot-empty-icon",children:"+"}),s.jsx("div",{className:"sa-bot-empty-title",children:"Sin bots asignados"}),s.jsx("div",{className:"sa-bot-empty-sub",children:"Agrega un flujo desde el selector para activarlo en este tenant."})]}):s.jsx("div",{className:"sa-bot-grid",children:t.map(g=>s.jsxs("div",{className:"sa-assigned-bot",children:[s.jsx("div",{className:"sa-bot-item-icon",children:g.flow_icon||">"}),s.jsxs("div",{className:"sa-bot-item-info",children:[s.jsx("span",{className:"sa-bot-item-name",children:g.flow_name||g.flow_id}),s.jsx("span",{className:"sa-bot-item-desc",children:g.flow_description||"Sin descripcion"})]}),s.jsx("button",{type:"button",className:"sa-btn-remove",title:"Quitar bot del cliente",onClick:()=>i(g.id),children:"Quitar"})]},g.id))})}),s.jsxs("div",{className:"sa-bot-controls",children:[s.jsxs("div",{className:"sa-select-container",children:[s.jsx("label",{className:"sa-select-label",children:"Asignar bot"}),s.jsxs("select",{className:"sa-select-styled",value:l,onChange:g=>o(g.target.value),disabled:f.length===0,children:[s.jsx("option",{value:"",children:f.length===0?"No hay mas bots disponibles":"Selecciona un bot para asignar"}),f.map(g=>s.jsx("option",{value:g.id,children:g.name},g.id))]})]}),s.jsx("button",{type:"button",className:"sa-btn-assign",onClick:x,disabled:!l,children:"Asignar Bot"})]})]})}const Wt={name:"",slug:"",plan:"",db_url:"",phone_number_id:"",line_name:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",brand_name:"",logo_url:"",brand_primary:"#22d3ee",brand_accent:"#38bdf8",brand_bg:"#0b0f16",timezone:"",odoo_base_url:"",odoo_db_name:"",odoo_username:"",odoo_password:""},Qx=[{value:"starter",label:"Starter"},{value:"growth",label:"Growth"},{value:"scale",label:"Scale"},{value:"enterprise",label:"Enterprise"}];function Gx(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"4",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"4",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"})]})}function ec(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Yx(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"3.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M19 12a7 7 0 0 0-.1-1.2l2-1.5-2-3.5-2.4.7a7.2 7.2 0 0 0-2-1.2L12 2 9.5 4.3a7.2 7.2 0 0 0-2 1.2l-2.4-.7-2 3.5 2 1.5A7 7 0 0 0 5 12c0 .4 0 .8.1 1.2l-2 1.5 2 3.5 2.4-.7a7.2 7.2 0 0 0 2 1.2L12 22l2.5-2.3a7.2 7.2 0 0 0 2-1.2l2.4.7 2-3.5-2-1.5c.1-.4.1-.8.1-1.2Z",strokeWidth:"1.2",strokeLinejoin:"round"})]})}function Kx(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M16.5 16.5 20 20",strokeWidth:"1.6",strokeLinecap:"round"})]})}function Xx(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 12h12",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m13 6 6 6-6 6",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Jx(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M18 6 6 18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m6 6 12 12",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Zx(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56",strokeWidth:"1.8",strokeLinecap:"round"})})}function Cd(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ed(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m2 2 20 20",strokeWidth:"1.8",strokeLinecap:"round"})]})}function ey(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 18h.01",strokeWidth:"1.8",strokeLinecap:"round"})]})}function ty(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m15 5 4 4",strokeWidth:"1.8",strokeLinecap:"round"})]})}function ny(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M3 6h18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",strokeWidth:"1.8",strokeLinecap:"round"})]})}const Td={display_name:"",phone_number_id:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",is_active:!0,is_default:!1};function sy({isOpen:e,onClose:t,initialData:n,onSave:r,tenantId:a}){const[i,l]=m.useState(Td),[o,c]=m.useState(!1),[f,x]=m.useState(!1),[g,j]=m.useState(!1),[T,y]=m.useState(null);if(m.useEffect(()=>{e&&(l(n||{...Td}),y(null))},[e,n]),!e)return null;const A=async w=>{if(w.preventDefault(),j(!0),y(null),!i.phone_number_id||!i.verify_token||!n&&!i.wa_token){y("Los campos ID de Telfono, Verify Token y Access Token son obligatorios."),j(!1);return}try{await r({...i,tenant_id:a}),t()}catch(d){console.error("Error saving channel:",d),y(d.message||"Error al guardar la lnea.")}finally{j(!1)}};return s.jsx("div",{className:"sa-modal-overlay",onClick:t,children:s.jsxs("div",{className:"sa-modal-content",onClick:w=>w.stopPropagation(),children:[s.jsxs("div",{className:"sa-modal-header",children:[s.jsx("div",{className:"sa-modal-title",children:n?"Editar Lnea WhatsApp":"Nueva Lnea WhatsApp"}),s.jsx("button",{className:"sa-modal-close",onClick:t,children:s.jsx(Jx,{width:24,height:24})})]}),s.jsxs("div",{className:"sa-modal-body",children:[T&&s.jsx("div",{className:"sa-alert",style:{marginBottom:"1rem"},children:T}),s.jsxs("div",{className:"sa-form-grid",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre para mostrar (Opcional)"}),s.jsx("input",{value:i.display_name||"",onChange:w=>l({...i,display_name:w.target.value}),placeholder:"Ej: Ventas Principal"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Phone Number ID *"}),s.jsx("input",{value:i.phone_number_id||"",onChange:w=>l({...i,phone_number_id:w.target.value}),placeholder:"Identificador del nmero de telfono"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"WABA ID (WhatsApp Business Account ID)"}),s.jsx("input",{value:i.waba_id||"",onChange:w=>l({...i,waba_id:w.target.value}),placeholder:"Identificador de la cuenta de WhatsApp Business"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Verify Token (Webhook) *"}),s.jsx("input",{value:i.verify_token||"",onChange:w=>l({...i,verify_token:w.target.value}),placeholder:"Token de verificacin webhook"})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"Permanent Access Token *"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:o?"text":"password",value:i.wa_token||"",onChange:w=>l({...i,wa_token:w.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"Token de acceso permanente",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>c(!o),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:o?s.jsx(Ed,{width:18,height:18}):s.jsx(Cd,{width:18,height:18})})]})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"App Secret (Opcional)"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:f?"text":"password",value:i.app_secret||"",onChange:w=>l({...i,app_secret:w.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"App Secret de Meta",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>x(!f),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:f?s.jsx(Ed,{width:18,height:18}):s.jsx(Cd,{width:18,height:18})})]})]})]}),s.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"2rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_active,onChange:w=>l({...i,is_active:w.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Activa"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_default,onChange:w=>l({...i,is_default:w.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Principal (Por Defecto)"]})]})]}),s.jsxs("div",{className:"sa-modal-footer",children:[s.jsx("button",{className:"sa-btn ghost",onClick:t,disabled:g,children:"Cancelar"}),s.jsx("button",{className:"sa-btn primary",onClick:A,disabled:g,children:g?s.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(Zx,{width:16,height:16,className:"animate-spin"})," Guardando..."]}):"Guardar Lnea"})]})]})})}function ry({channels:e=[],tenantId:t,onRefresh:n}){const[r,a]=m.useState(!1),[i,l]=m.useState(null),o=()=>{l(null),a(!0)},c=g=>{l(g),a(!0)},f=async g=>{const j=i?`/api/superadmin/channels/${i.id}`:"/api/superadmin/channels",y=await fetch(j,{method:i?"PATCH":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(g)});if(!y.ok){const A=await y.json();throw new Error(A.error||"Error al guardar")}await n()},x=async g=>{if(confirm("Ests seguro de que deseas eliminar esta lnea? Esta accin no se puede deshacer."))try{if(!(await fetch(`/api/superadmin/channels/${g}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error("Error al eliminar");await n()}catch(j){console.error("Error deleting channel:",j),alert("No se pudo eliminar la lnea.")}};return s.jsxs("section",{className:"sa-lines-card",children:[s.jsxs("header",{className:"sa-lines-header",children:[s.jsxs("div",{className:"sa-lines-title",children:[s.jsx("div",{className:"sa-lines-icon",children:s.jsx(ey,{width:24,height:24})}),s.jsxs("div",{children:[s.jsx("h3",{children:"Lneas de WhatsApp Cloud"}),s.jsx("p",{children:"Gestiona las conexiones activas de WhatsApp para este tenant."})]})]}),s.jsxs("button",{className:"sa-btn primary",onClick:o,children:[s.jsx(ec,{width:16,height:16,style:{marginRight:"0.5rem"}}),"Agregar Nueva Lnea"]})]}),s.jsx("div",{className:"sa-lines-body",children:s.jsxs("div",{className:"sa-lines-grid",children:[e.map(g=>s.jsxs("div",{className:`sa-line-card ${g.is_active?"":"opacity-75"}`,children:[s.jsxs("div",{className:"sa-line-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-line-name",children:g.display_name||"Sin nombre"}),s.jsxs("div",{className:"sa-line-meta",children:["ID: ",g.phone_number_id]})]}),s.jsx("div",{className:`sa-line-status ${g.is_active?"active":""}`,title:g.is_active?"Activo":"Inactivo"})]}),s.jsxs("div",{className:"sa-line-badges",children:[g.is_default&&s.jsx("span",{className:"sa-line-badge default",children:"DEFAULT"}),!g.is_active&&s.jsx("span",{className:"sa-status warn",children:"INACTIVO"})]}),s.jsxs("div",{className:"sa-line-details",children:[s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"WABA ID"}),s.jsx("span",{className:"sa-detail-value",children:g.waba_id||"-"})]}),s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"Verify Token"}),s.jsx("span",{className:"sa-detail-value",children:g.verify_token?`${g.verify_token.substring(0,16)}...`:"-"})]})]}),s.jsxs("div",{className:"sa-line-actions",children:[s.jsx("button",{className:"sa-btn ghost",onClick:()=>c(g),title:"Editar",children:s.jsx(ty,{width:16,height:16})}),s.jsx("button",{className:"sa-btn ghost",onClick:()=>x(g.id),title:"Eliminar",style:{color:"#f87171"},children:s.jsx(ny,{width:16,height:16})})]})]},g.id)),s.jsxs("button",{type:"button",className:"sa-line-add-card",onClick:o,children:[s.jsx("div",{className:"sa-add-icon-circle",children:s.jsx(ec,{width:24,height:24})}),s.jsx("span",{children:"Nueva Conexin"})]})]})}),s.jsx(sy,{isOpen:r,onClose:()=>a(!1),initialData:i,onSave:f,tenantId:t})]})}function Ad({route:e="/superadmin",onNavigate:t,onImpersonateTenant:n,onLogout:r=()=>{}}){const[a,i]=m.useState([]),[l,o]=m.useState([]),[c,f]=m.useState(""),[x,g]=m.useState(""),[j,T]=m.useState("Verificacion de red: sistema ok"),[y,A]=m.useState(Wt),[w,d]=m.useState(!1),[p,v]=m.useState(!1),[S,P]=m.useState(""),[N,D]=m.useState(""),[E,$]=m.useState(!0),[F,te]=m.useState(Wt),[he,xe]=m.useState(!0),[Be,we]=m.useState(!1),pe=m.useRef(""),[Oe,B]=m.useState([]),[H,b]=m.useState([]),[W,Y]=m.useState(!1),{pushToast:Z}=eu(),C=m.useMemo(()=>{if(!e)return"";const _=e.match(/^\/superadmin\/tenants\/([^/]+)\/?$/)||e.match(/^\/superadmin\/tenant\/([^/]+)\/?$/)||e.match(/^\/superadmin\/edit\/([^/]+)\/?$/);return _?_[1]:""},[e]),ee=e.startsWith("/superadmin/new"),V=!!C,U=ee||V,re=m.useCallback(_=>{if(t){t(_,{replace:!1});return}typeof window>"u"||window.history.pushState({},"",_)},[t]);async function me(){try{const _=await ce("/api/superadmin/tenants");i(_.tenants||[]);const z=await ce("/api/superadmin/channels");o(z.channels||[]),g("")}catch(_){g(_.message||"No se pudo cargar datos.")}}m.useEffect(()=>{me(),yt()},[]),m.useMemo(()=>{const _=new Map;return l.forEach(z=>{const Q=_.get(z.tenant_id)||0;_.set(z.tenant_id,Q+1)}),_},[l]);const de=m.useMemo(()=>{const _=c.trim().toLowerCase();return _?a.filter(z=>{const Q=String(z.name||"").toLowerCase(),se=String(z.slug||"").toLowerCase(),je=String(z.id||"").toLowerCase();return Q.includes(_)||se.includes(_)||je.includes(_)}):a.slice()},[a,c]),ye=a.length,Xe=a.filter(_=>_.is_active).length;a.filter(_=>_.has_database).length;const Je=a.filter(_=>_.has_odoo).length,at=ye?Math.round(Je/ye*100):0;function Et(_){if(!_)return"--";const z=new Date(_);return Number.isNaN(z.getTime())?"--":z.toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"2-digit"})}function Ue(_){return 10+Math.abs(Array.from(_).reduce((se,je)=>se+je.charCodeAt(0),0))%70}function Ve(){A(Wt),te(Wt),D(""),$(!0),xe(!0),b([]),T("Verificacion de red: sistema ok"),pe.current=""}function He(){Ve(),g(""),re("/superadmin/new")}function Jt(){pe.current="",re("/superadmin")}async function Tt(_){if(n)try{g(""),P(_),await n(_)}catch(z){g(z.message||"No se pudo entrar al tenant.")}finally{P("")}}function K(_){const z={};return Object.keys(Wt).forEach(Q=>{const se=_[Q];z[Q]=typeof se=="string"?se.trim():se||""}),{...Wt,...z}}async function Ce(_){if(_){pe.current=_,D(_),A(Wt),te(Wt),$(!0),xe(!0),b([]),we(!0),g("");try{const z=await ce(`/api/superadmin/tenants/${_}/details`);if(pe.current!==_)return;const Q=z.tenant||{},se=z.branding||null,je=z.odoo||null,Ne=z.database||null,dt=z.channel||null,qe=(se==null?void 0:se.colors)||{},Ut=K({...Wt,name:Q.name||"",slug:Q.slug||"",plan:Q.plan||"",db_url:(Ne==null?void 0:Ne.db_url)||"",brand_name:(se==null?void 0:se.brand_name)||"",logo_url:(se==null?void 0:se.logo_url)||"",brand_primary:(qe==null?void 0:qe.primary)||Wt.brand_primary,brand_accent:(qe==null?void 0:qe.accent)||Wt.brand_accent,brand_bg:(qe==null?void 0:qe.bg)||Wt.brand_bg,odoo_base_url:(je==null?void 0:je.base_url)||"",odoo_db_name:(je==null?void 0:je.db_name)||"",odoo_username:(je==null?void 0:je.username)||"",odoo_password:(je==null?void 0:je.password)||""});A(Ut),te(Ut),D(Q.id||_),$(!!Q.is_active),xe(!!Q.is_active),T("Modo edicion: cambios pendientes"),await ut(_)}catch(z){g(z.message||"No se pudo cargar tenant.")}finally{we(!1)}}}async function yt(){try{const _=await ce("/api/superadmin/flows");B(_.flows||[])}catch(_){console.error("Error loading flows",_)}}async function ut(_){if(_){Y(!0);try{const z=await ce(`/api/superadmin/tenant-bots?tenant_id=${_}`);b(z.tenant_bots||[])}catch(z){console.error("Error loading tenant bots",z)}finally{Y(!1)}}}async function Nn(_,z){try{await Ge(`/api/superadmin/tenant-bots/${_}`,{is_active:z}),b(Q=>Q.map(se=>se.id===_?{...se,is_active:z}:se))}catch(Q){g(Q.message||"Error al cambiar estado del bot.")}}async function Ze(_){if(N)try{const z=await ke("/api/superadmin/tenant-bots",{tenant_id:N,flow_id:_});z.tenant_bot&&(b(Q=>[z.tenant_bot,...Q]),Z({message:"Bot agregado correctamente"}))}catch(z){g(z.message||"Error al agregar bot."),Z({type:"error",message:z.message||"Error al agregar bot"})}}async function wn(_){const z=H.find(Q=>Q.id===_);try{await Yn(`/api/superadmin/tenant-bots/${_}`),b(Q=>Q.filter(se=>se.id!==_)),Z({message:"Bot eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{if(!z)return;const Q=await ke("/api/superadmin/tenant-bots",{tenant_id:z.tenant_id,flow_id:z.flow_id});Q!=null&&Q.tenant_bot&&z.is_active===!1&&await Ge(`/api/superadmin/tenant-bots/${Q.tenant_bot.id}`,{is_active:!1}),await ut(N),Z({message:"Bot restaurado"})}catch(Q){Z({type:"error",message:(Q==null?void 0:Q.message)||"No se pudo restaurar el bot"})}}})}catch(Q){g(Q.message||"Error al eliminar bot."),Z({type:"error",message:Q.message||"Error al eliminar bot"})}}async function zn(_){g(""),re(`/superadmin/tenants/${_.id}`)}function Zt(){const _=y.name.trim(),z=y.slug.trim(),Q=y.db_url.trim();return!_||!z?{ok:!1,message:"Nombre y subdominio son requeridos."}:!N&&!Q?{ok:!1,message:"Tenant DB URL es requerido."}:(y.brand_name.trim()||y.logo_url.trim()||y.brand_primary||y.brand_accent||y.brand_bg)&&!y.brand_name.trim()?{ok:!1,message:"Brand name es requerido."}:(y.odoo_base_url||y.odoo_db_name||y.odoo_username||y.odoo_password)&&(!y.odoo_base_url||!y.odoo_db_name||!y.odoo_username||!N&&!y.odoo_password)?{ok:!1,message:"Odoo incompleto: base_url, db_name, username, password."}:{ok:!0}}function Ee(_){if(!_)return"Verificacion completada";const z=[];if(_.database){const Q=_.database.ok?"DB ok":"DB error",se=typeof _.database.latency_ms=="number"?` (${_.database.latency_ms}ms)`:"";z.push(`${Q}${se}`)}if(_.odoo){const Q=_.odoo.ok?"Odoo ok":"Odoo error",se=typeof _.odoo.latency_ms=="number"?` (${_.odoo.latency_ms}ms)`:"";z.push(`${Q}${se}`)}return z.length?`Verificacion completada: ${z.join(" | ")}`:"Verificacion completada"}function zt(_){if(_!=null&&_.database&&!_.database.ok){const z=_.database.details||_.database.error;return L(z||"Error en DB")}if(_!=null&&_.odoo&&!_.odoo.ok){const z=_.odoo.details||_.odoo.error;return L(z||"Error en Odoo")}return"No se pudo validar conexion"}function L(_){const z=(_||"").toString(),Q=z.toLowerCase();return Q.includes("missing")?"Completa los campos de Odoo":Q.includes("db_connection_failed")?"No se pudo conectar a la base de datos":Q.includes("odoo")&&Q.includes("failed")?"No se pudo autenticar en Odoo":z||"No se pudo validar conexion"}async function Se(){const _=Zt();if(!_.ok){T(_.message);return}d(!0),T("Verificando conexion...");try{const z=await ke("/api/superadmin/tenants/validate",{db_url:y.db_url.trim(),odoo_base_url:y.odoo_base_url.trim(),odoo_db_name:y.odoo_db_name.trim(),odoo_username:y.odoo_username.trim(),odoo_password:y.odoo_password.trim()}),Q=Ee(z.checks);T(Q),z.ok?Z({message:Q}):Z({type:"error",message:zt(z.checks)})}catch(z){T("Error validando conexion"),Z({type:"error",message:z.message||"No se pudo validar conexion"})}finally{d(!1)}}async function ps(_){var Q;if(_.preventDefault(),V&&!$t)return;const z=Zt();if(!z.ok){g(z.message);return}try{v(!0),g("");let se=N;if(se?await Ge(`/api/superadmin/tenants/${se}`,{name:y.name.trim(),slug:y.slug.trim(),plan:y.plan.trim(),is_active:E}):se=(Q=(await ke("/api/superadmin/tenants",{name:y.name.trim(),slug:y.slug.trim(),plan:y.plan.trim()})).tenant)==null?void 0:Q.id,!se)throw new Error("tenant_not_ready");if(y.db_url.trim()&&await ke(`/api/superadmin/tenants/${se}/database`,{db_url:y.db_url.trim()}),(y.brand_name.trim()||y.logo_url.trim())&&await Ge("/api/superadmin/branding",{tenant_id:se,brand_name:y.brand_name.trim(),logo_url:y.logo_url.trim()||null,colors:null}),y.odoo_base_url||y.odoo_db_name||y.odoo_username||y.odoo_password){const dt={tenant_id:se,base_url:y.odoo_base_url.trim(),db_name:y.odoo_db_name.trim(),username:y.odoo_username.trim()};y.odoo_password.trim()&&(dt.password=y.odoo_password.trim()),await Ge("/api/superadmin/odoo",dt)}if(await me(),N){const dt=K(y);A(dt),te(dt),xe(E),T("Cambios guardados"),Z({message:"Tenant actualizado correctamente"})}else Ve(),Z({message:"Tenant creado correctamente"})}catch(se){g(se.message||"No se pudo guardar tenant."),Z({type:"error",message:se.message||"No se pudo guardar tenant"})}finally{v(!1)}}async function cn(){if(!N)return;const _=!E;try{v(!0),g(""),await Ge(`/api/superadmin/tenants/${N}`,{is_active:_}),$(_),xe(_),T(_?"Tenant reactivado":"Tenant bloqueado"),await me()}catch(z){g(z.message||"No se pudo cambiar estado del tenant.")}finally{v(!1)}}const $t=m.useMemo(()=>!N&&!V||E!==he?!0:Object.keys(F).some(_=>{const z=String(y[_]??""),Q=String(F[_]??"");return z!==Q}),[he,F,E,N,V,y]);return m.useEffect(()=>{if(V&&C&&C!==N){Ce(C);return}ee&&(N||Be)&&Ve()},[Be,N,ee,V,C]),s.jsxs("div",{className:"sa-shell",children:[s.jsxs("aside",{className:"sa-rail",children:[s.jsx("div",{className:"sa-rail-logo",children:"PRZV"}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${U?"":"active"}`,onClick:Jt,children:[s.jsx(Gx,{className:"sa-rail-icon"}),s.jsx("span",{children:"Dashboard"})]}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${ee?"active":""}`,onClick:He,children:[s.jsx(ec,{className:"sa-rail-icon"}),s.jsx("span",{children:"Nuevo"})]}),s.jsxs("button",{type:"button",className:"sa-rail-btn",children:[s.jsx(Yx,{className:"sa-rail-icon"}),s.jsx("span",{children:"Ajustes"})]}),s.jsxs("div",{className:"sa-rail-footer",children:[s.jsx("div",{className:"sa-avatar",children:"SA"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-role",children:"Superadmin"}),s.jsx("div",{className:"sa-meta",children:"Control plane"})]})]})]}),s.jsxs("main",{className:"sa-main",children:[!U&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-topbar",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-kicker",children:"Panel de control Perzivalh"}),s.jsxs("div",{className:"sa-title",children:["Sistema operativo ",s.jsx("span",{className:"sa-dot"})]}),s.jsx("div",{className:"sa-subtitle",children:"Estado general del entorno"})]}),s.jsxs("div",{className:"sa-top-actions",children:[s.jsx("span",{className:"sa-version",children:"v0.4 stable"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:me,children:"Recargar"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"}),s.jsx("button",{className:"sa-btn primary",type:"button",onClick:He,children:"Nuevo tenant"})]})]}),s.jsxs("section",{className:"sa-kpi-grid",children:[s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Total de empresas (tenants)"}),s.jsx("div",{className:"sa-kpi-value",children:ye}),s.jsxs("div",{className:"sa-kpi-meta",children:["+",Xe," activas"]})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Usuarios activos totales"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"En tiempo real"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Mensajes hoy"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"Canal API"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Conexiones Odoo activas"}),s.jsxs("div",{className:"sa-kpi-value",children:[at,"%"]}),s.jsxs("div",{className:"sa-kpi-meta",children:[Je," sincronizadas"]})]})]}),s.jsxs("section",{className:"sa-table-card",children:[s.jsxs("div",{className:"sa-table-header",children:[s.jsxs("div",{className:"sa-search",children:[s.jsx(Kx,{className:"sa-search-icon"}),s.jsx("input",{value:c,onChange:_=>f(_.target.value),placeholder:"Filtrar empresas..."})]}),s.jsxs("div",{className:"sa-table-actions",children:[s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Ordenar por salud"}),s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Exportar CSV"})]})]}),s.jsxs("div",{className:"sa-table",children:[s.jsxs("div",{className:"sa-table-head",children:[s.jsx("div",{children:"ID referencia"}),s.jsx("div",{children:"Nombre de la empresa"}),s.jsx("div",{children:"Estado"}),s.jsx("div",{children:"Uso de recursos"}),s.jsx("div",{children:"Tiempo de actividad"}),s.jsx("div",{children:"Acciones"})]}),de.length?de.map(_=>{var je;const z=Ue(_.id||"tenant"),Q=_.has_database?"db":"no-db",se=_.has_database;return s.jsxs("div",{className:"sa-table-row",children:[s.jsx("div",{className:"sa-ref",children:((je=_.slug)==null?void 0:je.toUpperCase())||"TENANT"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-tenant-name",children:_.name}),s.jsx("div",{className:"sa-tenant-meta",children:_.id.slice(0,8)})]}),s.jsx("div",{className:`sa-status ${_.is_active?"ok":"warn"}`,children:_.is_active?"activo":"inactivo"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-progress",children:s.jsx("span",{className:`sa-progress-fill ${Q}`,style:{width:`${z}%`}})}),s.jsxs("div",{className:"sa-tenant-meta",children:[z,"% carga"]})]}),s.jsx("div",{className:"sa-tenant-meta",children:Et(_.created_at)}),s.jsx("div",{children:s.jsxs("div",{className:"sa-action-group",children:[s.jsx("button",{className:"sa-action",type:"button",onClick:()=>Tt(_.id),disabled:!se||S===_.id,children:se?S===_.id?"Entrando...":"Entrar":"Sin DB"}),s.jsx("button",{className:"sa-link",type:"button",onClick:()=>zn(_),children:s.jsx(Xx,{className:"sa-link-icon"})})]})})]},_.id)}):s.jsx("div",{className:"sa-empty",children:"Sin tenants para mostrar."})]}),s.jsxs("div",{className:"sa-footer-note",children:["Mostrando ",de.length||0," empresas en produccion"]})]})]}),U&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-create-header",children:[s.jsx("button",{className:"sa-back",type:"button",onClick:Jt,children:"Volver al dashboard"}),s.jsx("div",{className:"sa-create-title",children:V?"Editar tenant":"Registrar nuevo tenant"}),s.jsxs("div",{className:"sa-create-actions",children:[s.jsx("div",{className:"sa-create-meta",children:"Modo: superadmin"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"})]})]}),x?s.jsx("div",{className:"sa-alert",children:x}):null,s.jsxs("form",{className:"sa-form",onSubmit:ps,children:[s.jsxs("div",{className:"sa-form-grid sa-form-grid-2",children:[s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Identidad del tenant"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre de la empresa"}),s.jsx("input",{value:y.name,onChange:_=>A({...y,name:_.target.value}),placeholder:"Ej. Empresa Alfa"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Subdominio reservado"}),s.jsx("input",{value:y.slug,onChange:_=>A({...y,slug:_.target.value}),placeholder:"alfa-salud"})]}),s.jsxs("div",{className:"sa-field sa-field-row",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Plan"}),s.jsxs("select",{value:y.plan,onChange:_=>A({...y,plan:_.target.value}),children:[s.jsx("option",{value:"",children:"Seleccionar"}),Qx.map(_=>s.jsx("option",{value:_.value,children:_.label},_.value))]})]}),V&&s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Estado del tenant"}),s.jsxs("select",{value:E?"active":"inactive",onChange:_=>$(_.target.value==="active"),children:[s.jsx("option",{value:"active",children:"Activo"}),s.jsx("option",{value:"inactive",children:"Bloqueado"})]})]})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Brand name"}),s.jsx("input",{value:y.brand_name,onChange:_=>A({...y,brand_name:_.target.value}),placeholder:"Perzivalh"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Logo URL"}),s.jsx("input",{value:y.logo_url,onChange:_=>A({...y,logo_url:_.target.value}),placeholder:"https://"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Paleta de colores"}),s.jsx("div",{className:"sa-note",children:"Personalizacin deshabilitada por ahora."})]}),!V&&s.jsx("div",{className:"sa-note",children:"Nota: al registrar un tenant se inicia el aprovisionamiento en el entorno de produccion."})]}),s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Variables de entorno (envs)"}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Base de datos"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Tenant DB URL"}),s.jsx("input",{value:y.db_url,onChange:_=>A({...y,db_url:_.target.value}),placeholder:"postgresql://..."})]})]}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Odoo (opcional)"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Base URL"}),s.jsx("input",{value:y.odoo_base_url,onChange:_=>A({...y,odoo_base_url:_.target.value}),placeholder:"https://odoo-instancia"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo DB Name"}),s.jsx("input",{value:y.odoo_db_name,onChange:_=>A({...y,odoo_db_name:_.target.value}),placeholder:"db_tenant_prod"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo User"}),s.jsx("input",{value:y.odoo_username,onChange:_=>A({...y,odoo_username:_.target.value}),placeholder:"usuario@empresa.com"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Password (opcional)"}),s.jsx("input",{type:"password",value:y.odoo_password,onChange:_=>A({...y,odoo_password:_.target.value}),placeholder:"********"})]})]})]})]}),s.jsxs("div",{className:"sa-form-actions",children:[s.jsx("div",{className:"sa-status-note",children:V?Be?"Cargando datos...":$t?"Cambios pendientes":"Sin cambios":j}),s.jsx("div",{className:"sa-form-buttons",children:V?s.jsxs(s.Fragment,{children:[$t&&s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:p,children:p?"Guardando...":"Guardar cambios"}),s.jsx("button",{className:"sa-btn danger",type:"button",onClick:cn,disabled:p||!N,children:E?"Bloquear tenant":"Reactivar tenant"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:Se,disabled:w||p,children:w?"Validando...":"Validar conexion"}),s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:p,children:p?"Guardando...":"Desplegar instancia"})]})})]})]}),N?s.jsx(ry,{channels:l.filter(_=>_.tenant_id===N),tenantId:N,onRefresh:me}):s.jsx("div",{style:{marginTop:"2rem",padding:"1rem",border:"1px dashed rgba(255,255,255,0.2)",borderRadius:"12px",color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",textAlign:"center"},children:"Crea el tenant primero para configurar las lneas de WhatsApp."}),N&&s.jsx(qx,{tenantId:N,tenantBots:H,availableFlows:Oe,loading:W,onToggleBot:Nn,onAddBot:Ze,onRemoveBot:wn})]})]})]})}const Ld=["open","pending","assigned"],Od=["admin","recepcion","caja","marketing","doctor"],An={admin:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!0},campaigns:{read:!0,write:!0},settings:{read:!0,write:!0}},settings:{general:{read:!0,write:!0},users:{read:!0,write:!0},bot:{read:!0,write:!0},templates:{read:!0,write:!0},audit:{read:!0,write:!0},odoo:{read:!0,write:!0}}},recepcion:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},caja:{modules:{chat:{read:!0,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},marketing:{modules:{chat:{read:!1,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!0,write:!0},settings:{read:!0,write:!1}},settings:{general:{read:!0,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!0,write:!0},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},doctor:{modules:{chat:{read:!0,write:!1},dashboard:{read:!1,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}}};function Kl(e){if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleString()}function ay(e){if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleDateString()}function iy(e){if(!e)return"-";const t=new Date(e);if(Number.isNaN(t.getTime()))return"-";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):i===1?"Ayer":["Dom","Lun","Mar","Mie","Jue","Vie","Sab"][t.getDay()]}function ly(e){if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);if(i===0)return"Hoy";if(i===1)return"Ayer";const l=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],o=`${t.getDate()} ${l[t.getMonth()]}`;return t.getFullYear()!==n.getFullYear()?`${o} ${t.getFullYear()}`:o}function J(e){return e?typeof e=="string"?e:e.message||"Error inesperado":"Error inesperado"}function oy(e,t){return e?t.includes(e.role):!1}function Xl(e){if(!e||typeof e!="object")return{...An};const t={...An};return Object.entries(e).forEach(([n,r])=>{var a,i;!r||typeof r!="object"||(t[n]={modules:{...(a=An[n])==null?void 0:a.modules,...r.modules},settings:{...(i=An[n])==null?void 0:i.settings,...r.settings}})}),t}function pt(e,t,n,r="read"){var i;const a=(i=e==null?void 0:e[t])==null?void 0:i[n];return a?!!a[r]:!1}function Jl(e){const t=n=>n.status==="pending"&&!n.assigned_user_id?0:n.status==="pending"&&n.assigned_user_id?1:n.status==="assigned"?2:3;return[...e].sort((n,r)=>{const a=t(n),i=t(r);if(a!==i)return a-i;const l=new Date(n.last_message_at||n.created_at||0).getTime();return new Date(r.last_message_at||r.created_at||0).getTime()-l})}function cy(e){const t=new URLSearchParams;Object.entries(e||{}).forEach(([r,a])=>{a==null||a===""||t.append(r,a)});const n=t.toString();return n?`?${n}`:""}function Rd(e){if(!e)return"?";const t=e.trim();return t?t[0].toUpperCase():"?"}function Pd(e){if(typeof document>"u")return;const t=document.documentElement.style;t.removeProperty("--accent"),t.removeProperty("--accent-strong"),t.removeProperty("--accent-soft"),t.removeProperty("--accent-soft-2"),t.removeProperty("--scroll-thumb"),t.removeProperty("--scroll-thumb-hover")}function uy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M4.5 5.5h15v10H8l-3.5 3.5V5.5Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 9h8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 12.5h5",strokeWidth:"1.8",strokeLinecap:"round"})]})}function dy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"})]})}function hy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 9a6 6 0 1 1 12 0c0 4.2 2 5.5 2 5.5H4S6 13.2 6 9Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M9.5 19a2.5 2.5 0 0 0 5 0",strokeWidth:"1.8"})]})}function fy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"2",strokeLinecap:"round"})]})}function py(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"4",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 3v2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M12 18.5V21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M3 12h2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M18.5 12H21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 5.2l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 17l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 18.8 7 17",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 7l1.8-1.8",strokeWidth:"1.8",strokeLinecap:"round"})]})}function my(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M20 14.2A8.5 8.5 0 1 1 9.8 4 6.5 6.5 0 0 0 20 14.2Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function gy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.8"}),s.jsx("path",{d:"M16.5 16.5 21 21",strokeWidth:"1.8",strokeLinecap:"round"})]})}function vy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function xy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3.5",y:"6",width:"11",height:"12",rx:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"m14.5 10 6-3v10l-6-3",strokeWidth:"1.8"})]})}function yy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M6.5 4.5 9 3l2.5 4-2.5 1.5c1.2 2.3 3.2 4.3 5.5 5.5L16 11l4 2.5-1.5 2.5c-.7 1.2-2.2 1.7-3.6 1.3a15.9 15.9 0 0 1-7.7-7.7c-.4-1.4.1-2.9 1.3-3.6Z",strokeWidth:"1.6",strokeLinejoin:"round"})})}function jy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"9",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 10v6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"7.5",r:"1",fill:"currentColor"})]})}function Ny(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"m4 12 15-7-6 14-2.5-5.2L4 12Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function wy(){const[e,t]=m.useState(localStorage.getItem("token")||""),[n,r]=m.useState(()=>typeof window<"u"&&localStorage.getItem("superadmin_token")||""),[a,i]=m.useState(null),[l,o]=m.useState(null),[c,f]=m.useState(null),[x,g]=m.useState([]),[j,T]=m.useState({id:"",display_name:""}),[y,A]=m.useState(()=>{if(typeof window>"u")return{};try{return JSON.parse(localStorage.getItem("last_read_map")||"{}")}catch{return{}}}),[w,d]=m.useState({email:"",password:""}),[p,v]=m.useState(""),[S,P]=m.useState("chats"),[N,D]=m.useState(()=>typeof window<"u"?window.location.pathname:"/"),[E,$]=m.useState(()=>localStorage.getItem("theme")||"light"),[F,te]=m.useState(!1),[he,xe]=m.useState(!1),[Be,we]=m.useState(!1),[pe,Oe]=m.useState(!0),[B,H]=m.useState(!1),b=m.useRef(null),W=m.useRef(null),Y=m.useRef(0),[Z,C]=m.useState("users"),[ee,V]=m.useState("list"),[U,re]=m.useState(()=>Xl(null)),[me,de]=m.useState(!1),[ye,Xe]=m.useState(!1),[Je,at]=m.useState(!1),Et=m.useMemo(()=>{const h=Object.keys(U||{}).filter(k=>!Od.includes(k));return[...Od,...h]},[U]),[Ue,Ve]=m.useState({status:"",assigned_user_id:"",tag:"",search:"",phone_number_id:""}),He=N.startsWith("/superadmin"),[Jt,Tt]=m.useState([]),[K,Ce]=m.useState(null),[yt,ut]=m.useState([]),[Nn,Ze]=m.useState(""),[wn,zn]=m.useState("text"),[Zt,Ee]=m.useState([]),[zt,L]=m.useState([]),[Se,ps]=m.useState(""),[cn,$t]=m.useState(""),[_,z]=m.useState(""),[Q,se]=m.useState(!1),[je,Ne]=m.useState({name:"",color:"#6b7280"}),[dt,qe]=m.useState(!1),[Ut,ne]=m.useState(""),{pushToast:X}=eu(),$n=m.useRef(new Map),un=m.useRef(new Map),_n=m.useRef(new Map),dn=m.useRef(new Map),Ds=m.useRef(new Map),[ms,Ms]=m.useState(null),[gs,ht]=m.useState([]),[vs,Un]=m.useState([]),[Vt,rl]=m.useState([]),[al,Nr]=m.useState(""),[_a,tu]=m.useState(null),[Vn,il]=m.useState([]),[nu,wr]=m.useState(null),[At,Sa]=m.useState({name:"",template_id:"",scheduled_for:"",send_now:!0}),[jt,_r]=m.useState({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),[Is,Fn]=m.useState([]),[ft,ka]=m.useState({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),[Bs,zs]=m.useState(null),[ll,ol]=m.useState([]),[cl,ul]=m.useState([]),[Qe,ba]=m.useState({id:"",code:"",name:"",address:"",lat:"",lng:"",hours_text:"",phone:"",is_active:!0}),[_e,Sr]=m.useState({id:"",code:"",name:"",subtitle:"",description:"",price_bob:"",duration_min:"",image_url:"",is_featured:!1,is_active:!0}),[xs,ys]=m.useState({id:"",name:"",language:"es",category:"",body_preview:"",is_active:!0}),[dl,js]=m.useState([]),Lt=m.useCallback((h,k={})=>{if(typeof window>"u")return;const O=h||"/";if(window.location.pathname===O){D(O);return}k.replace?window.history.replaceState({},"",O):window.history.pushState({},"",O),D(O)},[]),kr=m.useMemo(()=>gs.find(h=>h.id===At.template_id),[gs,At.template_id]),hl=m.useMemo(()=>{const h=[...yt].reverse().find(k=>k.type==="note");return(h==null?void 0:h.text)||""},[yt]),Ca=m.useMemo(()=>yt.filter(h=>h.type==="note"),[yt]);m.useEffect(()=>{if(typeof window>"u")return;const h=()=>{D(window.location.pathname||"/")};return window.addEventListener("popstate",h),()=>window.removeEventListener("popstate",h)},[]),m.useEffect(()=>{Hs(e||null)},[e]),m.useEffect(()=>{document.body.dataset.theme=E,localStorage.setItem("theme",E)},[E]),m.useEffect(()=>{H(!1),Oe(!0),requestAnimationFrame(()=>{R()}),K&&G(K)},[K==null?void 0:K.id]),m.useEffect(()=>{S==="chats"&&(H(!1),Oe(!0),requestAnimationFrame(()=>{R()}))},[S,K==null?void 0:K.id]),m.useEffect(()=>{K&&(pe?R():H(!0))},[yt,K==null?void 0:K.id,pe]),m.useEffect(()=>{S!=="chats"&&Oe(!1)},[S]),m.useEffect(()=>{if(!e)return;let h=!0;return ce("/api/me").then(k=>{h&&i(k.user)}).catch(()=>{h&&(t(""),i(null))}),()=>{h=!1}},[e]),m.useEffect(()=>{if(!a||a.role==="superadmin"){o(null),g([]),Pd();return}let h=!0;return ce("/api/branding").then(k=>{h&&o(k.branding||null)}).catch(()=>{h&&o(null)}),ce("/api/tenant").then(k=>{h&&f(k.tenant||null)}).catch(()=>{h&&f(null)}),ce("/api/channels").then(k=>{h&&g(k.channels||[])}).catch(()=>{h&&g([])}),()=>{h=!1}},[a]),m.useEffect(()=>{Pd()},[l]),m.useEffect(()=>{if(a){if(a.role==="superadmin"){He||Lt("/superadmin",{replace:!0});return}He&&Lt("/",{replace:!0})}},[a,He,Lt]),m.useEffect(()=>{a&&a.role!=="superadmin"&&(br(),$s())},[a]),m.useEffect(()=>{a&&a.role!=="superadmin"&&fl()},[a]),m.useEffect(()=>{!a||S!=="chats"||a.role!=="superadmin"&&pl()},[a,S,Ue]),m.useEffect(()=>{a&&a.role!=="superadmin"&&(S==="dashboard"&&Ot(),S==="campaigns"&&(Fs(),La(1,6)))},[a,S]),m.useEffect(()=>{if(!a||S!=="admin")return;const h=(U==null?void 0:U[a.role])||An[a.role],k=pt(h,"settings","users"),O=pt(h,"settings","bot"),I=pt(h,"settings","general"),ge=pt(h,"settings","templates"),bn=pt(h,"settings","audit");Z==="users"&&k&&Er(),Z==="bot"&&O&&vp(),Z==="general"&&I&&Hn(),Z==="templates"&&ge&&Fs(),Z==="audit"&&bn&&Lp()},[a,S,Z,U]),m.useEffect(()=>{if(!a||S!=="admin")return;const h=(U==null?void 0:U[a.role])||An[a.role],O=["general","users","bot","templates","audit","odoo"].filter(I=>pt(h,"settings",I));if(!O.length){P(result.user.role==="superadmin"?"superadmin":"chats");return}O.includes(Z)||C(O[0])},[a,S,Z,U]),m.useEffect(()=>{if(!e||(a==null?void 0:a.role)==="superadmin")return;const h=gx(e),k={current:null},O=["/sounds/new-notification-09-352705.wav","/sounds/new-notification-09-352705.mp3"],I=()=>{if(k.current)return k.current;const le=new Audio(O[0]);le.volume=1;let fe=0;return le.addEventListener("error",()=>{fe+=1,fe<O.length&&(le.src=O[fe],le.load())}),k.current=le,le},ge=()=>{const le=I();le.play().then(()=>{le.pause(),le.currentTime=0}).catch(()=>{})};window.addEventListener("click",ge,{once:!0}),window.addEventListener("touchstart",ge,{once:!0});const bn=()=>{if(!(typeof window>"u"))try{const le=I();le.currentTime=0,le.play().catch(()=>{})}catch{}};return h.on("conversation:update",({conversation:le})=>{const fe=Ds.current.get(le.id);Ds.current.set(le.id,le.status),le.status==="pending"&&!le.assigned_user_id&&fe!=="pending"&&(bn(),X({message:"Nueva conversacin pendiente"})),Tt(Ft=>{const wt=Ft.map(Cn=>Cn.id===le.id?{...Cn,...le}:Cn);return wt.find(Cn=>Cn.id===le.id)||wt.push(le),Jl(wt)}),Ce(Ft=>(Ft==null?void 0:Ft.id)===le.id?{...Ft,...le}:Ft)}),h.on("message:new",({conversation:le,message:fe})=>{le.status==="pending"&&!le.assigned_user_id&&bn();const Ft={...le,last_message_text:(fe==null?void 0:fe.text)||null,last_message_type:(fe==null?void 0:fe.type)||null,last_message_direction:(fe==null?void 0:fe.direction)||null,last_message_at:(fe==null?void 0:fe.created_at)||le.last_message_at};Tt(wt=>{const Cn=wt.map(Ar=>Ar.id===le.id?{...Ar,...Ft}:Ar);return Cn.find(Ar=>Ar.id===le.id)||Cn.push(Ft),Jl(Cn)}),Ce(wt=>(wt==null?void 0:wt.id)===le.id?{...wt,...Ft}:wt),ut(wt=>!K||K.id!==le.id?wt:(G(Ft),[...wt,fe]))}),()=>{h.disconnect()}},[e,K]),m.useEffect(()=>{if(!a)return;if(a.role==="superadmin"){S!=="superadmin"&&P("superadmin");return}const h=(U==null?void 0:U[a.role])||An[a.role],k=pt(h,"modules","chat"),O=pt(h,"modules","dashboard"),I=pt(h,"modules","campaigns"),ge=pt(h,"modules","settings");S==="chats"&&!k&&P(O?"dashboard":I?"campaigns":"admin"),S==="dashboard"&&!O&&P(k?"chats":I?"campaigns":"admin"),S==="campaigns"&&!I&&P(k?"chats":O?"dashboard":"admin"),S==="admin"&&!ge&&P(k?"chats":O?"dashboard":"campaigns")},[a,S,U]),m.useEffect(()=>{if(!a||a.role!=="admin"||!me||!ye||Je)return;const h=setTimeout(()=>{const k=Y.current;at(!0),Ge("/api/admin/role-permissions",{permissions:U}).then(()=>{Y.current===k&&Xe(!1)}).catch(O=>{ne(J(O))}).finally(()=>{at(!1)})},350);return()=>clearTimeout(h)},[a,U,ye,me,Je]);async function br(){try{const h=await ce("/api/users");L(h.users||[])}catch(h){ne(J(h))}}async function fl(){try{const h=await ce("/api/role-permissions"),k=Xl(h.permissions||null);Y.current=0,re(k),Xe(!1),de(!0)}catch(h){ne(J(h)),de(!0)}}async function $s(){try{const h=await ce("/api/tags");Ee(h.tags||[])}catch(h){ne(J(h))}}async function pl(){try{const h=cy(Ue),k=await ce(`/api/conversations${h}`);Tt(Jl(k.conversations||[]))}catch(h){ne(J(h))}}async function ml(h){qe(!0);try{const k=await ce(`/api/conversations/${h}`);let O=k.conversation;const I=k.messages||[];if((O==null?void 0:O.status)==="pending"&&!O.assigned_user_id&&(a!=null&&a.id))try{O=(await Ge(`/api/conversations/${h}/assign`,{})).conversation}catch(ge){String(J(ge)).includes("already_assigned")&&X({type:"error",message:"Conversacin tomada por otro operador"})}Ce(O),ut(I),G(O)}catch(k){ne(J(k))}finally{qe(!1)}}async function gl(h){h.preventDefault(),v("");try{const k=await ke("/api/auth/login",{email:w.email,password:w.password});t(k.token),Hs(k.token),i(k.user),r(""),localStorage.removeItem("superadmin_token");const O=k.user.role==="superadmin";P(O?"superadmin":"chats"),O?Lt("/superadmin",{replace:!0}):He&&Lt("/",{replace:!0})}catch{v("Credenciales invalidas")}}function Us(){t(""),Hs(null),i(null),Tt([]),Ce(null),ut([]),P("chats"),we(!1),re(Xl(null)),de(!1),Xe(!1),at(!1),Y.current=0,r(""),localStorage.removeItem("superadmin_token"),Lt("/",{replace:!0})}async function Cr(h){const k=await ke(`/api/superadmin/tenants/${h}/impersonate`);!n&&e&&(localStorage.setItem("superadmin_token",e),r(e)),t(k.token),Hs(k.token),i(k.user),P("chats"),Lt("/",{replace:!0})}function Ea(){const h=n||(typeof window<"u"?localStorage.getItem("superadmin_token"):"");if(!h){Us();return}localStorage.removeItem("superadmin_token"),r(""),t(h),Hs(h),i(null),P("chats"),Lt("/superadmin",{replace:!0})}function Ta(h){re(k=>typeof h=="function"?h(k):h),Y.current+=1,Xe(!0)}function u(){$(h=>h==="light"?"dark":"light")}function R(){const h=W.current;h&&(h.scrollTop=h.scrollHeight,Oe(!0),H(!1))}function G(h){!(h!=null&&h.id)||!(h!=null&&h.last_message_at)||A(k=>{const O={...k,[h.id]:h.last_message_at};return localStorage.setItem("last_read_map",JSON.stringify(O)),O})}function ae(){const h=W.current;if(!h)return;const O=h.scrollHeight-h.scrollTop-h.clientHeight<24;Oe(O),O&&H(!1)}function ie(){Ce(null),ut([])}function ze(h){var k;Ze(h),(k=b.current)==null||k.focus()}async function Nt(h){if(h.preventDefault(),!K||!Nn.trim())return;const k=Nn.trim();Ze("");try{await ke(`/api/conversations/${K.id}/messages`,{text:k,type:wn})}catch(O){ne(J(O))}}async function Sn(h){if(h.preventDefault(),!K||!cn.trim())return;const k=cn.trim();$t("");try{const O=await ke(`/api/conversations/${K.id}/messages`,{text:k,type:"note"});O!=null&&O.message&&ut(I=>[...I,O.message]),O!=null&&O.conversation&&Ce(O.conversation)}catch(O){ne(J(O))}}async function Vs(){if(K)try{const h=await Ge(`/api/conversations/${K.id}/assign`);Ce(h.conversation)}catch(h){const k=J(h)||"No se pudo tomar la conversacion";X({type:"error",message:k})}}async function Aa(){if(!(!K||!_))try{const h=await Ge(`/api/conversations/${K.id}/assign`,{user_id:_});Ce(h.conversation),z(""),X({message:"Conversacin reasignada"})}catch(h){const k=J(h)||"No se pudo reasignar";X({type:"error",message:k})}}async function vl(h){if(K)try{const k=await Ge(`/api/conversations/${K.id}/status`,{status:h});Ce(k.conversation)}catch(k){ne(J(k))}}async function kn(h){var O;if(!K)return;const k=((O=K.tags)==null?void 0:O.some(I=>I.name===h))||!1;if(k){const I=`${K.id}:${h}`;if(dn.current.has(I))return;const ge=K,bn={...K,tags:(K.tags||[]).filter(fe=>fe.name!==h)};Ce(bn);const le=setTimeout(async()=>{try{const fe=await ke(`/api/conversations/${ge.id}/tags`,{add:[],remove:[h]});(K==null?void 0:K.id)===ge.id&&Ce(fe.conversation)}catch(fe){(K==null?void 0:K.id)===ge.id&&Ce(ge),X({type:"error",message:J(fe)||"No se pudo eliminar el tag"})}finally{dn.current.delete(I)}},8e3);dn.current.set(I,{timer:le,snapshot:ge}),X({message:"Tag eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const fe=dn.current.get(I);fe!=null&&fe.timer&&clearTimeout(fe.timer),fe!=null&&fe.snapshot?Ce(fe.snapshot):Ce(ge),dn.current.delete(I),X({message:"Eliminacin cancelada"})}});return}try{const I=await ke(`/api/conversations/${K.id}/tags`,{add:k?[]:[h],remove:k?[h]:[]});Ce(I.conversation)}catch(I){ne(J(I))}}async function hn(h){if(h.preventDefault(),!Se.trim()||!K)return;const k=Se.trim();ps("");try{const O=await ke(`/api/conversations/${K.id}/tags`,{add:[k]});Ce(O.conversation),await $s()}catch(O){ne(J(O))}}async function fn(h){h.preventDefault();const k=je.name.trim();if(!k){ne("Completa el nombre de la etiqueta");return}try{await ke("/api/tags",{name:k,color:je.color||null}),Ne({name:"",color:"#6b7280"}),await $s(),X({message:"Etiqueta creada"})}catch(O){ne(J(O))}}async function Wn(h,k){if(h)try{await Yn(`/api/tags/${h}`),Ce(O=>O&&{...O,tags:(O.tags||[]).filter(I=>I.name!==k)}),await $s(),X({message:"Etiqueta eliminada"})}catch(O){ne(J(O))}}async function Ot(){try{const h=await ce("/api/dashboard/metrics");Ms(h)}catch(h){ne(J(h))}}async function Fs(){try{const h=await ce("/api/templates").catch(()=>ce("/api/admin/templates"));ht(h.templates||[])}catch(h){ne(J(h))}}async function La(h=1,k=6){try{const O=await ce(`/api/admin/campaigns?page=${h}&page_size=${k}`);Un(O.campaigns||[])}catch(O){ne(J(O))}}async function dp(h){Nr(h);try{const k=await ce(`/api/admin/campaigns/${h}/messages`);rl(k.messages||[])}catch(k){ne(J(k))}}async function hp(h){var O;if(h.preventDefault(),!At.name.trim()||!At.template_id){ne("Completa el nombre y plantilla");return}const k={};jt.status&&(k.status=jt.status),jt.tag&&(k.tag=jt.tag.trim()),jt.assigned_user_id&&(k.assigned_user_id=jt.assigned_user_id),jt.verified_only&&(k.verified_only=!0),jt.segment_id&&(k.segment_id=jt.segment_id,jt.segment_name&&(k.segment_name=jt.segment_name));try{const I=await ke("/api/admin/campaigns",{name:At.name.trim(),template_id:At.template_id,audience_filter:k,scheduled_for:At.scheduled_for||null});if(At.send_now&&!At.scheduled_for){const ge=(O=I==null?void 0:I.campaign)==null?void 0:O.id;ge&&await ke(`/api/admin/campaigns/${ge}/send`,{})}Sa({name:"",template_id:"",scheduled_for:"",send_now:!0}),_r({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),await La(1,6),X({message:"Campaa creada correctamente"})}catch(I){ne(J(I)),X({type:"error",message:J(I)||"Error al crear campaa"})}}async function fp(h){try{await ke(`/api/admin/campaigns/${h}/send`,{}),await La(1,6)}catch(k){ne(J(k))}}async function pp(){try{await ce("/api/templates/sync"),await Fs()}catch(h){ne(J(h))}}async function Er(){try{const h=await ce("/api/admin/users");Fn(h.users||[])}catch(h){ne(J(h))}}async function mp(h){if(h.preventDefault(),!ft.name.trim()||!ft.role){ne("Completa los campos requeridos");return}try{ft.id?(await Ge(`/api/admin/users/${ft.id}`,{name:ft.name.trim(),role:ft.role,is_active:ft.is_active,password:ft.password||void 0}),X({message:"Usuario actualizado correctamente"})):(await ke("/api/admin/users",{name:ft.name.trim(),email:ft.email.trim().toLowerCase(),role:ft.role,password:ft.password}),X({message:"Usuario creado correctamente"})),ka({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),await Er()}catch(k){ne(J(k)),X({type:"error",message:J(k)||"Error al guardar usuario"})}}async function gp(h){if(!h||$n.current.has(h))return;let k=null;try{k=Is.slice(),Fn(I=>I.filter(ge=>ge.id!==h));const O=setTimeout(async()=>{try{await Yn(`/api/admin/users/${h}`),await Er(),X({message:"Usuario eliminado definitivamente"})}catch(I){k?Fn(k):await Er(),X({type:"error",message:J(I)||"No se pudo eliminar el usuario"})}finally{$n.current.delete(h)}},8e3);$n.current.set(h,{timer:O,snapshot:k}),X({message:"Usuario eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const I=$n.current.get(h);I!=null&&I.timer&&clearTimeout(I.timer),I!=null&&I.snapshot?Fn(I.snapshot):k?Fn(k):await Er(),$n.current.delete(h),X({message:"Eliminacin cancelada"})}})}catch(O){ne(J(O)),X({type:"error",message:J(O)||"Error al eliminar usuario"})}}async function vp(){try{const h=await ce("/api/admin/settings");zs(h.settings)}catch(h){ne(J(h))}}async function xp(){if(Bs)try{const h=await Ge("/api/admin/settings",{bot_enabled:Bs.bot_enabled,auto_reply_enabled:Bs.auto_reply_enabled});zs(h.settings)}catch(h){ne(J(h))}}async function Hn(){try{const[h,k]=await Promise.all([ce("/api/admin/branches"),ce("/api/admin/services")]);ol(h.branches||[]),ul(k.services||[])}catch(h){ne(J(h))}}async function yp(){try{const h=await ce("/api/channels");g(h.channels||[])}catch{g([])}}function jp(h){T({id:h.id,display_name:h.display_name||""})}async function Np(h){if(h.preventDefault(),!!j.id)try{await Ge(`/api/channels/${j.id}`,{display_name:j.display_name.trim()}),T({id:"",display_name:""}),await yp(),X({message:"Canal actualizado correctamente"})}catch(k){ne(J(k)),X({type:"error",message:J(k)||"Error al guardar canal"})}}async function wp(h){const k=U==null?void 0:U[h];if(!(!h||un.current.has(h)))try{re(I=>{const ge={...I};return delete ge[h],ge});const O=setTimeout(async()=>{try{await Yn(`/api/admin/role-permissions/${h}`),X({message:"Rol eliminado definitivamente"})}catch(I){k&&re(ge=>({...ge,[h]:k})),X({type:"error",message:J(I)||"No se pudo eliminar el rol"})}finally{un.current.delete(h)}},8e3);un.current.set(h,{timer:O,currentPermissions:k}),X({message:"Rol eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const I=un.current.get(h);I!=null&&I.timer&&clearTimeout(I.timer),I!=null&&I.currentPermissions&&re(ge=>({...ge,[h]:I.currentPermissions})),un.current.delete(h),X({message:"Eliminacin cancelada"})}})}catch(O){ne(J(O)),X({type:"error",message:J(O)||"Error al eliminar rol"})}}async function _p(h){if(h.preventDefault(),!Qe.code.trim()||!Qe.name.trim()){ne("Completa codigo y nombre");return}const k={code:Qe.code.trim(),name:Qe.name.trim(),address:Qe.address.trim(),lat:Qe.lat!==""?Number(Qe.lat):0,lng:Qe.lng!==""?Number(Qe.lng):0,hours_text:Qe.hours_text.trim(),phone:Qe.phone.trim()||null,is_active:Qe.is_active};try{Qe.id?(await Ge(`/api/admin/branches/${Qe.id}`,k),X({message:"Sucursal actualizada correctamente"})):(await ke("/api/admin/branches",k),X({message:"Sucursal creada correctamente"})),ba({id:"",code:"",name:"",address:"",lat:"",lng:"",hours_text:"",phone:"",is_active:!0}),await Hn()}catch(O){ne(J(O)),X({type:"error",message:J(O)||"Error al guardar sucursal"})}}async function Sp(h){try{await Yn(`/api/admin/branches/${h}`),await Hn(),X({message:"Sucursal eliminada correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{await Ge(`/api/admin/branches/${h}`,{is_active:!0}),await Hn(),X({message:"Sucursal restaurada"})}catch(k){X({type:"error",message:J(k)||"No se pudo restaurar la sucursal"})}}})}catch(k){ne(J(k)),X({type:"error",message:J(k)||"Error al eliminar sucursal"})}}async function kp(h){if(h.preventDefault(),!_e.code.trim()||!_e.name.trim()){ne("Completa codigo y nombre");return}const k={code:_e.code.trim(),name:_e.name.trim(),subtitle:_e.subtitle.trim()||null,description:_e.description.trim(),price_bob:_e.price_bob?Number(_e.price_bob):0,duration_min:_e.duration_min?Number(_e.duration_min):null,image_url:_e.image_url.trim()||null,is_featured:_e.is_featured,is_active:_e.is_active};try{_e.id?(await Ge(`/api/admin/services/${_e.id}`,k),X({message:"Servicio actualizado correctamente"})):(await ke("/api/admin/services",k),X({message:"Servicio creado correctamente"})),Sr({id:"",code:"",name:"",subtitle:"",description:"",price_bob:"",duration_min:"",image_url:"",is_featured:!1,is_active:!0}),await Hn()}catch(O){ne(J(O)),X({type:"error",message:J(O)||"Error al guardar servicio"})}}async function bp(h){try{await Yn(`/api/admin/services/${h}`),await Hn(),X({message:"Servicio eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{await Ge(`/api/admin/services/${h}`,{is_active:!0}),await Hn(),X({message:"Servicio restaurado"})}catch(k){X({type:"error",message:J(k)||"No se pudo restaurar el servicio"})}}})}catch(k){ne(J(k)),X({type:"error",message:J(k)||"Error al eliminar servicio"})}}async function Cp(h,k,O){if(h)try{await ke(`/api/admin/services/${h.id}/branches`,{branch_id:k,is_available:O}),await Hn()}catch(I){ne(J(I))}}async function Ep(h,k){h!=null&&h.preventDefault&&h.preventDefault();const O=k||xs||{},I=typeof O.name=="string"?O.name.trim():"";if(!I)return ne("Completa el nombre"),null;const ge={name:I,category:O.category||"UTILITY",language:O.language||"es",body_text:O.body_text||O.body_preview||"",header_type:O.header_type||null,header_content:O.header_content||null,footer_text:O.footer_text||null,buttons:O.buttons||O.buttons_json||[]},bn=O.variable_mappings||O.variableMappings||[];try{let le=null;return O.id?(le=await Qo(`/api/templates/${O.id}`,ge),await Qo(`/api/templates/${O.id}/mappings`,{mappings:bn}),X({message:"Borrador actualizado correctamente"})):(le=await ke("/api/templates/draft",{...ge,variable_mappings:bn}),X({message:"Borrador creado correctamente"})),await Fs(),(le==null?void 0:le.template)||null}catch(le){return ne(J(le)),X({type:"error",message:J(le)||"Error al guardar plantilla"}),null}}async function Tp(h){if(h)try{await ke(`/api/templates/${h}/submit`,{}),await Fs(),X({message:"Plantilla enviada a revisin de Meta"})}catch(k){ne(J(k)),X({type:"error",message:J(k)||"Error al enviar a Meta"})}}async function Ap(h){if(h&&!_n.current.has(h))try{const k=gs.slice();ht(I=>I.filter(ge=>ge.id!==h));const O=setTimeout(async()=>{try{await Yn(`/api/templates/${h}`),await Fs(),X({message:"Plantilla eliminada definitivamente"})}catch(I){ht(k),X({type:"error",message:J(I)||"No se pudo eliminar la plantilla"})}finally{_n.current.delete(h)}},8e3);_n.current.set(h,{timer:O,snapshot:k}),X({message:"Plantilla eliminada. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const I=_n.current.get(h);I!=null&&I.timer&&clearTimeout(I.timer),I!=null&&I.snapshot?ht(I.snapshot):ht(k),_n.current.delete(h),X({message:"Eliminacin cancelada"})}})}catch(k){ne(J(k)),X({type:"error",message:J(k)||"Error al eliminar plantilla"})}}async function Lp(){try{const h=await ce("/api/admin/audit?limit=200");js(h.logs||[])}catch(h){ne(J(h))}}const su={open:0,pending:0,closed:0};((ms==null?void 0:ms.status_counts)||[]).forEach(h=>{su[h.status]=h._count.status});const Op=He?"Acceso al control plane":"Acceso a bandeja multiusuario";if(!e||!a)return s.jsx("div",{className:"login-shell",children:s.jsxs("div",{className:"login-card",children:[s.jsx("div",{className:"login-title",children:"Perzivalh"}),s.jsx("div",{className:"login-subtitle",children:Op}),s.jsxs("form",{className:"login-form",onSubmit:gl,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:w.email,onChange:h=>d(k=>({...k,email:h.target.value})),required:!0})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:w.password,onChange:h=>d(k=>({...k,password:h.target.value})),required:!0})]}),p?s.jsx("div",{className:"error",children:p}):null,s.jsx("button",{className:"primary",type:"submit",children:"Entrar"})]})]})});if((a==null?void 0:a.role)==="superadmin"&&He)return s.jsx("main",{className:"superadmin-page",children:s.jsx(Ad,{route:N,onNavigate:Lt,onImpersonateTenant:Cr,onLogout:Us})});const Tr=(U==null?void 0:U[a.role])||An[a.role],Rp=pt(Tr,"modules","chat"),Pp=pt(Tr,"modules","dashboard"),Dp=pt(Tr,"modules","campaigns"),Mp=pt(Tr,"modules","settings"),Ip=oy(a,["admin"]),Bp=pt(Tr,"modules","chat","write"),zp=["Confirmar Cita","Solicitar Resultados","Urgencia"],ru={open:"Bot activo",pending:"Pendiente",assigned:"Tomada"},$p=K?K.display_name||K.phone_e164||K.wa_id:"Selecciona un chat",Up=(K==null?void 0:K.phone_e164)||(K==null?void 0:K.wa_id)||"",Vp=K?ru[K.status]||"Sin estado":"",Fp=[{id:"chats",label:"Chats",icon:uy,enabled:Rp},{id:"dashboard",label:"Dashboard",icon:dy,enabled:Pp},{id:"campaigns",label:"Campanas",icon:hy,enabled:Dp},{id:"admin",label:"Configuraciones",icon:fy,enabled:Mp}],xl=[];let au="";yt.forEach(h=>{const k=h.created_at,O=k?new Date(k):null,I=O&&!Number.isNaN(O.getTime())?`${O.getFullYear()}-${O.getMonth()}-${O.getDate()}`:"";I&&I!==au&&(xl.push(s.jsx("div",{className:"day-pill",children:ly(k)},`day-${I}`)),au=I),xl.push(s.jsxs("div",{className:`message ${h.direction} ${h.type==="note"?"note":""}`,children:[s.jsx("div",{className:"message-text",children:h.text||`[${h.type}]`}),s.jsx("div",{className:"message-meta",children:Kl(h.created_at)})]},h.id))});const Wp=!!n&&a.role!=="superadmin";return s.jsxs("div",{className:`app-shell ${S==="admin"?"admin-shell":""}`,children:[s.jsx(yx,{navItems:Fp,view:S,onSetView:P,theme:E,onToggleTheme:u,user:a,logoUrl:(l==null?void 0:l.logo_url)||"",brandName:(l==null?void 0:l.brand_name)||"",isProfileOpen:Be,onToggleProfile:()=>we(h=>!h),onLogout:Us,onReturnToSuperadmin:Ea,showReturnToSuperadmin:Wp,getInitial:Rd,SunIcon:py,MoonIcon:my}),S==="admin"?s.jsx(Wx,{settingsSection:Z,setSettingsSection:C,settingsTab:ee,setSettingsTab:V,rolePermissions:U,setRolePermissions:Ta,defaultRolePermissions:An,currentRole:a.role,isAdmin:Ip,adminUsers:Is,userForm:ft,setUserForm:ka,roleOptions:Et,handleUserSubmit:mp,handleUserDelete:gp,settings:Bs,setSettings:zs,handleSaveSettings:xp,planName:(c==null?void 0:c.plan)||"",branches:ll,services:cl,branchForm:Qe,setBranchForm:ba,handleBranchSubmit:_p,handleBranchDisable:Sp,serviceForm:_e,setServiceForm:Sr,handleServiceSubmit:kp,handleServiceDisable:bp,handleServiceBranchToggle:Cp,tenantChannels:x,channelForm:j,setChannelForm:T,handleChannelSelect:jp,handleChannelSubmit:Np,handleRoleDelete:wp,templates:gs,templateForm:xs,setTemplateForm:ys,handleTemplateSubmit:Ep,handleTemplateSubmitToMeta:Tp,handleTemplateDelete:Ap,handleSyncTemplates:pp,auditLogs:dl,formatDate:Kl,useShellLayout:!0,pageError:Ut}):S==="superadmin"?s.jsx("main",{className:"content content-page",children:s.jsx(Ad,{onImpersonateTenant:Cr,onLogout:Us})}):s.jsxs("main",{className:`content ${S==="chats"?"content-chats":"content-page"}`,children:[S==="chats"&&s.jsx(jx,{activeConversation:K,conversations:Jt,channels:x,brandName:(l==null?void 0:l.brand_name)||"",lastReadMap:y,filters:Ue,showFilters:F,users:zt,tags:Zt,statusOptions:Ld,statusLabels:ru,formatListTime:iy,formatCompactDate:ay,messageBlocks:xl,messageDraft:Nn,messageMode:wn,quickActions:zp,tagInput:Se,noteInput:cn,notesList:Ca,latestNote:hl,loadingConversation:dt,isInfoOpen:he,hasUnread:B,activeName:$p,activePhone:Up,activeStatusLabel:Vp,canManageStatus:Bp,currentUser:a,messageInputRef:b,chatBodyRef:W,setShowFilters:te,setFilters:Ve,loadConversation:ml,handleBackToList:ie,setIsInfoOpen:xe,handleChatScroll:ae,handleAssignSelf:Vs,handleStatusChange:vl,handleToggleTag:kn,handleAddTag:hn,setNoteInput:$t,handleAddNote:Sn,reassignUserId:_,setReassignUserId:z,handleReassignConversation:Aa,handleOpenTagManager:()=>se(!0),handleCloseTagManager:()=>se(!1),showTagManager:Q,tagManagerForm:je,setTagManagerForm:Ne,handleCreateTag:fn,handleDeleteTag:Wn,handleQuickAction:ze,handleSendMessage:Nt,setMessageMode:zn,setMessageDraft:Ze,scrollChatToBottom:R,getInitial:Rd,PlusIcon:vy,SearchIcon:gy,VideoIcon:xy,PhoneIcon:yy,InfoIcon:jy,SendIcon:Ny}),S==="dashboard"&&s.jsx(_x,{statusCounts:su,metrics:ms,onRefresh:Ot}),S==="campaigns"&&s.jsx(bx,{campaignForm:At,setCampaignForm:Sa,campaignFilter:jt,setCampaignFilter:_r,templates:gs,campaigns:vs,selectedCampaignId:al,campaignMessages:Vt,users:zt,tags:Zt,selectedTemplate:kr,statusOptions:Ld,onCreateCampaign:hp,onLoadCampaigns:La,onLoadCampaignMessages:dp,onSendCampaign:fp,formatDate:Kl}),Ut&&s.jsx("div",{className:"error-banner",children:Ut})]})]})}const _y=Gf(document.getElementById("root"));_y.render(s.jsx(vx,{children:s.jsx(wy,{})}));
