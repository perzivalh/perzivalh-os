(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var qh={exports:{}},Fl={},Gh={exports:{}},Ne={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var li=Symbol.for("react.element"),wm=Symbol.for("react.portal"),_m=Symbol.for("react.fragment"),Sm=Symbol.for("react.strict_mode"),km=Symbol.for("react.profiler"),bm=Symbol.for("react.provider"),Cm=Symbol.for("react.context"),Em=Symbol.for("react.forward_ref"),Am=Symbol.for("react.suspense"),Tm=Symbol.for("react.memo"),Lm=Symbol.for("react.lazy"),fd=Symbol.iterator;function Rm(e){return e===null||typeof e!="object"?null:(e=fd&&e[fd]||e["@@iterator"],typeof e=="function"?e:null)}var Qh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Kh=Object.assign,Yh={};function Yr(e,t,n){this.props=e,this.context=t,this.refs=Yh,this.updater=n||Qh}Yr.prototype.isReactComponent={};Yr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Yr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Xh(){}Xh.prototype=Yr.prototype;function hu(e,t,n){this.props=e,this.context=t,this.refs=Yh,this.updater=n||Qh}var fu=hu.prototype=new Xh;fu.constructor=hu;Kh(fu,Yr.prototype);fu.isPureReactComponent=!0;var pd=Array.isArray,Jh=Object.prototype.hasOwnProperty,pu={current:null},Zh={key:!0,ref:!0,__self:!0,__source:!0};function ef(e,t,n){var r,a={},i=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)Jh.call(t,r)&&!Zh.hasOwnProperty(r)&&(a[r]=t[r]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var u=Array(c),m=0;m<c;m++)u[m]=arguments[m+2];a.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)a[r]===void 0&&(a[r]=c[r]);return{$$typeof:li,type:e,key:i,ref:l,props:a,_owner:pu.current}}function Om(e,t){return{$$typeof:li,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function mu(e){return typeof e=="object"&&e!==null&&e.$$typeof===li}function Pm(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var md=/\/+/g;function Po(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Pm(""+e.key):t.toString(36)}function tl(e,t,n,r,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case li:case wm:l=!0}}if(l)return l=e,a=a(l),e=r===""?"."+Po(l,0):r,pd(a)?(n="",e!=null&&(n=e.replace(md,"$&/")+"/"),tl(a,t,n,"",function(m){return m})):a!=null&&(mu(a)&&(a=Om(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(md,"$&/")+"/")+e)),t.push(a)),1;if(l=0,r=r===""?".":r+":",pd(e))for(var c=0;c<e.length;c++){i=e[c];var u=r+Po(i,c);l+=tl(i,t,n,u,a)}else if(u=Rm(e),typeof u=="function")for(e=u.call(e),c=0;!(i=e.next()).done;)i=i.value,u=r+Po(i,c++),l+=tl(i,t,n,u,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Ri(e,t,n){if(e==null)return e;var r=[],a=0;return tl(e,r,"","",function(i){return t.call(n,i,a++)}),r}function Im(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Et={current:null},nl={transition:null},Mm={ReactCurrentDispatcher:Et,ReactCurrentBatchConfig:nl,ReactCurrentOwner:pu};function tf(){throw Error("act(...) is not supported in production builds of React.")}Ne.Children={map:Ri,forEach:function(e,t,n){Ri(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ri(e,function(){t++}),t},toArray:function(e){return Ri(e,function(t){return t})||[]},only:function(e){if(!mu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ne.Component=Yr;Ne.Fragment=_m;Ne.Profiler=km;Ne.PureComponent=hu;Ne.StrictMode=Sm;Ne.Suspense=Am;Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mm;Ne.act=tf;Ne.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Kh({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=pu.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)Jh.call(t,u)&&!Zh.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&c!==void 0?c[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var m=0;m<u;m++)c[m]=arguments[m+2];r.children=c}return{$$typeof:li,type:e.type,key:a,ref:i,props:r,_owner:l}};Ne.createContext=function(e){return e={$$typeof:Cm,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:bm,_context:e},e.Consumer=e};Ne.createElement=ef;Ne.createFactory=function(e){var t=ef.bind(null,e);return t.type=e,t};Ne.createRef=function(){return{current:null}};Ne.forwardRef=function(e){return{$$typeof:Em,render:e}};Ne.isValidElement=mu;Ne.lazy=function(e){return{$$typeof:Lm,_payload:{_status:-1,_result:e},_init:Im}};Ne.memo=function(e,t){return{$$typeof:Tm,type:e,compare:t===void 0?null:t}};Ne.startTransition=function(e){var t=nl.transition;nl.transition={};try{e()}finally{nl.transition=t}};Ne.unstable_act=tf;Ne.useCallback=function(e,t){return Et.current.useCallback(e,t)};Ne.useContext=function(e){return Et.current.useContext(e)};Ne.useDebugValue=function(){};Ne.useDeferredValue=function(e){return Et.current.useDeferredValue(e)};Ne.useEffect=function(e,t){return Et.current.useEffect(e,t)};Ne.useId=function(){return Et.current.useId()};Ne.useImperativeHandle=function(e,t,n){return Et.current.useImperativeHandle(e,t,n)};Ne.useInsertionEffect=function(e,t){return Et.current.useInsertionEffect(e,t)};Ne.useLayoutEffect=function(e,t){return Et.current.useLayoutEffect(e,t)};Ne.useMemo=function(e,t){return Et.current.useMemo(e,t)};Ne.useReducer=function(e,t,n){return Et.current.useReducer(e,t,n)};Ne.useRef=function(e){return Et.current.useRef(e)};Ne.useState=function(e){return Et.current.useState(e)};Ne.useSyncExternalStore=function(e,t,n){return Et.current.useSyncExternalStore(e,t,n)};Ne.useTransition=function(){return Et.current.useTransition()};Ne.version="18.3.1";Gh.exports=Ne;var h=Gh.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dm=h,Bm=Symbol.for("react.element"),zm=Symbol.for("react.fragment"),$m=Object.prototype.hasOwnProperty,Um=Dm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Vm={key:!0,ref:!0,__self:!0,__source:!0};function nf(e,t,n){var r,a={},i=null,l=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)$m.call(t,r)&&!Vm.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Bm,type:e,key:i,ref:l,props:a,_owner:Um.current}}Fl.Fragment=zm;Fl.jsx=nf;Fl.jsxs=nf;qh.exports=Fl;var s=qh.exports,sf={exports:{}},Wt={},rf={exports:{}},af={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,te){var Z=W.length;W.push(te);e:for(;0<Z;){var ce=Z-1>>>1,le=W[ce];if(0<a(le,te))W[ce]=te,W[Z]=le,Z=ce;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var te=W[0],Z=W.pop();if(Z!==te){W[0]=Z;e:for(var ce=0,le=W.length,be=le>>>1;ce<be;){var T=2*(ce+1)-1,q=W[T],k=T+1,U=W[k];if(0>a(q,Z))k<le&&0>a(U,q)?(W[ce]=U,W[k]=Z,ce=k):(W[ce]=q,W[T]=Z,ce=T);else if(k<le&&0>a(U,Z))W[ce]=U,W[k]=Z,ce=k;else break e}}return te}function a(W,te){var Z=W.sortIndex-te.sortIndex;return Z!==0?Z:W.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var u=[],m=[],S=1,g=null,y=3,E=!1,O=!1,P=!1,b=typeof setTimeout=="function"?setTimeout:null,f=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(W){for(var te=n(m);te!==null;){if(te.callback===null)r(m);else if(te.startTime<=W)r(m),te.sortIndex=te.expirationTime,t(u,te);else break;te=n(m)}}function j(W){if(P=!1,v(W),!O)if(n(u)!==null)O=!0,Ee(R);else{var te=n(m);te!==null&&Me(j,te.startTime-W)}}function R(W,te){O=!1,P&&(P=!1,f(N),N=-1),E=!0;var Z=y;try{for(v(te),g=n(u);g!==null&&(!(g.expirationTime>te)||W&&!Y());){var ce=g.callback;if(typeof ce=="function"){g.callback=null,y=g.priorityLevel;var le=ce(g.expirationTime<=te);te=e.unstable_now(),typeof le=="function"?g.callback=le:g===n(u)&&r(u),v(te)}else r(u);g=n(u)}if(g!==null)var be=!0;else{var T=n(m);T!==null&&Me(j,T.startTime-te),be=!1}return be}finally{g=null,y=Z,E=!1}}var $=!1,A=null,N=-1,V=5,I=-1;function Y(){return!(e.unstable_now()-I<V)}function he(){if(A!==null){var W=e.unstable_now();I=W;var te=!0;try{te=A(!0,W)}finally{te?fe():($=!1,A=null)}}else $=!1}var fe;if(typeof p=="function")fe=function(){p(he)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,ke=Se.port2;Se.port1.onmessage=he,fe=function(){ke.postMessage(null)}}else fe=function(){b(he,0)};function Ee(W){A=W,$||($=!0,fe())}function Me(W,te){N=b(function(){W(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){O||E||(O=!0,Ee(R))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(W){switch(y){case 1:case 2:case 3:var te=3;break;default:te=y}var Z=y;y=te;try{return W()}finally{y=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,te){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Z=y;y=W;try{return te()}finally{y=Z}},e.unstable_scheduleCallback=function(W,te,Z){var ce=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ce+Z:ce):Z=ce,W){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=Z+le,W={id:S++,callback:te,priorityLevel:W,startTime:Z,expirationTime:le,sortIndex:-1},Z>ce?(W.sortIndex=Z,t(m,W),n(u)===null&&W===n(m)&&(P?(f(N),N=-1):P=!0,Me(j,Z-ce))):(W.sortIndex=le,t(u,W),O||E||(O=!0,Ee(R))),W},e.unstable_shouldYield=Y,e.unstable_wrapCallback=function(W){var te=y;return function(){var Z=y;y=te;try{return W.apply(this,arguments)}finally{y=Z}}}})(af);rf.exports=af;var Fm=rf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wm=h,Ft=Fm;function z(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lf=new Set,Wa={};function fr(e,t){Fr(e,t),Fr(e+"Capture",t)}function Fr(e,t){for(Wa[e]=t,e=0;e<t.length;e++)lf.add(t[e])}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hc=Object.prototype.hasOwnProperty,Hm=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vd={},gd={};function qm(e){return hc.call(gd,e)?!0:hc.call(vd,e)?!1:Hm.test(e)?gd[e]=!0:(vd[e]=!0,!1)}function Gm(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Qm(e,t,n,r){if(t===null||typeof t>"u"||Gm(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function At(e,t,n,r,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){vt[e]=new At(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];vt[t]=new At(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){vt[e]=new At(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){vt[e]=new At(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){vt[e]=new At(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){vt[e]=new At(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){vt[e]=new At(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){vt[e]=new At(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){vt[e]=new At(e,5,!1,e.toLowerCase(),null,!1,!1)});var vu=/[\-:]([a-z])/g;function gu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(vu,gu);vt[t]=new At(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(vu,gu);vt[t]=new At(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(vu,gu);vt[t]=new At(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){vt[e]=new At(e,1,!1,e.toLowerCase(),null,!1,!1)});vt.xlinkHref=new At("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){vt[e]=new At(e,1,!1,e.toLowerCase(),null,!0,!0)});function xu(e,t,n,r){var a=vt.hasOwnProperty(t)?vt[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Qm(t,n,a,r)&&(n=null),r||a===null?qm(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ts=Wm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oi=Symbol.for("react.element"),kr=Symbol.for("react.portal"),br=Symbol.for("react.fragment"),yu=Symbol.for("react.strict_mode"),fc=Symbol.for("react.profiler"),of=Symbol.for("react.provider"),cf=Symbol.for("react.context"),ju=Symbol.for("react.forward_ref"),pc=Symbol.for("react.suspense"),mc=Symbol.for("react.suspense_list"),Nu=Symbol.for("react.memo"),ys=Symbol.for("react.lazy"),uf=Symbol.for("react.offscreen"),xd=Symbol.iterator;function ja(e){return e===null||typeof e!="object"?null:(e=xd&&e[xd]||e["@@iterator"],typeof e=="function"?e:null)}var Fe=Object.assign,Io;function Aa(e){if(Io===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Io=t&&t[1]||""}return`
`+Io+e}var Mo=!1;function Do(e,t){if(!e||Mo)return"";Mo=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(m){var r=m}Reflect.construct(e,[],t)}else{try{t.call()}catch(m){r=m}e.call(t.prototype)}else{try{throw Error()}catch(m){r=m}e()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var a=m.stack.split(`
`),i=r.stack.split(`
`),l=a.length-1,c=i.length-1;1<=l&&0<=c&&a[l]!==i[c];)c--;for(;1<=l&&0<=c;l--,c--)if(a[l]!==i[c]){if(l!==1||c!==1)do if(l--,c--,0>c||a[l]!==i[c]){var u=`
`+a[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=c);break}}}finally{Mo=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Aa(e):""}function Km(e){switch(e.tag){case 5:return Aa(e.type);case 16:return Aa("Lazy");case 13:return Aa("Suspense");case 19:return Aa("SuspenseList");case 0:case 2:case 15:return e=Do(e.type,!1),e;case 11:return e=Do(e.type.render,!1),e;case 1:return e=Do(e.type,!0),e;default:return""}}function vc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case br:return"Fragment";case kr:return"Portal";case fc:return"Profiler";case yu:return"StrictMode";case pc:return"Suspense";case mc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case cf:return(e.displayName||"Context")+".Consumer";case of:return(e._context.displayName||"Context")+".Provider";case ju:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Nu:return t=e.displayName||null,t!==null?t:vc(e.type)||"Memo";case ys:t=e._payload,e=e._init;try{return vc(e(t))}catch{}}return null}function Ym(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vc(t);case 8:return t===yu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Is(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function df(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Xm(e){var t=df(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){r=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Pi(e){e._valueTracker||(e._valueTracker=Xm(e))}function hf(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=df(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function gl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function gc(e,t){var n=t.checked;return Fe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function yd(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Is(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ff(e,t){t=t.checked,t!=null&&xu(e,"checked",t,!1)}function xc(e,t){ff(e,t);var n=Is(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?yc(e,t.type,n):t.hasOwnProperty("defaultValue")&&yc(e,t.type,Is(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function jd(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function yc(e,t,n){(t!=="number"||gl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ta=Array.isArray;function Dr(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Is(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function jc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(z(91));return Fe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Nd(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(z(92));if(Ta(n)){if(1<n.length)throw Error(z(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Is(n)}}function pf(e,t){var n=Is(t.value),r=Is(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function wd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function mf(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?mf(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ii,vf=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ii=Ii||document.createElement("div"),Ii.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ii.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ha(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Pa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Jm=["Webkit","ms","Moz","O"];Object.keys(Pa).forEach(function(e){Jm.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Pa[t]=Pa[e]})});function gf(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Pa.hasOwnProperty(e)&&Pa[e]?(""+t).trim():t+"px"}function xf(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=gf(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var Zm=Fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wc(e,t){if(t){if(Zm[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(z(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(z(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(z(61))}if(t.style!=null&&typeof t.style!="object")throw Error(z(62))}}function _c(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sc=null;function wu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var kc=null,Br=null,zr=null;function _d(e){if(e=ui(e)){if(typeof kc!="function")throw Error(z(280));var t=e.stateNode;t&&(t=Ql(t),kc(e.stateNode,e.type,t))}}function yf(e){Br?zr?zr.push(e):zr=[e]:Br=e}function jf(){if(Br){var e=Br,t=zr;if(zr=Br=null,_d(e),t)for(e=0;e<t.length;e++)_d(t[e])}}function Nf(e,t){return e(t)}function wf(){}var Bo=!1;function _f(e,t,n){if(Bo)return e(t,n);Bo=!0;try{return Nf(e,t,n)}finally{Bo=!1,(Br!==null||zr!==null)&&(wf(),jf())}}function qa(e,t){var n=e.stateNode;if(n===null)return null;var r=Ql(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(z(231,t,typeof n));return n}var bc=!1;if(Xn)try{var Na={};Object.defineProperty(Na,"passive",{get:function(){bc=!0}}),window.addEventListener("test",Na,Na),window.removeEventListener("test",Na,Na)}catch{bc=!1}function ev(e,t,n,r,a,i,l,c,u){var m=Array.prototype.slice.call(arguments,3);try{t.apply(n,m)}catch(S){this.onError(S)}}var Ia=!1,xl=null,yl=!1,Cc=null,tv={onError:function(e){Ia=!0,xl=e}};function nv(e,t,n,r,a,i,l,c,u){Ia=!1,xl=null,ev.apply(tv,arguments)}function sv(e,t,n,r,a,i,l,c,u){if(nv.apply(this,arguments),Ia){if(Ia){var m=xl;Ia=!1,xl=null}else throw Error(z(198));yl||(yl=!0,Cc=m)}}function pr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Sf(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Sd(e){if(pr(e)!==e)throw Error(z(188))}function rv(e){var t=e.alternate;if(!t){if(t=pr(e),t===null)throw Error(z(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return Sd(a),e;if(i===r)return Sd(a),t;i=i.sibling}throw Error(z(188))}if(n.return!==r.return)n=a,r=i;else{for(var l=!1,c=a.child;c;){if(c===n){l=!0,n=a,r=i;break}if(c===r){l=!0,r=a,n=i;break}c=c.sibling}if(!l){for(c=i.child;c;){if(c===n){l=!0,n=i,r=a;break}if(c===r){l=!0,r=i,n=a;break}c=c.sibling}if(!l)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?e:t}function kf(e){return e=rv(e),e!==null?bf(e):null}function bf(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=bf(e);if(t!==null)return t;e=e.sibling}return null}var Cf=Ft.unstable_scheduleCallback,kd=Ft.unstable_cancelCallback,av=Ft.unstable_shouldYield,iv=Ft.unstable_requestPaint,qe=Ft.unstable_now,lv=Ft.unstable_getCurrentPriorityLevel,_u=Ft.unstable_ImmediatePriority,Ef=Ft.unstable_UserBlockingPriority,jl=Ft.unstable_NormalPriority,ov=Ft.unstable_LowPriority,Af=Ft.unstable_IdlePriority,Wl=null,Pn=null;function cv(e){if(Pn&&typeof Pn.onCommitFiberRoot=="function")try{Pn.onCommitFiberRoot(Wl,e,void 0,(e.current.flags&128)===128)}catch{}}var jn=Math.clz32?Math.clz32:hv,uv=Math.log,dv=Math.LN2;function hv(e){return e>>>=0,e===0?32:31-(uv(e)/dv|0)|0}var Mi=64,Di=4194304;function La(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Nl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,l=n&268435455;if(l!==0){var c=l&~a;c!==0?r=La(c):(i&=l,i!==0&&(r=La(i)))}else l=n&~a,l!==0?r=La(l):i!==0&&(r=La(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-jn(t),a=1<<n,r|=e[n],t&=~a;return r}function fv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pv(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-jn(i),c=1<<l,u=a[l];u===-1?(!(c&n)||c&r)&&(a[l]=fv(c,t)):u<=t&&(e.expiredLanes|=c),i&=~c}}function Ec(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Tf(){var e=Mi;return Mi<<=1,!(Mi&4194240)&&(Mi=64),e}function zo(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function oi(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-jn(t),e[t]=n}function mv(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-jn(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}function Su(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-jn(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var Le=0;function Lf(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Rf,ku,Of,Pf,If,Ac=!1,Bi=[],bs=null,Cs=null,Es=null,Ga=new Map,Qa=new Map,Ns=[],vv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bd(e,t){switch(e){case"focusin":case"focusout":bs=null;break;case"dragenter":case"dragleave":Cs=null;break;case"mouseover":case"mouseout":Es=null;break;case"pointerover":case"pointerout":Ga.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qa.delete(t.pointerId)}}function wa(e,t,n,r,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},t!==null&&(t=ui(t),t!==null&&ku(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function gv(e,t,n,r,a){switch(t){case"focusin":return bs=wa(bs,e,t,n,r,a),!0;case"dragenter":return Cs=wa(Cs,e,t,n,r,a),!0;case"mouseover":return Es=wa(Es,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Ga.set(i,wa(Ga.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Qa.set(i,wa(Qa.get(i)||null,e,t,n,r,a)),!0}return!1}function Mf(e){var t=sr(e.target);if(t!==null){var n=pr(t);if(n!==null){if(t=n.tag,t===13){if(t=Sf(n),t!==null){e.blockedOn=t,If(e.priority,function(){Of(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function sl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Tc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Sc=r,n.target.dispatchEvent(r),Sc=null}else return t=ui(n),t!==null&&ku(t),e.blockedOn=n,!1;t.shift()}return!0}function Cd(e,t,n){sl(e)&&n.delete(t)}function xv(){Ac=!1,bs!==null&&sl(bs)&&(bs=null),Cs!==null&&sl(Cs)&&(Cs=null),Es!==null&&sl(Es)&&(Es=null),Ga.forEach(Cd),Qa.forEach(Cd)}function _a(e,t){e.blockedOn===t&&(e.blockedOn=null,Ac||(Ac=!0,Ft.unstable_scheduleCallback(Ft.unstable_NormalPriority,xv)))}function Ka(e){function t(a){return _a(a,e)}if(0<Bi.length){_a(Bi[0],e);for(var n=1;n<Bi.length;n++){var r=Bi[n];r.blockedOn===e&&(r.blockedOn=null)}}for(bs!==null&&_a(bs,e),Cs!==null&&_a(Cs,e),Es!==null&&_a(Es,e),Ga.forEach(t),Qa.forEach(t),n=0;n<Ns.length;n++)r=Ns[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Ns.length&&(n=Ns[0],n.blockedOn===null);)Mf(n),n.blockedOn===null&&Ns.shift()}var $r=ts.ReactCurrentBatchConfig,wl=!0;function yv(e,t,n,r){var a=Le,i=$r.transition;$r.transition=null;try{Le=1,bu(e,t,n,r)}finally{Le=a,$r.transition=i}}function jv(e,t,n,r){var a=Le,i=$r.transition;$r.transition=null;try{Le=4,bu(e,t,n,r)}finally{Le=a,$r.transition=i}}function bu(e,t,n,r){if(wl){var a=Tc(e,t,n,r);if(a===null)Ko(e,t,r,_l,n),bd(e,r);else if(gv(a,e,t,n,r))r.stopPropagation();else if(bd(e,r),t&4&&-1<vv.indexOf(e)){for(;a!==null;){var i=ui(a);if(i!==null&&Rf(i),i=Tc(e,t,n,r),i===null&&Ko(e,t,r,_l,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else Ko(e,t,r,null,n)}}var _l=null;function Tc(e,t,n,r){if(_l=null,e=wu(r),e=sr(e),e!==null)if(t=pr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Sf(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return _l=e,null}function Df(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lv()){case _u:return 1;case Ef:return 4;case jl:case ov:return 16;case Af:return 536870912;default:return 16}default:return 16}}var _s=null,Cu=null,rl=null;function Bf(){if(rl)return rl;var e,t=Cu,n=t.length,r,a="value"in _s?_s.value:_s.textContent,i=a.length;for(e=0;e<n&&t[e]===a[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===a[i-r];r++);return rl=a.slice(e,1<r?1-r:void 0)}function al(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function zi(){return!0}function Ed(){return!1}function Ht(e){function t(n,r,a,i,l){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?zi:Ed,this.isPropagationStopped=Ed,this}return Fe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zi)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zi)},persist:function(){},isPersistent:zi}),t}var Xr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eu=Ht(Xr),ci=Fe({},Xr,{view:0,detail:0}),Nv=Ht(ci),$o,Uo,Sa,Hl=Fe({},ci,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Au,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Sa&&(Sa&&e.type==="mousemove"?($o=e.screenX-Sa.screenX,Uo=e.screenY-Sa.screenY):Uo=$o=0,Sa=e),$o)},movementY:function(e){return"movementY"in e?e.movementY:Uo}}),Ad=Ht(Hl),wv=Fe({},Hl,{dataTransfer:0}),_v=Ht(wv),Sv=Fe({},ci,{relatedTarget:0}),Vo=Ht(Sv),kv=Fe({},Xr,{animationName:0,elapsedTime:0,pseudoElement:0}),bv=Ht(kv),Cv=Fe({},Xr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ev=Ht(Cv),Av=Fe({},Xr,{data:0}),Td=Ht(Av),Tv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ov(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Rv[e])?!!t[e]:!1}function Au(){return Ov}var Pv=Fe({},ci,{key:function(e){if(e.key){var t=Tv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=al(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Lv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Au,charCode:function(e){return e.type==="keypress"?al(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?al(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Iv=Ht(Pv),Mv=Fe({},Hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ld=Ht(Mv),Dv=Fe({},ci,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Au}),Bv=Ht(Dv),zv=Fe({},Xr,{propertyName:0,elapsedTime:0,pseudoElement:0}),$v=Ht(zv),Uv=Fe({},Hl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Vv=Ht(Uv),Fv=[9,13,27,32],Tu=Xn&&"CompositionEvent"in window,Ma=null;Xn&&"documentMode"in document&&(Ma=document.documentMode);var Wv=Xn&&"TextEvent"in window&&!Ma,zf=Xn&&(!Tu||Ma&&8<Ma&&11>=Ma),Rd=" ",Od=!1;function $f(e,t){switch(e){case"keyup":return Fv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Cr=!1;function Hv(e,t){switch(e){case"compositionend":return Uf(t);case"keypress":return t.which!==32?null:(Od=!0,Rd);case"textInput":return e=t.data,e===Rd&&Od?null:e;default:return null}}function qv(e,t){if(Cr)return e==="compositionend"||!Tu&&$f(e,t)?(e=Bf(),rl=Cu=_s=null,Cr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zf&&t.locale!=="ko"?null:t.data;default:return null}}var Gv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Gv[e.type]:t==="textarea"}function Vf(e,t,n,r){yf(r),t=Sl(t,"onChange"),0<t.length&&(n=new Eu("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Da=null,Ya=null;function Qv(e){Zf(e,0)}function ql(e){var t=Tr(e);if(hf(t))return e}function Kv(e,t){if(e==="change")return t}var Ff=!1;if(Xn){var Fo;if(Xn){var Wo="oninput"in document;if(!Wo){var Id=document.createElement("div");Id.setAttribute("oninput","return;"),Wo=typeof Id.oninput=="function"}Fo=Wo}else Fo=!1;Ff=Fo&&(!document.documentMode||9<document.documentMode)}function Md(){Da&&(Da.detachEvent("onpropertychange",Wf),Ya=Da=null)}function Wf(e){if(e.propertyName==="value"&&ql(Ya)){var t=[];Vf(t,Ya,e,wu(e)),_f(Qv,t)}}function Yv(e,t,n){e==="focusin"?(Md(),Da=t,Ya=n,Da.attachEvent("onpropertychange",Wf)):e==="focusout"&&Md()}function Xv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ql(Ya)}function Jv(e,t){if(e==="click")return ql(t)}function Zv(e,t){if(e==="input"||e==="change")return ql(t)}function eg(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var wn=typeof Object.is=="function"?Object.is:eg;function Xa(e,t){if(wn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!hc.call(t,a)||!wn(e[a],t[a]))return!1}return!0}function Dd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Bd(e,t){var n=Dd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Dd(n)}}function Hf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Hf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function qf(){for(var e=window,t=gl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=gl(e.document)}return t}function Lu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function tg(e){var t=qf(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Hf(n.ownerDocument.documentElement,n)){if(r!==null&&Lu(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=Bd(n,i);var l=Bd(n,r);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ng=Xn&&"documentMode"in document&&11>=document.documentMode,Er=null,Lc=null,Ba=null,Rc=!1;function zd(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Rc||Er==null||Er!==gl(r)||(r=Er,"selectionStart"in r&&Lu(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ba&&Xa(Ba,r)||(Ba=r,r=Sl(Lc,"onSelect"),0<r.length&&(t=new Eu("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Er)))}function $i(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ar={animationend:$i("Animation","AnimationEnd"),animationiteration:$i("Animation","AnimationIteration"),animationstart:$i("Animation","AnimationStart"),transitionend:$i("Transition","TransitionEnd")},Ho={},Gf={};Xn&&(Gf=document.createElement("div").style,"AnimationEvent"in window||(delete Ar.animationend.animation,delete Ar.animationiteration.animation,delete Ar.animationstart.animation),"TransitionEvent"in window||delete Ar.transitionend.transition);function Gl(e){if(Ho[e])return Ho[e];if(!Ar[e])return e;var t=Ar[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Gf)return Ho[e]=t[n];return e}var Qf=Gl("animationend"),Kf=Gl("animationiteration"),Yf=Gl("animationstart"),Xf=Gl("transitionend"),Jf=new Map,$d="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ds(e,t){Jf.set(e,t),fr(t,[e])}for(var qo=0;qo<$d.length;qo++){var Go=$d[qo],sg=Go.toLowerCase(),rg=Go[0].toUpperCase()+Go.slice(1);Ds(sg,"on"+rg)}Ds(Qf,"onAnimationEnd");Ds(Kf,"onAnimationIteration");Ds(Yf,"onAnimationStart");Ds("dblclick","onDoubleClick");Ds("focusin","onFocus");Ds("focusout","onBlur");Ds(Xf,"onTransitionEnd");Fr("onMouseEnter",["mouseout","mouseover"]);Fr("onMouseLeave",["mouseout","mouseover"]);Fr("onPointerEnter",["pointerout","pointerover"]);Fr("onPointerLeave",["pointerout","pointerover"]);fr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fr("onBeforeInput",["compositionend","keypress","textInput","paste"]);fr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ra="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ag=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ra));function Ud(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,sv(r,t,void 0,e),e.currentTarget=null}function Zf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var l=r.length-1;0<=l;l--){var c=r[l],u=c.instance,m=c.currentTarget;if(c=c.listener,u!==i&&a.isPropagationStopped())break e;Ud(a,c,m),i=u}else for(l=0;l<r.length;l++){if(c=r[l],u=c.instance,m=c.currentTarget,c=c.listener,u!==i&&a.isPropagationStopped())break e;Ud(a,c,m),i=u}}}if(yl)throw e=Cc,yl=!1,Cc=null,e}function Be(e,t){var n=t[Dc];n===void 0&&(n=t[Dc]=new Set);var r=e+"__bubble";n.has(r)||(ep(t,e,2,!1),n.add(r))}function Qo(e,t,n){var r=0;t&&(r|=4),ep(n,e,r,t)}var Ui="_reactListening"+Math.random().toString(36).slice(2);function Ja(e){if(!e[Ui]){e[Ui]=!0,lf.forEach(function(n){n!=="selectionchange"&&(ag.has(n)||Qo(n,!1,e),Qo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ui]||(t[Ui]=!0,Qo("selectionchange",!1,t))}}function ep(e,t,n,r){switch(Df(t)){case 1:var a=yv;break;case 4:a=jv;break;default:a=bu}n=a.bind(null,t,n,e),a=void 0,!bc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Ko(e,t,n,r,a){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var c=r.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(l===4)for(l=r.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;l=l.return}for(;c!==null;){if(l=sr(c),l===null)return;if(u=l.tag,u===5||u===6){r=i=l;continue e}c=c.parentNode}}r=r.return}_f(function(){var m=i,S=wu(n),g=[];e:{var y=Jf.get(e);if(y!==void 0){var E=Eu,O=e;switch(e){case"keypress":if(al(n)===0)break e;case"keydown":case"keyup":E=Iv;break;case"focusin":O="focus",E=Vo;break;case"focusout":O="blur",E=Vo;break;case"beforeblur":case"afterblur":E=Vo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=Ad;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=_v;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=Bv;break;case Qf:case Kf:case Yf:E=bv;break;case Xf:E=$v;break;case"scroll":E=Nv;break;case"wheel":E=Vv;break;case"copy":case"cut":case"paste":E=Ev;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=Ld}var P=(t&4)!==0,b=!P&&e==="scroll",f=P?y!==null?y+"Capture":null:y;P=[];for(var p=m,v;p!==null;){v=p;var j=v.stateNode;if(v.tag===5&&j!==null&&(v=j,f!==null&&(j=qa(p,f),j!=null&&P.push(Za(p,j,v)))),b)break;p=p.return}0<P.length&&(y=new E(y,O,null,n,S),g.push({event:y,listeners:P}))}}if(!(t&7)){e:{if(y=e==="mouseover"||e==="pointerover",E=e==="mouseout"||e==="pointerout",y&&n!==Sc&&(O=n.relatedTarget||n.fromElement)&&(sr(O)||O[Jn]))break e;if((E||y)&&(y=S.window===S?S:(y=S.ownerDocument)?y.defaultView||y.parentWindow:window,E?(O=n.relatedTarget||n.toElement,E=m,O=O?sr(O):null,O!==null&&(b=pr(O),O!==b||O.tag!==5&&O.tag!==6)&&(O=null)):(E=null,O=m),E!==O)){if(P=Ad,j="onMouseLeave",f="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(P=Ld,j="onPointerLeave",f="onPointerEnter",p="pointer"),b=E==null?y:Tr(E),v=O==null?y:Tr(O),y=new P(j,p+"leave",E,n,S),y.target=b,y.relatedTarget=v,j=null,sr(S)===m&&(P=new P(f,p+"enter",O,n,S),P.target=v,P.relatedTarget=b,j=P),b=j,E&&O)t:{for(P=E,f=O,p=0,v=P;v;v=wr(v))p++;for(v=0,j=f;j;j=wr(j))v++;for(;0<p-v;)P=wr(P),p--;for(;0<v-p;)f=wr(f),v--;for(;p--;){if(P===f||f!==null&&P===f.alternate)break t;P=wr(P),f=wr(f)}P=null}else P=null;E!==null&&Vd(g,y,E,P,!1),O!==null&&b!==null&&Vd(g,b,O,P,!0)}}e:{if(y=m?Tr(m):window,E=y.nodeName&&y.nodeName.toLowerCase(),E==="select"||E==="input"&&y.type==="file")var R=Kv;else if(Pd(y))if(Ff)R=Zv;else{R=Xv;var $=Yv}else(E=y.nodeName)&&E.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(R=Jv);if(R&&(R=R(e,m))){Vf(g,R,n,S);break e}$&&$(e,y,m),e==="focusout"&&($=y._wrapperState)&&$.controlled&&y.type==="number"&&yc(y,"number",y.value)}switch($=m?Tr(m):window,e){case"focusin":(Pd($)||$.contentEditable==="true")&&(Er=$,Lc=m,Ba=null);break;case"focusout":Ba=Lc=Er=null;break;case"mousedown":Rc=!0;break;case"contextmenu":case"mouseup":case"dragend":Rc=!1,zd(g,n,S);break;case"selectionchange":if(ng)break;case"keydown":case"keyup":zd(g,n,S)}var A;if(Tu)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Cr?$f(e,n)&&(N="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(zf&&n.locale!=="ko"&&(Cr||N!=="onCompositionStart"?N==="onCompositionEnd"&&Cr&&(A=Bf()):(_s=S,Cu="value"in _s?_s.value:_s.textContent,Cr=!0)),$=Sl(m,N),0<$.length&&(N=new Td(N,e,null,n,S),g.push({event:N,listeners:$}),A?N.data=A:(A=Uf(n),A!==null&&(N.data=A)))),(A=Wv?Hv(e,n):qv(e,n))&&(m=Sl(m,"onBeforeInput"),0<m.length&&(S=new Td("onBeforeInput","beforeinput",null,n,S),g.push({event:S,listeners:m}),S.data=A))}Zf(g,t)})}function Za(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Sl(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=qa(e,n),i!=null&&r.unshift(Za(e,i,a)),i=qa(e,t),i!=null&&r.push(Za(e,i,a))),e=e.return}return r}function wr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Vd(e,t,n,r,a){for(var i=t._reactName,l=[];n!==null&&n!==r;){var c=n,u=c.alternate,m=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&m!==null&&(c=m,a?(u=qa(n,i),u!=null&&l.unshift(Za(n,u,c))):a||(u=qa(n,i),u!=null&&l.push(Za(n,u,c)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var ig=/\r\n?/g,lg=/\u0000|\uFFFD/g;function Fd(e){return(typeof e=="string"?e:""+e).replace(ig,`
`).replace(lg,"")}function Vi(e,t,n){if(t=Fd(t),Fd(e)!==t&&n)throw Error(z(425))}function kl(){}var Oc=null,Pc=null;function Ic(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Mc=typeof setTimeout=="function"?setTimeout:void 0,og=typeof clearTimeout=="function"?clearTimeout:void 0,Wd=typeof Promise=="function"?Promise:void 0,cg=typeof queueMicrotask=="function"?queueMicrotask:typeof Wd<"u"?function(e){return Wd.resolve(null).then(e).catch(ug)}:Mc;function ug(e){setTimeout(function(){throw e})}function Yo(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),Ka(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Ka(t)}function As(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Hd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Jr=Math.random().toString(36).slice(2),On="__reactFiber$"+Jr,ei="__reactProps$"+Jr,Jn="__reactContainer$"+Jr,Dc="__reactEvents$"+Jr,dg="__reactListeners$"+Jr,hg="__reactHandles$"+Jr;function sr(e){var t=e[On];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Jn]||n[On]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Hd(e);e!==null;){if(n=e[On])return n;e=Hd(e)}return t}e=n,n=e.parentNode}return null}function ui(e){return e=e[On]||e[Jn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Tr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(z(33))}function Ql(e){return e[ei]||null}var Bc=[],Lr=-1;function Bs(e){return{current:e}}function ze(e){0>Lr||(e.current=Bc[Lr],Bc[Lr]=null,Lr--)}function Ie(e,t){Lr++,Bc[Lr]=e.current,e.current=t}var Ms={},Nt=Bs(Ms),Pt=Bs(!1),or=Ms;function Wr(e,t){var n=e.type.contextTypes;if(!n)return Ms;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function It(e){return e=e.childContextTypes,e!=null}function bl(){ze(Pt),ze(Nt)}function qd(e,t,n){if(Nt.current!==Ms)throw Error(z(168));Ie(Nt,t),Ie(Pt,n)}function tp(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(z(108,Ym(e)||"Unknown",a));return Fe({},n,r)}function Cl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ms,or=Nt.current,Ie(Nt,e),Ie(Pt,Pt.current),!0}function Gd(e,t,n){var r=e.stateNode;if(!r)throw Error(z(169));n?(e=tp(e,t,or),r.__reactInternalMemoizedMergedChildContext=e,ze(Pt),ze(Nt),Ie(Nt,e)):ze(Pt),Ie(Pt,n)}var qn=null,Kl=!1,Xo=!1;function np(e){qn===null?qn=[e]:qn.push(e)}function fg(e){Kl=!0,np(e)}function zs(){if(!Xo&&qn!==null){Xo=!0;var e=0,t=Le;try{var n=qn;for(Le=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}qn=null,Kl=!1}catch(a){throw qn!==null&&(qn=qn.slice(e+1)),Cf(_u,zs),a}finally{Le=t,Xo=!1}}return null}var Rr=[],Or=0,El=null,Al=0,en=[],tn=0,cr=null,Qn=1,Kn="";function tr(e,t){Rr[Or++]=Al,Rr[Or++]=El,El=e,Al=t}function sp(e,t,n){en[tn++]=Qn,en[tn++]=Kn,en[tn++]=cr,cr=e;var r=Qn;e=Kn;var a=32-jn(r)-1;r&=~(1<<a),n+=1;var i=32-jn(t)+a;if(30<i){var l=a-a%5;i=(r&(1<<l)-1).toString(32),r>>=l,a-=l,Qn=1<<32-jn(t)+a|n<<a|r,Kn=i+e}else Qn=1<<i|n<<a|r,Kn=e}function Ru(e){e.return!==null&&(tr(e,1),sp(e,1,0))}function Ou(e){for(;e===El;)El=Rr[--Or],Rr[Or]=null,Al=Rr[--Or],Rr[Or]=null;for(;e===cr;)cr=en[--tn],en[tn]=null,Kn=en[--tn],en[tn]=null,Qn=en[--tn],en[tn]=null}var Vt=null,Ut=null,$e=!1,yn=null;function rp(e,t){var n=sn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Qd(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Vt=e,Ut=As(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Vt=e,Ut=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=cr!==null?{id:Qn,overflow:Kn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=sn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Vt=e,Ut=null,!0):!1;default:return!1}}function zc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function $c(e){if($e){var t=Ut;if(t){var n=t;if(!Qd(e,t)){if(zc(e))throw Error(z(418));t=As(n.nextSibling);var r=Vt;t&&Qd(e,t)?rp(r,n):(e.flags=e.flags&-4097|2,$e=!1,Vt=e)}}else{if(zc(e))throw Error(z(418));e.flags=e.flags&-4097|2,$e=!1,Vt=e}}}function Kd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Vt=e}function Fi(e){if(e!==Vt)return!1;if(!$e)return Kd(e),$e=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ic(e.type,e.memoizedProps)),t&&(t=Ut)){if(zc(e))throw ap(),Error(z(418));for(;t;)rp(e,t),t=As(t.nextSibling)}if(Kd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(z(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ut=As(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ut=null}}else Ut=Vt?As(e.stateNode.nextSibling):null;return!0}function ap(){for(var e=Ut;e;)e=As(e.nextSibling)}function Hr(){Ut=Vt=null,$e=!1}function Pu(e){yn===null?yn=[e]:yn.push(e)}var pg=ts.ReactCurrentBatchConfig;function ka(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,e));var a=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var c=a.refs;l===null?delete c[i]:c[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,e))}return e}function Wi(e,t){throw e=Object.prototype.toString.call(t),Error(z(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yd(e){var t=e._init;return t(e._payload)}function ip(e){function t(f,p){if(e){var v=f.deletions;v===null?(f.deletions=[p],f.flags|=16):v.push(p)}}function n(f,p){if(!e)return null;for(;p!==null;)t(f,p),p=p.sibling;return null}function r(f,p){for(f=new Map;p!==null;)p.key!==null?f.set(p.key,p):f.set(p.index,p),p=p.sibling;return f}function a(f,p){return f=Os(f,p),f.index=0,f.sibling=null,f}function i(f,p,v){return f.index=v,e?(v=f.alternate,v!==null?(v=v.index,v<p?(f.flags|=2,p):v):(f.flags|=2,p)):(f.flags|=1048576,p)}function l(f){return e&&f.alternate===null&&(f.flags|=2),f}function c(f,p,v,j){return p===null||p.tag!==6?(p=rc(v,f.mode,j),p.return=f,p):(p=a(p,v),p.return=f,p)}function u(f,p,v,j){var R=v.type;return R===br?S(f,p,v.props.children,j,v.key):p!==null&&(p.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===ys&&Yd(R)===p.type)?(j=a(p,v.props),j.ref=ka(f,p,v),j.return=f,j):(j=hl(v.type,v.key,v.props,null,f.mode,j),j.ref=ka(f,p,v),j.return=f,j)}function m(f,p,v,j){return p===null||p.tag!==4||p.stateNode.containerInfo!==v.containerInfo||p.stateNode.implementation!==v.implementation?(p=ac(v,f.mode,j),p.return=f,p):(p=a(p,v.children||[]),p.return=f,p)}function S(f,p,v,j,R){return p===null||p.tag!==7?(p=lr(v,f.mode,j,R),p.return=f,p):(p=a(p,v),p.return=f,p)}function g(f,p,v){if(typeof p=="string"&&p!==""||typeof p=="number")return p=rc(""+p,f.mode,v),p.return=f,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Oi:return v=hl(p.type,p.key,p.props,null,f.mode,v),v.ref=ka(f,null,p),v.return=f,v;case kr:return p=ac(p,f.mode,v),p.return=f,p;case ys:var j=p._init;return g(f,j(p._payload),v)}if(Ta(p)||ja(p))return p=lr(p,f.mode,v,null),p.return=f,p;Wi(f,p)}return null}function y(f,p,v,j){var R=p!==null?p.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return R!==null?null:c(f,p,""+v,j);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Oi:return v.key===R?u(f,p,v,j):null;case kr:return v.key===R?m(f,p,v,j):null;case ys:return R=v._init,y(f,p,R(v._payload),j)}if(Ta(v)||ja(v))return R!==null?null:S(f,p,v,j,null);Wi(f,v)}return null}function E(f,p,v,j,R){if(typeof j=="string"&&j!==""||typeof j=="number")return f=f.get(v)||null,c(p,f,""+j,R);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Oi:return f=f.get(j.key===null?v:j.key)||null,u(p,f,j,R);case kr:return f=f.get(j.key===null?v:j.key)||null,m(p,f,j,R);case ys:var $=j._init;return E(f,p,v,$(j._payload),R)}if(Ta(j)||ja(j))return f=f.get(v)||null,S(p,f,j,R,null);Wi(p,j)}return null}function O(f,p,v,j){for(var R=null,$=null,A=p,N=p=0,V=null;A!==null&&N<v.length;N++){A.index>N?(V=A,A=null):V=A.sibling;var I=y(f,A,v[N],j);if(I===null){A===null&&(A=V);break}e&&A&&I.alternate===null&&t(f,A),p=i(I,p,N),$===null?R=I:$.sibling=I,$=I,A=V}if(N===v.length)return n(f,A),$e&&tr(f,N),R;if(A===null){for(;N<v.length;N++)A=g(f,v[N],j),A!==null&&(p=i(A,p,N),$===null?R=A:$.sibling=A,$=A);return $e&&tr(f,N),R}for(A=r(f,A);N<v.length;N++)V=E(A,f,N,v[N],j),V!==null&&(e&&V.alternate!==null&&A.delete(V.key===null?N:V.key),p=i(V,p,N),$===null?R=V:$.sibling=V,$=V);return e&&A.forEach(function(Y){return t(f,Y)}),$e&&tr(f,N),R}function P(f,p,v,j){var R=ja(v);if(typeof R!="function")throw Error(z(150));if(v=R.call(v),v==null)throw Error(z(151));for(var $=R=null,A=p,N=p=0,V=null,I=v.next();A!==null&&!I.done;N++,I=v.next()){A.index>N?(V=A,A=null):V=A.sibling;var Y=y(f,A,I.value,j);if(Y===null){A===null&&(A=V);break}e&&A&&Y.alternate===null&&t(f,A),p=i(Y,p,N),$===null?R=Y:$.sibling=Y,$=Y,A=V}if(I.done)return n(f,A),$e&&tr(f,N),R;if(A===null){for(;!I.done;N++,I=v.next())I=g(f,I.value,j),I!==null&&(p=i(I,p,N),$===null?R=I:$.sibling=I,$=I);return $e&&tr(f,N),R}for(A=r(f,A);!I.done;N++,I=v.next())I=E(A,f,N,I.value,j),I!==null&&(e&&I.alternate!==null&&A.delete(I.key===null?N:I.key),p=i(I,p,N),$===null?R=I:$.sibling=I,$=I);return e&&A.forEach(function(he){return t(f,he)}),$e&&tr(f,N),R}function b(f,p,v,j){if(typeof v=="object"&&v!==null&&v.type===br&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Oi:e:{for(var R=v.key,$=p;$!==null;){if($.key===R){if(R=v.type,R===br){if($.tag===7){n(f,$.sibling),p=a($,v.props.children),p.return=f,f=p;break e}}else if($.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===ys&&Yd(R)===$.type){n(f,$.sibling),p=a($,v.props),p.ref=ka(f,$,v),p.return=f,f=p;break e}n(f,$);break}else t(f,$);$=$.sibling}v.type===br?(p=lr(v.props.children,f.mode,j,v.key),p.return=f,f=p):(j=hl(v.type,v.key,v.props,null,f.mode,j),j.ref=ka(f,p,v),j.return=f,f=j)}return l(f);case kr:e:{for($=v.key;p!==null;){if(p.key===$)if(p.tag===4&&p.stateNode.containerInfo===v.containerInfo&&p.stateNode.implementation===v.implementation){n(f,p.sibling),p=a(p,v.children||[]),p.return=f,f=p;break e}else{n(f,p);break}else t(f,p);p=p.sibling}p=ac(v,f.mode,j),p.return=f,f=p}return l(f);case ys:return $=v._init,b(f,p,$(v._payload),j)}if(Ta(v))return O(f,p,v,j);if(ja(v))return P(f,p,v,j);Wi(f,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,p!==null&&p.tag===6?(n(f,p.sibling),p=a(p,v),p.return=f,f=p):(n(f,p),p=rc(v,f.mode,j),p.return=f,f=p),l(f)):n(f,p)}return b}var qr=ip(!0),lp=ip(!1),Tl=Bs(null),Ll=null,Pr=null,Iu=null;function Mu(){Iu=Pr=Ll=null}function Du(e){var t=Tl.current;ze(Tl),e._currentValue=t}function Uc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ur(e,t){Ll=e,Iu=Pr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ot=!0),e.firstContext=null)}function an(e){var t=e._currentValue;if(Iu!==e)if(e={context:e,memoizedValue:t,next:null},Pr===null){if(Ll===null)throw Error(z(308));Pr=e,Ll.dependencies={lanes:0,firstContext:e}}else Pr=Pr.next=e;return t}var rr=null;function Bu(e){rr===null?rr=[e]:rr.push(e)}function op(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,Bu(t)):(n.next=a.next,a.next=n),t.interleaved=n,Zn(e,r)}function Zn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var js=!1;function zu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Yn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ts(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,_e&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Zn(e,n)}return a=r.interleaved,a===null?(t.next=t,Bu(r)):(t.next=a.next,a.next=t),r.interleaved=t,Zn(e,n)}function il(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Su(e,n)}}function Xd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=l:i=i.next=l,n=n.next}while(n!==null);i===null?a=i=t:i=i.next=t}else a=i=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Rl(e,t,n,r){var a=e.updateQueue;js=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var u=c,m=u.next;u.next=null,l===null?i=m:l.next=m,l=u;var S=e.alternate;S!==null&&(S=S.updateQueue,c=S.lastBaseUpdate,c!==l&&(c===null?S.firstBaseUpdate=m:c.next=m,S.lastBaseUpdate=u))}if(i!==null){var g=a.baseState;l=0,S=m=u=null,c=i;do{var y=c.lane,E=c.eventTime;if((r&y)===y){S!==null&&(S=S.next={eventTime:E,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var O=e,P=c;switch(y=t,E=n,P.tag){case 1:if(O=P.payload,typeof O=="function"){g=O.call(E,g,y);break e}g=O;break e;case 3:O.flags=O.flags&-65537|128;case 0:if(O=P.payload,y=typeof O=="function"?O.call(E,g,y):O,y==null)break e;g=Fe({},g,y);break e;case 2:js=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,y=a.effects,y===null?a.effects=[c]:y.push(c))}else E={eventTime:E,lane:y,tag:c.tag,payload:c.payload,callback:c.callback,next:null},S===null?(m=S=E,u=g):S=S.next=E,l|=y;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;y=c,c=y.next,y.next=null,a.lastBaseUpdate=y,a.shared.pending=null}}while(!0);if(S===null&&(u=g),a.baseState=u,a.firstBaseUpdate=m,a.lastBaseUpdate=S,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);dr|=l,e.lanes=l,e.memoizedState=g}}function Jd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(z(191,a));a.call(r)}}}var di={},In=Bs(di),ti=Bs(di),ni=Bs(di);function ar(e){if(e===di)throw Error(z(174));return e}function $u(e,t){switch(Ie(ni,t),Ie(ti,e),Ie(In,di),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Nc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Nc(t,e)}ze(In),Ie(In,t)}function Gr(){ze(In),ze(ti),ze(ni)}function up(e){ar(ni.current);var t=ar(In.current),n=Nc(t,e.type);t!==n&&(Ie(ti,e),Ie(In,n))}function Uu(e){ti.current===e&&(ze(In),ze(ti))}var Ue=Bs(0);function Ol(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Jo=[];function Vu(){for(var e=0;e<Jo.length;e++)Jo[e]._workInProgressVersionPrimary=null;Jo.length=0}var ll=ts.ReactCurrentDispatcher,Zo=ts.ReactCurrentBatchConfig,ur=0,Ve=null,st=null,ct=null,Pl=!1,za=!1,si=0,mg=0;function xt(){throw Error(z(321))}function Fu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!wn(e[n],t[n]))return!1;return!0}function Wu(e,t,n,r,a,i){if(ur=i,Ve=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ll.current=e===null||e.memoizedState===null?yg:jg,e=n(r,a),za){i=0;do{if(za=!1,si=0,25<=i)throw Error(z(301));i+=1,ct=st=null,t.updateQueue=null,ll.current=Ng,e=n(r,a)}while(za)}if(ll.current=Il,t=st!==null&&st.next!==null,ur=0,ct=st=Ve=null,Pl=!1,t)throw Error(z(300));return e}function Hu(){var e=si!==0;return si=0,e}function Rn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ct===null?Ve.memoizedState=ct=e:ct=ct.next=e,ct}function ln(){if(st===null){var e=Ve.alternate;e=e!==null?e.memoizedState:null}else e=st.next;var t=ct===null?Ve.memoizedState:ct.next;if(t!==null)ct=t,st=e;else{if(e===null)throw Error(z(310));st=e,e={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},ct===null?Ve.memoizedState=ct=e:ct=ct.next=e}return ct}function ri(e,t){return typeof t=="function"?t(e):t}function ec(e){var t=ln(),n=t.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=e;var r=st,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var c=l=null,u=null,m=i;do{var S=m.lane;if((ur&S)===S)u!==null&&(u=u.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:e(r,m.action);else{var g={lane:S,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};u===null?(c=u=g,l=r):u=u.next=g,Ve.lanes|=S,dr|=S}m=m.next}while(m!==null&&m!==i);u===null?l=r:u.next=c,wn(r,t.memoizedState)||(Ot=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do i=a.lane,Ve.lanes|=i,dr|=i,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function tc(e){var t=ln(),n=t.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(a!==null){n.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);wn(i,t.memoizedState)||(Ot=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function dp(){}function hp(e,t){var n=Ve,r=ln(),a=t(),i=!wn(r.memoizedState,a);if(i&&(r.memoizedState=a,Ot=!0),r=r.queue,qu(mp.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||ct!==null&&ct.memoizedState.tag&1){if(n.flags|=2048,ai(9,pp.bind(null,n,r,a,t),void 0,null),ut===null)throw Error(z(349));ur&30||fp(n,t,a)}return a}function fp(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function pp(e,t,n,r){t.value=n,t.getSnapshot=r,vp(t)&&gp(e)}function mp(e,t,n){return n(function(){vp(t)&&gp(e)})}function vp(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!wn(e,n)}catch{return!0}}function gp(e){var t=Zn(e,1);t!==null&&Nn(t,e,1,-1)}function Zd(e){var t=Rn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ri,lastRenderedState:e},t.queue=e,e=e.dispatch=xg.bind(null,Ve,e),[t.memoizedState,e]}function ai(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function xp(){return ln().memoizedState}function ol(e,t,n,r){var a=Rn();Ve.flags|=e,a.memoizedState=ai(1|t,n,void 0,r===void 0?null:r)}function Yl(e,t,n,r){var a=ln();r=r===void 0?null:r;var i=void 0;if(st!==null){var l=st.memoizedState;if(i=l.destroy,r!==null&&Fu(r,l.deps)){a.memoizedState=ai(t,n,i,r);return}}Ve.flags|=e,a.memoizedState=ai(1|t,n,i,r)}function eh(e,t){return ol(8390656,8,e,t)}function qu(e,t){return Yl(2048,8,e,t)}function yp(e,t){return Yl(4,2,e,t)}function jp(e,t){return Yl(4,4,e,t)}function Np(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function wp(e,t,n){return n=n!=null?n.concat([e]):null,Yl(4,4,Np.bind(null,t,e),n)}function Gu(){}function _p(e,t){var n=ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Fu(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Sp(e,t){var n=ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Fu(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function kp(e,t,n){return ur&21?(wn(n,t)||(n=Tf(),Ve.lanes|=n,dr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ot=!0),e.memoizedState=n)}function vg(e,t){var n=Le;Le=n!==0&&4>n?n:4,e(!0);var r=Zo.transition;Zo.transition={};try{e(!1),t()}finally{Le=n,Zo.transition=r}}function bp(){return ln().memoizedState}function gg(e,t,n){var r=Rs(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Cp(e))Ep(t,n);else if(n=op(e,t,n,r),n!==null){var a=Ct();Nn(n,e,r,a),Ap(n,t,r)}}function xg(e,t,n){var r=Rs(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Cp(e))Ep(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,c=i(l,n);if(a.hasEagerState=!0,a.eagerState=c,wn(c,l)){var u=t.interleaved;u===null?(a.next=a,Bu(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}n=op(e,t,a,r),n!==null&&(a=Ct(),Nn(n,e,r,a),Ap(n,t,r))}}function Cp(e){var t=e.alternate;return e===Ve||t!==null&&t===Ve}function Ep(e,t){za=Pl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ap(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Su(e,n)}}var Il={readContext:an,useCallback:xt,useContext:xt,useEffect:xt,useImperativeHandle:xt,useInsertionEffect:xt,useLayoutEffect:xt,useMemo:xt,useReducer:xt,useRef:xt,useState:xt,useDebugValue:xt,useDeferredValue:xt,useTransition:xt,useMutableSource:xt,useSyncExternalStore:xt,useId:xt,unstable_isNewReconciler:!1},yg={readContext:an,useCallback:function(e,t){return Rn().memoizedState=[e,t===void 0?null:t],e},useContext:an,useEffect:eh,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ol(4194308,4,Np.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ol(4194308,4,e,t)},useInsertionEffect:function(e,t){return ol(4,2,e,t)},useMemo:function(e,t){var n=Rn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Rn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=gg.bind(null,Ve,e),[r.memoizedState,e]},useRef:function(e){var t=Rn();return e={current:e},t.memoizedState=e},useState:Zd,useDebugValue:Gu,useDeferredValue:function(e){return Rn().memoizedState=e},useTransition:function(){var e=Zd(!1),t=e[0];return e=vg.bind(null,e[1]),Rn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ve,a=Rn();if($e){if(n===void 0)throw Error(z(407));n=n()}else{if(n=t(),ut===null)throw Error(z(349));ur&30||fp(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,eh(mp.bind(null,r,i,e),[e]),r.flags|=2048,ai(9,pp.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Rn(),t=ut.identifierPrefix;if($e){var n=Kn,r=Qn;n=(r&~(1<<32-jn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=si++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=mg++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},jg={readContext:an,useCallback:_p,useContext:an,useEffect:qu,useImperativeHandle:wp,useInsertionEffect:yp,useLayoutEffect:jp,useMemo:Sp,useReducer:ec,useRef:xp,useState:function(){return ec(ri)},useDebugValue:Gu,useDeferredValue:function(e){var t=ln();return kp(t,st.memoizedState,e)},useTransition:function(){var e=ec(ri)[0],t=ln().memoizedState;return[e,t]},useMutableSource:dp,useSyncExternalStore:hp,useId:bp,unstable_isNewReconciler:!1},Ng={readContext:an,useCallback:_p,useContext:an,useEffect:qu,useImperativeHandle:wp,useInsertionEffect:yp,useLayoutEffect:jp,useMemo:Sp,useReducer:tc,useRef:xp,useState:function(){return tc(ri)},useDebugValue:Gu,useDeferredValue:function(e){var t=ln();return st===null?t.memoizedState=e:kp(t,st.memoizedState,e)},useTransition:function(){var e=tc(ri)[0],t=ln().memoizedState;return[e,t]},useMutableSource:dp,useSyncExternalStore:hp,useId:bp,unstable_isNewReconciler:!1};function vn(e,t){if(e&&e.defaultProps){t=Fe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Vc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Fe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Xl={isMounted:function(e){return(e=e._reactInternals)?pr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ct(),a=Rs(e),i=Yn(r,a);i.payload=t,n!=null&&(i.callback=n),t=Ts(e,i,a),t!==null&&(Nn(t,e,a,r),il(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ct(),a=Rs(e),i=Yn(r,a);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Ts(e,i,a),t!==null&&(Nn(t,e,a,r),il(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ct(),r=Rs(e),a=Yn(n,r);a.tag=2,t!=null&&(a.callback=t),t=Ts(e,a,r),t!==null&&(Nn(t,e,r,n),il(t,e,r))}};function th(e,t,n,r,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,l):t.prototype&&t.prototype.isPureReactComponent?!Xa(n,r)||!Xa(a,i):!0}function Tp(e,t,n){var r=!1,a=Ms,i=t.contextType;return typeof i=="object"&&i!==null?i=an(i):(a=It(t)?or:Nt.current,r=t.contextTypes,i=(r=r!=null)?Wr(e,a):Ms),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Xl,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function nh(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Xl.enqueueReplaceState(t,t.state,null)}function Fc(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},zu(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=an(i):(i=It(t)?or:Nt.current,a.context=Wr(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Vc(e,t,i,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Xl.enqueueReplaceState(a,a.state,null),Rl(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Qr(e,t){try{var n="",r=t;do n+=Km(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function nc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Wc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var wg=typeof WeakMap=="function"?WeakMap:Map;function Lp(e,t,n){n=Yn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Dl||(Dl=!0,eu=r),Wc(e,t)},n}function Rp(e,t,n){n=Yn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){Wc(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Wc(e,t),typeof r!="function"&&(Ls===null?Ls=new Set([this]):Ls.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function sh(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new wg;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Mg.bind(null,e,t,n),t.then(e,e))}function rh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ah(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Yn(-1,1),t.tag=2,Ts(n,t,1))),n.lanes|=1),e)}var _g=ts.ReactCurrentOwner,Ot=!1;function bt(e,t,n,r){t.child=e===null?lp(t,null,n,r):qr(t,e.child,n,r)}function ih(e,t,n,r,a){n=n.render;var i=t.ref;return Ur(t,a),r=Wu(e,t,n,r,i,a),n=Hu(),e!==null&&!Ot?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,es(e,t,a)):($e&&n&&Ru(t),t.flags|=1,bt(e,t,r,a),t.child)}function lh(e,t,n,r,a){if(e===null){var i=n.type;return typeof i=="function"&&!td(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Op(e,t,i,r,a)):(e=hl(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(n=n.compare,n=n!==null?n:Xa,n(l,r)&&e.ref===t.ref)return es(e,t,a)}return t.flags|=1,e=Os(i,r),e.ref=t.ref,e.return=t,t.child=e}function Op(e,t,n,r,a){if(e!==null){var i=e.memoizedProps;if(Xa(i,r)&&e.ref===t.ref)if(Ot=!1,t.pendingProps=r=i,(e.lanes&a)!==0)e.flags&131072&&(Ot=!0);else return t.lanes=e.lanes,es(e,t,a)}return Hc(e,t,n,r,a)}function Pp(e,t,n){var r=t.pendingProps,a=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ie(Mr,$t),$t|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ie(Mr,$t),$t|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ie(Mr,$t),$t|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ie(Mr,$t),$t|=r;return bt(e,t,a,n),t.child}function Ip(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Hc(e,t,n,r,a){var i=It(n)?or:Nt.current;return i=Wr(t,i),Ur(t,a),n=Wu(e,t,n,r,i,a),r=Hu(),e!==null&&!Ot?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,es(e,t,a)):($e&&r&&Ru(t),t.flags|=1,bt(e,t,n,a),t.child)}function oh(e,t,n,r,a){if(It(n)){var i=!0;Cl(t)}else i=!1;if(Ur(t,a),t.stateNode===null)cl(e,t),Tp(t,n,r),Fc(t,n,r,a),r=!0;else if(e===null){var l=t.stateNode,c=t.memoizedProps;l.props=c;var u=l.context,m=n.contextType;typeof m=="object"&&m!==null?m=an(m):(m=It(n)?or:Nt.current,m=Wr(t,m));var S=n.getDerivedStateFromProps,g=typeof S=="function"||typeof l.getSnapshotBeforeUpdate=="function";g||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==r||u!==m)&&nh(t,l,r,m),js=!1;var y=t.memoizedState;l.state=y,Rl(t,r,l,a),u=t.memoizedState,c!==r||y!==u||Pt.current||js?(typeof S=="function"&&(Vc(t,n,S,r),u=t.memoizedState),(c=js||th(t,n,c,r,y,u,m))?(g||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),l.props=r,l.state=u,l.context=m,r=c):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,cp(e,t),c=t.memoizedProps,m=t.type===t.elementType?c:vn(t.type,c),l.props=m,g=t.pendingProps,y=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=an(u):(u=It(n)?or:Nt.current,u=Wr(t,u));var E=n.getDerivedStateFromProps;(S=typeof E=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==g||y!==u)&&nh(t,l,r,u),js=!1,y=t.memoizedState,l.state=y,Rl(t,r,l,a);var O=t.memoizedState;c!==g||y!==O||Pt.current||js?(typeof E=="function"&&(Vc(t,n,E,r),O=t.memoizedState),(m=js||th(t,n,m,r,y,O,u)||!1)?(S||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,O,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,O,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=O),l.props=r,l.state=O,l.context=u,r=m):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),r=!1)}return qc(e,t,n,r,i,a)}function qc(e,t,n,r,a,i){Ip(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return a&&Gd(t,n,!1),es(e,t,i);r=t.stateNode,_g.current=t;var c=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=qr(t,e.child,null,i),t.child=qr(t,null,c,i)):bt(e,t,c,i),t.memoizedState=r.state,a&&Gd(t,n,!0),t.child}function Mp(e){var t=e.stateNode;t.pendingContext?qd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&qd(e,t.context,!1),$u(e,t.containerInfo)}function ch(e,t,n,r,a){return Hr(),Pu(a),t.flags|=256,bt(e,t,n,r),t.child}var Gc={dehydrated:null,treeContext:null,retryLane:0};function Qc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Dp(e,t,n){var r=t.pendingProps,a=Ue.current,i=!1,l=(t.flags&128)!==0,c;if((c=l)||(c=e!==null&&e.memoizedState===null?!1:(a&2)!==0),c?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Ie(Ue,a&1),e===null)return $c(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,i?(r=t.mode,i=t.child,l={mode:"hidden",children:l},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=eo(l,r,0,null),e=lr(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Qc(n),t.memoizedState=Gc,e):Qu(t,l));if(a=e.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return Sg(e,t,l,r,c,a,n);if(i){i=r.fallback,l=t.mode,a=e.child,c=a.sibling;var u={mode:"hidden",children:r.children};return!(l&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Os(a,u),r.subtreeFlags=a.subtreeFlags&14680064),c!==null?i=Os(c,i):(i=lr(i,l,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,l=e.child.memoizedState,l=l===null?Qc(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=Gc,r}return i=e.child,e=i.sibling,r=Os(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Qu(e,t){return t=eo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Hi(e,t,n,r){return r!==null&&Pu(r),qr(t,e.child,null,n),e=Qu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Sg(e,t,n,r,a,i,l){if(n)return t.flags&256?(t.flags&=-257,r=nc(Error(z(422))),Hi(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=eo({mode:"visible",children:r.children},a,0,null),i=lr(i,a,l,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&qr(t,e.child,null,l),t.child.memoizedState=Qc(l),t.memoizedState=Gc,i);if(!(t.mode&1))return Hi(e,t,l,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(z(419)),r=nc(i,r,void 0),Hi(e,t,l,r)}if(c=(l&e.childLanes)!==0,Ot||c){if(r=ut,r!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Zn(e,a),Nn(r,e,a,-1))}return ed(),r=nc(Error(z(421))),Hi(e,t,l,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Dg.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Ut=As(a.nextSibling),Vt=t,$e=!0,yn=null,e!==null&&(en[tn++]=Qn,en[tn++]=Kn,en[tn++]=cr,Qn=e.id,Kn=e.overflow,cr=t),t=Qu(t,r.children),t.flags|=4096,t)}function uh(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Uc(e.return,t,n)}function sc(e,t,n,r,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Bp(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(bt(e,t,r.children,n),r=Ue.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&uh(e,n,t);else if(e.tag===19)uh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ie(Ue,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&Ol(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),sc(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Ol(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}sc(t,!0,n,null,i);break;case"together":sc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function cl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function es(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),dr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(z(153));if(t.child!==null){for(e=t.child,n=Os(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Os(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function kg(e,t,n){switch(t.tag){case 3:Mp(t),Hr();break;case 5:up(t);break;case 1:It(t.type)&&Cl(t);break;case 4:$u(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ie(Tl,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ie(Ue,Ue.current&1),t.flags|=128,null):n&t.child.childLanes?Dp(e,t,n):(Ie(Ue,Ue.current&1),e=es(e,t,n),e!==null?e.sibling:null);Ie(Ue,Ue.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Bp(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ie(Ue,Ue.current),r)break;return null;case 22:case 23:return t.lanes=0,Pp(e,t,n)}return es(e,t,n)}var zp,Kc,$p,Up;zp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Kc=function(){};$p=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,ar(In.current);var i=null;switch(n){case"input":a=gc(e,a),r=gc(e,r),i=[];break;case"select":a=Fe({},a,{value:void 0}),r=Fe({},r,{value:void 0}),i=[];break;case"textarea":a=jc(e,a),r=jc(e,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=kl)}wc(n,r);var l;n=null;for(m in a)if(!r.hasOwnProperty(m)&&a.hasOwnProperty(m)&&a[m]!=null)if(m==="style"){var c=a[m];for(l in c)c.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(Wa.hasOwnProperty(m)?i||(i=[]):(i=i||[]).push(m,null));for(m in r){var u=r[m];if(c=a!=null?a[m]:void 0,r.hasOwnProperty(m)&&u!==c&&(u!=null||c!=null))if(m==="style")if(c){for(l in c)!c.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&c[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(i||(i=[]),i.push(m,n)),n=u;else m==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(m,u)):m==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(m,""+u):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(Wa.hasOwnProperty(m)?(u!=null&&m==="onScroll"&&Be("scroll",e),i||c===u||(i=[])):(i=i||[]).push(m,u))}n&&(i=i||[]).push("style",n);var m=i;(t.updateQueue=m)&&(t.flags|=4)}};Up=function(e,t,n,r){n!==r&&(t.flags|=4)};function ba(e,t){if(!$e)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function yt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function bg(e,t,n){var r=t.pendingProps;switch(Ou(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(t),null;case 1:return It(t.type)&&bl(),yt(t),null;case 3:return r=t.stateNode,Gr(),ze(Pt),ze(Nt),Vu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Fi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,yn!==null&&(su(yn),yn=null))),Kc(e,t),yt(t),null;case 5:Uu(t);var a=ar(ni.current);if(n=t.type,e!==null&&t.stateNode!=null)$p(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(z(166));return yt(t),null}if(e=ar(In.current),Fi(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[On]=t,r[ei]=i,e=(t.mode&1)!==0,n){case"dialog":Be("cancel",r),Be("close",r);break;case"iframe":case"object":case"embed":Be("load",r);break;case"video":case"audio":for(a=0;a<Ra.length;a++)Be(Ra[a],r);break;case"source":Be("error",r);break;case"img":case"image":case"link":Be("error",r),Be("load",r);break;case"details":Be("toggle",r);break;case"input":yd(r,i),Be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Be("invalid",r);break;case"textarea":Nd(r,i),Be("invalid",r)}wc(n,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&Vi(r.textContent,c,e),a=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&Vi(r.textContent,c,e),a=["children",""+c]):Wa.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&Be("scroll",r)}switch(n){case"input":Pi(r),jd(r,i,!0);break;case"textarea":Pi(r),wd(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=kl)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=mf(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[On]=t,e[ei]=r,zp(e,t,!1,!1),t.stateNode=e;e:{switch(l=_c(n,r),n){case"dialog":Be("cancel",e),Be("close",e),a=r;break;case"iframe":case"object":case"embed":Be("load",e),a=r;break;case"video":case"audio":for(a=0;a<Ra.length;a++)Be(Ra[a],e);a=r;break;case"source":Be("error",e),a=r;break;case"img":case"image":case"link":Be("error",e),Be("load",e),a=r;break;case"details":Be("toggle",e),a=r;break;case"input":yd(e,r),a=gc(e,r),Be("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Fe({},r,{value:void 0}),Be("invalid",e);break;case"textarea":Nd(e,r),a=jc(e,r),Be("invalid",e);break;default:a=r}wc(n,a),c=a;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?xf(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&vf(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ha(e,u):typeof u=="number"&&Ha(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Wa.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Be("scroll",e):u!=null&&xu(e,i,u,l))}switch(n){case"input":Pi(e),jd(e,r,!1);break;case"textarea":Pi(e),wd(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Is(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Dr(e,!!r.multiple,i,!1):r.defaultValue!=null&&Dr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=kl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return yt(t),null;case 6:if(e&&t.stateNode!=null)Up(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(z(166));if(n=ar(ni.current),ar(In.current),Fi(t)){if(r=t.stateNode,n=t.memoizedProps,r[On]=t,(i=r.nodeValue!==n)&&(e=Vt,e!==null))switch(e.tag){case 3:Vi(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Vi(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[On]=t,t.stateNode=r}return yt(t),null;case 13:if(ze(Ue),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($e&&Ut!==null&&t.mode&1&&!(t.flags&128))ap(),Hr(),t.flags|=98560,i=!1;else if(i=Fi(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(z(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(z(317));i[On]=t}else Hr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;yt(t),i=!1}else yn!==null&&(su(yn),yn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ue.current&1?rt===0&&(rt=3):ed())),t.updateQueue!==null&&(t.flags|=4),yt(t),null);case 4:return Gr(),Kc(e,t),e===null&&Ja(t.stateNode.containerInfo),yt(t),null;case 10:return Du(t.type._context),yt(t),null;case 17:return It(t.type)&&bl(),yt(t),null;case 19:if(ze(Ue),i=t.memoizedState,i===null)return yt(t),null;if(r=(t.flags&128)!==0,l=i.rendering,l===null)if(r)ba(i,!1);else{if(rt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Ol(e),l!==null){for(t.flags|=128,ba(i,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ie(Ue,Ue.current&1|2),t.child}e=e.sibling}i.tail!==null&&qe()>Kr&&(t.flags|=128,r=!0,ba(i,!1),t.lanes=4194304)}else{if(!r)if(e=Ol(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ba(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!$e)return yt(t),null}else 2*qe()-i.renderingStartTime>Kr&&n!==1073741824&&(t.flags|=128,r=!0,ba(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(n=i.last,n!==null?n.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=qe(),t.sibling=null,n=Ue.current,Ie(Ue,r?n&1|2:n&1),t):(yt(t),null);case 22:case 23:return Zu(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?$t&1073741824&&(yt(t),t.subtreeFlags&6&&(t.flags|=8192)):yt(t),null;case 24:return null;case 25:return null}throw Error(z(156,t.tag))}function Cg(e,t){switch(Ou(t),t.tag){case 1:return It(t.type)&&bl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Gr(),ze(Pt),ze(Nt),Vu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Uu(t),null;case 13:if(ze(Ue),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(z(340));Hr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ze(Ue),null;case 4:return Gr(),null;case 10:return Du(t.type._context),null;case 22:case 23:return Zu(),null;case 24:return null;default:return null}}var qi=!1,jt=!1,Eg=typeof WeakSet=="function"?WeakSet:Set,J=null;function Ir(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){We(e,t,r)}else n.current=null}function Yc(e,t,n){try{n()}catch(r){We(e,t,r)}}var dh=!1;function Ag(e,t){if(Oc=wl,e=qf(),Lu(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var l=0,c=-1,u=-1,m=0,S=0,g=e,y=null;t:for(;;){for(var E;g!==n||a!==0&&g.nodeType!==3||(c=l+a),g!==i||r!==0&&g.nodeType!==3||(u=l+r),g.nodeType===3&&(l+=g.nodeValue.length),(E=g.firstChild)!==null;)y=g,g=E;for(;;){if(g===e)break t;if(y===n&&++m===a&&(c=l),y===i&&++S===r&&(u=l),(E=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=E}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Pc={focusedElem:e,selectionRange:n},wl=!1,J=t;J!==null;)if(t=J,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,J=e;else for(;J!==null;){t=J;try{var O=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var P=O.memoizedProps,b=O.memoizedState,f=t.stateNode,p=f.getSnapshotBeforeUpdate(t.elementType===t.type?P:vn(t.type,P),b);f.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(j){We(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,J=e;break}J=t.return}return O=dh,dh=!1,O}function $a(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Yc(t,n,i)}a=a.next}while(a!==r)}}function Jl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Xc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Vp(e){var t=e.alternate;t!==null&&(e.alternate=null,Vp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[On],delete t[ei],delete t[Dc],delete t[dg],delete t[hg])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Fp(e){return e.tag===5||e.tag===3||e.tag===4}function hh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Fp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Jc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=kl));else if(r!==4&&(e=e.child,e!==null))for(Jc(e,t,n),e=e.sibling;e!==null;)Jc(e,t,n),e=e.sibling}function Zc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Zc(e,t,n),e=e.sibling;e!==null;)Zc(e,t,n),e=e.sibling}var pt=null,gn=!1;function xs(e,t,n){for(n=n.child;n!==null;)Wp(e,t,n),n=n.sibling}function Wp(e,t,n){if(Pn&&typeof Pn.onCommitFiberUnmount=="function")try{Pn.onCommitFiberUnmount(Wl,n)}catch{}switch(n.tag){case 5:jt||Ir(n,t);case 6:var r=pt,a=gn;pt=null,xs(e,t,n),pt=r,gn=a,pt!==null&&(gn?(e=pt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):pt.removeChild(n.stateNode));break;case 18:pt!==null&&(gn?(e=pt,n=n.stateNode,e.nodeType===8?Yo(e.parentNode,n):e.nodeType===1&&Yo(e,n),Ka(e)):Yo(pt,n.stateNode));break;case 4:r=pt,a=gn,pt=n.stateNode.containerInfo,gn=!0,xs(e,t,n),pt=r,gn=a;break;case 0:case 11:case 14:case 15:if(!jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Yc(n,t,l),a=a.next}while(a!==r)}xs(e,t,n);break;case 1:if(!jt&&(Ir(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){We(n,t,c)}xs(e,t,n);break;case 21:xs(e,t,n);break;case 22:n.mode&1?(jt=(r=jt)||n.memoizedState!==null,xs(e,t,n),jt=r):xs(e,t,n);break;default:xs(e,t,n)}}function fh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Eg),t.forEach(function(r){var a=Bg.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function mn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,l=t,c=l;e:for(;c!==null;){switch(c.tag){case 5:pt=c.stateNode,gn=!1;break e;case 3:pt=c.stateNode.containerInfo,gn=!0;break e;case 4:pt=c.stateNode.containerInfo,gn=!0;break e}c=c.return}if(pt===null)throw Error(z(160));Wp(i,l,a),pt=null,gn=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(m){We(a,t,m)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Hp(t,e),t=t.sibling}function Hp(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mn(t,e),Ln(e),r&4){try{$a(3,e,e.return),Jl(3,e)}catch(P){We(e,e.return,P)}try{$a(5,e,e.return)}catch(P){We(e,e.return,P)}}break;case 1:mn(t,e),Ln(e),r&512&&n!==null&&Ir(n,n.return);break;case 5:if(mn(t,e),Ln(e),r&512&&n!==null&&Ir(n,n.return),e.flags&32){var a=e.stateNode;try{Ha(a,"")}catch(P){We(e,e.return,P)}}if(r&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=n!==null?n.memoizedProps:i,c=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&ff(a,i),_c(c,l);var m=_c(c,i);for(l=0;l<u.length;l+=2){var S=u[l],g=u[l+1];S==="style"?xf(a,g):S==="dangerouslySetInnerHTML"?vf(a,g):S==="children"?Ha(a,g):xu(a,S,g,m)}switch(c){case"input":xc(a,i);break;case"textarea":pf(a,i);break;case"select":var y=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var E=i.value;E!=null?Dr(a,!!i.multiple,E,!1):y!==!!i.multiple&&(i.defaultValue!=null?Dr(a,!!i.multiple,i.defaultValue,!0):Dr(a,!!i.multiple,i.multiple?[]:"",!1))}a[ei]=i}catch(P){We(e,e.return,P)}}break;case 6:if(mn(t,e),Ln(e),r&4){if(e.stateNode===null)throw Error(z(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(P){We(e,e.return,P)}}break;case 3:if(mn(t,e),Ln(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ka(t.containerInfo)}catch(P){We(e,e.return,P)}break;case 4:mn(t,e),Ln(e);break;case 13:mn(t,e),Ln(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Xu=qe())),r&4&&fh(e);break;case 22:if(S=n!==null&&n.memoizedState!==null,e.mode&1?(jt=(m=jt)||S,mn(t,e),jt=m):mn(t,e),Ln(e),r&8192){if(m=e.memoizedState!==null,(e.stateNode.isHidden=m)&&!S&&e.mode&1)for(J=e,S=e.child;S!==null;){for(g=J=S;J!==null;){switch(y=J,E=y.child,y.tag){case 0:case 11:case 14:case 15:$a(4,y,y.return);break;case 1:Ir(y,y.return);var O=y.stateNode;if(typeof O.componentWillUnmount=="function"){r=y,n=y.return;try{t=r,O.props=t.memoizedProps,O.state=t.memoizedState,O.componentWillUnmount()}catch(P){We(r,n,P)}}break;case 5:Ir(y,y.return);break;case 22:if(y.memoizedState!==null){mh(g);continue}}E!==null?(E.return=y,J=E):mh(g)}S=S.sibling}e:for(S=null,g=e;;){if(g.tag===5){if(S===null){S=g;try{a=g.stateNode,m?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=g.stateNode,u=g.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=gf("display",l))}catch(P){We(e,e.return,P)}}}else if(g.tag===6){if(S===null)try{g.stateNode.nodeValue=m?"":g.memoizedProps}catch(P){We(e,e.return,P)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;S===g&&(S=null),g=g.return}S===g&&(S=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:mn(t,e),Ln(e),r&4&&fh(e);break;case 21:break;default:mn(t,e),Ln(e)}}function Ln(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Fp(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(Ha(a,""),r.flags&=-33);var i=hh(e);Zc(e,i,a);break;case 3:case 4:var l=r.stateNode.containerInfo,c=hh(e);Jc(e,c,l);break;default:throw Error(z(161))}}catch(u){We(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Tg(e,t,n){J=e,qp(e)}function qp(e,t,n){for(var r=(e.mode&1)!==0;J!==null;){var a=J,i=a.child;if(a.tag===22&&r){var l=a.memoizedState!==null||qi;if(!l){var c=a.alternate,u=c!==null&&c.memoizedState!==null||jt;c=qi;var m=jt;if(qi=l,(jt=u)&&!m)for(J=a;J!==null;)l=J,u=l.child,l.tag===22&&l.memoizedState!==null?vh(a):u!==null?(u.return=l,J=u):vh(a);for(;i!==null;)J=i,qp(i),i=i.sibling;J=a,qi=c,jt=m}ph(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,J=i):ph(e)}}function ph(e){for(;J!==null;){var t=J;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:jt||Jl(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!jt)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:vn(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Jd(t,i,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Jd(t,l,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var m=t.alternate;if(m!==null){var S=m.memoizedState;if(S!==null){var g=S.dehydrated;g!==null&&Ka(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}jt||t.flags&512&&Xc(t)}catch(y){We(t,t.return,y)}}if(t===e){J=null;break}if(n=t.sibling,n!==null){n.return=t.return,J=n;break}J=t.return}}function mh(e){for(;J!==null;){var t=J;if(t===e){J=null;break}var n=t.sibling;if(n!==null){n.return=t.return,J=n;break}J=t.return}}function vh(e){for(;J!==null;){var t=J;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Jl(4,t)}catch(u){We(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(u){We(t,a,u)}}var i=t.return;try{Xc(t)}catch(u){We(t,i,u)}break;case 5:var l=t.return;try{Xc(t)}catch(u){We(t,l,u)}}}catch(u){We(t,t.return,u)}if(t===e){J=null;break}var c=t.sibling;if(c!==null){c.return=t.return,J=c;break}J=t.return}}var Lg=Math.ceil,Ml=ts.ReactCurrentDispatcher,Ku=ts.ReactCurrentOwner,rn=ts.ReactCurrentBatchConfig,_e=0,ut=null,Ye=null,mt=0,$t=0,Mr=Bs(0),rt=0,ii=null,dr=0,Zl=0,Yu=0,Ua=null,Rt=null,Xu=0,Kr=1/0,Hn=null,Dl=!1,eu=null,Ls=null,Gi=!1,Ss=null,Bl=0,Va=0,tu=null,ul=-1,dl=0;function Ct(){return _e&6?qe():ul!==-1?ul:ul=qe()}function Rs(e){return e.mode&1?_e&2&&mt!==0?mt&-mt:pg.transition!==null?(dl===0&&(dl=Tf()),dl):(e=Le,e!==0||(e=window.event,e=e===void 0?16:Df(e.type)),e):1}function Nn(e,t,n,r){if(50<Va)throw Va=0,tu=null,Error(z(185));oi(e,n,r),(!(_e&2)||e!==ut)&&(e===ut&&(!(_e&2)&&(Zl|=n),rt===4&&ws(e,mt)),Mt(e,r),n===1&&_e===0&&!(t.mode&1)&&(Kr=qe()+500,Kl&&zs()))}function Mt(e,t){var n=e.callbackNode;pv(e,t);var r=Nl(e,e===ut?mt:0);if(r===0)n!==null&&kd(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&kd(n),t===1)e.tag===0?fg(gh.bind(null,e)):np(gh.bind(null,e)),cg(function(){!(_e&6)&&zs()}),n=null;else{switch(Lf(r)){case 1:n=_u;break;case 4:n=Ef;break;case 16:n=jl;break;case 536870912:n=Af;break;default:n=jl}n=em(n,Gp.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Gp(e,t){if(ul=-1,dl=0,_e&6)throw Error(z(327));var n=e.callbackNode;if(Vr()&&e.callbackNode!==n)return null;var r=Nl(e,e===ut?mt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=zl(e,r);else{t=r;var a=_e;_e|=2;var i=Kp();(ut!==e||mt!==t)&&(Hn=null,Kr=qe()+500,ir(e,t));do try{Pg();break}catch(c){Qp(e,c)}while(!0);Mu(),Ml.current=i,_e=a,Ye!==null?t=0:(ut=null,mt=0,t=rt)}if(t!==0){if(t===2&&(a=Ec(e),a!==0&&(r=a,t=nu(e,a))),t===1)throw n=ii,ir(e,0),ws(e,r),Mt(e,qe()),n;if(t===6)ws(e,r);else{if(a=e.current.alternate,!(r&30)&&!Rg(a)&&(t=zl(e,r),t===2&&(i=Ec(e),i!==0&&(r=i,t=nu(e,i))),t===1))throw n=ii,ir(e,0),ws(e,r),Mt(e,qe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(z(345));case 2:nr(e,Rt,Hn);break;case 3:if(ws(e,r),(r&130023424)===r&&(t=Xu+500-qe(),10<t)){if(Nl(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){Ct(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Mc(nr.bind(null,e,Rt,Hn),t);break}nr(e,Rt,Hn);break;case 4:if(ws(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var l=31-jn(r);i=1<<l,l=t[l],l>a&&(a=l),r&=~i}if(r=a,r=qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Lg(r/1960))-r,10<r){e.timeoutHandle=Mc(nr.bind(null,e,Rt,Hn),r);break}nr(e,Rt,Hn);break;case 5:nr(e,Rt,Hn);break;default:throw Error(z(329))}}}return Mt(e,qe()),e.callbackNode===n?Gp.bind(null,e):null}function nu(e,t){var n=Ua;return e.current.memoizedState.isDehydrated&&(ir(e,t).flags|=256),e=zl(e,t),e!==2&&(t=Rt,Rt=n,t!==null&&su(t)),e}function su(e){Rt===null?Rt=e:Rt.push.apply(Rt,e)}function Rg(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!wn(i(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ws(e,t){for(t&=~Yu,t&=~Zl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-jn(t),r=1<<n;e[n]=-1,t&=~r}}function gh(e){if(_e&6)throw Error(z(327));Vr();var t=Nl(e,0);if(!(t&1))return Mt(e,qe()),null;var n=zl(e,t);if(e.tag!==0&&n===2){var r=Ec(e);r!==0&&(t=r,n=nu(e,r))}if(n===1)throw n=ii,ir(e,0),ws(e,t),Mt(e,qe()),n;if(n===6)throw Error(z(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,nr(e,Rt,Hn),Mt(e,qe()),null}function Ju(e,t){var n=_e;_e|=1;try{return e(t)}finally{_e=n,_e===0&&(Kr=qe()+500,Kl&&zs())}}function hr(e){Ss!==null&&Ss.tag===0&&!(_e&6)&&Vr();var t=_e;_e|=1;var n=rn.transition,r=Le;try{if(rn.transition=null,Le=1,e)return e()}finally{Le=r,rn.transition=n,_e=t,!(_e&6)&&zs()}}function Zu(){$t=Mr.current,ze(Mr)}function ir(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,og(n)),Ye!==null)for(n=Ye.return;n!==null;){var r=n;switch(Ou(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&bl();break;case 3:Gr(),ze(Pt),ze(Nt),Vu();break;case 5:Uu(r);break;case 4:Gr();break;case 13:ze(Ue);break;case 19:ze(Ue);break;case 10:Du(r.type._context);break;case 22:case 23:Zu()}n=n.return}if(ut=e,Ye=e=Os(e.current,null),mt=$t=t,rt=0,ii=null,Yu=Zl=dr=0,Rt=Ua=null,rr!==null){for(t=0;t<rr.length;t++)if(n=rr[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var l=i.next;i.next=a,r.next=l}n.pending=r}rr=null}return e}function Qp(e,t){do{var n=Ye;try{if(Mu(),ll.current=Il,Pl){for(var r=Ve.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Pl=!1}if(ur=0,ct=st=Ve=null,za=!1,si=0,Ku.current=null,n===null||n.return===null){rt=1,ii=t,Ye=null;break}e:{var i=e,l=n.return,c=n,u=t;if(t=mt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var m=u,S=c,g=S.tag;if(!(S.mode&1)&&(g===0||g===11||g===15)){var y=S.alternate;y?(S.updateQueue=y.updateQueue,S.memoizedState=y.memoizedState,S.lanes=y.lanes):(S.updateQueue=null,S.memoizedState=null)}var E=rh(l);if(E!==null){E.flags&=-257,ah(E,l,c,i,t),E.mode&1&&sh(i,m,t),t=E,u=m;var O=t.updateQueue;if(O===null){var P=new Set;P.add(u),t.updateQueue=P}else O.add(u);break e}else{if(!(t&1)){sh(i,m,t),ed();break e}u=Error(z(426))}}else if($e&&c.mode&1){var b=rh(l);if(b!==null){!(b.flags&65536)&&(b.flags|=256),ah(b,l,c,i,t),Pu(Qr(u,c));break e}}i=u=Qr(u,c),rt!==4&&(rt=2),Ua===null?Ua=[i]:Ua.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var f=Lp(i,u,t);Xd(i,f);break e;case 1:c=u;var p=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Ls===null||!Ls.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=Rp(i,c,t);Xd(i,j);break e}}i=i.return}while(i!==null)}Xp(n)}catch(R){t=R,Ye===n&&n!==null&&(Ye=n=n.return);continue}break}while(!0)}function Kp(){var e=Ml.current;return Ml.current=Il,e===null?Il:e}function ed(){(rt===0||rt===3||rt===2)&&(rt=4),ut===null||!(dr&268435455)&&!(Zl&268435455)||ws(ut,mt)}function zl(e,t){var n=_e;_e|=2;var r=Kp();(ut!==e||mt!==t)&&(Hn=null,ir(e,t));do try{Og();break}catch(a){Qp(e,a)}while(!0);if(Mu(),_e=n,Ml.current=r,Ye!==null)throw Error(z(261));return ut=null,mt=0,rt}function Og(){for(;Ye!==null;)Yp(Ye)}function Pg(){for(;Ye!==null&&!av();)Yp(Ye)}function Yp(e){var t=Zp(e.alternate,e,$t);e.memoizedProps=e.pendingProps,t===null?Xp(e):Ye=t,Ku.current=null}function Xp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Cg(n,t),n!==null){n.flags&=32767,Ye=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{rt=6,Ye=null;return}}else if(n=bg(n,t,$t),n!==null){Ye=n;return}if(t=t.sibling,t!==null){Ye=t;return}Ye=t=e}while(t!==null);rt===0&&(rt=5)}function nr(e,t,n){var r=Le,a=rn.transition;try{rn.transition=null,Le=1,Ig(e,t,n,r)}finally{rn.transition=a,Le=r}return null}function Ig(e,t,n,r){do Vr();while(Ss!==null);if(_e&6)throw Error(z(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(z(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(mv(e,i),e===ut&&(Ye=ut=null,mt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Gi||(Gi=!0,em(jl,function(){return Vr(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=rn.transition,rn.transition=null;var l=Le;Le=1;var c=_e;_e|=4,Ku.current=null,Ag(e,n),Hp(n,e),tg(Pc),wl=!!Oc,Pc=Oc=null,e.current=n,Tg(n),iv(),_e=c,Le=l,rn.transition=i}else e.current=n;if(Gi&&(Gi=!1,Ss=e,Bl=a),i=e.pendingLanes,i===0&&(Ls=null),cv(n.stateNode),Mt(e,qe()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Dl)throw Dl=!1,e=eu,eu=null,e;return Bl&1&&e.tag!==0&&Vr(),i=e.pendingLanes,i&1?e===tu?Va++:(Va=0,tu=e):Va=0,zs(),null}function Vr(){if(Ss!==null){var e=Lf(Bl),t=rn.transition,n=Le;try{if(rn.transition=null,Le=16>e?16:e,Ss===null)var r=!1;else{if(e=Ss,Ss=null,Bl=0,_e&6)throw Error(z(331));var a=_e;for(_e|=4,J=e.current;J!==null;){var i=J,l=i.child;if(J.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var m=c[u];for(J=m;J!==null;){var S=J;switch(S.tag){case 0:case 11:case 15:$a(8,S,i)}var g=S.child;if(g!==null)g.return=S,J=g;else for(;J!==null;){S=J;var y=S.sibling,E=S.return;if(Vp(S),S===m){J=null;break}if(y!==null){y.return=E,J=y;break}J=E}}}var O=i.alternate;if(O!==null){var P=O.child;if(P!==null){O.child=null;do{var b=P.sibling;P.sibling=null,P=b}while(P!==null)}}J=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,J=l;else e:for(;J!==null;){if(i=J,i.flags&2048)switch(i.tag){case 0:case 11:case 15:$a(9,i,i.return)}var f=i.sibling;if(f!==null){f.return=i.return,J=f;break e}J=i.return}}var p=e.current;for(J=p;J!==null;){l=J;var v=l.child;if(l.subtreeFlags&2064&&v!==null)v.return=l,J=v;else e:for(l=p;J!==null;){if(c=J,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Jl(9,c)}}catch(R){We(c,c.return,R)}if(c===l){J=null;break e}var j=c.sibling;if(j!==null){j.return=c.return,J=j;break e}J=c.return}}if(_e=a,zs(),Pn&&typeof Pn.onPostCommitFiberRoot=="function")try{Pn.onPostCommitFiberRoot(Wl,e)}catch{}r=!0}return r}finally{Le=n,rn.transition=t}}return!1}function xh(e,t,n){t=Qr(n,t),t=Lp(e,t,1),e=Ts(e,t,1),t=Ct(),e!==null&&(oi(e,1,t),Mt(e,t))}function We(e,t,n){if(e.tag===3)xh(e,e,n);else for(;t!==null;){if(t.tag===3){xh(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ls===null||!Ls.has(r))){e=Qr(n,e),e=Rp(t,e,1),t=Ts(t,e,1),e=Ct(),t!==null&&(oi(t,1,e),Mt(t,e));break}}t=t.return}}function Mg(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ct(),e.pingedLanes|=e.suspendedLanes&n,ut===e&&(mt&n)===n&&(rt===4||rt===3&&(mt&130023424)===mt&&500>qe()-Xu?ir(e,0):Yu|=n),Mt(e,t)}function Jp(e,t){t===0&&(e.mode&1?(t=Di,Di<<=1,!(Di&130023424)&&(Di=4194304)):t=1);var n=Ct();e=Zn(e,t),e!==null&&(oi(e,t,n),Mt(e,n))}function Dg(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Jp(e,n)}function Bg(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(t),Jp(e,n)}var Zp;Zp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Pt.current)Ot=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ot=!1,kg(e,t,n);Ot=!!(e.flags&131072)}else Ot=!1,$e&&t.flags&1048576&&sp(t,Al,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;cl(e,t),e=t.pendingProps;var a=Wr(t,Nt.current);Ur(t,n),a=Wu(null,t,r,e,a,n);var i=Hu();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,It(r)?(i=!0,Cl(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,zu(t),a.updater=Xl,t.stateNode=a,a._reactInternals=t,Fc(t,r,e,n),t=qc(null,t,r,!0,i,n)):(t.tag=0,$e&&i&&Ru(t),bt(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(cl(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=$g(r),e=vn(r,e),a){case 0:t=Hc(null,t,r,e,n);break e;case 1:t=oh(null,t,r,e,n);break e;case 11:t=ih(null,t,r,e,n);break e;case 14:t=lh(null,t,r,vn(r.type,e),n);break e}throw Error(z(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:vn(r,a),Hc(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:vn(r,a),oh(e,t,r,a,n);case 3:e:{if(Mp(t),e===null)throw Error(z(387));r=t.pendingProps,i=t.memoizedState,a=i.element,cp(e,t),Rl(t,r,null,n);var l=t.memoizedState;if(r=l.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Qr(Error(z(423)),t),t=ch(e,t,r,n,a);break e}else if(r!==a){a=Qr(Error(z(424)),t),t=ch(e,t,r,n,a);break e}else for(Ut=As(t.stateNode.containerInfo.firstChild),Vt=t,$e=!0,yn=null,n=lp(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Hr(),r===a){t=es(e,t,n);break e}bt(e,t,r,n)}t=t.child}return t;case 5:return up(t),e===null&&$c(t),r=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,Ic(r,a)?l=null:i!==null&&Ic(r,i)&&(t.flags|=32),Ip(e,t),bt(e,t,l,n),t.child;case 6:return e===null&&$c(t),null;case 13:return Dp(e,t,n);case 4:return $u(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=qr(t,null,r,n):bt(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:vn(r,a),ih(e,t,r,a,n);case 7:return bt(e,t,t.pendingProps,n),t.child;case 8:return bt(e,t,t.pendingProps.children,n),t.child;case 12:return bt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,Ie(Tl,r._currentValue),r._currentValue=l,i!==null)if(wn(i.value,l)){if(i.children===a.children&&!Pt.current){t=es(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var c=i.dependencies;if(c!==null){l=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Yn(-1,n&-n),u.tag=2;var m=i.updateQueue;if(m!==null){m=m.shared;var S=m.pending;S===null?u.next=u:(u.next=S.next,S.next=u),m.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Uc(i.return,n,t),c.lanes|=n;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(z(341));l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),Uc(l,n,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}bt(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ur(t,n),a=an(a),r=r(a),t.flags|=1,bt(e,t,r,n),t.child;case 14:return r=t.type,a=vn(r,t.pendingProps),a=vn(r.type,a),lh(e,t,r,a,n);case 15:return Op(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:vn(r,a),cl(e,t),t.tag=1,It(r)?(e=!0,Cl(t)):e=!1,Ur(t,n),Tp(t,r,a),Fc(t,r,a,n),qc(null,t,r,!0,e,n);case 19:return Bp(e,t,n);case 22:return Pp(e,t,n)}throw Error(z(156,t.tag))};function em(e,t){return Cf(e,t)}function zg(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(e,t,n,r){return new zg(e,t,n,r)}function td(e){return e=e.prototype,!(!e||!e.isReactComponent)}function $g(e){if(typeof e=="function")return td(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ju)return 11;if(e===Nu)return 14}return 2}function Os(e,t){var n=e.alternate;return n===null?(n=sn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function hl(e,t,n,r,a,i){var l=2;if(r=e,typeof e=="function")td(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case br:return lr(n.children,a,i,t);case yu:l=8,a|=8;break;case fc:return e=sn(12,n,t,a|2),e.elementType=fc,e.lanes=i,e;case pc:return e=sn(13,n,t,a),e.elementType=pc,e.lanes=i,e;case mc:return e=sn(19,n,t,a),e.elementType=mc,e.lanes=i,e;case uf:return eo(n,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case of:l=10;break e;case cf:l=9;break e;case ju:l=11;break e;case Nu:l=14;break e;case ys:l=16,r=null;break e}throw Error(z(130,e==null?e:typeof e,""))}return t=sn(l,n,t,a),t.elementType=e,t.type=r,t.lanes=i,t}function lr(e,t,n,r){return e=sn(7,e,r,t),e.lanes=n,e}function eo(e,t,n,r){return e=sn(22,e,r,t),e.elementType=uf,e.lanes=n,e.stateNode={isHidden:!1},e}function rc(e,t,n){return e=sn(6,e,null,t),e.lanes=n,e}function ac(e,t,n){return t=sn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ug(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zo(0),this.expirationTimes=zo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zo(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function nd(e,t,n,r,a,i,l,c,u){return e=new Ug(e,t,n,c,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=sn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zu(i),e}function Vg(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:kr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function tm(e){if(!e)return Ms;e=e._reactInternals;e:{if(pr(e)!==e||e.tag!==1)throw Error(z(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(It(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(z(171))}if(e.tag===1){var n=e.type;if(It(n))return tp(e,n,t)}return t}function nm(e,t,n,r,a,i,l,c,u){return e=nd(n,r,!0,e,a,i,l,c,u),e.context=tm(null),n=e.current,r=Ct(),a=Rs(n),i=Yn(r,a),i.callback=t??null,Ts(n,i,a),e.current.lanes=a,oi(e,a,r),Mt(e,r),e}function to(e,t,n,r){var a=t.current,i=Ct(),l=Rs(a);return n=tm(n),t.context===null?t.context=n:t.pendingContext=n,t=Yn(i,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ts(a,t,l),e!==null&&(Nn(e,a,l,i),il(e,a,l)),l}function $l(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function yh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function sd(e,t){yh(e,t),(e=e.alternate)&&yh(e,t)}function Fg(){return null}var sm=typeof reportError=="function"?reportError:function(e){console.error(e)};function rd(e){this._internalRoot=e}no.prototype.render=rd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(z(409));to(e,t,null,null)};no.prototype.unmount=rd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hr(function(){to(null,e,null,null)}),t[Jn]=null}};function no(e){this._internalRoot=e}no.prototype.unstable_scheduleHydration=function(e){if(e){var t=Pf();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ns.length&&t!==0&&t<Ns[n].priority;n++);Ns.splice(n,0,e),n===0&&Mf(e)}};function ad(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function so(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function jh(){}function Wg(e,t,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var m=$l(l);i.call(m)}}var l=nm(t,r,e,0,null,!1,!1,"",jh);return e._reactRootContainer=l,e[Jn]=l.current,Ja(e.nodeType===8?e.parentNode:e),hr(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var c=r;r=function(){var m=$l(u);c.call(m)}}var u=nd(e,0,!1,null,null,!1,!1,"",jh);return e._reactRootContainer=u,e[Jn]=u.current,Ja(e.nodeType===8?e.parentNode:e),hr(function(){to(t,u,n,r)}),u}function ro(e,t,n,r,a){var i=n._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var c=a;a=function(){var u=$l(l);c.call(u)}}to(t,l,e,a)}else l=Wg(n,t,e,a,r);return $l(l)}Rf=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=La(t.pendingLanes);n!==0&&(Su(t,n|1),Mt(t,qe()),!(_e&6)&&(Kr=qe()+500,zs()))}break;case 13:hr(function(){var r=Zn(e,1);if(r!==null){var a=Ct();Nn(r,e,1,a)}}),sd(e,1)}};ku=function(e){if(e.tag===13){var t=Zn(e,134217728);if(t!==null){var n=Ct();Nn(t,e,134217728,n)}sd(e,134217728)}};Of=function(e){if(e.tag===13){var t=Rs(e),n=Zn(e,t);if(n!==null){var r=Ct();Nn(n,e,t,r)}sd(e,t)}};Pf=function(){return Le};If=function(e,t){var n=Le;try{return Le=e,t()}finally{Le=n}};kc=function(e,t,n){switch(t){case"input":if(xc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Ql(r);if(!a)throw Error(z(90));hf(r),xc(r,a)}}}break;case"textarea":pf(e,n);break;case"select":t=n.value,t!=null&&Dr(e,!!n.multiple,t,!1)}};Nf=Ju;wf=hr;var Hg={usingClientEntryPoint:!1,Events:[ui,Tr,Ql,yf,jf,Ju]},Ca={findFiberByHostInstance:sr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qg={bundleType:Ca.bundleType,version:Ca.version,rendererPackageName:Ca.rendererPackageName,rendererConfig:Ca.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ts.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=kf(e),e===null?null:e.stateNode},findFiberByHostInstance:Ca.findFiberByHostInstance||Fg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qi.isDisabled&&Qi.supportsFiber)try{Wl=Qi.inject(qg),Pn=Qi}catch{}}Wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Hg;Wt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ad(t))throw Error(z(200));return Vg(e,t,null,n)};Wt.createRoot=function(e,t){if(!ad(e))throw Error(z(299));var n=!1,r="",a=sm;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=nd(e,1,!1,null,null,n,!1,r,a),e[Jn]=t.current,Ja(e.nodeType===8?e.parentNode:e),new rd(t)};Wt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(z(188)):(e=Object.keys(e).join(","),Error(z(268,e)));return e=kf(t),e=e===null?null:e.stateNode,e};Wt.flushSync=function(e){return hr(e)};Wt.hydrate=function(e,t,n){if(!so(t))throw Error(z(200));return ro(null,e,t,!0,n)};Wt.hydrateRoot=function(e,t,n){if(!ad(e))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",l=sm;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=nm(t,null,e,1,n??null,a,!1,i,l),e[Jn]=t.current,Ja(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new no(t)};Wt.render=function(e,t,n){if(!so(t))throw Error(z(200));return ro(null,e,t,!1,n)};Wt.unmountComponentAtNode=function(e){if(!so(e))throw Error(z(40));return e._reactRootContainer?(hr(function(){ro(null,null,e,!1,function(){e._reactRootContainer=null,e[Jn]=null})}),!0):!1};Wt.unstable_batchedUpdates=Ju;Wt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!so(n))throw Error(z(200));if(e==null||e._reactInternals===void 0)throw Error(z(38));return ro(e,t,n,!1,r)};Wt.version="18.3.1-next-f1338f8080-20240426";function rm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rm)}catch(e){console.error(e)}}rm(),sf.exports=Wt;var Gg=sf.exports,am,Nh=Gg;am=Nh.createRoot,Nh.hydrateRoot;const Qg="http://localhost:3000";let ru=localStorage.getItem("token");function _r(e){ru=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}async function hi(e,t={}){const n={"Content-Type":"application/json",...t.headers||{}};if(ru&&(n.Authorization=`Bearer ${ru}`),typeof window<"u"&&navigator&&navigator.onLine===!1)throw new Error("offline");let r;try{r=await fetch(`${Qg}${e}`,{...t,headers:n})}catch(a){throw typeof window<"u"&&navigator&&navigator.onLine===!1?new Error("offline"):a instanceof TypeError?new Error("network_error"):a}if(!r.ok){const i=(await r.json().catch(()=>({}))).error||"request_failed";throw new Error(i)}return r.json()}function je(e){return hi(e,{method:"GET"})}function Te(e,t){return hi(e,{method:"POST",body:JSON.stringify(t||{})})}function ot(e,t){return hi(e,{method:"PATCH",body:JSON.stringify(t||{})})}function Ul(e,t){return hi(e,{method:"PUT",body:JSON.stringify(t||{})})}function ks(e){return hi(e,{method:"DELETE"})}const Dn=Object.create(null);Dn.open="0";Dn.close="1";Dn.ping="2";Dn.pong="3";Dn.message="4";Dn.upgrade="5";Dn.noop="6";const fl=Object.create(null);Object.keys(Dn).forEach(e=>{fl[Dn[e]]=e});const au={type:"error",data:"parser error"},im=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",lm=typeof ArrayBuffer=="function",om=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,id=({type:e,data:t},n,r)=>im&&t instanceof Blob?n?r(t):wh(t,r):lm&&(t instanceof ArrayBuffer||om(t))?n?r(t):wh(new Blob([t]),r):r(Dn[e]+(t||"")),wh=(e,t)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];t("b"+(r||""))},n.readAsDataURL(e)};function _h(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let ic;function Kg(e,t){if(im&&e.data instanceof Blob)return e.data.arrayBuffer().then(_h).then(t);if(lm&&(e.data instanceof ArrayBuffer||om(e.data)))return t(_h(e.data));id(e,!1,n=>{ic||(ic=new TextEncoder),t(ic.encode(n))})}const Sh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Oa=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<Sh.length;e++)Oa[Sh.charCodeAt(e)]=e;const Yg=e=>{let t=e.length*.75,n=e.length,r,a=0,i,l,c,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const m=new ArrayBuffer(t),S=new Uint8Array(m);for(r=0;r<n;r+=4)i=Oa[e.charCodeAt(r)],l=Oa[e.charCodeAt(r+1)],c=Oa[e.charCodeAt(r+2)],u=Oa[e.charCodeAt(r+3)],S[a++]=i<<2|l>>4,S[a++]=(l&15)<<4|c>>2,S[a++]=(c&3)<<6|u&63;return m},Xg=typeof ArrayBuffer=="function",ld=(e,t)=>{if(typeof e!="string")return{type:"message",data:cm(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:Jg(e.substring(1),t)}:fl[n]?e.length>1?{type:fl[n],data:e.substring(1)}:{type:fl[n]}:au},Jg=(e,t)=>{if(Xg){const n=Yg(e);return cm(n,t)}else return{base64:!0,data:e}},cm=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},um="",Zg=(e,t)=>{const n=e.length,r=new Array(n);let a=0;e.forEach((i,l)=>{id(i,!1,c=>{r[l]=c,++a===n&&t(r.join(um))})})},ex=(e,t)=>{const n=e.split(um),r=[];for(let a=0;a<n.length;a++){const i=ld(n[a],t);if(r.push(i),i.type==="error")break}return r};function tx(){return new TransformStream({transform(e,t){Kg(e,n=>{const r=n.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const i=new DataView(a.buffer);i.setUint8(0,126),i.setUint16(1,r)}else{a=new Uint8Array(9);const i=new DataView(a.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(a[0]|=128),t.enqueue(a),t.enqueue(n)})}})}let lc;function Ki(e){return e.reduce((t,n)=>t+n.length,0)}function Yi(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let a=0;a<t;a++)n[a]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function nx(e,t){lc||(lc=new TextDecoder);const n=[];let r=0,a=-1,i=!1;return new TransformStream({transform(l,c){for(n.push(l);;){if(r===0){if(Ki(n)<1)break;const u=Yi(n,1);i=(u[0]&128)===128,a=u[0]&127,a<126?r=3:a===126?r=1:r=2}else if(r===1){if(Ki(n)<2)break;const u=Yi(n,2);a=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),r=3}else if(r===2){if(Ki(n)<8)break;const u=Yi(n,8),m=new DataView(u.buffer,u.byteOffset,u.length),S=m.getUint32(0);if(S>Math.pow(2,21)-1){c.enqueue(au);break}a=S*Math.pow(2,32)+m.getUint32(4),r=3}else{if(Ki(n)<a)break;const u=Yi(n,a);c.enqueue(ld(i?u:lc.decode(u),t)),r=0}if(a===0||a>e){c.enqueue(au);break}}}})}const dm=4;function Xe(e){if(e)return sx(e)}function sx(e){for(var t in Xe.prototype)e[t]=Xe.prototype[t];return e}Xe.prototype.on=Xe.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Xe.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};Xe.prototype.off=Xe.prototype.removeListener=Xe.prototype.removeAllListeners=Xe.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,a=0;a<n.length;a++)if(r=n[a],r===t||r.fn===t){n.splice(a,1);break}return n.length===0&&delete this._callbacks["$"+e],this};Xe.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,a=n.length;r<a;++r)n[r].apply(this,t)}return this};Xe.prototype.emitReserved=Xe.prototype.emit;Xe.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Xe.prototype.hasListeners=function(e){return!!this.listeners(e).length};const ao=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),nn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),rx="arraybuffer";function hm(e,...t){return t.reduce((n,r)=>(e.hasOwnProperty(r)&&(n[r]=e[r]),n),{})}const ax=nn.setTimeout,ix=nn.clearTimeout;function io(e,t){t.useNativeTimers?(e.setTimeoutFn=ax.bind(nn),e.clearTimeoutFn=ix.bind(nn)):(e.setTimeoutFn=nn.setTimeout.bind(nn),e.clearTimeoutFn=nn.clearTimeout.bind(nn))}const lx=1.33;function ox(e){return typeof e=="string"?cx(e):Math.ceil((e.byteLength||e.size)*lx)}function cx(e){let t=0,n=0;for(let r=0,a=e.length;r<a;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function fm(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function ux(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function dx(e){let t={},n=e.split("&");for(let r=0,a=n.length;r<a;r++){let i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class hx extends Error{constructor(t,n,r){super(t),this.description=n,this.context=r,this.type="TransportError"}}class od extends Xe{constructor(t){super(),this.writable=!1,io(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,r){return super.emitReserved("error",new hx(t,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=ld(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=ux(t);return n.length?"?"+n:""}}class fx extends od{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};ex(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Zg(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=fm()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let pm=!1;try{pm=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const px=pm;function mx(){}class vx extends fx{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,n){const r=this.request({method:"POST",data:t});r.on("success",n),r.on("error",(a,i)=>{this.onError("xhr post error",a,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=t}}class Mn extends Xe{constructor(t,n,r){super(),this.createRequest=t,io(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const n=hm(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&r.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var a;r.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=Mn.requestsCount++,Mn.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=mx,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Mn.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Mn.requestsCount=0;Mn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",kh);else if(typeof addEventListener=="function"){const e="onpagehide"in nn?"pagehide":"unload";addEventListener(e,kh,!1)}}function kh(){for(let e in Mn.requests)Mn.requests.hasOwnProperty(e)&&Mn.requests[e].abort()}const gx=function(){const e=mm({xdomain:!1});return e&&e.responseType!==null}();class xx extends vx{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=gx&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Mn(mm,this.uri(),t)}}function mm(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||px))return new XMLHttpRequest}catch{}if(!t)try{return new nn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const vm=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class yx extends od{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,r=vm?{}:hm(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,r)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;id(r,this.supportsBinary,i=>{try{this.doWrite(r,i)}catch{}a&&ao(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=fm()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const oc=nn.WebSocket||nn.MozWebSocket;class jx extends yx{createSocket(t,n,r){return vm?new oc(t,n,r):n?new oc(t,n):new oc(t)}doWrite(t,n){this.ws.send(n)}}class Nx extends od{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=nx(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),a=tx();a.readable.pipeTo(t.writable),this._writer=a.writable.getWriter();const i=()=>{r.read().then(({done:c,value:u})=>{c||(this.onPacket(u),i())}).catch(c=>{})};i();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;this._writer.write(r).then(()=>{a&&ao(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const wx={websocket:jx,webtransport:Nx,polling:xx},_x=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Sx=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function iu(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");n!=-1&&r!=-1&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let a=_x.exec(e||""),i={},l=14;for(;l--;)i[Sx[l]]=a[l]||"";return n!=-1&&r!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=kx(i,i.path),i.queryKey=bx(i,i.query),i}function kx(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function bx(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,a,i){a&&(n[a]=i)}),n}const lu=typeof addEventListener=="function"&&typeof removeEventListener=="function",pl=[];lu&&addEventListener("offline",()=>{pl.forEach(e=>e())},!1);class Ps extends Xe{constructor(t,n){if(super(),this.binaryType=rx,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const r=iu(t);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=iu(n.host).host);io(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const a=r.prototype.name;this.transports.push(a),this._transportsByName[a]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=dx(this.opts.query)),lu&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},pl.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=dm,n.transport=t,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Ps.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Ps.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const a=this.writeBuffer[r].data;if(a&&(n+=ox(a)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,ao(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,r){return this._sendPacket("message",t,n,r),this}send(t,n,r){return this._sendPacket("message",t,n,r),this}_sendPacket(t,n,r,a){if(typeof n=="function"&&(a=n,n=void 0),typeof r=="function"&&(a=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:t,data:n,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(Ps.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),lu&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=pl.indexOf(this._offlineEventListener);r!==-1&&pl.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}Ps.protocol=dm;class Cx extends Ps{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),r=!1;Ps.priorWebsocketSuccess=!1;const a=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",g=>{if(!r)if(g.type==="pong"&&g.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Ps.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(S(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const y=new Error("probe error");y.transport=n.name,this.emitReserved("upgradeError",y)}}))};function i(){r||(r=!0,S(),n.close(),n=null)}const l=g=>{const y=new Error("probe error: "+g);y.transport=n.name,i(),this.emitReserved("upgradeError",y)};function c(){l("transport closed")}function u(){l("socket closed")}function m(g){n&&g.name!==n.name&&i()}const S=()=>{n.removeListener("open",a),n.removeListener("error",l),n.removeListener("close",c),this.off("close",u),this.off("upgrading",m)};n.once("open",a),n.once("error",l),n.once("close",c),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}let Ex=class extends Cx{constructor(t,n={}){const r=typeof t=="object"?t:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(a=>wx[a]).filter(a=>!!a)),super(t,r)}};function Ax(e,t="",n){let r=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),r=iu(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}const Tx=typeof ArrayBuffer=="function",Lx=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,gm=Object.prototype.toString,Rx=typeof Blob=="function"||typeof Blob<"u"&&gm.call(Blob)==="[object BlobConstructor]",Ox=typeof File=="function"||typeof File<"u"&&gm.call(File)==="[object FileConstructor]";function cd(e){return Tx&&(e instanceof ArrayBuffer||Lx(e))||Rx&&e instanceof Blob||Ox&&e instanceof File}function ml(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(ml(e[n]))return!0;return!1}if(cd(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return ml(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&ml(e[n]))return!0;return!1}function Px(e){const t=[],n=e.data,r=e;return r.data=ou(n,t),r.attachments=t.length,{packet:r,buffers:t}}function ou(e,t){if(!e)return e;if(cd(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=ou(e[r],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=ou(e[r],t));return n}return e}function Ix(e,t){return e.data=cu(e.data,t),delete e.attachments,e}function cu(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=cu(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=cu(e[n],t));return e}const xm=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Mx=5;var me;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(me||(me={}));class Dx{constructor(t){this.replacer=t}encode(t){return(t.type===me.EVENT||t.type===me.ACK)&&ml(t)?this.encodeAsBinary({type:t.type===me.EVENT?me.BINARY_EVENT:me.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===me.BINARY_EVENT||t.type===me.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=Px(t),r=this.encodeAsString(n.packet),a=n.buffers;return a.unshift(r),a}}class ud extends Xe{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const r=n.type===me.BINARY_EVENT;r||n.type===me.BINARY_ACK?(n.type=r?me.EVENT:me.ACK,this.reconstructor=new Bx(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(cd(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const r={type:Number(t.charAt(0))};if(me[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===me.BINARY_EVENT||r.type===me.BINARY_ACK){const i=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const l=t.substring(i,n);if(l!=Number(l)||t.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(l)}if(t.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););r.nsp=t.substring(i,n)}else r.nsp="/";const a=t.charAt(n+1);if(a!==""&&Number(a)==a){const i=n+1;for(;++n;){const l=t.charAt(n);if(l==null||Number(l)!=l){--n;break}if(n===t.length)break}r.id=Number(t.substring(i,n+1))}if(t.charAt(++n)){const i=this.tryParse(t.substr(n));if(ud.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case me.CONNECT:return Vl(n);case me.DISCONNECT:return n===void 0;case me.CONNECT_ERROR:return typeof n=="string"||Vl(n);case me.EVENT:case me.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&xm.indexOf(n[0])===-1);case me.ACK:case me.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Bx{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=Ix(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function zx(e){return typeof e=="string"}const $x=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};function Ux(e){return e===void 0||$x(e)}function Vl(e){return Object.prototype.toString.call(e)==="[object Object]"}function Vx(e,t){switch(e){case me.CONNECT:return t===void 0||Vl(t);case me.DISCONNECT:return t===void 0;case me.EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&xm.indexOf(t[0])===-1);case me.ACK:return Array.isArray(t);case me.CONNECT_ERROR:return typeof t=="string"||Vl(t);default:return!1}}function Fx(e){return zx(e.nsp)&&Ux(e.id)&&Vx(e.type,e.data)}const Wx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ud,Encoder:Dx,get PacketType(){return me},isPacketValid:Fx,protocol:Mx},Symbol.toStringTag,{value:"Module"}));function xn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Hx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ym extends Xe{constructor(t,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[xn(t,"open",this.onopen.bind(this)),xn(t,"packet",this.onpacket.bind(this)),xn(t,"error",this.onerror.bind(this)),xn(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var r,a,i;if(Hx.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const l={type:me.EVENT,data:n};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const S=this.ids++,g=n.pop();this._registerAckCallback(S,g),l.id=S}const c=(a=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||a===void 0?void 0:a.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!c||(u?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(t,n){var r;const a=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(a===void 0){this.acks[t]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===t&&this.sendBuffer.splice(c,1);n.call(this,new Error("operation has timed out"))},a),l=(...c)=>{this.io.clearTimeoutFn(i),n.apply(this,c)};l.withError=!0,this.acks[t]=l}emitWithAck(t,...n){return new Promise((r,a)=>{const i=(l,c)=>l?a(l):r(c);i.withError=!0,n.push(i),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((a,...i)=>(this._queue[0],a!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(a)):(this._queue.shift(),n&&n(null,...i)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:me.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case me.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case me.EVENT:case me.BINARY_EVENT:this.onevent(t);break;case me.ACK:case me.BINARY_ACK:this.onack(t);break;case me.DISCONNECT:this.ondisconnect();break;case me.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let r=!1;return function(...a){r||(r=!0,n.packet({type:me.ACK,id:t,data:a}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:me.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,t.data)}}}function Zr(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Zr.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};Zr.prototype.reset=function(){this.attempts=0};Zr.prototype.setMin=function(e){this.ms=e};Zr.prototype.setMax=function(e){this.max=e};Zr.prototype.setJitter=function(e){this.jitter=e};class uu extends Xe{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,io(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Zr({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const a=n.parser||Wx;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Ex(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const a=xn(n,"open",function(){r.onopen(),t&&t()}),i=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),t?t(c):this.maybeReconnectOnOpen()},l=xn(n,"error",i);if(this._timeout!==!1){const c=this._timeout,u=this.setTimeoutFn(()=>{a(),i(new Error("timeout")),n.close()},c);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(a),this.subs.push(l),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(xn(t,"ping",this.onping.bind(this)),xn(t,"data",this.ondata.bind(this)),xn(t,"error",this.onerror.bind(this)),xn(t,"close",this.onclose.bind(this)),xn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){ao(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new ym(this,t,n),this.nsps[t]=r),r}_destroy(t){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let r=0;r<n.length;r++)this.engine.write(n[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(a=>{a?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",a)):t.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Ea={};function vl(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=Ax(e,t.path||"/socket.io"),r=n.source,a=n.id,i=n.path,l=Ea[a]&&i in Ea[a].nsps,c=t.forceNew||t["force new connection"]||t.multiplex===!1||l;let u;return c?u=new uu(r,t):(Ea[a]||(Ea[a]=new uu(r,t)),u=Ea[a]),n.query&&!t.query&&(t.query=n.queryKey),u.socket(n.path,t)}Object.assign(vl,{Manager:uu,Socket:ym,io:vl,connect:vl});const qx="http://localhost:3000";function Gx(e){return vl(qx,{auth:{token:e}})}const jm=h.createContext(null);function Qx({children:e}){const[t,n]=h.useState([]),r=h.useRef(new Map),a=c=>{n(m=>m.filter(S=>S.id!==c));const u=r.current.get(c);u&&(clearTimeout(u),r.current.delete(c))},i=({message:c,type:u="success",actionLabel:m,onAction:S,duration:g=6e3})=>{const y=`${Date.now()}-${Math.random().toString(36).slice(2,8)}`;if(n(E=>[...E,{id:y,message:c,type:u,actionLabel:m,onAction:S,duration:g}]),g>0){const E=setTimeout(()=>a(y),g);r.current.set(y,E)}return y},l=c=>c==="error"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 4.5c.5 0 .95.26 1.2.68l6.5 11.25a1.35 1.35 0 0 1-1.2 2.02H5.5a1.35 1.35 0 0 1-1.2-2.02L10.8 5.18c.25-.42.7-.68 1.2-.68Zm0 4.25a.9.9 0 0 0-.9.9v5.5a.9.9 0 1 0 1.8 0v-5.5a.9.9 0 0 0-.9-.9Zm0 8.3a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Z",fill:"currentColor"})}):c==="info"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 3.5a8.5 8.5 0 1 1 0 17 8.5 8.5 0 0 1 0-17Zm0 3.9a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Zm-1.2 4.2h2.4v6.1h-2.4v-6.1Z",fill:"currentColor"})}):s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M9.5 16.6 5.6 12.7a1 1 0 1 1 1.4-1.4l2.5 2.5 7.5-7.5a1 1 0 1 1 1.4 1.4l-8.9 8.9a1 1 0 0 1-1.4 0Z",fill:"currentColor"})});return s.jsxs(jm.Provider,{value:{pushToast:i,removeToast:a},children:[e,s.jsx("div",{className:"toast-container",children:t.map(c=>s.jsxs("div",{className:`toast toast-${c.type}`,style:{"--toast-duration":`${c.duration}ms`},children:[s.jsx("div",{className:"toast-icon",children:l(c.type)}),s.jsx("div",{className:"toast-message",children:c.message}),c.actionLabel&&s.jsx("button",{className:"toast-action",type:"button",onClick:()=>{c.onAction&&Promise.resolve(c.onAction()).catch(()=>{}),a(c.id)},children:c.actionLabel}),s.jsx("button",{className:"toast-close",type:"button",onClick:()=>a(c.id),children:"x"}),c.duration>0&&s.jsx("div",{className:`toast-progress toast-progress-${c.type}`})]},c.id))})]})}function dd(){const e=h.useContext(jm);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function Kx({user:e,isOpen:t,onToggle:n,onLogout:r,onReturnToSuperadmin:a,showReturnToSuperadmin:i,getInitial:l}){return s.jsxs("div",{className:"rail-profile",children:[s.jsx("button",{className:`profile-button ${t?"active":""}`,type:"button",onClick:n,title:"Perfil","aria-label":"Perfil",children:s.jsx("span",{children:l(e.name)})}),t&&s.jsxs("div",{className:"profile-card",children:[s.jsx("div",{className:"profile-title",children:e.name}),s.jsx("div",{className:"profile-meta",children:e.email||"Sin correo"}),s.jsx("div",{className:"profile-role",children:e.role}),i?s.jsx("button",{className:"ghost",type:"button",onClick:a,children:"Volver a superadmin"}):null,s.jsx("button",{className:"primary",type:"button",onClick:r,children:"Salir"})]})]})}function Yx({navItems:e,view:t,onSetView:n,theme:r,onToggleTheme:a,user:i,logoUrl:l,brandName:c,isProfileOpen:u,onToggleProfile:m,onLogout:S,onReturnToSuperadmin:g,showReturnToSuperadmin:y,getInitial:E,SunIcon:O,MoonIcon:P}){const b=(c||"P").trim().charAt(0)||"P";return s.jsxs("aside",{className:"nav-rail",children:[s.jsx("button",{className:"rail-logo",type:"button",title:c||"Logo",children:l?s.jsx("img",{src:l,alt:c||"Logo"}):s.jsx("span",{className:"logo-mark",children:b})}),s.jsx("nav",{className:"rail-nav",children:e.map(f=>{const p=f.icon;return s.jsx("button",{className:`rail-button ${t===f.id?"active":""}`,onClick:()=>f.enabled&&n(f.id),title:f.label,"aria-label":f.label,type:"button",disabled:!f.enabled,children:s.jsx(p,{className:"rail-icon"})},f.id)})}),s.jsx("div",{className:"rail-spacer"}),s.jsx("button",{className:"rail-button",type:"button",onClick:a,title:r==="dark"?"Tema claro":"Tema oscuro","aria-label":r==="dark"?"Tema claro":"Tema oscuro",children:r==="dark"?s.jsx(O,{className:"rail-icon"}):s.jsx(P,{className:"rail-icon"})}),s.jsx(Kx,{user:i,isOpen:u,onToggle:m,onLogout:S,onReturnToSuperadmin:g,showReturnToSuperadmin:y,getInitial:E})]})}function Xx({activeConversation:e,conversations:t,channels:n,brandName:r,lastReadMap:a,filters:i,showFilters:l,users:c,tags:u,statusOptions:m,statusLabels:S,formatListTime:g,messageBlocks:y,messageDraft:E,messageMode:O,quickActions:P,tagInput:b,setTagInput:f,noteInput:p,notesList:v,latestNote:j,loadingConversation:R,isInfoOpen:$,hasUnread:A,scrollDayLabel:N,activeName:V,activePhone:I,activeStatusLabel:Y,canManageStatus:he,currentUser:fe,messageInputRef:Se,chatBodyRef:ke,setShowFilters:Ee,setFilters:Me,loadConversation:W,handleBackToList:te,setIsInfoOpen:Z,handleChatScroll:ce,handleAssignSelf:le,handleStatusChange:be,handleToggleTag:T,handleAddTag:q,setNoteInput:k,handleAddNote:U,reassignUserId:Q,setReassignUserId:B,handleReassignConversation:ne,handleOpenTagManager:ue,handleCloseTagManager:He,showTagManager:wt,tagManagerForm:Dt,setTagManagerForm:ve,handleCreateTag:qt,handleDeleteTag:Gt,handleQuickAction:_n,handleSendMessage:on,setMessageMode:Ge,setMessageDraft:Bt,scrollChatToBottom:cn,getInitial:Qt,PlusIcon:at,SearchIcon:un,VideoIcon:Je,PhoneIcon:ge,InfoIcon:_t,SendIcon:H}){const Oe=new Map((n||[]).map(L=>[L.phone_number_id,L.display_name||(L.phone_number_id?`Linea ${String(L.phone_number_id).slice(-4)}`:"")])),xe=new Map((c||[]).map(L=>[L.id,L])),Qe=(e==null?void 0:e.assigned_user_id)&&e.assigned_user_id!==(fe==null?void 0:fe.id);function Sn(L){if(!L)return"Sin mensajes";const Ae=L.last_message_preview||L.last_message_text||L.last_message||"";return Ae||(L.last_message_type?`[${L.last_message_type}]`:"Sin mensajes")}return s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:`chat-shell ${e?"has-active":""}`,children:[s.jsxs("aside",{className:"chat-list-panel",children:[s.jsxs("div",{className:"chat-list-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"list-title",children:(r||"Perzivalh").toUpperCase()}),s.jsx("div",{className:"list-subtitle",children:"Chats"})]}),s.jsx("button",{className:"icon-button add-chat",type:"button",title:"Nuevo chat",children:s.jsx(at,{className:"icon"})})]}),s.jsxs("div",{className:"chat-search ui-search",children:[s.jsx(un,{className:"search-icon ui-search-icon"}),s.jsx("input",{type:"text",placeholder:"Buscar pacientes o mensajes",value:i.search,onFocus:()=>Ee(!0),onClick:()=>Ee(!0),onChange:L=>Me(Ae=>({...Ae,search:L.target.value}))}),l&&s.jsx("button",{className:"search-close",type:"button",onClick:()=>Ee(!1),"aria-label":"Cerrar filtros",children:"x"})]}),l&&s.jsxs("div",{className:"chat-filters",children:[s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Status"}),s.jsxs("select",{value:i.status,onChange:L=>Me(Ae=>({...Ae,status:L.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),m.map(L=>s.jsx("option",{value:L,children:S[L]||L},L))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Asignado"}),s.jsxs("select",{value:i.assigned_user_id,onChange:L=>Me(Ae=>({...Ae,assigned_user_id:L.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"unassigned",children:"Sin asignar"}),c.map(L=>s.jsx("option",{value:L.id,children:L.name},L.id))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Tags"}),s.jsxs("select",{value:i.tag,onChange:L=>Me(Ae=>({...Ae,tag:L.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),u.map(L=>s.jsx("option",{value:L.name,children:L.name},L.id))]})]})]}),s.jsxs("div",{className:"list-header",children:[s.jsxs("select",{className:"line-filter",value:i.phone_number_id,onChange:L=>Me(Ae=>({...Ae,phone_number_id:L.target.value})),children:[s.jsx("option",{value:"",children:"Todas las lineas"}),(n||[]).map(L=>s.jsx("option",{value:L.phone_number_id,children:L.display_name||`Linea ${String(L.phone_number_id).slice(-4)}`},L.id))]}),s.jsx("span",{children:t.length})]}),s.jsx("div",{className:"conversation-list",children:t.map((L,Ae)=>{var dt,Ze,et,ss;const $s=(e==null?void 0:e.id)===L.id,kn=L.status==="pending"&&!L.assigned_user_id,Bn=L.display_name||L.phone_e164||L.wa_id||"Sin nombre",ns=Sn(L),bn=Number(L.unread_count||L.unread_messages||L.unread||0),zt=((Ze=(dt=L.tags)==null?void 0:dt[0])==null?void 0:Ze.name)||"",_=((et=L.assigned_user)==null?void 0:et.name)||((ss=xe.get(L.assigned_user_id||""))==null?void 0:ss.name)||"",F=_?`Tomada por ${_}`:"",G=L.phone_number_id?Oe.get(L.phone_number_id)||`Linea ${String(L.phone_number_id).slice(-4)}`:"",se=(a==null?void 0:a[L.id])||null,we=L.last_message_at,dn=we&&(!se||new Date(we).getTime()>new Date(se).getTime())&&L.last_message_direction==="in";return s.jsxs("button",{className:`conversation-item ${$s?"active":""}`,onClick:()=>W(L.id),style:{animationDelay:`${Math.min(Ae,6)*60}ms`},children:[s.jsxs("div",{className:"avatar",children:[s.jsx("span",{children:Qt(Bn)}),kn&&s.jsx("span",{className:"presence-dot"})]}),s.jsxs("div",{className:"conversation-body",children:[s.jsxs("div",{className:"conversation-row",children:[s.jsx("span",{className:"conversation-name",children:Bn}),s.jsxs("div",{className:"conversation-right",children:[s.jsx("span",{className:"conversation-time",children:g(L.last_message_at)}),bn>0&&s.jsx("span",{className:"conversation-unread",children:bn})]})]}),s.jsx("div",{className:`conversation-preview ${dn?"unread":""}`,children:ns}),s.jsxs("div",{className:"conversation-meta",children:[G&&s.jsx("span",{className:"status-pill line-pill",children:G}),F&&s.jsx("span",{className:"status-pill assignee-pill",children:F}),zt&&s.jsx("span",{className:"status-pill tag-pill",children:zt})]})]})]},L.id)})})]}),s.jsxs("div",{className:`chat-view ${$?"info-open":"info-closed"}`,children:[s.jsx("div",{className:"chat-main",children:s.jsxs("div",{className:"chat-card",children:[s.jsxs("header",{className:"chat-topbar",children:[s.jsxs("div",{className:"chat-title",children:[e&&s.jsx("button",{className:"back-button",type:"button",onClick:te,children:"Chats"}),s.jsx("div",{className:"chat-avatar",children:s.jsx("span",{children:Qt(V)})}),s.jsxs("div",{children:[s.jsx("div",{className:"chat-name",children:V}),e?s.jsx("div",{className:"chat-status",children:Y}):s.jsx("div",{className:"chat-status muted",children:"Elige una conversacion"})]})]}),s.jsxs("div",{className:"chat-actions",children:[s.jsx("button",{className:"icon-button",type:"button",title:"Video",children:s.jsx(Je,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Llamar",children:s.jsx(ge,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Buscar",children:s.jsx(un,{className:"icon"})}),s.jsx("button",{className:`icon-button ${$?"active":""}`,type:"button",title:"Info",onClick:()=>Z(L=>!L),children:s.jsx(_t,{className:"icon"})})]})]}),s.jsxs("div",{className:"chat-body",ref:ke,onScroll:ce,children:[N&&s.jsx("div",{className:"chat-day-sticky","aria-hidden":"true",children:N}),R&&s.jsx("div",{className:"empty",children:"Cargando..."}),!R&&!e&&s.jsx("div",{className:"empty",children:"Selecciona una conversacion"}),!R&&e&&s.jsx(s.Fragment,{children:y.length?y:s.jsx("div",{className:"empty-state",children:"Sin mensajes"})})]}),A&&s.jsx("button",{className:"new-message-banner",type:"button",onClick:cn,children:"Nuevos mensajes"}),s.jsxs("form",{className:"chat-composer",onSubmit:on,children:[Qe&&s.jsx("div",{className:"assign-warning",children:"Conversacion tomada por otro operador."}),P.length>0&&s.jsx("div",{className:"quick-actions",children:P.map(L=>s.jsx("button",{className:"quick-action",type:"button",onClick:()=>_n(L),disabled:Qe,children:L},L))}),s.jsxs("div",{className:"composer-row",children:[s.jsxs("select",{className:"message-mode",value:O,onChange:L=>Ge(L.target.value),disabled:Qe,children:[s.jsx("option",{value:"text",children:"WhatsApp"}),s.jsx("option",{value:"note",children:"Nota interna"})]}),s.jsx("input",{ref:Se,type:"text",placeholder:"Escribe un mensaje...",value:E,onChange:L=>Bt(L.target.value),disabled:Qe}),s.jsx("button",{className:"send-button",type:"submit",disabled:Qe,children:s.jsx(H,{className:"icon"})})]})]})]})}),s.jsxs("aside",{className:"chat-info",children:[s.jsxs("div",{className:"info-card",children:[s.jsx("div",{className:"info-avatar",children:s.jsx("span",{children:Qt(V)})}),s.jsx("div",{className:"info-name",children:V}),s.jsx("div",{className:"info-phone",children:I||"Sin telefono"})]}),s.jsxs("div",{className:"info-section",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("div",{className:"section-title",children:"Etiquetas"}),s.jsx("button",{className:"link-button",type:"button",onClick:ue,children:"Gestionar"})]}),s.jsx("div",{className:"tag-list",children:((e==null?void 0:e.tags)||[]).length?e.tags.map(L=>s.jsxs("span",{className:"tag-chip",children:[s.jsx("span",{className:"tag-chip-label",children:L.name}),s.jsx("button",{className:"tag-remove",type:"button",title:"Quitar etiqueta",onClick:()=>T(L.name),children:"x"})]},L.name)):s.jsx("div",{className:"empty-state",children:"Sin etiquetas"})}),s.jsxs("form",{className:"tag-form",onSubmit:q,children:[s.jsxs("select",{value:b,onChange:L=>f(L.target.value),children:[s.jsx("option",{value:"",children:"Selecciona etiqueta..."}),u.filter(L=>!((e==null?void 0:e.tags)||[]).some(Ae=>Ae.name===L.name)).map(L=>s.jsx("option",{value:L.name,children:L.name},L.id))]}),s.jsx("button",{className:"icon-button",type:"submit",title:"Agregar",children:s.jsx(at,{className:"icon"})})]})]}),s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Notas internas"}),v!=null&&v.length?s.jsx("div",{className:"notes-stack",children:v.slice(-5).map(L=>s.jsx("div",{className:"note-card",children:L.text},L.id))}):s.jsx("div",{className:"empty-state",children:"Sin notas internas"}),s.jsxs("form",{className:"note-form",onSubmit:U,children:[s.jsx("input",{type:"text",placeholder:"Agregar nota interna...",value:p,onChange:L=>k(L.target.value),disabled:!e}),s.jsx("button",{className:"icon-button",type:"submit",title:"Guardar nota",children:s.jsx(at,{className:"icon"})})]})]}),e&&s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Acciones"}),s.jsxs("div",{className:"action-stack",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:le,disabled:Qe,children:"Tomar conversacion"}),he&&s.jsxs("div",{className:"reassign-card",children:[s.jsxs("select",{value:Q,onChange:L=>B(L.target.value),children:[s.jsx("option",{value:"",children:"Reasignar a..."}),c.map(L=>s.jsx("option",{value:L.id,children:L.name},L.id))]}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:ne,disabled:!Q,children:"Reasignar"})]}),he&&s.jsxs("div",{className:"action-row",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>be("open"),children:"Reactivar bot"}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>be("pending"),children:"Liberar para otro operador"})]})]})]})]})]})]}),wt&&s.jsx("div",{className:"modal-overlay",onClick:He,children:s.jsxs("div",{className:"modal-card",onClick:L=>L.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Gestion de etiquetas"}),s.jsx("button",{className:"modal-close",type:"button",onClick:He,children:"x"})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("form",{className:"tag-manager-form",onSubmit:qt,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:Dt.name,onChange:L=>ve(Ae=>({...Ae,name:L.target.value})),placeholder:"Nombre de etiqueta"})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Color"}),s.jsx("input",{type:"color",value:Dt.color,onChange:L=>ve(Ae=>({...Ae,color:L.target.value}))})]}),s.jsx("div",{className:"modal-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Crear etiqueta"})})]}),s.jsx("div",{className:"tag-manager-list",children:(u||[]).map(L=>s.jsxs("div",{className:"tag-manager-row",children:[s.jsx("span",{className:"tag-chip",style:{borderColor:L.color||"#cbd5f5"},children:s.jsx("span",{className:"tag-chip-label",children:L.name})}),s.jsx("div",{className:"tag-manager-actions",children:s.jsx("button",{className:"danger soft",type:"button",onClick:()=>Gt(L.id,L.name),children:"Eliminar"})})]},L.id))})]})]})})]})}const bh=[{value:"24h",label:"ltimas 24h"},{value:"7d",label:"ltima semana"},{value:"30d",label:"ltimo mes"}];function Jx(e){const t=e?new Date(e):null;if(!t||Number.isNaN(t.getTime()))return"--";const n=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];return`${String(t.getDate()).padStart(2,"0")} ${n[t.getMonth()].toUpperCase()}`}function Ch(e){return e.length?e.map((t,n)=>`${n===0?"M":"L"}${t.x} ${t.y}`).join(" "):""}function Xi(e,t="%"){return e==null?null:e>0?`+${e}${t}`:`${e}${t}`}function Zx({metrics:e,channels:t,selectedPeriod:n,selectedChannel:r,onPeriodChange:a,onChannelChange:i,onRefresh:l,onGenerateReport:c,brandName:u}){var te,Z,ce,le,be,T,q,k,U,Q;const m=(u||"Empresa").trim(),S=m?`${m} Enterprise`:"Enterprise",g=((te=e==null?void 0:e.active_conversations)==null?void 0:te.value)??0,y=((Z=e==null?void 0:e.active_conversations)==null?void 0:Z.change)??null,E=(ce=e==null?void 0:e.avg_response_time)==null?void 0:ce.value,O=E?`${E.toFixed(1)}m`:"-",P=(le=e==null?void 0:e.avg_response_time)==null?void 0:le.change,b=((be=e==null?void 0:e.unique_contacts)==null?void 0:be.value)??0,f=((T=e==null?void 0:e.unique_contacts)==null?void 0:T.change)??null,v=`${(((q=e==null?void 0:e.conversion_rate)==null?void 0:q.value)??0).toFixed(1)}%`,j=((k=e==null?void 0:e.conversion_rate)==null?void 0:k.change)??null,R=((U=e==null?void 0:e.message_volume)==null?void 0:U.length)>0?e.message_volume.slice(-14):[],$=Math.max(...R.map(B=>B.in_count+B.out_count),1),A=Math.max(R.length*42+30,200),N=220,V=150,I=180,Y=R.map((B,ne)=>{const He=(B.in_count+B.out_count)/$*V,wt=B.in_count/$*V,Dt=B.out_count/$*V;return{x:22+ne*42,totalHeight:He,inHeight:wt,outHeight:Dt}}),he=Ch(Y.map((B,ne)=>({x:B.x+10,y:I-B.inHeight}))),fe=Ch(Y.map(B=>({x:B.x+10,y:I-B.outHeight}))),Se=R.length>0?Array.from(new Set([0,Math.floor(R.length/3),Math.floor(2*R.length/3),R.length-1])):[],ke=(e==null?void 0:e.operators)??[],Ee=Math.round((e==null?void 0:e.team_efficiency)??0),Me=(e==null?void 0:e.daily_goal)??500,W=(e==null?void 0:e.resolved_today)??0;return s.jsxs("section",{className:"dashboard-layout",children:[s.jsxs("div",{className:"dashboard-main",children:[s.jsxs("header",{className:"dashboard-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dashboard-kicker",children:S}),s.jsx("h2",{className:"dashboard-title",children:"Dashboard"}),s.jsx("div",{className:"dashboard-subtitle",children:"Marketing Analytics & WhatsApp CRM Overview"})]}),s.jsxs("div",{className:"dashboard-actions",children:[s.jsxs("select",{className:"dash-filter",value:r||"",onChange:B=>i(B.target.value||null),children:[s.jsx("option",{value:"",children:"Todas las lneas"}),(t||[]).map(B=>s.jsx("option",{value:B.phone_number_id,children:B.display_name||B.phone_number_id},B.phone_number_id))]}),s.jsx("select",{className:"dash-filter",value:n||"30d",onChange:B=>a(B.target.value),children:bh.map(B=>s.jsx("option",{value:B.value,children:B.label},B.value))}),s.jsx("button",{className:"primary",type:"button",onClick:c,children:"Generar Reporte"})]})]}),s.jsxs("div",{className:"dashboard-kpis",children:[s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Conversaciones activas"}),s.jsx("div",{className:"dash-kpi-value",children:g.toLocaleString()})]}),s.jsx("div",{className:"dash-kpi-icon",children:"C"})]}),y!==null&&s.jsx("div",{className:`dash-kpi-change ${y>=0?"up":"down"}`,children:Xi(y)})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tiempo de respuesta"}),s.jsx("div",{className:"dash-kpi-value",children:O})]}),s.jsx("div",{className:"dash-kpi-icon",children:"T"})]}),P!==null&&s.jsx("div",{className:`dash-kpi-change ${P<=0?"up":"down"}`,children:Xi(P,"m")})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Contactos nicos"}),s.jsx("div",{className:"dash-kpi-value",children:b.toLocaleString()})]}),s.jsx("div",{className:"dash-kpi-icon",children:"#"})]}),f!==null&&s.jsx("div",{className:`dash-kpi-change ${f>=0?"up":"down"}`,children:Xi(f)})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tasa de conversin"}),s.jsx("div",{className:"dash-kpi-value",children:v})]}),s.jsx("div",{className:"dash-kpi-icon",children:"%"})]}),j!==null&&s.jsx("div",{className:`dash-kpi-change ${j>=0?"up":"down"}`,children:Xi(j)})]})]}),s.jsxs("div",{className:"dash-card dash-chart-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-card-title",children:"Flujo de Mensajes"}),s.jsx("div",{className:"dash-card-subtitle",children:"Volumen diario"})]}),s.jsxs("div",{className:"dash-legend",children:[s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot in"})," Entrantes"]}),s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot out"})," Salientes"]})]})]}),R.length>0?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"dash-chart",children:s.jsxs("svg",{className:"dash-chart-svg",viewBox:`0 0 ${A} ${N}`,preserveAspectRatio:"none",children:[s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"60",x2:A,y2:"60"}),s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"120",x2:A,y2:"120"}),Y.map((B,ne)=>s.jsxs("g",{children:[s.jsx("rect",{className:"dash-bar in",x:B.x,y:I-B.inHeight,width:"20",height:B.inHeight,rx:"6"}),s.jsx("rect",{className:"dash-bar out",x:B.x,y:I-B.inHeight-B.outHeight,width:"20",height:B.outHeight,rx:"6"})]},`bar-${ne}`)),s.jsx("path",{className:"dash-line in",d:he}),s.jsx("path",{className:"dash-line out",d:fe})]})}),s.jsx("div",{className:"dash-chart-labels",children:Se.map(B=>{var ne;return s.jsx("span",{children:Jx((ne=R[B])==null?void 0:ne.day)},`label-${B}`)})})]}):s.jsx("div",{className:"empty-state",children:"Sin datos para el periodo seleccionado"})]})]}),s.jsxs("aside",{className:"dashboard-side",children:[s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Performance de Operadores"}),s.jsxs("div",{className:"dash-card-subtitle",children:["Top 10 - ",((Q=bh.find(B=>B.value===n))==null?void 0:Q.label)||"ltimo mes"]}),s.jsx("div",{className:"dash-operator-list",children:ke.length>0?ke.map((B,ne)=>{var ue;return s.jsxs("div",{className:"dash-operator",children:[s.jsx("div",{className:"dash-operator-avatar",children:((ue=B.name)==null?void 0:ue[0])||"?"}),s.jsxs("div",{className:"dash-operator-meta",children:[s.jsx("div",{className:"dash-operator-name",children:B.name}),s.jsx("div",{className:"dash-operator-role",children:B.role}),s.jsxs("div",{className:"dash-operator-stats",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Resueltos"}),s.jsx("div",{className:"dash-stat-value",children:B.resolved})]}),s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Pendientes"}),s.jsx("div",{className:"dash-stat-value danger",children:B.pending})]})]})]})]},B.id||`op-${ne}`)}):s.jsx("div",{className:"empty-state",children:"Sin operadores activos"})})]}),s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Eficiencia de Equipo"}),s.jsxs("div",{className:"dash-efficiency",children:[s.jsxs("div",{className:"dash-efficiency-value",children:[Ee,"%"]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:`${Ee}%`}})}),s.jsxs("div",{className:"dash-muted",children:[W," resueltas - Objetivo: ",Me]})]})]})]})]})}const Eh={draft:"BORRADOR",scheduled:"PROGRAMADA",running:"ENVIANDO",sending:"ENVIANDO",completed:"FINALIZADA",sent:"FINALIZADA",paused:"PAUSADA",failed:"ERROR"},Ji={APPROVED:{label:"APROBADA",className:"approved"},PENDING:{label:"PENDIENTE",className:"pending"},REJECTED:{label:"RECHAZADA",className:"rejected"},DRAFT:{label:"BORRADOR",className:"draft"},PAUSED:{label:"PAUSADA",className:"pending"},DISABLED:{label:"DESHABILITADA",className:"draft"}},Ah={MARKETING:"MARKETING",UTILITY:"UTILIDAD",AUTHENTICATION:"AUTENTICACION"},Zi=[{id:"audiences",label:"Audiencias",title:"Audiencias",subtitle:"MDULO DE GESTIN Y CAMPAAS"},{id:"templates",label:"Biblioteca de Plantillas",title:"Biblioteca de Plantillas",subtitle:"Consulta y gestiona las plantillas de mensajes autorizadas por WhatsApp."},{id:"new",label:"Campaas",title:"Campaas",subtitle:"Historial de envos y difusin WhatsApp"}],ey={audiencias:"audiences",audiences:"audiences",templates:"templates",plantillas:"templates",biblioteca:"templates",nueva:"new",campaign:"new",campaigns:"new",nueva_campana:"new",history:"new",historial:"new"},Th=[{id:"dynamic",label:"Audiencias Dinmicas",title:"Automatizacin de Audiencias y Tags",subtitle:"Unificacin de flujos de datos Perzivalh CRM",actionLabel:"Guardar Configuracin"},{id:"excel",label:"Importar Excel",title:"Importacin de Contactos Excel",subtitle:"Gestin de base de datos externa Perzivalh CRM",actionLabel:"Iniciar Importacin"},{id:"odoo",label:"Importar de Odoo",title:"Sincronizacin Inteligente Odoo",subtitle:"Automatizacin de audiencias Perzivalh OS",actionLabel:"Actualizar Lista Odoo"}],ty=[{value:"phone",label:"Telfono"},{value:"name",label:"Nombre Completo"},{value:"city",label:"Ciudad"},{value:"tags",label:"Etiquetas"},{value:"ignore",label:"Sin Mapear"}];function ny({campaignForm:e,setCampaignForm:t,campaignFilter:n,setCampaignFilter:r,templates:a,campaigns:i,selectedCampaignId:l,campaignMessages:c,users:u,tags:m,channels:S,selectedTemplate:g,statusOptions:y,onCreateCampaign:E,onLoadCampaigns:O,onLoadCampaignMessages:P,onSendCampaign:b,onUpdateCampaign:f,onDeleteCampaign:p,onResendCampaign:v,campaignsTotal:j,formatDate:R,brandName:$}){var Ai,Ti,Li;const A=($||"Perzivalh").trim(),[N,V]=h.useState(""),[I,Y]=h.useState("all"),[he,fe]=h.useState(!1),[Se,ke]=h.useState(null),[Ee,Me]=h.useState(""),[W,te]=h.useState(!1),[Z,ce]=h.useState(""),[le,be]=h.useState("all"),[T,q]=h.useState(!1),[k,U]=h.useState(null),[Q,B]=h.useState(""),[ne,ue]=h.useState(null),[He,wt]=h.useState("down"),[Dt,ve]=h.useState(null),[qt,Gt]=h.useState(!1),[_n,on]=h.useState(!1),[Ge,Bt]=h.useState({id:"",name:"",phone:"",email:"",vat:""}),[cn,Qt]=h.useState(e.send_now===!1||e.scheduled_for?"schedule":"now"),[at,un]=h.useState(1),[Je]=h.useState(6),{pushToast:ge}=dd(),_t=h.useRef(null),[H,Oe]=h.useState(!1),[xe,Qe]=h.useState("dynamic"),Sn=h.useMemo(()=>Th.map(o=>({...o,subtitle:o.subtitle.replace(/Perzivalh/g,A)})),[A]),[L,Ae]=h.useState({enabled:!1,phone_number_id:null}),[$s,kn]=h.useState(!1),[Bn,ns]=h.useState([]),[bn,zt]=h.useState(!1),[_,F]=h.useState(!1),[G,se]=h.useState(""),[we,dn]=h.useState(null),[dt,Ze]=h.useState(""),[et,ss]=h.useState(null),[ea,rs]=h.useState([]),[re,oe]=h.useState({targetMode:"new",listName:"",targetSegmentId:"",prefix:"",ignoreDuplicates:!0}),[hn,zn]=h.useState(null),[Us,as]=h.useState(!1),[ta,Vs]=h.useState({connected:!1}),[fi,$n]=h.useState(!1),[na,Cn]=h.useState(!1),[is,ls]=h.useState(null),[Re,pi]=h.useState(()=>{if(typeof window>"u")return"templates";const x=new URLSearchParams(window.location.search).get("tab");return x?ey[x]||x:"templates"}),[mr,lo]=h.useState(null),[En,sa]=h.useState(null),[os,cs]=h.useState([]),[ra,aa]=h.useState(0),[mi,oo]=h.useState(!1),[us,hd]=h.useState(""),[Fs,ht]=h.useState(new Set),[ia,Ke]=h.useState(""),[Ws,la]=h.useState(!1),[it,tt]=h.useState(1),[Un]=h.useState(10),[St,oa]=h.useState({tag:"Todas",date:"Cualquier fecha",status:"Activos"}),[vi,ca]=h.useState(null),ua=h.useRef(null),Kt=h.useMemo(()=>(S||[]).filter(o=>o==null?void 0:o.phone_number_id),[S]),[fn,Hs]=h.useState(""),ye=h.useMemo(()=>Kt.find(o=>o.phone_number_id===fn)||Kt[0]||null,[Kt,fn]),ds=(ye==null?void 0:ye.display_name)||(ye==null?void 0:ye.phone_number_id)||"";h.useEffect(()=>{const o=e.send_now===!1||e.scheduled_for?"schedule":"now";Qt(o)},[e.send_now,e.scheduled_for]);const[qs,da]=h.useState([]);h.useEffect(()=>{Tt(),gi()},[]),h.useEffect(()=>{!fn&&Kt.length&&Hs(Kt[0].phone_number_id)},[Kt,fn]),h.useEffect(()=>{H&&(co(),vr(),Gs())},[H,fn]),h.useEffect(()=>{if(Re!=="new"||T)return;const o=setTimeout(()=>{un(1),O(1,Je,Z.trim())},350);return()=>clearTimeout(o)},[Z,Je,T,Re,O]),h.useEffect(()=>{!H||xe!=="odoo"||Gs()},[xe,H]),h.useEffect(()=>{Zi.find(o=>o.id===Re)||pi("templates")},[Re]),h.useEffect(()=>{if(typeof window>"u")return;const o=new URLSearchParams(window.location.search);o.set("tab",Re);const x=`${window.location.pathname}?${o.toString()}`;window.history.replaceState({},"",x)},[Re]);async function Tt(){try{const o=await je("/api/audiences?with_counts=true");o&&o.segments&&da(o.segments)}catch(o){console.error("Failed to load segments",o)}}async function gi(){try{const o=await je("/api/contacts/stats");lo(o||null)}catch(o){console.error("Failed to load Odoo stats",o),lo(null)}}async function co(){kn(!0);try{const o=ye!=null&&ye.phone_number_id?`?phone_number_id=${encodeURIComponent(ye.phone_number_id)}`:"",x=await je(`/api/audiences/automation-settings${o}`);Ae((x==null?void 0:x.settings)||{enabled:!1,phone_number_id:null})}catch(o){console.error("Failed to load automation settings",o)}finally{kn(!1)}}async function vr(){zt(!0);try{const o=new URLSearchParams;ye!=null&&ye.phone_number_id&&o.set("phone_number_id",ye.phone_number_id),ds&&o.set("line_name",ds);const x=o.toString(),D=await je(`/api/audiences/dynamic-tags${x?`?${x}`:""}`);ns((D==null?void 0:D.items)||[])}catch(o){console.error("Failed to load dynamic audiences",o)}finally{zt(!1)}}async function ha(o=L.enabled){try{const x=await Te("/api/audiences/automation-settings",{enabled:o,phone_number_id:(ye==null?void 0:ye.phone_number_id)||null,line_name:ds||null});Ae((x==null?void 0:x.settings)||{...L,enabled:o}),ge({message:"Configuracin guardada"})}catch(x){ge({type:"error",message:x.message||"No se pudo guardar"})}}async function xi(o){Ae(x=>({...x,enabled:o})),await ha(o)}async function uo(){F(!0);try{await Te("/api/audiences/sync-historical",{phone_number_id:(ye==null?void 0:ye.phone_number_id)||null,line_name:ds||null}),await vr(),await Tt(),ge({message:"Sincronizacin completa"})}catch(o){ge({type:"error",message:o.message||"Error al sincronizar"})}finally{F(!1)}}async function yi(){const o=G.trim();if(o)try{await Te("/api/audiences/dynamic-tags",{name:o,phone_number_id:(ye==null?void 0:ye.phone_number_id)||null,line_name:ds||null}),se(""),await vr(),await Tt(),ge({message:"Etiqueta creada correctamente"})}catch(x){ge({type:"error",message:x.message||"No se pudo crear etiqueta"})}}async function Gs(){$n(!0);try{const o=await je("/api/contacts/odoo-status");Vs(o||{connected:!1})}catch(o){console.error("Failed to load Odoo status",o),Vs({connected:!1})}finally{$n(!1)}}async function ji(){Cn(!0),ls(null);try{const o=await Te("/api/contacts/refresh-odoo",{});ls(o||null),await gi(),ge({message:"Lista Odoo actualizada"})}catch(o){ge({type:"error",message:o.message||"Error al actualizar Odoo"})}finally{Cn(!1)}}async function ho(o){return new Promise((x,D)=>{const K=new FileReader;K.onload=()=>{const pe=(K.result||"").toString().split(",")[1]||"";x(pe)},K.onerror=()=>D(K.error),K.readAsDataURL(o)})}async function fa(o){var D;const x=(D=o.target.files)==null?void 0:D[0];if(x){dn(x),zn(null);try{const K=await ho(x);Ze(K);const ee=await Te("/api/audiences/import-preview",{file_base64:K,filename:x.name});ss(ee),rs((ee==null?void 0:ee.mapping)||[])}catch(K){ss(null),rs([]),ge({type:"error",message:K.message||"No se pudo leer el archivo"})}}}function pn(){dn(null),Ze(""),ss(null),rs([]),zn(null)}async function fo(){if(!we||!dt){ge({type:"error",message:"Selecciona un archivo vlido"});return}as(!0);try{const o={file_base64:dt,filename:we.name,mapping:ea,options:{baseTagName:re.listName,targetSegmentId:re.targetMode==="existing"?re.targetSegmentId:"",prefix:re.prefix,ignoreDuplicates:re.ignoreDuplicates,phoneNumberId:(ye==null?void 0:ye.phone_number_id)||null}},x=await Te("/api/audiences/import-excel",o);zn(x),await Tt(),await vr(),ge({message:"Importacin completada"})}catch(o){ge({type:"error",message:o.message||"Error al importar"})}finally{as(!1)}}async function Qs(o,x={}){if(!o){cs([]),aa(0);return}const D=x.page||1,K=x.search||"";oo(!0);try{if(o.type==="odoo"){const Fn=(D-1)*Un,Tn=await je(`/api/contacts?search=${encodeURIComponent(K)}&offset=${Fn}&limit=${Un}`);let Xt=(Tn==null?void 0:Tn.contacts)||[];St.tag!=="Todas"&&(Xt=Xt.filter(Wn=>{const Jt=Wn.tags_json||[];return St.tag==="Con etiquetas"?Array.isArray(Jt)&&Jt.length>0:St.tag==="Sin etiquetas"?!Array.isArray(Jt)||Jt.length===0:!0})),St.status!=="Activos"&&(Xt=Xt.filter(Wn=>{const Jt=(Wn.status||"ACTIVO").toUpperCase();return St.status==="Activos"?Jt==="ACTIVO":Jt!=="ACTIVO"})),cs(Xt),aa((Tn==null?void 0:Tn.total)||Xt.length);return}const ee=K?1e3:200,pe=await je(`/api/audiences/${o.id}/preview?limit=${ee}`),nt=(pe==null?void 0:pe.recipients)||[],Lt=K.trim().toLowerCase();let Yt=Lt?nt.filter(Fn=>{var Wn,Jt;const Tn=((Wn=Fn.name)==null?void 0:Wn.toLowerCase())||"",Xt=((Jt=Fn.phone_e164)==null?void 0:Jt.toLowerCase())||"";return Tn.includes(Lt)||Xt.includes(Lt)}):nt;St.tag==="Sin etiquetas"&&(Yt=Yt.filter(Fn=>!Fn.tags||Fn.tags.length===0));const jr=Lt?Yt.length:(pe==null?void 0:pe.total)||Yt.length,Nr=(D-1)*Un,Oo=Yt.slice(Nr,Nr+Un);cs(Oo),aa(jr)}catch(ee){console.error("Failed to load audience contacts",ee),cs([]),aa(0)}finally{oo(!1)}}function po(o){sa((o==null?void 0:o.id)||null),tt(1),ht(new Set),Ke("")}async function mo(){try{await Te("/api/audiences/refresh-counts",{}),await Tt(),lt&&await Qs(lt,{page:it,search:us}),ge({message:"Conteos actualizados"})}catch(o){ge({type:"error",message:o.message||"No se pudo actualizar"})}}async function vo(o){if(!(!o||o.type==="odoo"||o.isDefault||!window.confirm(`Eliminar la audiencia "${o.name}"? Esta accin la desactiva y no borra contactos.`)))try{await ks(`/api/audiences/${o.id}`),await Tt(),En===o.id&&sa(null),ca(null),ge({message:"Audiencia eliminada"})}catch(D){ge({type:"error",message:D.message||"No se pudo eliminar"})}}async function gr(o){if(!o||o.type==="odoo"||o.isDefault)return;const x=window.prompt("Nuevo nombre de la audiencia:",o.name);if(!(!x||!x.trim()))try{await Ul(`/api/audiences/${o.id}`,{name:x.trim()}),await Tt(),ca(null),ge({message:"Audiencia renombrada"})}catch(D){ge({type:"error",message:D.message||"No se pudo renombrar"})}}function pa(o,x){oa(D=>{const K=D[o],ee=x.indexOf(K),pe=x[(ee+1)%x.length];return{...D,[o]:pe}})}function go(){if(xe==="dynamic"){ha();return}if(xe==="excel"){fo();return}xe==="odoo"&&ji()}const ft=h.useMemo(()=>{const o={id:"odoo",name:"odoo",subtitle:"Origen: Odoo",count:(mr==null?void 0:mr.total)||0,type:"odoo"},x=qs.map(D=>{var K;return{id:D.id,name:D.name,subtitle:D.description||"Segmento personalizado",count:D.estimated_count||0,type:"segment",isDefault:(D.name||"").toUpperCase().startsWith("DEFAULT"),rules:D.rules_json,tagName:Array.isArray(D.rules_json)&&((K=D.rules_json.find(ee=>(ee.type||ee.field)==="tag"&&ee.value))==null?void 0:K.value)||""}});return[o,...x]},[qs,mr]),Ni=h.useMemo(()=>{const o=Ee.trim().toLowerCase();return o?ft.filter(x=>{var ee,pe;const D=((ee=x.name)==null?void 0:ee.toLowerCase())||"",K=((pe=x.subtitle)==null?void 0:pe.toLowerCase())||"";return D.includes(o)||K.includes(o)}):ft},[ft,Ee]),lt=h.useMemo(()=>ft.find(o=>o.id===En),[ft,En]),ma=o=>{const x=(o==null?void 0:o.buttons_json)??(o==null?void 0:o.buttons)??[];if(Array.isArray(x))return x;if(typeof x=="string")try{const D=JSON.parse(x);return Array.isArray(D)?D:[]}catch{return[]}return[]},wi=h.useMemo(()=>ma(g),[g]),_i=h.useMemo(()=>ma(Se),[Se]),Ks=h.useMemo(()=>Math.max(1,Math.ceil(ra/Un)),[ra,Un]),hs=h.useMemo(()=>{const o=[],x=Math.max(1,it-1),D=Math.min(Ks,x+2);for(let K=x;K<=D;K+=1)o.push(K);return o},[it,Ks]),Ys=o=>o==="sent"?"completed":o==="sending"?"running":o||"",Xs=h.useMemo(()=>{const o={all:i.length,completed:0,scheduled:0,draft:0,failed:0,running:0};return i.forEach(x=>{const D=Ys(x.status);D==="completed"&&(o.completed+=1),D==="scheduled"&&(o.scheduled+=1),D==="draft"&&(o.draft+=1),D==="failed"&&(o.failed+=1),D==="running"&&(o.running+=1)}),o},[i]),xr=h.useMemo(()=>{const o=Z.trim().toLowerCase();return i.filter(x=>{const D=!o||(x.name||"").toLowerCase().includes(o),K=Ys(x.status);return D&&(le==="all"||K===le)})},[i,Z,le]),fs=h.useMemo(()=>{const o=[],x=j||i.length,D=Math.max(1,Math.ceil(x/Je)),K=Math.max(1,at-1),ee=Math.min(D,K+2);for(let pe=K;pe<=ee;pe+=1)o.push(pe);return{pages:o,totalPages:D}},[j,i.length,at,Je]);h.useEffect(()=>{Re==="audiences"&&!En&&ft.length&&sa(ft[0].id)},[ft,Re,En]),h.useEffect(()=>{Re!=="new"&&T&&(q(!1),U(null),xa())},[Re,T]),h.useEffect(()=>{if(Re!=="audiences")return;const o=setTimeout(()=>{Qs(lt,{page:it,search:us})},300);return()=>clearTimeout(o)},[En,it,us,Re,lt,St]),h.useEffect(()=>{ht(new Set),Ke("")},[En]);const Js=h.useMemo(()=>os.filter(o=>o.conversation_id||o.conversationId),[os]),Vn=h.useMemo(()=>{const o=new Map(os.map(x=>[x.conversation_id||x.conversationId||"",x]));return Array.from(Fs).map(x=>o.get(x)).filter(Boolean)},[os,Fs]),ps=(lt==null?void 0:lt.tagName)||"",Si=h.useMemo(()=>ft.filter(o=>o.tagName),[ft]),va=Si.find(o=>o.id===ia),An=(va==null?void 0:va.tagName)||"";h.useEffect(()=>{if(!ua.current)return;const o=Js.length,x=Fs.size;ua.current.indeterminate=x>0&&x<o},[Js.length,Fs]);function xo(o){if(!o){ht(new Set);return}const x=new Set(Js.map(D=>D.conversation_id||D.conversationId||""));ht(x)}function yo(o){const x=o.conversation_id||o.conversationId||"";x&&ht(D=>{const K=new Set(D);return K.has(x)?K.delete(x):K.add(x),K})}async function ga(o){if(!Vn.length||Ws)return;if((o==="add"||o==="move")&&!An){ge({type:"error",message:"Selecciona una audiencia destino vlida."});return}if((o==="remove"||o==="move")&&!ps){ge({type:"error",message:"La audiencia actual no permite quitar contactos."});return}if(An&&An===ps&&o!=="remove"){ge({type:"error",message:"La audiencia destino debe ser diferente a la actual."});return}const D=Vn.map(ee=>({contact:ee,conversationId:ee.conversation_id||ee.conversationId||""})).filter(ee=>ee.conversationId),K=Vn.length-D.length;if(!D.length){ge({type:"error",message:"No hay contactos compatibles para esta accin."});return}la(!0);try{await Promise.all(D.map(({conversationId:ee})=>Te(`/api/conversations/${ee}/tags`,{add:o==="add"||o==="move"?[An]:[],remove:o==="remove"||o==="move"?[ps]:[]}))),K&&ge({type:"error",message:`${K} contacto(s) no se pudieron actualizar.`}),ht(new Set),Ke(""),await Tt(),await Qs(lt,{page:it,search:us}),ge({message:"Cambios aplicados correctamente."})}catch(ee){ge({type:"error",message:ee.message||"No se pudo actualizar."})}finally{la(!1)}}const jo=h.useMemo(()=>{const o=new Set;return(a||[]).forEach(x=>{x.category&&o.add(x.category)}),Array.from(o)},[a]),ki=h.useMemo(()=>{const o=N.trim().toLowerCase(),x=I==="all"?"":I.toLowerCase();return(a||[]).filter(D=>{var Lt,Yt;const K=((Lt=D.name)==null?void 0:Lt.toLowerCase())||"",ee=((Yt=D.category)==null?void 0:Yt.toLowerCase())||"";return(!o||K.includes(o)||ee.includes(o))&&(!x||ee===x)})},[N,I,a]),bi=h.useMemo(()=>{const o=Q.trim().toLowerCase();return(a||[]).filter(x=>{var K;const D=((K=x.name)==null?void 0:K.toLowerCase())||"";return!o||D.includes(o)})},[Q,a]),ms=h.useMemo(()=>n.segment_id?ft.find(o=>o.id===n.segment_id)||null:n.tag&&ft.find(o=>o.name===n.tag)||null,[ft,n.segment_id,n.tag]),No=h.useMemo(()=>n.segment_id?`segment:${n.segment_id}`:n.tag?`tag:${n.tag}`:n.assigned_user_id?`assigned:${n.assigned_user_id}`:n.status?`status:${n.status}`:n.verified_only?"verified":"",[n.segment_id,n.tag,n.assigned_user_id,n.status,n.verified_only]);function vs(o){r(x=>{const D={...x,status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""};if(o.startsWith("segment:")){const K=o.slice(8),ee=ft.find(pe=>pe.id===K);D.segment_id=K,D.segment_name=(ee==null?void 0:ee.name)||""}else o.startsWith("tag:")?D.tag=o.slice(4):o.startsWith("status:")?D.status=o.slice(7):o.startsWith("assigned:")?D.assigned_user_id=o.slice(9):o==="verified"&&(D.verified_only=!0);return D})}function yr(o){if(!o)return"";const x=new Date(o);if(Number.isNaN(x.getTime()))return"";const D=K=>String(K).padStart(2,"0");return`${x.getFullYear()}-${D(x.getMonth()+1)}-${D(x.getDate())}T${D(x.getHours())}:${D(x.getMinutes())}`}function wo(o){t(x=>({...x,template_id:o}))}function xa(){t({name:"",template_id:"",scheduled_for:"",send_now:!0}),r({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),B("")}function _o(o){var ee;if(!o)return;U(o),q(!0),B(""),t(pe=>{var nt;return{...pe,name:o.name||"",template_id:o.template_id||((nt=o.template)==null?void 0:nt.id)||"",scheduled_for:yr(o.scheduled_for||o.scheduled_at),send_now:!(o.scheduled_for||o.scheduled_at)}});const x=o.audience_filter||{},D=x.segment_id||o.segment_id||"",K=x.segment_name||((ee=o.segment)==null?void 0:ee.name)||"";r(pe=>({...pe,status:x.status||"",tag:x.tag||"",assigned_user_id:x.assigned_user_id||"",verified_only:!!x.verified_only,segment_id:D,segment_name:K}))}function So(o){!(o!=null&&o.id)||!p||!window.confirm(`Eliminar la campaa "${o.name}"?`)||p(o.id)}function Zs(o){!(o!=null&&o.id)||!v||!window.confirm(`Reenviar la campaa "${o.name}"?`)||v(o.id)}function ko(o,x){if(ue(D=>D===o?null:o),x!=null&&x.currentTarget&&typeof window<"u"){const D=x.currentTarget.getBoundingClientRect(),K=window.innerHeight-D.bottom,ee=D.top,pe=K<180&&ee>K;wt(pe?"up":"down")}}function bo(o){ve(x=>x===o?null:o)}function Co(o){o!=null&&o.id&&(Bt({id:o.id,name:o.name||"",phone:o.phone_e164||o.phone||"",email:o.email||"",vat:o.vat||""}),Gt(!0),ve(null))}async function Eo(o){if(o.preventDefault(),!!Ge.id){on(!0);try{const x=await Ul(`/api/contacts/${Ge.id}`,{name:Ge.name,phone:Ge.phone,email:Ge.email,vat:Ge.vat});x!=null&&x.contact&&cs(D=>D.map(K=>K.id===x.contact.id?x.contact:K)),Gt(!1),ge({message:"Contacto actualizado"}),await Qs(lt,{page:it,search:us})}catch(x){ge({type:"error",message:x.message||"No se pudo actualizar"})}finally{on(!1)}}}async function ya(o){if(!(!(o!=null&&o.id)||!window.confirm(`Eliminar el contacto "${o.name||o.phone_e164||"Sin nombre"}"?`)))try{await ks(`/api/contacts/${o.id}`),cs(D=>D.filter(K=>K.id!==o.id)),ve(null),ge({message:"Contacto eliminado"}),await Qs(lt,{page:it,search:us})}catch(D){ge({type:"error",message:D.message||"No se pudo eliminar"})}}function Ao(o){if(o.preventDefault(),!e.name.trim()||!e.template_id)return;const x={};if(n.status&&(x.status=n.status),n.tag&&(x.tag=n.tag.trim()),n.assigned_user_id&&(x.assigned_user_id=n.assigned_user_id),n.verified_only&&(x.verified_only=!0),n.segment_id&&(x.segment_id=n.segment_id,n.segment_name&&(x.segment_name=n.segment_name)),k&&f){f(k.id,{name:e.name.trim(),template_id:e.template_id,segment_id:n.segment_id||null,audience_filter:x,scheduled_for:e.scheduled_for||null}),q(!1),U(null),xa();return}E(o)}function To(o){ke(o),fe(!0)}const Lo=Zi.find(o=>o.id===Re)||Zi[1],Ro={title:"Campaas",subtitle:"CONFIGURACIN DE NUEVO ENVO MASIVO"},Ci=Sn.find(o=>o.id===xe)||Sn[0],Ei=H?Ci:Re==="new"&&T?Ro:Lo;return s.jsxs("section",{className:"campaigns-page",children:[s.jsxs("div",{className:"campaigns-shell",children:[s.jsxs("header",{className:"campaigns-header",children:[s.jsxs("div",{className:"campaigns-title-block",children:[s.jsxs("div",{className:"campaigns-title-row",children:[H&&s.jsx("button",{className:"campaigns-back",type:"button",onClick:()=>Oe(!1),"aria-label":"Volver",children:"<"}),s.jsx("span",{className:"campaigns-heading",children:Ei.title})]}),s.jsx("div",{className:`campaigns-subtitle ${H?"campaigns-subtitle--upper":""}`,children:Ei.subtitle})]}),s.jsxs("div",{className:"campaigns-actions",children:[H&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>Oe(!1),children:xe==="excel"?"Cancelar":"Descartar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:go,disabled:xe==="excel"&&(Us||!dt||re.targetMode==="new"&&!re.listName.trim()||re.targetMode==="existing"&&!re.targetSegmentId)||xe==="odoo"&&na,children:Ci.actionLabel})]}),!H&&Re==="audiences"&&s.jsxs("button",{className:"campaigns-primary campaigns-primary--dropdown",type:"button",onClick:()=>{Oe(!0),Qe("dynamic")},children:[s.jsx("span",{className:"campaigns-primary-icon",children:"+"}),"Nueva Audiencia"]}),!H&&Re==="new"&&s.jsx(s.Fragment,{children:T?s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>{q(!1),U(null),xa()},children:"Cancelar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>{var o,x;return(x=(o=_t.current)==null?void 0:o.requestSubmit)==null?void 0:x.call(o)},children:k?"Guardar cambios":"Lanzar Campaa"})]}):s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>q(!0),children:"+ Lanzar Campaa"})})]})]}),!H&&s.jsx("nav",{className:"campaigns-tabs",role:"tablist","aria-label":"Secciones de Campaas",children:Zi.map(o=>s.jsx("button",{type:"button",role:"tab","aria-selected":Re===o.id,className:`campaigns-tab ${Re===o.id?"active":""}`,onClick:()=>pi(o.id),children:o.label},o.id))}),s.jsx("div",{className:"campaigns-tab-panel",children:H?s.jsxs("section",{className:"audience-flow",children:[s.jsx("nav",{className:"audience-flow-tabs",role:"tablist","aria-label":"Flujo de nueva audiencia",children:Th.map(o=>s.jsx("button",{type:"button",role:"tab","aria-selected":xe===o.id,className:`audience-flow-tab ${xe===o.id?"active":""}`,onClick:()=>Qe(o.id),children:o.label},o.id))}),s.jsxs("div",{className:"audience-flow-panel",children:[xe==="dynamic"&&s.jsxs("div",{className:"audience-flow-content",children:[s.jsxs("div",{className:"audience-hero",children:[s.jsxs("div",{className:"audience-hero-main",children:[s.jsx("div",{className:"audience-hero-title",children:"Sincronizacin Automtica Total"}),s.jsx("div",{className:"audience-hero-subtitle",children:"Vincula tus etiquetas directamente con Audiencias Dinmicas. La lgica del sistema es 1 Tag = 1 Audiencia."}),s.jsxs("div",{className:"audience-line-picker",children:[s.jsx("span",{children:"Lnea activa"}),s.jsxs("select",{value:(ye==null?void 0:ye.phone_number_id)||"",onChange:o=>Hs(o.target.value),disabled:!Kt.length,children:[!Kt.length&&s.jsx("option",{value:"",children:"Sin lneas registradas"}),Kt.map(o=>s.jsx("option",{value:o.phone_number_id,children:o.display_name||o.phone_number_id},o.id))]})]})]}),s.jsxs("label",{className:"audience-switch",children:[s.jsx("span",{children:"Estado"}),s.jsx("input",{type:"checkbox",checked:L.enabled,onChange:o=>xi(o.target.checked),disabled:$s||!Kt.length}),s.jsx("span",{children:L.enabled?"ACTIVO":"INACTIVO"})]})]}),s.jsxs("div",{className:"audience-rule-card",children:[s.jsx("div",{className:"audience-rule-title",children:"Regla de Automatizacin unificada"}),s.jsx("p",{children:"Cuando un operador o bot etiqueta a un contacto en el CRM, este se aade instantneamente a la lista de audiencia correspondiente. No requiere intervencin manual adicional."})]}),s.jsxs("div",{className:"audience-section-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audience-section-title",children:"Gestin de Etiquetas dinmicas"}),s.jsx("div",{className:"audience-section-subtitle",children:"Administra las etiquetas vinculadas que alimentan tus listas de envo en tiempo real."})]}),s.jsxs("div",{className:"audience-section-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:uo,disabled:_,children:_?"Sincronizando...":"Sincronizar Datos Histricos"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:yi,disabled:!G.trim(),children:"Nueva Etiqueta / Audiencia"})]})]}),s.jsxs("div",{className:"audience-tags-grid",children:[bn&&s.jsx("div",{className:"empty-state",children:"Cargando etiquetas..."}),!bn&&Bn.length===0&&s.jsx("div",{className:"empty-state",children:"No hay etiquetas dinmicas an."}),!bn&&Bn.map(o=>{var x,D,K,ee,pe;return s.jsxs("div",{className:`audience-tag-card ${o.is_default?"default":""}`,children:[s.jsxs("div",{className:"audience-tag-head",children:[s.jsx("div",{className:"audience-tag-name",children:o.is_default?((x=o.segment)==null?void 0:x.name)||"DEFAULT":((D=o.tag)==null?void 0:D.name)||((K=o.segment)==null?void 0:K.name)}),s.jsx("div",{className:"audience-tag-count",children:((ee=o.segment)==null?void 0:ee.estimated_count)||0})]}),s.jsxs("div",{className:"audience-tag-meta",children:["Audiencia: ",((pe=o.segment)==null?void 0:pe.estimated_count)||0," contactos"]}),s.jsxs("div",{className:"audience-tag-status",children:[s.jsx("span",{className:"dot"}),"Sincronizado",s.jsx("span",{className:"audience-tag-time",children:o.last_synced_at?`  ${R(o.last_synced_at)}`:""})]})]},o.id)}),s.jsx("div",{className:"audience-tag-card add",children:s.jsxs("div",{className:"audience-tag-add",children:[s.jsx("div",{className:"audience-tag-add-icon",children:"+"}),s.jsx("input",{type:"text",placeholder:"Crear nueva etiqueta",value:G,onChange:o=>se(o.target.value)}),s.jsx("button",{type:"button",className:"campaigns-primary",onClick:yi,disabled:!G.trim(),children:"Crear"})]})})]})]}),xe==="excel"&&s.jsxs("div",{className:"audience-flow-content",children:[we?s.jsxs("div",{className:"excel-file-panel",children:[s.jsxs("div",{children:[s.jsx("div",{className:"excel-file-title",children:"Archivo cargado"}),s.jsx("div",{className:"excel-file-name",children:we.name})]}),s.jsxs("div",{className:"excel-file-actions",children:[s.jsxs("label",{className:"excel-link",children:["Cambiar archivo",s.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:fa})]}),s.jsx("button",{className:"campaigns-danger",type:"button",onClick:pn,children:"Eliminar archivo"})]})]}):s.jsx("div",{className:"excel-dropzone",children:s.jsxs("div",{className:"excel-dropzone-inner",children:[s.jsx("div",{className:"excel-dropzone-icon",children:"?"}),s.jsx("div",{className:"excel-dropzone-title",children:"Sube tu archivo de Excel"}),s.jsxs("div",{className:"excel-dropzone-subtitle",children:["Arrastra y suelta tu archivo .xlsx o .csv aqu o"," ",s.jsxs("label",{className:"excel-link",children:["explora tus archivos",s.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:fa})]})]}),s.jsxs("div",{className:"excel-dropzone-tags",children:[s.jsx("span",{children:"Mximo 50MB"}),s.jsx("span",{children:"Hasta 50,000 filas"})]})]})}),we?s.jsxs("div",{className:"excel-grid",children:[s.jsxs("div",{className:"excel-card",children:[s.jsx("div",{className:"excel-card-title",children:"Configuracin de Importacin"}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista de destino"}),s.jsxs("select",{value:re.targetMode,onChange:o=>oe(x=>({...x,targetMode:o.target.value})),children:[s.jsx("option",{value:"new",children:"Crear Nueva Lista"}),s.jsx("option",{value:"existing",children:"Elegir Lista Existente"})]})]}),re.targetMode==="new"?s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Nombre de la nueva lista"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO",value:re.listName,onChange:o=>oe(x=>({...x,listName:o.target.value}))})]}):s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista existente"}),s.jsxs("select",{value:re.targetSegmentId,onChange:o=>oe(x=>({...x,targetSegmentId:o.target.value})),children:[s.jsx("option",{value:"",children:"Selecciona una lista"}),qs.map(o=>s.jsx("option",{value:o.id,children:o.name},o.id))]})]}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Prefijo de etiqueta (opcional)"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO_",value:re.prefix,onChange:o=>oe(x=>({...x,prefix:o.target.value}))})]}),s.jsxs("label",{className:"excel-checkbox",children:[s.jsx("input",{type:"checkbox",checked:re.ignoreDuplicates,onChange:o=>oe(x=>({...x,ignoreDuplicates:o.target.checked}))}),"Ignorar contactos duplicados"]}),hn&&s.jsxs("div",{className:"excel-summary",children:["Procesadas: ",hn.processed,"  Nuevos:"," ",hn.created,"  Duplicados:"," ",hn.skipped,"  Errores: ",hn.errors]})]}),s.jsxs("div",{className:"excel-card",children:[s.jsxs("div",{className:"excel-card-title",children:["Vista previa de mapeo",s.jsxs("span",{className:"excel-pill",children:["Columnas detectadas: ",((Ai=et==null?void 0:et.columns)==null?void 0:Ai.length)||0]})]}),s.jsxs("div",{className:"excel-map-table",children:[s.jsxs("div",{className:"excel-map-head",children:[s.jsx("span",{children:"Columna Excel"}),s.jsx("span",{children:"Mapeo CRM"}),s.jsx("span",{children:"Ejemplo"})]}),((et==null?void 0:et.columns)||[]).map((o,x)=>{var D,K;return s.jsxs("div",{className:"excel-map-row",children:[s.jsx("span",{children:o}),s.jsx("select",{value:ea[x]||"ignore",onChange:ee=>rs(pe=>{const nt=[...pe];return nt[x]=ee.target.value,nt}),children:ty.map(ee=>s.jsx("option",{value:ee.value,children:ee.label},ee.value))}),s.jsx("span",{children:((K=(D=et==null?void 0:et.previewRows)==null?void 0:D[0])==null?void 0:K[x])||"--"})]},`${o}-${x}`)}),!et&&s.jsx("div",{className:"empty-state",children:"Sube un archivo para ver el mapeo."})]})]})]}):s.jsxs("div",{className:"excel-placeholder",children:[s.jsx("div",{className:"excel-placeholder-title",children:"Agrega un archivo para continuar"}),s.jsx("div",{className:"excel-placeholder-subtitle",children:"Luego podrs mapear todas las columnas a los campos del CRM."})]})]}),xe==="odoo"&&s.jsxs("div",{className:"audience-flow-content odoo-flow",children:[s.jsxs("div",{className:"odoo-status",children:[s.jsx("span",{className:`odoo-indicator ${ta.connected?"on":"off"}`}),"Estado: ",ta.connected?"Odoo conectado":"Odoo no conectado"]}),s.jsxs("div",{className:"odoo-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:Gs,disabled:fi,children:fi?"Validando...":"Validar Conexin"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:ji,disabled:na,children:na?"Actualizando...":"Actualizar Lista Odoo"})]}),s.jsx("div",{className:"odoo-note",children:"Se importarn contactos y se crearn audiencias por etiqueta Automticamente."}),is&&s.jsxs("div",{className:"odoo-summary",children:[s.jsx("div",{className:"odoo-summary-title",children:"Resultado de sincronizacin"}),s.jsxs("div",{className:"odoo-summary-metrics",children:[s.jsxs("span",{children:["Aadidos: ",is.created||0]}),s.jsxs("span",{children:["Actualizados: ",is.updated||0]}),s.jsxs("span",{children:["Omitidos: ",is.skipped||0]})]}),(Li=(Ti=is.preview)==null?void 0:Ti.created)!=null&&Li.length?s.jsxs("div",{className:"odoo-preview",children:[s.jsx("div",{className:"odoo-preview-title",children:"Contactos aadidos"}),s.jsx("ul",{children:is.preview.created.map(o=>s.jsxs("li",{children:[s.jsx("strong",{children:o.name||"Sin nombre"})," ",s.jsx("span",{children:o.phone_e164||""})]},`${o.phone_e164||o.name}-${o.id||""}`))})]}):null]})]})]})]}):s.jsxs(s.Fragment,{children:[Re==="templates"&&s.jsxs("section",{className:"campaigns-panel templates-panel",children:[s.jsxs("div",{className:"templates-toolbar",children:[s.jsxs("label",{className:"templates-search ui-search",children:[s.jsx("span",{className:"template-search-icon ui-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar por nombre de plantilla...",value:N,onChange:o=>V(o.target.value)})]}),s.jsxs("select",{className:"templates-select",value:I,onChange:o=>Y(o.target.value),children:[s.jsx("option",{value:"all",children:"Todas las categorias"}),jo.map(o=>s.jsx("option",{value:o.toLowerCase(),children:Ah[o]||o},o))]})]}),s.jsxs("div",{className:"template-grid template-grid--library",children:[ki.map(o=>{const x=(o.status||(o.is_active?"APPROVED":"PENDING")).toUpperCase(),D=Ji[x]||Ji.PENDING,K=Ah[o.category]||o.category||"GENERAL",ee=o.id===e.template_id,pe=o.rejection_reason||o.rejectionReason||o.rejection_message||"",nt=x==="REJECTED"?"Ver detalles":"Previsualizar";return s.jsxs("div",{className:`template-card ${ee?"selected":""}`,children:[s.jsxs("div",{className:"template-head",children:[s.jsx("div",{className:"template-name",title:o.name,children:o.name}),s.jsx("span",{className:`template-status ${D.className}`,children:D.label})]}),s.jsx("div",{className:"template-category",children:K}),s.jsx("div",{className:`template-preview ${x==="REJECTED"?"rejected":""}`,children:o.body_preview||o.body_text||"Sin preview"}),x==="REJECTED"&&pe&&s.jsxs("div",{className:"template-rejection",children:["Rechazada por Meta: ",pe]}),s.jsx("div",{className:"template-footer",children:s.jsx("button",{className:"template-action",type:"button",onClick:()=>To(o),children:nt})})]},o.id)}),!ki.length&&s.jsx("div",{className:"empty-state",children:"Sin plantillas disponibles"})]})]}),Re==="audiences"&&s.jsx("section",{className:"campaigns-panel audiences-panel",children:s.jsxs("div",{className:"audiences-layout",children:[s.jsxs("div",{className:"audiences-list",children:[s.jsxs("label",{className:"audiences-search ui-search",children:[s.jsx("span",{className:"template-search-icon ui-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar lista...",value:Ee,onChange:o=>Me(o.target.value)})]}),s.jsxs("div",{className:"audience-list",children:[Ni.map(o=>{var x;return s.jsxs("button",{type:"button",className:`audience-card ${En===o.id?"active":""}`,onClick:()=>po(o),children:[s.jsxs("div",{className:"audience-title",children:[s.jsx("span",{children:o.name}),s.jsxs("div",{className:"audience-title-actions",children:[s.jsx("span",{className:"audience-count",children:((x=o.count)==null?void 0:x.toLocaleString("es-PE"))||0}),!o.isDefault&&o.type!=="odoo"&&s.jsxs("div",{className:"audience-menu-wrapper",children:[s.jsx("button",{className:"audience-menu",type:"button","aria-label":"Opciones de audiencia",onClick:D=>{D.stopPropagation(),ca(K=>K===o.id?null:o.id)},children:"..."}),vi===o.id&&s.jsxs("div",{className:"audience-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>gr(o),children:"Renombrar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>vo(o),children:"Eliminar"})]})]})]})]}),s.jsx("div",{className:"audience-subtitle",children:o.subtitle})]},o.id)}),!Ni.length&&s.jsx("div",{className:"empty-state",children:"Sin audiencias disponibles"})]})]}),s.jsxs("div",{className:"audiences-table-panel",children:[s.jsxs("div",{className:"audiences-filters",children:[s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ETIQUETA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>pa("tag",["Todas","Con etiquetas","Sin etiquetas"]),children:St.tag})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"FECHA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>pa("date",["Cualquier fecha","ltimos 30 das"]),children:St.date})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ESTADO:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>pa("status",["Activos","Inactivos"]),children:St.status})]}),s.jsxs("div",{className:"audiences-filter-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Descargar",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Actualizar",onClick:mo,children:""})]})]}),s.jsxs("div",{className:"audiences-search-row",children:[s.jsxs("label",{className:"audiences-search-field ui-search",children:[s.jsx("span",{className:"template-search-icon ui-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar contacto en esta lista...",value:us,onChange:o=>{hd(o.target.value),tt(1)}})]}),s.jsxs("div",{className:"audiences-total",children:[ra.toLocaleString("es-PE")," contactos en total"]})]}),s.jsxs("div",{className:"audiences-bulk",children:[s.jsxs("div",{className:"audiences-bulk-info",children:[Vn.length," seleccionados"]}),s.jsxs("select",{className:"audiences-bulk-select",value:ia,onChange:o=>Ke(o.target.value),children:[s.jsx("option",{value:"",children:"Selecciona audiencia destino..."}),Si.map(o=>s.jsx("option",{value:o.id,children:o.name},`bulk-${o.id}`))]}),s.jsx("button",{className:"audiences-bulk-btn",type:"button",disabled:Ws||!Vn.length||!An||An===ps,onClick:()=>ga("add"),children:"Aadir"}),s.jsx("button",{className:"audiences-bulk-btn",type:"button",disabled:Ws||!Vn.length||!An||An===ps,onClick:()=>ga("move"),children:"Mover"}),s.jsx("button",{className:"audiences-bulk-btn danger",type:"button",disabled:Ws||!Vn.length||!ps,onClick:()=>ga("remove"),children:"Eliminar"})]}),(lt==null?void 0:lt.type)==="odoo"&&s.jsx("div",{className:"audiences-bulk-note",children:"Las acciones masivas solo aplican a contactos con conversacin de WhatsApp."}),s.jsxs("div",{className:"audiences-table",children:[s.jsxs("div",{className:"audiences-table-head",children:[s.jsx("span",{children:s.jsx("input",{ref:ua,type:"checkbox","aria-label":"Seleccionar todos",checked:Js.length>0&&Fs.size===Js.length,onChange:o=>xo(o.target.checked)})}),s.jsx("span",{children:"CONTACTO"}),s.jsx("span",{children:"WHATSAPP"}),s.jsx("span",{children:"ETIQUETAS"}),s.jsx("span",{children:"FECHA REGISTRO"}),s.jsx("span",{children:"ESTADO"}),s.jsx("span",{})]}),mi&&s.jsx("div",{className:"loading",children:"Cargando contactos..."}),!mi&&os.length===0&&s.jsx("div",{className:"empty-state",children:"No hay contactos en esta audiencia."}),!mi&&os.map(o=>{const x=o.name||"Sin nombre",D=o.email||"",K=o.phone_e164||o.phone||"-",ee=Array.isArray(o.tags)?o.tags:o.tags?[o.tags]:[],pe=x.trim().slice(0,1).toUpperCase(),nt=o.conversation_id||o.conversationId||"";return s.jsxs("div",{className:"audiences-table-row",children:[s.jsx("input",{type:"checkbox","aria-label":"Seleccionar contacto",checked:Fs.has(nt),onChange:()=>yo(o),disabled:!nt}),s.jsxs("div",{className:"audiences-contact",children:[s.jsx("div",{className:"audiences-avatar",children:pe}),s.jsxs("div",{className:"audiences-contact-info",children:[s.jsx("div",{className:"audiences-contact-name",children:x}),D&&s.jsx("div",{className:"audiences-contact-email",children:D})]})]}),s.jsx("div",{children:K}),s.jsx("div",{className:"audiences-tags",children:ee.length?ee.map(Lt=>s.jsx("span",{className:"audiences-tag",children:Lt},`${o.id}-${Lt}`)):s.jsx("span",{className:"audiences-tag empty",children:""})}),s.jsx("div",{children:o.created_at?R(o.created_at):""}),s.jsx("div",{className:"audiences-status",children:(o.status||"ACTIVO").toUpperCase()}),s.jsxs("div",{className:"audiences-menu-wrapper",children:[s.jsx("button",{className:"audiences-menu",type:"button","aria-label":"Opciones",onClick:()=>bo(o.id),disabled:!o.id,children:"..."}),Dt===o.id&&s.jsxs("div",{className:"audiences-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>Co(o),children:"Editar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>ya(o),children:"Eliminar"})]})]})]},o.id||K)})]}),s.jsxs("div",{className:"audiences-pagination",children:[s.jsxs("div",{className:"audiences-page-info",children:["Pgina ",it," de ",Ks]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:it<=1,onClick:()=>tt(o=>Math.max(1,o-1)),children:"<"}),hs.map(o=>s.jsx("button",{className:`audiences-page-btn ${o===it?"active":""}`,type:"button",onClick:()=>tt(o),children:o},`aud-page-${o}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:it>=Ks,onClick:()=>tt(o=>Math.min(Ks,o+1)),children:">"})]})]})]})]})}),Re==="new"&&s.jsx("section",{className:"campaigns-panel campaigns-module",children:T?s.jsxs("div",{className:"campaigns-launch",children:[s.jsxs("form",{className:"campaigns-launch-form",ref:_t,onSubmit:Ao,children:[s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"1"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Nombre de la Campaa"}),s.jsx("input",{type:"text",placeholder:"Ej: Promocin Black Friday 2024",value:e.name,onChange:o=>t(x=>({...x,name:o.target.value}))})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"2"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Seleccionar Audiencia"}),s.jsxs("select",{value:No,onChange:o=>vs(o.target.value),children:[s.jsx("option",{value:"",children:"Selecciona un segmento..."}),ft.filter(o=>o.type!=="odoo").map(o=>s.jsx("option",{value:`segment:${o.id}`,children:o.name},`seg-${o.id}`)),s.jsx("option",{value:"verified",children:"Solo verificados"}),s.jsx("option",{value:"assigned:unassigned",children:"Sin asignar"})]})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"3"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Elegir Plantilla de Meta"}),s.jsxs("div",{className:"launch-template-search ui-search",children:[s.jsx("span",{className:"template-search-icon ui-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar plantilla...",value:Q,onChange:o=>B(o.target.value)}),s.jsx("button",{type:"button",onClick:()=>B(""),children:"Limpiar"})]}),s.jsx("div",{className:"launch-templates-scroll",children:s.jsxs("div",{className:"launch-templates",children:[bi.map(o=>{const x=o.status||"APPROVED",D=Ji[x]||Ji.APPROVED,K=e.template_id===o.id;return s.jsxs("button",{className:`launch-template ${K?"selected":""}`,type:"button",onClick:()=>wo(o.id),children:[s.jsx("div",{className:"launch-template-icon"}),s.jsx("div",{className:"launch-template-title",children:o.name}),s.jsx("div",{className:"launch-template-preview",children:o.body_preview||o.body_text||"Sin preview"}),s.jsx("span",{className:`launch-template-status ${D.className}`,children:D.label})]},o.id)}),bi.length===0&&s.jsx("div",{className:"launch-empty",children:"Sin plantillas"})]})})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"4"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Programacin"}),s.jsxs("div",{className:"launch-schedule",children:[s.jsx("button",{className:`launch-schedule-option ${cn==="now"?"active":""}`,type:"button",onClick:()=>{Qt("now"),t(o=>({...o,scheduled_for:"",send_now:!0}))},children:"Enviar Ahora"}),s.jsx("button",{className:`launch-schedule-option ${cn==="schedule"?"active":""}`,type:"button",onClick:()=>{Qt("schedule"),t(o=>({...o,send_now:!1}))},children:"Programar Envo"})]}),cn==="schedule"&&s.jsx("input",{type:"datetime-local",value:e.scheduled_for,onChange:o=>t(x=>({...x,scheduled_for:o.target.value,send_now:!1}))})]})]})]}),s.jsxs("aside",{className:"campaigns-launch-preview",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:"Nombre del Cliente"}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(g==null?void 0:g.body_preview)||(g==null?void 0:g.body_text)||"Selecciona una plantilla para ver el contenido."}),wi.length>0&&s.jsx("div",{className:"preview-actions",children:wi.map((o,x)=>s.jsx("button",{type:"button",children:o.text||o.label||o.title||`Botn ${x+1}`},`preview-btn-${x}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Destinatarios"}),s.jsx("strong",{children:(ms==null?void 0:ms.count)||0})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:(g==null?void 0:g.name)||"Sin plantilla"})]})]})]})]}):s.jsxs("div",{className:"campaigns-dashboard",children:[s.jsxs("aside",{className:"campaigns-sidebar",children:[s.jsxs("label",{className:"campaigns-search ui-search",children:[s.jsx("span",{className:"template-search-icon ui-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar campaa...",value:Z,onChange:o=>ce(o.target.value)})]}),s.jsxs("div",{className:"campaigns-filters-list",children:[s.jsxs("button",{className:`campaigns-filter-item ${le==="all"?"active":""}`,type:"button",onClick:()=>be("all"),children:[s.jsx("span",{children:"Todas las Campaas"}),s.jsx("span",{className:"campaigns-filter-count",children:Xs.all})]}),s.jsxs("button",{className:`campaigns-filter-item ${le==="completed"?"active":""}`,type:"button",onClick:()=>be("completed"),children:[s.jsx("span",{children:"Enviadas"}),s.jsx("span",{className:"campaigns-filter-count",children:Xs.completed})]}),s.jsxs("button",{className:`campaigns-filter-item ${le==="scheduled"?"active":""}`,type:"button",onClick:()=>be("scheduled"),children:[s.jsx("span",{children:"Programadas"}),s.jsx("span",{className:"campaigns-filter-count",children:Xs.scheduled})]}),s.jsxs("button",{className:`campaigns-filter-item ${le==="draft"?"active":""}`,type:"button",onClick:()=>be("draft"),children:[s.jsx("span",{children:"Borradores"}),s.jsx("span",{className:"campaigns-filter-count",children:Xs.draft})]}),s.jsxs("button",{className:`campaigns-filter-item ${le==="failed"?"active":""}`,type:"button",onClick:()=>be("failed"),children:[s.jsx("span",{children:"Fallidas"}),s.jsx("span",{className:"campaigns-filter-count",children:Xs.failed})]})]}),s.jsxs("div",{className:"campaigns-quota",children:[s.jsx("div",{className:"campaigns-quota-title",children:"Cuota de mensajes"}),s.jsx("div",{className:"campaigns-quota-bar",children:s.jsx("div",{className:"campaigns-quota-fill",style:{width:"65%"}})}),s.jsx("div",{className:"campaigns-quota-meta",children:"65% usado"})]})]}),s.jsxs("div",{className:"campaigns-table-panel",children:[s.jsxs("div",{className:"campaigns-table-filters",children:[s.jsx("div",{className:"campaigns-filter-chip",children:"Canal: WhatsApp Business"}),s.jsx("div",{className:"campaigns-filter-chip",children:"Periodo: ltimos 30 das"}),s.jsxs("div",{className:"campaigns-table-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button",onClick:()=>O(at,Je,Z.trim()),children:""})]})]}),s.jsxs("div",{className:"campaigns-table",children:[s.jsxs("div",{className:"campaigns-table-head",children:[s.jsx("span",{children:"Campaa"}),s.jsx("span",{children:"Fecha"}),s.jsx("span",{children:"Audiencia"}),s.jsx("span",{children:"Enviados"}),s.jsx("span",{children:"Ledos"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{})]}),xr.map(o=>{const x=o.messages_count||o.audience_count||"--",D=o.read_count||"--",K=o.reply_count||"--",ee=Ys(o.status),pe=Eh[ee]||ee,nt=["running","sending"].includes(ee),Lt=["completed","failed"].includes(ee),Yt=!nt,jr=!nt;return s.jsxs("div",{className:"campaigns-table-row",children:[s.jsxs("div",{className:"campaigns-table-title",children:[s.jsx("div",{className:"campaigns-table-name",children:o.name}),s.jsxs("div",{className:"campaigns-table-ref",children:["Ref: ",o.id.slice(0,10)]})]}),s.jsx("div",{className:"campaigns-table-date",children:R(o.created_at)}),s.jsx("div",{className:"campaigns-table-tags",children:s.jsx("span",{className:"campaigns-pill",children:o.audience_label||"Base General"})}),s.jsx("div",{className:"campaigns-metric",children:x}),s.jsx("div",{className:"campaigns-metric",children:D}),s.jsx("div",{className:"campaigns-metric",children:K}),s.jsx("div",{className:`campaigns-status ${ee}`,children:pe}),s.jsx("div",{className:"campaigns-row-actions",children:s.jsxs("div",{className:"campaigns-row-menu",children:[s.jsx("button",{className:"campaigns-row-menu-btn",type:"button","aria-label":"Opciones",onClick:Nr=>ko(o.id,Nr),children:"..."}),ne===o.id&&s.jsxs("div",{className:`campaigns-row-dropdown ${He==="up"?"drop-up":""}`,children:[Yt&&s.jsx("button",{type:"button",onClick:()=>{_o(o),ue(null)},children:"Editar"}),Lt&&s.jsx("button",{type:"button",onClick:()=>{Zs(o),ue(null)},children:"Reenviar"}),jr&&s.jsx("button",{type:"button",className:"danger",onClick:()=>{So(o),ue(null)},children:"Eliminar"})]})]})})]},o.id)}),!xr.length&&s.jsx("div",{className:"empty-state",children:"Sin campaas registradas"})]}),s.jsxs("div",{className:"campaigns-table-footer",children:[s.jsxs("span",{children:["Mostrando ",xr.length," de"," ",j||i.length," campaas"]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:at<=1,onClick:()=>{const o=Math.max(1,at-1);un(o),O(o,Je,Z.trim())},children:"<"}),fs.pages.map(o=>s.jsx("button",{className:`audiences-page-btn ${o===at?"active":""}`,type:"button",onClick:()=>{un(o),O(o,Je,Z.trim())},children:o},`camp-page-${o}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:at>=fs.totalPages,onClick:()=>{const o=Math.min(fs.totalPages,at+1);un(o),O(o,Je,Z.trim())},children:">"})]})]})]})]})}),Re==="history"&&s.jsxs("section",{className:"campaigns-panel campaigns-history",children:[s.jsxs("div",{className:"campaigns-history-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"campaigns-history-title",children:"Historial de Envos"}),s.jsx("div",{className:"campaigns-history-subtitle",children:"ltimos 30 das"})]}),s.jsx("button",{className:"campaigns-link",type:"button",onClick:O,children:"Ver todo el historial"})]}),s.jsxs("div",{className:"history-table history-table--main",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"Campaa / Fecha"}),s.jsx("span",{children:"Alcance"}),s.jsx("span",{children:"Tasa de lectura"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),i.map(o=>{const x=Eh[o.status]||o.status,D=o.audience_count||o.messages_count||o.total||"--";return s.jsxs("div",{className:"history-row",children:[s.jsxs("div",{className:"history-title",children:[s.jsx("div",{className:"history-name",children:o.name}),s.jsx("div",{className:"history-date",children:R(o.created_at)})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:D}),s.jsx("div",{className:"history-label",children:"contactos"})]}),s.jsxs("div",{className:"history-meter",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-bar",children:s.jsx("div",{className:"history-bar-fill",style:{width:"0%"}})})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-label",children:"mensajes"})]}),s.jsx("div",{className:`history-status ${o.status}`,children:x}),s.jsxs("div",{className:"history-actions",children:[s.jsx("button",{className:"campaigns-ghost small",type:"button",onClick:()=>P(o.id),children:"Ver mensajes"}),s.jsx("button",{className:"campaigns-danger small",type:"button",onClick:()=>b(o.id),disabled:o.status==="sending",children:"Enviar"})]})]},o.id)}),!i.length&&s.jsx("div",{className:"empty-state",children:"Sin Campaas registradas"})]}),l&&s.jsxs("div",{className:"campaigns-messages",children:[s.jsx("div",{className:"campaigns-history-title",children:"Mensajes"}),s.jsxs("div",{className:"history-table history-table--messages",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"WA"}),s.jsx("span",{children:"Status"}),s.jsx("span",{children:"Enviado"})]}),c.map(o=>s.jsxs("div",{className:"history-row",children:[s.jsx("span",{children:o.wa_id}),s.jsx("span",{children:o.status}),s.jsx("span",{children:R(o.sent_at)})]},o.id))]})]})]})]})})]}),he&&s.jsx("div",{className:"modal-overlay",onClick:()=>fe(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Previsualizar plantilla"}),s.jsx("button",{className:"modal-close",onClick:()=>fe(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:A}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(Se==null?void 0:Se.body_preview)||(Se==null?void 0:Se.body_text)||"Sin previsualizacin disponible."}),_i.length>0&&s.jsx("div",{className:"preview-actions",children:_i.map((o,x)=>s.jsx("button",{type:"button",children:o.text||o.label||o.title||`Botn ${x+1}`},`preview-modal-btn-${x}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})}),qt&&s.jsx("div",{className:"modal-overlay",onClick:()=>Gt(!1),children:s.jsxs("div",{className:"modal-content",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Editar contacto"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>Gt(!1),children:"x"})]}),s.jsxs("form",{className:"modal-body",onSubmit:Eo,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:Ge.name,onChange:o=>Bt(x=>({...x,name:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Telfono"}),s.jsx("input",{type:"text",value:Ge.phone,onChange:o=>Bt(x=>({...x,phone:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:Ge.email,onChange:o=>Bt(x=>({...x,email:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"CI / NIT"}),s.jsx("input",{type:"text",value:Ge.vat,onChange:o=>Bt(x=>({...x,vat:o.target.value}))})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{className:"btn-secondary",type:"button",onClick:()=>Gt(!1),children:"Cancelar"}),s.jsx("button",{className:"btn-primary",type:"submit",disabled:_n,children:_n?"Guardando...":"Guardar"})]})]})]})})]})}function Fa({variant:e="error",title:t,message:n,actionLabel:r,onAction:a,dismissLabel:i="Cerrar",onDismiss:l}){const c=e==="offline"?"x":"!";return s.jsxs("div",{className:`notice-banner notice-banner-${e}`,children:[s.jsx("div",{className:"notice-icon","aria-hidden":"true",children:c}),s.jsxs("div",{className:"notice-content",children:[t?s.jsx("div",{className:"notice-title",children:t}):null,s.jsx("div",{className:"notice-text",children:n})]}),s.jsxs("div",{className:"notice-actions",children:[r&&s.jsx("button",{className:"notice-action",type:"button",onClick:a,children:r}),l&&s.jsx("button",{className:"notice-close",type:"button",onClick:l,children:i})]})]})}const sy={admin:{title:"Administrador",subtitle:"Acceso total",tone:"alert"},recepcion:{title:"Operador",subtitle:"Atencion al cliente",tone:"info"},caja:{title:"Supervisor",subtitle:"Auditoria y gestion",tone:"dark"},marketing:{title:"Marketing",subtitle:"Crecimiento y campanas",tone:"info"},doctor:{title:"Doctor",subtitle:"Atencion al cliente",tone:"dark"}},Lh=[{id:"chat",label:"Chat"},{id:"dashboard",label:"Dashboard"},{id:"campaigns",label:"Campanas"}],Rh=[{id:"general",label:"General"},{id:"users",label:"Gestion de Usuarios"},{id:"bot",label:"Configuracion de Bot"},{id:"templates",label:"Plantillas de Meta"},{id:"audit",label:"Registros / Auditoria"},{id:"odoo",label:"Integracion Odoo"}];function Oh(e){return sy[e]||{title:e,subtitle:"Acceso personalizado",tone:"info"}}function ry({settingsTab:e,setSettingsTab:t,rolePermissions:n,setRolePermissions:r,isAdmin:a,adminUsers:i,userForm:l,setUserForm:c,roleOptions:u,handleUserSubmit:m,handleUserDelete:S,defaultRolePermissions:g,handleRoleDelete:y}){const[E,O]=h.useState(""),[P,b]=h.useState(!1),[f,p]=h.useState(""),[v,j]=h.useState(null),[R,$]=h.useState(!1),[A,N]=h.useState("create"),[V,I]=h.useState("recepcion"),[Y,he]=h.useState({modules:{},settings:{}}),fe=h.useMemo(()=>{const T=E.trim().toLowerCase(),q=i||[];return T?q.filter(k=>{var B,ne;const U=((B=k.name)==null?void 0:B.toLowerCase())||"",Q=((ne=k.email)==null?void 0:ne.toLowerCase())||"";return U.includes(T)||Q.includes(T)}):q},[i,E]);function Se(T){const q=(n==null?void 0:n[T])||(g==null?void 0:g[T])||{modules:{},settings:{}};return{modules:{...q.modules||{}},settings:{...q.settings||{}}}}function ke(T,q="edit"){N(q),I(T),he(Se(T)),$(!0)}function Ee(T,q,k){he(U=>{const Q={...U},B={...Q[T]||{}},ne={...B[q]||{}},ue=!ne[k];return ne[k]=ue,k==="write"&&ue&&(ne.read=!0),k==="read"&&!ue&&(ne.write=!1),B[q]=ne,Q[T]=B,Q})}function Me(){V&&(r(T=>({...T,[V]:Y})),$(!1))}function W(){V&&y&&y(V),$(!1)}function te(T,q,k,U){a&&r(Q=>{var Dt,ve;const B={...Q},ne={modules:{...(Dt=B[T])==null?void 0:Dt.modules},settings:{...(ve=B[T])==null?void 0:ve.settings}},ue={...ne[q]},He={...ue[k]},wt=!He[U];return He[U]=wt,U==="write"&&wt&&(He.read=!0),U==="read"&&!wt&&(He.write=!1),ue[k]=He,ne[q]=ue,B[T]=ne,B})}function Z(T){return Oh(T).title.toUpperCase()}function ce(T,q){return T!=null&&T.id?`OP-${T.id.slice(-4).toUpperCase()}`:`OP-${String(q+1).padStart(4,"0")}`}function le(T){c({id:T.id,name:T.name,email:T.email,role:T.role,password:"",is_active:T.is_active}),b(!0)}function be(){c({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),b(!0)}return s.jsxs("div",{className:"users-page",children:[s.jsxs("header",{className:"users-header",children:[s.jsxs("div",{className:"users-title-row",children:[s.jsx("span",{className:"users-kicker"}),s.jsxs("div",{children:[s.jsx("div",{className:"users-title",children:"Gestion de Usuarios"}),s.jsx("div",{className:"users-subtitle",children:"Administra los accesos y roles de los operadores de tu empresa."})]})]}),s.jsxs("div",{className:"users-actions",children:[e==="list"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"users-search",children:[s.jsx("span",{className:"users-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar usuario...",value:E,onChange:T=>O(T.target.value)})]}),s.jsx("button",{className:"settings-primary",type:"button",onClick:be,children:"Nuevo Usuario"})]}),e==="roles"&&s.jsx("button",{className:"settings-primary",type:"button",onClick:()=>ke("recepcion","create"),children:"+ Nuevo Rol"})]})]}),s.jsxs("div",{className:"users-tabs",children:[s.jsx("button",{className:`users-tab ${e==="list"?"active":""}`,type:"button",onClick:()=>t("list"),children:"Lista de Usuarios"}),s.jsx("button",{className:`users-tab ${e==="roles"?"active":""}`,type:"button",onClick:()=>t("roles"),children:"Roles y Permisos"})]}),e==="list"&&s.jsxs("div",{className:"users-table",children:[s.jsxs("div",{className:"users-table-head",children:[s.jsx("span",{children:"Nombre / Usuario"}),s.jsx("span",{children:"Email"}),s.jsx("span",{children:"Rol"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),fe.map((T,q)=>{var k;return s.jsxs("div",{className:"users-row",children:[s.jsxs("div",{className:"users-cell user-name",children:[s.jsx("div",{className:"user-avatar",children:((k=T.name)==null?void 0:k[0])||"?"}),s.jsxs("div",{children:[s.jsx("div",{className:"user-title",children:T.name}),s.jsx("div",{className:"user-id",children:ce(T,q)})]})]}),s.jsx("div",{className:"users-cell",children:T.email}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`role-pill ${T.role}`,children:Z(T.role)})}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`status-pill ${T.is_active?"active":"inactive"}`,children:T.is_active?"Activo":"Inactivo"})}),s.jsx("div",{className:"users-cell",children:s.jsxs("div",{className:"users-actions-menu",children:[s.jsx("button",{className:"users-action",type:"button",onClick:()=>p(U=>U===T.id?"":T.id),children:"..."}),f===T.id&&s.jsxs("div",{className:"users-menu",children:[s.jsx("button",{type:"button",onClick:()=>{p(""),le(T)},children:"Editar"}),s.jsx("button",{type:"button",onClick:()=>{p(""),j(T)},children:"Eliminar"})]})]})})]},T.id)}),!fe.length&&s.jsx("div",{className:"empty-state",children:"Sin usuarios para mostrar"})]}),e==="roles"&&s.jsx("div",{className:"roles-grid",children:u.map(T=>{const q=Oh(T),k=n==null?void 0:n[T];return s.jsxs("div",{className:"role-card",children:[s.jsxs("div",{className:"role-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"role-title",children:q.title}),s.jsx("div",{className:`role-subtitle ${q.tone}`,children:q.subtitle})]}),s.jsx("button",{className:"role-edit",type:"button",onClick:()=>ke(T,"edit"),children:"edit"})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),Lh.map(U=>{var Q,B,ne,ue;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((B=(Q=k==null?void 0:k.modules)==null?void 0:Q[U.id])==null?void 0:B.read)||!1,disabled:!a,onChange:()=>te(T,"modules",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ue=(ne=k==null?void 0:k.modules)==null?void 0:ne[U.id])==null?void 0:ue.write)||!1,disabled:!a,onChange:()=>te(T,"modules",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsx("div",{className:"role-settings-title",children:"Configuracion"}),Rh.map(U=>{var Q,B,ne,ue;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((B=(Q=k==null?void 0:k.settings)==null?void 0:Q[U.id])==null?void 0:B.read)||!1,disabled:!a,onChange:()=>te(T,"settings",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ue=(ne=k==null?void 0:k.settings)==null?void 0:ne[U.id])==null?void 0:ue.write)||!1,disabled:!a,onChange:()=>te(T,"settings",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]})]},T)})}),P&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:l.id?"Editar usuario":"Crear usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>b(!1),children:"x"})]}),s.jsxs("form",{className:"form-grid",onSubmit:async T=>{await m(T),b(!1)},children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:T=>c(q=>({...q,name:T.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:l.email,onChange:T=>c(q=>({...q,email:T.target.value})),disabled:!!l.id})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),s.jsx("select",{value:l.role,onChange:T=>c(q=>({...q,role:T.target.value})),children:u.map(T=>s.jsx("option",{value:T,children:T},T))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:l.password,onChange:T=>c(q=>({...q,password:T.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:T=>c(q=>({...q,is_active:T.target.checked}))}),"Activo"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"primary",type:"submit",children:l.id?"Guardar cambios":"Crear"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>b(!1),children:"Cancelar"})]})]})]})}),v&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Eliminar usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>j(null),children:"x"})]}),s.jsxs("p",{className:"modal-text",children:["Vas a desactivar a ",s.jsx("strong",{children:v.email}),". Continuar?"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"danger",type:"button",onClick:()=>{S==null||S(v.id),j(null)},children:"Eliminar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>j(null),children:"Cancelar"})]})]})}),R&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card modal-lg",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:A==="create"?"Nuevo rol":"Editar rol"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>$(!1),children:"x"})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),A==="edit"?s.jsx("select",{value:V,disabled:!0,children:u.map(T=>s.jsx("option",{value:T,children:T},T))}):s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"text",list:"role-options",placeholder:"nuevo-rol",value:V,onChange:T=>I(T.target.value)}),s.jsx("datalist",{id:"role-options",children:u.map(T=>s.jsx("option",{value:T},T))})]})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Modulos"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),Lh.map(T=>{var q,k,U,Q;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:T.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((k=(q=Y==null?void 0:Y.modules)==null?void 0:q[T.id])==null?void 0:k.read)||!1,onChange:()=>Ee("modules",T.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((Q=(U=Y==null?void 0:Y.modules)==null?void 0:U[T.id])==null?void 0:Q.write)||!1,onChange:()=>Ee("modules",T.id,"write")}),s.jsx("span",{})]})]},T.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Configuracion"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),Rh.map(T=>{var q,k,U,Q;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:T.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((k=(q=Y==null?void 0:Y.settings)==null?void 0:q[T.id])==null?void 0:k.read)||!1,onChange:()=>Ee("settings",T.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((Q=(U=Y==null?void 0:Y.settings)==null?void 0:U[T.id])==null?void 0:Q.write)||!1,onChange:()=>Ee("settings",T.id,"write")}),s.jsx("span",{})]})]},T.id)})]})]}),s.jsxs("div",{className:"form-actions",children:[A==="edit"&&s.jsx("button",{className:"danger",type:"button",onClick:W,children:"Eliminar rol"}),s.jsx("button",{className:"primary",type:"button",onClick:Me,disabled:!V,children:"Guardar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>$(!1),children:"Cancelar"})]})]})})]})}const Ph={id:"",display_name:"",is_default:!1,is_active:!0};function ay(e){if(!e)return"Sin fecha";const t=new Date(e);return Number.isNaN(t.getTime())?"Sin fecha":t.toLocaleDateString("es-BO",{day:"2-digit",month:"short",year:"numeric"})}function el(e){return e!=null&&e.display_name?e.display_name:`Linea ${e!=null&&e.phone_number_id?String(e.phone_number_id).slice(-4):"----"}`}function iy({tenantChannels:e=[],channelForm:t=Ph,setChannelForm:n,handleChannelSelect:r,handleChannelSubmit:a,handleChannelQuickUpdate:i}){const[l,c]=h.useState(""),[u,m]=h.useState("all"),[S,g]=h.useState(""),y=h.useMemo(()=>e.find(f=>f.id===t.id)||null,[e,t.id]),E=h.useMemo(()=>{const f=e.length,p=e.filter(j=>j.is_active).length,v=e.find(j=>j.is_default);return{total:f,active:p,inactive:f-p,primaryName:v?el(v):"Sin principal"}},[e]),O=h.useMemo(()=>{const f=l.trim().toLowerCase();return[...e].filter(p=>u==="active"&&!p.is_active||u==="inactive"&&p.is_active?!1:f?[p.display_name||"",p.phone_number_id||"",p.waba_id||""].join(" ").toLowerCase().includes(f):!0).sort((p,v)=>{const j=+!!v.is_default-+!!p.is_default;if(j!==0)return j;const R=+!!v.is_active-+!!p.is_active;return R!==0?R:el(p).localeCompare(el(v),"es")})},[e,l,u]);async function P(f){var v;if(!f)return;const p=String(f);try{if(typeof navigator<"u"&&((v=navigator.clipboard)!=null&&v.writeText))await navigator.clipboard.writeText(p);else if(typeof document<"u"){const j=document.createElement("textarea");j.value=p,j.setAttribute("readonly",""),j.style.position="absolute",j.style.left="-9999px",document.body.appendChild(j),j.select(),document.execCommand("copy"),document.body.removeChild(j)}g(p),setTimeout(()=>{g(j=>j===p?"":j)},1600)}catch{g("")}}function b(){n(Ph)}return s.jsxs("section",{className:"general-lines-shell",children:[s.jsxs("div",{className:"general-lines-header",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"general-lines-title",children:"Lineas de WhatsApp"}),s.jsx("p",{className:"general-lines-description",children:"Gestiona nombres visibles, estado operativo y linea principal para tus conversaciones."})]}),s.jsxs("div",{className:"general-lines-stats",children:[s.jsxs("div",{className:"line-stat",children:[s.jsx("span",{children:"Total"}),s.jsx("strong",{children:E.total})]}),s.jsxs("div",{className:"line-stat",children:[s.jsx("span",{children:"Activas"}),s.jsx("strong",{children:E.active})]}),s.jsxs("div",{className:"line-stat",children:[s.jsx("span",{children:"Inactivas"}),s.jsx("strong",{children:E.inactive})]}),s.jsxs("div",{className:"line-stat line-stat-wide",children:[s.jsx("span",{children:"Principal"}),s.jsx("strong",{children:E.primaryName})]})]})]}),s.jsxs("div",{className:"page-grid general-lines-grid",children:[s.jsxs("div",{className:"panel general-lines-panel",children:[s.jsx("div",{className:"panel-title",children:"Listado de lineas"}),s.jsxs("div",{className:"general-lines-filters",children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Buscar linea"}),s.jsx("input",{type:"text",placeholder:"Nombre, Phone ID o WABA ID",value:l,onChange:f=>c(f.target.value)})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Estado"}),s.jsxs("select",{value:u,onChange:f=>m(f.target.value),children:[s.jsx("option",{value:"all",children:"Todas"}),s.jsx("option",{value:"active",children:"Activas"}),s.jsx("option",{value:"inactive",children:"Inactivas"})]})]})]}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head general-lines-table-head",children:[s.jsx("span",{children:"Linea"}),s.jsx("span",{children:"Phone ID"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),O.map(f=>s.jsxs("div",{className:"table-row general-lines-row",children:[s.jsxs("div",{className:"line-cell",children:[s.jsx("div",{className:"line-main-name",children:el(f)}),s.jsxs("div",{className:"line-meta",children:[f.is_default?s.jsx("span",{className:"line-pill default",children:"Principal"}):null,f.waba_id?s.jsxs("span",{className:"line-pill",children:["WABA ",f.waba_id]}):null,s.jsxs("span",{className:"line-pill",children:["Creada ",ay(f.created_at)]})]})]}),s.jsx("span",{className:"line-phone-id",children:f.phone_number_id}),s.jsx("span",{children:s.jsx("span",{className:`line-pill ${f.is_active?"active":"inactive"}`,children:f.is_active?"Activa":"Inactiva"})}),s.jsxs("div",{className:"row-actions",children:[s.jsx("button",{className:"ghost",onClick:()=>r(f),children:"Editar"}),s.jsx("button",{className:"ghost",onClick:()=>P(f.phone_number_id),children:S===f.phone_number_id?"Copiado":"Copiar ID"}),s.jsx("button",{className:"ghost",onClick:()=>i(f.id,{is_default:!0}),disabled:f.is_default,children:"Principal"}),s.jsx("button",{className:f.is_active?"danger soft":"ghost",onClick:()=>i(f.id,{is_active:!f.is_active}),children:f.is_active?"Desactivar":"Activar"})]})]},f.id)),!O.length&&s.jsx("div",{className:"empty-state",children:"No hay lineas que coincidan con los filtros."})]})]}),s.jsxs("div",{className:"panel general-lines-panel",children:[s.jsx("div",{className:"panel-title",children:t.id?"Editar linea seleccionada":"Selecciona una linea"}),s.jsxs("form",{className:"form-grid",onSubmit:a,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre visible"}),s.jsx("input",{type:"text",value:t.display_name||"",onChange:f=>n(p=>({...p,display_name:f.target.value})),placeholder:"Ej: Linea principal",disabled:!t.id})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Phone ID"}),s.jsx("input",{type:"text",value:(y==null?void 0:y.phone_number_id)||"",readOnly:!0,disabled:!0})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:!!t.is_default,onChange:f=>n(p=>({...p,is_default:f.target.checked})),disabled:!t.id}),"Marcar como principal"]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:!!t.is_active,onChange:f=>n(p=>({...p,is_active:f.target.checked})),disabled:!t.id}),"Linea activa"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"primary",type:"submit",disabled:!t.id,children:"Guardar cambios"}),s.jsx("button",{className:"ghost",type:"button",disabled:!t.id,onClick:b,children:"Cancelar"})]})]})]})]})]})}function ly(){var O,P,b,f,p,v,j,R,$,A;const[e,t]=h.useState([]),[n,r]=h.useState(null),[a,i]=h.useState(!0),[l,c]=h.useState("");h.useEffect(()=>{u()},[]);async function u(){i(!0);try{const[N,V]=await Promise.all([je("/api/admin/bots"),je("/api/admin/bots/metrics")]);t(N.bots||[]),r(V.metrics),c("")}catch(N){console.error(N),c(N.message||"Error al cargar datos")}finally{i(!1)}}async function m(N,V){try{await ot(`/api/admin/bots/${N}`,{is_active:V}),t(I=>I.map(Y=>Y.id===N?{...Y,is_active:V}:Y))}catch(I){c(I.message||"Error al cambiar estado")}}const S=N=>{if(!N)return"Sin actividad reciente";const V=new Date(N),Y=new Date-V,he=Math.floor(Y/6e4);if(he<1)return"Hace un momento";if(he<60)return`ltima actividad: hace ${he} min`;const fe=Math.floor(he/60);return fe<24?`ltima actividad: hace ${fe}h`:`ltima actividad: ${V.toLocaleDateString()}`},g=e.filter(N=>N.is_active).length,y=g>0?"ACTIVO":"INACTIVO",E=g>0?"active":"inactive";return s.jsxs("div",{className:"bot-section",children:[s.jsxs("div",{className:"bot-section-header",children:[s.jsxs("div",{className:"bot-section-title-area",children:[s.jsx("div",{className:"bot-section-icon",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"bot-section-title",children:"Gestin de Bots"}),s.jsx("p",{className:"bot-section-subtitle",children:"Administra los flujos automatizados y el rendimiento tcnico."})]})]}),s.jsxs("div",{className:"bot-section-global-toggle",children:[s.jsx("span",{className:"bot-toggle-label",children:"ESTADO DEL BOT:"}),s.jsxs("div",{className:`bot-toggle-pill ${E}`,children:[s.jsx("span",{className:"bot-toggle-dot"}),s.jsx("span",{children:y})]})]})]}),l&&s.jsx("div",{className:"bot-error",children:l}),s.jsxs("div",{className:"bot-section-content",children:[s.jsxs("div",{className:"bot-flows-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MONITOREO DE FLUJOS"})}),a?s.jsx("div",{className:"bot-loading",children:"Cargando bots..."}):e.length===0?s.jsxs("div",{className:"bot-empty",children:[s.jsx("p",{children:"No hay bots asignados a tu cuenta."}),s.jsx("p",{className:"bot-empty-hint",children:"Contacta con soporte si necesitas activar un bot."})]}):s.jsx("div",{className:"bot-flows-list",children:e.map(N=>s.jsxs("div",{className:"bot-flow-card",children:[s.jsxs("div",{className:"bot-flow-info",children:[s.jsx("span",{className:"bot-flow-icon",children:N.flow_icon||""}),s.jsxs("div",{children:[s.jsx("div",{className:"bot-flow-name",children:N.flow_name}),s.jsxs("div",{className:`bot-flow-status ${N.is_active?"active":"inactive"}`,children:[" ",N.is_active?"ACTIVO":"INACTIVO"]})]})]}),s.jsx("div",{className:"bot-flow-actions",children:s.jsxs("label",{className:"bot-toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:N.is_active,onChange:()=>m(N.id,!N.is_active)}),s.jsx("span",{className:"bot-toggle-slider"})]})}),s.jsx("div",{className:"bot-flow-meta",children:S(N.updated_at)}),N.flow_description&&s.jsx("div",{className:"bot-flow-desc",children:N.flow_description})]},N.id))})]}),s.jsxs("div",{className:"bot-metrics-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MTRICAS DE EFICACIA DETALLADAS"})}),s.jsxs("div",{className:"bot-metrics-grid",children:[s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:`bot-metric-badge ${((O=n==null?void 0:n.interactions)==null?void 0:O.change)>=0?"positive":"neutral"}`,children:[((P=n==null?void 0:n.interactions)==null?void 0:P.change)>0?"+":"",(b=n==null?void 0:n.interactions)==null?void 0:b.change,"% ",(f=n==null?void 0:n.interactions)==null?void 0:f.label]}),s.jsx("div",{className:"bot-metric-label",children:"INTERACCIONES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.interactions.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"Total de sesiones iniciadas hoy"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge neutral",children:["Objetivo: ",(p=n==null?void 0:n.resolution)==null?void 0:p.target,"%"]}),s.jsx("div",{className:"bot-metric-label",children:"RESOLUCIN FINAL"}),s.jsxs("div",{className:"bot-metric-value",children:[n?n.resolution.value:"--","%"]}),s.jsx("div",{className:"bot-metric-progress",children:s.jsx("div",{className:"bot-metric-progress-fill",style:{width:`${n?n.resolution.value:0}%`}})})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge sla",children:[" ",(v=n==null?void 0:n.uptime)==null?void 0:v.status]}),s.jsx("div",{className:"bot-metric-label",children:"VIDA DEL PROCESO"}),s.jsx("div",{className:"bot-metric-value",children:n?n.uptime.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"UPTIME SISTEMA"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:`bot-metric-icon ${((j=n==null?void 0:n.errors)==null?void 0:j.value)>0?"error":""}`,children:""}),s.jsx("div",{className:`bot-metric-badge ${((R=n==null?void 0:n.errors)==null?void 0:R.value)===0?"stable":"neutral"}`,children:($=n==null?void 0:n.errors)==null?void 0:$.status}),s.jsx("div",{className:"bot-metric-label",children:"ERRORES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.errors.value:"--"}),s.jsxs("div",{className:`bot-metric-sub ${((A=n==null?void 0:n.errors)==null?void 0:A.critical)>0?"error-sub":""}`,children:["CRTICOS: ",n?n.errors.critical:0]})]})]})]})]})]})}const Ih={DRAFT:{bg:"#e3e8ef",text:"#475569",label:"BORRADOR"},PENDING:{bg:"#fef3c7",text:"#d97706",label:"PENDIENTE"},APPROVED:{bg:"#d1fae5",text:"#059669",label:"APROBADA"},REJECTED:{bg:"#fee2e2",text:"#dc2626",label:"RECHAZADA"},PAUSED:{bg:"#fef3c7",text:"#d97706",label:"PAUSADA"},DISABLED:{bg:"#e5e7eb",text:"#6b7280",label:"DESHABILITADA"}},oy=[{value:"UTILITY",label:"Utility"},{value:"MARKETING",label:"Marketing"},{value:"AUTHENTICATION",label:"Authentication"}],cy=[{value:"es",label:"Espaol (ES)"},{value:"en",label:"English (EN)"}];function uy({templates:e=[],templateForm:t,setTemplateForm:n,handleTemplateSubmit:r,handleTemplateSubmitToMeta:a,handleTemplateDelete:i,handleSyncTemplates:l,onLoadTemplates:c,brandName:u=""}){var q;const m=(u||"PODOPIE").trim(),[S,g]=h.useState("list"),[y,E]=h.useState(null),[O,P]=h.useState(""),[b,f]=h.useState(!1),[p,v]=h.useState(""),[j,R]=h.useState(!1),[$,A]=h.useState(!1),[N,V]=h.useState(null),[I,Y]=h.useState({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),[he,fe]=h.useState([]);h.useEffect(()=>{c&&c()},[]);const Se=async()=>{f(!0);try{await l()}finally{f(!1)}},ke=()=>{E(null),Y({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),fe([]),g("editor")},Ee=k=>{E(k),Y({name:k.name||"",category:k.category||"UTILITY",language:k.language||"es",body_text:k.body_text||k.body_preview||"",header_type:k.header_type||"",header_content:k.header_content||"",footer_text:k.footer_text||"",buttons:k.buttons_json||[]}),fe(k.variable_mappings||[]),g("editor")},Me=async k=>{!(k!=null&&k.id)||!i||!window.confirm(`Eliminar la plantilla "${k.name}"? Esta accin la ocultar localmente y la eliminar de Meta si aplica.`)||await i(k.id)},W=async k=>{k.preventDefault();const U={...I,id:y==null?void 0:y.id,variable_mappings:he};if(n&&n(U),r){const Q=await r(null,U);Q&&E(Q)}},te=async()=>{if(a){R(!0);try{let k=y==null?void 0:y.id;if(!k){const U={...I,variable_mappings:he},Q=await r(null,U);k=Q==null?void 0:Q.id,Q&&E(Q)}k&&(await a(k),g("list"),E(null))}finally{R(!1)}}},Z=()=>{g("list"),E(null)},ce=k=>{const U=(k==null?void 0:k.buttons_json)??(k==null?void 0:k.buttons)??[];if(Array.isArray(U))return U;if(typeof U=="string")try{const Q=JSON.parse(U);return Array.isArray(Q)?Q:[]}catch{return[]}return[]},be=(k=>{const U=k.match(/\{\{(\d+)\}\}/g)||[];return[...new Set(U)].map(Q=>parseInt(Q.replace(/[{}]/g,"")))})(I.body_text),T=e.filter(k=>{var B;const U=!O||((B=k.name)==null?void 0:B.toLowerCase().includes(O.toLowerCase()))||(k.body_text||k.body_preview||"").toLowerCase().includes(O.toLowerCase()),Q=!p||k.status===p;return U&&Q});return S==="list"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"templates-section",children:[s.jsxs("div",{className:"templates-header",children:[s.jsxs("div",{className:"templates-title-row",children:[s.jsx("h1",{children:"Plantillas de Meta"}),s.jsxs("span",{className:"meta-connected-badge",children:[s.jsx("span",{className:"status-dot"}),"CONECTADO A META API"]})]}),s.jsxs("div",{className:"templates-actions",children:[s.jsx("div",{className:"search-input-wrap",children:s.jsx("input",{type:"text",placeholder:"Buscar plantillas...",value:O,onChange:k=>P(k.target.value)})}),s.jsxs("select",{value:p,onChange:k=>v(k.target.value),className:"status-filter-select",children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"APPROVED",children:"Aprobadas"}),s.jsx("option",{value:"PENDING",children:"Pendientes"}),s.jsx("option",{value:"REJECTED",children:"Rechazadas"}),s.jsx("option",{value:"DRAFT",children:"Borradores"})]}),s.jsx("button",{className:"btn-sync",onClick:Se,disabled:b,children:b?" Sincronizando...":" Sincronizar"}),s.jsxs("button",{className:"btn-create-template",onClick:ke,children:[s.jsx("span",{children:"+"})," Crear Nueva Plantilla"]})]})]}),s.jsxs("div",{className:"templates-grid",children:[T.map(k=>{var Q;const U=Ih[k.status]||Ih.DRAFT;return s.jsxs("div",{className:"template-card",onClick:()=>Ee(k),children:[s.jsxs("div",{className:"template-card-head",children:[s.jsx("div",{className:"template-category-icon",children:k.category==="MARKETING"?"":k.category==="UTILITY"?"":""}),s.jsx("span",{className:"template-status-badge",style:{backgroundColor:U.bg,color:U.text},children:U.label})]}),s.jsx("h3",{className:"template-card-name",children:k.name}),s.jsxs("div",{className:"template-card-meta",children:[s.jsx("span",{className:"tag-category",children:k.category}),s.jsx("span",{className:"tag-language",children:k.language==="es"?"ESPAOL (ES)":(Q=k.language)==null?void 0:Q.toUpperCase()})]}),(k.body_text||k.body_preview)&&s.jsxs("p",{className:"template-card-preview",children:[(k.body_text||k.body_preview).slice(0,80),"..."]}),s.jsxs("div",{className:"template-card-actions",children:[s.jsx("button",{className:"btn-preview",onClick:B=>{B.stopPropagation(),V(k),A(!0)},children:"Vista previa"}),s.jsx("button",{className:"btn-preview danger",onClick:B=>{B.stopPropagation(),Me(k)},children:"Eliminar"})]})]},k.id)}),s.jsxs("div",{className:"template-card template-card-create",onClick:ke,children:[s.jsx("div",{className:"create-icon",children:"+"}),s.jsx("h3",{children:"Crear nueva plantilla"}),s.jsx("p",{children:"Empieza a disear tu flujo de WhatsApp"})]})]}),T.length===0&&!O&&s.jsx("div",{className:"templates-empty",children:s.jsx("p",{children:"No hay plantillas. Crea una nueva o sincroniza desde Meta."})})]}),$&&s.jsx("div",{className:"modal-overlay",onClick:()=>A(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:k=>k.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Vista previa"}),s.jsx("button",{className:"modal-close",onClick:()=>A(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:m}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(N==null?void 0:N.body_preview)||(N==null?void 0:N.body_text)||"Sin previsualizacin disponible."}),ce(N).length>0&&s.jsx("div",{className:"preview-actions",children:ce(N).map((k,U)=>s.jsx("button",{type:"button",children:k.text||k.label||k.title||`Botn ${U+1}`},`prev-${U}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})})]}):s.jsxs("div",{className:"template-editor",children:[s.jsxs("div",{className:"editor-header",children:[s.jsxs("div",{className:"editor-breadcrumb",children:[s.jsx("button",{className:"btn-back",onClick:Z,children:" Volver"}),s.jsx("span",{className:"breadcrumb-sep",children:"/"}),s.jsx("span",{children:y?"Editar Plantilla":"Nueva Plantilla"})]}),s.jsxs("div",{className:"editor-actions",children:[s.jsx("button",{className:"btn-save-draft",onClick:W,children:" Guardar Borrador"}),((y==null?void 0:y.status)==="DRAFT"||(y==null?void 0:y.status)==="REJECTED"||!y)&&s.jsx("button",{className:"btn-primary",onClick:te,disabled:j||!I.name||!I.body_text,children:j?"Enviando...":"Enviar a Meta"}),s.jsx("button",{className:"btn-discard",onClick:Z,children:" Descartar"})]})]}),s.jsxs("div",{className:"editor-layout",children:[s.jsxs("div",{className:"editor-form-panel",children:[s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" General Settings"}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Template Name"}),s.jsx("input",{type:"text",placeholder:"patient_appointment_reminder",value:I.name,onChange:k=>Y({...I,name:k.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")})})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Category"}),s.jsx("select",{value:I.category,onChange:k=>Y({...I,category:k.target.value}),children:oy.map(k=>s.jsx("option",{value:k.value,children:k.label},k.value))})]}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Language"}),s.jsx("select",{value:I.language,onChange:k=>Y({...I,language:k.target.value}),children:cy.map(k=>s.jsx("option",{value:k.value,children:k.label},k.value))})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("div",{className:"form-section-header",children:[s.jsx("h3",{children:" Message Body"}),s.jsx("button",{className:"btn-insert-var",type:"button",onClick:()=>{const k=be.length+1;Y({...I,body_text:I.body_text+`{{${k}}}`})},children:"+ Insert Variable"})]}),s.jsx("textarea",{rows:"6",placeholder:`Hola {{1}}, te recordamos tu cita en ${m} para el da {{2}} a las {{3}}. Por favor, confirma tu asistencia.`,value:I.body_text,onChange:k=>Y({...I,body_text:k.target.value})}),s.jsxs("div",{className:"char-count",children:[I.body_text.length," / 1024"]})]})]}),s.jsxs("div",{className:"editor-preview-panel",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:m}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:I.body_text||"Tu mensaje aparecer aqu..."}),I.buttons&&I.buttons.length>0&&s.jsx("div",{className:"preview-actions",children:I.buttons.map((k,U)=>s.jsx("button",{type:"button",children:k.text||k.title||`Botn ${U+1}`},`btn-${U}`))}),s.jsx("div",{className:"preview-time",children:"10:42 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:I.name||"Sin nombre"})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Idioma"}),s.jsx("strong",{children:((q=I.language)==null?void 0:q.toUpperCase())||"ES"})]})]})]}),s.jsxs("div",{className:"editor-mapping-panel",children:[s.jsxs("div",{className:"mapping-tabs",children:[s.jsx("button",{className:"tab active",children:"VARIABLES"}),s.jsx("button",{className:"tab",children:"BUTTONS"})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsx("h4",{children:"ODOO FIELD MAPPING"}),be.length===0?s.jsxs("p",{className:"mapping-empty",children:["Agrega variables ","{{1}}",", ","{{2}}","... en tu mensaje"]}):be.map(k=>{const U=he.find(Q=>Q.var_index===k)||{};return s.jsxs("div",{className:"mapping-item",children:[s.jsxs("div",{className:"mapping-var-badge",children:[`{{${k}}}`," Variable"]}),s.jsxs("select",{value:U.source_path||"",onChange:Q=>{const B=he.filter(ne=>ne.var_index!==k);B.push({var_index:k,source_type:"odoo",source_path:Q.target.value}),fe(B)},children:[s.jsx("option",{value:"",children:"Select Odoo Field..."}),s.jsx("option",{value:"partner_id.name",children:"patient_id.name"}),s.jsx("option",{value:"start_date",children:"start_date (Formatted)"}),s.jsx("option",{value:"start_time",children:"start_time"}),s.jsx("option",{value:"partner_id.phone",children:"patient_phone"})]}),s.jsx("span",{className:`mapping-status ${U.source_path?"linked":"needs"}`,children:U.source_path?" Linked":" Needs mapping"})]},k)})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsxs("div",{className:"mapping-section-header",children:[s.jsx("h4",{children:"ACTION BUTTONS"}),s.jsx("button",{className:"btn-add-button",onClick:()=>{Y({...I,buttons:[...I.buttons||[],{type:"QUICK_REPLY",text:""}]})},children:"+ Add Button"})]}),(I.buttons||[]).map((k,U)=>s.jsxs("div",{className:"button-item",children:[s.jsx("span",{className:"button-icon",children:""}),s.jsx("input",{type:"text",placeholder:"Button text",value:k.text||"",onChange:Q=>{const B=[...I.buttons];B[U]={...B[U],text:Q.target.value},Y({...I,buttons:B})}}),s.jsx("button",{className:"btn-remove",onClick:()=>{const Q=I.buttons.filter((B,ne)=>ne!==U);Y({...I,buttons:Q})},children:""})]},U))]}),s.jsxs("div",{className:"mapping-tip",children:[s.jsx("span",{className:"tip-icon",children:""}),s.jsx("span",{children:"Tip: Asegrate de que tus variables estn correctamente mapeadas a campos de Odoo antes de enviar."})]})]})]})]})}const Mh={campaigns:"",users:"",bot:"",chat:"",templates:"",audience:"",system:""},dy={"user.created":"USUARIO CREADO","user.updated":"USUARIO EDITADO","user.disabled":"USUARIO ELIMINADO",template_draft_created:"PLANTILLA CREADA",template_draft_updated:"PLANTILLA EDITADA",template_submitted:"PLANTILLA ENVIADA",template_deleted:"PLANTILLA ELIMINADA",template_restored:"PLANTILLA RESTAURADA",audience_created:"SEGMENTO CREADO",audience_updated:"SEGMENTO EDITADO",audience_deleted:"SEGMENTO ELIMINADO","campaign.created":"CAMPAA CREADA","campaign.queued":"CAMPAA EN COLA","campaign.sending":"CAMPAA LANZADA","settings.updated":"CONFIG ACTUALIZADA","role_permissions.updated":"PERMISOS CAMBIADOS","role_permissions.deleted":"ROL ELIMINADO","conversation.status_changed":"CHAT ACTUALIZADO","conversation.tag_added":"TAG AGREGADO","conversation.tag_removed":"TAG ELIMINADO"};function Nm(e){var r;const t=((r=e==null?void 0:e.data_json)==null?void 0:r.entity)||"";if(t==="template")return"templates";if(t==="audience")return"audience";if(t==="campaign")return"campaigns";if(t==="conversation")return"chat";const n=(e==null?void 0:e.action)||"";return n.includes("user")?"users":n.includes("campaign")?"campaigns":n.includes("template")?"templates":n.includes("audience")?"audience":n.includes("bot")?"bot":n.includes("conversation")?"chat":"system"}function cc(e){if(!e)return{date:"--",time:"--"};const t=new Date(e);return Number.isNaN(t.getTime())?{date:"--",time:"--"}:{date:t.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}),time:t.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}}function hy(e,t="csv"){const r=[["timestamp","usuario","email","accion","modulo","data"].join(",")];e.forEach(m=>{var O,P;const S=((O=m.user)==null?void 0:O.name)||"Sistema",g=((P=m.user)==null?void 0:P.email)||"",y=Nm(m),E=[new Date(m.created_at).toISOString(),S,g,m.action,y,JSON.stringify(m.data_json||{})];r.push(E.map(b=>`"${String(b).replace(/"/g,'""')}"`).join(","))});const a=r.join(`
`),i=t==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv;charset=utf-8;",l=t==="excel"?"audit_logs.xlsx":"audit_logs.csv",c=new Blob([a],{type:i}),u=document.createElement("a");u.href=URL.createObjectURL(c),u.download=l,document.body.appendChild(u),u.click(),document.body.removeChild(u)}function fy(){var $,A;const[e,t]=h.useState(""),[n,r]=h.useState(""),[a,i]=h.useState(""),[l,c]=h.useState(1),[u]=h.useState(6),[m,S]=h.useState(0),[g,y]=h.useState([]),[E,O]=h.useState(!1),[P,b]=h.useState(null),f=Math.max(1,Math.ceil(m/u)),p=async({pageOverride:N}={})=>{O(!0);try{const V=new URLSearchParams;V.set("page",String(N||l)),V.set("page_size",String(u)),e.trim()&&V.set("q",e.trim()),n&&V.set("from",n),a&&V.set("to",a);const I=await je(`/api/admin/audit?${V.toString()}`);y(I.logs||[]),S(I.total||0)}finally{O(!1)}};h.useEffect(()=>{p()},[l]);const v=()=>{c(1),p({pageOverride:1})},j=async(N="csv")=>{const V=new URLSearchParams;V.set("page","1"),V.set("page_size","1000"),e.trim()&&V.set("q",e.trim()),n&&V.set("from",n),a&&V.set("to",a);const I=await je(`/api/admin/audit?${V.toString()}`);hy(I.logs||[],N)},R=h.useMemo(()=>{const N=[],V=Math.max(1,l-1),I=Math.min(f,V+2);for(let Y=V;Y<=I;Y+=1)N.push(Y);return N},[l,f]);return s.jsxs("div",{className:"audit-module",children:[s.jsxs("div",{className:"audit-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-title",children:"Registros / Auditoria"}),s.jsx("div",{className:"audit-subtitle",children:"Monitorea acciones de usuarios y eventos del sistema"})]}),s.jsxs("div",{className:"audit-export-group",children:[s.jsx("button",{className:"audit-export",type:"button",onClick:()=>j("excel"),children:" Exportar Excel"}),s.jsx("button",{className:"audit-export outline",type:"button",onClick:()=>j("csv"),children:" Exportar CSV"})]})]}),s.jsxs("div",{className:"audit-filters",children:[s.jsxs("div",{className:"audit-search",children:[s.jsx("span",{className:"audit-search-icon"}),s.jsx("input",{type:"text",placeholder:"Filtrar por usuario o accion..",value:e,onChange:N=>t(N.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Desde"}),s.jsx("input",{type:"date",value:n,onChange:N=>r(N.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Hasta"}),s.jsx("input",{type:"date",value:a,onChange:N=>i(N.target.value)})]}),s.jsx("button",{className:"audit-filter-btn",type:"button",onClick:v,children:"Filtrar"})]}),s.jsxs("div",{className:"audit-card",children:[s.jsxs("div",{className:"audit-table-head",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("span",{children:"Usuario"}),s.jsx("span",{children:"Accion"}),s.jsx("span",{children:"Modulo"})]}),E&&s.jsx("div",{className:"audit-empty",children:"Cargando registros..."}),!E&&!g.length&&s.jsx("div",{className:"audit-empty",children:"Sin registros para mostrar"}),!E&&g.map(N=>{var Se,ke;const V=cc(N.created_at),I=Nm(N),Y=dy[N.action]||N.action,he=((Se=N.user)==null?void 0:Se.name)||"System Bot",fe=((ke=N.user)==null?void 0:ke.email)||"automated@service";return s.jsxs("button",{type:"button",className:"audit-row",onClick:()=>b(N),children:[s.jsxs("div",{className:"audit-cell time",children:[s.jsx("div",{children:V.date}),s.jsx("div",{className:"audit-time",children:V.time})]}),s.jsxs("div",{className:"audit-cell user",children:[s.jsx("div",{className:"audit-avatar",children:(he==null?void 0:he[0])||"S"}),s.jsxs("div",{children:[s.jsx("div",{className:"audit-user-name",children:he}),s.jsx("div",{className:"audit-user-email",children:fe})]})]}),s.jsx("div",{className:"audit-cell action",children:s.jsx("span",{className:"audit-action-pill",children:Y})}),s.jsxs("div",{className:"audit-cell module",children:[s.jsx("span",{className:"audit-module-icon",children:Mh[I]||Mh.system}),I.charAt(0).toUpperCase()+I.slice(1)]})]},N.id)})]}),s.jsxs("div",{className:"audit-footer",children:[s.jsxs("div",{children:["Mostrando ",g.length," de ",m," registros"]}),s.jsxs("div",{className:"audit-pagination",children:[s.jsx("button",{type:"button",disabled:l<=1,onClick:()=>c(N=>Math.max(1,N-1)),children:""}),R.map(N=>s.jsx("button",{type:"button",className:N===l?"active":"",onClick:()=>c(N),children:N},N)),s.jsx("button",{type:"button",disabled:l>=f,onClick:()=>c(N=>Math.min(f,N+1)),children:""})]})]}),P&&s.jsx("div",{className:"audit-modal",children:s.jsxs("div",{className:"audit-modal-card",children:[s.jsxs("div",{className:"audit-modal-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-modal-title",children:"Detalle del registro"}),s.jsx("div",{className:"audit-modal-subtitle",children:P.action})]}),s.jsx("button",{type:"button",onClick:()=>b(null),children:""})]}),s.jsxs("div",{className:"audit-modal-body",children:[s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Usuario"}),s.jsx("strong",{children:(($=P.user)==null?void 0:$.name)||"System Bot"}),s.jsx("small",{children:((A=P.user)==null?void 0:A.email)||"automated@service"})]}),s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("strong",{children:cc(P.created_at).date}),s.jsx("small",{children:cc(P.created_at).time})]}),s.jsxs("div",{className:"audit-detail full",children:[s.jsx("span",{children:"Data"}),s.jsx("pre",{children:JSON.stringify(P.data_json||{},null,2)})]})]})]})})]})}function py(){return s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Integracion Odoo"}),s.jsx("div",{className:"empty-state",children:"Seccion en construccion"})]})}function my(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("line",{x1:"4",y1:"6",x2:"20",y2:"6",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"6",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"18",x2:"20",y2:"18",strokeWidth:"2"}),s.jsx("circle",{cx:"11",cy:"18",r:"2",strokeWidth:"2"})]})}function vy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"9",cy:"8",r:"3",strokeWidth:"2"}),s.jsx("path",{d:"M4 20c0-3 2.7-5.5 6-5.5s6 2.5 6 5.5",strokeWidth:"2"}),s.jsx("circle",{cx:"17",cy:"9",r:"2",strokeWidth:"2"}),s.jsx("path",{d:"M14 20c0-1.8 1.4-3.4 3.2-4",strokeWidth:"2"})]})}function gy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"2"})]})}function xy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"4",width:"12",height:"16",rx:"2",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"9",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"13",x2:"15",y2:"13",strokeWidth:"2"})]})}function yy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"5",width:"12",height:"15",rx:"2",strokeWidth:"2"}),s.jsx("path",{d:"M9 5h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 10h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 14h6",strokeWidth:"2"})]})}function jy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M8 4h4a2 2 0 1 1 0 4h-1v2h2a2 2 0 1 1 0 4h-2v2H8a2 2 0 1 1-4 0V8a2 2 0 1 1 4 0z",strokeWidth:"2"})})}function Ny({settingsSection:e,setSettingsSection:t,settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,currentRole:l,isAdmin:c,adminUsers:u,userForm:m,setUserForm:S,roleOptions:g,handleUserSubmit:y,settings:E,setSettings:O,handleSaveSettings:P,templates:b,templateForm:f,setTemplateForm:p,handleTemplateSubmit:v,handleTemplateSubmitToMeta:j,handleTemplateDelete:R,handleSyncTemplates:$,auditLogs:A,formatDate:N,planName:V,tenantChannels:I,channelForm:Y,setChannelForm:he,handleChannelSelect:fe,handleChannelSubmit:Se,handleChannelQuickUpdate:ke,handleUserDelete:Ee,defaultRolePermissions:Me,handleRoleDelete:W,useShellLayout:te=!1,pageError:Z,isOffline:ce=!1,onDismissError:le,brandName:be=""}){const T=a==null?void 0:a[l],q=[{title:"Principal",items:[{id:"general",label:"General",icon:my},{id:"users",label:"Gestion de Usuarios",icon:vy},{id:"bot",label:"Configuracion de Bot",icon:gy}]},{title:"Canales e Integraciones",items:[{id:"templates",label:"Plantillas de Meta",icon:xy},{id:"audit",label:"Registros / Auditoria",icon:yy},{id:"odoo",label:"Integracion Odoo",icon:jy}]}];function k(B){var ne,ue;return!!((ue=(ne=T==null?void 0:T.settings)==null?void 0:ne[B])!=null&&ue.read)}function U(B){k(B)&&t(B)}const Q=s.jsxs(s.Fragment,{children:[s.jsxs("aside",{className:"settings-sidebar",children:[s.jsxs("div",{className:"settings-header",children:[s.jsx("div",{className:"settings-title",children:"CONFIGURACION"}),s.jsxs("div",{className:"settings-version",children:[(be||"Empresa").toUpperCase()," OS V2.0"]})]}),q.map(B=>s.jsxs("div",{className:"settings-group",children:[s.jsx("div",{className:"settings-group-title",children:B.title}),s.jsx("div",{className:"settings-group-list",children:B.items.map(ne=>{const ue=!k(ne.id),He=ne.icon;return s.jsxs("button",{className:`settings-item ${e===ne.id?"active":""}`,type:"button",onClick:()=>U(ne.id),disabled:ue,children:[s.jsx("span",{className:"settings-icon","aria-hidden":"true",children:s.jsx(He,{className:"settings-icon-svg"})}),ne.label]},ne.id)})})]},B.title)),s.jsxs("div",{className:"settings-plan",children:[s.jsx("div",{className:"settings-plan-label",children:"Plan actual"}),s.jsx("div",{className:"settings-plan-name",children:V||"Sin plan"})]})]}),s.jsxs("div",{className:"settings-content",children:[e==="users"&&s.jsx(ry,{settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,isAdmin:c,adminUsers:u,userForm:m,setUserForm:S,roleOptions:g,handleUserSubmit:y,handleUserDelete:Ee,defaultRolePermissions:Me,handleRoleDelete:W}),e==="general"&&s.jsx(iy,{tenantChannels:I,channelForm:Y,setChannelForm:he,handleChannelSelect:fe,handleChannelSubmit:Se,handleChannelQuickUpdate:ke}),e==="bot"&&s.jsx(ly,{settings:E,setSettings:O,handleSaveSettings:P}),e==="templates"&&s.jsx(uy,{templates:b,templateForm:f,setTemplateForm:p,handleTemplateSubmit:v,handleTemplateSubmitToMeta:j,handleTemplateDelete:R,handleSyncTemplates:$,brandName:be}),e==="audit"&&s.jsx(fy,{auditLogs:A,formatDate:N}),e==="odoo"&&s.jsx(py,{}),ce?s.jsx(Fa,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):Z?s.jsx(Fa,{variant:"error",title:"Ocurri un problema",message:Z,dismissLabel:"Cerrar",onDismiss:le}):null]})]});return te?Q:s.jsx("section",{className:"settings-layout",children:Q})}function wy(){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"1.8"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"1.8"})]})}function _y({tenantId:e,tenantBots:t,availableFlows:n,loading:r,onAddBot:a,onRemoveBot:i,onUpdateBotConfig:l}){const[c,u]=h.useState(""),[m,S]=h.useState("openai"),[g,y]=h.useState(""),[E,O]=h.useState({}),P=new Set(t.map(A=>A.flow_id)),b=n.filter(A=>!P.has(A.id)),f=h.useMemo(()=>new Map(n.map(A=>[A.id,A])),[n]),p=b.find(A=>A.id===c),v=!!(p!=null&&p.requires_ai);function j(){if(!c)return;a(c,v?{ai:{provider:m,key:g||void 0}}:null),u(""),y("")}function R(A,N){O(V=>({...V,[A]:{...V[A]||{},...N}}))}function $(A){var he,fe;if(!l)return;const N=E[A.id]||{},V=N.provider||((fe=(he=A.config)==null?void 0:he.ai)==null?void 0:fe.provider)||"openai",I=N.key||"",Y={ai:{provider:V,...I?{key:I}:{}}};l(A.id,Y),R(A.id,{key:""})}return s.jsxs("section",{className:"sa-bot-card","data-tenant":e||"",children:[s.jsxs("header",{className:"sa-bot-header",children:[s.jsx("div",{className:"sa-bot-icon-large","aria-hidden":"true",children:s.jsx(wy,{})}),s.jsxs("div",{className:"sa-bot-title-group",children:[s.jsx("h3",{children:"Asignacion de Bots"}),s.jsx("p",{children:"Selecciona que flujos estaran disponibles para este cliente. Los flujos asignados apareceran inmediatamente en el panel del usuario."})]})]}),s.jsx("div",{className:"sa-bot-body",children:r?s.jsx("div",{className:"sa-bot-loading",children:"Cargando asignaciones..."}):t.length===0?s.jsxs("div",{className:"sa-bot-empty",children:[s.jsx("div",{className:"sa-bot-empty-icon",children:"+"}),s.jsx("div",{className:"sa-bot-empty-title",children:"Sin bots asignados"}),s.jsx("div",{className:"sa-bot-empty-sub",children:"Agrega un flujo desde el selector para activarlo en este tenant."})]}):s.jsx("div",{className:"sa-bot-grid",children:t.map(A=>{var N,V,I,Y,he,fe,Se;return s.jsxs("div",{className:"sa-assigned-bot",children:[s.jsx("div",{className:"sa-bot-item-icon",children:A.flow_icon||">"}),s.jsxs("div",{className:"sa-bot-item-info",children:[s.jsx("span",{className:"sa-bot-item-name",children:A.flow_name||A.flow_id}),s.jsx("span",{className:"sa-bot-item-desc",children:A.flow_description||"Sin descripcion"}),((N=f.get(A.flow_id))==null?void 0:N.requires_ai)&&s.jsxs("div",{className:"sa-bot-ai-config",children:[s.jsxs("div",{className:"sa-ai-field",children:[s.jsx("label",{className:"sa-select-label",children:"Proveedor IA"}),s.jsxs("select",{className:"sa-select-styled",value:((V=E[A.id])==null?void 0:V.provider)||((Y=(I=A.config)==null?void 0:I.ai)==null?void 0:Y.provider)||"openai",onChange:ke=>R(A.id,{provider:ke.target.value}),children:[s.jsx("option",{value:"openai",children:"OpenAI"}),s.jsx("option",{value:"gemini",children:"Gemini"})]})]}),s.jsxs("div",{className:"sa-ai-field",children:[s.jsx("label",{className:"sa-select-label",children:"API Key"}),s.jsx("input",{type:"password",className:"sa-input",placeholder:(fe=(he=A.config)==null?void 0:he.ai)!=null&&fe.key_present?"******** (configurada)":"Pegue la API key",value:((Se=E[A.id])==null?void 0:Se.key)||"",onChange:ke=>R(A.id,{key:ke.target.value})})]}),s.jsx("button",{type:"button",className:"sa-btn-assign sa-btn-save",onClick:()=>$(A),children:"Guardar IA"})]})]}),s.jsx("button",{type:"button",className:"sa-btn-remove",title:"Quitar bot del cliente",onClick:()=>i(A.id),children:"Quitar"})]},A.id)})})}),s.jsxs("div",{className:"sa-bot-controls",children:[s.jsxs("div",{className:"sa-select-container",children:[s.jsx("label",{className:"sa-select-label",children:"Asignar bot"}),s.jsxs("select",{className:"sa-select-styled",value:c,onChange:A=>u(A.target.value),disabled:b.length===0,children:[s.jsx("option",{value:"",children:b.length===0?"No hay mas bots disponibles":"Selecciona un bot para asignar"}),b.map(A=>s.jsx("option",{value:A.id,children:A.name},A.id))]})]}),v&&s.jsxs("div",{className:"sa-ai-assign",children:[s.jsxs("div",{className:"sa-ai-field",children:[s.jsx("label",{className:"sa-select-label",children:"Proveedor IA"}),s.jsxs("select",{className:"sa-select-styled",value:m,onChange:A=>S(A.target.value),children:[s.jsx("option",{value:"openai",children:"OpenAI"}),s.jsx("option",{value:"gemini",children:"Gemini"})]})]}),s.jsxs("div",{className:"sa-ai-field",children:[s.jsx("label",{className:"sa-select-label",children:"API Key"}),s.jsx("input",{type:"password",className:"sa-input",placeholder:"Pegue la API key",value:g,onChange:A=>y(A.target.value)})]})]}),s.jsx("button",{type:"button",className:"sa-btn-assign",onClick:j,disabled:!c,children:"Asignar Bot"})]})]})}const Zt={name:"",slug:"",plan:"",db_url:"",phone_number_id:"",line_name:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",brand_name:"",logo_url:"",brand_primary:"#22d3ee",brand_accent:"#38bdf8",brand_bg:"#0b0f16",timezone:"",odoo_base_url:"",odoo_db_name:"",odoo_username:"",odoo_password:""},Sy=[{value:"starter",label:"Starter"},{value:"growth",label:"Growth"},{value:"scale",label:"Scale"},{value:"enterprise",label:"Enterprise"}];function ky(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"4",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"4",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"})]})}function du(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function by(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"3.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M19 12a7 7 0 0 0-.1-1.2l2-1.5-2-3.5-2.4.7a7.2 7.2 0 0 0-2-1.2L12 2 9.5 4.3a7.2 7.2 0 0 0-2 1.2l-2.4-.7-2 3.5 2 1.5A7 7 0 0 0 5 12c0 .4 0 .8.1 1.2l-2 1.5 2 3.5 2.4-.7a7.2 7.2 0 0 0 2 1.2L12 22l2.5-2.3a7.2 7.2 0 0 0 2-1.2l2.4.7 2-3.5-2-1.5c.1-.4.1-.8.1-1.2Z",strokeWidth:"1.2",strokeLinejoin:"round"})]})}function Cy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M16.5 16.5 20 20",strokeWidth:"1.6",strokeLinecap:"round"})]})}function Ey(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 12h12",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m13 6 6 6-6 6",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ay(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M18 6 6 18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m6 6 12 12",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ty(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56",strokeWidth:"1.8",strokeLinecap:"round"})})}function Dh(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Bh(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m2 2 20 20",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ly(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 18h.01",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ry(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m15 5 4 4",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Oy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M3 6h18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",strokeWidth:"1.8",strokeLinecap:"round"})]})}const zh={display_name:"",phone_number_id:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",is_active:!0,is_default:!1};function Py({isOpen:e,onClose:t,initialData:n,onSave:r,tenantId:a}){const[i,l]=h.useState(zh),[c,u]=h.useState(!1),[m,S]=h.useState(!1),[g,y]=h.useState(!1),[E,O]=h.useState(null);if(h.useEffect(()=>{e&&(l(n||{...zh}),O(null))},[e,n]),!e)return null;const P=async b=>{if(b.preventDefault(),y(!0),O(null),!i.phone_number_id||!i.verify_token||!n&&!i.wa_token){O("Los campos ID de Telfono, Verify Token y Access Token son obligatorios."),y(!1);return}try{await r({...i,tenant_id:a}),t()}catch(f){console.error("Error saving channel:",f),O(f.message||"Error al guardar la lnea.")}finally{y(!1)}};return s.jsx("div",{className:"sa-modal-overlay",onClick:t,children:s.jsxs("div",{className:"sa-modal-content",onClick:b=>b.stopPropagation(),children:[s.jsxs("div",{className:"sa-modal-header",children:[s.jsx("div",{className:"sa-modal-title",children:n?"Editar Lnea WhatsApp":"Nueva Lnea WhatsApp"}),s.jsx("button",{className:"sa-modal-close",onClick:t,children:s.jsx(Ay,{width:24,height:24})})]}),s.jsxs("div",{className:"sa-modal-body",children:[E&&s.jsx("div",{className:"sa-alert",style:{marginBottom:"1rem"},children:E}),s.jsxs("div",{className:"sa-form-grid",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre para mostrar (Opcional)"}),s.jsx("input",{value:i.display_name||"",onChange:b=>l({...i,display_name:b.target.value}),placeholder:"Ej: Ventas Principal"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Phone Number ID *"}),s.jsx("input",{value:i.phone_number_id||"",onChange:b=>l({...i,phone_number_id:b.target.value}),placeholder:"Identificador del nmero de telfono"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"WABA ID (WhatsApp Business Account ID)"}),s.jsx("input",{value:i.waba_id||"",onChange:b=>l({...i,waba_id:b.target.value}),placeholder:"Identificador de la cuenta de WhatsApp Business"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Verify Token (Webhook) *"}),s.jsx("input",{value:i.verify_token||"",onChange:b=>l({...i,verify_token:b.target.value}),placeholder:"Token de verificacin webhook"})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"Permanent Access Token *"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:c?"text":"password",value:i.wa_token||"",onChange:b=>l({...i,wa_token:b.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"Token de acceso permanente",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>u(!c),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:c?s.jsx(Bh,{width:18,height:18}):s.jsx(Dh,{width:18,height:18})})]})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"App Secret (Opcional)"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:m?"text":"password",value:i.app_secret||"",onChange:b=>l({...i,app_secret:b.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"App Secret de Meta",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>S(!m),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:m?s.jsx(Bh,{width:18,height:18}):s.jsx(Dh,{width:18,height:18})})]})]})]}),s.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"2rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_active,onChange:b=>l({...i,is_active:b.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Activa"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_default,onChange:b=>l({...i,is_default:b.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Principal (Por Defecto)"]})]})]}),s.jsxs("div",{className:"sa-modal-footer",children:[s.jsx("button",{className:"sa-btn ghost",onClick:t,disabled:g,children:"Cancelar"}),s.jsx("button",{className:"sa-btn primary",onClick:P,disabled:g,children:g?s.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(Ty,{width:16,height:16,className:"animate-spin"})," Guardando..."]}):"Guardar Lnea"})]})]})})}function Iy({channels:e=[],tenantId:t,onRefresh:n}){const[r,a]=h.useState(!1),[i,l]=h.useState(null),c=()=>{l(null),a(!0)},u=g=>{l(g),a(!0)},m=async g=>{i?await ot(`/api/superadmin/channels/${i.id}`,g):await Te("/api/superadmin/channels",g),await n()},S=async g=>{if(confirm("Ests seguro de que deseas eliminar esta lnea? Esta accin no se puede deshacer."))try{await ks(`/api/superadmin/channels/${g}`),await n()}catch(y){console.error("Error deleting channel:",y),alert("No se pudo eliminar la lnea.")}};return s.jsxs("section",{className:"sa-lines-card",children:[s.jsxs("header",{className:"sa-lines-header",children:[s.jsxs("div",{className:"sa-lines-title",children:[s.jsx("div",{className:"sa-lines-icon",children:s.jsx(Ly,{width:24,height:24})}),s.jsxs("div",{children:[s.jsx("h3",{children:"Lneas de WhatsApp Cloud"}),s.jsx("p",{children:"Gestiona las conexiones activas de WhatsApp para este tenant."})]})]}),s.jsxs("button",{className:"sa-btn primary",onClick:c,children:[s.jsx(du,{width:16,height:16,style:{marginRight:"0.5rem"}}),"Agregar Nueva Lnea"]})]}),s.jsx("div",{className:"sa-lines-body",children:s.jsxs("div",{className:"sa-lines-grid",children:[e.map(g=>s.jsxs("div",{className:`sa-line-card ${g.is_active?"":"opacity-75"}`,children:[s.jsxs("div",{className:"sa-line-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-line-name",children:g.display_name||"Sin nombre"}),s.jsxs("div",{className:"sa-line-meta",children:["ID: ",g.phone_number_id]})]}),s.jsx("div",{className:`sa-line-status ${g.is_active?"active":""}`,title:g.is_active?"Activo":"Inactivo"})]}),s.jsxs("div",{className:"sa-line-badges",children:[g.is_default&&s.jsx("span",{className:"sa-line-badge default",children:"DEFAULT"}),!g.is_active&&s.jsx("span",{className:"sa-status warn",children:"INACTIVO"})]}),s.jsxs("div",{className:"sa-line-details",children:[s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"WABA ID"}),s.jsx("span",{className:"sa-detail-value",children:g.waba_id||"-"})]}),s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"Verify Token"}),s.jsx("span",{className:"sa-detail-value",children:g.verify_token?`${g.verify_token.substring(0,16)}...`:"-"})]})]}),s.jsxs("div",{className:"sa-line-actions",children:[s.jsx("button",{className:"sa-btn ghost",onClick:()=>u(g),title:"Editar",children:s.jsx(Ry,{width:16,height:16})}),s.jsx("button",{className:"sa-btn ghost",onClick:()=>S(g.id),title:"Eliminar",style:{color:"#f87171"},children:s.jsx(Oy,{width:16,height:16})})]})]},g.id)),s.jsxs("button",{type:"button",className:"sa-line-add-card",onClick:c,children:[s.jsx("div",{className:"sa-add-icon-circle",children:s.jsx(du,{width:24,height:24})}),s.jsx("span",{children:"Nueva Conexin"})]})]})}),s.jsx(Py,{isOpen:r,onClose:()=>a(!1),initialData:i,onSave:m,tenantId:t})]})}function $h({route:e="/superadmin",onNavigate:t,onImpersonateTenant:n,onLogout:r=()=>{}}){const[a,i]=h.useState([]),[l,c]=h.useState([]),[u,m]=h.useState([]),[S,g]=h.useState(""),[y,E]=h.useState(""),[O,P]=h.useState("Verificacion de red: sistema ok"),[b,f]=h.useState(Zt),[p,v]=h.useState(!1),[j,R]=h.useState(!1),[$,A]=h.useState(""),[N,V]=h.useState(""),[I,Y]=h.useState(!0),[he,fe]=h.useState(Zt),[Se,ke]=h.useState(!0),[Ee,Me]=h.useState(!1),W=h.useRef(""),[te,Z]=h.useState([]),[ce,le]=h.useState([]),[be,T]=h.useState(!1),{pushToast:q}=dd(),k=h.useMemo(()=>{if(!e)return"";const _=e.match(/^\/superadmin\/tenants\/([^/]+)\/?$/)||e.match(/^\/superadmin\/tenant\/([^/]+)\/?$/)||e.match(/^\/superadmin\/edit\/([^/]+)\/?$/);return _?_[1]:""},[e]),U=e.startsWith("/superadmin/new"),Q=!!k,B=U||Q,ne=h.useCallback(_=>{if(t){t(_,{replace:!1});return}typeof window>"u"||window.history.pushState({},"",_)},[t]);async function ue(){try{const _=await je("/api/superadmin/tenants");i(_.tenants||[]);const F=await je("/api/superadmin/channels");c(F.channels||[]),E("")}catch(_){E(_.message||"No se pudo cargar datos.")}}h.useEffect(()=>{ue(),Je()},[]),h.useMemo(()=>{const _=new Map;return l.forEach(F=>{const G=_.get(F.tenant_id)||0;_.set(F.tenant_id,G+1)}),_},[l]);const He=h.useMemo(()=>{const _=S.trim().toLowerCase();return _?a.filter(F=>{const G=String(F.name||"").toLowerCase(),se=String(F.slug||"").toLowerCase(),we=String(F.id||"").toLowerCase();return G.includes(_)||se.includes(_)||we.includes(_)}):a.slice()},[a,S]),wt=a.length,Dt=a.filter(_=>_.is_active).length;a.filter(_=>_.has_database).length;const ve=a.filter(_=>_.has_odoo).length,qt=wt?Math.round(ve/wt*100):0;function Gt(_){if(!_)return"--";const F=new Date(_);return Number.isNaN(F.getTime())?"--":F.toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"2-digit"})}function _n(_){return 10+Math.abs(Array.from(_).reduce((se,we)=>se+we.charCodeAt(0),0))%70}function on(){f(Zt),fe(Zt),V(""),Y(!0),ke(!0),le([]),m([]),P("Verificacion de red: sistema ok"),W.current=""}function Ge(){on(),E(""),ne("/superadmin/new")}function Bt(){W.current="",ne("/superadmin")}async function cn(_){if(n)try{E(""),A(_),await n(_)}catch(F){E(F.message||"No se pudo entrar al tenant.")}finally{A("")}}function Qt(_){const F={};return Object.keys(Zt).forEach(G=>{const se=_[G];F[G]=typeof se=="string"?se.trim():se||""}),{...Zt,...F}}async function at(_){if(_){W.current=_,V(_),f(Zt),fe(Zt),Y(!0),ke(!0),le([]),m([]),Me(!0),E("");try{const F=await je(`/api/superadmin/tenants/${_}/details`);if(W.current!==_)return;const G=F.tenant||{},se=F.branding||null,we=F.odoo||null,dn=F.database||null,dt=F.channel||null;m(F.channels||[]);const Ze=(se==null?void 0:se.colors)||{},et=Qt({...Zt,name:G.name||"",slug:G.slug||"",plan:G.plan||"",db_url:(dn==null?void 0:dn.db_url)||"",brand_name:(se==null?void 0:se.brand_name)||"",logo_url:(se==null?void 0:se.logo_url)||"",brand_primary:(Ze==null?void 0:Ze.primary)||Zt.brand_primary,brand_accent:(Ze==null?void 0:Ze.accent)||Zt.brand_accent,brand_bg:(Ze==null?void 0:Ze.bg)||Zt.brand_bg,odoo_base_url:(we==null?void 0:we.base_url)||"",odoo_db_name:(we==null?void 0:we.db_name)||"",odoo_username:(we==null?void 0:we.username)||"",odoo_password:(we==null?void 0:we.password)||""});f(et),fe(et),V(G.id||_),Y(!!G.is_active),ke(!!G.is_active),P("Modo edicion: cambios pendientes"),await ge(_)}catch(F){E(F.message||"No se pudo cargar tenant.")}finally{Me(!1)}}}async function un(_){if(_)try{const F=await je(`/api/superadmin/tenants/${_}/details`);if(N&&N!==_)return;m(F.channels||[])}catch(F){console.error("Error loading tenant channels",F)}}async function Je(){try{const _=await je("/api/superadmin/flows");Z(_.flows||[])}catch(_){console.error("Error loading flows",_)}}async function ge(_){if(_){T(!0);try{const F=await je(`/api/superadmin/tenant-bots?tenant_id=${_}`);le(F.tenant_bots||[])}catch(F){console.error("Error loading tenant bots",F)}finally{T(!1)}}}async function _t(_,F){try{await ot(`/api/superadmin/tenant-bots/${_}`,{is_active:F}),le(G=>G.map(se=>se.id===_?{...se,is_active:F}:se))}catch(G){E(G.message||"Error al cambiar estado del bot.")}}async function H(_,F=null){if(N)try{const G=await Te("/api/superadmin/tenant-bots",{tenant_id:N,flow_id:_,config:F});G.tenant_bot&&(le(se=>[G.tenant_bot,...se]),q({message:"Bot agregado correctamente"}))}catch(G){E(G.message||"Error al agregar bot."),q({type:"error",message:G.message||"Error al agregar bot"})}}async function Oe(_){const F=ce.find(G=>G.id===_);try{await ks(`/api/superadmin/tenant-bots/${_}`),le(G=>G.filter(se=>se.id!==_)),q({message:"Bot eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{if(!F)return;const G=await Te("/api/superadmin/tenant-bots",{tenant_id:F.tenant_id,flow_id:F.flow_id,config:F.config||null});G!=null&&G.tenant_bot&&F.is_active===!1&&await ot(`/api/superadmin/tenant-bots/${G.tenant_bot.id}`,{is_active:!1}),await ge(N),q({message:"Bot restaurado"})}catch(G){q({type:"error",message:(G==null?void 0:G.message)||"No se pudo restaurar el bot"})}}})}catch(G){E(G.message||"Error al eliminar bot."),q({type:"error",message:G.message||"Error al eliminar bot"})}}async function xe(_,F){try{const G=await ot(`/api/superadmin/tenant-bots/${_}`,{config:F});G!=null&&G.tenant_bot&&le(se=>se.map(we=>we.id===_?G.tenant_bot:we)),q({message:"Configuracion IA actualizada"})}catch(G){E(G.message||"Error al actualizar configuracion del bot."),q({type:"error",message:G.message||"Error al actualizar configuracion del bot"})}}async function Qe(_){E(""),ne(`/superadmin/tenants/${_.id}`)}async function Sn(){await ue(),N&&await un(N)}function L(){const _=b.name.trim(),F=b.slug.trim(),G=b.db_url.trim();return!_||!F?{ok:!1,message:"Nombre y subdominio son requeridos."}:!N&&!G?{ok:!1,message:"Tenant DB URL es requerido."}:(b.brand_name.trim()||b.logo_url.trim()||b.brand_primary||b.brand_accent||b.brand_bg)&&!b.brand_name.trim()?{ok:!1,message:"Brand name es requerido."}:(b.odoo_base_url||b.odoo_db_name||b.odoo_username||b.odoo_password)&&(!b.odoo_base_url||!b.odoo_db_name||!b.odoo_username||!N&&!b.odoo_password)?{ok:!1,message:"Odoo incompleto: base_url, db_name, username, password."}:{ok:!0}}function Ae(_){if(!_)return"Verificacion completada";const F=[];if(_.database){const G=_.database.ok?"DB ok":"DB error",se=typeof _.database.latency_ms=="number"?` (${_.database.latency_ms}ms)`:"";F.push(`${G}${se}`)}if(_.odoo){const G=_.odoo.ok?"Odoo ok":"Odoo error",se=typeof _.odoo.latency_ms=="number"?` (${_.odoo.latency_ms}ms)`:"";F.push(`${G}${se}`)}return F.length?`Verificacion completada: ${F.join(" | ")}`:"Verificacion completada"}function $s(_){if(_!=null&&_.database&&!_.database.ok){const F=_.database.details||_.database.error;return kn(F||"Error en DB")}if(_!=null&&_.odoo&&!_.odoo.ok){const F=_.odoo.details||_.odoo.error;return kn(F||"Error en Odoo")}return"No se pudo validar conexion"}function kn(_){const F=(_||"").toString(),G=F.toLowerCase();return G.includes("missing")?"Completa los campos de Odoo":G.includes("db_connection_failed")?"No se pudo conectar a la base de datos":G.includes("odoo")&&G.includes("failed")?"No se pudo autenticar en Odoo":F||"No se pudo validar conexion"}async function Bn(){const _=L();if(!_.ok){P(_.message);return}v(!0),P("Verificando conexion...");try{const F=await Te("/api/superadmin/tenants/validate",{db_url:b.db_url.trim(),odoo_base_url:b.odoo_base_url.trim(),odoo_db_name:b.odoo_db_name.trim(),odoo_username:b.odoo_username.trim(),odoo_password:b.odoo_password.trim()}),G=Ae(F.checks);P(G),F.ok?q({message:G}):q({type:"error",message:$s(F.checks)})}catch(F){P("Error validando conexion"),q({type:"error",message:F.message||"No se pudo validar conexion"})}finally{v(!1)}}async function ns(_){var G;if(_.preventDefault(),Q&&!zt)return;const F=L();if(!F.ok){E(F.message);return}try{R(!0),E("");let se=N;if(se?await ot(`/api/superadmin/tenants/${se}`,{name:b.name.trim(),slug:b.slug.trim(),plan:b.plan.trim(),is_active:I}):se=(G=(await Te("/api/superadmin/tenants",{name:b.name.trim(),slug:b.slug.trim(),plan:b.plan.trim()})).tenant)==null?void 0:G.id,!se)throw new Error("tenant_not_ready");if(b.db_url.trim()&&await Te(`/api/superadmin/tenants/${se}/database`,{db_url:b.db_url.trim()}),(b.brand_name.trim()||b.logo_url.trim())&&await ot("/api/superadmin/branding",{tenant_id:se,brand_name:b.brand_name.trim(),logo_url:b.logo_url.trim()||null,colors:null}),b.odoo_base_url||b.odoo_db_name||b.odoo_username||b.odoo_password){const dt={tenant_id:se,base_url:b.odoo_base_url.trim(),db_name:b.odoo_db_name.trim(),username:b.odoo_username.trim()};b.odoo_password.trim()&&(dt.password=b.odoo_password.trim()),await ot("/api/superadmin/odoo",dt)}if(await ue(),N){const dt=Qt(b);f(dt),fe(dt),ke(I),P("Cambios guardados"),q({message:"Tenant actualizado correctamente"})}else on(),q({message:"Tenant creado correctamente"})}catch(se){E(se.message||"No se pudo guardar tenant."),q({type:"error",message:se.message||"No se pudo guardar tenant"})}finally{R(!1)}}async function bn(){if(!N)return;const _=!I;try{R(!0),E(""),await ot(`/api/superadmin/tenants/${N}`,{is_active:_}),Y(_),ke(_),P(_?"Tenant reactivado":"Tenant bloqueado"),await ue()}catch(F){E(F.message||"No se pudo cambiar estado del tenant.")}finally{R(!1)}}const zt=h.useMemo(()=>!N&&!Q||I!==Se?!0:Object.keys(he).some(_=>{const F=String(b[_]??""),G=String(he[_]??"");return F!==G}),[Se,he,I,N,Q,b]);return h.useEffect(()=>{if(Q&&k&&k!==N){at(k);return}U&&(N||Ee)&&on()},[Ee,N,U,Q,k]),s.jsxs("div",{className:"sa-shell",children:[s.jsxs("aside",{className:"sa-rail",children:[s.jsx("div",{className:"sa-rail-logo",children:"PRZV"}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${B?"":"active"}`,onClick:Bt,children:[s.jsx(ky,{className:"sa-rail-icon"}),s.jsx("span",{children:"Dashboard"})]}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${U?"active":""}`,onClick:Ge,children:[s.jsx(du,{className:"sa-rail-icon"}),s.jsx("span",{children:"Nuevo"})]}),s.jsxs("button",{type:"button",className:"sa-rail-btn",children:[s.jsx(by,{className:"sa-rail-icon"}),s.jsx("span",{children:"Ajustes"})]}),s.jsxs("div",{className:"sa-rail-footer",children:[s.jsx("div",{className:"sa-avatar",children:"SA"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-role",children:"Superadmin"}),s.jsx("div",{className:"sa-meta",children:"Control plane"})]})]})]}),s.jsxs("main",{className:"sa-main",children:[!B&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-topbar",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-kicker",children:"Panel de control Perzivalh"}),s.jsxs("div",{className:"sa-title",children:["Sistema operativo ",s.jsx("span",{className:"sa-dot"})]}),s.jsx("div",{className:"sa-subtitle",children:"Estado general del entorno"})]}),s.jsxs("div",{className:"sa-top-actions",children:[s.jsx("span",{className:"sa-version",children:"v0.4 stable"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:ue,children:"Recargar"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"}),s.jsx("button",{className:"sa-btn primary",type:"button",onClick:Ge,children:"Nuevo tenant"})]})]}),s.jsxs("section",{className:"sa-kpi-grid",children:[s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Total de empresas (tenants)"}),s.jsx("div",{className:"sa-kpi-value",children:wt}),s.jsxs("div",{className:"sa-kpi-meta",children:["+",Dt," activas"]})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Usuarios activos totales"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"En tiempo real"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Mensajes hoy"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"Canal API"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Conexiones Odoo activas"}),s.jsxs("div",{className:"sa-kpi-value",children:[qt,"%"]}),s.jsxs("div",{className:"sa-kpi-meta",children:[ve," sincronizadas"]})]})]}),s.jsxs("section",{className:"sa-table-card",children:[s.jsxs("div",{className:"sa-table-header",children:[s.jsxs("div",{className:"sa-search",children:[s.jsx(Cy,{className:"sa-search-icon"}),s.jsx("input",{value:S,onChange:_=>g(_.target.value),placeholder:"Filtrar empresas..."})]}),s.jsxs("div",{className:"sa-table-actions",children:[s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Ordenar por salud"}),s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Exportar CSV"})]})]}),s.jsxs("div",{className:"sa-table",children:[s.jsxs("div",{className:"sa-table-head",children:[s.jsx("div",{children:"ID referencia"}),s.jsx("div",{children:"Nombre de la empresa"}),s.jsx("div",{children:"Estado"}),s.jsx("div",{children:"Uso de recursos"}),s.jsx("div",{children:"Tiempo de actividad"}),s.jsx("div",{children:"Acciones"})]}),He.length?He.map(_=>{var we;const F=_n(_.id||"tenant"),G=_.has_database?"db":"no-db",se=_.has_database;return s.jsxs("div",{className:"sa-table-row",children:[s.jsx("div",{className:"sa-ref",children:((we=_.slug)==null?void 0:we.toUpperCase())||"TENANT"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-tenant-name",children:_.name}),s.jsx("div",{className:"sa-tenant-meta",children:_.id.slice(0,8)})]}),s.jsx("div",{className:`sa-status ${_.is_active?"ok":"warn"}`,children:_.is_active?"activo":"inactivo"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-progress",children:s.jsx("span",{className:`sa-progress-fill ${G}`,style:{width:`${F}%`}})}),s.jsxs("div",{className:"sa-tenant-meta",children:[F,"% carga"]})]}),s.jsx("div",{className:"sa-tenant-meta",children:Gt(_.created_at)}),s.jsx("div",{children:s.jsxs("div",{className:"sa-action-group",children:[s.jsx("button",{className:"sa-action",type:"button",onClick:()=>cn(_.id),disabled:!se||$===_.id,children:se?$===_.id?"Entrando...":"Entrar":"Sin DB"}),s.jsx("button",{className:"sa-link",type:"button",onClick:()=>Qe(_),children:s.jsx(Ey,{className:"sa-link-icon"})})]})})]},_.id)}):s.jsx("div",{className:"sa-empty",children:"Sin tenants para mostrar."})]}),s.jsxs("div",{className:"sa-footer-note",children:["Mostrando ",He.length||0," empresas en produccion"]})]})]}),B&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-create-header",children:[s.jsx("button",{className:"sa-back",type:"button",onClick:Bt,children:"Volver al dashboard"}),s.jsx("div",{className:"sa-create-title",children:Q?"Editar tenant":"Registrar nuevo tenant"}),s.jsxs("div",{className:"sa-create-actions",children:[s.jsx("div",{className:"sa-create-meta",children:"Modo: superadmin"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"})]})]}),y?s.jsx("div",{className:"sa-alert",children:y}):null,s.jsxs("form",{className:"sa-form",onSubmit:ns,children:[s.jsxs("div",{className:"sa-form-grid sa-form-grid-2",children:[s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Identidad del tenant"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre de la empresa"}),s.jsx("input",{value:b.name,onChange:_=>f({...b,name:_.target.value}),placeholder:"Ej. Empresa Alfa"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Subdominio reservado"}),s.jsx("input",{value:b.slug,onChange:_=>f({...b,slug:_.target.value}),placeholder:"alfa-salud"})]}),s.jsxs("div",{className:"sa-field sa-field-row",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Plan"}),s.jsxs("select",{value:b.plan,onChange:_=>f({...b,plan:_.target.value}),children:[s.jsx("option",{value:"",children:"Seleccionar"}),Sy.map(_=>s.jsx("option",{value:_.value,children:_.label},_.value))]})]}),Q&&s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Estado del tenant"}),s.jsxs("select",{value:I?"active":"inactive",onChange:_=>Y(_.target.value==="active"),children:[s.jsx("option",{value:"active",children:"Activo"}),s.jsx("option",{value:"inactive",children:"Bloqueado"})]})]})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Brand name"}),s.jsx("input",{value:b.brand_name,onChange:_=>f({...b,brand_name:_.target.value}),placeholder:"Perzivalh"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Logo URL"}),s.jsx("input",{value:b.logo_url,onChange:_=>f({...b,logo_url:_.target.value}),placeholder:"https://"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Paleta de colores"}),s.jsx("div",{className:"sa-note",children:"Personalizacin deshabilitada por ahora."})]}),!Q&&s.jsx("div",{className:"sa-note",children:"Nota: al registrar un tenant se inicia el aprovisionamiento en el entorno de produccion."})]}),s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Variables de entorno (envs)"}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Base de datos"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Tenant DB URL"}),s.jsx("input",{value:b.db_url,onChange:_=>f({...b,db_url:_.target.value}),placeholder:"postgresql://..."})]})]}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Odoo (opcional)"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Base URL"}),s.jsx("input",{value:b.odoo_base_url,onChange:_=>f({...b,odoo_base_url:_.target.value}),placeholder:"https://odoo-instancia"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo DB Name"}),s.jsx("input",{value:b.odoo_db_name,onChange:_=>f({...b,odoo_db_name:_.target.value}),placeholder:"db_tenant_prod"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo User"}),s.jsx("input",{value:b.odoo_username,onChange:_=>f({...b,odoo_username:_.target.value}),placeholder:"usuario@empresa.com"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Password (opcional)"}),s.jsx("input",{type:"password",value:b.odoo_password,onChange:_=>f({...b,odoo_password:_.target.value}),placeholder:"********"})]})]})]})]}),s.jsxs("div",{className:"sa-form-actions",children:[s.jsx("div",{className:"sa-status-note",children:Q?Ee?"Cargando datos...":zt?"Cambios pendientes":"Sin cambios":O}),s.jsx("div",{className:"sa-form-buttons",children:Q?s.jsxs(s.Fragment,{children:[zt&&s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:j,children:j?"Guardando...":"Guardar cambios"}),s.jsx("button",{className:"sa-btn danger",type:"button",onClick:bn,disabled:j||!N,children:I?"Bloquear tenant":"Reactivar tenant"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:Bn,disabled:p||j,children:p?"Validando...":"Validar conexion"}),s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:j,children:j?"Guardando...":"Desplegar instancia"})]})})]})]}),N?s.jsx(Iy,{channels:u.length?u:l.filter(_=>_.tenant_id===N),tenantId:N,onRefresh:Sn}):s.jsx("div",{style:{marginTop:"2rem",padding:"1rem",border:"1px dashed rgba(255,255,255,0.2)",borderRadius:"12px",color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",textAlign:"center"},children:"Crea el tenant primero para configurar las lneas de WhatsApp."}),N&&s.jsx(_y,{tenantId:N,tenantBots:ce,availableFlows:te,loading:be,onToggleBot:_t,onAddBot:H,onRemoveBot:Oe,onUpdateBotConfig:xe})]})]})]})}const Uh=["open","pending","assigned"],Vh=["admin","recepcion","caja","marketing","doctor"],Gn={admin:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!0},campaigns:{read:!0,write:!0},settings:{read:!0,write:!0}},settings:{general:{read:!0,write:!0},users:{read:!0,write:!0},bot:{read:!0,write:!0},templates:{read:!0,write:!0},audit:{read:!0,write:!0},odoo:{read:!0,write:!0}}},recepcion:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},caja:{modules:{chat:{read:!0,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},marketing:{modules:{chat:{read:!1,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!0,write:!0},settings:{read:!0,write:!1}},settings:{general:{read:!0,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!0,write:!0},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},doctor:{modules:{chat:{read:!0,write:!1},dashboard:{read:!1,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}}};function uc(e){if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleString()}function My(e){if(!e)return"-";const t=new Date(e);if(Number.isNaN(t.getTime()))return"-";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):i===1?"Ayer":["Dom","Lun","Mar","Mie","Jue","Vie","Sab"][t.getDay()]}function Fh(e){if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?"Hoy":i===1?"Ayer":`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}function ie(e){if(!e)return"Error inesperado";if(typeof e=="string")return e==="offline"?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":e==="network_error"?"No se pudo conectar con el servidor. Intenta de nuevo.":e==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":e;const t=e.message||"Error inesperado";return t==="offline"||t.toLowerCase().includes("failed to fetch")?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":t==="network_error"||t.toLowerCase().includes("networkerror")?"No se pudo conectar con el servidor. Intenta de nuevo.":t==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":t}function Dy(e,t){return e?t.includes(e.role):!1}function dc(e){if(!e||typeof e!="object")return{...Gn};const t={...Gn};return Object.entries(e).forEach(([n,r])=>{var a,i;!r||typeof r!="object"||(t[n]={modules:{...(a=Gn[n])==null?void 0:a.modules,...r.modules},settings:{...(i=Gn[n])==null?void 0:i.settings,...r.settings}})}),t}function kt(e,t,n,r="read"){var i;const a=(i=e==null?void 0:e[t])==null?void 0:i[n];return a?!!a[r]:!1}function Sr(e){const t=n=>n.status==="pending"&&!n.assigned_user_id?0:n.status==="pending"&&n.assigned_user_id?1:n.status==="assigned"?2:3;return[...e].sort((n,r)=>{const a=t(n),i=t(r);if(a!==i)return a-i;const l=new Date(n.last_message_at||n.created_at||0).getTime();return new Date(r.last_message_at||r.created_at||0).getTime()-l})}function By(e){const t=new URLSearchParams;Object.entries(e||{}).forEach(([r,a])=>{a==null||a===""||t.append(r,a)});const n=t.toString();return n?`?${n}`:""}function Wh(e){if(!e)return"?";const t=e.trim();return t?t[0].toUpperCase():"?"}function Hh(e){if(typeof document>"u")return;const t=document.documentElement.style;t.removeProperty("--accent"),t.removeProperty("--accent-strong"),t.removeProperty("--accent-soft"),t.removeProperty("--accent-soft-2"),t.removeProperty("--scroll-thumb"),t.removeProperty("--scroll-thumb-hover")}function zy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M4.5 5.5h15v10H8l-3.5 3.5V5.5Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 9h8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 12.5h5",strokeWidth:"1.8",strokeLinecap:"round"})]})}function $y(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"})]})}function Uy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 9a6 6 0 1 1 12 0c0 4.2 2 5.5 2 5.5H4S6 13.2 6 9Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M9.5 19a2.5 2.5 0 0 0 5 0",strokeWidth:"1.8"})]})}function Vy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"2",strokeLinecap:"round"})]})}function Fy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"4",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 3v2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M12 18.5V21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M3 12h2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M18.5 12H21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 5.2l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 17l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 18.8 7 17",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 7l1.8-1.8",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Wy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M20 14.2A8.5 8.5 0 1 1 9.8 4 6.5 6.5 0 0 0 20 14.2Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function Hy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.8"}),s.jsx("path",{d:"M16.5 16.5 21 21",strokeWidth:"1.8",strokeLinecap:"round"})]})}function qy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Gy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3.5",y:"6",width:"11",height:"12",rx:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"m14.5 10 6-3v10l-6-3",strokeWidth:"1.8"})]})}function Qy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M6.5 4.5 9 3l2.5 4-2.5 1.5c1.2 2.3 3.2 4.3 5.5 5.5L16 11l4 2.5-1.5 2.5c-.7 1.2-2.2 1.7-3.6 1.3a15.9 15.9 0 0 1-7.7-7.7c-.4-1.4.1-2.9 1.3-3.6Z",strokeWidth:"1.6",strokeLinejoin:"round"})})}function Ky(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"9",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 10v6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"7.5",r:"1",fill:"currentColor"})]})}function Yy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"m4 12 15-7-6 14-2.5-5.2L4 12Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function Xy(){const[e,t]=h.useState(localStorage.getItem("token")||""),[n,r]=h.useState(()=>typeof window<"u"&&localStorage.getItem("superadmin_token")||""),[a,i]=h.useState(null),[l,c]=h.useState(null),[u,m]=h.useState(null),[S,g]=h.useState([]),[y,E]=h.useState({id:"",display_name:"",is_default:!1,is_active:!0}),[O,P]=h.useState(()=>{if(typeof window>"u")return{};try{return JSON.parse(localStorage.getItem("last_read_map")||"{}")}catch{return{}}}),[b,f]=h.useState({email:"",password:""}),[p,v]=h.useState(""),[j,R]=h.useState("chats"),[$,A]=h.useState(()=>typeof window<"u"?window.location.pathname:"/"),[N,V]=h.useState(()=>localStorage.getItem("theme")||"light"),[I,Y]=h.useState(()=>typeof window<"u"&&window.navigator?!window.navigator.onLine:!1),[he,fe]=h.useState(!1),[Se,ke]=h.useState(!1),[Ee,Me]=h.useState(!1),[W,te]=h.useState(!0),[Z,ce]=h.useState(!1),[le,be]=h.useState(""),T=h.useRef(null),q=h.useRef(null),k=h.useRef(null),U=h.useRef({conversationId:null,lastId:null,length:0}),Q=h.useRef(0),B=h.useRef(!1),ne=h.useRef(0),[ue,He]=h.useState("users"),[wt,Dt]=h.useState("list"),[ve,qt]=h.useState(()=>dc(null)),[Gt,_n]=h.useState(!1),[on,Ge]=h.useState(!1),[Bt,cn]=h.useState(!1),Qt=h.useMemo(()=>{const d=Object.keys(ve||{}).filter(w=>!Vh.includes(w));return[...Vh,...d]},[ve]),[at,un]=h.useState({status:"",assigned_user_id:"",tag:"",search:"",phone_number_id:""}),Je=$.startsWith("/superadmin"),[ge,_t]=h.useState([]),[H,Oe]=h.useState(null),[xe,Qe]=h.useState([]),[Sn,L]=h.useState(""),[Ae,$s]=h.useState("text"),[kn,Bn]=h.useState([]),[ns,bn]=h.useState([]),[zt,_]=h.useState(""),[F,G]=h.useState(""),[se,we]=h.useState(""),[dn,dt]=h.useState(!1),[Ze,et]=h.useState({name:"",color:"#6b7280"}),[ss,ea]=h.useState(!1),[rs,re]=h.useState(""),{pushToast:oe}=dd(),hn=h.useRef(new Map),zn=h.useRef(new Map),Us=h.useRef(new Map),as=h.useRef(new Map),ta=h.useRef(new Map),[Vs,fi]=h.useState(null),[$n,na]=h.useState("30d"),[Cn,is]=h.useState(null),[ls,Re]=h.useState([]),[pi,mr]=h.useState([]),[lo,En]=h.useState(0),[sa,os]=h.useState([]),[cs,ra]=h.useState(""),[aa,mi]=h.useState(null),[oo,us]=h.useState([]),[hd,Fs]=h.useState(null),[ht,ia]=h.useState({name:"",template_id:"",scheduled_for:"",send_now:!0}),[Ke,Ws]=h.useState({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),[la,it]=h.useState([]),[tt,Un]=h.useState({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),[St,oa]=h.useState(null),[vi,ca]=h.useState({id:"",name:"",language:"es",category:"",body_preview:"",is_active:!0}),[ua,Kt]=h.useState([]),fn=((l==null?void 0:l.brand_name)||(u==null?void 0:u.name)||"Perzivalh").trim(),[Hs,ye]=h.useState(!1),[ds,qs]=h.useState(!1),[da,Tt]=h.useState(null),gi=48,co=80,vr=60,ha=320,xi=120,uo=5,yi=2*60*1e3,Gs=h.useRef(new Map);function ji(){const d=Gs.current;for(;d.size>uo;){const w=d.keys().next().value;d.delete(w)}}function ho(d){const w=Gs.current,C=w.get(d);return C?Date.now()-C.updatedAt>yi?(w.delete(d),null):C:null}function fa(d,w){const C=Gs.current;C.delete(d),C.set(d,{...w,updatedAt:Date.now()}),ji()}const pn=h.useCallback((d,w={})=>{if(typeof window>"u")return;const C=d||"/";if(window.location.pathname===C){A(C);return}w.replace?window.history.replaceState({},"",C):window.history.pushState({},"",C),A(C)},[]),fo=h.useMemo(()=>ls.find(d=>d.id===ht.template_id),[ls,ht.template_id]),Qs=h.useMemo(()=>{const d=[...xe].reverse().find(w=>w.type==="note");return(d==null?void 0:d.text)||""},[xe]),po=h.useMemo(()=>xe.filter(d=>d.type==="note"),[xe]);h.useEffect(()=>{if(typeof window>"u")return;const d=()=>{A(window.location.pathname||"/")};return window.addEventListener("popstate",d),()=>window.removeEventListener("popstate",d)},[]),h.useEffect(()=>{_r(e||null)},[e]),h.useEffect(()=>{document.body.dataset.theme=N,localStorage.setItem("theme",N)},[N]),h.useEffect(()=>{if(typeof window>"u")return;const d=()=>{Y(!window.navigator.onLine)};return d(),window.addEventListener("online",d),window.addEventListener("offline",d),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",d)}},[]),h.useEffect(()=>{ce(!1),te(!0),requestAnimationFrame(()=>{hs()}),H&&Ys(H)},[H==null?void 0:H.id]),h.useEffect(()=>{j==="chats"&&(ce(!1),te(!0),requestAnimationFrame(()=>{hs()}))},[j,H==null?void 0:H.id]),h.useEffect(()=>{var Ce;if(!H){be("");return}const d=xe[xe.length-1],w=(d==null?void 0:d.id)||(d==null?void 0:d.created_at)||(xe.length?`${xe.length}`:null),C=U.current,ae=C.conversationId===H.id&&d&&C.lastId&&w!==C.lastId;if(B.current&&xe.length>0){B.current=!1,requestAnimationFrame(()=>{hs()});return}if(ae?W?hs():ce(!0):W&&ce(!1),U.current={conversationId:H.id,lastId:w,length:xe.length},fs(),W&&xe.length>ha){const X=xe.slice(-ha);Qe(X),Tt(((Ce=X[0])==null?void 0:Ce.created_at)||null),ye(!0)}},[xe,H==null?void 0:H.id,W]),h.useEffect(()=>{var w;if(!(H!=null&&H.id)||!xe.length)return;const d={messages:xe.slice(-xi),cursor:da||((w=xe[0])==null?void 0:w.created_at)||null,hasMore:Hs};fa(H.id,d)},[xe,da,Hs,H==null?void 0:H.id]),h.useEffect(()=>{j!=="chats"&&te(!1)},[j]),h.useEffect(()=>{if(!e)return;let d=!0;return je("/api/me").then(w=>{d&&i(w.user)}).catch(()=>{d&&(t(""),i(null))}),()=>{d=!1}},[e]),h.useEffect(()=>{if(!a||a.role==="superadmin"){c(null),g([]),Hh();return}let d=!0;return je("/api/branding").then(w=>{d&&c(w.branding||null)}).catch(()=>{d&&c(null)}),je("/api/tenant").then(w=>{d&&m(w.tenant||null)}).catch(()=>{d&&m(null)}),je("/api/channels").then(w=>{d&&g(w.channels||[])}).catch(()=>{d&&g([])}),()=>{d=!1}},[a]),h.useEffect(()=>{Hh()},[l]),h.useEffect(()=>{if(a){if(a.role==="superadmin"){Je||pn("/superadmin",{replace:!0});return}Je&&pn("/",{replace:!0})}},[a,Je,pn]),h.useEffect(()=>{a&&a.role!=="superadmin"&&(mo(),gr())},[a]),h.useEffect(()=>{a&&a.role!=="superadmin"&&vo()},[a]),h.useEffect(()=>{!a||j!=="chats"||a.role!=="superadmin"&&pa()},[a,j,at]),h.useEffect(()=>{a&&a.role!=="superadmin"&&(j==="dashboard"&&ms($n,Cn),j==="campaigns"&&(vs(),yr(1,6)))},[a,j,$n,Cn]),h.useEffect(()=>{if(!a||j!=="admin")return;const d=(ve==null?void 0:ve[a.role])||Gn[a.role],w=kt(d,"settings","users"),C=kt(d,"settings","bot"),M=kt(d,"settings","general"),ae=kt(d,"settings","templates"),Ce=kt(d,"settings","audit");ue==="users"&&w&&Zs(),ue==="bot"&&C&&Co(),ue==="general"&&M&&ya(),ue==="templates"&&ae&&vs(),ue==="audit"&&Ce&&Ti()},[a,j,ue,ve]),h.useEffect(()=>{if(!a||j!=="admin")return;const d=(ve==null?void 0:ve[a.role])||Gn[a.role],C=["general","users","bot","templates","audit","odoo"].filter(M=>kt(d,"settings",M));if(!C.length){R(result.user.role==="superadmin"?"superadmin":"chats");return}C.includes(ue)||He(C[0])},[a,j,ue,ve]),h.useEffect(()=>{if(!e||(a==null?void 0:a.role)==="superadmin")return;const d=Gx(e),w={current:null},C=["/sounds/new-notification-09-352705.wav","/sounds/new-notification-09-352705.mp3"],M=()=>{if(w.current)return w.current;const X=new Audio(C[0]);X.volume=1;let de=0;return X.addEventListener("error",()=>{de+=1,de<C.length&&(X.src=C[de],X.load())}),w.current=X,X},ae=()=>{const X=M();X.play().then(()=>{X.pause(),X.currentTime=0}).catch(()=>{})};window.addEventListener("click",ae,{once:!0}),window.addEventListener("touchstart",ae,{once:!0});const Ce=()=>{if(!(typeof window>"u"))try{const X=M();X.currentTime=0,X.play().catch(()=>{})}catch{}};return d.on("conversation:update",({conversation:X})=>{const de=ta.current.get(X.id);ta.current.set(X.id,X.status),X.status==="pending"&&!X.assigned_user_id&&de!=="pending"&&(Ce(),oe({message:"Nueva conversacin pendiente"})),_t(De=>{const Pe=De.map(gt=>gt.id===X.id?{...gt,...X}:gt);return Pe.find(gt=>gt.id===X.id)||Pe.push(X),Sr(Pe)}),Oe(De=>(De==null?void 0:De.id)===X.id?{...De,...X}:De)}),d.on("message:new",({conversation:X,message:de})=>{X.status==="pending"&&!X.assigned_user_id&&Ce();const De={...X,last_message_text:(de==null?void 0:de.text)||null,last_message_type:(de==null?void 0:de.type)||null,last_message_direction:(de==null?void 0:de.direction)||null,last_message_at:(de==null?void 0:de.created_at)||X.last_message_at};_t(Pe=>{const gt=Pe.map(gs=>gs.id===X.id?{...gs,...De}:gs);return gt.find(gs=>gs.id===X.id)||gt.push(De),Sr(gt)}),Oe(Pe=>(Pe==null?void 0:Pe.id)===X.id?{...Pe,...De}:Pe),Qe(Pe=>!H||H.id!==X.id?Pe:(Ys(De),[...Pe,de]))}),()=>{d.disconnect()}},[e,H]),h.useEffect(()=>{if(!a)return;if(a.role==="superadmin"){j!=="superadmin"&&R("superadmin");return}const d=(ve==null?void 0:ve[a.role])||Gn[a.role],w=kt(d,"modules","chat"),C=kt(d,"modules","dashboard"),M=kt(d,"modules","campaigns"),ae=kt(d,"modules","settings");j==="chats"&&!w&&R(C?"dashboard":M?"campaigns":"admin"),j==="dashboard"&&!C&&R(w?"chats":M?"campaigns":"admin"),j==="campaigns"&&!M&&R(w?"chats":C?"dashboard":"admin"),j==="admin"&&!ae&&R(w?"chats":C?"dashboard":"campaigns")},[a,j,ve]),h.useEffect(()=>{if(!a||a.role!=="admin"||!Gt||!on||Bt)return;const d=setTimeout(()=>{const w=ne.current;cn(!0),ot("/api/admin/role-permissions",{permissions:ve}).then(()=>{ne.current===w&&Ge(!1)}).catch(C=>{re(ie(C))}).finally(()=>{cn(!1)})},350);return()=>clearTimeout(d)},[a,ve,on,Gt,Bt]);async function mo(){try{const d=await je("/api/users");bn(d.users||[])}catch(d){re(ie(d))}}async function vo(){try{const d=await je("/api/role-permissions"),w=dc(d.permissions||null);ne.current=0,qt(w),Ge(!1),_n(!0)}catch(d){re(ie(d)),_n(!0)}}async function gr(){try{const d=await je("/api/tags");Bn(d.tags||[])}catch(d){re(ie(d))}}async function pa(){try{const d=By(at),w=await je(`/api/conversations${d}`);_t(Sr(w.conversations||[]))}catch(d){re(ie(d))}}async function go(d){var ae,Ce;B.current=!0;const w=ho(d),C=ge.find(X=>X.id===d);ea(!w),xr(),C&&Oe(C),w&&(Qe(w.messages||[]),Tt(w.cursor||null),ye(!!w.hasMore),fs(),requestAnimationFrame(()=>{hs()}));const M=Q.current+1;Q.current=M;try{const X=`?limit=${co}&window_hours=${gi}`,de=await je(`/api/conversations/${d}${X}`);if(Q.current!==M)return;let De=de.conversation;const Pe=de.messages||[];if((De==null?void 0:De.status)==="pending"&&!De.assigned_user_id&&(a!=null&&a.id))try{De=(await ot(`/api/conversations/${d}/assign`,{})).conversation,_t(gs=>Sr(gs.map(er=>er.id===d?{...er,...De}:er)))}catch(gt){String(ie(gt)).includes("already_assigned")&&oe({type:"error",message:"Conversacin tomada por otro operador"})}Oe(De),Qe(Pe),ye(!!de.has_more),Tt(de.next_cursor||((ae=Pe[0])==null?void 0:ae.created_at)||null),fa(d,{messages:Pe.slice(-xi),cursor:de.next_cursor||((Ce=Pe[0])==null?void 0:Ce.created_at)||null,hasMore:!!de.has_more}),Ys(De)}catch(X){re(ie(X))}finally{Q.current===M&&ea(!1)}}async function ft(d){var Ce;if(!Hs||ds)return;const w=da;if(!w){ye(!1);return}qs(!0);const C=q.current,M=C?C.scrollHeight:0,ae=C?C.scrollTop:0;try{const X=`?limit=${vr}&before=${encodeURIComponent(w)}`,de=await je(`/api/conversations/${d}${X}`);if((H==null?void 0:H.id)!==d)return;const De=de.messages||[];De.length?(Qe(Pe=>{const gt=new Set(Pe.map(er=>er.id));return[...De.filter(er=>!gt.has(er.id)),...Pe]}),Tt(de.next_cursor||((Ce=De[0])==null?void 0:Ce.created_at)||w),ye(!!de.has_more),requestAnimationFrame(()=>{const Pe=q.current;if(!Pe)return;const gt=Pe.scrollHeight;Pe.scrollTop=gt-M+ae})):ye(!1)}catch(X){re(ie(X))}finally{qs(!1)}}async function Ni(d){d.preventDefault(),v("");try{const w=await Te("/api/auth/login",{email:b.email,password:b.password});t(w.token),_r(w.token),i(w.user),r(""),localStorage.removeItem("superadmin_token");const C=w.user.role==="superadmin";R(C?"superadmin":"chats"),C?pn("/superadmin",{replace:!0}):Je&&pn("/",{replace:!0})}catch{v("Credenciales invalidas")}}function lt(){t(""),_r(null),i(null),_t([]),Oe(null),Qe([]),R("chats"),Me(!1),qt(dc(null)),_n(!1),Ge(!1),cn(!1),ne.current=0,r(""),localStorage.removeItem("superadmin_token"),pn("/",{replace:!0})}async function ma(d){const w=await Te(`/api/superadmin/tenants/${d}/impersonate`);!n&&e&&(localStorage.setItem("superadmin_token",e),r(e)),t(w.token),_r(w.token),i(w.user),R("chats"),pn("/",{replace:!0})}function wi(){const d=n||(typeof window<"u"?localStorage.getItem("superadmin_token"):"");if(!d){lt();return}localStorage.removeItem("superadmin_token"),r(""),t(d),_r(d),i(null),R("chats"),pn("/superadmin",{replace:!0})}function _i(d){qt(w=>typeof d=="function"?d(w):d),ne.current+=1,Ge(!0)}function Ks(){V(d=>d==="light"?"dark":"light")}function hs(){const d=q.current;d&&(d.scrollTop=d.scrollHeight,te(!0),ce(!1),fs())}function Ys(d){!(d!=null&&d.id)||!(d!=null&&d.last_message_at)||P(w=>{const C={...w,[d.id]:d.last_message_at};return localStorage.setItem("last_read_map",JSON.stringify(C)),C})}function Xs(){const d=q.current;if(!d)return;const C=d.scrollHeight-d.scrollTop-d.clientHeight<24;te(C),C&&ce(!1),d.scrollTop<120&&Hs&&!ds&&H&&ft(H.id),fs()}function xr(){Qe([]),Tt(null),ye(!1),qs(!1),U.current={conversationId:null,lastId:null,length:0}}function fs(){k.current||(k.current=requestAnimationFrame(()=>{k.current=null,Js()}))}function Js(){const d=q.current;if(!d)return;const w=d.querySelectorAll(".day-pill");if(!w.length){be("");return}const C=d.scrollTop,M=12;let ae=w[0];for(const X of w)if(X.offsetTop-M<=C)ae=X;else break;const Ce=ae.dataset.dayLabel||ae.textContent||"";be(Ce)}function Vn(){Oe(null),xr()}function ps(d){var w;L(d),(w=T.current)==null||w.focus()}async function Si(d){if(d.preventDefault(),!H||!Sn.trim())return;const w=Sn.trim();L("");try{await Te(`/api/conversations/${H.id}/messages`,{text:w,type:Ae})}catch(C){re(ie(C))}}async function va(d){if(d.preventDefault(),!H||!F.trim())return;const w=F.trim();G("");try{const C=await Te(`/api/conversations/${H.id}/messages`,{text:w,type:"note"});C!=null&&C.message&&Qe(M=>[...M,C.message]),C!=null&&C.conversation&&Oe(C.conversation)}catch(C){re(ie(C))}}async function An(){if(H)try{const d=await ot(`/api/conversations/${H.id}/assign`);Oe(d.conversation),_t(w=>Sr(w.map(C=>C.id===d.conversation.id?{...C,...d.conversation}:C)))}catch(d){const w=ie(d)||"No se pudo tomar la conversacion";oe({type:"error",message:w})}}async function xo(){if(!(!H||!se))try{const d=await ot(`/api/conversations/${H.id}/assign`,{user_id:se});Oe(d.conversation),_t(w=>Sr(w.map(C=>C.id===d.conversation.id?{...C,...d.conversation}:C))),we(""),oe({message:"Conversacin reasignada"})}catch(d){const w=ie(d)||"No se pudo reasignar";oe({type:"error",message:w})}}async function yo(d){var w;if(H)try{let M=(await ot(`/api/conversations/${H.id}/status`,{status:d})).conversation;if(d==="open"&&((w=M==null?void 0:M.tags)!=null&&w.length)){const ae=M.tags.find(Ce=>(Ce.name||"").toLowerCase()==="pendiente");if(ae)try{M=(await Te(`/api/conversations/${M.id}/tags`,{add:[],remove:[ae.name]})).conversation||M}catch{M={...M,tags:M.tags.filter(X=>X.name!==ae.name)}}}Oe(M),_t(ae=>ae.map(Ce=>Ce.id===M.id?{...Ce,...M}:Ce))}catch(C){re(ie(C))}}async function ga(d){var C;if(!H)return;const w=((C=H.tags)==null?void 0:C.some(M=>M.name===d))||!1;if(w){const M=`${H.id}:${d}`;if(as.current.has(M))return;const ae=H,Ce={...H,tags:(H.tags||[]).filter(de=>de.name!==d)};Oe(Ce);const X=setTimeout(async()=>{try{const de=await Te(`/api/conversations/${ae.id}/tags`,{add:[],remove:[d]});(H==null?void 0:H.id)===ae.id&&Oe(de.conversation)}catch(de){(H==null?void 0:H.id)===ae.id&&Oe(ae),oe({type:"error",message:ie(de)||"No se pudo eliminar el tag"})}finally{as.current.delete(M)}},8e3);as.current.set(M,{timer:X,snapshot:ae}),oe({message:"Tag eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const de=as.current.get(M);de!=null&&de.timer&&clearTimeout(de.timer),de!=null&&de.snapshot?Oe(de.snapshot):Oe(ae),as.current.delete(M),oe({message:"Eliminacin cancelada"})}});return}try{const M=await Te(`/api/conversations/${H.id}/tags`,{add:w?[]:[d],remove:w?[d]:[]});Oe(M.conversation)}catch(M){re(ie(M))}}async function jo(d){if(d.preventDefault(),!zt.trim()||!H)return;const w=zt.trim();_("");try{const C=await Te(`/api/conversations/${H.id}/tags`,{add:[w]});Oe(C.conversation),await gr()}catch(C){re(ie(C))}}async function ki(d){d.preventDefault();const w=Ze.name.trim();if(!w){re("Completa el nombre de la etiqueta");return}try{await Te("/api/tags",{name:w,color:Ze.color||null}),et({name:"",color:"#6b7280"}),await gr(),oe({message:"Etiqueta creada"})}catch(C){re(ie(C))}}async function bi(d,w){if(d)try{await ks(`/api/tags/${d}`),Oe(C=>C&&{...C,tags:(C.tags||[]).filter(M=>M.name!==w)}),await gr(),oe({message:"Etiqueta eliminada"})}catch(C){re(ie(C))}}async function ms(d="30d",w=null){try{const C=new URLSearchParams;C.set("period",d),w&&C.set("channel",w);const M=await je(`/api/dashboard/metrics?${C.toString()}`);fi(M)}catch(C){re(ie(C))}}async function No(){try{const d=new URLSearchParams;d.set("period",$n),Cn&&d.set("channel",Cn);const w="http://localhost:3000",C=localStorage.getItem("token"),M=await fetch(`${w}/api/dashboard/report?${d.toString()}`,{headers:{Authorization:`Bearer ${C}`}});if(!M.ok)throw new Error("report_failed");const ae=await M.blob(),Ce=URL.createObjectURL(ae),X=document.createElement("a");X.href=Ce,X.download=`reporte-dashboard-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(Ce),oe({message:"Reporte descargado"})}catch(d){re(ie(d))}}async function vs(){try{const d=await je("/api/templates").catch(()=>je("/api/admin/templates"));Re(d.templates||[])}catch(d){re(ie(d))}}async function yr(d=1,w=6,C=""){try{const M=new URLSearchParams({page:String(d),page_size:String(w)});C&&M.set("q",C);const ae=await je(`/api/admin/campaigns?${M.toString()}`);mr(ae.campaigns||[]),En(Number.isFinite(ae.total)?ae.total:(ae.campaigns||[]).length)}catch(M){re(ie(M))}}async function wo(d){ra(d);try{const w=await je(`/api/admin/campaigns/${d}/messages`);os(w.messages||[])}catch(w){re(ie(w))}}async function xa(d){var w;if(d.preventDefault(),!ht.name.trim()||!ht.template_id){re("Completa el nombre y plantilla");return}Ke.status&&Ke.status,Ke.tag&&Ke.tag.trim(),Ke.assigned_user_id&&Ke.assigned_user_id,Ke.verified_only,Ke.segment_id&&(Ke.segment_id,Ke.segment_name&&Ke.segment_name);try{const C=await Te("/api/admin/campaigns",{name:ht.name.trim(),template_id:ht.template_id,audience_filter:Ke.segment_id?{segment_id:Ke.segment_id}:Ke,scheduled_for:ht.scheduled_for||null});if(ht.send_now&&!ht.scheduled_for){const M=(w=C==null?void 0:C.campaign)==null?void 0:w.id;M&&await Te(`/api/admin/campaigns/${M}/send`,{})}ia({name:"",template_id:"",scheduled_for:"",send_now:!0}),Ws({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),await yr(1,6),oe({message:"Campaa creada correctamente"})}catch(C){re(ie(C)),oe({type:"error",message:ie(C)||"Error al crear campaa"})}}async function _o(d){try{await Te(`/api/admin/campaigns/${d}/send`,{}),await yr(1,6)}catch(w){re(ie(w))}}async function So(){try{await je("/api/templates/sync"),await vs()}catch(d){re(ie(d))}}async function Zs(){try{const d=await je("/api/admin/users");it(d.users||[])}catch(d){re(ie(d))}}async function ko(d){if(d.preventDefault(),!tt.name.trim()||!tt.role){re("Completa los campos requeridos");return}try{tt.id?(await ot(`/api/admin/users/${tt.id}`,{name:tt.name.trim(),role:tt.role,is_active:tt.is_active,password:tt.password||void 0}),oe({message:"Usuario actualizado correctamente"})):(await Te("/api/admin/users",{name:tt.name.trim(),email:tt.email.trim().toLowerCase(),role:tt.role,password:tt.password}),oe({message:"Usuario creado correctamente"})),Un({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),await Zs()}catch(w){re(ie(w)),oe({type:"error",message:ie(w)||"Error al guardar usuario"})}}async function bo(d){if(!d||hn.current.has(d))return;let w=null;try{w=la.slice(),it(M=>M.filter(ae=>ae.id!==d));const C=setTimeout(async()=>{try{await ks(`/api/admin/users/${d}`),await Zs(),oe({message:"Usuario eliminado definitivamente"})}catch(M){w?it(w):await Zs(),oe({type:"error",message:ie(M)||"No se pudo eliminar el usuario"})}finally{hn.current.delete(d)}},8e3);hn.current.set(d,{timer:C,snapshot:w}),oe({message:"Usuario eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const M=hn.current.get(d);M!=null&&M.timer&&clearTimeout(M.timer),M!=null&&M.snapshot?it(M.snapshot):w?it(w):await Zs(),hn.current.delete(d),oe({message:"Eliminacin cancelada"})}})}catch(C){re(ie(C)),oe({type:"error",message:ie(C)||"Error al eliminar usuario"})}}async function Co(){try{const d=await je("/api/admin/settings");oa(d.settings)}catch(d){re(ie(d))}}async function Eo(){if(St)try{const d=await ot("/api/admin/settings",{bot_enabled:St.bot_enabled,auto_reply_enabled:St.auto_reply_enabled});oa(d.settings)}catch(d){re(ie(d))}}async function ya(){try{const d=await je("/api/channels");g(d.channels||[])}catch{g([])}}function Ao(d){E({id:d.id,display_name:d.display_name||"",is_default:!!d.is_default,is_active:d.is_active!==!1})}async function To(d){if(d.preventDefault(),!!y.id)try{await ot(`/api/channels/${y.id}`,{display_name:y.display_name.trim(),is_default:!!y.is_default,is_active:!!y.is_active}),E({id:"",display_name:"",is_default:!1,is_active:!0}),await ya(),oe({message:"Canal actualizado correctamente"})}catch(w){re(ie(w)),oe({type:"error",message:ie(w)||"Error al guardar canal"})}}async function Lo(d,w){if(!(!d||!w||typeof w!="object"))try{if(await ot(`/api/channels/${d}`,w),await ya(),w.is_default===!0){oe({message:"Linea principal actualizada"});return}w.is_active!==void 0&&oe({message:w.is_active?"Linea activada":"Linea desactivada"})}catch(C){re(ie(C)),oe({type:"error",message:ie(C)||"Error al actualizar linea"})}}async function Ro(d){const w=ve==null?void 0:ve[d];if(!(!d||zn.current.has(d)))try{qt(M=>{const ae={...M};return delete ae[d],ae});const C=setTimeout(async()=>{try{await ks(`/api/admin/role-permissions/${d}`),oe({message:"Rol eliminado definitivamente"})}catch(M){w&&qt(ae=>({...ae,[d]:w})),oe({type:"error",message:ie(M)||"No se pudo eliminar el rol"})}finally{zn.current.delete(d)}},8e3);zn.current.set(d,{timer:C,currentPermissions:w}),oe({message:"Rol eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const M=zn.current.get(d);M!=null&&M.timer&&clearTimeout(M.timer),M!=null&&M.currentPermissions&&qt(ae=>({...ae,[d]:M.currentPermissions})),zn.current.delete(d),oe({message:"Eliminacin cancelada"})}})}catch(C){re(ie(C)),oe({type:"error",message:ie(C)||"Error al eliminar rol"})}}async function Ci(d,w){d!=null&&d.preventDefault&&d.preventDefault();const C=w||vi||{},M=typeof C.name=="string"?C.name.trim():"";if(!M)return re("Completa el nombre"),null;const ae={name:M,category:C.category||"UTILITY",language:C.language||"es",body_text:C.body_text||C.body_preview||"",header_type:C.header_type||null,header_content:C.header_content||null,footer_text:C.footer_text||null,buttons:C.buttons||C.buttons_json||[]},Ce=C.variable_mappings||C.variableMappings||[];try{let X=null;return C.id?(X=await Ul(`/api/templates/${C.id}`,ae),await Ul(`/api/templates/${C.id}/mappings`,{mappings:Ce}),oe({message:"Borrador actualizado correctamente"})):(X=await Te("/api/templates/draft",{...ae,variable_mappings:Ce}),oe({message:"Borrador creado correctamente"})),await vs(),(X==null?void 0:X.template)||null}catch(X){return re(ie(X)),oe({type:"error",message:ie(X)||"Error al guardar plantilla"}),null}}async function Ei(d){if(d)try{await Te(`/api/templates/${d}/submit`,{}),await vs(),oe({message:"Plantilla enviada a revisin de Meta"})}catch(w){re(ie(w)),oe({type:"error",message:ie(w)||"Error al enviar a Meta"})}}async function Ai(d){if(d&&!Us.current.has(d))try{const w=ls.slice();Re(M=>M.filter(ae=>ae.id!==d));const C=setTimeout(async()=>{try{await ks(`/api/templates/${d}`),await vs(),oe({message:"Plantilla eliminada definitivamente"})}catch(M){Re(w),oe({type:"error",message:ie(M)||"No se pudo eliminar la plantilla"})}finally{Us.current.delete(d)}},8e3);Us.current.set(d,{timer:C,snapshot:w}),oe({message:"Plantilla eliminada. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const M=Us.current.get(d);M!=null&&M.timer&&clearTimeout(M.timer),M!=null&&M.snapshot?Re(M.snapshot):Re(w),Us.current.delete(d),oe({message:"Eliminacin cancelada"})}})}catch(w){re(ie(w)),oe({type:"error",message:ie(w)||"Error al eliminar plantilla"})}}async function Ti(){try{const d=await je("/api/admin/audit?limit=200");Kt(d.logs||[])}catch(d){re(ie(d))}}const Li={open:0,pending:0,closed:0};((Vs==null?void 0:Vs.status_counts)||[]).forEach(d=>{Li[d.status]=d._count.status});const o=Je?"Acceso al control plane":"Acceso a bandeja multiusuario";if(!e||!a)return s.jsx("div",{className:"login-shell",children:s.jsxs("div",{className:"login-card",children:[s.jsx("div",{className:"login-title",children:"Perzivalh"}),s.jsx("div",{className:"login-subtitle",children:o}),I?s.jsx(Fa,{variant:"offline",title:"Sin conexin",message:"No tienes internet en este momento. Conctate y vuelve a intentar iniciar sesin.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):null,s.jsxs("form",{className:"login-form",onSubmit:Ni,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:b.email,onChange:d=>f(w=>({...w,email:d.target.value})),required:!0})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:b.password,onChange:d=>f(w=>({...w,password:d.target.value})),required:!0})]}),p?s.jsx("div",{className:"error",children:p}):null,s.jsx("button",{className:"primary",type:"submit",children:"Entrar"})]})]})});if((a==null?void 0:a.role)==="superadmin"&&Je)return s.jsx("main",{className:"superadmin-page",children:s.jsx($h,{route:$,onNavigate:pn,onImpersonateTenant:ma,onLogout:lt})});const x=(ve==null?void 0:ve[a.role])||Gn[a.role],D=kt(x,"modules","chat"),K=kt(x,"modules","dashboard"),ee=kt(x,"modules","campaigns"),pe=kt(x,"modules","settings"),nt=Dy(a,["admin"]),Lt=kt(x,"modules","chat","write"),Yt=[],jr={open:"Bot activo",pending:"Pendiente",assigned:"Tomada"},Nr=H?H.display_name||H.phone_e164||H.wa_id:"Selecciona un chat",Oo=(H==null?void 0:H.phone_e164)||(H==null?void 0:H.wa_id)||"",Fn=H?jr[H.status]||"Sin estado":"",Tn=[{id:"chats",label:"Chats",icon:zy,enabled:D},{id:"dashboard",label:"Dashboard",icon:$y,enabled:K},{id:"campaigns",label:"Campaas",icon:Uy,enabled:ee},{id:"admin",label:"Configuraciones",icon:Vy,enabled:pe}],Xt=[];let Wn="";xe.forEach(d=>{const w=d.created_at,C=w?new Date(w):null,M=C&&!Number.isNaN(C.getTime())?`${C.getFullYear()}-${C.getMonth()}-${C.getDate()}`:"";if(M&&M!==Wn){const ae=Fh(w);Xt.push(s.jsx("div",{className:"day-pill","data-day-label":ae,children:ae},`day-${M}`)),Wn=M}Xt.push(s.jsxs("div",{className:`message ${d.direction} ${d.type==="note"?"note":""}`,"data-day-key":M,"data-day-label":M?Fh(w):"",children:[s.jsx("div",{className:"message-text",children:d.text||`[${d.type}]`}),s.jsx("div",{className:"message-meta",children:uc(d.created_at)})]},d.id))});const Jt=!!n&&a.role!=="superadmin";return s.jsxs("div",{className:`app-shell ${j==="admin"?"admin-shell":""}`,children:[s.jsx(Yx,{navItems:Tn,view:j,onSetView:R,theme:N,onToggleTheme:Ks,user:a,logoUrl:(l==null?void 0:l.logo_url)||"",brandName:fn,isProfileOpen:Ee,onToggleProfile:()=>Me(d=>!d),onLogout:lt,onReturnToSuperadmin:wi,showReturnToSuperadmin:Jt,getInitial:Wh,SunIcon:Fy,MoonIcon:Wy}),j==="admin"?s.jsx(Ny,{settingsSection:ue,setSettingsSection:He,settingsTab:wt,setSettingsTab:Dt,rolePermissions:ve,setRolePermissions:_i,defaultRolePermissions:Gn,currentRole:a.role,isAdmin:nt,adminUsers:la,userForm:tt,setUserForm:Un,roleOptions:Qt,handleUserSubmit:ko,handleUserDelete:bo,settings:St,setSettings:oa,handleSaveSettings:Eo,planName:(u==null?void 0:u.plan)||"",tenantChannels:S,channelForm:y,setChannelForm:E,handleChannelSelect:Ao,handleChannelSubmit:To,handleChannelQuickUpdate:Lo,handleRoleDelete:Ro,templates:ls,templateForm:vi,setTemplateForm:ca,handleTemplateSubmit:Ci,handleTemplateSubmitToMeta:Ei,handleTemplateDelete:Ai,handleSyncTemplates:So,auditLogs:ua,formatDate:uc,useShellLayout:!0,pageError:rs,isOffline:I,onDismissError:()=>re(""),brandName:fn}):j==="superadmin"?s.jsx("main",{className:"content content-page",children:s.jsx($h,{onImpersonateTenant:ma,onLogout:lt})}):s.jsxs("main",{className:`content ${j==="chats"?"content-chats":"content-page"}`,children:[j==="chats"&&s.jsx(Xx,{activeConversation:H,conversations:ge,channels:S,brandName:fn,lastReadMap:O,filters:at,showFilters:he,users:ns,tags:kn,statusOptions:Uh,statusLabels:jr,formatListTime:My,messageBlocks:Xt,messageDraft:Sn,messageMode:Ae,quickActions:Yt,tagInput:zt,setTagInput:_,noteInput:F,notesList:po,latestNote:Qs,loadingConversation:ss,isInfoOpen:Se,hasUnread:Z,scrollDayLabel:le,activeName:Nr,activePhone:Oo,activeStatusLabel:Fn,canManageStatus:Lt,currentUser:a,messageInputRef:T,chatBodyRef:q,setShowFilters:fe,setFilters:un,loadConversation:go,handleBackToList:Vn,setIsInfoOpen:ke,handleChatScroll:Xs,handleAssignSelf:An,handleStatusChange:yo,handleToggleTag:ga,handleAddTag:jo,setNoteInput:G,handleAddNote:va,reassignUserId:se,setReassignUserId:we,handleReassignConversation:xo,handleOpenTagManager:()=>dt(!0),handleCloseTagManager:()=>dt(!1),showTagManager:dn,tagManagerForm:Ze,setTagManagerForm:et,handleCreateTag:ki,handleDeleteTag:bi,handleQuickAction:ps,handleSendMessage:Si,setMessageMode:$s,setMessageDraft:L,scrollChatToBottom:hs,getInitial:Wh,PlusIcon:qy,SearchIcon:Hy,VideoIcon:Gy,PhoneIcon:Qy,InfoIcon:Ky,SendIcon:Yy}),j==="dashboard"&&s.jsx(Zx,{metrics:Vs,channels:S,selectedPeriod:$n,selectedChannel:Cn,onPeriodChange:d=>{na(d),ms(d,Cn)},onChannelChange:d=>{is(d),ms($n,d)},onRefresh:()=>ms($n,Cn),onGenerateReport:No,brandName:fn}),j==="campaigns"&&s.jsx(ny,{campaignForm:ht,setCampaignForm:ia,campaignFilter:Ke,setCampaignFilter:Ws,templates:ls,campaigns:pi,selectedCampaignId:cs,campaignMessages:sa,users:ns,tags:kn,channels:S,selectedTemplate:fo,statusOptions:Uh,onCreateCampaign:xa,onLoadCampaigns:yr,onLoadCampaignMessages:wo,onSendCampaign:_o,formatDate:uc,brandName:fn}),I?s.jsx(Fa,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):rs?s.jsx(Fa,{variant:"error",title:"Ocurri un problema",message:rs,dismissLabel:"Cerrar",onDismiss:()=>re("")}):null]})]})}const Jy=am(document.getElementById("root"));Jy.render(s.jsx(Qx,{children:s.jsx(Xy,{})}));
