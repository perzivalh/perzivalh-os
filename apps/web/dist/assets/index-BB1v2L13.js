(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var xh={exports:{}},vl={},yh={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fa=Symbol.for("react.element"),bm=Symbol.for("react.portal"),Cm=Symbol.for("react.fragment"),Em=Symbol.for("react.strict_mode"),Tm=Symbol.for("react.profiler"),Am=Symbol.for("react.provider"),Lm=Symbol.for("react.context"),Rm=Symbol.for("react.forward_ref"),Om=Symbol.for("react.suspense"),Pm=Symbol.for("react.memo"),Mm=Symbol.for("react.lazy"),Uu=Symbol.iterator;function Dm(e){return e===null||typeof e!="object"?null:(e=Uu&&e[Uu]||e["@@iterator"],typeof e=="function"?e:null)}var jh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Nh=Object.assign,wh={};function zr(e,t,n){this.props=e,this.context=t,this.refs=wh,this.updater=n||jh}zr.prototype.isReactComponent={};zr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};zr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function _h(){}_h.prototype=zr.prototype;function Ic(e,t,n){this.props=e,this.context=t,this.refs=wh,this.updater=n||jh}var Bc=Ic.prototype=new _h;Bc.constructor=Ic;Nh(Bc,zr.prototype);Bc.isPureReactComponent=!0;var Vu=Array.isArray,Sh=Object.prototype.hasOwnProperty,zc={current:null},kh={key:!0,ref:!0,__self:!0,__source:!0};function bh(e,t,n){var r,a={},i=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)Sh.call(t,r)&&!kh.hasOwnProperty(r)&&(a[r]=t[r]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var u=Array(c),m=0;m<c;m++)u[m]=arguments[m+2];a.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)a[r]===void 0&&(a[r]=c[r]);return{$$typeof:Fa,type:e,key:i,ref:l,props:a,_owner:zc.current}}function Im(e,t){return{$$typeof:Fa,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function $c(e){return typeof e=="object"&&e!==null&&e.$$typeof===Fa}function Bm(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Fu=/\/+/g;function so(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Bm(""+e.key):t.toString(36)}function Ti(e,t,n,r,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Fa:case bm:l=!0}}if(l)return l=e,a=a(l),e=r===""?"."+so(l,0):r,Vu(a)?(n="",e!=null&&(n=e.replace(Fu,"$&/")+"/"),Ti(a,t,n,"",function(m){return m})):a!=null&&($c(a)&&(a=Im(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(Fu,"$&/")+"/")+e)),t.push(a)),1;if(l=0,r=r===""?".":r+":",Vu(e))for(var c=0;c<e.length;c++){i=e[c];var u=r+so(i,c);l+=Ti(i,t,n,u,a)}else if(u=Dm(e),typeof u=="function")for(e=u.call(e),c=0;!(i=e.next()).done;)i=i.value,u=r+so(i,c++),l+=Ti(i,t,n,u,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function oi(e,t,n){if(e==null)return e;var r=[],a=0;return Ti(e,r,"","",function(i){return t.call(n,i,a++)}),r}function zm(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Rt={current:null},Ai={transition:null},$m={ReactCurrentDispatcher:Rt,ReactCurrentBatchConfig:Ai,ReactCurrentOwner:zc};function Ch(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:oi,forEach:function(e,t,n){oi(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return oi(e,function(){t++}),t},toArray:function(e){return oi(e,function(t){return t})||[]},only:function(e){if(!$c(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};me.Component=zr;me.Fragment=Cm;me.Profiler=Tm;me.PureComponent=Ic;me.StrictMode=Em;me.Suspense=Om;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$m;me.act=Ch;me.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Nh({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=zc.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)Sh.call(t,u)&&!kh.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&c!==void 0?c[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var m=0;m<u;m++)c[m]=arguments[m+2];r.children=c}return{$$typeof:Fa,type:e.type,key:a,ref:i,props:r,_owner:l}};me.createContext=function(e){return e={$$typeof:Lm,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Am,_context:e},e.Consumer=e};me.createElement=bh;me.createFactory=function(e){var t=bh.bind(null,e);return t.type=e,t};me.createRef=function(){return{current:null}};me.forwardRef=function(e){return{$$typeof:Rm,render:e}};me.isValidElement=$c;me.lazy=function(e){return{$$typeof:Mm,_payload:{_status:-1,_result:e},_init:zm}};me.memo=function(e,t){return{$$typeof:Pm,type:e,compare:t===void 0?null:t}};me.startTransition=function(e){var t=Ai.transition;Ai.transition={};try{e()}finally{Ai.transition=t}};me.unstable_act=Ch;me.useCallback=function(e,t){return Rt.current.useCallback(e,t)};me.useContext=function(e){return Rt.current.useContext(e)};me.useDebugValue=function(){};me.useDeferredValue=function(e){return Rt.current.useDeferredValue(e)};me.useEffect=function(e,t){return Rt.current.useEffect(e,t)};me.useId=function(){return Rt.current.useId()};me.useImperativeHandle=function(e,t,n){return Rt.current.useImperativeHandle(e,t,n)};me.useInsertionEffect=function(e,t){return Rt.current.useInsertionEffect(e,t)};me.useLayoutEffect=function(e,t){return Rt.current.useLayoutEffect(e,t)};me.useMemo=function(e,t){return Rt.current.useMemo(e,t)};me.useReducer=function(e,t,n){return Rt.current.useReducer(e,t,n)};me.useRef=function(e){return Rt.current.useRef(e)};me.useState=function(e){return Rt.current.useState(e)};me.useSyncExternalStore=function(e,t,n){return Rt.current.useSyncExternalStore(e,t,n)};me.useTransition=function(){return Rt.current.useTransition()};me.version="18.3.1";yh.exports=me;var f=yh.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Um=f,Vm=Symbol.for("react.element"),Fm=Symbol.for("react.fragment"),Wm=Object.prototype.hasOwnProperty,Hm=Um.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qm={key:!0,ref:!0,__self:!0,__source:!0};function Eh(e,t,n){var r,a={},i=null,l=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)Wm.call(t,r)&&!qm.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Vm,type:e,key:i,ref:l,props:a,_owner:Hm.current}}vl.Fragment=Fm;vl.jsx=Eh;vl.jsxs=Eh;xh.exports=vl;var s=xh.exports,Th={exports:{}},qt={},Ah={exports:{}},Lh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,G){var te=F.length;F.push(G);e:for(;0<te;){var se=te-1>>>1,de=F[se];if(0<a(de,G))F[se]=G,F[te]=de,te=se;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var G=F[0],te=F.pop();if(te!==G){F[0]=te;e:for(var se=0,de=F.length,be=de>>>1;se<be;){var T=2*(se+1)-1,H=F[T],b=T+1,$=F[b];if(0>a(H,te))b<de&&0>a($,H)?(F[se]=$,F[b]=te,se=b):(F[se]=H,F[T]=te,se=T);else if(b<de&&0>a($,te))F[se]=$,F[b]=te,se=b;else break e}}return G}function a(F,G){var te=F.sortIndex-G.sortIndex;return te!==0?te:F.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var u=[],m=[],N=1,v=null,x=3,C=!1,L=!1,R=!1,g=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(F){for(var G=n(m);G!==null;){if(G.callback===null)r(m);else if(G.startTime<=F)r(m),G.sortIndex=G.expirationTime,t(u,G);else break;G=n(m)}}function k(F){if(R=!1,y(F),!L)if(n(u)!==null)L=!0,Le(D);else{var G=n(m);G!==null&&at(k,G.startTime-F)}}function D(F,G){L=!1,R&&(R=!1,h(_),_=-1),C=!0;var te=x;try{for(y(G),v=n(u);v!==null&&(!(v.expirationTime>G)||F&&!K());){var se=v.callback;if(typeof se=="function"){v.callback=null,x=v.priorityLevel;var de=se(v.expirationTime<=G);G=e.unstable_now(),typeof de=="function"?v.callback=de:v===n(u)&&r(u),y(G)}else r(u);v=n(u)}if(v!==null)var be=!0;else{var T=n(m);T!==null&&at(k,T.startTime-G),be=!1}return be}finally{v=null,x=te,C=!1}}var z=!1,I=null,_=-1,P=5,M=-1;function K(){return!(e.unstable_now()-M<P)}function ue(){if(I!==null){var F=e.unstable_now();M=F;var G=!0;try{G=I(!0,F)}finally{G?fe():(z=!1,I=null)}}else z=!1}var fe;if(typeof p=="function")fe=function(){p(ue)};else if(typeof MessageChannel<"u"){var He=new MessageChannel,_e=He.port2;He.port1.onmessage=ue,fe=function(){_e.postMessage(null)}}else fe=function(){g(ue,0)};function Le(F){I=F,z||(z=!0,fe())}function at(F,G){_=g(function(){F(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){L||C||(L=!0,Le(D))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(F){switch(x){case 1:case 2:case 3:var G=3;break;default:G=x}var te=x;x=G;try{return F()}finally{x=te}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,G){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var te=x;x=F;try{return G()}finally{x=te}},e.unstable_scheduleCallback=function(F,G,te){var se=e.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?se+te:se):te=se,F){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=te+de,F={id:N++,callback:G,priorityLevel:F,startTime:te,expirationTime:de,sortIndex:-1},te>se?(F.sortIndex=te,t(m,F),n(u)===null&&F===n(m)&&(R?(h(_),_=-1):R=!0,at(k,te-se))):(F.sortIndex=de,t(u,F),L||C||(L=!0,Le(D))),F},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(F){var G=x;return function(){var te=x;x=G;try{return F.apply(this,arguments)}finally{x=te}}}})(Lh);Ah.exports=Lh;var Gm=Ah.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qm=f,Ht=Gm;function B(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Rh=new Set,ba={};function Js(e,t){Rr(e,t),Rr(e+"Capture",t)}function Rr(e,t){for(ba[e]=t,e=0;e<t.length;e++)Rh.add(t[e])}var Wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Io=Object.prototype.hasOwnProperty,Ym=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Wu={},Hu={};function Km(e){return Io.call(Hu,e)?!0:Io.call(Wu,e)?!1:Ym.test(e)?Hu[e]=!0:(Wu[e]=!0,!1)}function Xm(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Jm(e,t,n,r){if(t===null||typeof t>"u"||Xm(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ot(e,t,n,r,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){gt[e]=new Ot(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];gt[t]=new Ot(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){gt[e]=new Ot(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){gt[e]=new Ot(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){gt[e]=new Ot(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){gt[e]=new Ot(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){gt[e]=new Ot(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){gt[e]=new Ot(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){gt[e]=new Ot(e,5,!1,e.toLowerCase(),null,!1,!1)});var Uc=/[\-:]([a-z])/g;function Vc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Uc,Vc);gt[t]=new Ot(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Uc,Vc);gt[t]=new Ot(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Uc,Vc);gt[t]=new Ot(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){gt[e]=new Ot(e,1,!1,e.toLowerCase(),null,!1,!1)});gt.xlinkHref=new Ot("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){gt[e]=new Ot(e,1,!1,e.toLowerCase(),null,!0,!0)});function Fc(e,t,n,r){var a=gt.hasOwnProperty(t)?gt[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Jm(t,n,a,r)&&(n=null),r||a===null?Km(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Qn=Qm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ci=Symbol.for("react.element"),pr=Symbol.for("react.portal"),mr=Symbol.for("react.fragment"),Wc=Symbol.for("react.strict_mode"),Bo=Symbol.for("react.profiler"),Oh=Symbol.for("react.provider"),Ph=Symbol.for("react.context"),Hc=Symbol.for("react.forward_ref"),zo=Symbol.for("react.suspense"),$o=Symbol.for("react.suspense_list"),qc=Symbol.for("react.memo"),ps=Symbol.for("react.lazy"),Mh=Symbol.for("react.offscreen"),qu=Symbol.iterator;function na(e){return e===null||typeof e!="object"?null:(e=qu&&e[qu]||e["@@iterator"],typeof e=="function"?e:null)}var We=Object.assign,ro;function da(e){if(ro===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ro=t&&t[1]||""}return`
`+ro+e}var ao=!1;function io(e,t){if(!e||ao)return"";ao=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(m){var r=m}Reflect.construct(e,[],t)}else{try{t.call()}catch(m){r=m}e.call(t.prototype)}else{try{throw Error()}catch(m){r=m}e()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var a=m.stack.split(`
`),i=r.stack.split(`
`),l=a.length-1,c=i.length-1;1<=l&&0<=c&&a[l]!==i[c];)c--;for(;1<=l&&0<=c;l--,c--)if(a[l]!==i[c]){if(l!==1||c!==1)do if(l--,c--,0>c||a[l]!==i[c]){var u=`
`+a[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=c);break}}}finally{ao=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?da(e):""}function Zm(e){switch(e.tag){case 5:return da(e.type);case 16:return da("Lazy");case 13:return da("Suspense");case 19:return da("SuspenseList");case 0:case 2:case 15:return e=io(e.type,!1),e;case 11:return e=io(e.type.render,!1),e;case 1:return e=io(e.type,!0),e;default:return""}}function Uo(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case mr:return"Fragment";case pr:return"Portal";case Bo:return"Profiler";case Wc:return"StrictMode";case zo:return"Suspense";case $o:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ph:return(e.displayName||"Context")+".Consumer";case Oh:return(e._context.displayName||"Context")+".Provider";case Hc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case qc:return t=e.displayName||null,t!==null?t:Uo(e.type)||"Memo";case ps:t=e._payload,e=e._init;try{return Uo(e(t))}catch{}}return null}function eg(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Uo(t);case 8:return t===Wc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ts(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Dh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function tg(e){var t=Dh(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){r=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ui(e){e._valueTracker||(e._valueTracker=tg(e))}function Ih(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Dh(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Hi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Vo(e,t){var n=t.checked;return We({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Gu(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Ts(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Bh(e,t){t=t.checked,t!=null&&Fc(e,"checked",t,!1)}function Fo(e,t){Bh(e,t);var n=Ts(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Wo(e,t.type,n):t.hasOwnProperty("defaultValue")&&Wo(e,t.type,Ts(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Qu(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Wo(e,t,n){(t!=="number"||Hi(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ha=Array.isArray;function br(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ts(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Ho(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(B(91));return We({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Yu(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(B(92));if(ha(n)){if(1<n.length)throw Error(B(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ts(n)}}function zh(e,t){var n=Ts(t.value),r=Ts(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Ku(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function $h(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qo(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?$h(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var di,Uh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(di=di||document.createElement("div"),di.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=di.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ca(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ga={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ng=["Webkit","ms","Moz","O"];Object.keys(ga).forEach(function(e){ng.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ga[t]=ga[e]})});function Vh(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ga.hasOwnProperty(e)&&ga[e]?(""+t).trim():t+"px"}function Fh(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=Vh(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var sg=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Go(e,t){if(t){if(sg[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(B(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(B(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(B(61))}if(t.style!=null&&typeof t.style!="object")throw Error(B(62))}}function Qo(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yo=null;function Gc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ko=null,Cr=null,Er=null;function Xu(e){if(e=qa(e)){if(typeof Ko!="function")throw Error(B(280));var t=e.stateNode;t&&(t=wl(t),Ko(e.stateNode,e.type,t))}}function Wh(e){Cr?Er?Er.push(e):Er=[e]:Cr=e}function Hh(){if(Cr){var e=Cr,t=Er;if(Er=Cr=null,Xu(e),t)for(e=0;e<t.length;e++)Xu(t[e])}}function qh(e,t){return e(t)}function Gh(){}var lo=!1;function Qh(e,t,n){if(lo)return e(t,n);lo=!0;try{return qh(e,t,n)}finally{lo=!1,(Cr!==null||Er!==null)&&(Gh(),Hh())}}function Ea(e,t){var n=e.stateNode;if(n===null)return null;var r=wl(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(B(231,t,typeof n));return n}var Xo=!1;if(Wn)try{var sa={};Object.defineProperty(sa,"passive",{get:function(){Xo=!0}}),window.addEventListener("test",sa,sa),window.removeEventListener("test",sa,sa)}catch{Xo=!1}function rg(e,t,n,r,a,i,l,c,u){var m=Array.prototype.slice.call(arguments,3);try{t.apply(n,m)}catch(N){this.onError(N)}}var va=!1,qi=null,Gi=!1,Jo=null,ag={onError:function(e){va=!0,qi=e}};function ig(e,t,n,r,a,i,l,c,u){va=!1,qi=null,rg.apply(ag,arguments)}function lg(e,t,n,r,a,i,l,c,u){if(ig.apply(this,arguments),va){if(va){var m=qi;va=!1,qi=null}else throw Error(B(198));Gi||(Gi=!0,Jo=m)}}function Zs(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Yh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ju(e){if(Zs(e)!==e)throw Error(B(188))}function og(e){var t=e.alternate;if(!t){if(t=Zs(e),t===null)throw Error(B(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return Ju(a),e;if(i===r)return Ju(a),t;i=i.sibling}throw Error(B(188))}if(n.return!==r.return)n=a,r=i;else{for(var l=!1,c=a.child;c;){if(c===n){l=!0,n=a,r=i;break}if(c===r){l=!0,r=a,n=i;break}c=c.sibling}if(!l){for(c=i.child;c;){if(c===n){l=!0,n=i,r=a;break}if(c===r){l=!0,r=i,n=a;break}c=c.sibling}if(!l)throw Error(B(189))}}if(n.alternate!==r)throw Error(B(190))}if(n.tag!==3)throw Error(B(188));return n.stateNode.current===n?e:t}function Kh(e){return e=og(e),e!==null?Xh(e):null}function Xh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Xh(e);if(t!==null)return t;e=e.sibling}return null}var Jh=Ht.unstable_scheduleCallback,Zu=Ht.unstable_cancelCallback,cg=Ht.unstable_shouldYield,ug=Ht.unstable_requestPaint,Ye=Ht.unstable_now,dg=Ht.unstable_getCurrentPriorityLevel,Qc=Ht.unstable_ImmediatePriority,Zh=Ht.unstable_UserBlockingPriority,Qi=Ht.unstable_NormalPriority,hg=Ht.unstable_LowPriority,ef=Ht.unstable_IdlePriority,xl=null,Cn=null;function fg(e){if(Cn&&typeof Cn.onCommitFiberRoot=="function")try{Cn.onCommitFiberRoot(xl,e,void 0,(e.current.flags&128)===128)}catch{}}var mn=Math.clz32?Math.clz32:gg,pg=Math.log,mg=Math.LN2;function gg(e){return e>>>=0,e===0?32:31-(pg(e)/mg|0)|0}var hi=64,fi=4194304;function fa(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Yi(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,l=n&268435455;if(l!==0){var c=l&~a;c!==0?r=fa(c):(i&=l,i!==0&&(r=fa(i)))}else l=n&~a,l!==0?r=fa(l):i!==0&&(r=fa(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-mn(t),a=1<<n,r|=e[n],t&=~a;return r}function vg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xg(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-mn(i),c=1<<l,u=a[l];u===-1?(!(c&n)||c&r)&&(a[l]=vg(c,t)):u<=t&&(e.expiredLanes|=c),i&=~c}}function Zo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function tf(){var e=hi;return hi<<=1,!(hi&4194240)&&(hi=64),e}function oo(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Wa(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-mn(t),e[t]=n}function yg(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-mn(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}function Yc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-mn(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var ke=0;function nf(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var sf,Kc,rf,af,lf,ec=!1,pi=[],js=null,Ns=null,ws=null,Ta=new Map,Aa=new Map,gs=[],jg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ed(e,t){switch(e){case"focusin":case"focusout":js=null;break;case"dragenter":case"dragleave":Ns=null;break;case"mouseover":case"mouseout":ws=null;break;case"pointerover":case"pointerout":Ta.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Aa.delete(t.pointerId)}}function ra(e,t,n,r,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},t!==null&&(t=qa(t),t!==null&&Kc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Ng(e,t,n,r,a){switch(t){case"focusin":return js=ra(js,e,t,n,r,a),!0;case"dragenter":return Ns=ra(Ns,e,t,n,r,a),!0;case"mouseover":return ws=ra(ws,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Ta.set(i,ra(Ta.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Aa.set(i,ra(Aa.get(i)||null,e,t,n,r,a)),!0}return!1}function of(e){var t=Vs(e.target);if(t!==null){var n=Zs(t);if(n!==null){if(t=n.tag,t===13){if(t=Yh(n),t!==null){e.blockedOn=t,lf(e.priority,function(){rf(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Li(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=tc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Yo=r,n.target.dispatchEvent(r),Yo=null}else return t=qa(n),t!==null&&Kc(t),e.blockedOn=n,!1;t.shift()}return!0}function td(e,t,n){Li(e)&&n.delete(t)}function wg(){ec=!1,js!==null&&Li(js)&&(js=null),Ns!==null&&Li(Ns)&&(Ns=null),ws!==null&&Li(ws)&&(ws=null),Ta.forEach(td),Aa.forEach(td)}function aa(e,t){e.blockedOn===t&&(e.blockedOn=null,ec||(ec=!0,Ht.unstable_scheduleCallback(Ht.unstable_NormalPriority,wg)))}function La(e){function t(a){return aa(a,e)}if(0<pi.length){aa(pi[0],e);for(var n=1;n<pi.length;n++){var r=pi[n];r.blockedOn===e&&(r.blockedOn=null)}}for(js!==null&&aa(js,e),Ns!==null&&aa(Ns,e),ws!==null&&aa(ws,e),Ta.forEach(t),Aa.forEach(t),n=0;n<gs.length;n++)r=gs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<gs.length&&(n=gs[0],n.blockedOn===null);)of(n),n.blockedOn===null&&gs.shift()}var Tr=Qn.ReactCurrentBatchConfig,Ki=!0;function _g(e,t,n,r){var a=ke,i=Tr.transition;Tr.transition=null;try{ke=1,Xc(e,t,n,r)}finally{ke=a,Tr.transition=i}}function Sg(e,t,n,r){var a=ke,i=Tr.transition;Tr.transition=null;try{ke=4,Xc(e,t,n,r)}finally{ke=a,Tr.transition=i}}function Xc(e,t,n,r){if(Ki){var a=tc(e,t,n,r);if(a===null)yo(e,t,r,Xi,n),ed(e,r);else if(Ng(a,e,t,n,r))r.stopPropagation();else if(ed(e,r),t&4&&-1<jg.indexOf(e)){for(;a!==null;){var i=qa(a);if(i!==null&&sf(i),i=tc(e,t,n,r),i===null&&yo(e,t,r,Xi,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else yo(e,t,r,null,n)}}var Xi=null;function tc(e,t,n,r){if(Xi=null,e=Gc(r),e=Vs(e),e!==null)if(t=Zs(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Yh(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xi=e,null}function cf(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dg()){case Qc:return 1;case Zh:return 4;case Qi:case hg:return 16;case ef:return 536870912;default:return 16}default:return 16}}var xs=null,Jc=null,Ri=null;function uf(){if(Ri)return Ri;var e,t=Jc,n=t.length,r,a="value"in xs?xs.value:xs.textContent,i=a.length;for(e=0;e<n&&t[e]===a[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===a[i-r];r++);return Ri=a.slice(e,1<r?1-r:void 0)}function Oi(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function mi(){return!0}function nd(){return!1}function Gt(e){function t(n,r,a,i,l){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?mi:nd,this.isPropagationStopped=nd,this}return We(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=mi)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=mi)},persist:function(){},isPersistent:mi}),t}var $r={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zc=Gt($r),Ha=We({},$r,{view:0,detail:0}),kg=Gt(Ha),co,uo,ia,yl=We({},Ha,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ia&&(ia&&e.type==="mousemove"?(co=e.screenX-ia.screenX,uo=e.screenY-ia.screenY):uo=co=0,ia=e),co)},movementY:function(e){return"movementY"in e?e.movementY:uo}}),sd=Gt(yl),bg=We({},yl,{dataTransfer:0}),Cg=Gt(bg),Eg=We({},Ha,{relatedTarget:0}),ho=Gt(Eg),Tg=We({},$r,{animationName:0,elapsedTime:0,pseudoElement:0}),Ag=Gt(Tg),Lg=We({},$r,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Rg=Gt(Lg),Og=We({},$r,{data:0}),rd=Gt(Og),Pg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ig(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Dg[e])?!!t[e]:!1}function eu(){return Ig}var Bg=We({},Ha,{key:function(e){if(e.key){var t=Pg[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Oi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Mg[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eu,charCode:function(e){return e.type==="keypress"?Oi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Oi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),zg=Gt(Bg),$g=We({},yl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ad=Gt($g),Ug=We({},Ha,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eu}),Vg=Gt(Ug),Fg=We({},$r,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wg=Gt(Fg),Hg=We({},yl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qg=Gt(Hg),Gg=[9,13,27,32],tu=Wn&&"CompositionEvent"in window,xa=null;Wn&&"documentMode"in document&&(xa=document.documentMode);var Qg=Wn&&"TextEvent"in window&&!xa,df=Wn&&(!tu||xa&&8<xa&&11>=xa),id=" ",ld=!1;function hf(e,t){switch(e){case"keyup":return Gg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ff(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var gr=!1;function Yg(e,t){switch(e){case"compositionend":return ff(t);case"keypress":return t.which!==32?null:(ld=!0,id);case"textInput":return e=t.data,e===id&&ld?null:e;default:return null}}function Kg(e,t){if(gr)return e==="compositionend"||!tu&&hf(e,t)?(e=uf(),Ri=Jc=xs=null,gr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return df&&t.locale!=="ko"?null:t.data;default:return null}}var Xg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function od(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xg[e.type]:t==="textarea"}function pf(e,t,n,r){Wh(r),t=Ji(t,"onChange"),0<t.length&&(n=new Zc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ya=null,Ra=null;function Jg(e){kf(e,0)}function jl(e){var t=yr(e);if(Ih(t))return e}function Zg(e,t){if(e==="change")return t}var mf=!1;if(Wn){var fo;if(Wn){var po="oninput"in document;if(!po){var cd=document.createElement("div");cd.setAttribute("oninput","return;"),po=typeof cd.oninput=="function"}fo=po}else fo=!1;mf=fo&&(!document.documentMode||9<document.documentMode)}function ud(){ya&&(ya.detachEvent("onpropertychange",gf),Ra=ya=null)}function gf(e){if(e.propertyName==="value"&&jl(Ra)){var t=[];pf(t,Ra,e,Gc(e)),Qh(Jg,t)}}function ev(e,t,n){e==="focusin"?(ud(),ya=t,Ra=n,ya.attachEvent("onpropertychange",gf)):e==="focusout"&&ud()}function tv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return jl(Ra)}function nv(e,t){if(e==="click")return jl(t)}function sv(e,t){if(e==="input"||e==="change")return jl(t)}function rv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vn=typeof Object.is=="function"?Object.is:rv;function Oa(e,t){if(vn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!Io.call(t,a)||!vn(e[a],t[a]))return!1}return!0}function dd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hd(e,t){var n=dd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dd(n)}}function vf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?vf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function xf(){for(var e=window,t=Hi();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Hi(e.document)}return t}function nu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function av(e){var t=xf(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&vf(n.ownerDocument.documentElement,n)){if(r!==null&&nu(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=hd(n,i);var l=hd(n,r);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var iv=Wn&&"documentMode"in document&&11>=document.documentMode,vr=null,nc=null,ja=null,sc=!1;function fd(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;sc||vr==null||vr!==Hi(r)||(r=vr,"selectionStart"in r&&nu(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ja&&Oa(ja,r)||(ja=r,r=Ji(nc,"onSelect"),0<r.length&&(t=new Zc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vr)))}function gi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xr={animationend:gi("Animation","AnimationEnd"),animationiteration:gi("Animation","AnimationIteration"),animationstart:gi("Animation","AnimationStart"),transitionend:gi("Transition","TransitionEnd")},mo={},yf={};Wn&&(yf=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);function Nl(e){if(mo[e])return mo[e];if(!xr[e])return e;var t=xr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in yf)return mo[e]=t[n];return e}var jf=Nl("animationend"),Nf=Nl("animationiteration"),wf=Nl("animationstart"),_f=Nl("transitionend"),Sf=new Map,pd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ls(e,t){Sf.set(e,t),Js(t,[e])}for(var go=0;go<pd.length;go++){var vo=pd[go],lv=vo.toLowerCase(),ov=vo[0].toUpperCase()+vo.slice(1);Ls(lv,"on"+ov)}Ls(jf,"onAnimationEnd");Ls(Nf,"onAnimationIteration");Ls(wf,"onAnimationStart");Ls("dblclick","onDoubleClick");Ls("focusin","onFocus");Ls("focusout","onBlur");Ls(_f,"onTransitionEnd");Rr("onMouseEnter",["mouseout","mouseover"]);Rr("onMouseLeave",["mouseout","mouseover"]);Rr("onPointerEnter",["pointerout","pointerover"]);Rr("onPointerLeave",["pointerout","pointerover"]);Js("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Js("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Js("onBeforeInput",["compositionend","keypress","textInput","paste"]);Js("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Js("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Js("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cv=new Set("cancel close invalid load scroll toggle".split(" ").concat(pa));function md(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,lg(r,t,void 0,e),e.currentTarget=null}function kf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var l=r.length-1;0<=l;l--){var c=r[l],u=c.instance,m=c.currentTarget;if(c=c.listener,u!==i&&a.isPropagationStopped())break e;md(a,c,m),i=u}else for(l=0;l<r.length;l++){if(c=r[l],u=c.instance,m=c.currentTarget,c=c.listener,u!==i&&a.isPropagationStopped())break e;md(a,c,m),i=u}}}if(Gi)throw e=Jo,Gi=!1,Jo=null,e}function Pe(e,t){var n=t[oc];n===void 0&&(n=t[oc]=new Set);var r=e+"__bubble";n.has(r)||(bf(t,e,2,!1),n.add(r))}function xo(e,t,n){var r=0;t&&(r|=4),bf(n,e,r,t)}var vi="_reactListening"+Math.random().toString(36).slice(2);function Pa(e){if(!e[vi]){e[vi]=!0,Rh.forEach(function(n){n!=="selectionchange"&&(cv.has(n)||xo(n,!1,e),xo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[vi]||(t[vi]=!0,xo("selectionchange",!1,t))}}function bf(e,t,n,r){switch(cf(t)){case 1:var a=_g;break;case 4:a=Sg;break;default:a=Xc}n=a.bind(null,t,n,e),a=void 0,!Xo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function yo(e,t,n,r,a){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var c=r.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(l===4)for(l=r.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;l=l.return}for(;c!==null;){if(l=Vs(c),l===null)return;if(u=l.tag,u===5||u===6){r=i=l;continue e}c=c.parentNode}}r=r.return}Qh(function(){var m=i,N=Gc(n),v=[];e:{var x=Sf.get(e);if(x!==void 0){var C=Zc,L=e;switch(e){case"keypress":if(Oi(n)===0)break e;case"keydown":case"keyup":C=zg;break;case"focusin":L="focus",C=ho;break;case"focusout":L="blur",C=ho;break;case"beforeblur":case"afterblur":C=ho;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=sd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Cg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=Vg;break;case jf:case Nf:case wf:C=Ag;break;case _f:C=Wg;break;case"scroll":C=kg;break;case"wheel":C=qg;break;case"copy":case"cut":case"paste":C=Rg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=ad}var R=(t&4)!==0,g=!R&&e==="scroll",h=R?x!==null?x+"Capture":null:x;R=[];for(var p=m,y;p!==null;){y=p;var k=y.stateNode;if(y.tag===5&&k!==null&&(y=k,h!==null&&(k=Ea(p,h),k!=null&&R.push(Ma(p,k,y)))),g)break;p=p.return}0<R.length&&(x=new C(x,L,null,n,N),v.push({event:x,listeners:R}))}}if(!(t&7)){e:{if(x=e==="mouseover"||e==="pointerover",C=e==="mouseout"||e==="pointerout",x&&n!==Yo&&(L=n.relatedTarget||n.fromElement)&&(Vs(L)||L[Hn]))break e;if((C||x)&&(x=N.window===N?N:(x=N.ownerDocument)?x.defaultView||x.parentWindow:window,C?(L=n.relatedTarget||n.toElement,C=m,L=L?Vs(L):null,L!==null&&(g=Zs(L),L!==g||L.tag!==5&&L.tag!==6)&&(L=null)):(C=null,L=m),C!==L)){if(R=sd,k="onMouseLeave",h="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(R=ad,k="onPointerLeave",h="onPointerEnter",p="pointer"),g=C==null?x:yr(C),y=L==null?x:yr(L),x=new R(k,p+"leave",C,n,N),x.target=g,x.relatedTarget=y,k=null,Vs(N)===m&&(R=new R(h,p+"enter",L,n,N),R.target=y,R.relatedTarget=g,k=R),g=k,C&&L)t:{for(R=C,h=L,p=0,y=R;y;y=hr(y))p++;for(y=0,k=h;k;k=hr(k))y++;for(;0<p-y;)R=hr(R),p--;for(;0<y-p;)h=hr(h),y--;for(;p--;){if(R===h||h!==null&&R===h.alternate)break t;R=hr(R),h=hr(h)}R=null}else R=null;C!==null&&gd(v,x,C,R,!1),L!==null&&g!==null&&gd(v,g,L,R,!0)}}e:{if(x=m?yr(m):window,C=x.nodeName&&x.nodeName.toLowerCase(),C==="select"||C==="input"&&x.type==="file")var D=Zg;else if(od(x))if(mf)D=sv;else{D=tv;var z=ev}else(C=x.nodeName)&&C.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(D=nv);if(D&&(D=D(e,m))){pf(v,D,n,N);break e}z&&z(e,x,m),e==="focusout"&&(z=x._wrapperState)&&z.controlled&&x.type==="number"&&Wo(x,"number",x.value)}switch(z=m?yr(m):window,e){case"focusin":(od(z)||z.contentEditable==="true")&&(vr=z,nc=m,ja=null);break;case"focusout":ja=nc=vr=null;break;case"mousedown":sc=!0;break;case"contextmenu":case"mouseup":case"dragend":sc=!1,fd(v,n,N);break;case"selectionchange":if(iv)break;case"keydown":case"keyup":fd(v,n,N)}var I;if(tu)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else gr?hf(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(df&&n.locale!=="ko"&&(gr||_!=="onCompositionStart"?_==="onCompositionEnd"&&gr&&(I=uf()):(xs=N,Jc="value"in xs?xs.value:xs.textContent,gr=!0)),z=Ji(m,_),0<z.length&&(_=new rd(_,e,null,n,N),v.push({event:_,listeners:z}),I?_.data=I:(I=ff(n),I!==null&&(_.data=I)))),(I=Qg?Yg(e,n):Kg(e,n))&&(m=Ji(m,"onBeforeInput"),0<m.length&&(N=new rd("onBeforeInput","beforeinput",null,n,N),v.push({event:N,listeners:m}),N.data=I))}kf(v,t)})}function Ma(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ji(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ea(e,n),i!=null&&r.unshift(Ma(e,i,a)),i=Ea(e,t),i!=null&&r.push(Ma(e,i,a))),e=e.return}return r}function hr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function gd(e,t,n,r,a){for(var i=t._reactName,l=[];n!==null&&n!==r;){var c=n,u=c.alternate,m=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&m!==null&&(c=m,a?(u=Ea(n,i),u!=null&&l.unshift(Ma(n,u,c))):a||(u=Ea(n,i),u!=null&&l.push(Ma(n,u,c)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var uv=/\r\n?/g,dv=/\u0000|\uFFFD/g;function vd(e){return(typeof e=="string"?e:""+e).replace(uv,`
`).replace(dv,"")}function xi(e,t,n){if(t=vd(t),vd(e)!==t&&n)throw Error(B(425))}function Zi(){}var rc=null,ac=null;function ic(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var lc=typeof setTimeout=="function"?setTimeout:void 0,hv=typeof clearTimeout=="function"?clearTimeout:void 0,xd=typeof Promise=="function"?Promise:void 0,fv=typeof queueMicrotask=="function"?queueMicrotask:typeof xd<"u"?function(e){return xd.resolve(null).then(e).catch(pv)}:lc;function pv(e){setTimeout(function(){throw e})}function jo(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),La(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);La(t)}function _s(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function yd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ur=Math.random().toString(36).slice(2),bn="__reactFiber$"+Ur,Da="__reactProps$"+Ur,Hn="__reactContainer$"+Ur,oc="__reactEvents$"+Ur,mv="__reactListeners$"+Ur,gv="__reactHandles$"+Ur;function Vs(e){var t=e[bn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Hn]||n[bn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=yd(e);e!==null;){if(n=e[bn])return n;e=yd(e)}return t}e=n,n=e.parentNode}return null}function qa(e){return e=e[bn]||e[Hn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function yr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(B(33))}function wl(e){return e[Da]||null}var cc=[],jr=-1;function Rs(e){return{current:e}}function Me(e){0>jr||(e.current=cc[jr],cc[jr]=null,jr--)}function Oe(e,t){jr++,cc[jr]=e.current,e.current=t}var As={},kt=Rs(As),It=Rs(!1),Gs=As;function Or(e,t){var n=e.type.contextTypes;if(!n)return As;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Bt(e){return e=e.childContextTypes,e!=null}function el(){Me(It),Me(kt)}function jd(e,t,n){if(kt.current!==As)throw Error(B(168));Oe(kt,t),Oe(It,n)}function Cf(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(B(108,eg(e)||"Unknown",a));return We({},n,r)}function tl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||As,Gs=kt.current,Oe(kt,e),Oe(It,It.current),!0}function Nd(e,t,n){var r=e.stateNode;if(!r)throw Error(B(169));n?(e=Cf(e,t,Gs),r.__reactInternalMemoizedMergedChildContext=e,Me(It),Me(kt),Oe(kt,e)):Me(It),Oe(It,n)}var zn=null,_l=!1,No=!1;function Ef(e){zn===null?zn=[e]:zn.push(e)}function vv(e){_l=!0,Ef(e)}function Os(){if(!No&&zn!==null){No=!0;var e=0,t=ke;try{var n=zn;for(ke=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}zn=null,_l=!1}catch(a){throw zn!==null&&(zn=zn.slice(e+1)),Jh(Qc,Os),a}finally{ke=t,No=!1}}return null}var Nr=[],wr=0,nl=null,sl=0,Zt=[],en=0,Qs=null,Un=1,Vn="";function $s(e,t){Nr[wr++]=sl,Nr[wr++]=nl,nl=e,sl=t}function Tf(e,t,n){Zt[en++]=Un,Zt[en++]=Vn,Zt[en++]=Qs,Qs=e;var r=Un;e=Vn;var a=32-mn(r)-1;r&=~(1<<a),n+=1;var i=32-mn(t)+a;if(30<i){var l=a-a%5;i=(r&(1<<l)-1).toString(32),r>>=l,a-=l,Un=1<<32-mn(t)+a|n<<a|r,Vn=i+e}else Un=1<<i|n<<a|r,Vn=e}function su(e){e.return!==null&&($s(e,1),Tf(e,1,0))}function ru(e){for(;e===nl;)nl=Nr[--wr],Nr[wr]=null,sl=Nr[--wr],Nr[wr]=null;for(;e===Qs;)Qs=Zt[--en],Zt[en]=null,Vn=Zt[--en],Zt[en]=null,Un=Zt[--en],Zt[en]=null}var Wt=null,Ft=null,Be=!1,pn=null;function Af(e,t){var n=nn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function wd(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Wt=e,Ft=_s(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Wt=e,Ft=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Qs!==null?{id:Un,overflow:Vn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=nn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Wt=e,Ft=null,!0):!1;default:return!1}}function uc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function dc(e){if(Be){var t=Ft;if(t){var n=t;if(!wd(e,t)){if(uc(e))throw Error(B(418));t=_s(n.nextSibling);var r=Wt;t&&wd(e,t)?Af(r,n):(e.flags=e.flags&-4097|2,Be=!1,Wt=e)}}else{if(uc(e))throw Error(B(418));e.flags=e.flags&-4097|2,Be=!1,Wt=e}}}function _d(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Wt=e}function yi(e){if(e!==Wt)return!1;if(!Be)return _d(e),Be=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ic(e.type,e.memoizedProps)),t&&(t=Ft)){if(uc(e))throw Lf(),Error(B(418));for(;t;)Af(e,t),t=_s(t.nextSibling)}if(_d(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(B(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ft=_s(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ft=null}}else Ft=Wt?_s(e.stateNode.nextSibling):null;return!0}function Lf(){for(var e=Ft;e;)e=_s(e.nextSibling)}function Pr(){Ft=Wt=null,Be=!1}function au(e){pn===null?pn=[e]:pn.push(e)}var xv=Qn.ReactCurrentBatchConfig;function la(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(B(309));var r=n.stateNode}if(!r)throw Error(B(147,e));var a=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var c=a.refs;l===null?delete c[i]:c[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(B(284));if(!n._owner)throw Error(B(290,e))}return e}function ji(e,t){throw e=Object.prototype.toString.call(t),Error(B(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Sd(e){var t=e._init;return t(e._payload)}function Rf(e){function t(h,p){if(e){var y=h.deletions;y===null?(h.deletions=[p],h.flags|=16):y.push(p)}}function n(h,p){if(!e)return null;for(;p!==null;)t(h,p),p=p.sibling;return null}function r(h,p){for(h=new Map;p!==null;)p.key!==null?h.set(p.key,p):h.set(p.index,p),p=p.sibling;return h}function a(h,p){return h=Cs(h,p),h.index=0,h.sibling=null,h}function i(h,p,y){return h.index=y,e?(y=h.alternate,y!==null?(y=y.index,y<p?(h.flags|=2,p):y):(h.flags|=2,p)):(h.flags|=1048576,p)}function l(h){return e&&h.alternate===null&&(h.flags|=2),h}function c(h,p,y,k){return p===null||p.tag!==6?(p=Eo(y,h.mode,k),p.return=h,p):(p=a(p,y),p.return=h,p)}function u(h,p,y,k){var D=y.type;return D===mr?N(h,p,y.props.children,k,y.key):p!==null&&(p.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===ps&&Sd(D)===p.type)?(k=a(p,y.props),k.ref=la(h,p,y),k.return=h,k):(k=$i(y.type,y.key,y.props,null,h.mode,k),k.ref=la(h,p,y),k.return=h,k)}function m(h,p,y,k){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=To(y,h.mode,k),p.return=h,p):(p=a(p,y.children||[]),p.return=h,p)}function N(h,p,y,k,D){return p===null||p.tag!==7?(p=qs(y,h.mode,k,D),p.return=h,p):(p=a(p,y),p.return=h,p)}function v(h,p,y){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Eo(""+p,h.mode,y),p.return=h,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case ci:return y=$i(p.type,p.key,p.props,null,h.mode,y),y.ref=la(h,null,p),y.return=h,y;case pr:return p=To(p,h.mode,y),p.return=h,p;case ps:var k=p._init;return v(h,k(p._payload),y)}if(ha(p)||na(p))return p=qs(p,h.mode,y,null),p.return=h,p;ji(h,p)}return null}function x(h,p,y,k){var D=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return D!==null?null:c(h,p,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ci:return y.key===D?u(h,p,y,k):null;case pr:return y.key===D?m(h,p,y,k):null;case ps:return D=y._init,x(h,p,D(y._payload),k)}if(ha(y)||na(y))return D!==null?null:N(h,p,y,k,null);ji(h,y)}return null}function C(h,p,y,k,D){if(typeof k=="string"&&k!==""||typeof k=="number")return h=h.get(y)||null,c(p,h,""+k,D);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case ci:return h=h.get(k.key===null?y:k.key)||null,u(p,h,k,D);case pr:return h=h.get(k.key===null?y:k.key)||null,m(p,h,k,D);case ps:var z=k._init;return C(h,p,y,z(k._payload),D)}if(ha(k)||na(k))return h=h.get(y)||null,N(p,h,k,D,null);ji(p,k)}return null}function L(h,p,y,k){for(var D=null,z=null,I=p,_=p=0,P=null;I!==null&&_<y.length;_++){I.index>_?(P=I,I=null):P=I.sibling;var M=x(h,I,y[_],k);if(M===null){I===null&&(I=P);break}e&&I&&M.alternate===null&&t(h,I),p=i(M,p,_),z===null?D=M:z.sibling=M,z=M,I=P}if(_===y.length)return n(h,I),Be&&$s(h,_),D;if(I===null){for(;_<y.length;_++)I=v(h,y[_],k),I!==null&&(p=i(I,p,_),z===null?D=I:z.sibling=I,z=I);return Be&&$s(h,_),D}for(I=r(h,I);_<y.length;_++)P=C(I,h,_,y[_],k),P!==null&&(e&&P.alternate!==null&&I.delete(P.key===null?_:P.key),p=i(P,p,_),z===null?D=P:z.sibling=P,z=P);return e&&I.forEach(function(K){return t(h,K)}),Be&&$s(h,_),D}function R(h,p,y,k){var D=na(y);if(typeof D!="function")throw Error(B(150));if(y=D.call(y),y==null)throw Error(B(151));for(var z=D=null,I=p,_=p=0,P=null,M=y.next();I!==null&&!M.done;_++,M=y.next()){I.index>_?(P=I,I=null):P=I.sibling;var K=x(h,I,M.value,k);if(K===null){I===null&&(I=P);break}e&&I&&K.alternate===null&&t(h,I),p=i(K,p,_),z===null?D=K:z.sibling=K,z=K,I=P}if(M.done)return n(h,I),Be&&$s(h,_),D;if(I===null){for(;!M.done;_++,M=y.next())M=v(h,M.value,k),M!==null&&(p=i(M,p,_),z===null?D=M:z.sibling=M,z=M);return Be&&$s(h,_),D}for(I=r(h,I);!M.done;_++,M=y.next())M=C(I,h,_,M.value,k),M!==null&&(e&&M.alternate!==null&&I.delete(M.key===null?_:M.key),p=i(M,p,_),z===null?D=M:z.sibling=M,z=M);return e&&I.forEach(function(ue){return t(h,ue)}),Be&&$s(h,_),D}function g(h,p,y,k){if(typeof y=="object"&&y!==null&&y.type===mr&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case ci:e:{for(var D=y.key,z=p;z!==null;){if(z.key===D){if(D=y.type,D===mr){if(z.tag===7){n(h,z.sibling),p=a(z,y.props.children),p.return=h,h=p;break e}}else if(z.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===ps&&Sd(D)===z.type){n(h,z.sibling),p=a(z,y.props),p.ref=la(h,z,y),p.return=h,h=p;break e}n(h,z);break}else t(h,z);z=z.sibling}y.type===mr?(p=qs(y.props.children,h.mode,k,y.key),p.return=h,h=p):(k=$i(y.type,y.key,y.props,null,h.mode,k),k.ref=la(h,p,y),k.return=h,h=k)}return l(h);case pr:e:{for(z=y.key;p!==null;){if(p.key===z)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){n(h,p.sibling),p=a(p,y.children||[]),p.return=h,h=p;break e}else{n(h,p);break}else t(h,p);p=p.sibling}p=To(y,h.mode,k),p.return=h,h=p}return l(h);case ps:return z=y._init,g(h,p,z(y._payload),k)}if(ha(y))return L(h,p,y,k);if(na(y))return R(h,p,y,k);ji(h,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,p!==null&&p.tag===6?(n(h,p.sibling),p=a(p,y),p.return=h,h=p):(n(h,p),p=Eo(y,h.mode,k),p.return=h,h=p),l(h)):n(h,p)}return g}var Mr=Rf(!0),Of=Rf(!1),rl=Rs(null),al=null,_r=null,iu=null;function lu(){iu=_r=al=null}function ou(e){var t=rl.current;Me(rl),e._currentValue=t}function hc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ar(e,t){al=e,iu=_r=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Dt=!0),e.firstContext=null)}function rn(e){var t=e._currentValue;if(iu!==e)if(e={context:e,memoizedValue:t,next:null},_r===null){if(al===null)throw Error(B(308));_r=e,al.dependencies={lanes:0,firstContext:e}}else _r=_r.next=e;return t}var Fs=null;function cu(e){Fs===null?Fs=[e]:Fs.push(e)}function Pf(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,cu(t)):(n.next=a.next,a.next=n),t.interleaved=n,qn(e,r)}function qn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ms=!1;function uu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mf(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ss(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,xe&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,qn(e,n)}return a=r.interleaved,a===null?(t.next=t,cu(r)):(t.next=a.next,a.next=t),r.interleaved=t,qn(e,n)}function Pi(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Yc(e,n)}}function kd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=l:i=i.next=l,n=n.next}while(n!==null);i===null?a=i=t:i=i.next=t}else a=i=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function il(e,t,n,r){var a=e.updateQueue;ms=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var u=c,m=u.next;u.next=null,l===null?i=m:l.next=m,l=u;var N=e.alternate;N!==null&&(N=N.updateQueue,c=N.lastBaseUpdate,c!==l&&(c===null?N.firstBaseUpdate=m:c.next=m,N.lastBaseUpdate=u))}if(i!==null){var v=a.baseState;l=0,N=m=u=null,c=i;do{var x=c.lane,C=c.eventTime;if((r&x)===x){N!==null&&(N=N.next={eventTime:C,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var L=e,R=c;switch(x=t,C=n,R.tag){case 1:if(L=R.payload,typeof L=="function"){v=L.call(C,v,x);break e}v=L;break e;case 3:L.flags=L.flags&-65537|128;case 0:if(L=R.payload,x=typeof L=="function"?L.call(C,v,x):L,x==null)break e;v=We({},v,x);break e;case 2:ms=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,x=a.effects,x===null?a.effects=[c]:x.push(c))}else C={eventTime:C,lane:x,tag:c.tag,payload:c.payload,callback:c.callback,next:null},N===null?(m=N=C,u=v):N=N.next=C,l|=x;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;x=c,c=x.next,x.next=null,a.lastBaseUpdate=x,a.shared.pending=null}}while(!0);if(N===null&&(u=v),a.baseState=u,a.firstBaseUpdate=m,a.lastBaseUpdate=N,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Ks|=l,e.lanes=l,e.memoizedState=v}}function bd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(B(191,a));a.call(r)}}}var Ga={},En=Rs(Ga),Ia=Rs(Ga),Ba=Rs(Ga);function Ws(e){if(e===Ga)throw Error(B(174));return e}function du(e,t){switch(Oe(Ba,t),Oe(Ia,e),Oe(En,Ga),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:qo(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=qo(t,e)}Me(En),Oe(En,t)}function Dr(){Me(En),Me(Ia),Me(Ba)}function Df(e){Ws(Ba.current);var t=Ws(En.current),n=qo(t,e.type);t!==n&&(Oe(Ia,e),Oe(En,n))}function hu(e){Ia.current===e&&(Me(En),Me(Ia))}var Ve=Rs(0);function ll(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var wo=[];function fu(){for(var e=0;e<wo.length;e++)wo[e]._workInProgressVersionPrimary=null;wo.length=0}var Mi=Qn.ReactCurrentDispatcher,_o=Qn.ReactCurrentBatchConfig,Ys=0,Fe=null,st=null,lt=null,ol=!1,Na=!1,za=0,yv=0;function wt(){throw Error(B(321))}function pu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!vn(e[n],t[n]))return!1;return!0}function mu(e,t,n,r,a,i){if(Ys=i,Fe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Mi.current=e===null||e.memoizedState===null?_v:Sv,e=n(r,a),Na){i=0;do{if(Na=!1,za=0,25<=i)throw Error(B(301));i+=1,lt=st=null,t.updateQueue=null,Mi.current=kv,e=n(r,a)}while(Na)}if(Mi.current=cl,t=st!==null&&st.next!==null,Ys=0,lt=st=Fe=null,ol=!1,t)throw Error(B(300));return e}function gu(){var e=za!==0;return za=0,e}function Sn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lt===null?Fe.memoizedState=lt=e:lt=lt.next=e,lt}function an(){if(st===null){var e=Fe.alternate;e=e!==null?e.memoizedState:null}else e=st.next;var t=lt===null?Fe.memoizedState:lt.next;if(t!==null)lt=t,st=e;else{if(e===null)throw Error(B(310));st=e,e={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},lt===null?Fe.memoizedState=lt=e:lt=lt.next=e}return lt}function $a(e,t){return typeof t=="function"?t(e):t}function So(e){var t=an(),n=t.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=e;var r=st,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var c=l=null,u=null,m=i;do{var N=m.lane;if((Ys&N)===N)u!==null&&(u=u.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:e(r,m.action);else{var v={lane:N,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};u===null?(c=u=v,l=r):u=u.next=v,Fe.lanes|=N,Ks|=N}m=m.next}while(m!==null&&m!==i);u===null?l=r:u.next=c,vn(r,t.memoizedState)||(Dt=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do i=a.lane,Fe.lanes|=i,Ks|=i,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ko(e){var t=an(),n=t.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(a!==null){n.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);vn(i,t.memoizedState)||(Dt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function If(){}function Bf(e,t){var n=Fe,r=an(),a=t(),i=!vn(r.memoizedState,a);if(i&&(r.memoizedState=a,Dt=!0),r=r.queue,vu(Uf.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||lt!==null&&lt.memoizedState.tag&1){if(n.flags|=2048,Ua(9,$f.bind(null,n,r,a,t),void 0,null),ot===null)throw Error(B(349));Ys&30||zf(n,t,a)}return a}function zf(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function $f(e,t,n,r){t.value=n,t.getSnapshot=r,Vf(t)&&Ff(e)}function Uf(e,t,n){return n(function(){Vf(t)&&Ff(e)})}function Vf(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!vn(e,n)}catch{return!0}}function Ff(e){var t=qn(e,1);t!==null&&gn(t,e,1,-1)}function Cd(e){var t=Sn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$a,lastRenderedState:e},t.queue=e,e=e.dispatch=wv.bind(null,Fe,e),[t.memoizedState,e]}function Ua(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Wf(){return an().memoizedState}function Di(e,t,n,r){var a=Sn();Fe.flags|=e,a.memoizedState=Ua(1|t,n,void 0,r===void 0?null:r)}function Sl(e,t,n,r){var a=an();r=r===void 0?null:r;var i=void 0;if(st!==null){var l=st.memoizedState;if(i=l.destroy,r!==null&&pu(r,l.deps)){a.memoizedState=Ua(t,n,i,r);return}}Fe.flags|=e,a.memoizedState=Ua(1|t,n,i,r)}function Ed(e,t){return Di(8390656,8,e,t)}function vu(e,t){return Sl(2048,8,e,t)}function Hf(e,t){return Sl(4,2,e,t)}function qf(e,t){return Sl(4,4,e,t)}function Gf(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Qf(e,t,n){return n=n!=null?n.concat([e]):null,Sl(4,4,Gf.bind(null,t,e),n)}function xu(){}function Yf(e,t){var n=an();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&pu(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Kf(e,t){var n=an();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&pu(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Xf(e,t,n){return Ys&21?(vn(n,t)||(n=tf(),Fe.lanes|=n,Ks|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Dt=!0),e.memoizedState=n)}function jv(e,t){var n=ke;ke=n!==0&&4>n?n:4,e(!0);var r=_o.transition;_o.transition={};try{e(!1),t()}finally{ke=n,_o.transition=r}}function Jf(){return an().memoizedState}function Nv(e,t,n){var r=bs(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Zf(e))ep(t,n);else if(n=Pf(e,t,n,r),n!==null){var a=Lt();gn(n,e,r,a),tp(n,t,r)}}function wv(e,t,n){var r=bs(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Zf(e))ep(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,c=i(l,n);if(a.hasEagerState=!0,a.eagerState=c,vn(c,l)){var u=t.interleaved;u===null?(a.next=a,cu(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}n=Pf(e,t,a,r),n!==null&&(a=Lt(),gn(n,e,r,a),tp(n,t,r))}}function Zf(e){var t=e.alternate;return e===Fe||t!==null&&t===Fe}function ep(e,t){Na=ol=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function tp(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Yc(e,n)}}var cl={readContext:rn,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useInsertionEffect:wt,useLayoutEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useMutableSource:wt,useSyncExternalStore:wt,useId:wt,unstable_isNewReconciler:!1},_v={readContext:rn,useCallback:function(e,t){return Sn().memoizedState=[e,t===void 0?null:t],e},useContext:rn,useEffect:Ed,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Di(4194308,4,Gf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Di(4194308,4,e,t)},useInsertionEffect:function(e,t){return Di(4,2,e,t)},useMemo:function(e,t){var n=Sn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Sn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Nv.bind(null,Fe,e),[r.memoizedState,e]},useRef:function(e){var t=Sn();return e={current:e},t.memoizedState=e},useState:Cd,useDebugValue:xu,useDeferredValue:function(e){return Sn().memoizedState=e},useTransition:function(){var e=Cd(!1),t=e[0];return e=jv.bind(null,e[1]),Sn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Fe,a=Sn();if(Be){if(n===void 0)throw Error(B(407));n=n()}else{if(n=t(),ot===null)throw Error(B(349));Ys&30||zf(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,Ed(Uf.bind(null,r,i,e),[e]),r.flags|=2048,Ua(9,$f.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Sn(),t=ot.identifierPrefix;if(Be){var n=Vn,r=Un;n=(r&~(1<<32-mn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=za++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=yv++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Sv={readContext:rn,useCallback:Yf,useContext:rn,useEffect:vu,useImperativeHandle:Qf,useInsertionEffect:Hf,useLayoutEffect:qf,useMemo:Kf,useReducer:So,useRef:Wf,useState:function(){return So($a)},useDebugValue:xu,useDeferredValue:function(e){var t=an();return Xf(t,st.memoizedState,e)},useTransition:function(){var e=So($a)[0],t=an().memoizedState;return[e,t]},useMutableSource:If,useSyncExternalStore:Bf,useId:Jf,unstable_isNewReconciler:!1},kv={readContext:rn,useCallback:Yf,useContext:rn,useEffect:vu,useImperativeHandle:Qf,useInsertionEffect:Hf,useLayoutEffect:qf,useMemo:Kf,useReducer:ko,useRef:Wf,useState:function(){return ko($a)},useDebugValue:xu,useDeferredValue:function(e){var t=an();return st===null?t.memoizedState=e:Xf(t,st.memoizedState,e)},useTransition:function(){var e=ko($a)[0],t=an().memoizedState;return[e,t]},useMutableSource:If,useSyncExternalStore:Bf,useId:Jf,unstable_isNewReconciler:!1};function dn(e,t){if(e&&e.defaultProps){t=We({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function fc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:We({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var kl={isMounted:function(e){return(e=e._reactInternals)?Zs(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Lt(),a=bs(e),i=Fn(r,a);i.payload=t,n!=null&&(i.callback=n),t=Ss(e,i,a),t!==null&&(gn(t,e,a,r),Pi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Lt(),a=bs(e),i=Fn(r,a);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Ss(e,i,a),t!==null&&(gn(t,e,a,r),Pi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Lt(),r=bs(e),a=Fn(n,r);a.tag=2,t!=null&&(a.callback=t),t=Ss(e,a,r),t!==null&&(gn(t,e,r,n),Pi(t,e,r))}};function Td(e,t,n,r,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,l):t.prototype&&t.prototype.isPureReactComponent?!Oa(n,r)||!Oa(a,i):!0}function np(e,t,n){var r=!1,a=As,i=t.contextType;return typeof i=="object"&&i!==null?i=rn(i):(a=Bt(t)?Gs:kt.current,r=t.contextTypes,i=(r=r!=null)?Or(e,a):As),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=kl,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Ad(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&kl.enqueueReplaceState(t,t.state,null)}function pc(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},uu(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=rn(i):(i=Bt(t)?Gs:kt.current,a.context=Or(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(fc(e,t,i,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&kl.enqueueReplaceState(a,a.state,null),il(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Ir(e,t){try{var n="",r=t;do n+=Zm(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function bo(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function mc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var bv=typeof WeakMap=="function"?WeakMap:Map;function sp(e,t,n){n=Fn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){dl||(dl=!0,kc=r),mc(e,t)},n}function rp(e,t,n){n=Fn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){mc(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){mc(e,t),typeof r!="function"&&(ks===null?ks=new Set([this]):ks.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function Ld(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new bv;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=$v.bind(null,e,t,n),t.then(e,e))}function Rd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Od(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Fn(-1,1),t.tag=2,Ss(n,t,1))),n.lanes|=1),e)}var Cv=Qn.ReactCurrentOwner,Dt=!1;function At(e,t,n,r){t.child=e===null?Of(t,null,n,r):Mr(t,e.child,n,r)}function Pd(e,t,n,r,a){n=n.render;var i=t.ref;return Ar(t,a),r=mu(e,t,n,r,i,a),n=gu(),e!==null&&!Dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gn(e,t,a)):(Be&&n&&su(t),t.flags|=1,At(e,t,r,a),t.child)}function Md(e,t,n,r,a){if(e===null){var i=n.type;return typeof i=="function"&&!bu(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,ap(e,t,i,r,a)):(e=$i(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(n=n.compare,n=n!==null?n:Oa,n(l,r)&&e.ref===t.ref)return Gn(e,t,a)}return t.flags|=1,e=Cs(i,r),e.ref=t.ref,e.return=t,t.child=e}function ap(e,t,n,r,a){if(e!==null){var i=e.memoizedProps;if(Oa(i,r)&&e.ref===t.ref)if(Dt=!1,t.pendingProps=r=i,(e.lanes&a)!==0)e.flags&131072&&(Dt=!0);else return t.lanes=e.lanes,Gn(e,t,a)}return gc(e,t,n,r,a)}function ip(e,t,n){var r=t.pendingProps,a=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oe(kr,Vt),Vt|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Oe(kr,Vt),Vt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Oe(kr,Vt),Vt|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Oe(kr,Vt),Vt|=r;return At(e,t,a,n),t.child}function lp(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function gc(e,t,n,r,a){var i=Bt(n)?Gs:kt.current;return i=Or(t,i),Ar(t,a),n=mu(e,t,n,r,i,a),r=gu(),e!==null&&!Dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gn(e,t,a)):(Be&&r&&su(t),t.flags|=1,At(e,t,n,a),t.child)}function Dd(e,t,n,r,a){if(Bt(n)){var i=!0;tl(t)}else i=!1;if(Ar(t,a),t.stateNode===null)Ii(e,t),np(t,n,r),pc(t,n,r,a),r=!0;else if(e===null){var l=t.stateNode,c=t.memoizedProps;l.props=c;var u=l.context,m=n.contextType;typeof m=="object"&&m!==null?m=rn(m):(m=Bt(n)?Gs:kt.current,m=Or(t,m));var N=n.getDerivedStateFromProps,v=typeof N=="function"||typeof l.getSnapshotBeforeUpdate=="function";v||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==r||u!==m)&&Ad(t,l,r,m),ms=!1;var x=t.memoizedState;l.state=x,il(t,r,l,a),u=t.memoizedState,c!==r||x!==u||It.current||ms?(typeof N=="function"&&(fc(t,n,N,r),u=t.memoizedState),(c=ms||Td(t,n,c,r,x,u,m))?(v||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),l.props=r,l.state=u,l.context=m,r=c):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,Mf(e,t),c=t.memoizedProps,m=t.type===t.elementType?c:dn(t.type,c),l.props=m,v=t.pendingProps,x=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=rn(u):(u=Bt(n)?Gs:kt.current,u=Or(t,u));var C=n.getDerivedStateFromProps;(N=typeof C=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==v||x!==u)&&Ad(t,l,r,u),ms=!1,x=t.memoizedState,l.state=x,il(t,r,l,a);var L=t.memoizedState;c!==v||x!==L||It.current||ms?(typeof C=="function"&&(fc(t,n,C,r),L=t.memoizedState),(m=ms||Td(t,n,m,r,x,L,u)||!1)?(N||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,L,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,L,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=L),l.props=r,l.state=L,l.context=u,r=m):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),r=!1)}return vc(e,t,n,r,i,a)}function vc(e,t,n,r,a,i){lp(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return a&&Nd(t,n,!1),Gn(e,t,i);r=t.stateNode,Cv.current=t;var c=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=Mr(t,e.child,null,i),t.child=Mr(t,null,c,i)):At(e,t,c,i),t.memoizedState=r.state,a&&Nd(t,n,!0),t.child}function op(e){var t=e.stateNode;t.pendingContext?jd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&jd(e,t.context,!1),du(e,t.containerInfo)}function Id(e,t,n,r,a){return Pr(),au(a),t.flags|=256,At(e,t,n,r),t.child}var xc={dehydrated:null,treeContext:null,retryLane:0};function yc(e){return{baseLanes:e,cachePool:null,transitions:null}}function cp(e,t,n){var r=t.pendingProps,a=Ve.current,i=!1,l=(t.flags&128)!==0,c;if((c=l)||(c=e!==null&&e.memoizedState===null?!1:(a&2)!==0),c?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Oe(Ve,a&1),e===null)return dc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,i?(r=t.mode,i=t.child,l={mode:"hidden",children:l},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=El(l,r,0,null),e=qs(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=yc(n),t.memoizedState=xc,e):yu(t,l));if(a=e.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return Ev(e,t,l,r,c,a,n);if(i){i=r.fallback,l=t.mode,a=e.child,c=a.sibling;var u={mode:"hidden",children:r.children};return!(l&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Cs(a,u),r.subtreeFlags=a.subtreeFlags&14680064),c!==null?i=Cs(c,i):(i=qs(i,l,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,l=e.child.memoizedState,l=l===null?yc(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=xc,r}return i=e.child,e=i.sibling,r=Cs(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function yu(e,t){return t=El({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ni(e,t,n,r){return r!==null&&au(r),Mr(t,e.child,null,n),e=yu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ev(e,t,n,r,a,i,l){if(n)return t.flags&256?(t.flags&=-257,r=bo(Error(B(422))),Ni(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=El({mode:"visible",children:r.children},a,0,null),i=qs(i,a,l,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Mr(t,e.child,null,l),t.child.memoizedState=yc(l),t.memoizedState=xc,i);if(!(t.mode&1))return Ni(e,t,l,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(B(419)),r=bo(i,r,void 0),Ni(e,t,l,r)}if(c=(l&e.childLanes)!==0,Dt||c){if(r=ot,r!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,qn(e,a),gn(r,e,a,-1))}return ku(),r=bo(Error(B(421))),Ni(e,t,l,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Uv.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Ft=_s(a.nextSibling),Wt=t,Be=!0,pn=null,e!==null&&(Zt[en++]=Un,Zt[en++]=Vn,Zt[en++]=Qs,Un=e.id,Vn=e.overflow,Qs=t),t=yu(t,r.children),t.flags|=4096,t)}function Bd(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),hc(e.return,t,n)}function Co(e,t,n,r,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function up(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(At(e,t,r.children,n),r=Ve.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Bd(e,n,t);else if(e.tag===19)Bd(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Oe(Ve,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&ll(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Co(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&ll(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Co(t,!0,n,null,i);break;case"together":Co(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ii(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ks|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(B(153));if(t.child!==null){for(e=t.child,n=Cs(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Cs(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Tv(e,t,n){switch(t.tag){case 3:op(t),Pr();break;case 5:Df(t);break;case 1:Bt(t.type)&&tl(t);break;case 4:du(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Oe(rl,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Oe(Ve,Ve.current&1),t.flags|=128,null):n&t.child.childLanes?cp(e,t,n):(Oe(Ve,Ve.current&1),e=Gn(e,t,n),e!==null?e.sibling:null);Oe(Ve,Ve.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return up(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Oe(Ve,Ve.current),r)break;return null;case 22:case 23:return t.lanes=0,ip(e,t,n)}return Gn(e,t,n)}var dp,jc,hp,fp;dp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jc=function(){};hp=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Ws(En.current);var i=null;switch(n){case"input":a=Vo(e,a),r=Vo(e,r),i=[];break;case"select":a=We({},a,{value:void 0}),r=We({},r,{value:void 0}),i=[];break;case"textarea":a=Ho(e,a),r=Ho(e,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Zi)}Go(n,r);var l;n=null;for(m in a)if(!r.hasOwnProperty(m)&&a.hasOwnProperty(m)&&a[m]!=null)if(m==="style"){var c=a[m];for(l in c)c.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(ba.hasOwnProperty(m)?i||(i=[]):(i=i||[]).push(m,null));for(m in r){var u=r[m];if(c=a!=null?a[m]:void 0,r.hasOwnProperty(m)&&u!==c&&(u!=null||c!=null))if(m==="style")if(c){for(l in c)!c.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&c[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(i||(i=[]),i.push(m,n)),n=u;else m==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(m,u)):m==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(m,""+u):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(ba.hasOwnProperty(m)?(u!=null&&m==="onScroll"&&Pe("scroll",e),i||c===u||(i=[])):(i=i||[]).push(m,u))}n&&(i=i||[]).push("style",n);var m=i;(t.updateQueue=m)&&(t.flags|=4)}};fp=function(e,t,n,r){n!==r&&(t.flags|=4)};function oa(e,t){if(!Be)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function _t(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Av(e,t,n){var r=t.pendingProps;switch(ru(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(t),null;case 1:return Bt(t.type)&&el(),_t(t),null;case 3:return r=t.stateNode,Dr(),Me(It),Me(kt),fu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(yi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,pn!==null&&(Ec(pn),pn=null))),jc(e,t),_t(t),null;case 5:hu(t);var a=Ws(Ba.current);if(n=t.type,e!==null&&t.stateNode!=null)hp(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(B(166));return _t(t),null}if(e=Ws(En.current),yi(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[bn]=t,r[Da]=i,e=(t.mode&1)!==0,n){case"dialog":Pe("cancel",r),Pe("close",r);break;case"iframe":case"object":case"embed":Pe("load",r);break;case"video":case"audio":for(a=0;a<pa.length;a++)Pe(pa[a],r);break;case"source":Pe("error",r);break;case"img":case"image":case"link":Pe("error",r),Pe("load",r);break;case"details":Pe("toggle",r);break;case"input":Gu(r,i),Pe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Pe("invalid",r);break;case"textarea":Yu(r,i),Pe("invalid",r)}Go(n,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&xi(r.textContent,c,e),a=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&xi(r.textContent,c,e),a=["children",""+c]):ba.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&Pe("scroll",r)}switch(n){case"input":ui(r),Qu(r,i,!0);break;case"textarea":ui(r),Ku(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Zi)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$h(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[bn]=t,e[Da]=r,dp(e,t,!1,!1),t.stateNode=e;e:{switch(l=Qo(n,r),n){case"dialog":Pe("cancel",e),Pe("close",e),a=r;break;case"iframe":case"object":case"embed":Pe("load",e),a=r;break;case"video":case"audio":for(a=0;a<pa.length;a++)Pe(pa[a],e);a=r;break;case"source":Pe("error",e),a=r;break;case"img":case"image":case"link":Pe("error",e),Pe("load",e),a=r;break;case"details":Pe("toggle",e),a=r;break;case"input":Gu(e,r),a=Vo(e,r),Pe("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=We({},r,{value:void 0}),Pe("invalid",e);break;case"textarea":Yu(e,r),a=Ho(e,r),Pe("invalid",e);break;default:a=r}Go(n,a),c=a;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?Fh(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Uh(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ca(e,u):typeof u=="number"&&Ca(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ba.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Pe("scroll",e):u!=null&&Fc(e,i,u,l))}switch(n){case"input":ui(e),Qu(e,r,!1);break;case"textarea":ui(e),Ku(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Ts(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?br(e,!!r.multiple,i,!1):r.defaultValue!=null&&br(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Zi)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return _t(t),null;case 6:if(e&&t.stateNode!=null)fp(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(B(166));if(n=Ws(Ba.current),Ws(En.current),yi(t)){if(r=t.stateNode,n=t.memoizedProps,r[bn]=t,(i=r.nodeValue!==n)&&(e=Wt,e!==null))switch(e.tag){case 3:xi(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&xi(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[bn]=t,t.stateNode=r}return _t(t),null;case 13:if(Me(Ve),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Be&&Ft!==null&&t.mode&1&&!(t.flags&128))Lf(),Pr(),t.flags|=98560,i=!1;else if(i=yi(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(B(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(B(317));i[bn]=t}else Pr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;_t(t),i=!1}else pn!==null&&(Ec(pn),pn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ve.current&1?rt===0&&(rt=3):ku())),t.updateQueue!==null&&(t.flags|=4),_t(t),null);case 4:return Dr(),jc(e,t),e===null&&Pa(t.stateNode.containerInfo),_t(t),null;case 10:return ou(t.type._context),_t(t),null;case 17:return Bt(t.type)&&el(),_t(t),null;case 19:if(Me(Ve),i=t.memoizedState,i===null)return _t(t),null;if(r=(t.flags&128)!==0,l=i.rendering,l===null)if(r)oa(i,!1);else{if(rt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=ll(e),l!==null){for(t.flags|=128,oa(i,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Oe(Ve,Ve.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ye()>Br&&(t.flags|=128,r=!0,oa(i,!1),t.lanes=4194304)}else{if(!r)if(e=ll(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),oa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!Be)return _t(t),null}else 2*Ye()-i.renderingStartTime>Br&&n!==1073741824&&(t.flags|=128,r=!0,oa(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(n=i.last,n!==null?n.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ye(),t.sibling=null,n=Ve.current,Oe(Ve,r?n&1|2:n&1),t):(_t(t),null);case 22:case 23:return Su(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Vt&1073741824&&(_t(t),t.subtreeFlags&6&&(t.flags|=8192)):_t(t),null;case 24:return null;case 25:return null}throw Error(B(156,t.tag))}function Lv(e,t){switch(ru(t),t.tag){case 1:return Bt(t.type)&&el(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Dr(),Me(It),Me(kt),fu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return hu(t),null;case 13:if(Me(Ve),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(B(340));Pr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Me(Ve),null;case 4:return Dr(),null;case 10:return ou(t.type._context),null;case 22:case 23:return Su(),null;case 24:return null;default:return null}}var wi=!1,St=!1,Rv=typeof WeakSet=="function"?WeakSet:Set,Y=null;function Sr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qe(e,t,r)}else n.current=null}function Nc(e,t,n){try{n()}catch(r){qe(e,t,r)}}var zd=!1;function Ov(e,t){if(rc=Ki,e=xf(),nu(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var l=0,c=-1,u=-1,m=0,N=0,v=e,x=null;t:for(;;){for(var C;v!==n||a!==0&&v.nodeType!==3||(c=l+a),v!==i||r!==0&&v.nodeType!==3||(u=l+r),v.nodeType===3&&(l+=v.nodeValue.length),(C=v.firstChild)!==null;)x=v,v=C;for(;;){if(v===e)break t;if(x===n&&++m===a&&(c=l),x===i&&++N===r&&(u=l),(C=v.nextSibling)!==null)break;v=x,x=v.parentNode}v=C}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ac={focusedElem:e,selectionRange:n},Ki=!1,Y=t;Y!==null;)if(t=Y,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Y=e;else for(;Y!==null;){t=Y;try{var L=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(L!==null){var R=L.memoizedProps,g=L.memoizedState,h=t.stateNode,p=h.getSnapshotBeforeUpdate(t.elementType===t.type?R:dn(t.type,R),g);h.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(k){qe(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,Y=e;break}Y=t.return}return L=zd,zd=!1,L}function wa(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Nc(t,n,i)}a=a.next}while(a!==r)}}function bl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function wc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function pp(e){var t=e.alternate;t!==null&&(e.alternate=null,pp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[bn],delete t[Da],delete t[oc],delete t[mv],delete t[gv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function mp(e){return e.tag===5||e.tag===3||e.tag===4}function $d(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||mp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function _c(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Zi));else if(r!==4&&(e=e.child,e!==null))for(_c(e,t,n),e=e.sibling;e!==null;)_c(e,t,n),e=e.sibling}function Sc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Sc(e,t,n),e=e.sibling;e!==null;)Sc(e,t,n),e=e.sibling}var pt=null,hn=!1;function fs(e,t,n){for(n=n.child;n!==null;)gp(e,t,n),n=n.sibling}function gp(e,t,n){if(Cn&&typeof Cn.onCommitFiberUnmount=="function")try{Cn.onCommitFiberUnmount(xl,n)}catch{}switch(n.tag){case 5:St||Sr(n,t);case 6:var r=pt,a=hn;pt=null,fs(e,t,n),pt=r,hn=a,pt!==null&&(hn?(e=pt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):pt.removeChild(n.stateNode));break;case 18:pt!==null&&(hn?(e=pt,n=n.stateNode,e.nodeType===8?jo(e.parentNode,n):e.nodeType===1&&jo(e,n),La(e)):jo(pt,n.stateNode));break;case 4:r=pt,a=hn,pt=n.stateNode.containerInfo,hn=!0,fs(e,t,n),pt=r,hn=a;break;case 0:case 11:case 14:case 15:if(!St&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Nc(n,t,l),a=a.next}while(a!==r)}fs(e,t,n);break;case 1:if(!St&&(Sr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){qe(n,t,c)}fs(e,t,n);break;case 21:fs(e,t,n);break;case 22:n.mode&1?(St=(r=St)||n.memoizedState!==null,fs(e,t,n),St=r):fs(e,t,n);break;default:fs(e,t,n)}}function Ud(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Rv),t.forEach(function(r){var a=Vv.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function un(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,l=t,c=l;e:for(;c!==null;){switch(c.tag){case 5:pt=c.stateNode,hn=!1;break e;case 3:pt=c.stateNode.containerInfo,hn=!0;break e;case 4:pt=c.stateNode.containerInfo,hn=!0;break e}c=c.return}if(pt===null)throw Error(B(160));gp(i,l,a),pt=null,hn=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(m){qe(a,t,m)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)vp(t,e),t=t.sibling}function vp(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(un(t,e),_n(e),r&4){try{wa(3,e,e.return),bl(3,e)}catch(R){qe(e,e.return,R)}try{wa(5,e,e.return)}catch(R){qe(e,e.return,R)}}break;case 1:un(t,e),_n(e),r&512&&n!==null&&Sr(n,n.return);break;case 5:if(un(t,e),_n(e),r&512&&n!==null&&Sr(n,n.return),e.flags&32){var a=e.stateNode;try{Ca(a,"")}catch(R){qe(e,e.return,R)}}if(r&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=n!==null?n.memoizedProps:i,c=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&Bh(a,i),Qo(c,l);var m=Qo(c,i);for(l=0;l<u.length;l+=2){var N=u[l],v=u[l+1];N==="style"?Fh(a,v):N==="dangerouslySetInnerHTML"?Uh(a,v):N==="children"?Ca(a,v):Fc(a,N,v,m)}switch(c){case"input":Fo(a,i);break;case"textarea":zh(a,i);break;case"select":var x=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var C=i.value;C!=null?br(a,!!i.multiple,C,!1):x!==!!i.multiple&&(i.defaultValue!=null?br(a,!!i.multiple,i.defaultValue,!0):br(a,!!i.multiple,i.multiple?[]:"",!1))}a[Da]=i}catch(R){qe(e,e.return,R)}}break;case 6:if(un(t,e),_n(e),r&4){if(e.stateNode===null)throw Error(B(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(R){qe(e,e.return,R)}}break;case 3:if(un(t,e),_n(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{La(t.containerInfo)}catch(R){qe(e,e.return,R)}break;case 4:un(t,e),_n(e);break;case 13:un(t,e),_n(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(wu=Ye())),r&4&&Ud(e);break;case 22:if(N=n!==null&&n.memoizedState!==null,e.mode&1?(St=(m=St)||N,un(t,e),St=m):un(t,e),_n(e),r&8192){if(m=e.memoizedState!==null,(e.stateNode.isHidden=m)&&!N&&e.mode&1)for(Y=e,N=e.child;N!==null;){for(v=Y=N;Y!==null;){switch(x=Y,C=x.child,x.tag){case 0:case 11:case 14:case 15:wa(4,x,x.return);break;case 1:Sr(x,x.return);var L=x.stateNode;if(typeof L.componentWillUnmount=="function"){r=x,n=x.return;try{t=r,L.props=t.memoizedProps,L.state=t.memoizedState,L.componentWillUnmount()}catch(R){qe(r,n,R)}}break;case 5:Sr(x,x.return);break;case 22:if(x.memoizedState!==null){Fd(v);continue}}C!==null?(C.return=x,Y=C):Fd(v)}N=N.sibling}e:for(N=null,v=e;;){if(v.tag===5){if(N===null){N=v;try{a=v.stateNode,m?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=v.stateNode,u=v.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=Vh("display",l))}catch(R){qe(e,e.return,R)}}}else if(v.tag===6){if(N===null)try{v.stateNode.nodeValue=m?"":v.memoizedProps}catch(R){qe(e,e.return,R)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===e)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===e)break e;for(;v.sibling===null;){if(v.return===null||v.return===e)break e;N===v&&(N=null),v=v.return}N===v&&(N=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:un(t,e),_n(e),r&4&&Ud(e);break;case 21:break;default:un(t,e),_n(e)}}function _n(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(mp(n)){var r=n;break e}n=n.return}throw Error(B(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(Ca(a,""),r.flags&=-33);var i=$d(e);Sc(e,i,a);break;case 3:case 4:var l=r.stateNode.containerInfo,c=$d(e);_c(e,c,l);break;default:throw Error(B(161))}}catch(u){qe(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Pv(e,t,n){Y=e,xp(e)}function xp(e,t,n){for(var r=(e.mode&1)!==0;Y!==null;){var a=Y,i=a.child;if(a.tag===22&&r){var l=a.memoizedState!==null||wi;if(!l){var c=a.alternate,u=c!==null&&c.memoizedState!==null||St;c=wi;var m=St;if(wi=l,(St=u)&&!m)for(Y=a;Y!==null;)l=Y,u=l.child,l.tag===22&&l.memoizedState!==null?Wd(a):u!==null?(u.return=l,Y=u):Wd(a);for(;i!==null;)Y=i,xp(i),i=i.sibling;Y=a,wi=c,St=m}Vd(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Y=i):Vd(e)}}function Vd(e){for(;Y!==null;){var t=Y;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:St||bl(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!St)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:dn(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&bd(t,i,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}bd(t,l,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var m=t.alternate;if(m!==null){var N=m.memoizedState;if(N!==null){var v=N.dehydrated;v!==null&&La(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}St||t.flags&512&&wc(t)}catch(x){qe(t,t.return,x)}}if(t===e){Y=null;break}if(n=t.sibling,n!==null){n.return=t.return,Y=n;break}Y=t.return}}function Fd(e){for(;Y!==null;){var t=Y;if(t===e){Y=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Y=n;break}Y=t.return}}function Wd(e){for(;Y!==null;){var t=Y;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{bl(4,t)}catch(u){qe(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(u){qe(t,a,u)}}var i=t.return;try{wc(t)}catch(u){qe(t,i,u)}break;case 5:var l=t.return;try{wc(t)}catch(u){qe(t,l,u)}}}catch(u){qe(t,t.return,u)}if(t===e){Y=null;break}var c=t.sibling;if(c!==null){c.return=t.return,Y=c;break}Y=t.return}}var Mv=Math.ceil,ul=Qn.ReactCurrentDispatcher,ju=Qn.ReactCurrentOwner,sn=Qn.ReactCurrentBatchConfig,xe=0,ot=null,Je=null,mt=0,Vt=0,kr=Rs(0),rt=0,Va=null,Ks=0,Cl=0,Nu=0,_a=null,Mt=null,wu=0,Br=1/0,Bn=null,dl=!1,kc=null,ks=null,_i=!1,ys=null,hl=0,Sa=0,bc=null,Bi=-1,zi=0;function Lt(){return xe&6?Ye():Bi!==-1?Bi:Bi=Ye()}function bs(e){return e.mode&1?xe&2&&mt!==0?mt&-mt:xv.transition!==null?(zi===0&&(zi=tf()),zi):(e=ke,e!==0||(e=window.event,e=e===void 0?16:cf(e.type)),e):1}function gn(e,t,n,r){if(50<Sa)throw Sa=0,bc=null,Error(B(185));Wa(e,n,r),(!(xe&2)||e!==ot)&&(e===ot&&(!(xe&2)&&(Cl|=n),rt===4&&vs(e,mt)),zt(e,r),n===1&&xe===0&&!(t.mode&1)&&(Br=Ye()+500,_l&&Os()))}function zt(e,t){var n=e.callbackNode;xg(e,t);var r=Yi(e,e===ot?mt:0);if(r===0)n!==null&&Zu(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Zu(n),t===1)e.tag===0?vv(Hd.bind(null,e)):Ef(Hd.bind(null,e)),fv(function(){!(xe&6)&&Os()}),n=null;else{switch(nf(r)){case 1:n=Qc;break;case 4:n=Zh;break;case 16:n=Qi;break;case 536870912:n=ef;break;default:n=Qi}n=bp(n,yp.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function yp(e,t){if(Bi=-1,zi=0,xe&6)throw Error(B(327));var n=e.callbackNode;if(Lr()&&e.callbackNode!==n)return null;var r=Yi(e,e===ot?mt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=fl(e,r);else{t=r;var a=xe;xe|=2;var i=Np();(ot!==e||mt!==t)&&(Bn=null,Br=Ye()+500,Hs(e,t));do try{Bv();break}catch(c){jp(e,c)}while(!0);lu(),ul.current=i,xe=a,Je!==null?t=0:(ot=null,mt=0,t=rt)}if(t!==0){if(t===2&&(a=Zo(e),a!==0&&(r=a,t=Cc(e,a))),t===1)throw n=Va,Hs(e,0),vs(e,r),zt(e,Ye()),n;if(t===6)vs(e,r);else{if(a=e.current.alternate,!(r&30)&&!Dv(a)&&(t=fl(e,r),t===2&&(i=Zo(e),i!==0&&(r=i,t=Cc(e,i))),t===1))throw n=Va,Hs(e,0),vs(e,r),zt(e,Ye()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(B(345));case 2:Us(e,Mt,Bn);break;case 3:if(vs(e,r),(r&130023424)===r&&(t=wu+500-Ye(),10<t)){if(Yi(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){Lt(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=lc(Us.bind(null,e,Mt,Bn),t);break}Us(e,Mt,Bn);break;case 4:if(vs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var l=31-mn(r);i=1<<l,l=t[l],l>a&&(a=l),r&=~i}if(r=a,r=Ye()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Mv(r/1960))-r,10<r){e.timeoutHandle=lc(Us.bind(null,e,Mt,Bn),r);break}Us(e,Mt,Bn);break;case 5:Us(e,Mt,Bn);break;default:throw Error(B(329))}}}return zt(e,Ye()),e.callbackNode===n?yp.bind(null,e):null}function Cc(e,t){var n=_a;return e.current.memoizedState.isDehydrated&&(Hs(e,t).flags|=256),e=fl(e,t),e!==2&&(t=Mt,Mt=n,t!==null&&Ec(t)),e}function Ec(e){Mt===null?Mt=e:Mt.push.apply(Mt,e)}function Dv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!vn(i(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function vs(e,t){for(t&=~Nu,t&=~Cl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-mn(t),r=1<<n;e[n]=-1,t&=~r}}function Hd(e){if(xe&6)throw Error(B(327));Lr();var t=Yi(e,0);if(!(t&1))return zt(e,Ye()),null;var n=fl(e,t);if(e.tag!==0&&n===2){var r=Zo(e);r!==0&&(t=r,n=Cc(e,r))}if(n===1)throw n=Va,Hs(e,0),vs(e,t),zt(e,Ye()),n;if(n===6)throw Error(B(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Us(e,Mt,Bn),zt(e,Ye()),null}function _u(e,t){var n=xe;xe|=1;try{return e(t)}finally{xe=n,xe===0&&(Br=Ye()+500,_l&&Os())}}function Xs(e){ys!==null&&ys.tag===0&&!(xe&6)&&Lr();var t=xe;xe|=1;var n=sn.transition,r=ke;try{if(sn.transition=null,ke=1,e)return e()}finally{ke=r,sn.transition=n,xe=t,!(xe&6)&&Os()}}function Su(){Vt=kr.current,Me(kr)}function Hs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,hv(n)),Je!==null)for(n=Je.return;n!==null;){var r=n;switch(ru(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&el();break;case 3:Dr(),Me(It),Me(kt),fu();break;case 5:hu(r);break;case 4:Dr();break;case 13:Me(Ve);break;case 19:Me(Ve);break;case 10:ou(r.type._context);break;case 22:case 23:Su()}n=n.return}if(ot=e,Je=e=Cs(e.current,null),mt=Vt=t,rt=0,Va=null,Nu=Cl=Ks=0,Mt=_a=null,Fs!==null){for(t=0;t<Fs.length;t++)if(n=Fs[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var l=i.next;i.next=a,r.next=l}n.pending=r}Fs=null}return e}function jp(e,t){do{var n=Je;try{if(lu(),Mi.current=cl,ol){for(var r=Fe.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}ol=!1}if(Ys=0,lt=st=Fe=null,Na=!1,za=0,ju.current=null,n===null||n.return===null){rt=1,Va=t,Je=null;break}e:{var i=e,l=n.return,c=n,u=t;if(t=mt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var m=u,N=c,v=N.tag;if(!(N.mode&1)&&(v===0||v===11||v===15)){var x=N.alternate;x?(N.updateQueue=x.updateQueue,N.memoizedState=x.memoizedState,N.lanes=x.lanes):(N.updateQueue=null,N.memoizedState=null)}var C=Rd(l);if(C!==null){C.flags&=-257,Od(C,l,c,i,t),C.mode&1&&Ld(i,m,t),t=C,u=m;var L=t.updateQueue;if(L===null){var R=new Set;R.add(u),t.updateQueue=R}else L.add(u);break e}else{if(!(t&1)){Ld(i,m,t),ku();break e}u=Error(B(426))}}else if(Be&&c.mode&1){var g=Rd(l);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Od(g,l,c,i,t),au(Ir(u,c));break e}}i=u=Ir(u,c),rt!==4&&(rt=2),_a===null?_a=[i]:_a.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var h=sp(i,u,t);kd(i,h);break e;case 1:c=u;var p=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ks===null||!ks.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var k=rp(i,c,t);kd(i,k);break e}}i=i.return}while(i!==null)}_p(n)}catch(D){t=D,Je===n&&n!==null&&(Je=n=n.return);continue}break}while(!0)}function Np(){var e=ul.current;return ul.current=cl,e===null?cl:e}function ku(){(rt===0||rt===3||rt===2)&&(rt=4),ot===null||!(Ks&268435455)&&!(Cl&268435455)||vs(ot,mt)}function fl(e,t){var n=xe;xe|=2;var r=Np();(ot!==e||mt!==t)&&(Bn=null,Hs(e,t));do try{Iv();break}catch(a){jp(e,a)}while(!0);if(lu(),xe=n,ul.current=r,Je!==null)throw Error(B(261));return ot=null,mt=0,rt}function Iv(){for(;Je!==null;)wp(Je)}function Bv(){for(;Je!==null&&!cg();)wp(Je)}function wp(e){var t=kp(e.alternate,e,Vt);e.memoizedProps=e.pendingProps,t===null?_p(e):Je=t,ju.current=null}function _p(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Lv(n,t),n!==null){n.flags&=32767,Je=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{rt=6,Je=null;return}}else if(n=Av(n,t,Vt),n!==null){Je=n;return}if(t=t.sibling,t!==null){Je=t;return}Je=t=e}while(t!==null);rt===0&&(rt=5)}function Us(e,t,n){var r=ke,a=sn.transition;try{sn.transition=null,ke=1,zv(e,t,n,r)}finally{sn.transition=a,ke=r}return null}function zv(e,t,n,r){do Lr();while(ys!==null);if(xe&6)throw Error(B(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(B(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(yg(e,i),e===ot&&(Je=ot=null,mt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_i||(_i=!0,bp(Qi,function(){return Lr(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=sn.transition,sn.transition=null;var l=ke;ke=1;var c=xe;xe|=4,ju.current=null,Ov(e,n),vp(n,e),av(ac),Ki=!!rc,ac=rc=null,e.current=n,Pv(n),ug(),xe=c,ke=l,sn.transition=i}else e.current=n;if(_i&&(_i=!1,ys=e,hl=a),i=e.pendingLanes,i===0&&(ks=null),fg(n.stateNode),zt(e,Ye()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(dl)throw dl=!1,e=kc,kc=null,e;return hl&1&&e.tag!==0&&Lr(),i=e.pendingLanes,i&1?e===bc?Sa++:(Sa=0,bc=e):Sa=0,Os(),null}function Lr(){if(ys!==null){var e=nf(hl),t=sn.transition,n=ke;try{if(sn.transition=null,ke=16>e?16:e,ys===null)var r=!1;else{if(e=ys,ys=null,hl=0,xe&6)throw Error(B(331));var a=xe;for(xe|=4,Y=e.current;Y!==null;){var i=Y,l=i.child;if(Y.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var m=c[u];for(Y=m;Y!==null;){var N=Y;switch(N.tag){case 0:case 11:case 15:wa(8,N,i)}var v=N.child;if(v!==null)v.return=N,Y=v;else for(;Y!==null;){N=Y;var x=N.sibling,C=N.return;if(pp(N),N===m){Y=null;break}if(x!==null){x.return=C,Y=x;break}Y=C}}}var L=i.alternate;if(L!==null){var R=L.child;if(R!==null){L.child=null;do{var g=R.sibling;R.sibling=null,R=g}while(R!==null)}}Y=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,Y=l;else e:for(;Y!==null;){if(i=Y,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wa(9,i,i.return)}var h=i.sibling;if(h!==null){h.return=i.return,Y=h;break e}Y=i.return}}var p=e.current;for(Y=p;Y!==null;){l=Y;var y=l.child;if(l.subtreeFlags&2064&&y!==null)y.return=l,Y=y;else e:for(l=p;Y!==null;){if(c=Y,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:bl(9,c)}}catch(D){qe(c,c.return,D)}if(c===l){Y=null;break e}var k=c.sibling;if(k!==null){k.return=c.return,Y=k;break e}Y=c.return}}if(xe=a,Os(),Cn&&typeof Cn.onPostCommitFiberRoot=="function")try{Cn.onPostCommitFiberRoot(xl,e)}catch{}r=!0}return r}finally{ke=n,sn.transition=t}}return!1}function qd(e,t,n){t=Ir(n,t),t=sp(e,t,1),e=Ss(e,t,1),t=Lt(),e!==null&&(Wa(e,1,t),zt(e,t))}function qe(e,t,n){if(e.tag===3)qd(e,e,n);else for(;t!==null;){if(t.tag===3){qd(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ks===null||!ks.has(r))){e=Ir(n,e),e=rp(t,e,1),t=Ss(t,e,1),e=Lt(),t!==null&&(Wa(t,1,e),zt(t,e));break}}t=t.return}}function $v(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Lt(),e.pingedLanes|=e.suspendedLanes&n,ot===e&&(mt&n)===n&&(rt===4||rt===3&&(mt&130023424)===mt&&500>Ye()-wu?Hs(e,0):Nu|=n),zt(e,t)}function Sp(e,t){t===0&&(e.mode&1?(t=fi,fi<<=1,!(fi&130023424)&&(fi=4194304)):t=1);var n=Lt();e=qn(e,t),e!==null&&(Wa(e,t,n),zt(e,n))}function Uv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Sp(e,n)}function Vv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(B(314))}r!==null&&r.delete(t),Sp(e,n)}var kp;kp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||It.current)Dt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Dt=!1,Tv(e,t,n);Dt=!!(e.flags&131072)}else Dt=!1,Be&&t.flags&1048576&&Tf(t,sl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ii(e,t),e=t.pendingProps;var a=Or(t,kt.current);Ar(t,n),a=mu(null,t,r,e,a,n);var i=gu();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Bt(r)?(i=!0,tl(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,uu(t),a.updater=kl,t.stateNode=a,a._reactInternals=t,pc(t,r,e,n),t=vc(null,t,r,!0,i,n)):(t.tag=0,Be&&i&&su(t),At(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ii(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=Wv(r),e=dn(r,e),a){case 0:t=gc(null,t,r,e,n);break e;case 1:t=Dd(null,t,r,e,n);break e;case 11:t=Pd(null,t,r,e,n);break e;case 14:t=Md(null,t,r,dn(r.type,e),n);break e}throw Error(B(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:dn(r,a),gc(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:dn(r,a),Dd(e,t,r,a,n);case 3:e:{if(op(t),e===null)throw Error(B(387));r=t.pendingProps,i=t.memoizedState,a=i.element,Mf(e,t),il(t,r,null,n);var l=t.memoizedState;if(r=l.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Ir(Error(B(423)),t),t=Id(e,t,r,n,a);break e}else if(r!==a){a=Ir(Error(B(424)),t),t=Id(e,t,r,n,a);break e}else for(Ft=_s(t.stateNode.containerInfo.firstChild),Wt=t,Be=!0,pn=null,n=Of(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Pr(),r===a){t=Gn(e,t,n);break e}At(e,t,r,n)}t=t.child}return t;case 5:return Df(t),e===null&&dc(t),r=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,ic(r,a)?l=null:i!==null&&ic(r,i)&&(t.flags|=32),lp(e,t),At(e,t,l,n),t.child;case 6:return e===null&&dc(t),null;case 13:return cp(e,t,n);case 4:return du(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Mr(t,null,r,n):At(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:dn(r,a),Pd(e,t,r,a,n);case 7:return At(e,t,t.pendingProps,n),t.child;case 8:return At(e,t,t.pendingProps.children,n),t.child;case 12:return At(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,Oe(rl,r._currentValue),r._currentValue=l,i!==null)if(vn(i.value,l)){if(i.children===a.children&&!It.current){t=Gn(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var c=i.dependencies;if(c!==null){l=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Fn(-1,n&-n),u.tag=2;var m=i.updateQueue;if(m!==null){m=m.shared;var N=m.pending;N===null?u.next=u:(u.next=N.next,N.next=u),m.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),hc(i.return,n,t),c.lanes|=n;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(B(341));l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),hc(l,n,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}At(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ar(t,n),a=rn(a),r=r(a),t.flags|=1,At(e,t,r,n),t.child;case 14:return r=t.type,a=dn(r,t.pendingProps),a=dn(r.type,a),Md(e,t,r,a,n);case 15:return ap(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:dn(r,a),Ii(e,t),t.tag=1,Bt(r)?(e=!0,tl(t)):e=!1,Ar(t,n),np(t,r,a),pc(t,r,a,n),vc(null,t,r,!0,e,n);case 19:return up(e,t,n);case 22:return ip(e,t,n)}throw Error(B(156,t.tag))};function bp(e,t){return Jh(e,t)}function Fv(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nn(e,t,n,r){return new Fv(e,t,n,r)}function bu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Wv(e){if(typeof e=="function")return bu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Hc)return 11;if(e===qc)return 14}return 2}function Cs(e,t){var n=e.alternate;return n===null?(n=nn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function $i(e,t,n,r,a,i){var l=2;if(r=e,typeof e=="function")bu(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case mr:return qs(n.children,a,i,t);case Wc:l=8,a|=8;break;case Bo:return e=nn(12,n,t,a|2),e.elementType=Bo,e.lanes=i,e;case zo:return e=nn(13,n,t,a),e.elementType=zo,e.lanes=i,e;case $o:return e=nn(19,n,t,a),e.elementType=$o,e.lanes=i,e;case Mh:return El(n,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Oh:l=10;break e;case Ph:l=9;break e;case Hc:l=11;break e;case qc:l=14;break e;case ps:l=16,r=null;break e}throw Error(B(130,e==null?e:typeof e,""))}return t=nn(l,n,t,a),t.elementType=e,t.type=r,t.lanes=i,t}function qs(e,t,n,r){return e=nn(7,e,r,t),e.lanes=n,e}function El(e,t,n,r){return e=nn(22,e,r,t),e.elementType=Mh,e.lanes=n,e.stateNode={isHidden:!1},e}function Eo(e,t,n){return e=nn(6,e,null,t),e.lanes=n,e}function To(e,t,n){return t=nn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Hv(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oo(0),this.expirationTimes=oo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oo(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Cu(e,t,n,r,a,i,l,c,u){return e=new Hv(e,t,n,c,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=nn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},uu(i),e}function qv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Cp(e){if(!e)return As;e=e._reactInternals;e:{if(Zs(e)!==e||e.tag!==1)throw Error(B(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Bt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(B(171))}if(e.tag===1){var n=e.type;if(Bt(n))return Cf(e,n,t)}return t}function Ep(e,t,n,r,a,i,l,c,u){return e=Cu(n,r,!0,e,a,i,l,c,u),e.context=Cp(null),n=e.current,r=Lt(),a=bs(n),i=Fn(r,a),i.callback=t??null,Ss(n,i,a),e.current.lanes=a,Wa(e,a,r),zt(e,r),e}function Tl(e,t,n,r){var a=t.current,i=Lt(),l=bs(a);return n=Cp(n),t.context===null?t.context=n:t.pendingContext=n,t=Fn(i,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ss(a,t,l),e!==null&&(gn(e,a,l,i),Pi(e,a,l)),l}function pl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Gd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Eu(e,t){Gd(e,t),(e=e.alternate)&&Gd(e,t)}function Gv(){return null}var Tp=typeof reportError=="function"?reportError:function(e){console.error(e)};function Tu(e){this._internalRoot=e}Al.prototype.render=Tu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(B(409));Tl(e,t,null,null)};Al.prototype.unmount=Tu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Xs(function(){Tl(null,e,null,null)}),t[Hn]=null}};function Al(e){this._internalRoot=e}Al.prototype.unstable_scheduleHydration=function(e){if(e){var t=af();e={blockedOn:null,target:e,priority:t};for(var n=0;n<gs.length&&t!==0&&t<gs[n].priority;n++);gs.splice(n,0,e),n===0&&of(e)}};function Au(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ll(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Qd(){}function Qv(e,t,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var m=pl(l);i.call(m)}}var l=Ep(t,r,e,0,null,!1,!1,"",Qd);return e._reactRootContainer=l,e[Hn]=l.current,Pa(e.nodeType===8?e.parentNode:e),Xs(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var c=r;r=function(){var m=pl(u);c.call(m)}}var u=Cu(e,0,!1,null,null,!1,!1,"",Qd);return e._reactRootContainer=u,e[Hn]=u.current,Pa(e.nodeType===8?e.parentNode:e),Xs(function(){Tl(t,u,n,r)}),u}function Rl(e,t,n,r,a){var i=n._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var c=a;a=function(){var u=pl(l);c.call(u)}}Tl(t,l,e,a)}else l=Qv(n,t,e,a,r);return pl(l)}sf=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=fa(t.pendingLanes);n!==0&&(Yc(t,n|1),zt(t,Ye()),!(xe&6)&&(Br=Ye()+500,Os()))}break;case 13:Xs(function(){var r=qn(e,1);if(r!==null){var a=Lt();gn(r,e,1,a)}}),Eu(e,1)}};Kc=function(e){if(e.tag===13){var t=qn(e,134217728);if(t!==null){var n=Lt();gn(t,e,134217728,n)}Eu(e,134217728)}};rf=function(e){if(e.tag===13){var t=bs(e),n=qn(e,t);if(n!==null){var r=Lt();gn(n,e,t,r)}Eu(e,t)}};af=function(){return ke};lf=function(e,t){var n=ke;try{return ke=e,t()}finally{ke=n}};Ko=function(e,t,n){switch(t){case"input":if(Fo(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wl(r);if(!a)throw Error(B(90));Ih(r),Fo(r,a)}}}break;case"textarea":zh(e,n);break;case"select":t=n.value,t!=null&&br(e,!!n.multiple,t,!1)}};qh=_u;Gh=Xs;var Yv={usingClientEntryPoint:!1,Events:[qa,yr,wl,Wh,Hh,_u]},ca={findFiberByHostInstance:Vs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Kv={bundleType:ca.bundleType,version:ca.version,rendererPackageName:ca.rendererPackageName,rendererConfig:ca.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Kh(e),e===null?null:e.stateNode},findFiberByHostInstance:ca.findFiberByHostInstance||Gv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Si=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Si.isDisabled&&Si.supportsFiber)try{xl=Si.inject(Kv),Cn=Si}catch{}}qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yv;qt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Au(t))throw Error(B(200));return qv(e,t,null,n)};qt.createRoot=function(e,t){if(!Au(e))throw Error(B(299));var n=!1,r="",a=Tp;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Cu(e,1,!1,null,null,n,!1,r,a),e[Hn]=t.current,Pa(e.nodeType===8?e.parentNode:e),new Tu(t)};qt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(B(188)):(e=Object.keys(e).join(","),Error(B(268,e)));return e=Kh(t),e=e===null?null:e.stateNode,e};qt.flushSync=function(e){return Xs(e)};qt.hydrate=function(e,t,n){if(!Ll(t))throw Error(B(200));return Rl(null,e,t,!0,n)};qt.hydrateRoot=function(e,t,n){if(!Au(e))throw Error(B(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",l=Tp;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=Ep(t,null,e,1,n??null,a,!1,i,l),e[Hn]=t.current,Pa(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Al(t)};qt.render=function(e,t,n){if(!Ll(t))throw Error(B(200));return Rl(null,e,t,!1,n)};qt.unmountComponentAtNode=function(e){if(!Ll(e))throw Error(B(40));return e._reactRootContainer?(Xs(function(){Rl(null,null,e,!1,function(){e._reactRootContainer=null,e[Hn]=null})}),!0):!1};qt.unstable_batchedUpdates=_u;qt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ll(n))throw Error(B(200));if(e==null||e._reactInternals===void 0)throw Error(B(38));return Rl(e,t,n,!1,r)};qt.version="18.3.1-next-f1338f8080-20240426";function Ap(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ap)}catch(e){console.error(e)}}Ap(),Th.exports=qt;var Xv=Th.exports,Lp,Yd=Xv;Lp=Yd.createRoot,Yd.hydrateRoot;const Jv="http://localhost:3000";let Tc=localStorage.getItem("token");function fr(e){Tc=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}async function Qa(e,t={}){const n={"Content-Type":"application/json",...t.headers||{}};if(Tc&&(n.Authorization=`Bearer ${Tc}`),typeof window<"u"&&navigator&&navigator.onLine===!1)throw new Error("offline");let r;try{r=await fetch(`${Jv}${e}`,{...t,headers:n})}catch(a){throw typeof window<"u"&&navigator&&navigator.onLine===!1?new Error("offline"):a instanceof TypeError?new Error("network_error"):a}if(!r.ok){const i=(await r.json().catch(()=>({}))).error||"request_failed";throw new Error(i)}return r.json()}function pe(e){return Qa(e,{method:"GET"})}function Ne(e,t){return Qa(e,{method:"POST",body:JSON.stringify(t||{})})}function Xe(e,t){return Qa(e,{method:"PATCH",body:JSON.stringify(t||{})})}function ml(e,t){return Qa(e,{method:"PUT",body:JSON.stringify(t||{})})}function kn(e){return Qa(e,{method:"DELETE"})}const An=Object.create(null);An.open="0";An.close="1";An.ping="2";An.pong="3";An.message="4";An.upgrade="5";An.noop="6";const Ui=Object.create(null);Object.keys(An).forEach(e=>{Ui[An[e]]=e});const Ac={type:"error",data:"parser error"},Rp=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Op=typeof ArrayBuffer=="function",Pp=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Lu=({type:e,data:t},n,r)=>Rp&&t instanceof Blob?n?r(t):Kd(t,r):Op&&(t instanceof ArrayBuffer||Pp(t))?n?r(t):Kd(new Blob([t]),r):r(An[e]+(t||"")),Kd=(e,t)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];t("b"+(r||""))},n.readAsDataURL(e)};function Xd(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Ao;function Zv(e,t){if(Rp&&e.data instanceof Blob)return e.data.arrayBuffer().then(Xd).then(t);if(Op&&(e.data instanceof ArrayBuffer||Pp(e.data)))return t(Xd(e.data));Lu(e,!1,n=>{Ao||(Ao=new TextEncoder),t(Ao.encode(n))})}const Jd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ma=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<Jd.length;e++)ma[Jd.charCodeAt(e)]=e;const ex=e=>{let t=e.length*.75,n=e.length,r,a=0,i,l,c,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const m=new ArrayBuffer(t),N=new Uint8Array(m);for(r=0;r<n;r+=4)i=ma[e.charCodeAt(r)],l=ma[e.charCodeAt(r+1)],c=ma[e.charCodeAt(r+2)],u=ma[e.charCodeAt(r+3)],N[a++]=i<<2|l>>4,N[a++]=(l&15)<<4|c>>2,N[a++]=(c&3)<<6|u&63;return m},tx=typeof ArrayBuffer=="function",Ru=(e,t)=>{if(typeof e!="string")return{type:"message",data:Mp(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:nx(e.substring(1),t)}:Ui[n]?e.length>1?{type:Ui[n],data:e.substring(1)}:{type:Ui[n]}:Ac},nx=(e,t)=>{if(tx){const n=ex(e);return Mp(n,t)}else return{base64:!0,data:e}},Mp=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Dp="",sx=(e,t)=>{const n=e.length,r=new Array(n);let a=0;e.forEach((i,l)=>{Lu(i,!1,c=>{r[l]=c,++a===n&&t(r.join(Dp))})})},rx=(e,t)=>{const n=e.split(Dp),r=[];for(let a=0;a<n.length;a++){const i=Ru(n[a],t);if(r.push(i),i.type==="error")break}return r};function ax(){return new TransformStream({transform(e,t){Zv(e,n=>{const r=n.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const i=new DataView(a.buffer);i.setUint8(0,126),i.setUint16(1,r)}else{a=new Uint8Array(9);const i=new DataView(a.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(a[0]|=128),t.enqueue(a),t.enqueue(n)})}})}let Lo;function ki(e){return e.reduce((t,n)=>t+n.length,0)}function bi(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let a=0;a<t;a++)n[a]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function ix(e,t){Lo||(Lo=new TextDecoder);const n=[];let r=0,a=-1,i=!1;return new TransformStream({transform(l,c){for(n.push(l);;){if(r===0){if(ki(n)<1)break;const u=bi(n,1);i=(u[0]&128)===128,a=u[0]&127,a<126?r=3:a===126?r=1:r=2}else if(r===1){if(ki(n)<2)break;const u=bi(n,2);a=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),r=3}else if(r===2){if(ki(n)<8)break;const u=bi(n,8),m=new DataView(u.buffer,u.byteOffset,u.length),N=m.getUint32(0);if(N>Math.pow(2,21)-1){c.enqueue(Ac);break}a=N*Math.pow(2,32)+m.getUint32(4),r=3}else{if(ki(n)<a)break;const u=bi(n,a);c.enqueue(Ru(i?u:Lo.decode(u),t)),r=0}if(a===0||a>e){c.enqueue(Ac);break}}}})}const Ip=4;function Ze(e){if(e)return lx(e)}function lx(e){for(var t in Ze.prototype)e[t]=Ze.prototype[t];return e}Ze.prototype.on=Ze.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Ze.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};Ze.prototype.off=Ze.prototype.removeListener=Ze.prototype.removeAllListeners=Ze.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,a=0;a<n.length;a++)if(r=n[a],r===t||r.fn===t){n.splice(a,1);break}return n.length===0&&delete this._callbacks["$"+e],this};Ze.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,a=n.length;r<a;++r)n[r].apply(this,t)}return this};Ze.prototype.emitReserved=Ze.prototype.emit;Ze.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Ze.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Ol=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),tn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),ox="arraybuffer";function Bp(e,...t){return t.reduce((n,r)=>(e.hasOwnProperty(r)&&(n[r]=e[r]),n),{})}const cx=tn.setTimeout,ux=tn.clearTimeout;function Pl(e,t){t.useNativeTimers?(e.setTimeoutFn=cx.bind(tn),e.clearTimeoutFn=ux.bind(tn)):(e.setTimeoutFn=tn.setTimeout.bind(tn),e.clearTimeoutFn=tn.clearTimeout.bind(tn))}const dx=1.33;function hx(e){return typeof e=="string"?fx(e):Math.ceil((e.byteLength||e.size)*dx)}function fx(e){let t=0,n=0;for(let r=0,a=e.length;r<a;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function zp(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function px(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function mx(e){let t={},n=e.split("&");for(let r=0,a=n.length;r<a;r++){let i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class gx extends Error{constructor(t,n,r){super(t),this.description=n,this.context=r,this.type="TransportError"}}class Ou extends Ze{constructor(t){super(),this.writable=!1,Pl(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,r){return super.emitReserved("error",new gx(t,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=Ru(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=px(t);return n.length?"?"+n:""}}class vx extends Ou{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};rx(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,sx(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=zp()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let $p=!1;try{$p=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const xx=$p;function yx(){}class jx extends vx{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,n){const r=this.request({method:"POST",data:t});r.on("success",n),r.on("error",(a,i)=>{this.onError("xhr post error",a,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=t}}class Tn extends Ze{constructor(t,n,r){super(),this.createRequest=t,Pl(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const n=Bp(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&r.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var a;r.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=Tn.requestsCount++,Tn.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=yx,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Tn.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Tn.requestsCount=0;Tn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Zd);else if(typeof addEventListener=="function"){const e="onpagehide"in tn?"pagehide":"unload";addEventListener(e,Zd,!1)}}function Zd(){for(let e in Tn.requests)Tn.requests.hasOwnProperty(e)&&Tn.requests[e].abort()}const Nx=function(){const e=Up({xdomain:!1});return e&&e.responseType!==null}();class wx extends jx{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=Nx&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Tn(Up,this.uri(),t)}}function Up(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||xx))return new XMLHttpRequest}catch{}if(!t)try{return new tn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Vp=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class _x extends Ou{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,r=Vp?{}:Bp(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,r)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;Lu(r,this.supportsBinary,i=>{try{this.doWrite(r,i)}catch{}a&&Ol(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=zp()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const Ro=tn.WebSocket||tn.MozWebSocket;class Sx extends _x{createSocket(t,n,r){return Vp?new Ro(t,n,r):n?new Ro(t,n):new Ro(t)}doWrite(t,n){this.ws.send(n)}}class kx extends Ou{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=ix(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),a=ax();a.readable.pipeTo(t.writable),this._writer=a.writable.getWriter();const i=()=>{r.read().then(({done:c,value:u})=>{c||(this.onPacket(u),i())}).catch(c=>{})};i();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;this._writer.write(r).then(()=>{a&&Ol(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const bx={websocket:Sx,webtransport:kx,polling:wx},Cx=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ex=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Lc(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");n!=-1&&r!=-1&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let a=Cx.exec(e||""),i={},l=14;for(;l--;)i[Ex[l]]=a[l]||"";return n!=-1&&r!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=Tx(i,i.path),i.queryKey=Ax(i,i.query),i}function Tx(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function Ax(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,a,i){a&&(n[a]=i)}),n}const Rc=typeof addEventListener=="function"&&typeof removeEventListener=="function",Vi=[];Rc&&addEventListener("offline",()=>{Vi.forEach(e=>e())},!1);class Es extends Ze{constructor(t,n){if(super(),this.binaryType=ox,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const r=Lc(t);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=Lc(n.host).host);Pl(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const a=r.prototype.name;this.transports.push(a),this._transportsByName[a]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=mx(this.opts.query)),Rc&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Vi.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=Ip,n.transport=t,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Es.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Es.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const a=this.writeBuffer[r].data;if(a&&(n+=hx(a)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Ol(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,r){return this._sendPacket("message",t,n,r),this}send(t,n,r){return this._sendPacket("message",t,n,r),this}_sendPacket(t,n,r,a){if(typeof n=="function"&&(a=n,n=void 0),typeof r=="function"&&(a=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:t,data:n,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(Es.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Rc&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=Vi.indexOf(this._offlineEventListener);r!==-1&&Vi.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}Es.protocol=Ip;class Lx extends Es{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),r=!1;Es.priorWebsocketSuccess=!1;const a=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",v=>{if(!r)if(v.type==="pong"&&v.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Es.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(N(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const x=new Error("probe error");x.transport=n.name,this.emitReserved("upgradeError",x)}}))};function i(){r||(r=!0,N(),n.close(),n=null)}const l=v=>{const x=new Error("probe error: "+v);x.transport=n.name,i(),this.emitReserved("upgradeError",x)};function c(){l("transport closed")}function u(){l("socket closed")}function m(v){n&&v.name!==n.name&&i()}const N=()=>{n.removeListener("open",a),n.removeListener("error",l),n.removeListener("close",c),this.off("close",u),this.off("upgrading",m)};n.once("open",a),n.once("error",l),n.once("close",c),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}let Rx=class extends Lx{constructor(t,n={}){const r=typeof t=="object"?t:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(a=>bx[a]).filter(a=>!!a)),super(t,r)}};function Ox(e,t="",n){let r=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),r=Lc(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}const Px=typeof ArrayBuffer=="function",Mx=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Fp=Object.prototype.toString,Dx=typeof Blob=="function"||typeof Blob<"u"&&Fp.call(Blob)==="[object BlobConstructor]",Ix=typeof File=="function"||typeof File<"u"&&Fp.call(File)==="[object FileConstructor]";function Pu(e){return Px&&(e instanceof ArrayBuffer||Mx(e))||Dx&&e instanceof Blob||Ix&&e instanceof File}function Fi(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(Fi(e[n]))return!0;return!1}if(Pu(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Fi(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&Fi(e[n]))return!0;return!1}function Bx(e){const t=[],n=e.data,r=e;return r.data=Oc(n,t),r.attachments=t.length,{packet:r,buffers:t}}function Oc(e,t){if(!e)return e;if(Pu(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=Oc(e[r],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=Oc(e[r],t));return n}return e}function zx(e,t){return e.data=Pc(e.data,t),delete e.attachments,e}function Pc(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=Pc(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Pc(e[n],t));return e}const Wp=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],$x=5;var he;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(he||(he={}));class Ux{constructor(t){this.replacer=t}encode(t){return(t.type===he.EVENT||t.type===he.ACK)&&Fi(t)?this.encodeAsBinary({type:t.type===he.EVENT?he.BINARY_EVENT:he.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===he.BINARY_EVENT||t.type===he.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=Bx(t),r=this.encodeAsString(n.packet),a=n.buffers;return a.unshift(r),a}}class Mu extends Ze{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const r=n.type===he.BINARY_EVENT;r||n.type===he.BINARY_ACK?(n.type=r?he.EVENT:he.ACK,this.reconstructor=new Vx(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(Pu(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const r={type:Number(t.charAt(0))};if(he[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===he.BINARY_EVENT||r.type===he.BINARY_ACK){const i=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const l=t.substring(i,n);if(l!=Number(l)||t.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(l)}if(t.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););r.nsp=t.substring(i,n)}else r.nsp="/";const a=t.charAt(n+1);if(a!==""&&Number(a)==a){const i=n+1;for(;++n;){const l=t.charAt(n);if(l==null||Number(l)!=l){--n;break}if(n===t.length)break}r.id=Number(t.substring(i,n+1))}if(t.charAt(++n)){const i=this.tryParse(t.substr(n));if(Mu.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case he.CONNECT:return gl(n);case he.DISCONNECT:return n===void 0;case he.CONNECT_ERROR:return typeof n=="string"||gl(n);case he.EVENT:case he.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&Wp.indexOf(n[0])===-1);case he.ACK:case he.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Vx{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=zx(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Fx(e){return typeof e=="string"}const Wx=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};function Hx(e){return e===void 0||Wx(e)}function gl(e){return Object.prototype.toString.call(e)==="[object Object]"}function qx(e,t){switch(e){case he.CONNECT:return t===void 0||gl(t);case he.DISCONNECT:return t===void 0;case he.EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Wp.indexOf(t[0])===-1);case he.ACK:return Array.isArray(t);case he.CONNECT_ERROR:return typeof t=="string"||gl(t);default:return!1}}function Gx(e){return Fx(e.nsp)&&Hx(e.id)&&qx(e.type,e.data)}const Qx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Mu,Encoder:Ux,get PacketType(){return he},isPacketValid:Gx,protocol:$x},Symbol.toStringTag,{value:"Module"}));function fn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Yx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Hp extends Ze{constructor(t,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[fn(t,"open",this.onopen.bind(this)),fn(t,"packet",this.onpacket.bind(this)),fn(t,"error",this.onerror.bind(this)),fn(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var r,a,i;if(Yx.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const l={type:he.EVENT,data:n};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const N=this.ids++,v=n.pop();this._registerAckCallback(N,v),l.id=N}const c=(a=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||a===void 0?void 0:a.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!c||(u?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(t,n){var r;const a=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(a===void 0){this.acks[t]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===t&&this.sendBuffer.splice(c,1);n.call(this,new Error("operation has timed out"))},a),l=(...c)=>{this.io.clearTimeoutFn(i),n.apply(this,c)};l.withError=!0,this.acks[t]=l}emitWithAck(t,...n){return new Promise((r,a)=>{const i=(l,c)=>l?a(l):r(c);i.withError=!0,n.push(i),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((a,...i)=>(this._queue[0],a!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(a)):(this._queue.shift(),n&&n(null,...i)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:he.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case he.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case he.EVENT:case he.BINARY_EVENT:this.onevent(t);break;case he.ACK:case he.BINARY_ACK:this.onack(t);break;case he.DISCONNECT:this.ondisconnect();break;case he.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let r=!1;return function(...a){r||(r=!0,n.packet({type:he.ACK,id:t,data:a}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:he.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,t.data)}}}function Vr(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Vr.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};Vr.prototype.reset=function(){this.attempts=0};Vr.prototype.setMin=function(e){this.ms=e};Vr.prototype.setMax=function(e){this.max=e};Vr.prototype.setJitter=function(e){this.jitter=e};class Mc extends Ze{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,Pl(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Vr({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const a=n.parser||Qx;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Rx(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const a=fn(n,"open",function(){r.onopen(),t&&t()}),i=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),t?t(c):this.maybeReconnectOnOpen()},l=fn(n,"error",i);if(this._timeout!==!1){const c=this._timeout,u=this.setTimeoutFn(()=>{a(),i(new Error("timeout")),n.close()},c);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(a),this.subs.push(l),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(fn(t,"ping",this.onping.bind(this)),fn(t,"data",this.ondata.bind(this)),fn(t,"error",this.onerror.bind(this)),fn(t,"close",this.onclose.bind(this)),fn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){Ol(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new Hp(this,t,n),this.nsps[t]=r),r}_destroy(t){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let r=0;r<n.length;r++)this.engine.write(n[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(a=>{a?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",a)):t.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const ua={};function Wi(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=Ox(e,t.path||"/socket.io"),r=n.source,a=n.id,i=n.path,l=ua[a]&&i in ua[a].nsps,c=t.forceNew||t["force new connection"]||t.multiplex===!1||l;let u;return c?u=new Mc(r,t):(ua[a]||(ua[a]=new Mc(r,t)),u=ua[a]),n.query&&!t.query&&(t.query=n.queryKey),u.socket(n.path,t)}Object.assign(Wi,{Manager:Mc,Socket:Hp,io:Wi,connect:Wi});const Kx="http://localhost:3000";function Xx(e){return Wi(Kx,{auth:{token:e}})}const qp=f.createContext(null);function Jx({children:e}){const[t,n]=f.useState([]),r=f.useRef(new Map),a=c=>{n(m=>m.filter(N=>N.id!==c));const u=r.current.get(c);u&&(clearTimeout(u),r.current.delete(c))},i=({message:c,type:u="success",actionLabel:m,onAction:N,duration:v=6e3})=>{const x=`${Date.now()}-${Math.random().toString(36).slice(2,8)}`;if(n(C=>[...C,{id:x,message:c,type:u,actionLabel:m,onAction:N,duration:v}]),v>0){const C=setTimeout(()=>a(x),v);r.current.set(x,C)}return x},l=c=>c==="error"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 4.5c.5 0 .95.26 1.2.68l6.5 11.25a1.35 1.35 0 0 1-1.2 2.02H5.5a1.35 1.35 0 0 1-1.2-2.02L10.8 5.18c.25-.42.7-.68 1.2-.68Zm0 4.25a.9.9 0 0 0-.9.9v5.5a.9.9 0 1 0 1.8 0v-5.5a.9.9 0 0 0-.9-.9Zm0 8.3a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Z",fill:"currentColor"})}):c==="info"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 3.5a8.5 8.5 0 1 1 0 17 8.5 8.5 0 0 1 0-17Zm0 3.9a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Zm-1.2 4.2h2.4v6.1h-2.4v-6.1Z",fill:"currentColor"})}):s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M9.5 16.6 5.6 12.7a1 1 0 1 1 1.4-1.4l2.5 2.5 7.5-7.5a1 1 0 1 1 1.4 1.4l-8.9 8.9a1 1 0 0 1-1.4 0Z",fill:"currentColor"})});return s.jsxs(qp.Provider,{value:{pushToast:i,removeToast:a},children:[e,s.jsx("div",{className:"toast-container",children:t.map(c=>s.jsxs("div",{className:`toast toast-${c.type}`,style:{"--toast-duration":`${c.duration}ms`},children:[s.jsx("div",{className:"toast-icon",children:l(c.type)}),s.jsx("div",{className:"toast-message",children:c.message}),c.actionLabel&&s.jsx("button",{className:"toast-action",type:"button",onClick:()=>{c.onAction&&Promise.resolve(c.onAction()).catch(()=>{}),a(c.id)},children:c.actionLabel}),s.jsx("button",{className:"toast-close",type:"button",onClick:()=>a(c.id),children:"x"}),c.duration>0&&s.jsx("div",{className:`toast-progress toast-progress-${c.type}`})]},c.id))})]})}function Du(){const e=f.useContext(qp);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function Zx({user:e,isOpen:t,onToggle:n,onLogout:r,onReturnToSuperadmin:a,showReturnToSuperadmin:i,getInitial:l}){return s.jsxs("div",{className:"rail-profile",children:[s.jsx("button",{className:`profile-button ${t?"active":""}`,type:"button",onClick:n,title:"Perfil","aria-label":"Perfil",children:s.jsx("span",{children:l(e.name)})}),t&&s.jsxs("div",{className:"profile-card",children:[s.jsx("div",{className:"profile-title",children:e.name}),s.jsx("div",{className:"profile-meta",children:e.email||"Sin correo"}),s.jsx("div",{className:"profile-role",children:e.role}),i?s.jsx("button",{className:"ghost",type:"button",onClick:a,children:"Volver a superadmin"}):null,s.jsx("button",{className:"primary",type:"button",onClick:r,children:"Salir"})]})]})}function ey({navItems:e,view:t,onSetView:n,theme:r,onToggleTheme:a,user:i,logoUrl:l,brandName:c,isProfileOpen:u,onToggleProfile:m,onLogout:N,onReturnToSuperadmin:v,showReturnToSuperadmin:x,getInitial:C,SunIcon:L,MoonIcon:R}){const g=(c||"P").trim().charAt(0)||"P";return s.jsxs("aside",{className:"nav-rail",children:[s.jsx("button",{className:"rail-logo",type:"button",title:c||"Logo",children:l?s.jsx("img",{src:l,alt:c||"Logo"}):s.jsx("span",{className:"logo-mark",children:g})}),s.jsx("nav",{className:"rail-nav",children:e.map(h=>{const p=h.icon;return s.jsx("button",{className:`rail-button ${t===h.id?"active":""}`,onClick:()=>h.enabled&&n(h.id),title:h.label,"aria-label":h.label,type:"button",disabled:!h.enabled,children:s.jsx(p,{className:"rail-icon"})},h.id)})}),s.jsx("div",{className:"rail-spacer"}),s.jsx("button",{className:"rail-button",type:"button",onClick:a,title:r==="dark"?"Tema claro":"Tema oscuro","aria-label":r==="dark"?"Tema claro":"Tema oscuro",children:r==="dark"?s.jsx(L,{className:"rail-icon"}):s.jsx(R,{className:"rail-icon"})}),s.jsx(Zx,{user:i,isOpen:u,onToggle:m,onLogout:N,onReturnToSuperadmin:v,showReturnToSuperadmin:x,getInitial:C})]})}function ty({activeConversation:e,conversations:t,channels:n,brandName:r,lastReadMap:a,filters:i,showFilters:l,users:c,tags:u,statusOptions:m,statusLabels:N,formatListTime:v,messageBlocks:x,messageDraft:C,messageMode:L,quickActions:R,tagInput:g,noteInput:h,notesList:p,latestNote:y,loadingConversation:k,isInfoOpen:D,hasUnread:z,scrollDayLabel:I,activeName:_,activePhone:P,activeStatusLabel:M,canManageStatus:K,currentUser:ue,messageInputRef:fe,chatBodyRef:He,setShowFilters:_e,setFilters:Le,loadConversation:at,handleBackToList:F,setIsInfoOpen:G,handleChatScroll:te,handleAssignSelf:se,handleStatusChange:de,handleToggleTag:be,handleAddTag:T,setNoteInput:H,handleAddNote:b,reassignUserId:$,setReassignUserId:q,handleReassignConversation:ie,handleOpenTagManager:ce,handleCloseTagManager:ge,showTagManager:Ke,tagManagerForm:ct,setTagManagerForm:et,handleCreateTag:ve,handleDeleteTag:vt,handleQuickAction:tt,handleSendMessage:xt,setMessageMode:Ge,setMessageDraft:ze,scrollChatToBottom:Qe,getInitial:yt,PlusIcon:ut,SearchIcon:je,VideoIcon:Yn,PhoneIcon:$e,InfoIcon:ln,SendIcon:De}){const W=new Map((n||[]).map(A=>[A.phone_number_id,A.display_name||(A.phone_number_id?`Linea ${String(A.phone_number_id).slice(-4)}`:"")])),we=(e==null?void 0:e.assigned_user_id)&&e.assigned_user_id!==(ue==null?void 0:ue.id);function Ae(A){if(!A)return"Sin mensajes";const Se=A.last_message_preview||A.last_message_text||A.last_message||"";return Se||(A.last_message_type?`[${A.last_message_type}]`:"Sin mensajes")}return s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:`chat-shell ${e?"has-active":""}`,children:[s.jsxs("aside",{className:"chat-list-panel",children:[s.jsxs("div",{className:"chat-list-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"list-title",children:(r||"Perzivalh").toUpperCase()}),s.jsx("div",{className:"list-subtitle",children:"Chats"})]}),s.jsx("button",{className:"icon-button add-chat",type:"button",title:"Nuevo chat",children:s.jsx(ut,{className:"icon"})})]}),s.jsxs("div",{className:"chat-search",children:[s.jsx(je,{className:"search-icon"}),s.jsx("input",{type:"text",placeholder:"Buscar pacientes o mensajes",value:i.search,onFocus:()=>_e(!0),onClick:()=>_e(!0),onChange:A=>Le(Se=>({...Se,search:A.target.value}))}),l&&s.jsx("button",{className:"search-close",type:"button",onClick:()=>_e(!1),"aria-label":"Cerrar filtros",children:"x"})]}),l&&s.jsxs("div",{className:"chat-filters",children:[s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Status"}),s.jsxs("select",{value:i.status,onChange:A=>Le(Se=>({...Se,status:A.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),m.map(A=>s.jsx("option",{value:A,children:N[A]||A},A))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Asignado"}),s.jsxs("select",{value:i.assigned_user_id,onChange:A=>Le(Se=>({...Se,assigned_user_id:A.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"unassigned",children:"Sin asignar"}),c.map(A=>s.jsx("option",{value:A.id,children:A.name},A.id))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Tags"}),s.jsxs("select",{value:i.tag,onChange:A=>Le(Se=>({...Se,tag:A.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),u.map(A=>s.jsx("option",{value:A.name,children:A.name},A.id))]})]})]}),s.jsxs("div",{className:"list-header",children:[s.jsxs("select",{className:"line-filter",value:i.phone_number_id,onChange:A=>Le(Se=>({...Se,phone_number_id:A.target.value})),children:[s.jsx("option",{value:"",children:"Todas las lineas"}),(n||[]).map(A=>s.jsx("option",{value:A.phone_number_id,children:A.display_name||`Linea ${String(A.phone_number_id).slice(-4)}`},A.id))]}),s.jsx("span",{children:t.length})]}),s.jsx("div",{className:"conversation-list",children:t.map((A,Se)=>{var ye,Qt,Ue;const xn=(e==null?void 0:e.id)===A.id,Ln=A.status==="pending"&&!A.assigned_user_id,Rn=A.display_name||A.phone_e164||A.wa_id||"Sin nombre",yn=Ae(A),On=Number(A.unread_count||A.unread_messages||A.unread||0),jn=((Qt=(ye=A.tags)==null?void 0:ye[0])==null?void 0:Qt.name)||"",on=(Ue=A.assigned_user)!=null&&Ue.name?`Tomada por ${A.assigned_user.name}`:"",S=A.phone_number_id?W.get(A.phone_number_id)||`Linea ${String(A.phone_number_id).slice(-4)}`:"",U=(a==null?void 0:a[A.id])||null,Q=A.last_message_at,re=Q&&(!U||new Date(Q).getTime()>new Date(U).getTime())&&A.last_message_direction==="in";return s.jsxs("button",{className:`conversation-item ${xn?"active":""}`,onClick:()=>at(A.id),style:{animationDelay:`${Math.min(Se,6)*60}ms`},children:[s.jsxs("div",{className:"avatar",children:[s.jsx("span",{children:yt(Rn)}),Ln&&s.jsx("span",{className:"presence-dot"})]}),s.jsxs("div",{className:"conversation-body",children:[s.jsxs("div",{className:"conversation-row",children:[s.jsx("span",{className:"conversation-name",children:Rn}),s.jsxs("div",{className:"conversation-right",children:[s.jsx("span",{className:"conversation-time",children:v(A.last_message_at)}),On>0&&s.jsx("span",{className:"conversation-unread",children:On})]})]}),s.jsx("div",{className:`conversation-preview ${re?"unread":""}`,children:yn}),s.jsxs("div",{className:"conversation-meta",children:[S&&s.jsx("span",{className:"status-pill line-pill",children:S}),on&&s.jsx("span",{className:"status-pill assignee-pill",children:on}),jn&&s.jsx("span",{className:"status-pill tag-pill",children:jn})]})]})]},A.id)})})]}),s.jsxs("div",{className:`chat-view ${D?"info-open":"info-closed"}`,children:[s.jsx("div",{className:"chat-main",children:s.jsxs("div",{className:"chat-card",children:[s.jsxs("header",{className:"chat-topbar",children:[s.jsxs("div",{className:"chat-title",children:[e&&s.jsx("button",{className:"back-button",type:"button",onClick:F,children:"Chats"}),s.jsx("div",{className:"chat-avatar",children:s.jsx("span",{children:yt(_)})}),s.jsxs("div",{children:[s.jsx("div",{className:"chat-name",children:_}),e?s.jsx("div",{className:"chat-status",children:M}):s.jsx("div",{className:"chat-status muted",children:"Elige una conversacion"})]})]}),s.jsxs("div",{className:"chat-actions",children:[s.jsx("button",{className:"icon-button",type:"button",title:"Video",children:s.jsx(Yn,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Llamar",children:s.jsx($e,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Buscar",children:s.jsx(je,{className:"icon"})}),s.jsx("button",{className:`icon-button ${D?"active":""}`,type:"button",title:"Info",onClick:()=>G(A=>!A),children:s.jsx(ln,{className:"icon"})})]})]}),s.jsxs("div",{className:"chat-body",ref:He,onScroll:te,children:[I&&s.jsx("div",{className:"chat-day-sticky","aria-hidden":"true",children:I}),k&&s.jsx("div",{className:"empty",children:"Cargando..."}),!k&&!e&&s.jsx("div",{className:"empty",children:"Selecciona una conversacion"}),!k&&e&&s.jsx(s.Fragment,{children:x.length?x:s.jsx("div",{className:"empty-state",children:"Sin mensajes"})})]}),z&&s.jsx("button",{className:"new-message-banner",type:"button",onClick:Qe,children:"Nuevos mensajes"}),s.jsxs("form",{className:"chat-composer",onSubmit:xt,children:[we&&s.jsx("div",{className:"assign-warning",children:"Conversacion tomada por otro operador."}),R.length>0&&s.jsx("div",{className:"quick-actions",children:R.map(A=>s.jsx("button",{className:"quick-action",type:"button",onClick:()=>tt(A),disabled:we,children:A},A))}),s.jsxs("div",{className:"composer-row",children:[s.jsxs("select",{className:"message-mode",value:L,onChange:A=>Ge(A.target.value),disabled:we,children:[s.jsx("option",{value:"text",children:"WhatsApp"}),s.jsx("option",{value:"note",children:"Nota interna"})]}),s.jsx("input",{ref:fe,type:"text",placeholder:"Escribe un mensaje...",value:C,onChange:A=>ze(A.target.value),disabled:we}),s.jsx("button",{className:"send-button",type:"submit",disabled:we,children:s.jsx(De,{className:"icon"})})]})]})]})}),s.jsxs("aside",{className:"chat-info",children:[s.jsxs("div",{className:"info-card",children:[s.jsx("div",{className:"info-avatar",children:s.jsx("span",{children:yt(_)})}),s.jsx("div",{className:"info-name",children:_}),s.jsx("div",{className:"info-phone",children:P||"Sin telefono"})]}),s.jsxs("div",{className:"info-section",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("div",{className:"section-title",children:"Etiquetas"}),s.jsx("button",{className:"link-button",type:"button",onClick:ce,children:"Gestionar"})]}),s.jsx("div",{className:"tag-list",children:((e==null?void 0:e.tags)||[]).length?e.tags.map(A=>s.jsxs("span",{className:"tag-chip",children:[s.jsx("span",{className:"tag-chip-label",children:A.name}),s.jsx("button",{className:"tag-remove",type:"button",title:"Quitar etiqueta",onClick:()=>be(A.name),children:"x"})]},A.name)):s.jsx("div",{className:"empty-state",children:"Sin etiquetas"})}),s.jsxs("form",{className:"tag-form",onSubmit:T,children:[s.jsxs("select",{value:g,onChange:A=>setTagInput(A.target.value),children:[s.jsx("option",{value:"",children:"Selecciona etiqueta..."}),u.filter(A=>!((e==null?void 0:e.tags)||[]).some(Se=>Se.name===A.name)).map(A=>s.jsx("option",{value:A.name,children:A.name},A.id))]}),s.jsx("button",{className:"icon-button",type:"submit",title:"Agregar",children:s.jsx(ut,{className:"icon"})})]})]}),s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Notas internas"}),p!=null&&p.length?s.jsx("div",{className:"notes-stack",children:p.slice(-5).map(A=>s.jsx("div",{className:"note-card",children:A.text},A.id))}):s.jsx("div",{className:"empty-state",children:"Sin notas internas"}),s.jsxs("form",{className:"note-form",onSubmit:b,children:[s.jsx("input",{type:"text",placeholder:"Agregar nota interna...",value:h,onChange:A=>H(A.target.value),disabled:!e}),s.jsx("button",{className:"icon-button",type:"submit",title:"Guardar nota",children:s.jsx(ut,{className:"icon"})})]})]}),e&&s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Acciones"}),s.jsxs("div",{className:"action-stack",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:se,disabled:we,children:"Tomar conversacion"}),K&&s.jsxs("div",{className:"reassign-card",children:[s.jsxs("select",{value:$,onChange:A=>q(A.target.value),children:[s.jsx("option",{value:"",children:"Reasignar a..."}),c.map(A=>s.jsx("option",{value:A.id,children:A.name},A.id))]}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:ie,disabled:!$,children:"Reasignar"})]}),K&&s.jsxs("div",{className:"action-row",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>de("open"),children:"Reactivar bot"}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>de("pending"),children:"Liberar para otro operador"})]})]})]})]})]})]}),Ke&&s.jsx("div",{className:"modal-overlay",onClick:ge,children:s.jsxs("div",{className:"modal-card",onClick:A=>A.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Gestion de etiquetas"}),s.jsx("button",{className:"modal-close",type:"button",onClick:ge,children:"x"})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("form",{className:"tag-manager-form",onSubmit:ve,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:ct.name,onChange:A=>et(Se=>({...Se,name:A.target.value})),placeholder:"Nombre de etiqueta"})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Color"}),s.jsx("input",{type:"color",value:ct.color,onChange:A=>et(Se=>({...Se,color:A.target.value}))})]}),s.jsx("div",{className:"modal-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Crear etiqueta"})})]}),s.jsx("div",{className:"tag-manager-list",children:(u||[]).map(A=>s.jsxs("div",{className:"tag-manager-row",children:[s.jsx("span",{className:"tag-chip",style:{borderColor:A.color||"#cbd5f5"},children:s.jsx("span",{className:"tag-chip-label",children:A.name})}),s.jsx("div",{className:"tag-manager-actions",children:s.jsx("button",{className:"danger soft",type:"button",onClick:()=>vt(A.id,A.name),children:"Eliminar"})})]},A.id))})]})]})})]})}const ny=[{day:"2024-01-01",in_count:210,out_count:90},{day:"2024-01-04",in_count:280,out_count:120},{day:"2024-01-07",in_count:240,out_count:110},{day:"2024-01-10",in_count:320,out_count:140},{day:"2024-01-13",in_count:300,out_count:130},{day:"2024-01-17",in_count:310,out_count:135},{day:"2024-01-20",in_count:290,out_count:120},{day:"2024-01-24",in_count:260,out_count:115},{day:"2024-01-27",in_count:330,out_count:150},{day:"2024-01-30",in_count:340,out_count:160}];function sy(e){const t=e?new Date(e):null;if(!t||Number.isNaN(t.getTime()))return"--";const n=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];return`${String(t.getDate()).padStart(2,"0")} ${n[t.getMonth()].toUpperCase()}`}function eh(e){return e.length?e.map((t,n)=>`${n===0?"M":"L"}${t.x} ${t.y}`).join(" "):""}function ry({statusCounts:e,metrics:t,onRefresh:n,brandName:r}){var _;const a=(r||"Empresa").trim(),i=a?`${a} Enterprise`:"Enterprise",l=(e.open||0)+(e.pending||0),c=t!=null&&t.avg_first_reply_seconds?Number(t.avg_first_reply_seconds)/60:null,u=c?`${c.toFixed(1)}m`:"-",m=(t==null?void 0:t.conversion_rate)??(t==null?void 0:t.conversion_rate_percent)??null,v=`${(m==null?18.4:m>1?m:m*100).toFixed(1)}%`,x=((_=t==null?void 0:t.message_volume)==null?void 0:_.length)>0?t.message_volume.slice(-10):ny,C=Math.max(...x.map(P=>P.in_count+P.out_count),1),L=x.length*42+30,R=220,g=150,h=180,p=x.map((P,M)=>{const ue=(P.in_count+P.out_count)/C*g,fe=P.in_count/C*g,He=P.out_count/C*g;return{x:22+M*42,totalHeight:ue,inHeight:fe,outHeight:He}}),y=eh(p.map((P,M)=>({x:P.x+10,y:h-P.inHeight}))),k=eh(p.map(P=>({x:P.x+10,y:h-P.outHeight}))),D=Array.from(new Set([0,Math.floor(x.length/3),Math.floor(2*x.length/3),x.length-1])),z=Math.round((t==null?void 0:t.team_efficiency)||94),I=((t==null?void 0:t.top_tags)||[]).slice(0,3);return s.jsxs("section",{className:"dashboard-layout",children:[s.jsxs("div",{className:"dashboard-main",children:[s.jsxs("header",{className:"dashboard-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dashboard-kicker",children:i}),s.jsx("h2",{className:"dashboard-title",children:"Dashboard"}),s.jsx("div",{className:"dashboard-subtitle",children:"Marketing Analytics & WhatsApp CRM Overview"})]}),s.jsxs("div",{className:"dashboard-actions",children:[s.jsxs("button",{className:"dash-filter",type:"button",children:[s.jsx("span",{className:"dash-filter-icon","aria-hidden":"true"}),"Ultimos 30 dias"]}),s.jsx("button",{className:"primary",type:"button",onClick:n,children:"Generar Reporte"})]})]}),s.jsxs("div",{className:"dashboard-kpis",children:[s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Conversaciones activas"}),s.jsx("div",{className:"dash-kpi-value",children:l.toLocaleString()})]}),s.jsx("div",{className:"dash-kpi-icon",children:"C"})]}),s.jsx("div",{className:"dash-kpi-change up",children:"+12.5%"})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tiempo de respuesta"}),s.jsx("div",{className:"dash-kpi-value",children:u})]}),s.jsx("div",{className:"dash-kpi-icon",children:"T"})]}),s.jsx("div",{className:"dash-kpi-change down",children:"-0.8m"})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tasa de conversion"}),s.jsx("div",{className:"dash-kpi-value",children:v})]}),s.jsx("div",{className:"dash-kpi-icon",children:"%"})]}),s.jsx("div",{className:"dash-kpi-change up",children:"+2.1%"})]})]}),s.jsxs("div",{className:"dash-card dash-chart-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-card-title",children:"Flujo de Mensajes"}),s.jsx("div",{className:"dash-card-subtitle",children:"Volumen diario"})]}),s.jsxs("div",{className:"dash-legend",children:[s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot in"})," Entrantes"]}),s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot out"})," Salientes"]})]})]}),s.jsx("div",{className:"dash-chart",children:s.jsxs("svg",{className:"dash-chart-svg",viewBox:`0 0 ${L} ${R}`,preserveAspectRatio:"none",children:[s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"60",x2:L,y2:"60"}),s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"120",x2:L,y2:"120"}),p.map((P,M)=>s.jsxs("g",{children:[s.jsx("rect",{className:"dash-bar in",x:P.x,y:h-P.inHeight,width:"20",height:P.inHeight,rx:"6"}),s.jsx("rect",{className:"dash-bar out",x:P.x,y:h-P.inHeight-P.outHeight,width:"20",height:P.outHeight,rx:"6"})]},`bar-${M}`)),s.jsx("path",{className:"dash-line in",d:y}),s.jsx("path",{className:"dash-line out",d:k})]})}),s.jsx("div",{className:"dash-chart-labels",children:D.map(P=>{var M;return s.jsx("span",{children:sy((M=x[P])==null?void 0:M.day)},`label-${P}`)})})]}),s.jsxs("div",{className:"dashboard-lower",children:[s.jsxs("div",{className:"dash-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsx("div",{className:"dash-card-title",children:"Ultimas etiquetas detectadas"}),s.jsx("button",{className:"link-button",type:"button",children:"Ver todo"})]}),s.jsxs("div",{className:"dash-tag-table",children:[s.jsxs("div",{className:"dash-tag-head",children:[s.jsx("span",{children:"Etiqueta"}),s.jsx("span",{children:"Frecuencia"}),s.jsx("span",{children:"Accion"})]}),I.map(P=>s.jsxs("div",{className:"dash-tag-row",children:[s.jsx("span",{className:"dash-tag-chip",children:P.name}),s.jsx("span",{className:"dash-tag-count",children:P.count}),s.jsx("span",{className:"dash-tag-action",children:">"})]},P.name)),!I.length&&s.jsx("div",{className:"empty-state",children:"Sin etiquetas recientes"})]})]}),s.jsxs("div",{className:"dash-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsx("div",{className:"dash-card-title",children:"Actividad de Campana"}),s.jsx("span",{className:"dash-pill",children:"Monitor"})]}),s.jsxs("div",{className:"dash-campaign",children:[s.jsx("div",{className:"dash-campaign-title",children:'Campana de Verano "Pies Sanos"'}),s.jsxs("div",{className:"dash-campaign-meta",children:[s.jsx("span",{className:"dash-pill solid",children:"84% enviado"}),s.jsx("span",{className:"dash-muted",children:"Hace 2 horas"})]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:"84%"}})}),s.jsx("div",{className:"dash-muted",children:"1,240 destinatarios"})]})]})]})]}),s.jsxs("aside",{className:"dashboard-side",children:[s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Performance de Operadores"}),s.jsx("div",{className:"dash-card-subtitle",children:"Top 5 leaderboard - hoy"}),s.jsx("div",{className:"dash-operator-list",children:[{name:"Lucia Fernandez",role:"Especialista CRM",resolved:84,pending:3},{name:"Ricardo Gomez",role:"Atencion Pacientes",resolved:71,pending:8},{name:"Ana Martinez",role:"Soporte Medico",resolved:65,pending:12}].map(P=>s.jsxs("div",{className:"dash-operator",children:[s.jsx("div",{className:"dash-operator-avatar",children:P.name[0]}),s.jsxs("div",{className:"dash-operator-meta",children:[s.jsx("div",{className:"dash-operator-name",children:P.name}),s.jsx("div",{className:"dash-operator-role",children:P.role}),s.jsxs("div",{className:"dash-operator-stats",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Resueltos"}),s.jsx("div",{className:"dash-stat-value",children:P.resolved})]}),s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Pendientes"}),s.jsx("div",{className:"dash-stat-value danger",children:P.pending})]})]})]})]},P.name))})]}),s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Eficiencia de Equipo"}),s.jsxs("div",{className:"dash-efficiency",children:[s.jsxs("div",{className:"dash-efficiency-value",children:[z,"%"]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:`${z}%`}})}),s.jsx("div",{className:"dash-muted",children:"Objetivo diario: 500 conversiones"})]})]})]})]})}const th={draft:"BORRADOR",scheduled:"PROGRAMADA",sending:"ENVIANDO",sent:"FINALIZADA",failed:"ERROR"},Ci={APPROVED:{label:"APROBADA",className:"approved"},PENDING:{label:"PENDIENTE",className:"pending"},REJECTED:{label:"RECHAZADA",className:"rejected"},DRAFT:{label:"BORRADOR",className:"draft"},PAUSED:{label:"PAUSADA",className:"pending"},DISABLED:{label:"DESHABILITADA",className:"draft"}},nh={MARKETING:"MARKETING",UTILITY:"UTILIDAD",AUTHENTICATION:"AUTENTICACION"},Ei=[{id:"audiences",label:"Audiencias",title:"Audiencias",subtitle:"MDULO DE GESTIN Y CAMPAAS"},{id:"templates",label:"Biblioteca de Plantillas",title:"Biblioteca de Plantillas",subtitle:"Consulta y gestiona las plantillas de mensajes autorizadas por WhatsApp."},{id:"new",label:"Campaas",title:"Campaas",subtitle:"Historial de envos y difusin WhatsApp"}],ay={audiencias:"audiences",audiences:"audiences",templates:"templates",plantillas:"templates",biblioteca:"templates",nueva:"new",campaign:"new",campaigns:"new",nueva_campana:"new",history:"new",historial:"new"},sh=[{id:"dynamic",label:"Audiencias Dinmicas",title:"Automatizacin de Audiencias y Tags",subtitle:"Unificacin de flujos de datos Perzivalh CRM",actionLabel:"Guardar Configuracin"},{id:"excel",label:"Importar Excel",title:"Importacin de Contactos Excel",subtitle:"Gestin de base de datos externa Perzivalh CRM",actionLabel:"Iniciar Importacin"},{id:"odoo",label:"Importar de Odoo",title:"Sincronizacin Inteligente Odoo",subtitle:"Automatizacin de audiencias Perzivalh OS",actionLabel:"Actualizar Lista Odoo"}],iy=[{value:"phone",label:"Telfono"},{value:"name",label:"Nombre Completo"},{value:"city",label:"Ciudad"},{value:"tags",label:"Etiquetas"},{value:"ignore",label:"Sin Mapear"}];function ly({campaignForm:e,setCampaignForm:t,campaignFilter:n,setCampaignFilter:r,templates:a,campaigns:i,selectedCampaignId:l,campaignMessages:c,users:u,tags:m,selectedTemplate:N,statusOptions:v,onCreateCampaign:x,onLoadCampaigns:C,onLoadCampaignMessages:L,onSendCampaign:R,onUpdateCampaign:g,onDeleteCampaign:h,onResendCampaign:p,campaignsTotal:y,formatDate:k,brandName:D}){var ii;const z=(D||"Perzivalh").trim(),[I,_]=f.useState(""),[P,M]=f.useState("all"),[K,ue]=f.useState(!1),[fe,He]=f.useState(null),[_e,Le]=f.useState(""),[at,F]=f.useState(!1),[G,te]=f.useState(""),[se,de]=f.useState("all"),[be,T]=f.useState(!1),[H,b]=f.useState(null),[$,q]=f.useState(""),[ie,ce]=f.useState(null),[ge,Ke]=f.useState(null),[ct,et]=f.useState(!1),[ve,vt]=f.useState(!1),[tt,xt]=f.useState({id:"",name:"",phone:"",email:"",vat:""}),[Ge,ze]=f.useState(e.send_now===!1||e.scheduled_for?"schedule":"now"),[Qe,yt]=f.useState(1),[ut]=f.useState(6),{pushToast:je}=Du(),Yn=f.useRef(null),[$e,ln]=f.useState(!1),[De,W]=f.useState("dynamic"),we=f.useMemo(()=>sh.map(o=>({...o,subtitle:o.subtitle.replace(/Perzivalh/g,z)})),[z]),[Ae,A]=f.useState({enabled:!1,phone_number_id:null}),[Se,xn]=f.useState(!1),[Ln,Rn]=f.useState([]),[yn,On]=f.useState(!1),[jn,on]=f.useState(!1),[S,U]=f.useState(""),[Q,re]=f.useState(null),[ye,Qt]=f.useState(""),[Ue,bt]=f.useState(null),[Pn,er]=f.useState([]),[dt,Kn]=f.useState({targetMode:"new",listName:"",targetSegmentId:"",prefix:"",ignoreDuplicates:!0}),[Mn,ae]=f.useState(null),[ne,Xn]=f.useState(!1),[Jn,Zn]=f.useState({connected:!1}),[es,Fr]=f.useState(!1),[ts,Ya]=f.useState(!1),[Ce,ns]=f.useState(()=>{if(typeof window>"u")return"templates";const w=new URLSearchParams(window.location.search).get("tab");return w?ay[w]||w:"templates"}),[tr,Ka]=f.useState(null),[ss,Wr]=f.useState(null),[Xa,rs]=f.useState([]),[Hr,nr]=f.useState(0),[Ja,Ml]=f.useState(!1),[Ps,Iu]=f.useState(""),[Yt,sr]=f.useState(1),[ht]=f.useState(10),[$t,Pt]=f.useState({tag:"Todas",date:"Cualquier fecha",status:"Activos"}),[Za,rr]=f.useState(null);f.useEffect(()=>{const o=e.send_now===!1||e.scheduled_for?"schedule":"now";ze(o)},[e.send_now,e.scheduled_for]);const[Dn,Ct]=f.useState([]);f.useEffect(()=>{Nn(),Ms()},[]),f.useEffect(()=>{$e&&(qr(),ar(),ir())},[$e]),f.useEffect(()=>{if(Ce!=="new"||be)return;const o=setTimeout(()=>{yt(1),C(1,ut,G.trim())},350);return()=>clearTimeout(o)},[G,ut,be,Ce,C]),f.useEffect(()=>{!$e||De!=="odoo"||ir()},[De,$e]),f.useEffect(()=>{Ei.find(o=>o.id===Ce)||ns("templates")},[Ce]),f.useEffect(()=>{if(typeof window>"u")return;const o=new URLSearchParams(window.location.search);o.set("tab",Ce);const w=`${window.location.pathname}?${o.toString()}`;window.history.replaceState({},"",w)},[Ce]);async function Nn(){try{const o=await pe("/api/audiences?with_counts=true");o&&o.segments&&Ct(o.segments)}catch(o){console.error("Failed to load segments",o)}}async function Ms(){try{const o=await pe("/api/contacts/stats");Ka(o||null)}catch(o){console.error("Failed to load Odoo stats",o),Ka(null)}}async function qr(){xn(!0);try{const o=await pe("/api/audiences/automation-settings");A((o==null?void 0:o.settings)||{enabled:!1,phone_number_id:null})}catch(o){console.error("Failed to load automation settings",o)}finally{xn(!1)}}async function ar(){On(!0);try{const o=await pe("/api/audiences/dynamic-tags");Rn((o==null?void 0:o.items)||[])}catch(o){console.error("Failed to load dynamic audiences",o)}finally{On(!1)}}async function ei(o=Ae.enabled){try{const w=await Ne("/api/audiences/automation-settings",{enabled:o});A((w==null?void 0:w.settings)||{...Ae,enabled:o}),je({message:"Configuracin guardada"})}catch(w){je({type:"error",message:w.message||"No se pudo guardar"})}}async function Dl(o){A(w=>({...w,enabled:o})),await ei(o)}async function Il(){on(!0);try{await Ne("/api/audiences/sync-historical",{}),await ar(),await Nn(),je({message:"Sincronizacin completa"})}catch(o){je({type:"error",message:o.message||"Error al sincronizar"})}finally{on(!1)}}async function it(){const o=S.trim();if(o)try{await Ne("/api/audiences/dynamic-tags",{name:o}),U(""),await ar(),await Nn(),je({message:"Etiqueta creada correctamente"})}catch(w){je({type:"error",message:w.message||"No se pudo crear etiqueta"})}}async function ir(){Fr(!0);try{const o=await pe("/api/contacts/odoo-status");Zn(o||{connected:!1})}catch(o){console.error("Failed to load Odoo status",o),Zn({connected:!1})}finally{Fr(!1)}}async function nt(){Ya(!0);try{await Ne("/api/contacts/refresh-odoo",{}),await Ms(),je({message:"Lista Odoo actualizada"})}catch(o){je({type:"error",message:o.message||"Error al actualizar Odoo"})}finally{Ya(!1)}}async function ti(o){return new Promise((w,V)=>{const J=new FileReader;J.onload=()=>{const Ee=(J.result||"").toString().split(",")[1]||"";w(Ee)},J.onerror=()=>V(J.error),J.readAsDataURL(o)})}async function ni(o){var V;const w=(V=o.target.files)==null?void 0:V[0];if(w){re(w),ae(null);try{const J=await ti(w);Qt(J);const le=await Ne("/api/audiences/import-preview",{file_base64:J,filename:w.name});bt(le),er((le==null?void 0:le.mapping)||[])}catch(J){bt(null),er([]),je({type:"error",message:J.message||"No se pudo leer el archivo"})}}}async function Bl(){if(!Q||!ye){je({type:"error",message:"Selecciona un archivo vlido"});return}Xn(!0);try{const o={file_base64:ye,filename:Q.name,mapping:Pn,options:{baseTagName:dt.listName,targetSegmentId:dt.targetMode==="existing"?dt.targetSegmentId:"",prefix:dt.prefix,ignoreDuplicates:dt.ignoreDuplicates}},w=await Ne("/api/audiences/import-excel",o);ae(w),await Nn(),await ar(),je({message:"Importacin completada"})}catch(o){je({type:"error",message:o.message||"Error al importar"})}finally{Xn(!1)}}async function lr(o,w={}){if(!o){rs([]),nr(0);return}const V=w.page||1,J=w.search||"";Ml(!0);try{if(o.type==="odoo"){const wn=(V-1)*ht,Et=await pe(`/api/contacts?search=${encodeURIComponent(J)}&offset=${wn}&limit=${ht}`);let Ut=(Et==null?void 0:Et.contacts)||[];$t.tag!=="Todas"&&(Ut=Ut.filter(ds=>{const Xt=ds.tags_json||[];return $t.tag==="Con etiquetas"?Array.isArray(Xt)&&Xt.length>0:$t.tag==="Sin etiquetas"?!Array.isArray(Xt)||Xt.length===0:!0})),$t.status!=="Activos"&&(Ut=Ut.filter(ds=>{const Xt=(ds.status||"ACTIVO").toUpperCase();return $t.status==="Activos"?Xt==="ACTIVO":Xt!=="ACTIVO"})),rs(Ut),nr((Et==null?void 0:Et.total)||Ut.length);return}const le=await pe(`/api/audiences/${o.id}/preview?limit=200`),Ee=(le==null?void 0:le.recipients)||[],jt=J.trim().toLowerCase();let cn=jt?Ee.filter(wn=>{var ds,Xt;const Et=((ds=wn.name)==null?void 0:ds.toLowerCase())||"",Ut=((Xt=wn.phone_e164)==null?void 0:Xt.toLowerCase())||"";return Et.includes(jt)||Ut.includes(jt)}):Ee;$t.tag==="Sin etiquetas"&&(cn=cn.filter(wn=>!wn.tags||wn.tags.length===0));const us=(le==null?void 0:le.total)||cn.length,li=(V-1)*ht,eo=cn.slice(li,li+ht);rs(eo),nr(us)}catch(le){console.error("Failed to load audience contacts",le),rs([]),nr(0)}finally{Ml(!1)}}function zl(o){Wr((o==null?void 0:o.id)||null),sr(1)}async function Ds(){try{await Ne("/api/audiences/refresh-counts",{}),await Nn(),is&&await lr(is,{page:Yt,search:Ps}),je({message:"Conteos actualizados"})}catch(o){je({type:"error",message:o.message||"No se pudo actualizar"})}}async function or(o){if(!(!o||o.type==="odoo"||o.isDefault||!window.confirm(`Eliminar la audiencia "${o.name}"? Esta accin la desactiva y no borra contactos.`)))try{await kn(`/api/audiences/${o.id}`),await Nn(),ss===o.id&&Wr(null),rr(null),je({message:"Audiencia eliminada"})}catch(V){je({type:"error",message:V.message||"No se pudo eliminar"})}}async function In(o){if(!o||o.type==="odoo"||o.isDefault)return;const w=window.prompt("Nuevo nombre de la audiencia:",o.name);if(!(!w||!w.trim()))try{await ml(`/api/audiences/${o.id}`,{name:w.trim()}),await Nn(),rr(null),je({message:"Audiencia renombrada"})}catch(V){je({type:"error",message:V.message||"No se pudo renombrar"})}}function cr(o,w){Pt(V=>{const J=V[o],le=w.indexOf(J),Ee=w[(le+1)%w.length];return{...V,[o]:Ee}})}function Gr(){if(De==="dynamic"){ei();return}if(De==="excel"){Bl();return}De==="odoo"&&nt()}const ft=f.useMemo(()=>{const o={id:"odoo",name:"odoo",subtitle:"Origen: Odoo",count:(tr==null?void 0:tr.total)||0,type:"odoo"},w=Dn.map(V=>({id:V.id,name:V.name,subtitle:V.description||"Segmento personalizado",count:V.estimated_count||0,type:"segment",isDefault:(V.name||"").toUpperCase().startsWith("DEFAULT")}));return[o,...w]},[Dn,tr]),as=f.useMemo(()=>{const o=_e.trim().toLowerCase();return o?ft.filter(w=>{var le,Ee;const V=((le=w.name)==null?void 0:le.toLowerCase())||"",J=((Ee=w.subtitle)==null?void 0:Ee.toLowerCase())||"";return V.includes(o)||J.includes(o)}):ft},[ft,_e]),is=f.useMemo(()=>ft.find(o=>o.id===ss),[ft,ss]),si=o=>{const w=(o==null?void 0:o.buttons_json)??(o==null?void 0:o.buttons)??[];if(Array.isArray(w))return w;if(typeof w=="string")try{const V=JSON.parse(w);return Array.isArray(V)?V:[]}catch{return[]}return[]},ri=f.useMemo(()=>si(N),[N]),Qr=f.useMemo(()=>si(fe),[fe]),ls=f.useMemo(()=>Math.max(1,Math.ceil(Hr/ht)),[Hr,ht]),$l=f.useMemo(()=>{const o=[],w=Math.max(1,Yt-1),V=Math.min(ls,w+2);for(let J=w;J<=V;J+=1)o.push(J);return o},[Yt,ls]),Is=f.useMemo(()=>{const o={all:i.length,sent:0,scheduled:0,draft:0,failed:0};return i.forEach(w=>{w.status==="sent"&&(o.sent+=1),w.status==="scheduled"&&(o.scheduled+=1),w.status==="draft"&&(o.draft+=1),w.status==="failed"&&(o.failed+=1)}),o},[i]),Bs=f.useMemo(()=>{const o=G.trim().toLowerCase();return i.filter(w=>{const V=!o||(w.name||"").toLowerCase().includes(o),J=se==="all"||w.status===se;return V&&J})},[i,G,se]),Yr=f.useMemo(()=>{const o=[],w=y||i.length,V=Math.max(1,Math.ceil(w/ut)),J=Math.max(1,Qe-1),le=Math.min(V,J+2);for(let Ee=J;Ee<=le;Ee+=1)o.push(Ee);return{pages:o,totalPages:V}},[y,i.length,Qe,ut]);f.useEffect(()=>{Ce==="audiences"&&!ss&&ft.length&&Wr(ft[0].id)},[ft,Ce,ss]),f.useEffect(()=>{Ce!=="new"&&be&&(T(!1),b(null),os())},[Ce,be]),f.useEffect(()=>{Ce==="audiences"&&lr(is,{page:Yt,search:Ps})},[ss,Yt,Ps,Ce,is,$t]);const Ul=f.useMemo(()=>{const o=new Set;return(a||[]).forEach(w=>{w.category&&o.add(w.category)}),Array.from(o)},[a]),Kr=f.useMemo(()=>{const o=I.trim().toLowerCase(),w=P==="all"?"":P.toLowerCase();return(a||[]).filter(V=>{var cn,us;const J=((cn=V.name)==null?void 0:cn.toLowerCase())||"",le=((us=V.category)==null?void 0:us.toLowerCase())||"";return(!o||J.includes(o)||le.includes(o))&&(!w||le===w)})},[I,P,a]),Kt=f.useMemo(()=>{const o=$.trim().toLowerCase();return(a||[]).filter(w=>{var J;const V=((J=w.name)==null?void 0:J.toLowerCase())||"";return!o||V.includes(o)})},[$,a]),Xr=f.useMemo(()=>n.segment_id?ft.find(o=>o.id===n.segment_id)||null:n.tag&&ft.find(o=>o.name===n.tag)||null,[ft,n.segment_id,n.tag]),Vl=f.useMemo(()=>n.segment_id?`segment:${n.segment_id}`:n.tag?`tag:${n.tag}`:n.assigned_user_id?`assigned:${n.assigned_user_id}`:n.status?`status:${n.status}`:n.verified_only?"verified":"",[n.segment_id,n.tag,n.assigned_user_id,n.status,n.verified_only]);function Fl(o){r(w=>{const V={...w,status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""};if(o.startsWith("segment:")){const J=o.slice(8),le=ft.find(Ee=>Ee.id===J);V.segment_id=J,V.segment_name=(le==null?void 0:le.name)||""}else o.startsWith("tag:")?V.tag=o.slice(4):o.startsWith("status:")?V.status=o.slice(7):o.startsWith("assigned:")?V.assigned_user_id=o.slice(9):o==="verified"&&(V.verified_only=!0);return V})}function Wl(o){if(!o)return"";const w=new Date(o);if(Number.isNaN(w.getTime()))return"";const V=J=>String(J).padStart(2,"0");return`${w.getFullYear()}-${V(w.getMonth()+1)}-${V(w.getDate())}T${V(w.getHours())}:${V(w.getMinutes())}`}function Hl(o){t(w=>({...w,template_id:o}))}function os(){t({name:"",template_id:"",scheduled_for:"",send_now:!0}),r({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),q("")}function ql(o){if(!o)return;b(o),T(!0),t(V=>{var J;return{...V,name:o.name||"",template_id:o.template_id||((J=o.template)==null?void 0:J.id)||"",scheduled_for:Wl(o.scheduled_for),send_now:!o.scheduled_for}});const w=o.audience_filter||{};r(V=>({...V,status:w.status||"",tag:w.tag||"",assigned_user_id:w.assigned_user_id||"",verified_only:!!w.verified_only,segment_id:w.segment_id||"",segment_name:w.segment_name||""}))}function Gl(o){!(o!=null&&o.id)||!h||!window.confirm(`Eliminar la campaa "${o.name}"?`)||h(o.id)}function Ql(o){!(o!=null&&o.id)||!p||!window.confirm(`Reenviar la campaa "${o.name}"?`)||p(o.id)}function Yl(o){ce(w=>w===o?null:o)}function ur(o){Ke(w=>w===o?null:o)}function ai(o){o!=null&&o.id&&(xt({id:o.id,name:o.name||"",phone:o.phone_e164||o.phone||"",email:o.email||"",vat:o.vat||""}),et(!0),Ke(null))}async function Kl(o){if(o.preventDefault(),!!tt.id){vt(!0);try{const w=await ml(`/api/contacts/${tt.id}`,{name:tt.name,phone:tt.phone,email:tt.email,vat:tt.vat});w!=null&&w.contact&&rs(V=>V.map(J=>J.id===w.contact.id?w.contact:J)),et(!1),je({message:"Contacto actualizado"}),await lr(is,{page:Yt,search:Ps})}catch(w){je({type:"error",message:w.message||"No se pudo actualizar"})}finally{vt(!1)}}}async function Xl(o){if(!(!(o!=null&&o.id)||!window.confirm(`Eliminar el contacto "${o.name||o.phone_e164||"Sin nombre"}"?`)))try{await kn(`/api/contacts/${o.id}`),rs(V=>V.filter(J=>J.id!==o.id)),Ke(null),je({message:"Contacto eliminado"}),await lr(is,{page:Yt,search:Ps})}catch(V){je({type:"error",message:V.message||"No se pudo eliminar"})}}function Jl(o){if(o.preventDefault(),!e.name.trim()||!e.template_id)return;const w={};if(n.status&&(w.status=n.status),n.tag&&(w.tag=n.tag.trim()),n.assigned_user_id&&(w.assigned_user_id=n.assigned_user_id),n.verified_only&&(w.verified_only=!0),n.segment_id&&(w.segment_id=n.segment_id,n.segment_name&&(w.segment_name=n.segment_name)),H&&g){g(H.id,{name:e.name.trim(),template_id:e.template_id,audience_filter:w,scheduled_for:e.scheduled_for||null}),T(!1),b(null),os();return}x(o)}function cs(o){He(o),ue(!0)}const Jr=Ei.find(o=>o.id===Ce)||Ei[1],Zl={title:"Campaas",subtitle:"CONFIGURACIN DE NUEVO ENVO MASIVO"},Zr=we.find(o=>o.id===De)||we[0],zs=$e?Zr:Ce==="new"&&be?Zl:Jr;return s.jsxs("section",{className:"campaigns-page",children:[s.jsxs("div",{className:"campaigns-shell",children:[s.jsxs("header",{className:"campaigns-header",children:[s.jsxs("div",{className:"campaigns-title-block",children:[s.jsxs("div",{className:"campaigns-title-row",children:[$e&&s.jsx("button",{className:"campaigns-back",type:"button",onClick:()=>ln(!1),"aria-label":"Volver",children:"<"}),s.jsx("span",{className:"campaigns-heading",children:zs.title})]}),s.jsx("div",{className:`campaigns-subtitle ${$e?"campaigns-subtitle--upper":""}`,children:zs.subtitle})]}),s.jsxs("div",{className:"campaigns-actions",children:[$e&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>ln(!1),children:De==="excel"?"Cancelar":"Descartar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:Gr,disabled:De==="excel"&&(ne||!ye||dt.targetMode==="new"&&!dt.listName.trim()||dt.targetMode==="existing"&&!dt.targetSegmentId)||De==="odoo"&&ts,children:Zr.actionLabel})]}),!$e&&Ce==="audiences"&&s.jsxs("button",{className:"campaigns-primary campaigns-primary--dropdown",type:"button",onClick:()=>{ln(!0),W("dynamic")},children:[s.jsx("span",{className:"campaigns-primary-icon",children:"+"}),"Nueva Audiencia"]}),!$e&&Ce==="new"&&s.jsx(s.Fragment,{children:be?s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>{T(!1),b(null),os()},children:"Cancelar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>{var o,w;return(w=(o=Yn.current)==null?void 0:o.requestSubmit)==null?void 0:w.call(o)},children:"Lanzar Campaa"})]}):s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>T(!0),children:"+ Lanzar Campaa"})})]})]}),!$e&&s.jsx("nav",{className:"campaigns-tabs",role:"tablist","aria-label":"Secciones de Campaas",children:Ei.map(o=>s.jsx("button",{type:"button",role:"tab","aria-selected":Ce===o.id,className:`campaigns-tab ${Ce===o.id?"active":""}`,onClick:()=>ns(o.id),children:o.label},o.id))}),s.jsx("div",{className:"campaigns-tab-panel",children:$e?s.jsxs("section",{className:"audience-flow",children:[s.jsx("nav",{className:"audience-flow-tabs",role:"tablist","aria-label":"Flujo de nueva audiencia",children:sh.map(o=>s.jsx("button",{type:"button",role:"tab","aria-selected":De===o.id,className:`audience-flow-tab ${De===o.id?"active":""}`,onClick:()=>W(o.id),children:o.label},o.id))}),s.jsxs("div",{className:"audience-flow-panel",children:[De==="dynamic"&&s.jsxs("div",{className:"audience-flow-content",children:[s.jsxs("div",{className:"audience-hero",children:[s.jsxs("div",{className:"audience-hero-main",children:[s.jsx("div",{className:"audience-hero-title",children:"Sincronizacin Automtica Total"}),s.jsx("div",{className:"audience-hero-subtitle",children:"Vincula tus etiquetas directamente con Audiencias Dinmicas. La lgica del sistema es 1 Tag = 1 Audiencia."})]}),s.jsxs("label",{className:"audience-switch",children:[s.jsx("span",{children:"Estado"}),s.jsx("input",{type:"checkbox",checked:Ae.enabled,onChange:o=>Dl(o.target.checked),disabled:Se}),s.jsx("span",{children:Ae.enabled?"ACTIVO":"INACTIVO"})]})]}),s.jsxs("div",{className:"audience-rule-card",children:[s.jsx("div",{className:"audience-rule-title",children:"Regla de Automatizacin unificada"}),s.jsx("p",{children:"Cuando un operador o bot etiqueta a un contacto en el CRM, este se aade instantneamente a la lista de audiencia correspondiente. No requiere intervencin manual adicional."})]}),s.jsxs("div",{className:"audience-section-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audience-section-title",children:"Gestin de Etiquetas dinmicas"}),s.jsx("div",{className:"audience-section-subtitle",children:"Administra las etiquetas vinculadas que alimentan tus listas de envo en tiempo real."})]}),s.jsxs("div",{className:"audience-section-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:Il,disabled:jn,children:jn?"Sincronizando...":"Sincronizar Datos Histricos"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:it,disabled:!S.trim(),children:"Nueva Etiqueta / Audiencia"})]})]}),s.jsxs("div",{className:"audience-tags-grid",children:[yn&&s.jsx("div",{className:"empty-state",children:"Cargando etiquetas..."}),!yn&&Ln.length===0&&s.jsx("div",{className:"empty-state",children:"No hay etiquetas dinmicas an."}),!yn&&Ln.map(o=>{var w,V,J,le;return s.jsxs("div",{className:`audience-tag-card ${o.is_default?"default":""}`,children:[s.jsxs("div",{className:"audience-tag-head",children:[s.jsx("div",{className:"audience-tag-name",children:o.is_default?"DEFAULT":((w=o.tag)==null?void 0:w.name)||((V=o.segment)==null?void 0:V.name)}),s.jsx("div",{className:"audience-tag-count",children:((J=o.segment)==null?void 0:J.estimated_count)||0})]}),s.jsxs("div",{className:"audience-tag-meta",children:["Audiencia: ",((le=o.segment)==null?void 0:le.estimated_count)||0," contactos"]}),s.jsxs("div",{className:"audience-tag-status",children:[s.jsx("span",{className:"dot"}),"Sincronizado",s.jsx("span",{className:"audience-tag-time",children:o.last_synced_at?`  ${k(o.last_synced_at)}`:""})]})]},o.id)}),s.jsx("div",{className:"audience-tag-card add",children:s.jsxs("div",{className:"audience-tag-add",children:[s.jsx("div",{className:"audience-tag-add-icon",children:"+"}),s.jsx("input",{type:"text",placeholder:"Crear nueva etiqueta",value:S,onChange:o=>U(o.target.value)}),s.jsx("button",{type:"button",className:"campaigns-primary",onClick:it,disabled:!S.trim(),children:"Crear"})]})})]})]}),De==="excel"&&s.jsxs("div",{className:"audience-flow-content",children:[s.jsx("div",{className:"excel-dropzone",children:s.jsxs("div",{className:"excel-dropzone-inner",children:[s.jsx("div",{className:"excel-dropzone-icon",children:"?"}),s.jsx("div",{className:"excel-dropzone-title",children:"Sube tu archivo de Excel"}),s.jsxs("div",{className:"excel-dropzone-subtitle",children:["Arrastra y suelta tu archivo .xlsx o .csv aqu o"," ",s.jsxs("label",{className:"excel-link",children:["explora tus archivos",s.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:ni})]})]}),s.jsxs("div",{className:"excel-dropzone-tags",children:[s.jsx("span",{children:"Mximo 50MB"}),s.jsx("span",{children:"Hasta 50,000 filas"})]}),Q&&s.jsx("div",{className:"excel-file-name",children:Q.name})]})}),s.jsxs("div",{className:"excel-grid",children:[s.jsxs("div",{className:"excel-card",children:[s.jsx("div",{className:"excel-card-title",children:"Configuracin de Importacin"}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista de destino"}),s.jsxs("select",{value:dt.targetMode,onChange:o=>Kn(w=>({...w,targetMode:o.target.value})),children:[s.jsx("option",{value:"new",children:"Crear Nueva Lista"}),s.jsx("option",{value:"existing",children:"Elegir Lista Existente"})]})]}),dt.targetMode==="new"?s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Nombre de la nueva lista"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO",value:dt.listName,onChange:o=>Kn(w=>({...w,listName:o.target.value}))})]}):s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista existente"}),s.jsxs("select",{value:dt.targetSegmentId,onChange:o=>Kn(w=>({...w,targetSegmentId:o.target.value})),children:[s.jsx("option",{value:"",children:"Selecciona una lista"}),Dn.map(o=>s.jsx("option",{value:o.id,children:o.name},o.id))]})]}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Prefijo de etiqueta (opcional)"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO_",value:dt.prefix,onChange:o=>Kn(w=>({...w,prefix:o.target.value}))})]}),s.jsxs("label",{className:"excel-checkbox",children:[s.jsx("input",{type:"checkbox",checked:dt.ignoreDuplicates,onChange:o=>Kn(w=>({...w,ignoreDuplicates:o.target.checked}))}),"Ignorar contactos duplicados"]}),Mn&&s.jsxs("div",{className:"excel-summary",children:["Procesadas: ",Mn.processed,"  Nuevos:"," ",Mn.created,"  Duplicados:"," ",Mn.skipped,"  Errores: ",Mn.errors]})]}),s.jsxs("div",{className:"excel-card",children:[s.jsxs("div",{className:"excel-card-title",children:["Vista previa de mapeo",s.jsxs("span",{className:"excel-pill",children:["Columnas detectadas: ",((ii=Ue==null?void 0:Ue.columns)==null?void 0:ii.length)||0]})]}),s.jsxs("div",{className:"excel-map-table",children:[s.jsxs("div",{className:"excel-map-head",children:[s.jsx("span",{children:"Columna Excel"}),s.jsx("span",{children:"Mapeo CRM"}),s.jsx("span",{children:"Ejemplo"})]}),((Ue==null?void 0:Ue.columns)||[]).map((o,w)=>{var V,J;return s.jsxs("div",{className:"excel-map-row",children:[s.jsx("span",{children:o}),s.jsx("select",{value:Pn[w]||"ignore",onChange:le=>er(Ee=>{const jt=[...Ee];return jt[w]=le.target.value,jt}),children:iy.map(le=>s.jsx("option",{value:le.value,children:le.label},le.value))}),s.jsx("span",{children:((J=(V=Ue==null?void 0:Ue.previewRows)==null?void 0:V[0])==null?void 0:J[w])||"--"})]},`${o}-${w}`)}),!Ue&&s.jsx("div",{className:"empty-state",children:"Sube un archivo para ver el mapeo."})]})]})]})]}),De==="odoo"&&s.jsxs("div",{className:"audience-flow-content odoo-flow",children:[s.jsxs("div",{className:"odoo-status",children:[s.jsx("span",{className:`odoo-indicator ${Jn.connected?"on":"off"}`}),"Estado: ",Jn.connected?"Odoo conectado":"Odoo no conectado"]}),s.jsxs("div",{className:"odoo-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:ir,disabled:es,children:es?"Validando...":"Validar Conexin"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:nt,disabled:ts,children:ts?"Actualizando...":"Actualizar Lista Odoo"})]}),s.jsx("div",{className:"odoo-note",children:"Se importarn contactos y se crearn audiencias por etiqueta Automticamente."})]})]})]}):s.jsxs(s.Fragment,{children:[Ce==="templates"&&s.jsxs("section",{className:"campaigns-panel templates-panel",children:[s.jsxs("div",{className:"templates-toolbar",children:[s.jsxs("label",{className:"templates-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar por nombre de plantilla...",value:I,onChange:o=>_(o.target.value)})]}),s.jsxs("select",{className:"templates-select",value:P,onChange:o=>M(o.target.value),children:[s.jsx("option",{value:"all",children:"Todas las categorias"}),Ul.map(o=>s.jsx("option",{value:o.toLowerCase(),children:nh[o]||o},o))]})]}),s.jsxs("div",{className:"template-grid template-grid--library",children:[Kr.map(o=>{const w=(o.status||(o.is_active?"APPROVED":"PENDING")).toUpperCase(),V=Ci[w]||Ci.PENDING,J=nh[o.category]||o.category||"GENERAL",le=o.id===e.template_id,Ee=o.rejection_reason||o.rejectionReason||o.rejection_message||"",jt=w==="REJECTED"?"Ver detalles":"Previsualizar";return s.jsxs("div",{className:`template-card ${le?"selected":""}`,children:[s.jsxs("div",{className:"template-head",children:[s.jsx("div",{className:"template-name",title:o.name,children:o.name}),s.jsx("span",{className:`template-status ${V.className}`,children:V.label})]}),s.jsx("div",{className:"template-category",children:J}),s.jsx("div",{className:`template-preview ${w==="REJECTED"?"rejected":""}`,children:o.body_preview||o.body_text||"Sin preview"}),w==="REJECTED"&&Ee&&s.jsxs("div",{className:"template-rejection",children:["Rechazada por Meta: ",Ee]}),s.jsx("div",{className:"template-footer",children:s.jsx("button",{className:"template-action",type:"button",onClick:()=>cs(o),children:jt})})]},o.id)}),!Kr.length&&s.jsx("div",{className:"empty-state",children:"Sin plantillas disponibles"})]})]}),Ce==="audiences"&&s.jsx("section",{className:"campaigns-panel audiences-panel",children:s.jsxs("div",{className:"audiences-layout",children:[s.jsxs("div",{className:"audiences-list",children:[s.jsxs("label",{className:"audiences-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar lista...",value:_e,onChange:o=>Le(o.target.value)})]}),s.jsxs("div",{className:"audience-list",children:[as.map(o=>{var w;return s.jsxs("button",{type:"button",className:`audience-card ${ss===o.id?"active":""}`,onClick:()=>zl(o),children:[s.jsxs("div",{className:"audience-title",children:[s.jsx("span",{children:o.name}),s.jsxs("div",{className:"audience-title-actions",children:[s.jsx("span",{className:"audience-count",children:((w=o.count)==null?void 0:w.toLocaleString("es-PE"))||0}),!o.isDefault&&o.type!=="odoo"&&s.jsxs("div",{className:"audience-menu-wrapper",children:[s.jsx("button",{className:"audience-menu",type:"button","aria-label":"Opciones de audiencia",onClick:V=>{V.stopPropagation(),rr(J=>J===o.id?null:o.id)},children:"..."}),Za===o.id&&s.jsxs("div",{className:"audience-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>In(o),children:"Renombrar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>or(o),children:"Eliminar"})]})]})]})]}),s.jsx("div",{className:"audience-subtitle",children:o.subtitle})]},o.id)}),!as.length&&s.jsx("div",{className:"empty-state",children:"Sin audiencias disponibles"})]})]}),s.jsxs("div",{className:"audiences-table-panel",children:[s.jsxs("div",{className:"audiences-filters",children:[s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ETIQUETA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>cr("tag",["Todas","Con etiquetas","Sin etiquetas"]),children:$t.tag})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"FECHA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>cr("date",["Cualquier fecha","ltimos 30 das"]),children:$t.date})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ESTADO:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>cr("status",["Activos","Inactivos"]),children:$t.status})]}),s.jsxs("div",{className:"audiences-filter-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Descargar",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Actualizar",onClick:Ds,children:""})]})]}),s.jsxs("div",{className:"audiences-search-row",children:[s.jsxs("label",{className:"audiences-search-field",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar contacto en esta lista...",value:Ps,onChange:o=>{Iu(o.target.value),sr(1)}})]}),s.jsxs("div",{className:"audiences-total",children:[Hr.toLocaleString("es-PE")," contactos en total"]})]}),s.jsxs("div",{className:"audiences-table",children:[s.jsxs("div",{className:"audiences-table-head",children:[s.jsx("span",{}),s.jsx("span",{children:"CONTACTO"}),s.jsx("span",{children:"WHATSAPP"}),s.jsx("span",{children:"ETIQUETAS"}),s.jsx("span",{children:"FECHA REGISTRO"}),s.jsx("span",{children:"ESTADO"}),s.jsx("span",{})]}),Ja&&s.jsx("div",{className:"loading",children:"Cargando contactos..."}),!Ja&&Xa.length===0&&s.jsx("div",{className:"empty-state",children:"No hay contactos en esta audiencia."}),!Ja&&Xa.map(o=>{const w=o.name||"Sin nombre",V=o.email||"",J=o.phone_e164||o.phone||"-",le=Array.isArray(o.tags)?o.tags:o.tags?[o.tags]:[],Ee=w.trim().slice(0,1).toUpperCase();return s.jsxs("div",{className:"audiences-table-row",children:[s.jsx("input",{type:"checkbox","aria-label":"Seleccionar contacto"}),s.jsxs("div",{className:"audiences-contact",children:[s.jsx("div",{className:"audiences-avatar",children:Ee}),s.jsxs("div",{className:"audiences-contact-info",children:[s.jsx("div",{className:"audiences-contact-name",children:w}),V&&s.jsx("div",{className:"audiences-contact-email",children:V})]})]}),s.jsx("div",{children:J}),s.jsx("div",{className:"audiences-tags",children:le.length?le.map(jt=>s.jsx("span",{className:"audiences-tag",children:jt},`${o.id}-${jt}`)):s.jsx("span",{className:"audiences-tag empty",children:""})}),s.jsx("div",{children:o.created_at?k(o.created_at):""}),s.jsx("div",{className:"audiences-status",children:(o.status||"ACTIVO").toUpperCase()}),s.jsxs("div",{className:"audiences-menu-wrapper",children:[s.jsx("button",{className:"audiences-menu",type:"button","aria-label":"Opciones",onClick:()=>ur(o.id),disabled:!o.id,children:"..."}),ge===o.id&&s.jsxs("div",{className:"audiences-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>ai(o),children:"Editar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>Xl(o),children:"Eliminar"})]})]})]},o.id||J)})]}),s.jsxs("div",{className:"audiences-pagination",children:[s.jsxs("div",{className:"audiences-page-info",children:["Pgina ",Yt," de ",ls]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:Yt<=1,onClick:()=>sr(o=>Math.max(1,o-1)),children:"<"}),$l.map(o=>s.jsx("button",{className:`audiences-page-btn ${o===Yt?"active":""}`,type:"button",onClick:()=>sr(o),children:o},`aud-page-${o}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:Yt>=ls,onClick:()=>sr(o=>Math.min(ls,o+1)),children:">"})]})]})]})]})}),Ce==="new"&&s.jsx("section",{className:"campaigns-panel campaigns-module",children:be?s.jsxs("div",{className:"campaigns-launch",children:[s.jsxs("form",{className:"campaigns-launch-form",ref:Yn,onSubmit:Jl,children:[s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"1"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Nombre de la Campaa"}),s.jsx("input",{type:"text",placeholder:"Ej: Promocin Black Friday 2024",value:e.name,onChange:o=>t(w=>({...w,name:o.target.value}))})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"2"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Seleccionar Audiencia"}),s.jsxs("select",{value:Vl,onChange:o=>Fl(o.target.value),children:[s.jsx("option",{value:"",children:"Selecciona un segmento..."}),ft.filter(o=>o.type!=="odoo").map(o=>s.jsx("option",{value:`segment:${o.id}`,children:o.name},`seg-${o.id}`)),s.jsx("option",{value:"verified",children:"Solo verificados"}),s.jsx("option",{value:"assigned:unassigned",children:"Sin asignar"})]})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"3"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Elegir Plantilla de Meta"}),s.jsxs("div",{className:"launch-template-search",children:[s.jsx("input",{type:"text",placeholder:"Buscar plantilla...",value:$,onChange:o=>q(o.target.value)}),s.jsx("button",{type:"button",onClick:()=>q(""),children:"Limpiar"})]}),s.jsx("div",{className:"launch-templates-scroll",children:s.jsxs("div",{className:"launch-templates",children:[Kt.map(o=>{const w=o.status||"APPROVED",V=Ci[w]||Ci.APPROVED,J=e.template_id===o.id;return s.jsxs("button",{className:`launch-template ${J?"selected":""}`,type:"button",onClick:()=>Hl(o.id),children:[s.jsx("div",{className:"launch-template-icon"}),s.jsx("div",{className:"launch-template-title",children:o.name}),s.jsx("div",{className:"launch-template-preview",children:o.body_preview||o.body_text||"Sin preview"}),s.jsx("span",{className:`launch-template-status ${V.className}`,children:V.label})]},o.id)}),Kt.length===0&&s.jsx("div",{className:"launch-empty",children:"Sin plantillas"})]})})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"4"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Programacin"}),s.jsxs("div",{className:"launch-schedule",children:[s.jsx("button",{className:`launch-schedule-option ${Ge==="now"?"active":""}`,type:"button",onClick:()=>{ze("now"),t(o=>({...o,scheduled_for:"",send_now:!0}))},children:"Enviar Ahora"}),s.jsx("button",{className:`launch-schedule-option ${Ge==="schedule"?"active":""}`,type:"button",onClick:()=>{ze("schedule"),t(o=>({...o,send_now:!1}))},children:"Programar Envo"})]}),Ge==="schedule"&&s.jsx("input",{type:"datetime-local",value:e.scheduled_for,onChange:o=>t(w=>({...w,scheduled_for:o.target.value,send_now:!1}))})]})]})]}),s.jsxs("aside",{className:"campaigns-launch-preview",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:"Nombre del Cliente"}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(N==null?void 0:N.body_preview)||(N==null?void 0:N.body_text)||"Selecciona una plantilla para ver el contenido."}),ri.length>0&&s.jsx("div",{className:"preview-actions",children:ri.map((o,w)=>s.jsx("button",{type:"button",children:o.text||o.label||o.title||`Botn ${w+1}`},`preview-btn-${w}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Destinatarios"}),s.jsx("strong",{children:(Xr==null?void 0:Xr.count)||0})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:(N==null?void 0:N.name)||"Sin plantilla"})]})]})]})]}):s.jsxs("div",{className:"campaigns-dashboard",children:[s.jsxs("aside",{className:"campaigns-sidebar",children:[s.jsxs("label",{className:"campaigns-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar campaa...",value:G,onChange:o=>te(o.target.value)})]}),s.jsxs("div",{className:"campaigns-filters-list",children:[s.jsxs("button",{className:`campaigns-filter-item ${se==="all"?"active":""}`,type:"button",onClick:()=>de("all"),children:[s.jsx("span",{children:"Todas las Campaas"}),s.jsx("span",{className:"campaigns-filter-count",children:Is.all})]}),s.jsxs("button",{className:`campaigns-filter-item ${se==="sent"?"active":""}`,type:"button",onClick:()=>de("sent"),children:[s.jsx("span",{children:"Enviadas"}),s.jsx("span",{className:"campaigns-filter-count",children:Is.sent})]}),s.jsxs("button",{className:`campaigns-filter-item ${se==="scheduled"?"active":""}`,type:"button",onClick:()=>de("scheduled"),children:[s.jsx("span",{children:"Programadas"}),s.jsx("span",{className:"campaigns-filter-count",children:Is.scheduled})]}),s.jsxs("button",{className:`campaigns-filter-item ${se==="draft"?"active":""}`,type:"button",onClick:()=>de("draft"),children:[s.jsx("span",{children:"Borradores"}),s.jsx("span",{className:"campaigns-filter-count",children:Is.draft})]}),s.jsxs("button",{className:`campaigns-filter-item ${se==="failed"?"active":""}`,type:"button",onClick:()=>de("failed"),children:[s.jsx("span",{children:"Fallidas"}),s.jsx("span",{className:"campaigns-filter-count",children:Is.failed})]})]}),s.jsxs("div",{className:"campaigns-quota",children:[s.jsx("div",{className:"campaigns-quota-title",children:"Cuota de mensajes"}),s.jsx("div",{className:"campaigns-quota-bar",children:s.jsx("div",{className:"campaigns-quota-fill",style:{width:"65%"}})}),s.jsx("div",{className:"campaigns-quota-meta",children:"65% usado"})]})]}),s.jsxs("div",{className:"campaigns-table-panel",children:[s.jsxs("div",{className:"campaigns-table-filters",children:[s.jsx("div",{className:"campaigns-filter-chip",children:"Canal: WhatsApp Business"}),s.jsx("div",{className:"campaigns-filter-chip",children:"Periodo: ltimos 30 das"}),s.jsxs("div",{className:"campaigns-table-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button",onClick:()=>C(Qe,ut,G.trim()),children:""})]})]}),s.jsxs("div",{className:"campaigns-table",children:[s.jsxs("div",{className:"campaigns-table-head",children:[s.jsx("span",{children:"Campaa"}),s.jsx("span",{children:"Fecha"}),s.jsx("span",{children:"Audiencia"}),s.jsx("span",{children:"Enviados"}),s.jsx("span",{children:"Ledos"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{})]}),Bs.map(o=>{const w=o.messages_count||o.audience_count||"--",V=o.read_count||"--",J=o.reply_count||"--",le=th[o.status]||o.status,Ee=o.status==="sending",jt=["sent","failed"].includes(o.status),cn=!Ee,us=!Ee;return s.jsxs("div",{className:"campaigns-table-row",children:[s.jsxs("div",{className:"campaigns-table-title",children:[s.jsx("div",{className:"campaigns-table-name",children:o.name}),s.jsxs("div",{className:"campaigns-table-ref",children:["Ref: ",o.id.slice(0,10)]})]}),s.jsx("div",{className:"campaigns-table-date",children:k(o.created_at)}),s.jsx("div",{className:"campaigns-table-tags",children:s.jsx("span",{className:"campaigns-pill",children:o.audience_label||"Base General"})}),s.jsx("div",{className:"campaigns-metric",children:w}),s.jsx("div",{className:"campaigns-metric",children:V}),s.jsx("div",{className:"campaigns-metric",children:J}),s.jsx("div",{className:`campaigns-status ${o.status}`,children:le}),s.jsx("div",{className:"campaigns-row-actions",children:s.jsxs("div",{className:"campaigns-row-menu",children:[s.jsx("button",{className:"campaigns-row-menu-btn",type:"button","aria-label":"Opciones",onClick:()=>Yl(o.id),children:"..."}),ie===o.id&&s.jsxs("div",{className:"campaigns-row-dropdown",children:[cn&&s.jsx("button",{type:"button",onClick:()=>{ql(o),ce(null)},children:"Editar"}),jt&&s.jsx("button",{type:"button",onClick:()=>{Ql(o),ce(null)},children:"Reenviar"}),us&&s.jsx("button",{type:"button",className:"danger",onClick:()=>{Gl(o),ce(null)},children:"Eliminar"})]})]})})]},o.id)}),!Bs.length&&s.jsx("div",{className:"empty-state",children:"Sin campaas registradas"})]}),s.jsxs("div",{className:"campaigns-table-footer",children:[s.jsxs("span",{children:["Mostrando ",Bs.length," de"," ",y||i.length," campaas"]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:Qe<=1,onClick:()=>{const o=Math.max(1,Qe-1);yt(o),C(o,ut,G.trim())},children:"<"}),Yr.pages.map(o=>s.jsx("button",{className:`audiences-page-btn ${o===Qe?"active":""}`,type:"button",onClick:()=>{yt(o),C(o,ut,G.trim())},children:o},`camp-page-${o}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:Qe>=Yr.totalPages,onClick:()=>{const o=Math.min(Yr.totalPages,Qe+1);yt(o),C(o,ut,G.trim())},children:">"})]})]})]})]})}),Ce==="history"&&s.jsxs("section",{className:"campaigns-panel campaigns-history",children:[s.jsxs("div",{className:"campaigns-history-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"campaigns-history-title",children:"Historial de Envos"}),s.jsx("div",{className:"campaigns-history-subtitle",children:"ltimos 30 das"})]}),s.jsx("button",{className:"campaigns-link",type:"button",onClick:C,children:"Ver todo el historial"})]}),s.jsxs("div",{className:"history-table history-table--main",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"Campaa / Fecha"}),s.jsx("span",{children:"Alcance"}),s.jsx("span",{children:"Tasa de lectura"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),i.map(o=>{const w=th[o.status]||o.status,V=o.audience_count||o.messages_count||o.total||"--";return s.jsxs("div",{className:"history-row",children:[s.jsxs("div",{className:"history-title",children:[s.jsx("div",{className:"history-name",children:o.name}),s.jsx("div",{className:"history-date",children:k(o.created_at)})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:V}),s.jsx("div",{className:"history-label",children:"contactos"})]}),s.jsxs("div",{className:"history-meter",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-bar",children:s.jsx("div",{className:"history-bar-fill",style:{width:"0%"}})})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-label",children:"mensajes"})]}),s.jsx("div",{className:`history-status ${o.status}`,children:w}),s.jsxs("div",{className:"history-actions",children:[s.jsx("button",{className:"campaigns-ghost small",type:"button",onClick:()=>L(o.id),children:"Ver mensajes"}),s.jsx("button",{className:"campaigns-danger small",type:"button",onClick:()=>R(o.id),disabled:o.status==="sending",children:"Enviar"})]})]},o.id)}),!i.length&&s.jsx("div",{className:"empty-state",children:"Sin Campaas registradas"})]}),l&&s.jsxs("div",{className:"campaigns-messages",children:[s.jsx("div",{className:"campaigns-history-title",children:"Mensajes"}),s.jsxs("div",{className:"history-table history-table--messages",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"WA"}),s.jsx("span",{children:"Status"}),s.jsx("span",{children:"Enviado"})]}),c.map(o=>s.jsxs("div",{className:"history-row",children:[s.jsx("span",{children:o.wa_id}),s.jsx("span",{children:o.status}),s.jsx("span",{children:k(o.sent_at)})]},o.id))]})]})]})]})})]}),K&&s.jsx("div",{className:"modal-overlay",onClick:()=>ue(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Previsualizar plantilla"}),s.jsx("button",{className:"modal-close",onClick:()=>ue(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:z}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(fe==null?void 0:fe.body_preview)||(fe==null?void 0:fe.body_text)||"Sin previsualizacin disponible."}),Qr.length>0&&s.jsx("div",{className:"preview-actions",children:Qr.map((o,w)=>s.jsx("button",{type:"button",children:o.text||o.label||o.title||`Botn ${w+1}`},`preview-modal-btn-${w}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})}),ct&&s.jsx("div",{className:"modal-overlay",onClick:()=>et(!1),children:s.jsxs("div",{className:"modal-content",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Editar contacto"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>et(!1),children:"x"})]}),s.jsxs("form",{className:"modal-body",onSubmit:Kl,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:tt.name,onChange:o=>xt(w=>({...w,name:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Telfono"}),s.jsx("input",{type:"text",value:tt.phone,onChange:o=>xt(w=>({...w,phone:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:tt.email,onChange:o=>xt(w=>({...w,email:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"CI / NIT"}),s.jsx("input",{type:"text",value:tt.vat,onChange:o=>xt(w=>({...w,vat:o.target.value}))})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{className:"btn-secondary",type:"button",onClick:()=>et(!1),children:"Cancelar"}),s.jsx("button",{className:"btn-primary",type:"submit",disabled:ve,children:ve?"Guardando...":"Guardar"})]})]})]})})]})}function ka({variant:e="error",title:t,message:n,actionLabel:r,onAction:a,dismissLabel:i="Cerrar",onDismiss:l}){const c=e==="offline"?"x":"!";return s.jsxs("div",{className:`notice-banner notice-banner-${e}`,children:[s.jsx("div",{className:"notice-icon","aria-hidden":"true",children:c}),s.jsxs("div",{className:"notice-content",children:[t?s.jsx("div",{className:"notice-title",children:t}):null,s.jsx("div",{className:"notice-text",children:n})]}),s.jsxs("div",{className:"notice-actions",children:[r&&s.jsx("button",{className:"notice-action",type:"button",onClick:a,children:r}),l&&s.jsx("button",{className:"notice-close",type:"button",onClick:l,children:i})]})]})}const oy={admin:{title:"Administrador",subtitle:"Acceso total",tone:"alert"},recepcion:{title:"Operador",subtitle:"Atencion al cliente",tone:"info"},caja:{title:"Supervisor",subtitle:"Auditoria y gestion",tone:"dark"},marketing:{title:"Marketing",subtitle:"Crecimiento y campanas",tone:"info"},doctor:{title:"Doctor",subtitle:"Atencion al cliente",tone:"dark"}},rh=[{id:"chat",label:"Chat"},{id:"dashboard",label:"Dashboard"},{id:"campaigns",label:"Campanas"}],ah=[{id:"general",label:"General"},{id:"users",label:"Gestion de Usuarios"},{id:"bot",label:"Configuracion de Bot"},{id:"templates",label:"Plantillas de Meta"},{id:"audit",label:"Registros / Auditoria"},{id:"odoo",label:"Integracion Odoo"}];function ih(e){return oy[e]||{title:e,subtitle:"Acceso personalizado",tone:"info"}}function cy({settingsTab:e,setSettingsTab:t,rolePermissions:n,setRolePermissions:r,isAdmin:a,adminUsers:i,userForm:l,setUserForm:c,roleOptions:u,handleUserSubmit:m,handleUserDelete:N,defaultRolePermissions:v,handleRoleDelete:x}){const[C,L]=f.useState(""),[R,g]=f.useState(!1),[h,p]=f.useState(""),[y,k]=f.useState(null),[D,z]=f.useState(!1),[I,_]=f.useState("create"),[P,M]=f.useState("recepcion"),[K,ue]=f.useState({modules:{},settings:{}}),fe=f.useMemo(()=>{const T=C.trim().toLowerCase(),H=i||[];return T?H.filter(b=>{var ie,ce;const $=((ie=b.name)==null?void 0:ie.toLowerCase())||"",q=((ce=b.email)==null?void 0:ce.toLowerCase())||"";return $.includes(T)||q.includes(T)}):H},[i,C]);function He(T){const H=(n==null?void 0:n[T])||(v==null?void 0:v[T])||{modules:{},settings:{}};return{modules:{...H.modules||{}},settings:{...H.settings||{}}}}function _e(T,H="edit"){_(H),M(T),ue(He(T)),z(!0)}function Le(T,H,b){ue($=>{const q={...$},ie={...q[T]||{}},ce={...ie[H]||{}},ge=!ce[b];return ce[b]=ge,b==="write"&&ge&&(ce.read=!0),b==="read"&&!ge&&(ce.write=!1),ie[H]=ce,q[T]=ie,q})}function at(){P&&(r(T=>({...T,[P]:K})),z(!1))}function F(){P&&x&&x(P),z(!1)}function G(T,H,b,$){a&&r(q=>{var et,ve;const ie={...q},ce={modules:{...(et=ie[T])==null?void 0:et.modules},settings:{...(ve=ie[T])==null?void 0:ve.settings}},ge={...ce[H]},Ke={...ge[b]},ct=!Ke[$];return Ke[$]=ct,$==="write"&&ct&&(Ke.read=!0),$==="read"&&!ct&&(Ke.write=!1),ge[b]=Ke,ce[H]=ge,ie[T]=ce,ie})}function te(T){return ih(T).title.toUpperCase()}function se(T,H){return T!=null&&T.id?`OP-${T.id.slice(-4).toUpperCase()}`:`OP-${String(H+1).padStart(4,"0")}`}function de(T){c({id:T.id,name:T.name,email:T.email,role:T.role,password:"",is_active:T.is_active}),g(!0)}function be(){c({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),g(!0)}return s.jsxs("div",{className:"users-page",children:[s.jsxs("header",{className:"users-header",children:[s.jsxs("div",{className:"users-title-row",children:[s.jsx("span",{className:"users-kicker"}),s.jsxs("div",{children:[s.jsx("div",{className:"users-title",children:"Gestion de Usuarios"}),s.jsx("div",{className:"users-subtitle",children:"Administra los accesos y roles de los operadores de tu empresa."})]})]}),s.jsxs("div",{className:"users-actions",children:[e==="list"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"users-search",children:[s.jsx("span",{className:"users-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar usuario...",value:C,onChange:T=>L(T.target.value)})]}),s.jsx("button",{className:"settings-primary",type:"button",onClick:be,children:"Nuevo Usuario"})]}),e==="roles"&&s.jsx("button",{className:"settings-primary",type:"button",onClick:()=>_e("recepcion","create"),children:"+ Nuevo Rol"})]})]}),s.jsxs("div",{className:"users-tabs",children:[s.jsx("button",{className:`users-tab ${e==="list"?"active":""}`,type:"button",onClick:()=>t("list"),children:"Lista de Usuarios"}),s.jsx("button",{className:`users-tab ${e==="roles"?"active":""}`,type:"button",onClick:()=>t("roles"),children:"Roles y Permisos"})]}),e==="list"&&s.jsxs("div",{className:"users-table",children:[s.jsxs("div",{className:"users-table-head",children:[s.jsx("span",{children:"Nombre / Usuario"}),s.jsx("span",{children:"Email"}),s.jsx("span",{children:"Rol"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),fe.map((T,H)=>{var b;return s.jsxs("div",{className:"users-row",children:[s.jsxs("div",{className:"users-cell user-name",children:[s.jsx("div",{className:"user-avatar",children:((b=T.name)==null?void 0:b[0])||"?"}),s.jsxs("div",{children:[s.jsx("div",{className:"user-title",children:T.name}),s.jsx("div",{className:"user-id",children:se(T,H)})]})]}),s.jsx("div",{className:"users-cell",children:T.email}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`role-pill ${T.role}`,children:te(T.role)})}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`status-pill ${T.is_active?"active":"inactive"}`,children:T.is_active?"Activo":"Inactivo"})}),s.jsx("div",{className:"users-cell",children:s.jsxs("div",{className:"users-actions-menu",children:[s.jsx("button",{className:"users-action",type:"button",onClick:()=>p($=>$===T.id?"":T.id),children:"..."}),h===T.id&&s.jsxs("div",{className:"users-menu",children:[s.jsx("button",{type:"button",onClick:()=>{p(""),de(T)},children:"Editar"}),s.jsx("button",{type:"button",onClick:()=>{p(""),k(T)},children:"Eliminar"})]})]})})]},T.id)}),!fe.length&&s.jsx("div",{className:"empty-state",children:"Sin usuarios para mostrar"})]}),e==="roles"&&s.jsx("div",{className:"roles-grid",children:u.map(T=>{const H=ih(T),b=n==null?void 0:n[T];return s.jsxs("div",{className:"role-card",children:[s.jsxs("div",{className:"role-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"role-title",children:H.title}),s.jsx("div",{className:`role-subtitle ${H.tone}`,children:H.subtitle})]}),s.jsx("button",{className:"role-edit",type:"button",onClick:()=>_e(T,"edit"),children:"edit"})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),rh.map($=>{var q,ie,ce,ge;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:$.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ie=(q=b==null?void 0:b.modules)==null?void 0:q[$.id])==null?void 0:ie.read)||!1,disabled:!a,onChange:()=>G(T,"modules",$.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ge=(ce=b==null?void 0:b.modules)==null?void 0:ce[$.id])==null?void 0:ge.write)||!1,disabled:!a,onChange:()=>G(T,"modules",$.id,"write")}),s.jsx("span",{})]})]},$.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsx("div",{className:"role-settings-title",children:"Configuracion"}),ah.map($=>{var q,ie,ce,ge;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:$.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ie=(q=b==null?void 0:b.settings)==null?void 0:q[$.id])==null?void 0:ie.read)||!1,disabled:!a,onChange:()=>G(T,"settings",$.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ge=(ce=b==null?void 0:b.settings)==null?void 0:ce[$.id])==null?void 0:ge.write)||!1,disabled:!a,onChange:()=>G(T,"settings",$.id,"write")}),s.jsx("span",{})]})]},$.id)})]})]},T)})}),R&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:l.id?"Editar usuario":"Crear usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>g(!1),children:"x"})]}),s.jsxs("form",{className:"form-grid",onSubmit:async T=>{await m(T),g(!1)},children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:T=>c(H=>({...H,name:T.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:l.email,onChange:T=>c(H=>({...H,email:T.target.value})),disabled:!!l.id})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),s.jsx("select",{value:l.role,onChange:T=>c(H=>({...H,role:T.target.value})),children:u.map(T=>s.jsx("option",{value:T,children:T},T))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:l.password,onChange:T=>c(H=>({...H,password:T.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:T=>c(H=>({...H,is_active:T.target.checked}))}),"Activo"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"primary",type:"submit",children:l.id?"Guardar cambios":"Crear"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>g(!1),children:"Cancelar"})]})]})]})}),y&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Eliminar usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>k(null),children:"x"})]}),s.jsxs("p",{className:"modal-text",children:["Vas a desactivar a ",s.jsx("strong",{children:y.email}),". Continuar?"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"danger",type:"button",onClick:()=>{N==null||N(y.id),k(null)},children:"Eliminar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>k(null),children:"Cancelar"})]})]})}),D&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card modal-lg",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:I==="create"?"Nuevo rol":"Editar rol"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>z(!1),children:"x"})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),I==="edit"?s.jsx("select",{value:P,disabled:!0,children:u.map(T=>s.jsx("option",{value:T,children:T},T))}):s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"text",list:"role-options",placeholder:"nuevo-rol",value:P,onChange:T=>M(T.target.value)}),s.jsx("datalist",{id:"role-options",children:u.map(T=>s.jsx("option",{value:T},T))})]})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Modulos"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),rh.map(T=>{var H,b,$,q;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:T.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((b=(H=K==null?void 0:K.modules)==null?void 0:H[T.id])==null?void 0:b.read)||!1,onChange:()=>Le("modules",T.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((q=($=K==null?void 0:K.modules)==null?void 0:$[T.id])==null?void 0:q.write)||!1,onChange:()=>Le("modules",T.id,"write")}),s.jsx("span",{})]})]},T.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Configuracion"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),ah.map(T=>{var H,b,$,q;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:T.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((b=(H=K==null?void 0:K.settings)==null?void 0:H[T.id])==null?void 0:b.read)||!1,onChange:()=>Le("settings",T.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((q=($=K==null?void 0:K.settings)==null?void 0:$[T.id])==null?void 0:q.write)||!1,onChange:()=>Le("settings",T.id,"write")}),s.jsx("span",{})]})]},T.id)})]})]}),s.jsxs("div",{className:"form-actions",children:[I==="edit"&&s.jsx("button",{className:"danger",type:"button",onClick:F,children:"Eliminar rol"}),s.jsx("button",{className:"primary",type:"button",onClick:at,disabled:!P,children:"Guardar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>z(!1),children:"Cancelar"})]})]})})]})}function uy({branches:e,branchForm:t,setBranchForm:n,handleBranchSubmit:r,handleBranchDisable:a,services:i,serviceForm:l,setServiceForm:c,handleServiceSubmit:u,handleServiceDisable:m,handleServiceBranchToggle:N,tenantChannels:v,channelForm:x,setChannelForm:C,handleChannelSelect:L,handleChannelSubmit:R}){return s.jsxs("div",{className:"page-grid",children:[s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Sucursales"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Nombre"}),s.jsx("span",{children:"Codigo"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Accion"})]}),e.map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.name}),s.jsx("span",{children:g.code}),s.jsx("span",{children:g.is_active?"Activa":"Inactiva"}),s.jsxs("div",{className:"row-actions",children:[s.jsx("button",{className:"ghost",onClick:()=>n({id:g.id,code:g.code,name:g.name,address:g.address,lat:g.lat,lng:g.lng,hours_text:g.hours_text,phone:g.phone||"",is_active:g.is_active}),children:"Editar"}),s.jsx("button",{className:"danger",onClick:()=>a(g.id),children:"Desactivar"})]})]},g.id))]}),s.jsx("div",{className:"panel-title",children:t.id?"Editar sucursal":"Crear sucursal"}),s.jsxs("form",{className:"form-grid",onSubmit:r,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Codigo"}),s.jsx("input",{type:"text",value:t.code,onChange:g=>n(h=>({...h,code:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:t.name,onChange:g=>n(h=>({...h,name:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Direccion"}),s.jsx("input",{type:"text",value:t.address,onChange:g=>n(h=>({...h,address:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Lat"}),s.jsx("input",{type:"number",value:t.lat,onChange:g=>n(h=>({...h,lat:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Lng"}),s.jsx("input",{type:"number",value:t.lng,onChange:g=>n(h=>({...h,lng:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Telefono"}),s.jsx("input",{type:"text",value:t.phone,onChange:g=>n(h=>({...h,phone:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Horarios"}),s.jsx("textarea",{rows:"3",value:t.hours_text,onChange:g=>n(h=>({...h,hours_text:g.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:t.is_active,onChange:g=>n(h=>({...h,is_active:g.target.checked}))}),"Activa"]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Guardar"})})]})]}),s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Servicios"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Servicio"}),s.jsx("span",{children:"Precio"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Accion"})]}),i.map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.name}),s.jsxs("span",{children:["Bs ",g.price_bob]}),s.jsx("span",{children:g.is_active?"Activo":"Inactivo"}),s.jsxs("div",{className:"row-actions",children:[s.jsx("button",{className:"ghost",onClick:()=>c({id:g.id,code:g.code,name:g.name,subtitle:g.subtitle||"",description:g.description,price_bob:g.price_bob,duration_min:g.duration_min||"",image_url:g.image_url||"",is_featured:g.is_featured,is_active:g.is_active}),children:"Editar"}),s.jsx("button",{className:"danger",onClick:()=>m(g.id),children:"Desactivar"})]})]},g.id))]}),s.jsx("div",{className:"panel-title",children:l.id?"Editar servicio":"Crear servicio"}),s.jsxs("form",{className:"form-grid",onSubmit:u,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Codigo"}),s.jsx("input",{type:"text",value:l.code,onChange:g=>c(h=>({...h,code:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:g=>c(h=>({...h,name:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Subtitulo"}),s.jsx("input",{type:"text",value:l.subtitle,onChange:g=>c(h=>({...h,subtitle:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Descripcion"}),s.jsx("textarea",{rows:"3",value:l.description,onChange:g=>c(h=>({...h,description:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Precio (Bs)"}),s.jsx("input",{type:"number",value:l.price_bob,onChange:g=>c(h=>({...h,price_bob:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Duracion (min)"}),s.jsx("input",{type:"number",value:l.duration_min,onChange:g=>c(h=>({...h,duration_min:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Imagen URL"}),s.jsx("input",{type:"text",value:l.image_url,onChange:g=>c(h=>({...h,image_url:g.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_featured,onChange:g=>c(h=>({...h,is_featured:g.target.checked}))}),"Destacado"]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:g=>c(h=>({...h,is_active:g.target.checked}))}),"Activo"]}),l.id&&s.jsxs("div",{className:"field",children:[s.jsx("span",{children:"Disponibilidad por sucursal"}),s.jsx("div",{className:"chip-grid",children:e.map(g=>{var y,k;const h=(k=(y=i.find(D=>D.id===l.id))==null?void 0:y.branches)==null?void 0:k.find(D=>{var I;return(((I=D.branch)==null?void 0:I.id)||D.branch_id)===g.id}),p=(h==null?void 0:h.is_available)||!1;return s.jsxs("label",{className:"chip",children:[s.jsx("input",{type:"checkbox",checked:p,onChange:D=>N(i.find(z=>z.id===l.id),g.id,D.target.checked)}),g.name]},g.id)})})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Guardar"})})]})]}),s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Lineas de WhatsApp"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Nombre"}),s.jsx("span",{children:"Phone ID"}),s.jsx("span",{children:"Accion"})]}),(v||[]).map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.display_name||"Linea sin nombre"}),s.jsx("span",{children:g.phone_number_id}),s.jsx("button",{className:"ghost",onClick:()=>L(g),children:"Renombrar"})]},g.id)),!(v!=null&&v.length)&&s.jsx("div",{className:"empty-state",children:"Sin lineas registradas"})]}),s.jsx("div",{className:"panel-title",children:x.id?"Editar linea":"Selecciona una linea"}),s.jsxs("form",{className:"form-grid",onSubmit:R,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre visible"}),s.jsx("input",{type:"text",value:x.display_name,onChange:g=>C(h=>({...h,display_name:g.target.value})),disabled:!x.id})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",disabled:!x.id,children:"Guardar"})})]})]})]})}function dy(){var L,R,g,h,p,y,k,D,z,I;const[e,t]=f.useState([]),[n,r]=f.useState(null),[a,i]=f.useState(!0),[l,c]=f.useState("");f.useEffect(()=>{u()},[]);async function u(){i(!0);try{const[_,P]=await Promise.all([pe("/api/admin/bots"),pe("/api/admin/bots/metrics")]);t(_.bots||[]),r(P.metrics),c("")}catch(_){console.error(_),c(_.message||"Error al cargar datos")}finally{i(!1)}}async function m(_,P){try{await Xe(`/api/admin/bots/${_}`,{is_active:P}),t(M=>M.map(K=>K.id===_?{...K,is_active:P}:K))}catch(M){c(M.message||"Error al cambiar estado")}}const N=_=>{if(!_)return"Sin actividad reciente";const P=new Date(_),K=new Date-P,ue=Math.floor(K/6e4);if(ue<1)return"Hace un momento";if(ue<60)return`ltima actividad: hace ${ue} min`;const fe=Math.floor(ue/60);return fe<24?`ltima actividad: hace ${fe}h`:`ltima actividad: ${P.toLocaleDateString()}`},v=e.filter(_=>_.is_active).length,x=v>0?"ACTIVO":"INACTIVO",C=v>0?"active":"inactive";return s.jsxs("div",{className:"bot-section",children:[s.jsxs("div",{className:"bot-section-header",children:[s.jsxs("div",{className:"bot-section-title-area",children:[s.jsx("div",{className:"bot-section-icon",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"bot-section-title",children:"Gestin de Bots"}),s.jsx("p",{className:"bot-section-subtitle",children:"Administra los flujos automatizados y el rendimiento tcnico."})]})]}),s.jsxs("div",{className:"bot-section-global-toggle",children:[s.jsx("span",{className:"bot-toggle-label",children:"ESTADO DEL BOT:"}),s.jsxs("div",{className:`bot-toggle-pill ${C}`,children:[s.jsx("span",{className:"bot-toggle-dot"}),s.jsx("span",{children:x})]})]})]}),l&&s.jsx("div",{className:"bot-error",children:l}),s.jsxs("div",{className:"bot-section-content",children:[s.jsxs("div",{className:"bot-flows-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MONITOREO DE FLUJOS"})}),a?s.jsx("div",{className:"bot-loading",children:"Cargando bots..."}):e.length===0?s.jsxs("div",{className:"bot-empty",children:[s.jsx("p",{children:"No hay bots asignados a tu cuenta."}),s.jsx("p",{className:"bot-empty-hint",children:"Contacta con soporte si necesitas activar un bot."})]}):s.jsx("div",{className:"bot-flows-list",children:e.map(_=>s.jsxs("div",{className:"bot-flow-card",children:[s.jsxs("div",{className:"bot-flow-info",children:[s.jsx("span",{className:"bot-flow-icon",children:_.flow_icon||""}),s.jsxs("div",{children:[s.jsx("div",{className:"bot-flow-name",children:_.flow_name}),s.jsxs("div",{className:`bot-flow-status ${_.is_active?"active":"inactive"}`,children:[" ",_.is_active?"ACTIVO":"INACTIVO"]})]})]}),s.jsx("div",{className:"bot-flow-actions",children:s.jsxs("label",{className:"bot-toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:_.is_active,onChange:()=>m(_.id,!_.is_active)}),s.jsx("span",{className:"bot-toggle-slider"})]})}),s.jsx("div",{className:"bot-flow-meta",children:N(_.updated_at)}),_.flow_description&&s.jsx("div",{className:"bot-flow-desc",children:_.flow_description})]},_.id))})]}),s.jsxs("div",{className:"bot-metrics-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MTRICAS DE EFICACIA DETALLADAS"})}),s.jsxs("div",{className:"bot-metrics-grid",children:[s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:`bot-metric-badge ${((L=n==null?void 0:n.interactions)==null?void 0:L.change)>=0?"positive":"neutral"}`,children:[((R=n==null?void 0:n.interactions)==null?void 0:R.change)>0?"+":"",(g=n==null?void 0:n.interactions)==null?void 0:g.change,"% ",(h=n==null?void 0:n.interactions)==null?void 0:h.label]}),s.jsx("div",{className:"bot-metric-label",children:"INTERACCIONES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.interactions.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"Total de sesiones iniciadas hoy"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge neutral",children:["Objetivo: ",(p=n==null?void 0:n.resolution)==null?void 0:p.target,"%"]}),s.jsx("div",{className:"bot-metric-label",children:"RESOLUCIN FINAL"}),s.jsxs("div",{className:"bot-metric-value",children:[n?n.resolution.value:"--","%"]}),s.jsx("div",{className:"bot-metric-progress",children:s.jsx("div",{className:"bot-metric-progress-fill",style:{width:`${n?n.resolution.value:0}%`}})})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge sla",children:[" ",(y=n==null?void 0:n.uptime)==null?void 0:y.status]}),s.jsx("div",{className:"bot-metric-label",children:"VIDA DEL PROCESO"}),s.jsx("div",{className:"bot-metric-value",children:n?n.uptime.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"UPTIME SISTEMA"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:`bot-metric-icon ${((k=n==null?void 0:n.errors)==null?void 0:k.value)>0?"error":""}`,children:""}),s.jsx("div",{className:`bot-metric-badge ${((D=n==null?void 0:n.errors)==null?void 0:D.value)===0?"stable":"neutral"}`,children:(z=n==null?void 0:n.errors)==null?void 0:z.status}),s.jsx("div",{className:"bot-metric-label",children:"ERRORES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.errors.value:"--"}),s.jsxs("div",{className:`bot-metric-sub ${((I=n==null?void 0:n.errors)==null?void 0:I.critical)>0?"error-sub":""}`,children:["CRTICOS: ",n?n.errors.critical:0]})]})]})]})]})]})}const lh={DRAFT:{bg:"#e3e8ef",text:"#475569",label:"BORRADOR"},PENDING:{bg:"#fef3c7",text:"#d97706",label:"PENDIENTE"},APPROVED:{bg:"#d1fae5",text:"#059669",label:"APROBADA"},REJECTED:{bg:"#fee2e2",text:"#dc2626",label:"RECHAZADA"},PAUSED:{bg:"#fef3c7",text:"#d97706",label:"PAUSADA"},DISABLED:{bg:"#e5e7eb",text:"#6b7280",label:"DESHABILITADA"}},hy=[{value:"UTILITY",label:"Utility"},{value:"MARKETING",label:"Marketing"},{value:"AUTHENTICATION",label:"Authentication"}],fy=[{value:"es",label:"Espaol (ES)"},{value:"en",label:"English (EN)"}];function py({templates:e=[],templateForm:t,setTemplateForm:n,handleTemplateSubmit:r,handleTemplateSubmitToMeta:a,handleTemplateDelete:i,handleSyncTemplates:l,onLoadTemplates:c,brandName:u=""}){var H;const m=(u||"PODOPIE").trim(),[N,v]=f.useState("list"),[x,C]=f.useState(null),[L,R]=f.useState(""),[g,h]=f.useState(!1),[p,y]=f.useState(""),[k,D]=f.useState(!1),[z,I]=f.useState(!1),[_,P]=f.useState(null),[M,K]=f.useState({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),[ue,fe]=f.useState([]);f.useEffect(()=>{c&&c()},[]);const He=async()=>{h(!0);try{await l()}finally{h(!1)}},_e=()=>{C(null),K({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),fe([]),v("editor")},Le=b=>{C(b),K({name:b.name||"",category:b.category||"UTILITY",language:b.language||"es",body_text:b.body_text||b.body_preview||"",header_type:b.header_type||"",header_content:b.header_content||"",footer_text:b.footer_text||"",buttons:b.buttons_json||[]}),fe(b.variable_mappings||[]),v("editor")},at=async b=>{!(b!=null&&b.id)||!i||!window.confirm(`Eliminar la plantilla "${b.name}"? Esta accin la ocultar localmente y la eliminar de Meta si aplica.`)||await i(b.id)},F=async b=>{b.preventDefault();const $={...M,id:x==null?void 0:x.id,variable_mappings:ue};if(n&&n($),r){const q=await r(null,$);q&&C(q)}},G=async()=>{if(a){D(!0);try{let b=x==null?void 0:x.id;if(!b){const $={...M,variable_mappings:ue},q=await r(null,$);b=q==null?void 0:q.id,q&&C(q)}b&&(await a(b),v("list"),C(null))}finally{D(!1)}}},te=()=>{v("list"),C(null)},se=b=>{const $=(b==null?void 0:b.buttons_json)??(b==null?void 0:b.buttons)??[];if(Array.isArray($))return $;if(typeof $=="string")try{const q=JSON.parse($);return Array.isArray(q)?q:[]}catch{return[]}return[]},be=(b=>{const $=b.match(/\{\{(\d+)\}\}/g)||[];return[...new Set($)].map(q=>parseInt(q.replace(/[{}]/g,"")))})(M.body_text),T=e.filter(b=>{var ie;const $=!L||((ie=b.name)==null?void 0:ie.toLowerCase().includes(L.toLowerCase()))||(b.body_text||b.body_preview||"").toLowerCase().includes(L.toLowerCase()),q=!p||b.status===p;return $&&q});return N==="list"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"templates-section",children:[s.jsxs("div",{className:"templates-header",children:[s.jsxs("div",{className:"templates-title-row",children:[s.jsx("h1",{children:"Plantillas de Meta"}),s.jsxs("span",{className:"meta-connected-badge",children:[s.jsx("span",{className:"status-dot"}),"CONECTADO A META API"]})]}),s.jsxs("div",{className:"templates-actions",children:[s.jsx("div",{className:"search-input-wrap",children:s.jsx("input",{type:"text",placeholder:"Buscar plantillas...",value:L,onChange:b=>R(b.target.value)})}),s.jsxs("select",{value:p,onChange:b=>y(b.target.value),className:"status-filter-select",children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"APPROVED",children:"Aprobadas"}),s.jsx("option",{value:"PENDING",children:"Pendientes"}),s.jsx("option",{value:"REJECTED",children:"Rechazadas"}),s.jsx("option",{value:"DRAFT",children:"Borradores"})]}),s.jsx("button",{className:"btn-sync",onClick:He,disabled:g,children:g?" Sincronizando...":" Sincronizar"}),s.jsxs("button",{className:"btn-create-template",onClick:_e,children:[s.jsx("span",{children:"+"})," Crear Nueva Plantilla"]})]})]}),s.jsxs("div",{className:"templates-grid",children:[T.map(b=>{var q;const $=lh[b.status]||lh.DRAFT;return s.jsxs("div",{className:"template-card",onClick:()=>Le(b),children:[s.jsxs("div",{className:"template-card-head",children:[s.jsx("div",{className:"template-category-icon",children:b.category==="MARKETING"?"":b.category==="UTILITY"?"":""}),s.jsx("span",{className:"template-status-badge",style:{backgroundColor:$.bg,color:$.text},children:$.label})]}),s.jsx("h3",{className:"template-card-name",children:b.name}),s.jsxs("div",{className:"template-card-meta",children:[s.jsx("span",{className:"tag-category",children:b.category}),s.jsx("span",{className:"tag-language",children:b.language==="es"?"ESPAOL (ES)":(q=b.language)==null?void 0:q.toUpperCase()})]}),(b.body_text||b.body_preview)&&s.jsxs("p",{className:"template-card-preview",children:[(b.body_text||b.body_preview).slice(0,80),"..."]}),s.jsxs("div",{className:"template-card-actions",children:[s.jsx("button",{className:"btn-preview",onClick:ie=>{ie.stopPropagation(),P(b),I(!0)},children:"Vista previa"}),s.jsx("button",{className:"btn-preview danger",onClick:ie=>{ie.stopPropagation(),at(b)},children:"Eliminar"})]})]},b.id)}),s.jsxs("div",{className:"template-card template-card-create",onClick:_e,children:[s.jsx("div",{className:"create-icon",children:"+"}),s.jsx("h3",{children:"Crear nueva plantilla"}),s.jsx("p",{children:"Empieza a disear tu flujo de WhatsApp"})]})]}),T.length===0&&!L&&s.jsx("div",{className:"templates-empty",children:s.jsx("p",{children:"No hay plantillas. Crea una nueva o sincroniza desde Meta."})})]}),z&&s.jsx("div",{className:"modal-overlay",onClick:()=>I(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:b=>b.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Vista previa"}),s.jsx("button",{className:"modal-close",onClick:()=>I(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:m}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(_==null?void 0:_.body_preview)||(_==null?void 0:_.body_text)||"Sin previsualizacin disponible."}),se(_).length>0&&s.jsx("div",{className:"preview-actions",children:se(_).map((b,$)=>s.jsx("button",{type:"button",children:b.text||b.label||b.title||`Botn ${$+1}`},`prev-${$}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})})]}):s.jsxs("div",{className:"template-editor",children:[s.jsxs("div",{className:"editor-header",children:[s.jsxs("div",{className:"editor-breadcrumb",children:[s.jsx("button",{className:"btn-back",onClick:te,children:" Volver"}),s.jsx("span",{className:"breadcrumb-sep",children:"/"}),s.jsx("span",{children:x?"Editar Plantilla":"Nueva Plantilla"})]}),s.jsxs("div",{className:"editor-actions",children:[s.jsx("button",{className:"btn-save-draft",onClick:F,children:" Guardar Borrador"}),((x==null?void 0:x.status)==="DRAFT"||(x==null?void 0:x.status)==="REJECTED"||!x)&&s.jsx("button",{className:"btn-primary",onClick:G,disabled:k||!M.name||!M.body_text,children:k?"Enviando...":"Enviar a Meta"}),s.jsx("button",{className:"btn-discard",onClick:te,children:" Descartar"})]})]}),s.jsxs("div",{className:"editor-layout",children:[s.jsxs("div",{className:"editor-form-panel",children:[s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" General Settings"}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Template Name"}),s.jsx("input",{type:"text",placeholder:"patient_appointment_reminder",value:M.name,onChange:b=>K({...M,name:b.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")})})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Category"}),s.jsx("select",{value:M.category,onChange:b=>K({...M,category:b.target.value}),children:hy.map(b=>s.jsx("option",{value:b.value,children:b.label},b.value))})]}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Language"}),s.jsx("select",{value:M.language,onChange:b=>K({...M,language:b.target.value}),children:fy.map(b=>s.jsx("option",{value:b.value,children:b.label},b.value))})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("div",{className:"form-section-header",children:[s.jsx("h3",{children:" Message Body"}),s.jsx("button",{className:"btn-insert-var",type:"button",onClick:()=>{const b=be.length+1;K({...M,body_text:M.body_text+`{{${b}}}`})},children:"+ Insert Variable"})]}),s.jsx("textarea",{rows:"6",placeholder:`Hola {{1}}, te recordamos tu cita en ${m} para el da {{2}} a las {{3}}. Por favor, confirma tu asistencia.`,value:M.body_text,onChange:b=>K({...M,body_text:b.target.value})}),s.jsxs("div",{className:"char-count",children:[M.body_text.length," / 1024"]})]})]}),s.jsxs("div",{className:"editor-preview-panel",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:m}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:M.body_text||"Tu mensaje aparecer aqu..."}),M.buttons&&M.buttons.length>0&&s.jsx("div",{className:"preview-actions",children:M.buttons.map((b,$)=>s.jsx("button",{type:"button",children:b.text||b.title||`Botn ${$+1}`},`btn-${$}`))}),s.jsx("div",{className:"preview-time",children:"10:42 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:M.name||"Sin nombre"})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Idioma"}),s.jsx("strong",{children:((H=M.language)==null?void 0:H.toUpperCase())||"ES"})]})]})]}),s.jsxs("div",{className:"editor-mapping-panel",children:[s.jsxs("div",{className:"mapping-tabs",children:[s.jsx("button",{className:"tab active",children:"VARIABLES"}),s.jsx("button",{className:"tab",children:"BUTTONS"})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsx("h4",{children:"ODOO FIELD MAPPING"}),be.length===0?s.jsxs("p",{className:"mapping-empty",children:["Agrega variables ","{{1}}",", ","{{2}}","... en tu mensaje"]}):be.map(b=>{const $=ue.find(q=>q.var_index===b)||{};return s.jsxs("div",{className:"mapping-item",children:[s.jsxs("div",{className:"mapping-var-badge",children:[`{{${b}}}`," Variable"]}),s.jsxs("select",{value:$.source_path||"",onChange:q=>{const ie=ue.filter(ce=>ce.var_index!==b);ie.push({var_index:b,source_type:"odoo",source_path:q.target.value}),fe(ie)},children:[s.jsx("option",{value:"",children:"Select Odoo Field..."}),s.jsx("option",{value:"partner_id.name",children:"patient_id.name"}),s.jsx("option",{value:"start_date",children:"start_date (Formatted)"}),s.jsx("option",{value:"start_time",children:"start_time"}),s.jsx("option",{value:"partner_id.phone",children:"patient_phone"})]}),s.jsx("span",{className:`mapping-status ${$.source_path?"linked":"needs"}`,children:$.source_path?" Linked":" Needs mapping"})]},b)})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsxs("div",{className:"mapping-section-header",children:[s.jsx("h4",{children:"ACTION BUTTONS"}),s.jsx("button",{className:"btn-add-button",onClick:()=>{K({...M,buttons:[...M.buttons||[],{type:"QUICK_REPLY",text:""}]})},children:"+ Add Button"})]}),(M.buttons||[]).map((b,$)=>s.jsxs("div",{className:"button-item",children:[s.jsx("span",{className:"button-icon",children:""}),s.jsx("input",{type:"text",placeholder:"Button text",value:b.text||"",onChange:q=>{const ie=[...M.buttons];ie[$]={...ie[$],text:q.target.value},K({...M,buttons:ie})}}),s.jsx("button",{className:"btn-remove",onClick:()=>{const q=M.buttons.filter((ie,ce)=>ce!==$);K({...M,buttons:q})},children:""})]},$))]}),s.jsxs("div",{className:"mapping-tip",children:[s.jsx("span",{className:"tip-icon",children:""}),s.jsx("span",{children:"Tip: Asegrate de que tus variables estn correctamente mapeadas a campos de Odoo antes de enviar."})]})]})]})]})}const oh={campaigns:"",users:"",bot:"",chat:"",templates:"",audience:"",system:""},my={"user.created":"USUARIO CREADO","user.updated":"USUARIO EDITADO","user.disabled":"USUARIO ELIMINADO",template_draft_created:"PLANTILLA CREADA",template_draft_updated:"PLANTILLA EDITADA",template_submitted:"PLANTILLA ENVIADA",template_deleted:"PLANTILLA ELIMINADA",template_restored:"PLANTILLA RESTAURADA",audience_created:"SEGMENTO CREADO",audience_updated:"SEGMENTO EDITADO",audience_deleted:"SEGMENTO ELIMINADO","campaign.created":"CAMPAA CREADA","campaign.queued":"CAMPAA EN COLA","campaign.sending":"CAMPAA LANZADA","settings.updated":"CONFIG ACTUALIZADA","role_permissions.updated":"PERMISOS CAMBIADOS","role_permissions.deleted":"ROL ELIMINADO","conversation.status_changed":"CHAT ACTUALIZADO","conversation.tag_added":"TAG AGREGADO","conversation.tag_removed":"TAG ELIMINADO"};function Gp(e){var r;const t=((r=e==null?void 0:e.data_json)==null?void 0:r.entity)||"";if(t==="template")return"templates";if(t==="audience")return"audience";if(t==="campaign")return"campaigns";if(t==="conversation")return"chat";const n=(e==null?void 0:e.action)||"";return n.includes("user")?"users":n.includes("campaign")?"campaigns":n.includes("template")?"templates":n.includes("audience")?"audience":n.includes("bot")?"bot":n.includes("conversation")?"chat":"system"}function Oo(e){if(!e)return{date:"--",time:"--"};const t=new Date(e);return Number.isNaN(t.getTime())?{date:"--",time:"--"}:{date:t.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}),time:t.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}}function gy(e,t="csv"){const r=[["timestamp","usuario","email","accion","modulo","data"].join(",")];e.forEach(m=>{var L,R;const N=((L=m.user)==null?void 0:L.name)||"Sistema",v=((R=m.user)==null?void 0:R.email)||"",x=Gp(m),C=[new Date(m.created_at).toISOString(),N,v,m.action,x,JSON.stringify(m.data_json||{})];r.push(C.map(g=>`"${String(g).replace(/"/g,'""')}"`).join(","))});const a=r.join(`
`),i=t==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv;charset=utf-8;",l=t==="excel"?"audit_logs.xlsx":"audit_logs.csv",c=new Blob([a],{type:i}),u=document.createElement("a");u.href=URL.createObjectURL(c),u.download=l,document.body.appendChild(u),u.click(),document.body.removeChild(u)}function vy(){var z,I;const[e,t]=f.useState(""),[n,r]=f.useState(""),[a,i]=f.useState(""),[l,c]=f.useState(1),[u]=f.useState(6),[m,N]=f.useState(0),[v,x]=f.useState([]),[C,L]=f.useState(!1),[R,g]=f.useState(null),h=Math.max(1,Math.ceil(m/u)),p=async({pageOverride:_}={})=>{L(!0);try{const P=new URLSearchParams;P.set("page",String(_||l)),P.set("page_size",String(u)),e.trim()&&P.set("q",e.trim()),n&&P.set("from",n),a&&P.set("to",a);const M=await pe(`/api/admin/audit?${P.toString()}`);x(M.logs||[]),N(M.total||0)}finally{L(!1)}};f.useEffect(()=>{p()},[l]);const y=()=>{c(1),p({pageOverride:1})},k=async(_="csv")=>{const P=new URLSearchParams;P.set("page","1"),P.set("page_size","1000"),e.trim()&&P.set("q",e.trim()),n&&P.set("from",n),a&&P.set("to",a);const M=await pe(`/api/admin/audit?${P.toString()}`);gy(M.logs||[],_)},D=f.useMemo(()=>{const _=[],P=Math.max(1,l-1),M=Math.min(h,P+2);for(let K=P;K<=M;K+=1)_.push(K);return _},[l,h]);return s.jsxs("div",{className:"audit-module",children:[s.jsxs("div",{className:"audit-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-title",children:"Registros / Auditoria"}),s.jsx("div",{className:"audit-subtitle",children:"Monitorea acciones de usuarios y eventos del sistema"})]}),s.jsxs("div",{className:"audit-export-group",children:[s.jsx("button",{className:"audit-export",type:"button",onClick:()=>k("excel"),children:" Exportar Excel"}),s.jsx("button",{className:"audit-export outline",type:"button",onClick:()=>k("csv"),children:" Exportar CSV"})]})]}),s.jsxs("div",{className:"audit-filters",children:[s.jsxs("div",{className:"audit-search",children:[s.jsx("span",{className:"audit-search-icon"}),s.jsx("input",{type:"text",placeholder:"Filtrar por usuario o accion..",value:e,onChange:_=>t(_.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Desde"}),s.jsx("input",{type:"date",value:n,onChange:_=>r(_.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Hasta"}),s.jsx("input",{type:"date",value:a,onChange:_=>i(_.target.value)})]}),s.jsx("button",{className:"audit-filter-btn",type:"button",onClick:y,children:"Filtrar"})]}),s.jsxs("div",{className:"audit-card",children:[s.jsxs("div",{className:"audit-table-head",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("span",{children:"Usuario"}),s.jsx("span",{children:"Accion"}),s.jsx("span",{children:"Modulo"})]}),C&&s.jsx("div",{className:"audit-empty",children:"Cargando registros..."}),!C&&!v.length&&s.jsx("div",{className:"audit-empty",children:"Sin registros para mostrar"}),!C&&v.map(_=>{var He,_e;const P=Oo(_.created_at),M=Gp(_),K=my[_.action]||_.action,ue=((He=_.user)==null?void 0:He.name)||"System Bot",fe=((_e=_.user)==null?void 0:_e.email)||"automated@service";return s.jsxs("button",{type:"button",className:"audit-row",onClick:()=>g(_),children:[s.jsxs("div",{className:"audit-cell time",children:[s.jsx("div",{children:P.date}),s.jsx("div",{className:"audit-time",children:P.time})]}),s.jsxs("div",{className:"audit-cell user",children:[s.jsx("div",{className:"audit-avatar",children:(ue==null?void 0:ue[0])||"S"}),s.jsxs("div",{children:[s.jsx("div",{className:"audit-user-name",children:ue}),s.jsx("div",{className:"audit-user-email",children:fe})]})]}),s.jsx("div",{className:"audit-cell action",children:s.jsx("span",{className:"audit-action-pill",children:K})}),s.jsxs("div",{className:"audit-cell module",children:[s.jsx("span",{className:"audit-module-icon",children:oh[M]||oh.system}),M.charAt(0).toUpperCase()+M.slice(1)]})]},_.id)})]}),s.jsxs("div",{className:"audit-footer",children:[s.jsxs("div",{children:["Mostrando ",v.length," de ",m," registros"]}),s.jsxs("div",{className:"audit-pagination",children:[s.jsx("button",{type:"button",disabled:l<=1,onClick:()=>c(_=>Math.max(1,_-1)),children:""}),D.map(_=>s.jsx("button",{type:"button",className:_===l?"active":"",onClick:()=>c(_),children:_},_)),s.jsx("button",{type:"button",disabled:l>=h,onClick:()=>c(_=>Math.min(h,_+1)),children:""})]})]}),R&&s.jsx("div",{className:"audit-modal",children:s.jsxs("div",{className:"audit-modal-card",children:[s.jsxs("div",{className:"audit-modal-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-modal-title",children:"Detalle del registro"}),s.jsx("div",{className:"audit-modal-subtitle",children:R.action})]}),s.jsx("button",{type:"button",onClick:()=>g(null),children:""})]}),s.jsxs("div",{className:"audit-modal-body",children:[s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Usuario"}),s.jsx("strong",{children:((z=R.user)==null?void 0:z.name)||"System Bot"}),s.jsx("small",{children:((I=R.user)==null?void 0:I.email)||"automated@service"})]}),s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("strong",{children:Oo(R.created_at).date}),s.jsx("small",{children:Oo(R.created_at).time})]}),s.jsxs("div",{className:"audit-detail full",children:[s.jsx("span",{children:"Data"}),s.jsx("pre",{children:JSON.stringify(R.data_json||{},null,2)})]})]})]})})]})}function xy(){return s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Integracion Odoo"}),s.jsx("div",{className:"empty-state",children:"Seccion en construccion"})]})}function yy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("line",{x1:"4",y1:"6",x2:"20",y2:"6",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"6",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"18",x2:"20",y2:"18",strokeWidth:"2"}),s.jsx("circle",{cx:"11",cy:"18",r:"2",strokeWidth:"2"})]})}function jy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"9",cy:"8",r:"3",strokeWidth:"2"}),s.jsx("path",{d:"M4 20c0-3 2.7-5.5 6-5.5s6 2.5 6 5.5",strokeWidth:"2"}),s.jsx("circle",{cx:"17",cy:"9",r:"2",strokeWidth:"2"}),s.jsx("path",{d:"M14 20c0-1.8 1.4-3.4 3.2-4",strokeWidth:"2"})]})}function Ny(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"2"})]})}function wy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"4",width:"12",height:"16",rx:"2",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"9",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"13",x2:"15",y2:"13",strokeWidth:"2"})]})}function _y(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"5",width:"12",height:"15",rx:"2",strokeWidth:"2"}),s.jsx("path",{d:"M9 5h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 10h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 14h6",strokeWidth:"2"})]})}function Sy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M8 4h4a2 2 0 1 1 0 4h-1v2h2a2 2 0 1 1 0 4h-2v2H8a2 2 0 1 1-4 0V8a2 2 0 1 1 4 0z",strokeWidth:"2"})})}function ky({settingsSection:e,setSettingsSection:t,settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,currentRole:l,isAdmin:c,adminUsers:u,userForm:m,setUserForm:N,roleOptions:v,handleUserSubmit:x,settings:C,setSettings:L,handleSaveSettings:R,branches:g,services:h,branchForm:p,setBranchForm:y,handleBranchSubmit:k,handleBranchDisable:D,serviceForm:z,setServiceForm:I,handleServiceSubmit:_,handleServiceDisable:P,handleServiceBranchToggle:M,templates:K,templateForm:ue,setTemplateForm:fe,handleTemplateSubmit:He,handleTemplateSubmitToMeta:_e,handleTemplateDelete:Le,handleSyncTemplates:at,auditLogs:F,formatDate:G,planName:te,tenantChannels:se,channelForm:de,setChannelForm:be,handleChannelSelect:T,handleChannelSubmit:H,handleUserDelete:b,defaultRolePermissions:$,handleRoleDelete:q,useShellLayout:ie=!1,pageError:ce,isOffline:ge=!1,onDismissError:Ke,brandName:ct=""}){const et=a==null?void 0:a[l],ve=[{title:"Principal",items:[{id:"general",label:"General",icon:yy},{id:"users",label:"Gestion de Usuarios",icon:jy},{id:"bot",label:"Configuracion de Bot",icon:Ny}]},{title:"Canales e Integraciones",items:[{id:"templates",label:"Plantillas de Meta",icon:wy},{id:"audit",label:"Registros / Auditoria",icon:_y},{id:"odoo",label:"Integracion Odoo",icon:Sy}]}];function vt(Ge){var ze,Qe;return!!((Qe=(ze=et==null?void 0:et.settings)==null?void 0:ze[Ge])!=null&&Qe.read)}function tt(Ge){vt(Ge)&&t(Ge)}const xt=s.jsxs(s.Fragment,{children:[s.jsxs("aside",{className:"settings-sidebar",children:[s.jsxs("div",{className:"settings-header",children:[s.jsx("div",{className:"settings-title",children:"CONFIGURACION"}),s.jsxs("div",{className:"settings-version",children:[(ct||"Empresa").toUpperCase()," OS V2.0"]})]}),ve.map(Ge=>s.jsxs("div",{className:"settings-group",children:[s.jsx("div",{className:"settings-group-title",children:Ge.title}),s.jsx("div",{className:"settings-group-list",children:Ge.items.map(ze=>{const Qe=!vt(ze.id),yt=ze.icon;return s.jsxs("button",{className:`settings-item ${e===ze.id?"active":""}`,type:"button",onClick:()=>tt(ze.id),disabled:Qe,children:[s.jsx("span",{className:"settings-icon","aria-hidden":"true",children:s.jsx(yt,{className:"settings-icon-svg"})}),ze.label]},ze.id)})})]},Ge.title)),s.jsxs("div",{className:"settings-plan",children:[s.jsx("div",{className:"settings-plan-label",children:"Plan actual"}),s.jsx("div",{className:"settings-plan-name",children:te||"Sin plan"})]})]}),s.jsxs("div",{className:"settings-content",children:[e==="users"&&s.jsx(cy,{settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,isAdmin:c,adminUsers:u,userForm:m,setUserForm:N,roleOptions:v,handleUserSubmit:x,handleUserDelete:b,defaultRolePermissions:$,handleRoleDelete:q}),e==="general"&&s.jsx(uy,{branches:g,branchForm:p,setBranchForm:y,handleBranchSubmit:k,handleBranchDisable:D,services:h,serviceForm:z,setServiceForm:I,handleServiceSubmit:_,handleServiceDisable:P,handleServiceBranchToggle:M,tenantChannels:se,channelForm:de,setChannelForm:be,handleChannelSelect:T,handleChannelSubmit:H}),e==="bot"&&s.jsx(dy,{settings:C,setSettings:L,handleSaveSettings:R}),e==="templates"&&s.jsx(py,{templates:K,templateForm:ue,setTemplateForm:fe,handleTemplateSubmit:He,handleTemplateSubmitToMeta:_e,handleTemplateDelete:Le,handleSyncTemplates:at,brandName:ct}),e==="audit"&&s.jsx(vy,{auditLogs:F,formatDate:G}),e==="odoo"&&s.jsx(xy,{}),ge?s.jsx(ka,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):ce?s.jsx(ka,{variant:"error",title:"Ocurri un problema",message:ce,dismissLabel:"Cerrar",onDismiss:Ke}):null]})]});return ie?xt:s.jsx("section",{className:"settings-layout",children:xt})}function by(){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"1.8"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"1.8"})]})}function Cy({tenantId:e,tenantBots:t,availableFlows:n,loading:r,onAddBot:a,onRemoveBot:i}){const[l,c]=f.useState(""),u=new Set(t.map(v=>v.flow_id)),m=n.filter(v=>!u.has(v.id));function N(){l&&(a(l),c(""))}return s.jsxs("section",{className:"sa-bot-card","data-tenant":e||"",children:[s.jsxs("header",{className:"sa-bot-header",children:[s.jsx("div",{className:"sa-bot-icon-large","aria-hidden":"true",children:s.jsx(by,{})}),s.jsxs("div",{className:"sa-bot-title-group",children:[s.jsx("h3",{children:"Asignacion de Bots"}),s.jsx("p",{children:"Selecciona que flujos estaran disponibles para este cliente. Los flujos asignados apareceran inmediatamente en el panel del usuario."})]})]}),s.jsx("div",{className:"sa-bot-body",children:r?s.jsx("div",{className:"sa-bot-loading",children:"Cargando asignaciones..."}):t.length===0?s.jsxs("div",{className:"sa-bot-empty",children:[s.jsx("div",{className:"sa-bot-empty-icon",children:"+"}),s.jsx("div",{className:"sa-bot-empty-title",children:"Sin bots asignados"}),s.jsx("div",{className:"sa-bot-empty-sub",children:"Agrega un flujo desde el selector para activarlo en este tenant."})]}):s.jsx("div",{className:"sa-bot-grid",children:t.map(v=>s.jsxs("div",{className:"sa-assigned-bot",children:[s.jsx("div",{className:"sa-bot-item-icon",children:v.flow_icon||">"}),s.jsxs("div",{className:"sa-bot-item-info",children:[s.jsx("span",{className:"sa-bot-item-name",children:v.flow_name||v.flow_id}),s.jsx("span",{className:"sa-bot-item-desc",children:v.flow_description||"Sin descripcion"})]}),s.jsx("button",{type:"button",className:"sa-btn-remove",title:"Quitar bot del cliente",onClick:()=>i(v.id),children:"Quitar"})]},v.id))})}),s.jsxs("div",{className:"sa-bot-controls",children:[s.jsxs("div",{className:"sa-select-container",children:[s.jsx("label",{className:"sa-select-label",children:"Asignar bot"}),s.jsxs("select",{className:"sa-select-styled",value:l,onChange:v=>c(v.target.value),disabled:m.length===0,children:[s.jsx("option",{value:"",children:m.length===0?"No hay mas bots disponibles":"Selecciona un bot para asignar"}),m.map(v=>s.jsx("option",{value:v.id,children:v.name},v.id))]})]}),s.jsx("button",{type:"button",className:"sa-btn-assign",onClick:N,disabled:!l,children:"Asignar Bot"})]})]})}const Jt={name:"",slug:"",plan:"",db_url:"",phone_number_id:"",line_name:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",brand_name:"",logo_url:"",brand_primary:"#22d3ee",brand_accent:"#38bdf8",brand_bg:"#0b0f16",timezone:"",odoo_base_url:"",odoo_db_name:"",odoo_username:"",odoo_password:""},Ey=[{value:"starter",label:"Starter"},{value:"growth",label:"Growth"},{value:"scale",label:"Scale"},{value:"enterprise",label:"Enterprise"}];function Ty(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"4",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"4",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"})]})}function Dc(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ay(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"3.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M19 12a7 7 0 0 0-.1-1.2l2-1.5-2-3.5-2.4.7a7.2 7.2 0 0 0-2-1.2L12 2 9.5 4.3a7.2 7.2 0 0 0-2 1.2l-2.4-.7-2 3.5 2 1.5A7 7 0 0 0 5 12c0 .4 0 .8.1 1.2l-2 1.5 2 3.5 2.4-.7a7.2 7.2 0 0 0 2 1.2L12 22l2.5-2.3a7.2 7.2 0 0 0 2-1.2l2.4.7 2-3.5-2-1.5c.1-.4.1-.8.1-1.2Z",strokeWidth:"1.2",strokeLinejoin:"round"})]})}function Ly(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M16.5 16.5 20 20",strokeWidth:"1.6",strokeLinecap:"round"})]})}function Ry(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 12h12",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m13 6 6 6-6 6",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Oy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M18 6 6 18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m6 6 12 12",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Py(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56",strokeWidth:"1.8",strokeLinecap:"round"})})}function ch(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"1.8",strokeLinecap:"round"})]})}function uh(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m2 2 20 20",strokeWidth:"1.8",strokeLinecap:"round"})]})}function My(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 18h.01",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Dy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m15 5 4 4",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Iy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M3 6h18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",strokeWidth:"1.8",strokeLinecap:"round"})]})}const dh={display_name:"",phone_number_id:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",is_active:!0,is_default:!1};function By({isOpen:e,onClose:t,initialData:n,onSave:r,tenantId:a}){const[i,l]=f.useState(dh),[c,u]=f.useState(!1),[m,N]=f.useState(!1),[v,x]=f.useState(!1),[C,L]=f.useState(null);if(f.useEffect(()=>{e&&(l(n||{...dh}),L(null))},[e,n]),!e)return null;const R=async g=>{if(g.preventDefault(),x(!0),L(null),!i.phone_number_id||!i.verify_token||!n&&!i.wa_token){L("Los campos ID de Telfono, Verify Token y Access Token son obligatorios."),x(!1);return}try{await r({...i,tenant_id:a}),t()}catch(h){console.error("Error saving channel:",h),L(h.message||"Error al guardar la lnea.")}finally{x(!1)}};return s.jsx("div",{className:"sa-modal-overlay",onClick:t,children:s.jsxs("div",{className:"sa-modal-content",onClick:g=>g.stopPropagation(),children:[s.jsxs("div",{className:"sa-modal-header",children:[s.jsx("div",{className:"sa-modal-title",children:n?"Editar Lnea WhatsApp":"Nueva Lnea WhatsApp"}),s.jsx("button",{className:"sa-modal-close",onClick:t,children:s.jsx(Oy,{width:24,height:24})})]}),s.jsxs("div",{className:"sa-modal-body",children:[C&&s.jsx("div",{className:"sa-alert",style:{marginBottom:"1rem"},children:C}),s.jsxs("div",{className:"sa-form-grid",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre para mostrar (Opcional)"}),s.jsx("input",{value:i.display_name||"",onChange:g=>l({...i,display_name:g.target.value}),placeholder:"Ej: Ventas Principal"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Phone Number ID *"}),s.jsx("input",{value:i.phone_number_id||"",onChange:g=>l({...i,phone_number_id:g.target.value}),placeholder:"Identificador del nmero de telfono"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"WABA ID (WhatsApp Business Account ID)"}),s.jsx("input",{value:i.waba_id||"",onChange:g=>l({...i,waba_id:g.target.value}),placeholder:"Identificador de la cuenta de WhatsApp Business"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Verify Token (Webhook) *"}),s.jsx("input",{value:i.verify_token||"",onChange:g=>l({...i,verify_token:g.target.value}),placeholder:"Token de verificacin webhook"})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"Permanent Access Token *"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:c?"text":"password",value:i.wa_token||"",onChange:g=>l({...i,wa_token:g.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"Token de acceso permanente",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>u(!c),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:c?s.jsx(uh,{width:18,height:18}):s.jsx(ch,{width:18,height:18})})]})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"App Secret (Opcional)"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:m?"text":"password",value:i.app_secret||"",onChange:g=>l({...i,app_secret:g.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"App Secret de Meta",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>N(!m),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:m?s.jsx(uh,{width:18,height:18}):s.jsx(ch,{width:18,height:18})})]})]})]}),s.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"2rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_active,onChange:g=>l({...i,is_active:g.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Activa"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_default,onChange:g=>l({...i,is_default:g.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Principal (Por Defecto)"]})]})]}),s.jsxs("div",{className:"sa-modal-footer",children:[s.jsx("button",{className:"sa-btn ghost",onClick:t,disabled:v,children:"Cancelar"}),s.jsx("button",{className:"sa-btn primary",onClick:R,disabled:v,children:v?s.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(Py,{width:16,height:16,className:"animate-spin"})," Guardando..."]}):"Guardar Lnea"})]})]})})}function zy({channels:e=[],tenantId:t,onRefresh:n}){const[r,a]=f.useState(!1),[i,l]=f.useState(null),c=()=>{l(null),a(!0)},u=v=>{l(v),a(!0)},m=async v=>{i?await Xe(`/api/superadmin/channels/${i.id}`,v):await Ne("/api/superadmin/channels",v),await n()},N=async v=>{if(confirm("Ests seguro de que deseas eliminar esta lnea? Esta accin no se puede deshacer."))try{await kn(`/api/superadmin/channels/${v}`),await n()}catch(x){console.error("Error deleting channel:",x),alert("No se pudo eliminar la lnea.")}};return s.jsxs("section",{className:"sa-lines-card",children:[s.jsxs("header",{className:"sa-lines-header",children:[s.jsxs("div",{className:"sa-lines-title",children:[s.jsx("div",{className:"sa-lines-icon",children:s.jsx(My,{width:24,height:24})}),s.jsxs("div",{children:[s.jsx("h3",{children:"Lneas de WhatsApp Cloud"}),s.jsx("p",{children:"Gestiona las conexiones activas de WhatsApp para este tenant."})]})]}),s.jsxs("button",{className:"sa-btn primary",onClick:c,children:[s.jsx(Dc,{width:16,height:16,style:{marginRight:"0.5rem"}}),"Agregar Nueva Lnea"]})]}),s.jsx("div",{className:"sa-lines-body",children:s.jsxs("div",{className:"sa-lines-grid",children:[e.map(v=>s.jsxs("div",{className:`sa-line-card ${v.is_active?"":"opacity-75"}`,children:[s.jsxs("div",{className:"sa-line-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-line-name",children:v.display_name||"Sin nombre"}),s.jsxs("div",{className:"sa-line-meta",children:["ID: ",v.phone_number_id]})]}),s.jsx("div",{className:`sa-line-status ${v.is_active?"active":""}`,title:v.is_active?"Activo":"Inactivo"})]}),s.jsxs("div",{className:"sa-line-badges",children:[v.is_default&&s.jsx("span",{className:"sa-line-badge default",children:"DEFAULT"}),!v.is_active&&s.jsx("span",{className:"sa-status warn",children:"INACTIVO"})]}),s.jsxs("div",{className:"sa-line-details",children:[s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"WABA ID"}),s.jsx("span",{className:"sa-detail-value",children:v.waba_id||"-"})]}),s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"Verify Token"}),s.jsx("span",{className:"sa-detail-value",children:v.verify_token?`${v.verify_token.substring(0,16)}...`:"-"})]})]}),s.jsxs("div",{className:"sa-line-actions",children:[s.jsx("button",{className:"sa-btn ghost",onClick:()=>u(v),title:"Editar",children:s.jsx(Dy,{width:16,height:16})}),s.jsx("button",{className:"sa-btn ghost",onClick:()=>N(v.id),title:"Eliminar",style:{color:"#f87171"},children:s.jsx(Iy,{width:16,height:16})})]})]},v.id)),s.jsxs("button",{type:"button",className:"sa-line-add-card",onClick:c,children:[s.jsx("div",{className:"sa-add-icon-circle",children:s.jsx(Dc,{width:24,height:24})}),s.jsx("span",{children:"Nueva Conexin"})]})]})}),s.jsx(By,{isOpen:r,onClose:()=>a(!1),initialData:i,onSave:m,tenantId:t})]})}function hh({route:e="/superadmin",onNavigate:t,onImpersonateTenant:n,onLogout:r=()=>{}}){const[a,i]=f.useState([]),[l,c]=f.useState([]),[u,m]=f.useState([]),[N,v]=f.useState(""),[x,C]=f.useState(""),[L,R]=f.useState("Verificacion de red: sistema ok"),[g,h]=f.useState(Jt),[p,y]=f.useState(!1),[k,D]=f.useState(!1),[z,I]=f.useState(""),[_,P]=f.useState(""),[M,K]=f.useState(!0),[ue,fe]=f.useState(Jt),[He,_e]=f.useState(!0),[Le,at]=f.useState(!1),F=f.useRef(""),[G,te]=f.useState([]),[se,de]=f.useState([]),[be,T]=f.useState(!1),{pushToast:H}=Du(),b=f.useMemo(()=>{if(!e)return"";const S=e.match(/^\/superadmin\/tenants\/([^/]+)\/?$/)||e.match(/^\/superadmin\/tenant\/([^/]+)\/?$/)||e.match(/^\/superadmin\/edit\/([^/]+)\/?$/);return S?S[1]:""},[e]),$=e.startsWith("/superadmin/new"),q=!!b,ie=$||q,ce=f.useCallback(S=>{if(t){t(S,{replace:!1});return}typeof window>"u"||window.history.pushState({},"",S)},[t]);async function ge(){try{const S=await pe("/api/superadmin/tenants");i(S.tenants||[]);const U=await pe("/api/superadmin/channels");c(U.channels||[]),C("")}catch(S){C(S.message||"No se pudo cargar datos.")}}f.useEffect(()=>{ge(),$e()},[]),f.useMemo(()=>{const S=new Map;return l.forEach(U=>{const Q=S.get(U.tenant_id)||0;S.set(U.tenant_id,Q+1)}),S},[l]);const Ke=f.useMemo(()=>{const S=N.trim().toLowerCase();return S?a.filter(U=>{const Q=String(U.name||"").toLowerCase(),re=String(U.slug||"").toLowerCase(),ye=String(U.id||"").toLowerCase();return Q.includes(S)||re.includes(S)||ye.includes(S)}):a.slice()},[a,N]),ct=a.length,et=a.filter(S=>S.is_active).length;a.filter(S=>S.has_database).length;const ve=a.filter(S=>S.has_odoo).length,vt=ct?Math.round(ve/ct*100):0;function tt(S){if(!S)return"--";const U=new Date(S);return Number.isNaN(U.getTime())?"--":U.toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"2-digit"})}function xt(S){return 10+Math.abs(Array.from(S).reduce((re,ye)=>re+ye.charCodeAt(0),0))%70}function Ge(){h(Jt),fe(Jt),P(""),K(!0),_e(!0),de([]),m([]),R("Verificacion de red: sistema ok"),F.current=""}function ze(){Ge(),C(""),ce("/superadmin/new")}function Qe(){F.current="",ce("/superadmin")}async function yt(S){if(n)try{C(""),I(S),await n(S)}catch(U){C(U.message||"No se pudo entrar al tenant.")}finally{I("")}}function ut(S){const U={};return Object.keys(Jt).forEach(Q=>{const re=S[Q];U[Q]=typeof re=="string"?re.trim():re||""}),{...Jt,...U}}async function je(S){if(S){F.current=S,P(S),h(Jt),fe(Jt),K(!0),_e(!0),de([]),m([]),at(!0),C("");try{const U=await pe(`/api/superadmin/tenants/${S}/details`);if(F.current!==S)return;const Q=U.tenant||{},re=U.branding||null,ye=U.odoo||null,Qt=U.database||null,Ue=U.channel||null;m(U.channels||[]);const bt=(re==null?void 0:re.colors)||{},Pn=ut({...Jt,name:Q.name||"",slug:Q.slug||"",plan:Q.plan||"",db_url:(Qt==null?void 0:Qt.db_url)||"",brand_name:(re==null?void 0:re.brand_name)||"",logo_url:(re==null?void 0:re.logo_url)||"",brand_primary:(bt==null?void 0:bt.primary)||Jt.brand_primary,brand_accent:(bt==null?void 0:bt.accent)||Jt.brand_accent,brand_bg:(bt==null?void 0:bt.bg)||Jt.brand_bg,odoo_base_url:(ye==null?void 0:ye.base_url)||"",odoo_db_name:(ye==null?void 0:ye.db_name)||"",odoo_username:(ye==null?void 0:ye.username)||"",odoo_password:(ye==null?void 0:ye.password)||""});h(Pn),fe(Pn),P(Q.id||S),K(!!Q.is_active),_e(!!Q.is_active),R("Modo edicion: cambios pendientes"),await ln(S)}catch(U){C(U.message||"No se pudo cargar tenant.")}finally{at(!1)}}}async function Yn(S){if(S)try{const U=await pe(`/api/superadmin/tenants/${S}/details`);if(_&&_!==S)return;m(U.channels||[])}catch(U){console.error("Error loading tenant channels",U)}}async function $e(){try{const S=await pe("/api/superadmin/flows");te(S.flows||[])}catch(S){console.error("Error loading flows",S)}}async function ln(S){if(S){T(!0);try{const U=await pe(`/api/superadmin/tenant-bots?tenant_id=${S}`);de(U.tenant_bots||[])}catch(U){console.error("Error loading tenant bots",U)}finally{T(!1)}}}async function De(S,U){try{await Xe(`/api/superadmin/tenant-bots/${S}`,{is_active:U}),de(Q=>Q.map(re=>re.id===S?{...re,is_active:U}:re))}catch(Q){C(Q.message||"Error al cambiar estado del bot.")}}async function W(S){if(_)try{const U=await Ne("/api/superadmin/tenant-bots",{tenant_id:_,flow_id:S});U.tenant_bot&&(de(Q=>[U.tenant_bot,...Q]),H({message:"Bot agregado correctamente"}))}catch(U){C(U.message||"Error al agregar bot."),H({type:"error",message:U.message||"Error al agregar bot"})}}async function we(S){const U=se.find(Q=>Q.id===S);try{await kn(`/api/superadmin/tenant-bots/${S}`),de(Q=>Q.filter(re=>re.id!==S)),H({message:"Bot eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{if(!U)return;const Q=await Ne("/api/superadmin/tenant-bots",{tenant_id:U.tenant_id,flow_id:U.flow_id});Q!=null&&Q.tenant_bot&&U.is_active===!1&&await Xe(`/api/superadmin/tenant-bots/${Q.tenant_bot.id}`,{is_active:!1}),await ln(_),H({message:"Bot restaurado"})}catch(Q){H({type:"error",message:(Q==null?void 0:Q.message)||"No se pudo restaurar el bot"})}}})}catch(Q){C(Q.message||"Error al eliminar bot."),H({type:"error",message:Q.message||"Error al eliminar bot"})}}async function Ae(S){C(""),ce(`/superadmin/tenants/${S.id}`)}async function A(){await ge(),_&&await Yn(_)}function Se(){const S=g.name.trim(),U=g.slug.trim(),Q=g.db_url.trim();return!S||!U?{ok:!1,message:"Nombre y subdominio son requeridos."}:!_&&!Q?{ok:!1,message:"Tenant DB URL es requerido."}:(g.brand_name.trim()||g.logo_url.trim()||g.brand_primary||g.brand_accent||g.brand_bg)&&!g.brand_name.trim()?{ok:!1,message:"Brand name es requerido."}:(g.odoo_base_url||g.odoo_db_name||g.odoo_username||g.odoo_password)&&(!g.odoo_base_url||!g.odoo_db_name||!g.odoo_username||!_&&!g.odoo_password)?{ok:!1,message:"Odoo incompleto: base_url, db_name, username, password."}:{ok:!0}}function xn(S){if(!S)return"Verificacion completada";const U=[];if(S.database){const Q=S.database.ok?"DB ok":"DB error",re=typeof S.database.latency_ms=="number"?` (${S.database.latency_ms}ms)`:"";U.push(`${Q}${re}`)}if(S.odoo){const Q=S.odoo.ok?"Odoo ok":"Odoo error",re=typeof S.odoo.latency_ms=="number"?` (${S.odoo.latency_ms}ms)`:"";U.push(`${Q}${re}`)}return U.length?`Verificacion completada: ${U.join(" | ")}`:"Verificacion completada"}function Ln(S){if(S!=null&&S.database&&!S.database.ok){const U=S.database.details||S.database.error;return Rn(U||"Error en DB")}if(S!=null&&S.odoo&&!S.odoo.ok){const U=S.odoo.details||S.odoo.error;return Rn(U||"Error en Odoo")}return"No se pudo validar conexion"}function Rn(S){const U=(S||"").toString(),Q=U.toLowerCase();return Q.includes("missing")?"Completa los campos de Odoo":Q.includes("db_connection_failed")?"No se pudo conectar a la base de datos":Q.includes("odoo")&&Q.includes("failed")?"No se pudo autenticar en Odoo":U||"No se pudo validar conexion"}async function yn(){const S=Se();if(!S.ok){R(S.message);return}y(!0),R("Verificando conexion...");try{const U=await Ne("/api/superadmin/tenants/validate",{db_url:g.db_url.trim(),odoo_base_url:g.odoo_base_url.trim(),odoo_db_name:g.odoo_db_name.trim(),odoo_username:g.odoo_username.trim(),odoo_password:g.odoo_password.trim()}),Q=xn(U.checks);R(Q),U.ok?H({message:Q}):H({type:"error",message:Ln(U.checks)})}catch(U){R("Error validando conexion"),H({type:"error",message:U.message||"No se pudo validar conexion"})}finally{y(!1)}}async function On(S){var Q;if(S.preventDefault(),q&&!on)return;const U=Se();if(!U.ok){C(U.message);return}try{D(!0),C("");let re=_;if(re?await Xe(`/api/superadmin/tenants/${re}`,{name:g.name.trim(),slug:g.slug.trim(),plan:g.plan.trim(),is_active:M}):re=(Q=(await Ne("/api/superadmin/tenants",{name:g.name.trim(),slug:g.slug.trim(),plan:g.plan.trim()})).tenant)==null?void 0:Q.id,!re)throw new Error("tenant_not_ready");if(g.db_url.trim()&&await Ne(`/api/superadmin/tenants/${re}/database`,{db_url:g.db_url.trim()}),(g.brand_name.trim()||g.logo_url.trim())&&await Xe("/api/superadmin/branding",{tenant_id:re,brand_name:g.brand_name.trim(),logo_url:g.logo_url.trim()||null,colors:null}),g.odoo_base_url||g.odoo_db_name||g.odoo_username||g.odoo_password){const Ue={tenant_id:re,base_url:g.odoo_base_url.trim(),db_name:g.odoo_db_name.trim(),username:g.odoo_username.trim()};g.odoo_password.trim()&&(Ue.password=g.odoo_password.trim()),await Xe("/api/superadmin/odoo",Ue)}if(await ge(),_){const Ue=ut(g);h(Ue),fe(Ue),_e(M),R("Cambios guardados"),H({message:"Tenant actualizado correctamente"})}else Ge(),H({message:"Tenant creado correctamente"})}catch(re){C(re.message||"No se pudo guardar tenant."),H({type:"error",message:re.message||"No se pudo guardar tenant"})}finally{D(!1)}}async function jn(){if(!_)return;const S=!M;try{D(!0),C(""),await Xe(`/api/superadmin/tenants/${_}`,{is_active:S}),K(S),_e(S),R(S?"Tenant reactivado":"Tenant bloqueado"),await ge()}catch(U){C(U.message||"No se pudo cambiar estado del tenant.")}finally{D(!1)}}const on=f.useMemo(()=>!_&&!q||M!==He?!0:Object.keys(ue).some(S=>{const U=String(g[S]??""),Q=String(ue[S]??"");return U!==Q}),[He,ue,M,_,q,g]);return f.useEffect(()=>{if(q&&b&&b!==_){je(b);return}$&&(_||Le)&&Ge()},[Le,_,$,q,b]),s.jsxs("div",{className:"sa-shell",children:[s.jsxs("aside",{className:"sa-rail",children:[s.jsx("div",{className:"sa-rail-logo",children:"PRZV"}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${ie?"":"active"}`,onClick:Qe,children:[s.jsx(Ty,{className:"sa-rail-icon"}),s.jsx("span",{children:"Dashboard"})]}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${$?"active":""}`,onClick:ze,children:[s.jsx(Dc,{className:"sa-rail-icon"}),s.jsx("span",{children:"Nuevo"})]}),s.jsxs("button",{type:"button",className:"sa-rail-btn",children:[s.jsx(Ay,{className:"sa-rail-icon"}),s.jsx("span",{children:"Ajustes"})]}),s.jsxs("div",{className:"sa-rail-footer",children:[s.jsx("div",{className:"sa-avatar",children:"SA"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-role",children:"Superadmin"}),s.jsx("div",{className:"sa-meta",children:"Control plane"})]})]})]}),s.jsxs("main",{className:"sa-main",children:[!ie&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-topbar",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-kicker",children:"Panel de control Perzivalh"}),s.jsxs("div",{className:"sa-title",children:["Sistema operativo ",s.jsx("span",{className:"sa-dot"})]}),s.jsx("div",{className:"sa-subtitle",children:"Estado general del entorno"})]}),s.jsxs("div",{className:"sa-top-actions",children:[s.jsx("span",{className:"sa-version",children:"v0.4 stable"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:ge,children:"Recargar"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"}),s.jsx("button",{className:"sa-btn primary",type:"button",onClick:ze,children:"Nuevo tenant"})]})]}),s.jsxs("section",{className:"sa-kpi-grid",children:[s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Total de empresas (tenants)"}),s.jsx("div",{className:"sa-kpi-value",children:ct}),s.jsxs("div",{className:"sa-kpi-meta",children:["+",et," activas"]})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Usuarios activos totales"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"En tiempo real"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Mensajes hoy"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"Canal API"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Conexiones Odoo activas"}),s.jsxs("div",{className:"sa-kpi-value",children:[vt,"%"]}),s.jsxs("div",{className:"sa-kpi-meta",children:[ve," sincronizadas"]})]})]}),s.jsxs("section",{className:"sa-table-card",children:[s.jsxs("div",{className:"sa-table-header",children:[s.jsxs("div",{className:"sa-search",children:[s.jsx(Ly,{className:"sa-search-icon"}),s.jsx("input",{value:N,onChange:S=>v(S.target.value),placeholder:"Filtrar empresas..."})]}),s.jsxs("div",{className:"sa-table-actions",children:[s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Ordenar por salud"}),s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Exportar CSV"})]})]}),s.jsxs("div",{className:"sa-table",children:[s.jsxs("div",{className:"sa-table-head",children:[s.jsx("div",{children:"ID referencia"}),s.jsx("div",{children:"Nombre de la empresa"}),s.jsx("div",{children:"Estado"}),s.jsx("div",{children:"Uso de recursos"}),s.jsx("div",{children:"Tiempo de actividad"}),s.jsx("div",{children:"Acciones"})]}),Ke.length?Ke.map(S=>{var ye;const U=xt(S.id||"tenant"),Q=S.has_database?"db":"no-db",re=S.has_database;return s.jsxs("div",{className:"sa-table-row",children:[s.jsx("div",{className:"sa-ref",children:((ye=S.slug)==null?void 0:ye.toUpperCase())||"TENANT"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-tenant-name",children:S.name}),s.jsx("div",{className:"sa-tenant-meta",children:S.id.slice(0,8)})]}),s.jsx("div",{className:`sa-status ${S.is_active?"ok":"warn"}`,children:S.is_active?"activo":"inactivo"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-progress",children:s.jsx("span",{className:`sa-progress-fill ${Q}`,style:{width:`${U}%`}})}),s.jsxs("div",{className:"sa-tenant-meta",children:[U,"% carga"]})]}),s.jsx("div",{className:"sa-tenant-meta",children:tt(S.created_at)}),s.jsx("div",{children:s.jsxs("div",{className:"sa-action-group",children:[s.jsx("button",{className:"sa-action",type:"button",onClick:()=>yt(S.id),disabled:!re||z===S.id,children:re?z===S.id?"Entrando...":"Entrar":"Sin DB"}),s.jsx("button",{className:"sa-link",type:"button",onClick:()=>Ae(S),children:s.jsx(Ry,{className:"sa-link-icon"})})]})})]},S.id)}):s.jsx("div",{className:"sa-empty",children:"Sin tenants para mostrar."})]}),s.jsxs("div",{className:"sa-footer-note",children:["Mostrando ",Ke.length||0," empresas en produccion"]})]})]}),ie&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-create-header",children:[s.jsx("button",{className:"sa-back",type:"button",onClick:Qe,children:"Volver al dashboard"}),s.jsx("div",{className:"sa-create-title",children:q?"Editar tenant":"Registrar nuevo tenant"}),s.jsxs("div",{className:"sa-create-actions",children:[s.jsx("div",{className:"sa-create-meta",children:"Modo: superadmin"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"})]})]}),x?s.jsx("div",{className:"sa-alert",children:x}):null,s.jsxs("form",{className:"sa-form",onSubmit:On,children:[s.jsxs("div",{className:"sa-form-grid sa-form-grid-2",children:[s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Identidad del tenant"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre de la empresa"}),s.jsx("input",{value:g.name,onChange:S=>h({...g,name:S.target.value}),placeholder:"Ej. Empresa Alfa"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Subdominio reservado"}),s.jsx("input",{value:g.slug,onChange:S=>h({...g,slug:S.target.value}),placeholder:"alfa-salud"})]}),s.jsxs("div",{className:"sa-field sa-field-row",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Plan"}),s.jsxs("select",{value:g.plan,onChange:S=>h({...g,plan:S.target.value}),children:[s.jsx("option",{value:"",children:"Seleccionar"}),Ey.map(S=>s.jsx("option",{value:S.value,children:S.label},S.value))]})]}),q&&s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Estado del tenant"}),s.jsxs("select",{value:M?"active":"inactive",onChange:S=>K(S.target.value==="active"),children:[s.jsx("option",{value:"active",children:"Activo"}),s.jsx("option",{value:"inactive",children:"Bloqueado"})]})]})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Brand name"}),s.jsx("input",{value:g.brand_name,onChange:S=>h({...g,brand_name:S.target.value}),placeholder:"Perzivalh"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Logo URL"}),s.jsx("input",{value:g.logo_url,onChange:S=>h({...g,logo_url:S.target.value}),placeholder:"https://"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Paleta de colores"}),s.jsx("div",{className:"sa-note",children:"Personalizacin deshabilitada por ahora."})]}),!q&&s.jsx("div",{className:"sa-note",children:"Nota: al registrar un tenant se inicia el aprovisionamiento en el entorno de produccion."})]}),s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Variables de entorno (envs)"}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Base de datos"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Tenant DB URL"}),s.jsx("input",{value:g.db_url,onChange:S=>h({...g,db_url:S.target.value}),placeholder:"postgresql://..."})]})]}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Odoo (opcional)"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Base URL"}),s.jsx("input",{value:g.odoo_base_url,onChange:S=>h({...g,odoo_base_url:S.target.value}),placeholder:"https://odoo-instancia"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo DB Name"}),s.jsx("input",{value:g.odoo_db_name,onChange:S=>h({...g,odoo_db_name:S.target.value}),placeholder:"db_tenant_prod"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo User"}),s.jsx("input",{value:g.odoo_username,onChange:S=>h({...g,odoo_username:S.target.value}),placeholder:"usuario@empresa.com"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Password (opcional)"}),s.jsx("input",{type:"password",value:g.odoo_password,onChange:S=>h({...g,odoo_password:S.target.value}),placeholder:"********"})]})]})]})]}),s.jsxs("div",{className:"sa-form-actions",children:[s.jsx("div",{className:"sa-status-note",children:q?Le?"Cargando datos...":on?"Cambios pendientes":"Sin cambios":L}),s.jsx("div",{className:"sa-form-buttons",children:q?s.jsxs(s.Fragment,{children:[on&&s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:k,children:k?"Guardando...":"Guardar cambios"}),s.jsx("button",{className:"sa-btn danger",type:"button",onClick:jn,disabled:k||!_,children:M?"Bloquear tenant":"Reactivar tenant"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:yn,disabled:p||k,children:p?"Validando...":"Validar conexion"}),s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:k,children:k?"Guardando...":"Desplegar instancia"})]})})]})]}),_?s.jsx(zy,{channels:u.length?u:l.filter(S=>S.tenant_id===_),tenantId:_,onRefresh:A}):s.jsx("div",{style:{marginTop:"2rem",padding:"1rem",border:"1px dashed rgba(255,255,255,0.2)",borderRadius:"12px",color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",textAlign:"center"},children:"Crea el tenant primero para configurar las lneas de WhatsApp."}),_&&s.jsx(Cy,{tenantId:_,tenantBots:se,availableFlows:G,loading:be,onToggleBot:De,onAddBot:W,onRemoveBot:we})]})]})]})}const fh=["open","pending","assigned"],ph=["admin","recepcion","caja","marketing","doctor"],$n={admin:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!0},campaigns:{read:!0,write:!0},settings:{read:!0,write:!0}},settings:{general:{read:!0,write:!0},users:{read:!0,write:!0},bot:{read:!0,write:!0},templates:{read:!0,write:!0},audit:{read:!0,write:!0},odoo:{read:!0,write:!0}}},recepcion:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},caja:{modules:{chat:{read:!0,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},marketing:{modules:{chat:{read:!1,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!0,write:!0},settings:{read:!0,write:!1}},settings:{general:{read:!0,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!0,write:!0},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},doctor:{modules:{chat:{read:!0,write:!1},dashboard:{read:!1,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}}};function Po(e){if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleString()}function $y(e){if(!e)return"-";const t=new Date(e);if(Number.isNaN(t.getTime()))return"-";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):i===1?"Ayer":["Dom","Lun","Mar","Mie","Jue","Vie","Sab"][t.getDay()]}function mh(e){if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?"Hoy":i===1?"Ayer":`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}function Z(e){if(!e)return"Error inesperado";if(typeof e=="string")return e==="offline"?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":e==="network_error"?"No se pudo conectar con el servidor. Intenta de nuevo.":e==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":e;const t=e.message||"Error inesperado";return t==="offline"||t.toLowerCase().includes("failed to fetch")?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":t==="network_error"||t.toLowerCase().includes("networkerror")?"No se pudo conectar con el servidor. Intenta de nuevo.":t==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":t}function Uy(e,t){return e?t.includes(e.role):!1}function Mo(e){if(!e||typeof e!="object")return{...$n};const t={...$n};return Object.entries(e).forEach(([n,r])=>{var a,i;!r||typeof r!="object"||(t[n]={modules:{...(a=$n[n])==null?void 0:a.modules,...r.modules},settings:{...(i=$n[n])==null?void 0:i.settings,...r.settings}})}),t}function Tt(e,t,n,r="read"){var i;const a=(i=e==null?void 0:e[t])==null?void 0:i[n];return a?!!a[r]:!1}function Do(e){const t=n=>n.status==="pending"&&!n.assigned_user_id?0:n.status==="pending"&&n.assigned_user_id?1:n.status==="assigned"?2:3;return[...e].sort((n,r)=>{const a=t(n),i=t(r);if(a!==i)return a-i;const l=new Date(n.last_message_at||n.created_at||0).getTime();return new Date(r.last_message_at||r.created_at||0).getTime()-l})}function Vy(e){const t=new URLSearchParams;Object.entries(e||{}).forEach(([r,a])=>{a==null||a===""||t.append(r,a)});const n=t.toString();return n?`?${n}`:""}function gh(e){if(!e)return"?";const t=e.trim();return t?t[0].toUpperCase():"?"}function vh(e){if(typeof document>"u")return;const t=document.documentElement.style;t.removeProperty("--accent"),t.removeProperty("--accent-strong"),t.removeProperty("--accent-soft"),t.removeProperty("--accent-soft-2"),t.removeProperty("--scroll-thumb"),t.removeProperty("--scroll-thumb-hover")}function Fy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M4.5 5.5h15v10H8l-3.5 3.5V5.5Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 9h8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 12.5h5",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Wy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"})]})}function Hy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 9a6 6 0 1 1 12 0c0 4.2 2 5.5 2 5.5H4S6 13.2 6 9Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M9.5 19a2.5 2.5 0 0 0 5 0",strokeWidth:"1.8"})]})}function qy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"2",strokeLinecap:"round"})]})}function Gy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"4",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 3v2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M12 18.5V21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M3 12h2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M18.5 12H21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 5.2l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 17l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 18.8 7 17",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 7l1.8-1.8",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Qy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M20 14.2A8.5 8.5 0 1 1 9.8 4 6.5 6.5 0 0 0 20 14.2Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function Yy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.8"}),s.jsx("path",{d:"M16.5 16.5 21 21",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ky(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Xy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3.5",y:"6",width:"11",height:"12",rx:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"m14.5 10 6-3v10l-6-3",strokeWidth:"1.8"})]})}function Jy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M6.5 4.5 9 3l2.5 4-2.5 1.5c1.2 2.3 3.2 4.3 5.5 5.5L16 11l4 2.5-1.5 2.5c-.7 1.2-2.2 1.7-3.6 1.3a15.9 15.9 0 0 1-7.7-7.7c-.4-1.4.1-2.9 1.3-3.6Z",strokeWidth:"1.6",strokeLinejoin:"round"})})}function Zy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"9",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 10v6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"7.5",r:"1",fill:"currentColor"})]})}function ej(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"m4 12 15-7-6 14-2.5-5.2L4 12Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function tj(){const[e,t]=f.useState(localStorage.getItem("token")||""),[n,r]=f.useState(()=>typeof window<"u"&&localStorage.getItem("superadmin_token")||""),[a,i]=f.useState(null),[l,c]=f.useState(null),[u,m]=f.useState(null),[N,v]=f.useState([]),[x,C]=f.useState({id:"",display_name:""}),[L,R]=f.useState(()=>{if(typeof window>"u")return{};try{return JSON.parse(localStorage.getItem("last_read_map")||"{}")}catch{return{}}}),[g,h]=f.useState({email:"",password:""}),[p,y]=f.useState(""),[k,D]=f.useState("chats"),[z,I]=f.useState(()=>typeof window<"u"?window.location.pathname:"/"),[_,P]=f.useState(()=>localStorage.getItem("theme")||"light"),[M,K]=f.useState(()=>typeof window<"u"&&window.navigator?!window.navigator.onLine:!1),[ue,fe]=f.useState(!1),[He,_e]=f.useState(!1),[Le,at]=f.useState(!1),[F,G]=f.useState(!0),[te,se]=f.useState(!1),[de,be]=f.useState(""),T=f.useRef(null),H=f.useRef(null),b=f.useRef(null),$=f.useRef({conversationId:null,lastId:null,length:0}),q=f.useRef(0),ie=f.useRef(!1),ce=f.useRef(0),[ge,Ke]=f.useState("users"),[ct,et]=f.useState("list"),[ve,vt]=f.useState(()=>Mo(null)),[tt,xt]=f.useState(!1),[Ge,ze]=f.useState(!1),[Qe,yt]=f.useState(!1),ut=f.useMemo(()=>{const d=Object.keys(ve||{}).filter(j=>!ph.includes(j));return[...ph,...d]},[ve]),[je,Yn]=f.useState({status:"",assigned_user_id:"",tag:"",search:"",phone_number_id:""}),$e=z.startsWith("/superadmin"),[ln,De]=f.useState([]),[W,we]=f.useState(null),[Ae,A]=f.useState([]),[Se,xn]=f.useState(""),[Ln,Rn]=f.useState("text"),[yn,On]=f.useState([]),[jn,on]=f.useState([]),[S,U]=f.useState(""),[Q,re]=f.useState(""),[ye,Qt]=f.useState(""),[Ue,bt]=f.useState(!1),[Pn,er]=f.useState({name:"",color:"#6b7280"}),[dt,Kn]=f.useState(!1),[Mn,ae]=f.useState(""),{pushToast:ne}=Du(),Xn=f.useRef(new Map),Jn=f.useRef(new Map),Zn=f.useRef(new Map),es=f.useRef(new Map),Fr=f.useRef(new Map),[ts,Ya]=f.useState(null),[Ce,ns]=f.useState([]),[tr,Ka]=f.useState([]),[ss,Wr]=f.useState(0),[Xa,rs]=f.useState([]),[Hr,nr]=f.useState(""),[Ja,Ml]=f.useState(null),[Ps,Iu]=f.useState([]),[Yt,sr]=f.useState(null),[ht,$t]=f.useState({name:"",template_id:"",scheduled_for:"",send_now:!0}),[Pt,Za]=f.useState({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),[rr,Dn]=f.useState([]),[Ct,Nn]=f.useState({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),[Ms,qr]=f.useState(null),[ar,ei]=f.useState([]),[Dl,Il]=f.useState([]),[it,ir]=f.useState({id:"",code:"",name:"",address:"",lat:"",lng:"",hours_text:"",phone:"",is_active:!0}),[nt,ti]=f.useState({id:"",code:"",name:"",subtitle:"",description:"",price_bob:"",duration_min:"",image_url:"",is_featured:!1,is_active:!0}),[ni,Bl]=f.useState({id:"",name:"",language:"es",category:"",body_preview:"",is_active:!0}),[lr,zl]=f.useState([]),Ds=((l==null?void 0:l.brand_name)||(u==null?void 0:u.name)||"Perzivalh").trim(),[or,In]=f.useState(!1),[cr,Gr]=f.useState(!1),[ft,as]=f.useState(null),is=48,si=80,ri=60,Qr=320,ls=120,$l=5,Is=2*60*1e3,Bs=f.useRef(new Map);function Yr(){const d=Bs.current;for(;d.size>$l;){const j=d.keys().next().value;d.delete(j)}}function Ul(d){const j=Bs.current,E=j.get(d);return E?Date.now()-E.updatedAt>Is?(j.delete(d),null):E:null}function Kr(d,j){const E=Bs.current;E.delete(d),E.set(d,{...j,updatedAt:Date.now()}),Yr()}const Kt=f.useCallback((d,j={})=>{if(typeof window>"u")return;const E=d||"/";if(window.location.pathname===E){I(E);return}j.replace?window.history.replaceState({},"",E):window.history.pushState({},"",E),I(E)},[]),Xr=f.useMemo(()=>Ce.find(d=>d.id===ht.template_id),[Ce,ht.template_id]),Vl=f.useMemo(()=>{const d=[...Ae].reverse().find(j=>j.type==="note");return(d==null?void 0:d.text)||""},[Ae]),Fl=f.useMemo(()=>Ae.filter(d=>d.type==="note"),[Ae]);f.useEffect(()=>{if(typeof window>"u")return;const d=()=>{I(window.location.pathname||"/")};return window.addEventListener("popstate",d),()=>window.removeEventListener("popstate",d)},[]),f.useEffect(()=>{fr(e||null)},[e]),f.useEffect(()=>{document.body.dataset.theme=_,localStorage.setItem("theme",_)},[_]),f.useEffect(()=>{if(typeof window>"u")return;const d=()=>{K(!window.navigator.onLine)};return d(),window.addEventListener("online",d),window.addEventListener("offline",d),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",d)}},[]),f.useEffect(()=>{se(!1),G(!0),requestAnimationFrame(()=>{cs()}),W&&Jr(W)},[W==null?void 0:W.id]),f.useEffect(()=>{k==="chats"&&(se(!1),G(!0),requestAnimationFrame(()=>{cs()}))},[k,W==null?void 0:W.id]),f.useEffect(()=>{var Te;if(!W){be("");return}const d=Ae[Ae.length-1],j=(d==null?void 0:d.id)||(d==null?void 0:d.created_at)||(Ae.length?`${Ae.length}`:null),E=$.current,ee=E.conversationId===W.id&&d&&E.lastId&&j!==E.lastId;if(ie.current&&Ae.length>0){ie.current=!1,requestAnimationFrame(()=>{cs()});return}if(ee?F?cs():se(!0):F&&se(!1),$.current={conversationId:W.id,lastId:j,length:Ae.length},zs(),F&&Ae.length>Qr){const X=Ae.slice(-Qr);A(X),as(((Te=X[0])==null?void 0:Te.created_at)||null),In(!0)}},[Ae,W==null?void 0:W.id,F]),f.useEffect(()=>{var j;if(!(W!=null&&W.id)||!Ae.length)return;const d={messages:Ae.slice(-ls),cursor:ft||((j=Ae[0])==null?void 0:j.created_at)||null,hasMore:or};Kr(W.id,d)},[Ae,ft,or,W==null?void 0:W.id]),f.useEffect(()=>{k!=="chats"&&G(!1)},[k]),f.useEffect(()=>{if(!e)return;let d=!0;return pe("/api/me").then(j=>{d&&i(j.user)}).catch(()=>{d&&(t(""),i(null))}),()=>{d=!1}},[e]),f.useEffect(()=>{if(!a||a.role==="superadmin"){c(null),v([]),vh();return}let d=!0;return pe("/api/branding").then(j=>{d&&c(j.branding||null)}).catch(()=>{d&&c(null)}),pe("/api/tenant").then(j=>{d&&m(j.tenant||null)}).catch(()=>{d&&m(null)}),pe("/api/channels").then(j=>{d&&v(j.channels||[])}).catch(()=>{d&&v([])}),()=>{d=!1}},[a]),f.useEffect(()=>{vh()},[l]),f.useEffect(()=>{if(a){if(a.role==="superadmin"){$e||Kt("/superadmin",{replace:!0});return}$e&&Kt("/",{replace:!0})}},[a,$e,Kt]),f.useEffect(()=>{a&&a.role!=="superadmin"&&(Wl(),os())},[a]),f.useEffect(()=>{a&&a.role!=="superadmin"&&Hl()},[a]),f.useEffect(()=>{!a||k!=="chats"||a.role!=="superadmin"&&ql()},[a,k,je]),f.useEffect(()=>{a&&a.role!=="superadmin"&&(k==="dashboard"&&wn(),k==="campaigns"&&(Et(),Ut(1,6)))},[a,k]),f.useEffect(()=>{if(!a||k!=="admin")return;const d=(ve==null?void 0:ve[a.role])||$n[a.role],j=Tt(d,"settings","users"),E=Tt(d,"settings","bot"),O=Tt(d,"settings","general"),ee=Tt(d,"settings","templates"),Te=Tt(d,"settings","audit");ge==="users"&&j&&ea(),ge==="bot"&&E&&Jp(),ge==="general"&&O&&hs(),ge==="templates"&&ee&&Et(),ge==="audit"&&Te&&hm()},[a,k,ge,ve]),f.useEffect(()=>{if(!a||k!=="admin")return;const d=(ve==null?void 0:ve[a.role])||$n[a.role],E=["general","users","bot","templates","audit","odoo"].filter(O=>Tt(d,"settings",O));if(!E.length){D(result.user.role==="superadmin"?"superadmin":"chats");return}E.includes(ge)||Ke(E[0])},[a,k,ge,ve]),f.useEffect(()=>{if(!e||(a==null?void 0:a.role)==="superadmin")return;const d=Xx(e),j={current:null},E=["/sounds/new-notification-09-352705.wav","/sounds/new-notification-09-352705.mp3"],O=()=>{if(j.current)return j.current;const X=new Audio(E[0]);X.volume=1;let oe=0;return X.addEventListener("error",()=>{oe+=1,oe<E.length&&(X.src=E[oe],X.load())}),j.current=X,X},ee=()=>{const X=O();X.play().then(()=>{X.pause(),X.currentTime=0}).catch(()=>{})};window.addEventListener("click",ee,{once:!0}),window.addEventListener("touchstart",ee,{once:!0});const Te=()=>{if(!(typeof window>"u"))try{const X=O();X.currentTime=0,X.play().catch(()=>{})}catch{}};return d.on("conversation:update",({conversation:X})=>{const oe=Fr.current.get(X.id);Fr.current.set(X.id,X.status),X.status==="pending"&&!X.assigned_user_id&&oe!=="pending"&&(Te(),ne({message:"Nueva conversacin pendiente"})),De(Ie=>{const Re=Ie.map(Nt=>Nt.id===X.id?{...Nt,...X}:Nt);return Re.find(Nt=>Nt.id===X.id)||Re.push(X),Do(Re)}),we(Ie=>(Ie==null?void 0:Ie.id)===X.id?{...Ie,...X}:Ie)}),d.on("message:new",({conversation:X,message:oe})=>{X.status==="pending"&&!X.assigned_user_id&&Te();const Ie={...X,last_message_text:(oe==null?void 0:oe.text)||null,last_message_type:(oe==null?void 0:oe.type)||null,last_message_direction:(oe==null?void 0:oe.direction)||null,last_message_at:(oe==null?void 0:oe.created_at)||X.last_message_at};De(Re=>{const Nt=Re.map(dr=>dr.id===X.id?{...dr,...Ie}:dr);return Nt.find(dr=>dr.id===X.id)||Nt.push(Ie),Do(Nt)}),we(Re=>(Re==null?void 0:Re.id)===X.id?{...Re,...Ie}:Re),A(Re=>!W||W.id!==X.id?Re:(Jr(Ie),[...Re,oe]))}),()=>{d.disconnect()}},[e,W]),f.useEffect(()=>{if(!a)return;if(a.role==="superadmin"){k!=="superadmin"&&D("superadmin");return}const d=(ve==null?void 0:ve[a.role])||$n[a.role],j=Tt(d,"modules","chat"),E=Tt(d,"modules","dashboard"),O=Tt(d,"modules","campaigns"),ee=Tt(d,"modules","settings");k==="chats"&&!j&&D(E?"dashboard":O?"campaigns":"admin"),k==="dashboard"&&!E&&D(j?"chats":O?"campaigns":"admin"),k==="campaigns"&&!O&&D(j?"chats":E?"dashboard":"admin"),k==="admin"&&!ee&&D(j?"chats":E?"dashboard":"campaigns")},[a,k,ve]),f.useEffect(()=>{if(!a||a.role!=="admin"||!tt||!Ge||Qe)return;const d=setTimeout(()=>{const j=ce.current;yt(!0),Xe("/api/admin/role-permissions",{permissions:ve}).then(()=>{ce.current===j&&ze(!1)}).catch(E=>{ae(Z(E))}).finally(()=>{yt(!1)})},350);return()=>clearTimeout(d)},[a,ve,Ge,tt,Qe]);async function Wl(){try{const d=await pe("/api/users");on(d.users||[])}catch(d){ae(Z(d))}}async function Hl(){try{const d=await pe("/api/role-permissions"),j=Mo(d.permissions||null);ce.current=0,vt(j),ze(!1),xt(!0)}catch(d){ae(Z(d)),xt(!0)}}async function os(){try{const d=await pe("/api/tags");On(d.tags||[])}catch(d){ae(Z(d))}}async function ql(){try{const d=Vy(je),j=await pe(`/api/conversations${d}`);De(Do(j.conversations||[]))}catch(d){ae(Z(d))}}async function Gl(d){var ee,Te;ie.current=!0;const j=Ul(d),E=ln.find(X=>X.id===d);Kn(!j),Zr(),E&&we(E),j&&(A(j.messages||[]),as(j.cursor||null),In(!!j.hasMore),zs(),requestAnimationFrame(()=>{cs()}));const O=q.current+1;q.current=O;try{const X=`?limit=${si}&window_hours=${is}`,oe=await pe(`/api/conversations/${d}${X}`);if(q.current!==O)return;let Ie=oe.conversation;const Re=oe.messages||[];if((Ie==null?void 0:Ie.status)==="pending"&&!Ie.assigned_user_id&&(a!=null&&a.id))try{Ie=(await Xe(`/api/conversations/${d}/assign`,{})).conversation}catch(Nt){String(Z(Nt)).includes("already_assigned")&&ne({type:"error",message:"Conversacin tomada por otro operador"})}we(Ie),A(Re),In(!!oe.has_more),as(oe.next_cursor||((ee=Re[0])==null?void 0:ee.created_at)||null),Kr(d,{messages:Re.slice(-ls),cursor:oe.next_cursor||((Te=Re[0])==null?void 0:Te.created_at)||null,hasMore:!!oe.has_more}),Jr(Ie)}catch(X){ae(Z(X))}finally{q.current===O&&Kn(!1)}}async function Ql(d){var Te;if(!or||cr)return;const j=ft;if(!j){In(!1);return}Gr(!0);const E=H.current,O=E?E.scrollHeight:0,ee=E?E.scrollTop:0;try{const X=`?limit=${ri}&before=${encodeURIComponent(j)}`,oe=await pe(`/api/conversations/${d}${X}`);if((W==null?void 0:W.id)!==d)return;const Ie=oe.messages||[];Ie.length?(A(Re=>{const Nt=new Set(Re.map(no=>no.id));return[...Ie.filter(no=>!Nt.has(no.id)),...Re]}),as(oe.next_cursor||((Te=Ie[0])==null?void 0:Te.created_at)||j),In(!!oe.has_more),requestAnimationFrame(()=>{const Re=H.current;if(!Re)return;const Nt=Re.scrollHeight;Re.scrollTop=Nt-O+ee})):In(!1)}catch(X){ae(Z(X))}finally{Gr(!1)}}async function Yl(d){d.preventDefault(),y("");try{const j=await Ne("/api/auth/login",{email:g.email,password:g.password});t(j.token),fr(j.token),i(j.user),r(""),localStorage.removeItem("superadmin_token");const E=j.user.role==="superadmin";D(E?"superadmin":"chats"),E?Kt("/superadmin",{replace:!0}):$e&&Kt("/",{replace:!0})}catch{y("Credenciales invalidas")}}function ur(){t(""),fr(null),i(null),De([]),we(null),A([]),D("chats"),at(!1),vt(Mo(null)),xt(!1),ze(!1),yt(!1),ce.current=0,r(""),localStorage.removeItem("superadmin_token"),Kt("/",{replace:!0})}async function ai(d){const j=await Ne(`/api/superadmin/tenants/${d}/impersonate`);!n&&e&&(localStorage.setItem("superadmin_token",e),r(e)),t(j.token),fr(j.token),i(j.user),D("chats"),Kt("/",{replace:!0})}function Kl(){const d=n||(typeof window<"u"?localStorage.getItem("superadmin_token"):"");if(!d){ur();return}localStorage.removeItem("superadmin_token"),r(""),t(d),fr(d),i(null),D("chats"),Kt("/superadmin",{replace:!0})}function Xl(d){vt(j=>typeof d=="function"?d(j):d),ce.current+=1,ze(!0)}function Jl(){P(d=>d==="light"?"dark":"light")}function cs(){const d=H.current;d&&(d.scrollTop=d.scrollHeight,G(!0),se(!1),zs())}function Jr(d){!(d!=null&&d.id)||!(d!=null&&d.last_message_at)||R(j=>{const E={...j,[d.id]:d.last_message_at};return localStorage.setItem("last_read_map",JSON.stringify(E)),E})}function Zl(){const d=H.current;if(!d)return;const E=d.scrollHeight-d.scrollTop-d.clientHeight<24;G(E),E&&se(!1),d.scrollTop<120&&or&&!cr&&W&&Ql(W.id),zs()}function Zr(){A([]),as(null),In(!1),Gr(!1),$.current={conversationId:null,lastId:null,length:0}}function zs(){b.current||(b.current=requestAnimationFrame(()=>{b.current=null,ii()}))}function ii(){const d=H.current;if(!d)return;const j=d.querySelectorAll(".day-pill");if(!j.length){be("");return}const E=d.scrollTop,O=12;let ee=j[0];for(const X of j)if(X.offsetTop-O<=E)ee=X;else break;const Te=ee.dataset.dayLabel||ee.textContent||"";be(Te)}function o(){we(null),Zr()}function w(d){var j;xn(d),(j=T.current)==null||j.focus()}async function V(d){if(d.preventDefault(),!W||!Se.trim())return;const j=Se.trim();xn("");try{await Ne(`/api/conversations/${W.id}/messages`,{text:j,type:Ln})}catch(E){ae(Z(E))}}async function J(d){if(d.preventDefault(),!W||!Q.trim())return;const j=Q.trim();re("");try{const E=await Ne(`/api/conversations/${W.id}/messages`,{text:j,type:"note"});E!=null&&E.message&&A(O=>[...O,E.message]),E!=null&&E.conversation&&we(E.conversation)}catch(E){ae(Z(E))}}async function le(){if(W)try{const d=await Xe(`/api/conversations/${W.id}/assign`);we(d.conversation)}catch(d){const j=Z(d)||"No se pudo tomar la conversacion";ne({type:"error",message:j})}}async function Ee(){if(!(!W||!ye))try{const d=await Xe(`/api/conversations/${W.id}/assign`,{user_id:ye});we(d.conversation),Qt(""),ne({message:"Conversacin reasignada"})}catch(d){const j=Z(d)||"No se pudo reasignar";ne({type:"error",message:j})}}async function jt(d){var j;if(W)try{let O=(await Xe(`/api/conversations/${W.id}/status`,{status:d})).conversation;if(d==="open"&&((j=O==null?void 0:O.tags)!=null&&j.length)){const ee=O.tags.find(Te=>(Te.name||"").toLowerCase()==="pendiente");if(ee)try{O=(await Ne(`/api/conversations/${O.id}/tags`,{add:[],remove:[ee.name]})).conversation||O}catch{O={...O,tags:O.tags.filter(X=>X.name!==ee.name)}}}we(O),De(ee=>ee.map(Te=>Te.id===O.id?{...Te,...O}:Te))}catch(E){ae(Z(E))}}async function cn(d){var E;if(!W)return;const j=((E=W.tags)==null?void 0:E.some(O=>O.name===d))||!1;if(j){const O=`${W.id}:${d}`;if(es.current.has(O))return;const ee=W,Te={...W,tags:(W.tags||[]).filter(oe=>oe.name!==d)};we(Te);const X=setTimeout(async()=>{try{const oe=await Ne(`/api/conversations/${ee.id}/tags`,{add:[],remove:[d]});(W==null?void 0:W.id)===ee.id&&we(oe.conversation)}catch(oe){(W==null?void 0:W.id)===ee.id&&we(ee),ne({type:"error",message:Z(oe)||"No se pudo eliminar el tag"})}finally{es.current.delete(O)}},8e3);es.current.set(O,{timer:X,snapshot:ee}),ne({message:"Tag eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const oe=es.current.get(O);oe!=null&&oe.timer&&clearTimeout(oe.timer),oe!=null&&oe.snapshot?we(oe.snapshot):we(ee),es.current.delete(O),ne({message:"Eliminacin cancelada"})}});return}try{const O=await Ne(`/api/conversations/${W.id}/tags`,{add:j?[]:[d],remove:j?[d]:[]});we(O.conversation)}catch(O){ae(Z(O))}}async function us(d){if(d.preventDefault(),!S.trim()||!W)return;const j=S.trim();U("");try{const E=await Ne(`/api/conversations/${W.id}/tags`,{add:[j]});we(E.conversation),await os()}catch(E){ae(Z(E))}}async function li(d){d.preventDefault();const j=Pn.name.trim();if(!j){ae("Completa el nombre de la etiqueta");return}try{await Ne("/api/tags",{name:j,color:Pn.color||null}),er({name:"",color:"#6b7280"}),await os(),ne({message:"Etiqueta creada"})}catch(E){ae(Z(E))}}async function eo(d,j){if(d)try{await kn(`/api/tags/${d}`),we(E=>E&&{...E,tags:(E.tags||[]).filter(O=>O.name!==j)}),await os(),ne({message:"Etiqueta eliminada"})}catch(E){ae(Z(E))}}async function wn(){try{const d=await pe("/api/dashboard/metrics");Ya(d)}catch(d){ae(Z(d))}}async function Et(){try{const d=await pe("/api/templates").catch(()=>pe("/api/admin/templates"));ns(d.templates||[])}catch(d){ae(Z(d))}}async function Ut(d=1,j=6,E=""){try{const O=new URLSearchParams({page:String(d),page_size:String(j)});E&&O.set("q",E);const ee=await pe(`/api/admin/campaigns?${O.toString()}`);Ka(ee.campaigns||[]),Wr(Number.isFinite(ee.total)?ee.total:(ee.campaigns||[]).length)}catch(O){ae(Z(O))}}async function ds(d){nr(d);try{const j=await pe(`/api/admin/campaigns/${d}/messages`);rs(j.messages||[])}catch(j){ae(Z(j))}}async function Xt(d){var E;if(d.preventDefault(),!ht.name.trim()||!ht.template_id){ae("Completa el nombre y plantilla");return}const j={};Pt.status&&(j.status=Pt.status),Pt.tag&&(j.tag=Pt.tag.trim()),Pt.assigned_user_id&&(j.assigned_user_id=Pt.assigned_user_id),Pt.verified_only&&(j.verified_only=!0),Pt.segment_id&&(j.segment_id=Pt.segment_id,Pt.segment_name&&(j.segment_name=Pt.segment_name));try{const O=await Ne("/api/admin/campaigns",{name:ht.name.trim(),template_id:ht.template_id,audience_filter:j,scheduled_for:ht.scheduled_for||null});if(ht.send_now&&!ht.scheduled_for){const ee=(E=O==null?void 0:O.campaign)==null?void 0:E.id;ee&&await Ne(`/api/admin/campaigns/${ee}/send`,{})}$t({name:"",template_id:"",scheduled_for:"",send_now:!0}),Za({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),await Ut(1,6),ne({message:"Campaa creada correctamente"})}catch(O){ae(Z(O)),ne({type:"error",message:Z(O)||"Error al crear campaa"})}}async function Qp(d){try{await Ne(`/api/admin/campaigns/${d}/send`,{}),await Ut(1,6)}catch(j){ae(Z(j))}}async function Yp(){try{await pe("/api/templates/sync"),await Et()}catch(d){ae(Z(d))}}async function ea(){try{const d=await pe("/api/admin/users");Dn(d.users||[])}catch(d){ae(Z(d))}}async function Kp(d){if(d.preventDefault(),!Ct.name.trim()||!Ct.role){ae("Completa los campos requeridos");return}try{Ct.id?(await Xe(`/api/admin/users/${Ct.id}`,{name:Ct.name.trim(),role:Ct.role,is_active:Ct.is_active,password:Ct.password||void 0}),ne({message:"Usuario actualizado correctamente"})):(await Ne("/api/admin/users",{name:Ct.name.trim(),email:Ct.email.trim().toLowerCase(),role:Ct.role,password:Ct.password}),ne({message:"Usuario creado correctamente"})),Nn({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),await ea()}catch(j){ae(Z(j)),ne({type:"error",message:Z(j)||"Error al guardar usuario"})}}async function Xp(d){if(!d||Xn.current.has(d))return;let j=null;try{j=rr.slice(),Dn(O=>O.filter(ee=>ee.id!==d));const E=setTimeout(async()=>{try{await kn(`/api/admin/users/${d}`),await ea(),ne({message:"Usuario eliminado definitivamente"})}catch(O){j?Dn(j):await ea(),ne({type:"error",message:Z(O)||"No se pudo eliminar el usuario"})}finally{Xn.current.delete(d)}},8e3);Xn.current.set(d,{timer:E,snapshot:j}),ne({message:"Usuario eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const O=Xn.current.get(d);O!=null&&O.timer&&clearTimeout(O.timer),O!=null&&O.snapshot?Dn(O.snapshot):j?Dn(j):await ea(),Xn.current.delete(d),ne({message:"Eliminacin cancelada"})}})}catch(E){ae(Z(E)),ne({type:"error",message:Z(E)||"Error al eliminar usuario"})}}async function Jp(){try{const d=await pe("/api/admin/settings");qr(d.settings)}catch(d){ae(Z(d))}}async function Zp(){if(Ms)try{const d=await Xe("/api/admin/settings",{bot_enabled:Ms.bot_enabled,auto_reply_enabled:Ms.auto_reply_enabled});qr(d.settings)}catch(d){ae(Z(d))}}async function hs(){try{const[d,j]=await Promise.all([pe("/api/admin/branches"),pe("/api/admin/services")]);ei(d.branches||[]),Il(j.services||[])}catch(d){ae(Z(d))}}async function em(){try{const d=await pe("/api/channels");v(d.channels||[])}catch{v([])}}function tm(d){C({id:d.id,display_name:d.display_name||""})}async function nm(d){if(d.preventDefault(),!!x.id)try{await Xe(`/api/channels/${x.id}`,{display_name:x.display_name.trim()}),C({id:"",display_name:""}),await em(),ne({message:"Canal actualizado correctamente"})}catch(j){ae(Z(j)),ne({type:"error",message:Z(j)||"Error al guardar canal"})}}async function sm(d){const j=ve==null?void 0:ve[d];if(!(!d||Jn.current.has(d)))try{vt(O=>{const ee={...O};return delete ee[d],ee});const E=setTimeout(async()=>{try{await kn(`/api/admin/role-permissions/${d}`),ne({message:"Rol eliminado definitivamente"})}catch(O){j&&vt(ee=>({...ee,[d]:j})),ne({type:"error",message:Z(O)||"No se pudo eliminar el rol"})}finally{Jn.current.delete(d)}},8e3);Jn.current.set(d,{timer:E,currentPermissions:j}),ne({message:"Rol eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const O=Jn.current.get(d);O!=null&&O.timer&&clearTimeout(O.timer),O!=null&&O.currentPermissions&&vt(ee=>({...ee,[d]:O.currentPermissions})),Jn.current.delete(d),ne({message:"Eliminacin cancelada"})}})}catch(E){ae(Z(E)),ne({type:"error",message:Z(E)||"Error al eliminar rol"})}}async function rm(d){if(d.preventDefault(),!it.code.trim()||!it.name.trim()){ae("Completa codigo y nombre");return}const j={code:it.code.trim(),name:it.name.trim(),address:it.address.trim(),lat:it.lat!==""?Number(it.lat):0,lng:it.lng!==""?Number(it.lng):0,hours_text:it.hours_text.trim(),phone:it.phone.trim()||null,is_active:it.is_active};try{it.id?(await Xe(`/api/admin/branches/${it.id}`,j),ne({message:"Sucursal actualizada correctamente"})):(await Ne("/api/admin/branches",j),ne({message:"Sucursal creada correctamente"})),ir({id:"",code:"",name:"",address:"",lat:"",lng:"",hours_text:"",phone:"",is_active:!0}),await hs()}catch(E){ae(Z(E)),ne({type:"error",message:Z(E)||"Error al guardar sucursal"})}}async function am(d){try{await kn(`/api/admin/branches/${d}`),await hs(),ne({message:"Sucursal eliminada correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{await Xe(`/api/admin/branches/${d}`,{is_active:!0}),await hs(),ne({message:"Sucursal restaurada"})}catch(j){ne({type:"error",message:Z(j)||"No se pudo restaurar la sucursal"})}}})}catch(j){ae(Z(j)),ne({type:"error",message:Z(j)||"Error al eliminar sucursal"})}}async function im(d){if(d.preventDefault(),!nt.code.trim()||!nt.name.trim()){ae("Completa codigo y nombre");return}const j={code:nt.code.trim(),name:nt.name.trim(),subtitle:nt.subtitle.trim()||null,description:nt.description.trim(),price_bob:nt.price_bob?Number(nt.price_bob):0,duration_min:nt.duration_min?Number(nt.duration_min):null,image_url:nt.image_url.trim()||null,is_featured:nt.is_featured,is_active:nt.is_active};try{nt.id?(await Xe(`/api/admin/services/${nt.id}`,j),ne({message:"Servicio actualizado correctamente"})):(await Ne("/api/admin/services",j),ne({message:"Servicio creado correctamente"})),ti({id:"",code:"",name:"",subtitle:"",description:"",price_bob:"",duration_min:"",image_url:"",is_featured:!1,is_active:!0}),await hs()}catch(E){ae(Z(E)),ne({type:"error",message:Z(E)||"Error al guardar servicio"})}}async function lm(d){try{await kn(`/api/admin/services/${d}`),await hs(),ne({message:"Servicio eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{await Xe(`/api/admin/services/${d}`,{is_active:!0}),await hs(),ne({message:"Servicio restaurado"})}catch(j){ne({type:"error",message:Z(j)||"No se pudo restaurar el servicio"})}}})}catch(j){ae(Z(j)),ne({type:"error",message:Z(j)||"Error al eliminar servicio"})}}async function om(d,j,E){if(d)try{await Ne(`/api/admin/services/${d.id}/branches`,{branch_id:j,is_available:E}),await hs()}catch(O){ae(Z(O))}}async function cm(d,j){d!=null&&d.preventDefault&&d.preventDefault();const E=j||ni||{},O=typeof E.name=="string"?E.name.trim():"";if(!O)return ae("Completa el nombre"),null;const ee={name:O,category:E.category||"UTILITY",language:E.language||"es",body_text:E.body_text||E.body_preview||"",header_type:E.header_type||null,header_content:E.header_content||null,footer_text:E.footer_text||null,buttons:E.buttons||E.buttons_json||[]},Te=E.variable_mappings||E.variableMappings||[];try{let X=null;return E.id?(X=await ml(`/api/templates/${E.id}`,ee),await ml(`/api/templates/${E.id}/mappings`,{mappings:Te}),ne({message:"Borrador actualizado correctamente"})):(X=await Ne("/api/templates/draft",{...ee,variable_mappings:Te}),ne({message:"Borrador creado correctamente"})),await Et(),(X==null?void 0:X.template)||null}catch(X){return ae(Z(X)),ne({type:"error",message:Z(X)||"Error al guardar plantilla"}),null}}async function um(d){if(d)try{await Ne(`/api/templates/${d}/submit`,{}),await Et(),ne({message:"Plantilla enviada a revisin de Meta"})}catch(j){ae(Z(j)),ne({type:"error",message:Z(j)||"Error al enviar a Meta"})}}async function dm(d){if(d&&!Zn.current.has(d))try{const j=Ce.slice();ns(O=>O.filter(ee=>ee.id!==d));const E=setTimeout(async()=>{try{await kn(`/api/templates/${d}`),await Et(),ne({message:"Plantilla eliminada definitivamente"})}catch(O){ns(j),ne({type:"error",message:Z(O)||"No se pudo eliminar la plantilla"})}finally{Zn.current.delete(d)}},8e3);Zn.current.set(d,{timer:E,snapshot:j}),ne({message:"Plantilla eliminada. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const O=Zn.current.get(d);O!=null&&O.timer&&clearTimeout(O.timer),O!=null&&O.snapshot?ns(O.snapshot):ns(j),Zn.current.delete(d),ne({message:"Eliminacin cancelada"})}})}catch(j){ae(Z(j)),ne({type:"error",message:Z(j)||"Error al eliminar plantilla"})}}async function hm(){try{const d=await pe("/api/admin/audit?limit=200");zl(d.logs||[])}catch(d){ae(Z(d))}}const Bu={open:0,pending:0,closed:0};((ts==null?void 0:ts.status_counts)||[]).forEach(d=>{Bu[d.status]=d._count.status});const fm=$e?"Acceso al control plane":"Acceso a bandeja multiusuario";if(!e||!a)return s.jsx("div",{className:"login-shell",children:s.jsxs("div",{className:"login-card",children:[s.jsx("div",{className:"login-title",children:"Perzivalh"}),s.jsx("div",{className:"login-subtitle",children:fm}),M?s.jsx(ka,{variant:"offline",title:"Sin conexin",message:"No tienes internet en este momento. Conctate y vuelve a intentar iniciar sesin.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):null,s.jsxs("form",{className:"login-form",onSubmit:Yl,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:g.email,onChange:d=>h(j=>({...j,email:d.target.value})),required:!0})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:g.password,onChange:d=>h(j=>({...j,password:d.target.value})),required:!0})]}),p?s.jsx("div",{className:"error",children:p}):null,s.jsx("button",{className:"primary",type:"submit",children:"Entrar"})]})]})});if((a==null?void 0:a.role)==="superadmin"&&$e)return s.jsx("main",{className:"superadmin-page",children:s.jsx(hh,{route:z,onNavigate:Kt,onImpersonateTenant:ai,onLogout:ur})});const ta=(ve==null?void 0:ve[a.role])||$n[a.role],pm=Tt(ta,"modules","chat"),mm=Tt(ta,"modules","dashboard"),gm=Tt(ta,"modules","campaigns"),vm=Tt(ta,"modules","settings"),xm=Uy(a,["admin"]),ym=Tt(ta,"modules","chat","write"),jm=[],zu={open:"Bot activo",pending:"Pendiente",assigned:"Tomada"},Nm=W?W.display_name||W.phone_e164||W.wa_id:"Selecciona un chat",wm=(W==null?void 0:W.phone_e164)||(W==null?void 0:W.wa_id)||"",_m=W?zu[W.status]||"Sin estado":"",Sm=[{id:"chats",label:"Chats",icon:Fy,enabled:pm},{id:"dashboard",label:"Dashboard",icon:Wy,enabled:mm},{id:"campaigns",label:"Campaas",icon:Hy,enabled:gm},{id:"admin",label:"Configuraciones",icon:qy,enabled:vm}],to=[];let $u="";Ae.forEach(d=>{const j=d.created_at,E=j?new Date(j):null,O=E&&!Number.isNaN(E.getTime())?`${E.getFullYear()}-${E.getMonth()}-${E.getDate()}`:"";if(O&&O!==$u){const ee=mh(j);to.push(s.jsx("div",{className:"day-pill","data-day-label":ee,children:ee},`day-${O}`)),$u=O}to.push(s.jsxs("div",{className:`message ${d.direction} ${d.type==="note"?"note":""}`,"data-day-key":O,"data-day-label":O?mh(j):"",children:[s.jsx("div",{className:"message-text",children:d.text||`[${d.type}]`}),s.jsx("div",{className:"message-meta",children:Po(d.created_at)})]},d.id))});const km=!!n&&a.role!=="superadmin";return s.jsxs("div",{className:`app-shell ${k==="admin"?"admin-shell":""}`,children:[s.jsx(ey,{navItems:Sm,view:k,onSetView:D,theme:_,onToggleTheme:Jl,user:a,logoUrl:(l==null?void 0:l.logo_url)||"",brandName:Ds,isProfileOpen:Le,onToggleProfile:()=>at(d=>!d),onLogout:ur,onReturnToSuperadmin:Kl,showReturnToSuperadmin:km,getInitial:gh,SunIcon:Gy,MoonIcon:Qy}),k==="admin"?s.jsx(ky,{settingsSection:ge,setSettingsSection:Ke,settingsTab:ct,setSettingsTab:et,rolePermissions:ve,setRolePermissions:Xl,defaultRolePermissions:$n,currentRole:a.role,isAdmin:xm,adminUsers:rr,userForm:Ct,setUserForm:Nn,roleOptions:ut,handleUserSubmit:Kp,handleUserDelete:Xp,settings:Ms,setSettings:qr,handleSaveSettings:Zp,planName:(u==null?void 0:u.plan)||"",branches:ar,services:Dl,branchForm:it,setBranchForm:ir,handleBranchSubmit:rm,handleBranchDisable:am,serviceForm:nt,setServiceForm:ti,handleServiceSubmit:im,handleServiceDisable:lm,handleServiceBranchToggle:om,tenantChannels:N,channelForm:x,setChannelForm:C,handleChannelSelect:tm,handleChannelSubmit:nm,handleRoleDelete:sm,templates:Ce,templateForm:ni,setTemplateForm:Bl,handleTemplateSubmit:cm,handleTemplateSubmitToMeta:um,handleTemplateDelete:dm,handleSyncTemplates:Yp,auditLogs:lr,formatDate:Po,useShellLayout:!0,pageError:Mn,isOffline:M,onDismissError:()=>ae(""),brandName:Ds}):k==="superadmin"?s.jsx("main",{className:"content content-page",children:s.jsx(hh,{onImpersonateTenant:ai,onLogout:ur})}):s.jsxs("main",{className:`content ${k==="chats"?"content-chats":"content-page"}`,children:[k==="chats"&&s.jsx(ty,{activeConversation:W,conversations:ln,channels:N,brandName:Ds,lastReadMap:L,filters:je,showFilters:ue,users:jn,tags:yn,statusOptions:fh,statusLabels:zu,formatListTime:$y,messageBlocks:to,messageDraft:Se,messageMode:Ln,quickActions:jm,tagInput:S,noteInput:Q,notesList:Fl,latestNote:Vl,loadingConversation:dt,isInfoOpen:He,hasUnread:te,scrollDayLabel:de,activeName:Nm,activePhone:wm,activeStatusLabel:_m,canManageStatus:ym,currentUser:a,messageInputRef:T,chatBodyRef:H,setShowFilters:fe,setFilters:Yn,loadConversation:Gl,handleBackToList:o,setIsInfoOpen:_e,handleChatScroll:Zl,handleAssignSelf:le,handleStatusChange:jt,handleToggleTag:cn,handleAddTag:us,setNoteInput:re,handleAddNote:J,reassignUserId:ye,setReassignUserId:Qt,handleReassignConversation:Ee,handleOpenTagManager:()=>bt(!0),handleCloseTagManager:()=>bt(!1),showTagManager:Ue,tagManagerForm:Pn,setTagManagerForm:er,handleCreateTag:li,handleDeleteTag:eo,handleQuickAction:w,handleSendMessage:V,setMessageMode:Rn,setMessageDraft:xn,scrollChatToBottom:cs,getInitial:gh,PlusIcon:Ky,SearchIcon:Yy,VideoIcon:Xy,PhoneIcon:Jy,InfoIcon:Zy,SendIcon:ej}),k==="dashboard"&&s.jsx(ry,{statusCounts:Bu,metrics:ts,onRefresh:wn,brandName:Ds}),k==="campaigns"&&s.jsx(ly,{campaignForm:ht,setCampaignForm:$t,campaignFilter:Pt,setCampaignFilter:Za,templates:Ce,campaigns:tr,selectedCampaignId:Hr,campaignMessages:Xa,users:jn,tags:yn,selectedTemplate:Xr,statusOptions:fh,onCreateCampaign:Xt,onLoadCampaigns:Ut,onLoadCampaignMessages:ds,onSendCampaign:Qp,formatDate:Po,brandName:Ds}),M?s.jsx(ka,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):Mn?s.jsx(ka,{variant:"error",title:"Ocurri un problema",message:Mn,dismissLabel:"Cerrar",onDismiss:()=>ae("")}):null]})]})}const nj=Lp(document.getElementById("root"));nj.render(s.jsx(Jx,{children:s.jsx(tj,{})}));
