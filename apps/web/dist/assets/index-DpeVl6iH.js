(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var ih={exports:{}},ol={},lh={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oa=Symbol.for("react.element"),bm=Symbol.for("react.portal"),Cm=Symbol.for("react.fragment"),Em=Symbol.for("react.strict_mode"),Am=Symbol.for("react.profiler"),Tm=Symbol.for("react.provider"),Lm=Symbol.for("react.context"),Rm=Symbol.for("react.forward_ref"),Om=Symbol.for("react.suspense"),Pm=Symbol.for("react.memo"),Mm=Symbol.for("react.lazy"),Au=Symbol.iterator;function Dm(e){return e===null||typeof e!="object"?null:(e=Au&&e[Au]||e["@@iterator"],typeof e=="function"?e:null)}var oh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ch=Object.assign,uh={};function Lr(e,t,n){this.props=e,this.context=t,this.refs=uh,this.updater=n||oh}Lr.prototype.isReactComponent={};Lr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Lr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function dh(){}dh.prototype=Lr.prototype;function _c(e,t,n){this.props=e,this.context=t,this.refs=uh,this.updater=n||oh}var Sc=_c.prototype=new dh;Sc.constructor=_c;ch(Sc,Lr.prototype);Sc.isPureReactComponent=!0;var Tu=Array.isArray,hh=Object.prototype.hasOwnProperty,kc={current:null},fh={key:!0,ref:!0,__self:!0,__source:!0};function ph(e,t,n){var r,a={},i=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)hh.call(t,r)&&!fh.hasOwnProperty(r)&&(a[r]=t[r]);var o=arguments.length-2;if(o===1)a.children=n;else if(1<o){for(var u=Array(o),m=0;m<o;m++)u[m]=arguments[m+2];a.children=u}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)a[r]===void 0&&(a[r]=o[r]);return{$$typeof:Oa,type:e,key:i,ref:l,props:a,_owner:kc.current}}function Im(e,t){return{$$typeof:Oa,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function bc(e){return typeof e=="object"&&e!==null&&e.$$typeof===Oa}function Bm(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Lu=/\/+/g;function Vl(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Bm(""+e.key):t.toString(36)}function Ni(e,t,n,r,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Oa:case bm:l=!0}}if(l)return l=e,a=a(l),e=r===""?"."+Vl(l,0):r,Tu(a)?(n="",e!=null&&(n=e.replace(Lu,"$&/")+"/"),Ni(a,t,n,"",function(m){return m})):a!=null&&(bc(a)&&(a=Im(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(Lu,"$&/")+"/")+e)),t.push(a)),1;if(l=0,r=r===""?".":r+":",Tu(e))for(var o=0;o<e.length;o++){i=e[o];var u=r+Vl(i,o);l+=Ni(i,t,n,u,a)}else if(u=Dm(e),typeof u=="function")for(e=u.call(e),o=0;!(i=e.next()).done;)i=i.value,u=r+Vl(i,o++),l+=Ni(i,t,n,u,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function ei(e,t,n){if(e==null)return e;var r=[],a=0;return Ni(e,r,"","",function(i){return t.call(n,i,a++)}),r}function zm(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var kt={current:null},wi={transition:null},$m={ReactCurrentDispatcher:kt,ReactCurrentBatchConfig:wi,ReactCurrentOwner:kc};function mh(){throw Error("act(...) is not supported in production builds of React.")}ge.Children={map:ei,forEach:function(e,t,n){ei(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ei(e,function(){t++}),t},toArray:function(e){return ei(e,function(t){return t})||[]},only:function(e){if(!bc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ge.Component=Lr;ge.Fragment=Cm;ge.Profiler=Am;ge.PureComponent=_c;ge.StrictMode=Em;ge.Suspense=Om;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$m;ge.act=mh;ge.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=ch({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=kc.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)hh.call(t,u)&&!fh.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){o=Array(u);for(var m=0;m<u;m++)o[m]=arguments[m+2];r.children=o}return{$$typeof:Oa,type:e.type,key:a,ref:i,props:r,_owner:l}};ge.createContext=function(e){return e={$$typeof:Lm,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Tm,_context:e},e.Consumer=e};ge.createElement=ph;ge.createFactory=function(e){var t=ph.bind(null,e);return t.type=e,t};ge.createRef=function(){return{current:null}};ge.forwardRef=function(e){return{$$typeof:Rm,render:e}};ge.isValidElement=bc;ge.lazy=function(e){return{$$typeof:Mm,_payload:{_status:-1,_result:e},_init:zm}};ge.memo=function(e,t){return{$$typeof:Pm,type:e,compare:t===void 0?null:t}};ge.startTransition=function(e){var t=wi.transition;wi.transition={};try{e()}finally{wi.transition=t}};ge.unstable_act=mh;ge.useCallback=function(e,t){return kt.current.useCallback(e,t)};ge.useContext=function(e){return kt.current.useContext(e)};ge.useDebugValue=function(){};ge.useDeferredValue=function(e){return kt.current.useDeferredValue(e)};ge.useEffect=function(e,t){return kt.current.useEffect(e,t)};ge.useId=function(){return kt.current.useId()};ge.useImperativeHandle=function(e,t,n){return kt.current.useImperativeHandle(e,t,n)};ge.useInsertionEffect=function(e,t){return kt.current.useInsertionEffect(e,t)};ge.useLayoutEffect=function(e,t){return kt.current.useLayoutEffect(e,t)};ge.useMemo=function(e,t){return kt.current.useMemo(e,t)};ge.useReducer=function(e,t,n){return kt.current.useReducer(e,t,n)};ge.useRef=function(e){return kt.current.useRef(e)};ge.useState=function(e){return kt.current.useState(e)};ge.useSyncExternalStore=function(e,t,n){return kt.current.useSyncExternalStore(e,t,n)};ge.useTransition=function(){return kt.current.useTransition()};ge.version="18.3.1";lh.exports=ge;var f=lh.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Um=f,Vm=Symbol.for("react.element"),Fm=Symbol.for("react.fragment"),Wm=Object.prototype.hasOwnProperty,Hm=Um.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qm={key:!0,ref:!0,__self:!0,__source:!0};function gh(e,t,n){var r,a={},i=null,l=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)Wm.call(t,r)&&!qm.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Vm,type:e,key:i,ref:l,props:a,_owner:Hm.current}}ol.Fragment=Fm;ol.jsx=gh;ol.jsxs=gh;ih.exports=ol;var s=ih.exports,vh={exports:{}},Ut={},xh={exports:{}},yh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(V,Q){var ne=V.length;V.push(Q);e:for(;0<ne;){var re=ne-1>>>1,de=V[re];if(0<a(de,Q))V[re]=Q,V[ne]=de,ne=re;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var Q=V[0],ne=V.pop();if(ne!==Q){V[0]=ne;e:for(var re=0,de=V.length,be=de>>>1;re<be;){var A=2*(re+1)-1,H=V[A],k=A+1,U=V[k];if(0>a(H,ne))k<de&&0>a(U,H)?(V[re]=U,V[k]=ne,re=k):(V[re]=H,V[A]=ne,re=A);else if(k<de&&0>a(U,ne))V[re]=U,V[k]=ne,re=k;else break e}}return Q}function a(V,Q){var ne=V.sortIndex-Q.sortIndex;return ne!==0?ne:V.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var u=[],m=[],w=1,v=null,x=3,C=!1,L=!1,R=!1,g=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(V){for(var Q=n(m);Q!==null;){if(Q.callback===null)r(m);else if(Q.startTime<=V)r(m),Q.sortIndex=Q.expirationTime,t(u,Q);else break;Q=n(m)}}function S(V){if(R=!1,y(V),!L)if(n(u)!==null)L=!0,Ae(D);else{var Q=n(m);Q!==null&&tt(S,Q.startTime-V)}}function D(V,Q){L=!1,R&&(R=!1,h(_),_=-1),C=!0;var ne=x;try{for(y(Q),v=n(u);v!==null&&(!(v.expirationTime>Q)||V&&!K());){var re=v.callback;if(typeof re=="function"){v.callback=null,x=v.priorityLevel;var de=re(v.expirationTime<=Q);Q=e.unstable_now(),typeof de=="function"?v.callback=de:v===n(u)&&r(u),y(Q)}else r(u);v=n(u)}if(v!==null)var be=!0;else{var A=n(m);A!==null&&tt(S,A.startTime-Q),be=!1}return be}finally{v=null,x=ne,C=!1}}var z=!1,I=null,_=-1,P=5,M=-1;function K(){return!(e.unstable_now()-M<P)}function ue(){if(I!==null){var V=e.unstable_now();M=V;var Q=!0;try{Q=I(!0,V)}finally{Q?pe():(z=!1,I=null)}}else z=!1}var pe;if(typeof p=="function")pe=function(){p(ue)};else if(typeof MessageChannel<"u"){var We=new MessageChannel,Se=We.port2;We.port1.onmessage=ue,pe=function(){Se.postMessage(null)}}else pe=function(){g(ue,0)};function Ae(V){I=V,z||(z=!0,pe())}function tt(V,Q){_=g(function(){V(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){L||C||(L=!0,Ae(D))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(V){switch(x){case 1:case 2:case 3:var Q=3;break;default:Q=x}var ne=x;x=Q;try{return V()}finally{x=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,Q){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ne=x;x=V;try{return Q()}finally{x=ne}},e.unstable_scheduleCallback=function(V,Q,ne){var re=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?re+ne:re):ne=re,V){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=ne+de,V={id:w++,callback:Q,priorityLevel:V,startTime:ne,expirationTime:de,sortIndex:-1},ne>re?(V.sortIndex=ne,t(m,V),n(u)===null&&V===n(m)&&(R?(h(_),_=-1):R=!0,tt(S,ne-re))):(V.sortIndex=de,t(u,V),L||C||(L=!0,Ae(D))),V},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(V){var Q=x;return function(){var ne=x;x=Q;try{return V.apply(this,arguments)}finally{x=ne}}}})(yh);xh.exports=yh;var Qm=xh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gm=f,$t=Qm;function B(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jh=new Set,ga={};function Gs(e,t){Sr(e,t),Sr(e+"Capture",t)}function Sr(e,t){for(ga[e]=t,e=0;e<t.length;e++)jh.add(t[e])}var qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wo=Object.prototype.hasOwnProperty,Ym=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ru={},Ou={};function Km(e){return wo.call(Ou,e)?!0:wo.call(Ru,e)?!1:Ym.test(e)?Ou[e]=!0:(Ru[e]=!0,!1)}function Xm(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Jm(e,t,n,r){if(t===null||typeof t>"u"||Xm(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function bt(e,t,n,r,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var ut={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ut[e]=new bt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ut[t]=new bt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ut[e]=new bt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ut[e]=new bt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ut[e]=new bt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ut[e]=new bt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ut[e]=new bt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ut[e]=new bt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ut[e]=new bt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Cc=/[\-:]([a-z])/g;function Ec(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Cc,Ec);ut[t]=new bt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Cc,Ec);ut[t]=new bt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Cc,Ec);ut[t]=new bt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ut[e]=new bt(e,1,!1,e.toLowerCase(),null,!1,!1)});ut.xlinkHref=new bt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ut[e]=new bt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ac(e,t,n,r){var a=ut.hasOwnProperty(t)?ut[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Jm(t,n,a,r)&&(n=null),r||a===null?Km(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Kn=Gm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ti=Symbol.for("react.element"),ir=Symbol.for("react.portal"),lr=Symbol.for("react.fragment"),Tc=Symbol.for("react.strict_mode"),_o=Symbol.for("react.profiler"),Nh=Symbol.for("react.provider"),wh=Symbol.for("react.context"),Lc=Symbol.for("react.forward_ref"),So=Symbol.for("react.suspense"),ko=Symbol.for("react.suspense_list"),Rc=Symbol.for("react.memo"),cs=Symbol.for("react.lazy"),_h=Symbol.for("react.offscreen"),Pu=Symbol.iterator;function qr(e){return e===null||typeof e!="object"?null:(e=Pu&&e[Pu]||e["@@iterator"],typeof e=="function"?e:null)}var Fe=Object.assign,Fl;function ta(e){if(Fl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Fl=t&&t[1]||""}return`
`+Fl+e}var Wl=!1;function Hl(e,t){if(!e||Wl)return"";Wl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(m){var r=m}Reflect.construct(e,[],t)}else{try{t.call()}catch(m){r=m}e.call(t.prototype)}else{try{throw Error()}catch(m){r=m}e()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var a=m.stack.split(`
`),i=r.stack.split(`
`),l=a.length-1,o=i.length-1;1<=l&&0<=o&&a[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(a[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||a[l]!==i[o]){var u=`
`+a[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=o);break}}}finally{Wl=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ta(e):""}function Zm(e){switch(e.tag){case 5:return ta(e.type);case 16:return ta("Lazy");case 13:return ta("Suspense");case 19:return ta("SuspenseList");case 0:case 2:case 15:return e=Hl(e.type,!1),e;case 11:return e=Hl(e.type.render,!1),e;case 1:return e=Hl(e.type,!0),e;default:return""}}function bo(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case lr:return"Fragment";case ir:return"Portal";case _o:return"Profiler";case Tc:return"StrictMode";case So:return"Suspense";case ko:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case wh:return(e.displayName||"Context")+".Consumer";case Nh:return(e._context.displayName||"Context")+".Provider";case Lc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Rc:return t=e.displayName||null,t!==null?t:bo(e.type)||"Memo";case cs:t=e._payload,e=e._init;try{return bo(e(t))}catch{}}return null}function eg(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bo(t);case 8:return t===Tc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ss(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Sh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function tg(e){var t=Sh(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){r=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ni(e){e._valueTracker||(e._valueTracker=tg(e))}function kh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Sh(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ii(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Co(e,t){var n=t.checked;return Fe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Mu(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Ss(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function bh(e,t){t=t.checked,t!=null&&Ac(e,"checked",t,!1)}function Eo(e,t){bh(e,t);var n=Ss(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ao(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ao(e,t.type,Ss(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Du(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ao(e,t,n){(t!=="number"||Ii(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var na=Array.isArray;function xr(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ss(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function To(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(B(91));return Fe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Iu(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(B(92));if(na(n)){if(1<n.length)throw Error(B(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ss(n)}}function Ch(e,t){var n=Ss(t.value),r=Ss(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Bu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Eh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lo(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Eh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var si,Ah=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(si=si||document.createElement("div"),si.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=si.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function va(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ia={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ng=["Webkit","ms","Moz","O"];Object.keys(ia).forEach(function(e){ng.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ia[t]=ia[e]})});function Th(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ia.hasOwnProperty(e)&&ia[e]?(""+t).trim():t+"px"}function Lh(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=Th(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var sg=Fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ro(e,t){if(t){if(sg[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(B(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(B(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(B(61))}if(t.style!=null&&typeof t.style!="object")throw Error(B(62))}}function Oo(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Po=null;function Oc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Mo=null,yr=null,jr=null;function zu(e){if(e=Da(e)){if(typeof Mo!="function")throw Error(B(280));var t=e.stateNode;t&&(t=fl(t),Mo(e.stateNode,e.type,t))}}function Rh(e){yr?jr?jr.push(e):jr=[e]:yr=e}function Oh(){if(yr){var e=yr,t=jr;if(jr=yr=null,zu(e),t)for(e=0;e<t.length;e++)zu(t[e])}}function Ph(e,t){return e(t)}function Mh(){}var ql=!1;function Dh(e,t,n){if(ql)return e(t,n);ql=!0;try{return Ph(e,t,n)}finally{ql=!1,(yr!==null||jr!==null)&&(Mh(),Oh())}}function xa(e,t){var n=e.stateNode;if(n===null)return null;var r=fl(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(B(231,t,typeof n));return n}var Do=!1;if(qn)try{var Qr={};Object.defineProperty(Qr,"passive",{get:function(){Do=!0}}),window.addEventListener("test",Qr,Qr),window.removeEventListener("test",Qr,Qr)}catch{Do=!1}function rg(e,t,n,r,a,i,l,o,u){var m=Array.prototype.slice.call(arguments,3);try{t.apply(n,m)}catch(w){this.onError(w)}}var la=!1,Bi=null,zi=!1,Io=null,ag={onError:function(e){la=!0,Bi=e}};function ig(e,t,n,r,a,i,l,o,u){la=!1,Bi=null,rg.apply(ag,arguments)}function lg(e,t,n,r,a,i,l,o,u){if(ig.apply(this,arguments),la){if(la){var m=Bi;la=!1,Bi=null}else throw Error(B(198));zi||(zi=!0,Io=m)}}function Ys(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Ih(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function $u(e){if(Ys(e)!==e)throw Error(B(188))}function og(e){var t=e.alternate;if(!t){if(t=Ys(e),t===null)throw Error(B(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return $u(a),e;if(i===r)return $u(a),t;i=i.sibling}throw Error(B(188))}if(n.return!==r.return)n=a,r=i;else{for(var l=!1,o=a.child;o;){if(o===n){l=!0,n=a,r=i;break}if(o===r){l=!0,r=a,n=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===n){l=!0,n=i,r=a;break}if(o===r){l=!0,r=i,n=a;break}o=o.sibling}if(!l)throw Error(B(189))}}if(n.alternate!==r)throw Error(B(190))}if(n.tag!==3)throw Error(B(188));return n.stateNode.current===n?e:t}function Bh(e){return e=og(e),e!==null?zh(e):null}function zh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=zh(e);if(t!==null)return t;e=e.sibling}return null}var $h=$t.unstable_scheduleCallback,Uu=$t.unstable_cancelCallback,cg=$t.unstable_shouldYield,ug=$t.unstable_requestPaint,Ge=$t.unstable_now,dg=$t.unstable_getCurrentPriorityLevel,Pc=$t.unstable_ImmediatePriority,Uh=$t.unstable_UserBlockingPriority,$i=$t.unstable_NormalPriority,hg=$t.unstable_LowPriority,Vh=$t.unstable_IdlePriority,cl=null,Sn=null;function fg(e){if(Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot(cl,e,void 0,(e.current.flags&128)===128)}catch{}}var fn=Math.clz32?Math.clz32:gg,pg=Math.log,mg=Math.LN2;function gg(e){return e>>>=0,e===0?32:31-(pg(e)/mg|0)|0}var ri=64,ai=4194304;function sa(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ui(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,l=n&268435455;if(l!==0){var o=l&~a;o!==0?r=sa(o):(i&=l,i!==0&&(r=sa(i)))}else l=n&~a,l!==0?r=sa(l):i!==0&&(r=sa(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-fn(t),a=1<<n,r|=e[n],t&=~a;return r}function vg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xg(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-fn(i),o=1<<l,u=a[l];u===-1?(!(o&n)||o&r)&&(a[l]=vg(o,t)):u<=t&&(e.expiredLanes|=o),i&=~o}}function Bo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Fh(){var e=ri;return ri<<=1,!(ri&4194240)&&(ri=64),e}function Ql(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Pa(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-fn(t),e[t]=n}function yg(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-fn(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}function Mc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-fn(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var ke=0;function Wh(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Hh,Dc,qh,Qh,Gh,zo=!1,ii=[],ms=null,gs=null,vs=null,ya=new Map,ja=new Map,ds=[],jg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vu(e,t){switch(e){case"focusin":case"focusout":ms=null;break;case"dragenter":case"dragleave":gs=null;break;case"mouseover":case"mouseout":vs=null;break;case"pointerover":case"pointerout":ya.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ja.delete(t.pointerId)}}function Gr(e,t,n,r,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Da(t),t!==null&&Dc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Ng(e,t,n,r,a){switch(t){case"focusin":return ms=Gr(ms,e,t,n,r,a),!0;case"dragenter":return gs=Gr(gs,e,t,n,r,a),!0;case"mouseover":return vs=Gr(vs,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return ya.set(i,Gr(ya.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,ja.set(i,Gr(ja.get(i)||null,e,t,n,r,a)),!0}return!1}function Yh(e){var t=Bs(e.target);if(t!==null){var n=Ys(t);if(n!==null){if(t=n.tag,t===13){if(t=Ih(n),t!==null){e.blockedOn=t,Gh(e.priority,function(){qh(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _i(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=$o(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Po=r,n.target.dispatchEvent(r),Po=null}else return t=Da(n),t!==null&&Dc(t),e.blockedOn=n,!1;t.shift()}return!0}function Fu(e,t,n){_i(e)&&n.delete(t)}function wg(){zo=!1,ms!==null&&_i(ms)&&(ms=null),gs!==null&&_i(gs)&&(gs=null),vs!==null&&_i(vs)&&(vs=null),ya.forEach(Fu),ja.forEach(Fu)}function Yr(e,t){e.blockedOn===t&&(e.blockedOn=null,zo||(zo=!0,$t.unstable_scheduleCallback($t.unstable_NormalPriority,wg)))}function Na(e){function t(a){return Yr(a,e)}if(0<ii.length){Yr(ii[0],e);for(var n=1;n<ii.length;n++){var r=ii[n];r.blockedOn===e&&(r.blockedOn=null)}}for(ms!==null&&Yr(ms,e),gs!==null&&Yr(gs,e),vs!==null&&Yr(vs,e),ya.forEach(t),ja.forEach(t),n=0;n<ds.length;n++)r=ds[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<ds.length&&(n=ds[0],n.blockedOn===null);)Yh(n),n.blockedOn===null&&ds.shift()}var Nr=Kn.ReactCurrentBatchConfig,Vi=!0;function _g(e,t,n,r){var a=ke,i=Nr.transition;Nr.transition=null;try{ke=1,Ic(e,t,n,r)}finally{ke=a,Nr.transition=i}}function Sg(e,t,n,r){var a=ke,i=Nr.transition;Nr.transition=null;try{ke=4,Ic(e,t,n,r)}finally{ke=a,Nr.transition=i}}function Ic(e,t,n,r){if(Vi){var a=$o(e,t,n,r);if(a===null)so(e,t,r,Fi,n),Vu(e,r);else if(Ng(a,e,t,n,r))r.stopPropagation();else if(Vu(e,r),t&4&&-1<jg.indexOf(e)){for(;a!==null;){var i=Da(a);if(i!==null&&Hh(i),i=$o(e,t,n,r),i===null&&so(e,t,r,Fi,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else so(e,t,r,null,n)}}var Fi=null;function $o(e,t,n,r){if(Fi=null,e=Oc(r),e=Bs(e),e!==null)if(t=Ys(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Ih(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Fi=e,null}function Kh(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dg()){case Pc:return 1;case Uh:return 4;case $i:case hg:return 16;case Vh:return 536870912;default:return 16}default:return 16}}var fs=null,Bc=null,Si=null;function Xh(){if(Si)return Si;var e,t=Bc,n=t.length,r,a="value"in fs?fs.value:fs.textContent,i=a.length;for(e=0;e<n&&t[e]===a[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===a[i-r];r++);return Si=a.slice(e,1<r?1-r:void 0)}function ki(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function li(){return!0}function Wu(){return!1}function Vt(e){function t(n,r,a,i,l){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?li:Wu,this.isPropagationStopped=Wu,this}return Fe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=li)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=li)},persist:function(){},isPersistent:li}),t}var Rr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zc=Vt(Rr),Ma=Fe({},Rr,{view:0,detail:0}),kg=Vt(Ma),Gl,Yl,Kr,ul=Fe({},Ma,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$c,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Kr&&(Kr&&e.type==="mousemove"?(Gl=e.screenX-Kr.screenX,Yl=e.screenY-Kr.screenY):Yl=Gl=0,Kr=e),Gl)},movementY:function(e){return"movementY"in e?e.movementY:Yl}}),Hu=Vt(ul),bg=Fe({},ul,{dataTransfer:0}),Cg=Vt(bg),Eg=Fe({},Ma,{relatedTarget:0}),Kl=Vt(Eg),Ag=Fe({},Rr,{animationName:0,elapsedTime:0,pseudoElement:0}),Tg=Vt(Ag),Lg=Fe({},Rr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Rg=Vt(Lg),Og=Fe({},Rr,{data:0}),qu=Vt(Og),Pg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ig(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Dg[e])?!!t[e]:!1}function $c(){return Ig}var Bg=Fe({},Ma,{key:function(e){if(e.key){var t=Pg[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ki(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Mg[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$c,charCode:function(e){return e.type==="keypress"?ki(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ki(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),zg=Vt(Bg),$g=Fe({},ul,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qu=Vt($g),Ug=Fe({},Ma,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$c}),Vg=Vt(Ug),Fg=Fe({},Rr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wg=Vt(Fg),Hg=Fe({},ul,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qg=Vt(Hg),Qg=[9,13,27,32],Uc=qn&&"CompositionEvent"in window,oa=null;qn&&"documentMode"in document&&(oa=document.documentMode);var Gg=qn&&"TextEvent"in window&&!oa,Jh=qn&&(!Uc||oa&&8<oa&&11>=oa),Gu=" ",Yu=!1;function Zh(e,t){switch(e){case"keyup":return Qg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ef(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var or=!1;function Yg(e,t){switch(e){case"compositionend":return ef(t);case"keypress":return t.which!==32?null:(Yu=!0,Gu);case"textInput":return e=t.data,e===Gu&&Yu?null:e;default:return null}}function Kg(e,t){if(or)return e==="compositionend"||!Uc&&Zh(e,t)?(e=Xh(),Si=Bc=fs=null,or=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Jh&&t.locale!=="ko"?null:t.data;default:return null}}var Xg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ku(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xg[e.type]:t==="textarea"}function tf(e,t,n,r){Rh(r),t=Wi(t,"onChange"),0<t.length&&(n=new zc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ca=null,wa=null;function Jg(e){ff(e,0)}function dl(e){var t=dr(e);if(kh(t))return e}function Zg(e,t){if(e==="change")return t}var nf=!1;if(qn){var Xl;if(qn){var Jl="oninput"in document;if(!Jl){var Xu=document.createElement("div");Xu.setAttribute("oninput","return;"),Jl=typeof Xu.oninput=="function"}Xl=Jl}else Xl=!1;nf=Xl&&(!document.documentMode||9<document.documentMode)}function Ju(){ca&&(ca.detachEvent("onpropertychange",sf),wa=ca=null)}function sf(e){if(e.propertyName==="value"&&dl(wa)){var t=[];tf(t,wa,e,Oc(e)),Dh(Jg,t)}}function ev(e,t,n){e==="focusin"?(Ju(),ca=t,wa=n,ca.attachEvent("onpropertychange",sf)):e==="focusout"&&Ju()}function tv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return dl(wa)}function nv(e,t){if(e==="click")return dl(t)}function sv(e,t){if(e==="input"||e==="change")return dl(t)}function rv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var mn=typeof Object.is=="function"?Object.is:rv;function _a(e,t){if(mn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!wo.call(t,a)||!mn(e[a],t[a]))return!1}return!0}function Zu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ed(e,t){var n=Zu(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zu(n)}}function rf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?rf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function af(){for(var e=window,t=Ii();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ii(e.document)}return t}function Vc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function av(e){var t=af(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&rf(n.ownerDocument.documentElement,n)){if(r!==null&&Vc(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=ed(n,i);var l=ed(n,r);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var iv=qn&&"documentMode"in document&&11>=document.documentMode,cr=null,Uo=null,ua=null,Vo=!1;function td(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Vo||cr==null||cr!==Ii(r)||(r=cr,"selectionStart"in r&&Vc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ua&&_a(ua,r)||(ua=r,r=Wi(Uo,"onSelect"),0<r.length&&(t=new zc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=cr)))}function oi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ur={animationend:oi("Animation","AnimationEnd"),animationiteration:oi("Animation","AnimationIteration"),animationstart:oi("Animation","AnimationStart"),transitionend:oi("Transition","TransitionEnd")},Zl={},lf={};qn&&(lf=document.createElement("div").style,"AnimationEvent"in window||(delete ur.animationend.animation,delete ur.animationiteration.animation,delete ur.animationstart.animation),"TransitionEvent"in window||delete ur.transitionend.transition);function hl(e){if(Zl[e])return Zl[e];if(!ur[e])return e;var t=ur[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in lf)return Zl[e]=t[n];return e}var of=hl("animationend"),cf=hl("animationiteration"),uf=hl("animationstart"),df=hl("transitionend"),hf=new Map,nd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bs(e,t){hf.set(e,t),Gs(t,[e])}for(var eo=0;eo<nd.length;eo++){var to=nd[eo],lv=to.toLowerCase(),ov=to[0].toUpperCase()+to.slice(1);bs(lv,"on"+ov)}bs(of,"onAnimationEnd");bs(cf,"onAnimationIteration");bs(uf,"onAnimationStart");bs("dblclick","onDoubleClick");bs("focusin","onFocus");bs("focusout","onBlur");bs(df,"onTransitionEnd");Sr("onMouseEnter",["mouseout","mouseover"]);Sr("onMouseLeave",["mouseout","mouseover"]);Sr("onPointerEnter",["pointerout","pointerover"]);Sr("onPointerLeave",["pointerout","pointerover"]);Gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ra="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cv=new Set("cancel close invalid load scroll toggle".split(" ").concat(ra));function sd(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,lg(r,t,void 0,e),e.currentTarget=null}function ff(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var l=r.length-1;0<=l;l--){var o=r[l],u=o.instance,m=o.currentTarget;if(o=o.listener,u!==i&&a.isPropagationStopped())break e;sd(a,o,m),i=u}else for(l=0;l<r.length;l++){if(o=r[l],u=o.instance,m=o.currentTarget,o=o.listener,u!==i&&a.isPropagationStopped())break e;sd(a,o,m),i=u}}}if(zi)throw e=Io,zi=!1,Io=null,e}function De(e,t){var n=t[Qo];n===void 0&&(n=t[Qo]=new Set);var r=e+"__bubble";n.has(r)||(pf(t,e,2,!1),n.add(r))}function no(e,t,n){var r=0;t&&(r|=4),pf(n,e,r,t)}var ci="_reactListening"+Math.random().toString(36).slice(2);function Sa(e){if(!e[ci]){e[ci]=!0,jh.forEach(function(n){n!=="selectionchange"&&(cv.has(n)||no(n,!1,e),no(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ci]||(t[ci]=!0,no("selectionchange",!1,t))}}function pf(e,t,n,r){switch(Kh(t)){case 1:var a=_g;break;case 4:a=Sg;break;default:a=Ic}n=a.bind(null,t,n,e),a=void 0,!Do||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function so(e,t,n,r,a){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var o=r.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(l===4)for(l=r.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;l=l.return}for(;o!==null;){if(l=Bs(o),l===null)return;if(u=l.tag,u===5||u===6){r=i=l;continue e}o=o.parentNode}}r=r.return}Dh(function(){var m=i,w=Oc(n),v=[];e:{var x=hf.get(e);if(x!==void 0){var C=zc,L=e;switch(e){case"keypress":if(ki(n)===0)break e;case"keydown":case"keyup":C=zg;break;case"focusin":L="focus",C=Kl;break;case"focusout":L="blur",C=Kl;break;case"beforeblur":case"afterblur":C=Kl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=Hu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Cg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=Vg;break;case of:case cf:case uf:C=Tg;break;case df:C=Wg;break;case"scroll":C=kg;break;case"wheel":C=qg;break;case"copy":case"cut":case"paste":C=Rg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=Qu}var R=(t&4)!==0,g=!R&&e==="scroll",h=R?x!==null?x+"Capture":null:x;R=[];for(var p=m,y;p!==null;){y=p;var S=y.stateNode;if(y.tag===5&&S!==null&&(y=S,h!==null&&(S=xa(p,h),S!=null&&R.push(ka(p,S,y)))),g)break;p=p.return}0<R.length&&(x=new C(x,L,null,n,w),v.push({event:x,listeners:R}))}}if(!(t&7)){e:{if(x=e==="mouseover"||e==="pointerover",C=e==="mouseout"||e==="pointerout",x&&n!==Po&&(L=n.relatedTarget||n.fromElement)&&(Bs(L)||L[Qn]))break e;if((C||x)&&(x=w.window===w?w:(x=w.ownerDocument)?x.defaultView||x.parentWindow:window,C?(L=n.relatedTarget||n.toElement,C=m,L=L?Bs(L):null,L!==null&&(g=Ys(L),L!==g||L.tag!==5&&L.tag!==6)&&(L=null)):(C=null,L=m),C!==L)){if(R=Hu,S="onMouseLeave",h="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(R=Qu,S="onPointerLeave",h="onPointerEnter",p="pointer"),g=C==null?x:dr(C),y=L==null?x:dr(L),x=new R(S,p+"leave",C,n,w),x.target=g,x.relatedTarget=y,S=null,Bs(w)===m&&(R=new R(h,p+"enter",L,n,w),R.target=y,R.relatedTarget=g,S=R),g=S,C&&L)t:{for(R=C,h=L,p=0,y=R;y;y=rr(y))p++;for(y=0,S=h;S;S=rr(S))y++;for(;0<p-y;)R=rr(R),p--;for(;0<y-p;)h=rr(h),y--;for(;p--;){if(R===h||h!==null&&R===h.alternate)break t;R=rr(R),h=rr(h)}R=null}else R=null;C!==null&&rd(v,x,C,R,!1),L!==null&&g!==null&&rd(v,g,L,R,!0)}}e:{if(x=m?dr(m):window,C=x.nodeName&&x.nodeName.toLowerCase(),C==="select"||C==="input"&&x.type==="file")var D=Zg;else if(Ku(x))if(nf)D=sv;else{D=tv;var z=ev}else(C=x.nodeName)&&C.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(D=nv);if(D&&(D=D(e,m))){tf(v,D,n,w);break e}z&&z(e,x,m),e==="focusout"&&(z=x._wrapperState)&&z.controlled&&x.type==="number"&&Ao(x,"number",x.value)}switch(z=m?dr(m):window,e){case"focusin":(Ku(z)||z.contentEditable==="true")&&(cr=z,Uo=m,ua=null);break;case"focusout":ua=Uo=cr=null;break;case"mousedown":Vo=!0;break;case"contextmenu":case"mouseup":case"dragend":Vo=!1,td(v,n,w);break;case"selectionchange":if(iv)break;case"keydown":case"keyup":td(v,n,w)}var I;if(Uc)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else or?Zh(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(Jh&&n.locale!=="ko"&&(or||_!=="onCompositionStart"?_==="onCompositionEnd"&&or&&(I=Xh()):(fs=w,Bc="value"in fs?fs.value:fs.textContent,or=!0)),z=Wi(m,_),0<z.length&&(_=new qu(_,e,null,n,w),v.push({event:_,listeners:z}),I?_.data=I:(I=ef(n),I!==null&&(_.data=I)))),(I=Gg?Yg(e,n):Kg(e,n))&&(m=Wi(m,"onBeforeInput"),0<m.length&&(w=new qu("onBeforeInput","beforeinput",null,n,w),v.push({event:w,listeners:m}),w.data=I))}ff(v,t)})}function ka(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wi(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=xa(e,n),i!=null&&r.unshift(ka(e,i,a)),i=xa(e,t),i!=null&&r.push(ka(e,i,a))),e=e.return}return r}function rr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function rd(e,t,n,r,a){for(var i=t._reactName,l=[];n!==null&&n!==r;){var o=n,u=o.alternate,m=o.stateNode;if(u!==null&&u===r)break;o.tag===5&&m!==null&&(o=m,a?(u=xa(n,i),u!=null&&l.unshift(ka(n,u,o))):a||(u=xa(n,i),u!=null&&l.push(ka(n,u,o)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var uv=/\r\n?/g,dv=/\u0000|\uFFFD/g;function ad(e){return(typeof e=="string"?e:""+e).replace(uv,`
`).replace(dv,"")}function ui(e,t,n){if(t=ad(t),ad(e)!==t&&n)throw Error(B(425))}function Hi(){}var Fo=null,Wo=null;function Ho(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var qo=typeof setTimeout=="function"?setTimeout:void 0,hv=typeof clearTimeout=="function"?clearTimeout:void 0,id=typeof Promise=="function"?Promise:void 0,fv=typeof queueMicrotask=="function"?queueMicrotask:typeof id<"u"?function(e){return id.resolve(null).then(e).catch(pv)}:qo;function pv(e){setTimeout(function(){throw e})}function ro(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),Na(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Na(t)}function xs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ld(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Or=Math.random().toString(36).slice(2),_n="__reactFiber$"+Or,ba="__reactProps$"+Or,Qn="__reactContainer$"+Or,Qo="__reactEvents$"+Or,mv="__reactListeners$"+Or,gv="__reactHandles$"+Or;function Bs(e){var t=e[_n];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Qn]||n[_n]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ld(e);e!==null;){if(n=e[_n])return n;e=ld(e)}return t}e=n,n=e.parentNode}return null}function Da(e){return e=e[_n]||e[Qn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function dr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(B(33))}function fl(e){return e[ba]||null}var Go=[],hr=-1;function Cs(e){return{current:e}}function Ie(e){0>hr||(e.current=Go[hr],Go[hr]=null,hr--)}function Pe(e,t){hr++,Go[hr]=e.current,e.current=t}var ks={},vt=Cs(ks),Lt=Cs(!1),Fs=ks;function kr(e,t){var n=e.type.contextTypes;if(!n)return ks;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Rt(e){return e=e.childContextTypes,e!=null}function qi(){Ie(Lt),Ie(vt)}function od(e,t,n){if(vt.current!==ks)throw Error(B(168));Pe(vt,t),Pe(Lt,n)}function mf(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(B(108,eg(e)||"Unknown",a));return Fe({},n,r)}function Qi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ks,Fs=vt.current,Pe(vt,e),Pe(Lt,Lt.current),!0}function cd(e,t,n){var r=e.stateNode;if(!r)throw Error(B(169));n?(e=mf(e,t,Fs),r.__reactInternalMemoizedMergedChildContext=e,Ie(Lt),Ie(vt),Pe(vt,e)):Ie(Lt),Pe(Lt,n)}var $n=null,pl=!1,ao=!1;function gf(e){$n===null?$n=[e]:$n.push(e)}function vv(e){pl=!0,gf(e)}function Es(){if(!ao&&$n!==null){ao=!0;var e=0,t=ke;try{var n=$n;for(ke=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}$n=null,pl=!1}catch(a){throw $n!==null&&($n=$n.slice(e+1)),$h(Pc,Es),a}finally{ke=t,ao=!1}}return null}var fr=[],pr=0,Gi=null,Yi=0,Kt=[],Xt=0,Ws=null,Fn=1,Wn="";function Ds(e,t){fr[pr++]=Yi,fr[pr++]=Gi,Gi=e,Yi=t}function vf(e,t,n){Kt[Xt++]=Fn,Kt[Xt++]=Wn,Kt[Xt++]=Ws,Ws=e;var r=Fn;e=Wn;var a=32-fn(r)-1;r&=~(1<<a),n+=1;var i=32-fn(t)+a;if(30<i){var l=a-a%5;i=(r&(1<<l)-1).toString(32),r>>=l,a-=l,Fn=1<<32-fn(t)+a|n<<a|r,Wn=i+e}else Fn=1<<i|n<<a|r,Wn=e}function Fc(e){e.return!==null&&(Ds(e,1),vf(e,1,0))}function Wc(e){for(;e===Gi;)Gi=fr[--pr],fr[pr]=null,Yi=fr[--pr],fr[pr]=null;for(;e===Ws;)Ws=Kt[--Xt],Kt[Xt]=null,Wn=Kt[--Xt],Kt[Xt]=null,Fn=Kt[--Xt],Kt[Xt]=null}var zt=null,Bt=null,$e=!1,hn=null;function xf(e,t){var n=Zt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function ud(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,zt=e,Bt=xs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,zt=e,Bt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ws!==null?{id:Fn,overflow:Wn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Zt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,zt=e,Bt=null,!0):!1;default:return!1}}function Yo(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ko(e){if($e){var t=Bt;if(t){var n=t;if(!ud(e,t)){if(Yo(e))throw Error(B(418));t=xs(n.nextSibling);var r=zt;t&&ud(e,t)?xf(r,n):(e.flags=e.flags&-4097|2,$e=!1,zt=e)}}else{if(Yo(e))throw Error(B(418));e.flags=e.flags&-4097|2,$e=!1,zt=e}}}function dd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;zt=e}function di(e){if(e!==zt)return!1;if(!$e)return dd(e),$e=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ho(e.type,e.memoizedProps)),t&&(t=Bt)){if(Yo(e))throw yf(),Error(B(418));for(;t;)xf(e,t),t=xs(t.nextSibling)}if(dd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(B(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Bt=xs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Bt=null}}else Bt=zt?xs(e.stateNode.nextSibling):null;return!0}function yf(){for(var e=Bt;e;)e=xs(e.nextSibling)}function br(){Bt=zt=null,$e=!1}function Hc(e){hn===null?hn=[e]:hn.push(e)}var xv=Kn.ReactCurrentBatchConfig;function Xr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(B(309));var r=n.stateNode}if(!r)throw Error(B(147,e));var a=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=a.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(B(284));if(!n._owner)throw Error(B(290,e))}return e}function hi(e,t){throw e=Object.prototype.toString.call(t),Error(B(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function hd(e){var t=e._init;return t(e._payload)}function jf(e){function t(h,p){if(e){var y=h.deletions;y===null?(h.deletions=[p],h.flags|=16):y.push(p)}}function n(h,p){if(!e)return null;for(;p!==null;)t(h,p),p=p.sibling;return null}function r(h,p){for(h=new Map;p!==null;)p.key!==null?h.set(p.key,p):h.set(p.index,p),p=p.sibling;return h}function a(h,p){return h=ws(h,p),h.index=0,h.sibling=null,h}function i(h,p,y){return h.index=y,e?(y=h.alternate,y!==null?(y=y.index,y<p?(h.flags|=2,p):y):(h.flags|=2,p)):(h.flags|=1048576,p)}function l(h){return e&&h.alternate===null&&(h.flags|=2),h}function o(h,p,y,S){return p===null||p.tag!==6?(p=fo(y,h.mode,S),p.return=h,p):(p=a(p,y),p.return=h,p)}function u(h,p,y,S){var D=y.type;return D===lr?w(h,p,y.props.children,S,y.key):p!==null&&(p.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===cs&&hd(D)===p.type)?(S=a(p,y.props),S.ref=Xr(h,p,y),S.return=h,S):(S=Ri(y.type,y.key,y.props,null,h.mode,S),S.ref=Xr(h,p,y),S.return=h,S)}function m(h,p,y,S){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=po(y,h.mode,S),p.return=h,p):(p=a(p,y.children||[]),p.return=h,p)}function w(h,p,y,S,D){return p===null||p.tag!==7?(p=Vs(y,h.mode,S,D),p.return=h,p):(p=a(p,y),p.return=h,p)}function v(h,p,y){if(typeof p=="string"&&p!==""||typeof p=="number")return p=fo(""+p,h.mode,y),p.return=h,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case ti:return y=Ri(p.type,p.key,p.props,null,h.mode,y),y.ref=Xr(h,null,p),y.return=h,y;case ir:return p=po(p,h.mode,y),p.return=h,p;case cs:var S=p._init;return v(h,S(p._payload),y)}if(na(p)||qr(p))return p=Vs(p,h.mode,y,null),p.return=h,p;hi(h,p)}return null}function x(h,p,y,S){var D=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return D!==null?null:o(h,p,""+y,S);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ti:return y.key===D?u(h,p,y,S):null;case ir:return y.key===D?m(h,p,y,S):null;case cs:return D=y._init,x(h,p,D(y._payload),S)}if(na(y)||qr(y))return D!==null?null:w(h,p,y,S,null);hi(h,y)}return null}function C(h,p,y,S,D){if(typeof S=="string"&&S!==""||typeof S=="number")return h=h.get(y)||null,o(p,h,""+S,D);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ti:return h=h.get(S.key===null?y:S.key)||null,u(p,h,S,D);case ir:return h=h.get(S.key===null?y:S.key)||null,m(p,h,S,D);case cs:var z=S._init;return C(h,p,y,z(S._payload),D)}if(na(S)||qr(S))return h=h.get(y)||null,w(p,h,S,D,null);hi(p,S)}return null}function L(h,p,y,S){for(var D=null,z=null,I=p,_=p=0,P=null;I!==null&&_<y.length;_++){I.index>_?(P=I,I=null):P=I.sibling;var M=x(h,I,y[_],S);if(M===null){I===null&&(I=P);break}e&&I&&M.alternate===null&&t(h,I),p=i(M,p,_),z===null?D=M:z.sibling=M,z=M,I=P}if(_===y.length)return n(h,I),$e&&Ds(h,_),D;if(I===null){for(;_<y.length;_++)I=v(h,y[_],S),I!==null&&(p=i(I,p,_),z===null?D=I:z.sibling=I,z=I);return $e&&Ds(h,_),D}for(I=r(h,I);_<y.length;_++)P=C(I,h,_,y[_],S),P!==null&&(e&&P.alternate!==null&&I.delete(P.key===null?_:P.key),p=i(P,p,_),z===null?D=P:z.sibling=P,z=P);return e&&I.forEach(function(K){return t(h,K)}),$e&&Ds(h,_),D}function R(h,p,y,S){var D=qr(y);if(typeof D!="function")throw Error(B(150));if(y=D.call(y),y==null)throw Error(B(151));for(var z=D=null,I=p,_=p=0,P=null,M=y.next();I!==null&&!M.done;_++,M=y.next()){I.index>_?(P=I,I=null):P=I.sibling;var K=x(h,I,M.value,S);if(K===null){I===null&&(I=P);break}e&&I&&K.alternate===null&&t(h,I),p=i(K,p,_),z===null?D=K:z.sibling=K,z=K,I=P}if(M.done)return n(h,I),$e&&Ds(h,_),D;if(I===null){for(;!M.done;_++,M=y.next())M=v(h,M.value,S),M!==null&&(p=i(M,p,_),z===null?D=M:z.sibling=M,z=M);return $e&&Ds(h,_),D}for(I=r(h,I);!M.done;_++,M=y.next())M=C(I,h,_,M.value,S),M!==null&&(e&&M.alternate!==null&&I.delete(M.key===null?_:M.key),p=i(M,p,_),z===null?D=M:z.sibling=M,z=M);return e&&I.forEach(function(ue){return t(h,ue)}),$e&&Ds(h,_),D}function g(h,p,y,S){if(typeof y=="object"&&y!==null&&y.type===lr&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case ti:e:{for(var D=y.key,z=p;z!==null;){if(z.key===D){if(D=y.type,D===lr){if(z.tag===7){n(h,z.sibling),p=a(z,y.props.children),p.return=h,h=p;break e}}else if(z.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===cs&&hd(D)===z.type){n(h,z.sibling),p=a(z,y.props),p.ref=Xr(h,z,y),p.return=h,h=p;break e}n(h,z);break}else t(h,z);z=z.sibling}y.type===lr?(p=Vs(y.props.children,h.mode,S,y.key),p.return=h,h=p):(S=Ri(y.type,y.key,y.props,null,h.mode,S),S.ref=Xr(h,p,y),S.return=h,h=S)}return l(h);case ir:e:{for(z=y.key;p!==null;){if(p.key===z)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){n(h,p.sibling),p=a(p,y.children||[]),p.return=h,h=p;break e}else{n(h,p);break}else t(h,p);p=p.sibling}p=po(y,h.mode,S),p.return=h,h=p}return l(h);case cs:return z=y._init,g(h,p,z(y._payload),S)}if(na(y))return L(h,p,y,S);if(qr(y))return R(h,p,y,S);hi(h,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,p!==null&&p.tag===6?(n(h,p.sibling),p=a(p,y),p.return=h,h=p):(n(h,p),p=fo(y,h.mode,S),p.return=h,h=p),l(h)):n(h,p)}return g}var Cr=jf(!0),Nf=jf(!1),Ki=Cs(null),Xi=null,mr=null,qc=null;function Qc(){qc=mr=Xi=null}function Gc(e){var t=Ki.current;Ie(Ki),e._currentValue=t}function Xo(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function wr(e,t){Xi=e,qc=mr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Tt=!0),e.firstContext=null)}function tn(e){var t=e._currentValue;if(qc!==e)if(e={context:e,memoizedValue:t,next:null},mr===null){if(Xi===null)throw Error(B(308));mr=e,Xi.dependencies={lanes:0,firstContext:e}}else mr=mr.next=e;return t}var zs=null;function Yc(e){zs===null?zs=[e]:zs.push(e)}function wf(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,Yc(t)):(n.next=a.next,a.next=n),t.interleaved=n,Gn(e,r)}function Gn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var us=!1;function Kc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _f(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Hn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ys(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,xe&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Gn(e,n)}return a=r.interleaved,a===null?(t.next=t,Yc(r)):(t.next=a.next,a.next=t),r.interleaved=t,Gn(e,n)}function bi(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Mc(e,n)}}function fd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=l:i=i.next=l,n=n.next}while(n!==null);i===null?a=i=t:i=i.next=t}else a=i=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ji(e,t,n,r){var a=e.updateQueue;us=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var u=o,m=u.next;u.next=null,l===null?i=m:l.next=m,l=u;var w=e.alternate;w!==null&&(w=w.updateQueue,o=w.lastBaseUpdate,o!==l&&(o===null?w.firstBaseUpdate=m:o.next=m,w.lastBaseUpdate=u))}if(i!==null){var v=a.baseState;l=0,w=m=u=null,o=i;do{var x=o.lane,C=o.eventTime;if((r&x)===x){w!==null&&(w=w.next={eventTime:C,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var L=e,R=o;switch(x=t,C=n,R.tag){case 1:if(L=R.payload,typeof L=="function"){v=L.call(C,v,x);break e}v=L;break e;case 3:L.flags=L.flags&-65537|128;case 0:if(L=R.payload,x=typeof L=="function"?L.call(C,v,x):L,x==null)break e;v=Fe({},v,x);break e;case 2:us=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,x=a.effects,x===null?a.effects=[o]:x.push(o))}else C={eventTime:C,lane:x,tag:o.tag,payload:o.payload,callback:o.callback,next:null},w===null?(m=w=C,u=v):w=w.next=C,l|=x;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;x=o,o=x.next,x.next=null,a.lastBaseUpdate=x,a.shared.pending=null}}while(!0);if(w===null&&(u=v),a.baseState=u,a.firstBaseUpdate=m,a.lastBaseUpdate=w,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);qs|=l,e.lanes=l,e.memoizedState=v}}function pd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(B(191,a));a.call(r)}}}var Ia={},kn=Cs(Ia),Ca=Cs(Ia),Ea=Cs(Ia);function $s(e){if(e===Ia)throw Error(B(174));return e}function Xc(e,t){switch(Pe(Ea,t),Pe(Ca,e),Pe(kn,Ia),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Lo(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Lo(t,e)}Ie(kn),Pe(kn,t)}function Er(){Ie(kn),Ie(Ca),Ie(Ea)}function Sf(e){$s(Ea.current);var t=$s(kn.current),n=Lo(t,e.type);t!==n&&(Pe(Ca,e),Pe(kn,n))}function Jc(e){Ca.current===e&&(Ie(kn),Ie(Ca))}var Ue=Cs(0);function Zi(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var io=[];function Zc(){for(var e=0;e<io.length;e++)io[e]._workInProgressVersionPrimary=null;io.length=0}var Ci=Kn.ReactCurrentDispatcher,lo=Kn.ReactCurrentBatchConfig,Hs=0,Ve=null,Ze=null,st=null,el=!1,da=!1,Aa=0,yv=0;function pt(){throw Error(B(321))}function eu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!mn(e[n],t[n]))return!1;return!0}function tu(e,t,n,r,a,i){if(Hs=i,Ve=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ci.current=e===null||e.memoizedState===null?_v:Sv,e=n(r,a),da){i=0;do{if(da=!1,Aa=0,25<=i)throw Error(B(301));i+=1,st=Ze=null,t.updateQueue=null,Ci.current=kv,e=n(r,a)}while(da)}if(Ci.current=tl,t=Ze!==null&&Ze.next!==null,Hs=0,st=Ze=Ve=null,el=!1,t)throw Error(B(300));return e}function nu(){var e=Aa!==0;return Aa=0,e}function wn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?Ve.memoizedState=st=e:st=st.next=e,st}function nn(){if(Ze===null){var e=Ve.alternate;e=e!==null?e.memoizedState:null}else e=Ze.next;var t=st===null?Ve.memoizedState:st.next;if(t!==null)st=t,Ze=e;else{if(e===null)throw Error(B(310));Ze=e,e={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},st===null?Ve.memoizedState=st=e:st=st.next=e}return st}function Ta(e,t){return typeof t=="function"?t(e):t}function oo(e){var t=nn(),n=t.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=e;var r=Ze,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var o=l=null,u=null,m=i;do{var w=m.lane;if((Hs&w)===w)u!==null&&(u=u.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:e(r,m.action);else{var v={lane:w,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};u===null?(o=u=v,l=r):u=u.next=v,Ve.lanes|=w,qs|=w}m=m.next}while(m!==null&&m!==i);u===null?l=r:u.next=o,mn(r,t.memoizedState)||(Tt=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do i=a.lane,Ve.lanes|=i,qs|=i,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function co(e){var t=nn(),n=t.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(a!==null){n.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);mn(i,t.memoizedState)||(Tt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function kf(){}function bf(e,t){var n=Ve,r=nn(),a=t(),i=!mn(r.memoizedState,a);if(i&&(r.memoizedState=a,Tt=!0),r=r.queue,su(Af.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||st!==null&&st.memoizedState.tag&1){if(n.flags|=2048,La(9,Ef.bind(null,n,r,a,t),void 0,null),rt===null)throw Error(B(349));Hs&30||Cf(n,t,a)}return a}function Cf(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Ef(e,t,n,r){t.value=n,t.getSnapshot=r,Tf(t)&&Lf(e)}function Af(e,t,n){return n(function(){Tf(t)&&Lf(e)})}function Tf(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!mn(e,n)}catch{return!0}}function Lf(e){var t=Gn(e,1);t!==null&&pn(t,e,1,-1)}function md(e){var t=wn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ta,lastRenderedState:e},t.queue=e,e=e.dispatch=wv.bind(null,Ve,e),[t.memoizedState,e]}function La(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Rf(){return nn().memoizedState}function Ei(e,t,n,r){var a=wn();Ve.flags|=e,a.memoizedState=La(1|t,n,void 0,r===void 0?null:r)}function ml(e,t,n,r){var a=nn();r=r===void 0?null:r;var i=void 0;if(Ze!==null){var l=Ze.memoizedState;if(i=l.destroy,r!==null&&eu(r,l.deps)){a.memoizedState=La(t,n,i,r);return}}Ve.flags|=e,a.memoizedState=La(1|t,n,i,r)}function gd(e,t){return Ei(8390656,8,e,t)}function su(e,t){return ml(2048,8,e,t)}function Of(e,t){return ml(4,2,e,t)}function Pf(e,t){return ml(4,4,e,t)}function Mf(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Df(e,t,n){return n=n!=null?n.concat([e]):null,ml(4,4,Mf.bind(null,t,e),n)}function ru(){}function If(e,t){var n=nn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&eu(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Bf(e,t){var n=nn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&eu(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function zf(e,t,n){return Hs&21?(mn(n,t)||(n=Fh(),Ve.lanes|=n,qs|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Tt=!0),e.memoizedState=n)}function jv(e,t){var n=ke;ke=n!==0&&4>n?n:4,e(!0);var r=lo.transition;lo.transition={};try{e(!1),t()}finally{ke=n,lo.transition=r}}function $f(){return nn().memoizedState}function Nv(e,t,n){var r=Ns(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Uf(e))Vf(t,n);else if(n=wf(e,t,n,r),n!==null){var a=St();pn(n,e,r,a),Ff(n,t,r)}}function wv(e,t,n){var r=Ns(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Uf(e))Vf(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,n);if(a.hasEagerState=!0,a.eagerState=o,mn(o,l)){var u=t.interleaved;u===null?(a.next=a,Yc(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}n=wf(e,t,a,r),n!==null&&(a=St(),pn(n,e,r,a),Ff(n,t,r))}}function Uf(e){var t=e.alternate;return e===Ve||t!==null&&t===Ve}function Vf(e,t){da=el=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ff(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Mc(e,n)}}var tl={readContext:tn,useCallback:pt,useContext:pt,useEffect:pt,useImperativeHandle:pt,useInsertionEffect:pt,useLayoutEffect:pt,useMemo:pt,useReducer:pt,useRef:pt,useState:pt,useDebugValue:pt,useDeferredValue:pt,useTransition:pt,useMutableSource:pt,useSyncExternalStore:pt,useId:pt,unstable_isNewReconciler:!1},_v={readContext:tn,useCallback:function(e,t){return wn().memoizedState=[e,t===void 0?null:t],e},useContext:tn,useEffect:gd,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ei(4194308,4,Mf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ei(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ei(4,2,e,t)},useMemo:function(e,t){var n=wn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=wn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Nv.bind(null,Ve,e),[r.memoizedState,e]},useRef:function(e){var t=wn();return e={current:e},t.memoizedState=e},useState:md,useDebugValue:ru,useDeferredValue:function(e){return wn().memoizedState=e},useTransition:function(){var e=md(!1),t=e[0];return e=jv.bind(null,e[1]),wn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ve,a=wn();if($e){if(n===void 0)throw Error(B(407));n=n()}else{if(n=t(),rt===null)throw Error(B(349));Hs&30||Cf(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,gd(Af.bind(null,r,i,e),[e]),r.flags|=2048,La(9,Ef.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=wn(),t=rt.identifierPrefix;if($e){var n=Wn,r=Fn;n=(r&~(1<<32-fn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Aa++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=yv++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Sv={readContext:tn,useCallback:If,useContext:tn,useEffect:su,useImperativeHandle:Df,useInsertionEffect:Of,useLayoutEffect:Pf,useMemo:Bf,useReducer:oo,useRef:Rf,useState:function(){return oo(Ta)},useDebugValue:ru,useDeferredValue:function(e){var t=nn();return zf(t,Ze.memoizedState,e)},useTransition:function(){var e=oo(Ta)[0],t=nn().memoizedState;return[e,t]},useMutableSource:kf,useSyncExternalStore:bf,useId:$f,unstable_isNewReconciler:!1},kv={readContext:tn,useCallback:If,useContext:tn,useEffect:su,useImperativeHandle:Df,useInsertionEffect:Of,useLayoutEffect:Pf,useMemo:Bf,useReducer:co,useRef:Rf,useState:function(){return co(Ta)},useDebugValue:ru,useDeferredValue:function(e){var t=nn();return Ze===null?t.memoizedState=e:zf(t,Ze.memoizedState,e)},useTransition:function(){var e=co(Ta)[0],t=nn().memoizedState;return[e,t]},useMutableSource:kf,useSyncExternalStore:bf,useId:$f,unstable_isNewReconciler:!1};function cn(e,t){if(e&&e.defaultProps){t=Fe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Jo(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Fe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var gl={isMounted:function(e){return(e=e._reactInternals)?Ys(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=St(),a=Ns(e),i=Hn(r,a);i.payload=t,n!=null&&(i.callback=n),t=ys(e,i,a),t!==null&&(pn(t,e,a,r),bi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=St(),a=Ns(e),i=Hn(r,a);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=ys(e,i,a),t!==null&&(pn(t,e,a,r),bi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=St(),r=Ns(e),a=Hn(n,r);a.tag=2,t!=null&&(a.callback=t),t=ys(e,a,r),t!==null&&(pn(t,e,r,n),bi(t,e,r))}};function vd(e,t,n,r,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,l):t.prototype&&t.prototype.isPureReactComponent?!_a(n,r)||!_a(a,i):!0}function Wf(e,t,n){var r=!1,a=ks,i=t.contextType;return typeof i=="object"&&i!==null?i=tn(i):(a=Rt(t)?Fs:vt.current,r=t.contextTypes,i=(r=r!=null)?kr(e,a):ks),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=gl,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function xd(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&gl.enqueueReplaceState(t,t.state,null)}function Zo(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Kc(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=tn(i):(i=Rt(t)?Fs:vt.current,a.context=kr(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Jo(e,t,i,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&gl.enqueueReplaceState(a,a.state,null),Ji(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Ar(e,t){try{var n="",r=t;do n+=Zm(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function uo(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ec(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var bv=typeof WeakMap=="function"?WeakMap:Map;function Hf(e,t,n){n=Hn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){sl||(sl=!0,uc=r),ec(e,t)},n}function qf(e,t,n){n=Hn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){ec(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){ec(e,t),typeof r!="function"&&(js===null?js=new Set([this]):js.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function yd(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new bv;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=$v.bind(null,e,t,n),t.then(e,e))}function jd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Nd(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Hn(-1,1),t.tag=2,ys(n,t,1))),n.lanes|=1),e)}var Cv=Kn.ReactCurrentOwner,Tt=!1;function _t(e,t,n,r){t.child=e===null?Nf(t,null,n,r):Cr(t,e.child,n,r)}function wd(e,t,n,r,a){n=n.render;var i=t.ref;return wr(t,a),r=tu(e,t,n,r,i,a),n=nu(),e!==null&&!Tt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Yn(e,t,a)):($e&&n&&Fc(t),t.flags|=1,_t(e,t,r,a),t.child)}function _d(e,t,n,r,a){if(e===null){var i=n.type;return typeof i=="function"&&!hu(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Qf(e,t,i,r,a)):(e=Ri(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(n=n.compare,n=n!==null?n:_a,n(l,r)&&e.ref===t.ref)return Yn(e,t,a)}return t.flags|=1,e=ws(i,r),e.ref=t.ref,e.return=t,t.child=e}function Qf(e,t,n,r,a){if(e!==null){var i=e.memoizedProps;if(_a(i,r)&&e.ref===t.ref)if(Tt=!1,t.pendingProps=r=i,(e.lanes&a)!==0)e.flags&131072&&(Tt=!0);else return t.lanes=e.lanes,Yn(e,t,a)}return tc(e,t,n,r,a)}function Gf(e,t,n){var r=t.pendingProps,a=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(vr,It),It|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Pe(vr,It),It|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Pe(vr,It),It|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Pe(vr,It),It|=r;return _t(e,t,a,n),t.child}function Yf(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function tc(e,t,n,r,a){var i=Rt(n)?Fs:vt.current;return i=kr(t,i),wr(t,a),n=tu(e,t,n,r,i,a),r=nu(),e!==null&&!Tt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Yn(e,t,a)):($e&&r&&Fc(t),t.flags|=1,_t(e,t,n,a),t.child)}function Sd(e,t,n,r,a){if(Rt(n)){var i=!0;Qi(t)}else i=!1;if(wr(t,a),t.stateNode===null)Ai(e,t),Wf(t,n,r),Zo(t,n,r,a),r=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var u=l.context,m=n.contextType;typeof m=="object"&&m!==null?m=tn(m):(m=Rt(n)?Fs:vt.current,m=kr(t,m));var w=n.getDerivedStateFromProps,v=typeof w=="function"||typeof l.getSnapshotBeforeUpdate=="function";v||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==r||u!==m)&&xd(t,l,r,m),us=!1;var x=t.memoizedState;l.state=x,Ji(t,r,l,a),u=t.memoizedState,o!==r||x!==u||Lt.current||us?(typeof w=="function"&&(Jo(t,n,w,r),u=t.memoizedState),(o=us||vd(t,n,o,r,x,u,m))?(v||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),l.props=r,l.state=u,l.context=m,r=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,_f(e,t),o=t.memoizedProps,m=t.type===t.elementType?o:cn(t.type,o),l.props=m,v=t.pendingProps,x=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=tn(u):(u=Rt(n)?Fs:vt.current,u=kr(t,u));var C=n.getDerivedStateFromProps;(w=typeof C=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==v||x!==u)&&xd(t,l,r,u),us=!1,x=t.memoizedState,l.state=x,Ji(t,r,l,a);var L=t.memoizedState;o!==v||x!==L||Lt.current||us?(typeof C=="function"&&(Jo(t,n,C,r),L=t.memoizedState),(m=us||vd(t,n,m,r,x,L,u)||!1)?(w||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,L,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,L,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=L),l.props=r,l.state=L,l.context=u,r=m):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),r=!1)}return nc(e,t,n,r,i,a)}function nc(e,t,n,r,a,i){Yf(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return a&&cd(t,n,!1),Yn(e,t,i);r=t.stateNode,Cv.current=t;var o=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=Cr(t,e.child,null,i),t.child=Cr(t,null,o,i)):_t(e,t,o,i),t.memoizedState=r.state,a&&cd(t,n,!0),t.child}function Kf(e){var t=e.stateNode;t.pendingContext?od(e,t.pendingContext,t.pendingContext!==t.context):t.context&&od(e,t.context,!1),Xc(e,t.containerInfo)}function kd(e,t,n,r,a){return br(),Hc(a),t.flags|=256,_t(e,t,n,r),t.child}var sc={dehydrated:null,treeContext:null,retryLane:0};function rc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Xf(e,t,n){var r=t.pendingProps,a=Ue.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Pe(Ue,a&1),e===null)return Ko(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,i?(r=t.mode,i=t.child,l={mode:"hidden",children:l},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=yl(l,r,0,null),e=Vs(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=rc(n),t.memoizedState=sc,e):au(t,l));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return Ev(e,t,l,r,o,a,n);if(i){i=r.fallback,l=t.mode,a=e.child,o=a.sibling;var u={mode:"hidden",children:r.children};return!(l&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=ws(a,u),r.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=ws(o,i):(i=Vs(i,l,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,l=e.child.memoizedState,l=l===null?rc(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=sc,r}return i=e.child,e=i.sibling,r=ws(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function au(e,t){return t=yl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function fi(e,t,n,r){return r!==null&&Hc(r),Cr(t,e.child,null,n),e=au(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ev(e,t,n,r,a,i,l){if(n)return t.flags&256?(t.flags&=-257,r=uo(Error(B(422))),fi(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=yl({mode:"visible",children:r.children},a,0,null),i=Vs(i,a,l,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Cr(t,e.child,null,l),t.child.memoizedState=rc(l),t.memoizedState=sc,i);if(!(t.mode&1))return fi(e,t,l,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var o=r.dgst;return r=o,i=Error(B(419)),r=uo(i,r,void 0),fi(e,t,l,r)}if(o=(l&e.childLanes)!==0,Tt||o){if(r=rt,r!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Gn(e,a),pn(r,e,a,-1))}return du(),r=uo(Error(B(421))),fi(e,t,l,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Uv.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Bt=xs(a.nextSibling),zt=t,$e=!0,hn=null,e!==null&&(Kt[Xt++]=Fn,Kt[Xt++]=Wn,Kt[Xt++]=Ws,Fn=e.id,Wn=e.overflow,Ws=t),t=au(t,r.children),t.flags|=4096,t)}function bd(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Xo(e.return,t,n)}function ho(e,t,n,r,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Jf(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(_t(e,t,r.children,n),r=Ue.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&bd(e,n,t);else if(e.tag===19)bd(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Pe(Ue,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&Zi(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),ho(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Zi(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}ho(t,!0,n,null,i);break;case"together":ho(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ai(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Yn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),qs|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(B(153));if(t.child!==null){for(e=t.child,n=ws(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ws(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Av(e,t,n){switch(t.tag){case 3:Kf(t),br();break;case 5:Sf(t);break;case 1:Rt(t.type)&&Qi(t);break;case 4:Xc(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Pe(Ki,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Pe(Ue,Ue.current&1),t.flags|=128,null):n&t.child.childLanes?Xf(e,t,n):(Pe(Ue,Ue.current&1),e=Yn(e,t,n),e!==null?e.sibling:null);Pe(Ue,Ue.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Jf(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Pe(Ue,Ue.current),r)break;return null;case 22:case 23:return t.lanes=0,Gf(e,t,n)}return Yn(e,t,n)}var Zf,ac,ep,tp;Zf=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ac=function(){};ep=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,$s(kn.current);var i=null;switch(n){case"input":a=Co(e,a),r=Co(e,r),i=[];break;case"select":a=Fe({},a,{value:void 0}),r=Fe({},r,{value:void 0}),i=[];break;case"textarea":a=To(e,a),r=To(e,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Hi)}Ro(n,r);var l;n=null;for(m in a)if(!r.hasOwnProperty(m)&&a.hasOwnProperty(m)&&a[m]!=null)if(m==="style"){var o=a[m];for(l in o)o.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(ga.hasOwnProperty(m)?i||(i=[]):(i=i||[]).push(m,null));for(m in r){var u=r[m];if(o=a!=null?a[m]:void 0,r.hasOwnProperty(m)&&u!==o&&(u!=null||o!=null))if(m==="style")if(o){for(l in o)!o.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&o[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(i||(i=[]),i.push(m,n)),n=u;else m==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(i=i||[]).push(m,u)):m==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(m,""+u):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(ga.hasOwnProperty(m)?(u!=null&&m==="onScroll"&&De("scroll",e),i||o===u||(i=[])):(i=i||[]).push(m,u))}n&&(i=i||[]).push("style",n);var m=i;(t.updateQueue=m)&&(t.flags|=4)}};tp=function(e,t,n,r){n!==r&&(t.flags|=4)};function Jr(e,t){if(!$e)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function mt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Tv(e,t,n){var r=t.pendingProps;switch(Wc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mt(t),null;case 1:return Rt(t.type)&&qi(),mt(t),null;case 3:return r=t.stateNode,Er(),Ie(Lt),Ie(vt),Zc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(di(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,hn!==null&&(fc(hn),hn=null))),ac(e,t),mt(t),null;case 5:Jc(t);var a=$s(Ea.current);if(n=t.type,e!==null&&t.stateNode!=null)ep(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(B(166));return mt(t),null}if(e=$s(kn.current),di(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[_n]=t,r[ba]=i,e=(t.mode&1)!==0,n){case"dialog":De("cancel",r),De("close",r);break;case"iframe":case"object":case"embed":De("load",r);break;case"video":case"audio":for(a=0;a<ra.length;a++)De(ra[a],r);break;case"source":De("error",r);break;case"img":case"image":case"link":De("error",r),De("load",r);break;case"details":De("toggle",r);break;case"input":Mu(r,i),De("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},De("invalid",r);break;case"textarea":Iu(r,i),De("invalid",r)}Ro(n,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?r.textContent!==o&&(i.suppressHydrationWarning!==!0&&ui(r.textContent,o,e),a=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&ui(r.textContent,o,e),a=["children",""+o]):ga.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&De("scroll",r)}switch(n){case"input":ni(r),Du(r,i,!0);break;case"textarea":ni(r),Bu(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Hi)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Eh(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[_n]=t,e[ba]=r,Zf(e,t,!1,!1),t.stateNode=e;e:{switch(l=Oo(n,r),n){case"dialog":De("cancel",e),De("close",e),a=r;break;case"iframe":case"object":case"embed":De("load",e),a=r;break;case"video":case"audio":for(a=0;a<ra.length;a++)De(ra[a],e);a=r;break;case"source":De("error",e),a=r;break;case"img":case"image":case"link":De("error",e),De("load",e),a=r;break;case"details":De("toggle",e),a=r;break;case"input":Mu(e,r),a=Co(e,r),De("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Fe({},r,{value:void 0}),De("invalid",e);break;case"textarea":Iu(e,r),a=To(e,r),De("invalid",e);break;default:a=r}Ro(n,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var u=o[i];i==="style"?Lh(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Ah(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&va(e,u):typeof u=="number"&&va(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ga.hasOwnProperty(i)?u!=null&&i==="onScroll"&&De("scroll",e):u!=null&&Ac(e,i,u,l))}switch(n){case"input":ni(e),Du(e,r,!1);break;case"textarea":ni(e),Bu(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Ss(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?xr(e,!!r.multiple,i,!1):r.defaultValue!=null&&xr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Hi)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return mt(t),null;case 6:if(e&&t.stateNode!=null)tp(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(B(166));if(n=$s(Ea.current),$s(kn.current),di(t)){if(r=t.stateNode,n=t.memoizedProps,r[_n]=t,(i=r.nodeValue!==n)&&(e=zt,e!==null))switch(e.tag){case 3:ui(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ui(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[_n]=t,t.stateNode=r}return mt(t),null;case 13:if(Ie(Ue),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($e&&Bt!==null&&t.mode&1&&!(t.flags&128))yf(),br(),t.flags|=98560,i=!1;else if(i=di(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(B(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(B(317));i[_n]=t}else br(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;mt(t),i=!1}else hn!==null&&(fc(hn),hn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ue.current&1?et===0&&(et=3):du())),t.updateQueue!==null&&(t.flags|=4),mt(t),null);case 4:return Er(),ac(e,t),e===null&&Sa(t.stateNode.containerInfo),mt(t),null;case 10:return Gc(t.type._context),mt(t),null;case 17:return Rt(t.type)&&qi(),mt(t),null;case 19:if(Ie(Ue),i=t.memoizedState,i===null)return mt(t),null;if(r=(t.flags&128)!==0,l=i.rendering,l===null)if(r)Jr(i,!1);else{if(et!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Zi(e),l!==null){for(t.flags|=128,Jr(i,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Pe(Ue,Ue.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ge()>Tr&&(t.flags|=128,r=!0,Jr(i,!1),t.lanes=4194304)}else{if(!r)if(e=Zi(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Jr(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!$e)return mt(t),null}else 2*Ge()-i.renderingStartTime>Tr&&n!==1073741824&&(t.flags|=128,r=!0,Jr(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(n=i.last,n!==null?n.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ge(),t.sibling=null,n=Ue.current,Pe(Ue,r?n&1|2:n&1),t):(mt(t),null);case 22:case 23:return uu(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?It&1073741824&&(mt(t),t.subtreeFlags&6&&(t.flags|=8192)):mt(t),null;case 24:return null;case 25:return null}throw Error(B(156,t.tag))}function Lv(e,t){switch(Wc(t),t.tag){case 1:return Rt(t.type)&&qi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Er(),Ie(Lt),Ie(vt),Zc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Jc(t),null;case 13:if(Ie(Ue),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(B(340));br()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ie(Ue),null;case 4:return Er(),null;case 10:return Gc(t.type._context),null;case 22:case 23:return uu(),null;case 24:return null;default:return null}}var pi=!1,gt=!1,Rv=typeof WeakSet=="function"?WeakSet:Set,Y=null;function gr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qe(e,t,r)}else n.current=null}function ic(e,t,n){try{n()}catch(r){qe(e,t,r)}}var Cd=!1;function Ov(e,t){if(Fo=Vi,e=af(),Vc(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var l=0,o=-1,u=-1,m=0,w=0,v=e,x=null;t:for(;;){for(var C;v!==n||a!==0&&v.nodeType!==3||(o=l+a),v!==i||r!==0&&v.nodeType!==3||(u=l+r),v.nodeType===3&&(l+=v.nodeValue.length),(C=v.firstChild)!==null;)x=v,v=C;for(;;){if(v===e)break t;if(x===n&&++m===a&&(o=l),x===i&&++w===r&&(u=l),(C=v.nextSibling)!==null)break;v=x,x=v.parentNode}v=C}n=o===-1||u===-1?null:{start:o,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Wo={focusedElem:e,selectionRange:n},Vi=!1,Y=t;Y!==null;)if(t=Y,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Y=e;else for(;Y!==null;){t=Y;try{var L=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(L!==null){var R=L.memoizedProps,g=L.memoizedState,h=t.stateNode,p=h.getSnapshotBeforeUpdate(t.elementType===t.type?R:cn(t.type,R),g);h.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(S){qe(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,Y=e;break}Y=t.return}return L=Cd,Cd=!1,L}function ha(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&ic(t,n,i)}a=a.next}while(a!==r)}}function vl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function lc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function np(e){var t=e.alternate;t!==null&&(e.alternate=null,np(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[_n],delete t[ba],delete t[Qo],delete t[mv],delete t[gv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sp(e){return e.tag===5||e.tag===3||e.tag===4}function Ed(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||sp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function oc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Hi));else if(r!==4&&(e=e.child,e!==null))for(oc(e,t,n),e=e.sibling;e!==null;)oc(e,t,n),e=e.sibling}function cc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(cc(e,t,n),e=e.sibling;e!==null;)cc(e,t,n),e=e.sibling}var ot=null,un=!1;function os(e,t,n){for(n=n.child;n!==null;)rp(e,t,n),n=n.sibling}function rp(e,t,n){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount(cl,n)}catch{}switch(n.tag){case 5:gt||gr(n,t);case 6:var r=ot,a=un;ot=null,os(e,t,n),ot=r,un=a,ot!==null&&(un?(e=ot,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ot.removeChild(n.stateNode));break;case 18:ot!==null&&(un?(e=ot,n=n.stateNode,e.nodeType===8?ro(e.parentNode,n):e.nodeType===1&&ro(e,n),Na(e)):ro(ot,n.stateNode));break;case 4:r=ot,a=un,ot=n.stateNode.containerInfo,un=!0,os(e,t,n),ot=r,un=a;break;case 0:case 11:case 14:case 15:if(!gt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&ic(n,t,l),a=a.next}while(a!==r)}os(e,t,n);break;case 1:if(!gt&&(gr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){qe(n,t,o)}os(e,t,n);break;case 21:os(e,t,n);break;case 22:n.mode&1?(gt=(r=gt)||n.memoizedState!==null,os(e,t,n),gt=r):os(e,t,n);break;default:os(e,t,n)}}function Ad(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Rv),t.forEach(function(r){var a=Vv.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function on(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:ot=o.stateNode,un=!1;break e;case 3:ot=o.stateNode.containerInfo,un=!0;break e;case 4:ot=o.stateNode.containerInfo,un=!0;break e}o=o.return}if(ot===null)throw Error(B(160));rp(i,l,a),ot=null,un=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(m){qe(a,t,m)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ap(t,e),t=t.sibling}function ap(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(on(t,e),Nn(e),r&4){try{ha(3,e,e.return),vl(3,e)}catch(R){qe(e,e.return,R)}try{ha(5,e,e.return)}catch(R){qe(e,e.return,R)}}break;case 1:on(t,e),Nn(e),r&512&&n!==null&&gr(n,n.return);break;case 5:if(on(t,e),Nn(e),r&512&&n!==null&&gr(n,n.return),e.flags&32){var a=e.stateNode;try{va(a,"")}catch(R){qe(e,e.return,R)}}if(r&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=n!==null?n.memoizedProps:i,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&bh(a,i),Oo(o,l);var m=Oo(o,i);for(l=0;l<u.length;l+=2){var w=u[l],v=u[l+1];w==="style"?Lh(a,v):w==="dangerouslySetInnerHTML"?Ah(a,v):w==="children"?va(a,v):Ac(a,w,v,m)}switch(o){case"input":Eo(a,i);break;case"textarea":Ch(a,i);break;case"select":var x=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var C=i.value;C!=null?xr(a,!!i.multiple,C,!1):x!==!!i.multiple&&(i.defaultValue!=null?xr(a,!!i.multiple,i.defaultValue,!0):xr(a,!!i.multiple,i.multiple?[]:"",!1))}a[ba]=i}catch(R){qe(e,e.return,R)}}break;case 6:if(on(t,e),Nn(e),r&4){if(e.stateNode===null)throw Error(B(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(R){qe(e,e.return,R)}}break;case 3:if(on(t,e),Nn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Na(t.containerInfo)}catch(R){qe(e,e.return,R)}break;case 4:on(t,e),Nn(e);break;case 13:on(t,e),Nn(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(ou=Ge())),r&4&&Ad(e);break;case 22:if(w=n!==null&&n.memoizedState!==null,e.mode&1?(gt=(m=gt)||w,on(t,e),gt=m):on(t,e),Nn(e),r&8192){if(m=e.memoizedState!==null,(e.stateNode.isHidden=m)&&!w&&e.mode&1)for(Y=e,w=e.child;w!==null;){for(v=Y=w;Y!==null;){switch(x=Y,C=x.child,x.tag){case 0:case 11:case 14:case 15:ha(4,x,x.return);break;case 1:gr(x,x.return);var L=x.stateNode;if(typeof L.componentWillUnmount=="function"){r=x,n=x.return;try{t=r,L.props=t.memoizedProps,L.state=t.memoizedState,L.componentWillUnmount()}catch(R){qe(r,n,R)}}break;case 5:gr(x,x.return);break;case 22:if(x.memoizedState!==null){Ld(v);continue}}C!==null?(C.return=x,Y=C):Ld(v)}w=w.sibling}e:for(w=null,v=e;;){if(v.tag===5){if(w===null){w=v;try{a=v.stateNode,m?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=v.stateNode,u=v.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=Th("display",l))}catch(R){qe(e,e.return,R)}}}else if(v.tag===6){if(w===null)try{v.stateNode.nodeValue=m?"":v.memoizedProps}catch(R){qe(e,e.return,R)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===e)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===e)break e;for(;v.sibling===null;){if(v.return===null||v.return===e)break e;w===v&&(w=null),v=v.return}w===v&&(w=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:on(t,e),Nn(e),r&4&&Ad(e);break;case 21:break;default:on(t,e),Nn(e)}}function Nn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(sp(n)){var r=n;break e}n=n.return}throw Error(B(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(va(a,""),r.flags&=-33);var i=Ed(e);cc(e,i,a);break;case 3:case 4:var l=r.stateNode.containerInfo,o=Ed(e);oc(e,o,l);break;default:throw Error(B(161))}}catch(u){qe(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Pv(e,t,n){Y=e,ip(e)}function ip(e,t,n){for(var r=(e.mode&1)!==0;Y!==null;){var a=Y,i=a.child;if(a.tag===22&&r){var l=a.memoizedState!==null||pi;if(!l){var o=a.alternate,u=o!==null&&o.memoizedState!==null||gt;o=pi;var m=gt;if(pi=l,(gt=u)&&!m)for(Y=a;Y!==null;)l=Y,u=l.child,l.tag===22&&l.memoizedState!==null?Rd(a):u!==null?(u.return=l,Y=u):Rd(a);for(;i!==null;)Y=i,ip(i),i=i.sibling;Y=a,pi=o,gt=m}Td(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Y=i):Td(e)}}function Td(e){for(;Y!==null;){var t=Y;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:gt||vl(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!gt)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:cn(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&pd(t,i,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}pd(t,l,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var m=t.alternate;if(m!==null){var w=m.memoizedState;if(w!==null){var v=w.dehydrated;v!==null&&Na(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}gt||t.flags&512&&lc(t)}catch(x){qe(t,t.return,x)}}if(t===e){Y=null;break}if(n=t.sibling,n!==null){n.return=t.return,Y=n;break}Y=t.return}}function Ld(e){for(;Y!==null;){var t=Y;if(t===e){Y=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Y=n;break}Y=t.return}}function Rd(e){for(;Y!==null;){var t=Y;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{vl(4,t)}catch(u){qe(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(u){qe(t,a,u)}}var i=t.return;try{lc(t)}catch(u){qe(t,i,u)}break;case 5:var l=t.return;try{lc(t)}catch(u){qe(t,l,u)}}}catch(u){qe(t,t.return,u)}if(t===e){Y=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Y=o;break}Y=t.return}}var Mv=Math.ceil,nl=Kn.ReactCurrentDispatcher,iu=Kn.ReactCurrentOwner,en=Kn.ReactCurrentBatchConfig,xe=0,rt=null,Xe=null,ct=0,It=0,vr=Cs(0),et=0,Ra=null,qs=0,xl=0,lu=0,fa=null,At=null,ou=0,Tr=1/0,zn=null,sl=!1,uc=null,js=null,mi=!1,ps=null,rl=0,pa=0,dc=null,Ti=-1,Li=0;function St(){return xe&6?Ge():Ti!==-1?Ti:Ti=Ge()}function Ns(e){return e.mode&1?xe&2&&ct!==0?ct&-ct:xv.transition!==null?(Li===0&&(Li=Fh()),Li):(e=ke,e!==0||(e=window.event,e=e===void 0?16:Kh(e.type)),e):1}function pn(e,t,n,r){if(50<pa)throw pa=0,dc=null,Error(B(185));Pa(e,n,r),(!(xe&2)||e!==rt)&&(e===rt&&(!(xe&2)&&(xl|=n),et===4&&hs(e,ct)),Ot(e,r),n===1&&xe===0&&!(t.mode&1)&&(Tr=Ge()+500,pl&&Es()))}function Ot(e,t){var n=e.callbackNode;xg(e,t);var r=Ui(e,e===rt?ct:0);if(r===0)n!==null&&Uu(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Uu(n),t===1)e.tag===0?vv(Od.bind(null,e)):gf(Od.bind(null,e)),fv(function(){!(xe&6)&&Es()}),n=null;else{switch(Wh(r)){case 1:n=Pc;break;case 4:n=Uh;break;case 16:n=$i;break;case 536870912:n=Vh;break;default:n=$i}n=pp(n,lp.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function lp(e,t){if(Ti=-1,Li=0,xe&6)throw Error(B(327));var n=e.callbackNode;if(_r()&&e.callbackNode!==n)return null;var r=Ui(e,e===rt?ct:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=al(e,r);else{t=r;var a=xe;xe|=2;var i=cp();(rt!==e||ct!==t)&&(zn=null,Tr=Ge()+500,Us(e,t));do try{Bv();break}catch(o){op(e,o)}while(!0);Qc(),nl.current=i,xe=a,Xe!==null?t=0:(rt=null,ct=0,t=et)}if(t!==0){if(t===2&&(a=Bo(e),a!==0&&(r=a,t=hc(e,a))),t===1)throw n=Ra,Us(e,0),hs(e,r),Ot(e,Ge()),n;if(t===6)hs(e,r);else{if(a=e.current.alternate,!(r&30)&&!Dv(a)&&(t=al(e,r),t===2&&(i=Bo(e),i!==0&&(r=i,t=hc(e,i))),t===1))throw n=Ra,Us(e,0),hs(e,r),Ot(e,Ge()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(B(345));case 2:Is(e,At,zn);break;case 3:if(hs(e,r),(r&130023424)===r&&(t=ou+500-Ge(),10<t)){if(Ui(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){St(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=qo(Is.bind(null,e,At,zn),t);break}Is(e,At,zn);break;case 4:if(hs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var l=31-fn(r);i=1<<l,l=t[l],l>a&&(a=l),r&=~i}if(r=a,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Mv(r/1960))-r,10<r){e.timeoutHandle=qo(Is.bind(null,e,At,zn),r);break}Is(e,At,zn);break;case 5:Is(e,At,zn);break;default:throw Error(B(329))}}}return Ot(e,Ge()),e.callbackNode===n?lp.bind(null,e):null}function hc(e,t){var n=fa;return e.current.memoizedState.isDehydrated&&(Us(e,t).flags|=256),e=al(e,t),e!==2&&(t=At,At=n,t!==null&&fc(t)),e}function fc(e){At===null?At=e:At.push.apply(At,e)}function Dv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!mn(i(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function hs(e,t){for(t&=~lu,t&=~xl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-fn(t),r=1<<n;e[n]=-1,t&=~r}}function Od(e){if(xe&6)throw Error(B(327));_r();var t=Ui(e,0);if(!(t&1))return Ot(e,Ge()),null;var n=al(e,t);if(e.tag!==0&&n===2){var r=Bo(e);r!==0&&(t=r,n=hc(e,r))}if(n===1)throw n=Ra,Us(e,0),hs(e,t),Ot(e,Ge()),n;if(n===6)throw Error(B(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Is(e,At,zn),Ot(e,Ge()),null}function cu(e,t){var n=xe;xe|=1;try{return e(t)}finally{xe=n,xe===0&&(Tr=Ge()+500,pl&&Es())}}function Qs(e){ps!==null&&ps.tag===0&&!(xe&6)&&_r();var t=xe;xe|=1;var n=en.transition,r=ke;try{if(en.transition=null,ke=1,e)return e()}finally{ke=r,en.transition=n,xe=t,!(xe&6)&&Es()}}function uu(){It=vr.current,Ie(vr)}function Us(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,hv(n)),Xe!==null)for(n=Xe.return;n!==null;){var r=n;switch(Wc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qi();break;case 3:Er(),Ie(Lt),Ie(vt),Zc();break;case 5:Jc(r);break;case 4:Er();break;case 13:Ie(Ue);break;case 19:Ie(Ue);break;case 10:Gc(r.type._context);break;case 22:case 23:uu()}n=n.return}if(rt=e,Xe=e=ws(e.current,null),ct=It=t,et=0,Ra=null,lu=xl=qs=0,At=fa=null,zs!==null){for(t=0;t<zs.length;t++)if(n=zs[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var l=i.next;i.next=a,r.next=l}n.pending=r}zs=null}return e}function op(e,t){do{var n=Xe;try{if(Qc(),Ci.current=tl,el){for(var r=Ve.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}el=!1}if(Hs=0,st=Ze=Ve=null,da=!1,Aa=0,iu.current=null,n===null||n.return===null){et=1,Ra=t,Xe=null;break}e:{var i=e,l=n.return,o=n,u=t;if(t=ct,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var m=u,w=o,v=w.tag;if(!(w.mode&1)&&(v===0||v===11||v===15)){var x=w.alternate;x?(w.updateQueue=x.updateQueue,w.memoizedState=x.memoizedState,w.lanes=x.lanes):(w.updateQueue=null,w.memoizedState=null)}var C=jd(l);if(C!==null){C.flags&=-257,Nd(C,l,o,i,t),C.mode&1&&yd(i,m,t),t=C,u=m;var L=t.updateQueue;if(L===null){var R=new Set;R.add(u),t.updateQueue=R}else L.add(u);break e}else{if(!(t&1)){yd(i,m,t),du();break e}u=Error(B(426))}}else if($e&&o.mode&1){var g=jd(l);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Nd(g,l,o,i,t),Hc(Ar(u,o));break e}}i=u=Ar(u,o),et!==4&&(et=2),fa===null?fa=[i]:fa.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var h=Hf(i,u,t);fd(i,h);break e;case 1:o=u;var p=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(js===null||!js.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var S=qf(i,o,t);fd(i,S);break e}}i=i.return}while(i!==null)}dp(n)}catch(D){t=D,Xe===n&&n!==null&&(Xe=n=n.return);continue}break}while(!0)}function cp(){var e=nl.current;return nl.current=tl,e===null?tl:e}function du(){(et===0||et===3||et===2)&&(et=4),rt===null||!(qs&268435455)&&!(xl&268435455)||hs(rt,ct)}function al(e,t){var n=xe;xe|=2;var r=cp();(rt!==e||ct!==t)&&(zn=null,Us(e,t));do try{Iv();break}catch(a){op(e,a)}while(!0);if(Qc(),xe=n,nl.current=r,Xe!==null)throw Error(B(261));return rt=null,ct=0,et}function Iv(){for(;Xe!==null;)up(Xe)}function Bv(){for(;Xe!==null&&!cg();)up(Xe)}function up(e){var t=fp(e.alternate,e,It);e.memoizedProps=e.pendingProps,t===null?dp(e):Xe=t,iu.current=null}function dp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Lv(n,t),n!==null){n.flags&=32767,Xe=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{et=6,Xe=null;return}}else if(n=Tv(n,t,It),n!==null){Xe=n;return}if(t=t.sibling,t!==null){Xe=t;return}Xe=t=e}while(t!==null);et===0&&(et=5)}function Is(e,t,n){var r=ke,a=en.transition;try{en.transition=null,ke=1,zv(e,t,n,r)}finally{en.transition=a,ke=r}return null}function zv(e,t,n,r){do _r();while(ps!==null);if(xe&6)throw Error(B(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(B(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(yg(e,i),e===rt&&(Xe=rt=null,ct=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||mi||(mi=!0,pp($i,function(){return _r(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=en.transition,en.transition=null;var l=ke;ke=1;var o=xe;xe|=4,iu.current=null,Ov(e,n),ap(n,e),av(Wo),Vi=!!Fo,Wo=Fo=null,e.current=n,Pv(n),ug(),xe=o,ke=l,en.transition=i}else e.current=n;if(mi&&(mi=!1,ps=e,rl=a),i=e.pendingLanes,i===0&&(js=null),fg(n.stateNode),Ot(e,Ge()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(sl)throw sl=!1,e=uc,uc=null,e;return rl&1&&e.tag!==0&&_r(),i=e.pendingLanes,i&1?e===dc?pa++:(pa=0,dc=e):pa=0,Es(),null}function _r(){if(ps!==null){var e=Wh(rl),t=en.transition,n=ke;try{if(en.transition=null,ke=16>e?16:e,ps===null)var r=!1;else{if(e=ps,ps=null,rl=0,xe&6)throw Error(B(331));var a=xe;for(xe|=4,Y=e.current;Y!==null;){var i=Y,l=i.child;if(Y.flags&16){var o=i.deletions;if(o!==null){for(var u=0;u<o.length;u++){var m=o[u];for(Y=m;Y!==null;){var w=Y;switch(w.tag){case 0:case 11:case 15:ha(8,w,i)}var v=w.child;if(v!==null)v.return=w,Y=v;else for(;Y!==null;){w=Y;var x=w.sibling,C=w.return;if(np(w),w===m){Y=null;break}if(x!==null){x.return=C,Y=x;break}Y=C}}}var L=i.alternate;if(L!==null){var R=L.child;if(R!==null){L.child=null;do{var g=R.sibling;R.sibling=null,R=g}while(R!==null)}}Y=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,Y=l;else e:for(;Y!==null;){if(i=Y,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ha(9,i,i.return)}var h=i.sibling;if(h!==null){h.return=i.return,Y=h;break e}Y=i.return}}var p=e.current;for(Y=p;Y!==null;){l=Y;var y=l.child;if(l.subtreeFlags&2064&&y!==null)y.return=l,Y=y;else e:for(l=p;Y!==null;){if(o=Y,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:vl(9,o)}}catch(D){qe(o,o.return,D)}if(o===l){Y=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,Y=S;break e}Y=o.return}}if(xe=a,Es(),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot(cl,e)}catch{}r=!0}return r}finally{ke=n,en.transition=t}}return!1}function Pd(e,t,n){t=Ar(n,t),t=Hf(e,t,1),e=ys(e,t,1),t=St(),e!==null&&(Pa(e,1,t),Ot(e,t))}function qe(e,t,n){if(e.tag===3)Pd(e,e,n);else for(;t!==null;){if(t.tag===3){Pd(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(js===null||!js.has(r))){e=Ar(n,e),e=qf(t,e,1),t=ys(t,e,1),e=St(),t!==null&&(Pa(t,1,e),Ot(t,e));break}}t=t.return}}function $v(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=St(),e.pingedLanes|=e.suspendedLanes&n,rt===e&&(ct&n)===n&&(et===4||et===3&&(ct&130023424)===ct&&500>Ge()-ou?Us(e,0):lu|=n),Ot(e,t)}function hp(e,t){t===0&&(e.mode&1?(t=ai,ai<<=1,!(ai&130023424)&&(ai=4194304)):t=1);var n=St();e=Gn(e,t),e!==null&&(Pa(e,t,n),Ot(e,n))}function Uv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),hp(e,n)}function Vv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(B(314))}r!==null&&r.delete(t),hp(e,n)}var fp;fp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Lt.current)Tt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Tt=!1,Av(e,t,n);Tt=!!(e.flags&131072)}else Tt=!1,$e&&t.flags&1048576&&vf(t,Yi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ai(e,t),e=t.pendingProps;var a=kr(t,vt.current);wr(t,n),a=tu(null,t,r,e,a,n);var i=nu();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rt(r)?(i=!0,Qi(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Kc(t),a.updater=gl,t.stateNode=a,a._reactInternals=t,Zo(t,r,e,n),t=nc(null,t,r,!0,i,n)):(t.tag=0,$e&&i&&Fc(t),_t(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ai(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=Wv(r),e=cn(r,e),a){case 0:t=tc(null,t,r,e,n);break e;case 1:t=Sd(null,t,r,e,n);break e;case 11:t=wd(null,t,r,e,n);break e;case 14:t=_d(null,t,r,cn(r.type,e),n);break e}throw Error(B(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:cn(r,a),tc(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:cn(r,a),Sd(e,t,r,a,n);case 3:e:{if(Kf(t),e===null)throw Error(B(387));r=t.pendingProps,i=t.memoizedState,a=i.element,_f(e,t),Ji(t,r,null,n);var l=t.memoizedState;if(r=l.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Ar(Error(B(423)),t),t=kd(e,t,r,n,a);break e}else if(r!==a){a=Ar(Error(B(424)),t),t=kd(e,t,r,n,a);break e}else for(Bt=xs(t.stateNode.containerInfo.firstChild),zt=t,$e=!0,hn=null,n=Nf(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(br(),r===a){t=Yn(e,t,n);break e}_t(e,t,r,n)}t=t.child}return t;case 5:return Sf(t),e===null&&Ko(t),r=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,Ho(r,a)?l=null:i!==null&&Ho(r,i)&&(t.flags|=32),Yf(e,t),_t(e,t,l,n),t.child;case 6:return e===null&&Ko(t),null;case 13:return Xf(e,t,n);case 4:return Xc(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Cr(t,null,r,n):_t(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:cn(r,a),wd(e,t,r,a,n);case 7:return _t(e,t,t.pendingProps,n),t.child;case 8:return _t(e,t,t.pendingProps.children,n),t.child;case 12:return _t(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,Pe(Ki,r._currentValue),r._currentValue=l,i!==null)if(mn(i.value,l)){if(i.children===a.children&&!Lt.current){t=Yn(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var u=o.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Hn(-1,n&-n),u.tag=2;var m=i.updateQueue;if(m!==null){m=m.shared;var w=m.pending;w===null?u.next=u:(u.next=w.next,w.next=u),m.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Xo(i.return,n,t),o.lanes|=n;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(B(341));l.lanes|=n,o=l.alternate,o!==null&&(o.lanes|=n),Xo(l,n,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}_t(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,wr(t,n),a=tn(a),r=r(a),t.flags|=1,_t(e,t,r,n),t.child;case 14:return r=t.type,a=cn(r,t.pendingProps),a=cn(r.type,a),_d(e,t,r,a,n);case 15:return Qf(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:cn(r,a),Ai(e,t),t.tag=1,Rt(r)?(e=!0,Qi(t)):e=!1,wr(t,n),Wf(t,r,a),Zo(t,r,a,n),nc(null,t,r,!0,e,n);case 19:return Jf(e,t,n);case 22:return Gf(e,t,n)}throw Error(B(156,t.tag))};function pp(e,t){return $h(e,t)}function Fv(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zt(e,t,n,r){return new Fv(e,t,n,r)}function hu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Wv(e){if(typeof e=="function")return hu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Lc)return 11;if(e===Rc)return 14}return 2}function ws(e,t){var n=e.alternate;return n===null?(n=Zt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ri(e,t,n,r,a,i){var l=2;if(r=e,typeof e=="function")hu(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case lr:return Vs(n.children,a,i,t);case Tc:l=8,a|=8;break;case _o:return e=Zt(12,n,t,a|2),e.elementType=_o,e.lanes=i,e;case So:return e=Zt(13,n,t,a),e.elementType=So,e.lanes=i,e;case ko:return e=Zt(19,n,t,a),e.elementType=ko,e.lanes=i,e;case _h:return yl(n,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Nh:l=10;break e;case wh:l=9;break e;case Lc:l=11;break e;case Rc:l=14;break e;case cs:l=16,r=null;break e}throw Error(B(130,e==null?e:typeof e,""))}return t=Zt(l,n,t,a),t.elementType=e,t.type=r,t.lanes=i,t}function Vs(e,t,n,r){return e=Zt(7,e,r,t),e.lanes=n,e}function yl(e,t,n,r){return e=Zt(22,e,r,t),e.elementType=_h,e.lanes=n,e.stateNode={isHidden:!1},e}function fo(e,t,n){return e=Zt(6,e,null,t),e.lanes=n,e}function po(e,t,n){return t=Zt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Hv(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ql(0),this.expirationTimes=Ql(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ql(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function fu(e,t,n,r,a,i,l,o,u){return e=new Hv(e,t,n,o,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Zt(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Kc(i),e}function qv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ir,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function mp(e){if(!e)return ks;e=e._reactInternals;e:{if(Ys(e)!==e||e.tag!==1)throw Error(B(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(B(171))}if(e.tag===1){var n=e.type;if(Rt(n))return mf(e,n,t)}return t}function gp(e,t,n,r,a,i,l,o,u){return e=fu(n,r,!0,e,a,i,l,o,u),e.context=mp(null),n=e.current,r=St(),a=Ns(n),i=Hn(r,a),i.callback=t??null,ys(n,i,a),e.current.lanes=a,Pa(e,a,r),Ot(e,r),e}function jl(e,t,n,r){var a=t.current,i=St(),l=Ns(a);return n=mp(n),t.context===null?t.context=n:t.pendingContext=n,t=Hn(i,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ys(a,t,l),e!==null&&(pn(e,a,l,i),bi(e,a,l)),l}function il(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Md(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function pu(e,t){Md(e,t),(e=e.alternate)&&Md(e,t)}function Qv(){return null}var vp=typeof reportError=="function"?reportError:function(e){console.error(e)};function mu(e){this._internalRoot=e}Nl.prototype.render=mu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(B(409));jl(e,t,null,null)};Nl.prototype.unmount=mu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Qs(function(){jl(null,e,null,null)}),t[Qn]=null}};function Nl(e){this._internalRoot=e}Nl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Qh();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ds.length&&t!==0&&t<ds[n].priority;n++);ds.splice(n,0,e),n===0&&Yh(e)}};function gu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function wl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Dd(){}function Gv(e,t,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var m=il(l);i.call(m)}}var l=gp(t,r,e,0,null,!1,!1,"",Dd);return e._reactRootContainer=l,e[Qn]=l.current,Sa(e.nodeType===8?e.parentNode:e),Qs(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var o=r;r=function(){var m=il(u);o.call(m)}}var u=fu(e,0,!1,null,null,!1,!1,"",Dd);return e._reactRootContainer=u,e[Qn]=u.current,Sa(e.nodeType===8?e.parentNode:e),Qs(function(){jl(t,u,n,r)}),u}function _l(e,t,n,r,a){var i=n._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var o=a;a=function(){var u=il(l);o.call(u)}}jl(t,l,e,a)}else l=Gv(n,t,e,a,r);return il(l)}Hh=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=sa(t.pendingLanes);n!==0&&(Mc(t,n|1),Ot(t,Ge()),!(xe&6)&&(Tr=Ge()+500,Es()))}break;case 13:Qs(function(){var r=Gn(e,1);if(r!==null){var a=St();pn(r,e,1,a)}}),pu(e,1)}};Dc=function(e){if(e.tag===13){var t=Gn(e,134217728);if(t!==null){var n=St();pn(t,e,134217728,n)}pu(e,134217728)}};qh=function(e){if(e.tag===13){var t=Ns(e),n=Gn(e,t);if(n!==null){var r=St();pn(n,e,t,r)}pu(e,t)}};Qh=function(){return ke};Gh=function(e,t){var n=ke;try{return ke=e,t()}finally{ke=n}};Mo=function(e,t,n){switch(t){case"input":if(Eo(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=fl(r);if(!a)throw Error(B(90));kh(r),Eo(r,a)}}}break;case"textarea":Ch(e,n);break;case"select":t=n.value,t!=null&&xr(e,!!n.multiple,t,!1)}};Ph=cu;Mh=Qs;var Yv={usingClientEntryPoint:!1,Events:[Da,dr,fl,Rh,Oh,cu]},Zr={findFiberByHostInstance:Bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Kv={bundleType:Zr.bundleType,version:Zr.version,rendererPackageName:Zr.rendererPackageName,rendererConfig:Zr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Kn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Bh(e),e===null?null:e.stateNode},findFiberByHostInstance:Zr.findFiberByHostInstance||Qv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gi.isDisabled&&gi.supportsFiber)try{cl=gi.inject(Kv),Sn=gi}catch{}}Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yv;Ut.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gu(t))throw Error(B(200));return qv(e,t,null,n)};Ut.createRoot=function(e,t){if(!gu(e))throw Error(B(299));var n=!1,r="",a=vp;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=fu(e,1,!1,null,null,n,!1,r,a),e[Qn]=t.current,Sa(e.nodeType===8?e.parentNode:e),new mu(t)};Ut.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(B(188)):(e=Object.keys(e).join(","),Error(B(268,e)));return e=Bh(t),e=e===null?null:e.stateNode,e};Ut.flushSync=function(e){return Qs(e)};Ut.hydrate=function(e,t,n){if(!wl(t))throw Error(B(200));return _l(null,e,t,!0,n)};Ut.hydrateRoot=function(e,t,n){if(!gu(e))throw Error(B(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",l=vp;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=gp(t,null,e,1,n??null,a,!1,i,l),e[Qn]=t.current,Sa(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Nl(t)};Ut.render=function(e,t,n){if(!wl(t))throw Error(B(200));return _l(null,e,t,!1,n)};Ut.unmountComponentAtNode=function(e){if(!wl(e))throw Error(B(40));return e._reactRootContainer?(Qs(function(){_l(null,null,e,!1,function(){e._reactRootContainer=null,e[Qn]=null})}),!0):!1};Ut.unstable_batchedUpdates=cu;Ut.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!wl(n))throw Error(B(200));if(e==null||e._reactInternals===void 0)throw Error(B(38));return _l(e,t,n,!1,r)};Ut.version="18.3.1-next-f1338f8080-20240426";function xp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xp)}catch(e){console.error(e)}}xp(),vh.exports=Ut;var Xv=vh.exports,yp,Id=Xv;yp=Id.createRoot,Id.hydrateRoot;const Jv="http://localhost:3000";let pc=localStorage.getItem("token");function ar(e){pc=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}async function Ba(e,t={}){const n={"Content-Type":"application/json",...t.headers||{}};if(pc&&(n.Authorization=`Bearer ${pc}`),typeof window<"u"&&navigator&&navigator.onLine===!1)throw new Error("offline");let r;try{r=await fetch(`${Jv}${e}`,{...t,headers:n})}catch(a){throw typeof window<"u"&&navigator&&navigator.onLine===!1?new Error("offline"):a instanceof TypeError?new Error("network_error"):a}if(!r.ok){const i=(await r.json().catch(()=>({}))).error||"request_failed";throw new Error(i)}return r.json()}function me(e){return Ba(e,{method:"GET"})}function Ne(e,t){return Ba(e,{method:"POST",body:JSON.stringify(t||{})})}function Ke(e,t){return Ba(e,{method:"PATCH",body:JSON.stringify(t||{})})}function mc(e,t){return Ba(e,{method:"PUT",body:JSON.stringify(t||{})})}function Un(e){return Ba(e,{method:"DELETE"})}const Cn=Object.create(null);Cn.open="0";Cn.close="1";Cn.ping="2";Cn.pong="3";Cn.message="4";Cn.upgrade="5";Cn.noop="6";const Oi=Object.create(null);Object.keys(Cn).forEach(e=>{Oi[Cn[e]]=e});const gc={type:"error",data:"parser error"},jp=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Np=typeof ArrayBuffer=="function",wp=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,vu=({type:e,data:t},n,r)=>jp&&t instanceof Blob?n?r(t):Bd(t,r):Np&&(t instanceof ArrayBuffer||wp(t))?n?r(t):Bd(new Blob([t]),r):r(Cn[e]+(t||"")),Bd=(e,t)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];t("b"+(r||""))},n.readAsDataURL(e)};function zd(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let mo;function Zv(e,t){if(jp&&e.data instanceof Blob)return e.data.arrayBuffer().then(zd).then(t);if(Np&&(e.data instanceof ArrayBuffer||wp(e.data)))return t(zd(e.data));vu(e,!1,n=>{mo||(mo=new TextEncoder),t(mo.encode(n))})}const $d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",aa=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<$d.length;e++)aa[$d.charCodeAt(e)]=e;const ex=e=>{let t=e.length*.75,n=e.length,r,a=0,i,l,o,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const m=new ArrayBuffer(t),w=new Uint8Array(m);for(r=0;r<n;r+=4)i=aa[e.charCodeAt(r)],l=aa[e.charCodeAt(r+1)],o=aa[e.charCodeAt(r+2)],u=aa[e.charCodeAt(r+3)],w[a++]=i<<2|l>>4,w[a++]=(l&15)<<4|o>>2,w[a++]=(o&3)<<6|u&63;return m},tx=typeof ArrayBuffer=="function",xu=(e,t)=>{if(typeof e!="string")return{type:"message",data:_p(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:nx(e.substring(1),t)}:Oi[n]?e.length>1?{type:Oi[n],data:e.substring(1)}:{type:Oi[n]}:gc},nx=(e,t)=>{if(tx){const n=ex(e);return _p(n,t)}else return{base64:!0,data:e}},_p=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Sp="",sx=(e,t)=>{const n=e.length,r=new Array(n);let a=0;e.forEach((i,l)=>{vu(i,!1,o=>{r[l]=o,++a===n&&t(r.join(Sp))})})},rx=(e,t)=>{const n=e.split(Sp),r=[];for(let a=0;a<n.length;a++){const i=xu(n[a],t);if(r.push(i),i.type==="error")break}return r};function ax(){return new TransformStream({transform(e,t){Zv(e,n=>{const r=n.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const i=new DataView(a.buffer);i.setUint8(0,126),i.setUint16(1,r)}else{a=new Uint8Array(9);const i=new DataView(a.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(a[0]|=128),t.enqueue(a),t.enqueue(n)})}})}let go;function vi(e){return e.reduce((t,n)=>t+n.length,0)}function xi(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let a=0;a<t;a++)n[a]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function ix(e,t){go||(go=new TextDecoder);const n=[];let r=0,a=-1,i=!1;return new TransformStream({transform(l,o){for(n.push(l);;){if(r===0){if(vi(n)<1)break;const u=xi(n,1);i=(u[0]&128)===128,a=u[0]&127,a<126?r=3:a===126?r=1:r=2}else if(r===1){if(vi(n)<2)break;const u=xi(n,2);a=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),r=3}else if(r===2){if(vi(n)<8)break;const u=xi(n,8),m=new DataView(u.buffer,u.byteOffset,u.length),w=m.getUint32(0);if(w>Math.pow(2,21)-1){o.enqueue(gc);break}a=w*Math.pow(2,32)+m.getUint32(4),r=3}else{if(vi(n)<a)break;const u=xi(n,a);o.enqueue(xu(i?u:go.decode(u),t)),r=0}if(a===0||a>e){o.enqueue(gc);break}}}})}const kp=4;function Je(e){if(e)return lx(e)}function lx(e){for(var t in Je.prototype)e[t]=Je.prototype[t];return e}Je.prototype.on=Je.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Je.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};Je.prototype.off=Je.prototype.removeListener=Je.prototype.removeAllListeners=Je.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,a=0;a<n.length;a++)if(r=n[a],r===t||r.fn===t){n.splice(a,1);break}return n.length===0&&delete this._callbacks["$"+e],this};Je.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,a=n.length;r<a;++r)n[r].apply(this,t)}return this};Je.prototype.emitReserved=Je.prototype.emit;Je.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Je.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Sl=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),Jt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),ox="arraybuffer";function bp(e,...t){return t.reduce((n,r)=>(e.hasOwnProperty(r)&&(n[r]=e[r]),n),{})}const cx=Jt.setTimeout,ux=Jt.clearTimeout;function kl(e,t){t.useNativeTimers?(e.setTimeoutFn=cx.bind(Jt),e.clearTimeoutFn=ux.bind(Jt)):(e.setTimeoutFn=Jt.setTimeout.bind(Jt),e.clearTimeoutFn=Jt.clearTimeout.bind(Jt))}const dx=1.33;function hx(e){return typeof e=="string"?fx(e):Math.ceil((e.byteLength||e.size)*dx)}function fx(e){let t=0,n=0;for(let r=0,a=e.length;r<a;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function Cp(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function px(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function mx(e){let t={},n=e.split("&");for(let r=0,a=n.length;r<a;r++){let i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class gx extends Error{constructor(t,n,r){super(t),this.description=n,this.context=r,this.type="TransportError"}}class yu extends Je{constructor(t){super(),this.writable=!1,kl(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,r){return super.emitReserved("error",new gx(t,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=xu(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=px(t);return n.length?"?"+n:""}}class vx extends yu{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};rx(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,sx(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=Cp()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let Ep=!1;try{Ep=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const xx=Ep;function yx(){}class jx extends vx{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,n){const r=this.request({method:"POST",data:t});r.on("success",n),r.on("error",(a,i)=>{this.onError("xhr post error",a,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=t}}class bn extends Je{constructor(t,n,r){super(),this.createRequest=t,kl(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const n=bp(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&r.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var a;r.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=bn.requestsCount++,bn.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=yx,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete bn.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}bn.requestsCount=0;bn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Ud);else if(typeof addEventListener=="function"){const e="onpagehide"in Jt?"pagehide":"unload";addEventListener(e,Ud,!1)}}function Ud(){for(let e in bn.requests)bn.requests.hasOwnProperty(e)&&bn.requests[e].abort()}const Nx=function(){const e=Ap({xdomain:!1});return e&&e.responseType!==null}();class wx extends jx{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=Nx&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new bn(Ap,this.uri(),t)}}function Ap(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||xx))return new XMLHttpRequest}catch{}if(!t)try{return new Jt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Tp=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class _x extends yu{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,r=Tp?{}:bp(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,r)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;vu(r,this.supportsBinary,i=>{try{this.doWrite(r,i)}catch{}a&&Sl(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=Cp()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const vo=Jt.WebSocket||Jt.MozWebSocket;class Sx extends _x{createSocket(t,n,r){return Tp?new vo(t,n,r):n?new vo(t,n):new vo(t)}doWrite(t,n){this.ws.send(n)}}class kx extends yu{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=ix(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),a=ax();a.readable.pipeTo(t.writable),this._writer=a.writable.getWriter();const i=()=>{r.read().then(({done:o,value:u})=>{o||(this.onPacket(u),i())}).catch(o=>{})};i();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;this._writer.write(r).then(()=>{a&&Sl(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const bx={websocket:Sx,webtransport:kx,polling:wx},Cx=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ex=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function vc(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");n!=-1&&r!=-1&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let a=Cx.exec(e||""),i={},l=14;for(;l--;)i[Ex[l]]=a[l]||"";return n!=-1&&r!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=Ax(i,i.path),i.queryKey=Tx(i,i.query),i}function Ax(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function Tx(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,a,i){a&&(n[a]=i)}),n}const xc=typeof addEventListener=="function"&&typeof removeEventListener=="function",Pi=[];xc&&addEventListener("offline",()=>{Pi.forEach(e=>e())},!1);class _s extends Je{constructor(t,n){if(super(),this.binaryType=ox,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const r=vc(t);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=vc(n.host).host);kl(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const a=r.prototype.name;this.transports.push(a),this._transportsByName[a]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=mx(this.opts.query)),xc&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Pi.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=kp,n.transport=t,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&_s.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",_s.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const a=this.writeBuffer[r].data;if(a&&(n+=hx(a)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Sl(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,r){return this._sendPacket("message",t,n,r),this}send(t,n,r){return this._sendPacket("message",t,n,r),this}_sendPacket(t,n,r,a){if(typeof n=="function"&&(a=n,n=void 0),typeof r=="function"&&(a=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:t,data:n,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(_s.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),xc&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=Pi.indexOf(this._offlineEventListener);r!==-1&&Pi.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}_s.protocol=kp;class Lx extends _s{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),r=!1;_s.priorWebsocketSuccess=!1;const a=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",v=>{if(!r)if(v.type==="pong"&&v.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;_s.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(w(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const x=new Error("probe error");x.transport=n.name,this.emitReserved("upgradeError",x)}}))};function i(){r||(r=!0,w(),n.close(),n=null)}const l=v=>{const x=new Error("probe error: "+v);x.transport=n.name,i(),this.emitReserved("upgradeError",x)};function o(){l("transport closed")}function u(){l("socket closed")}function m(v){n&&v.name!==n.name&&i()}const w=()=>{n.removeListener("open",a),n.removeListener("error",l),n.removeListener("close",o),this.off("close",u),this.off("upgrading",m)};n.once("open",a),n.once("error",l),n.once("close",o),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}let Rx=class extends Lx{constructor(t,n={}){const r=typeof t=="object"?t:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(a=>bx[a]).filter(a=>!!a)),super(t,r)}};function Ox(e,t="",n){let r=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),r=vc(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}const Px=typeof ArrayBuffer=="function",Mx=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Lp=Object.prototype.toString,Dx=typeof Blob=="function"||typeof Blob<"u"&&Lp.call(Blob)==="[object BlobConstructor]",Ix=typeof File=="function"||typeof File<"u"&&Lp.call(File)==="[object FileConstructor]";function ju(e){return Px&&(e instanceof ArrayBuffer||Mx(e))||Dx&&e instanceof Blob||Ix&&e instanceof File}function Mi(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(Mi(e[n]))return!0;return!1}if(ju(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Mi(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&Mi(e[n]))return!0;return!1}function Bx(e){const t=[],n=e.data,r=e;return r.data=yc(n,t),r.attachments=t.length,{packet:r,buffers:t}}function yc(e,t){if(!e)return e;if(ju(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=yc(e[r],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=yc(e[r],t));return n}return e}function zx(e,t){return e.data=jc(e.data,t),delete e.attachments,e}function jc(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=jc(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=jc(e[n],t));return e}const Rp=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],$x=5;var fe;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(fe||(fe={}));class Ux{constructor(t){this.replacer=t}encode(t){return(t.type===fe.EVENT||t.type===fe.ACK)&&Mi(t)?this.encodeAsBinary({type:t.type===fe.EVENT?fe.BINARY_EVENT:fe.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===fe.BINARY_EVENT||t.type===fe.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=Bx(t),r=this.encodeAsString(n.packet),a=n.buffers;return a.unshift(r),a}}class Nu extends Je{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const r=n.type===fe.BINARY_EVENT;r||n.type===fe.BINARY_ACK?(n.type=r?fe.EVENT:fe.ACK,this.reconstructor=new Vx(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(ju(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const r={type:Number(t.charAt(0))};if(fe[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===fe.BINARY_EVENT||r.type===fe.BINARY_ACK){const i=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const l=t.substring(i,n);if(l!=Number(l)||t.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(l)}if(t.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););r.nsp=t.substring(i,n)}else r.nsp="/";const a=t.charAt(n+1);if(a!==""&&Number(a)==a){const i=n+1;for(;++n;){const l=t.charAt(n);if(l==null||Number(l)!=l){--n;break}if(n===t.length)break}r.id=Number(t.substring(i,n+1))}if(t.charAt(++n)){const i=this.tryParse(t.substr(n));if(Nu.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case fe.CONNECT:return ll(n);case fe.DISCONNECT:return n===void 0;case fe.CONNECT_ERROR:return typeof n=="string"||ll(n);case fe.EVENT:case fe.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&Rp.indexOf(n[0])===-1);case fe.ACK:case fe.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Vx{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=zx(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Fx(e){return typeof e=="string"}const Wx=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};function Hx(e){return e===void 0||Wx(e)}function ll(e){return Object.prototype.toString.call(e)==="[object Object]"}function qx(e,t){switch(e){case fe.CONNECT:return t===void 0||ll(t);case fe.DISCONNECT:return t===void 0;case fe.EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Rp.indexOf(t[0])===-1);case fe.ACK:return Array.isArray(t);case fe.CONNECT_ERROR:return typeof t=="string"||ll(t);default:return!1}}function Qx(e){return Fx(e.nsp)&&Hx(e.id)&&qx(e.type,e.data)}const Gx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Nu,Encoder:Ux,get PacketType(){return fe},isPacketValid:Qx,protocol:$x},Symbol.toStringTag,{value:"Module"}));function dn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Yx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Op extends Je{constructor(t,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[dn(t,"open",this.onopen.bind(this)),dn(t,"packet",this.onpacket.bind(this)),dn(t,"error",this.onerror.bind(this)),dn(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var r,a,i;if(Yx.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const l={type:fe.EVENT,data:n};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const w=this.ids++,v=n.pop();this._registerAckCallback(w,v),l.id=w}const o=(a=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||a===void 0?void 0:a.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!o||(u?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(t,n){var r;const a=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(a===void 0){this.acks[t]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);n.call(this,new Error("operation has timed out"))},a),l=(...o)=>{this.io.clearTimeoutFn(i),n.apply(this,o)};l.withError=!0,this.acks[t]=l}emitWithAck(t,...n){return new Promise((r,a)=>{const i=(l,o)=>l?a(l):r(o);i.withError=!0,n.push(i),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((a,...i)=>(this._queue[0],a!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(a)):(this._queue.shift(),n&&n(null,...i)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:fe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case fe.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case fe.EVENT:case fe.BINARY_EVENT:this.onevent(t);break;case fe.ACK:case fe.BINARY_ACK:this.onack(t);break;case fe.DISCONNECT:this.ondisconnect();break;case fe.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let r=!1;return function(...a){r||(r=!0,n.packet({type:fe.ACK,id:t,data:a}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:fe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,t.data)}}}function Pr(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Pr.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};Pr.prototype.reset=function(){this.attempts=0};Pr.prototype.setMin=function(e){this.ms=e};Pr.prototype.setMax=function(e){this.max=e};Pr.prototype.setJitter=function(e){this.jitter=e};class Nc extends Je{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,kl(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Pr({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const a=n.parser||Gx;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Rx(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const a=dn(n,"open",function(){r.onopen(),t&&t()}),i=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),t?t(o):this.maybeReconnectOnOpen()},l=dn(n,"error",i);if(this._timeout!==!1){const o=this._timeout,u=this.setTimeoutFn(()=>{a(),i(new Error("timeout")),n.close()},o);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(a),this.subs.push(l),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(dn(t,"ping",this.onping.bind(this)),dn(t,"data",this.ondata.bind(this)),dn(t,"error",this.onerror.bind(this)),dn(t,"close",this.onclose.bind(this)),dn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){Sl(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new Op(this,t,n),this.nsps[t]=r),r}_destroy(t){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let r=0;r<n.length;r++)this.engine.write(n[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(a=>{a?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",a)):t.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const ea={};function Di(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=Ox(e,t.path||"/socket.io"),r=n.source,a=n.id,i=n.path,l=ea[a]&&i in ea[a].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||l;let u;return o?u=new Nc(r,t):(ea[a]||(ea[a]=new Nc(r,t)),u=ea[a]),n.query&&!t.query&&(t.query=n.queryKey),u.socket(n.path,t)}Object.assign(Di,{Manager:Nc,Socket:Op,io:Di,connect:Di});const Kx="http://localhost:3000";function Xx(e){return Di(Kx,{auth:{token:e}})}const Pp=f.createContext(null);function Jx({children:e}){const[t,n]=f.useState([]),r=f.useRef(new Map),a=o=>{n(m=>m.filter(w=>w.id!==o));const u=r.current.get(o);u&&(clearTimeout(u),r.current.delete(o))},i=({message:o,type:u="success",actionLabel:m,onAction:w,duration:v=6e3})=>{const x=`${Date.now()}-${Math.random().toString(36).slice(2,8)}`;if(n(C=>[...C,{id:x,message:o,type:u,actionLabel:m,onAction:w,duration:v}]),v>0){const C=setTimeout(()=>a(x),v);r.current.set(x,C)}return x},l=o=>o==="error"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 4.5c.5 0 .95.26 1.2.68l6.5 11.25a1.35 1.35 0 0 1-1.2 2.02H5.5a1.35 1.35 0 0 1-1.2-2.02L10.8 5.18c.25-.42.7-.68 1.2-.68Zm0 4.25a.9.9 0 0 0-.9.9v5.5a.9.9 0 1 0 1.8 0v-5.5a.9.9 0 0 0-.9-.9Zm0 8.3a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Z",fill:"currentColor"})}):o==="info"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 3.5a8.5 8.5 0 1 1 0 17 8.5 8.5 0 0 1 0-17Zm0 3.9a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Zm-1.2 4.2h2.4v6.1h-2.4v-6.1Z",fill:"currentColor"})}):s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M9.5 16.6 5.6 12.7a1 1 0 1 1 1.4-1.4l2.5 2.5 7.5-7.5a1 1 0 1 1 1.4 1.4l-8.9 8.9a1 1 0 0 1-1.4 0Z",fill:"currentColor"})});return s.jsxs(Pp.Provider,{value:{pushToast:i,removeToast:a},children:[e,s.jsx("div",{className:"toast-container",children:t.map(o=>s.jsxs("div",{className:`toast toast-${o.type}`,style:{"--toast-duration":`${o.duration}ms`},children:[s.jsx("div",{className:"toast-icon",children:l(o.type)}),s.jsx("div",{className:"toast-message",children:o.message}),o.actionLabel&&s.jsx("button",{className:"toast-action",type:"button",onClick:()=>{o.onAction&&Promise.resolve(o.onAction()).catch(()=>{}),a(o.id)},children:o.actionLabel}),s.jsx("button",{className:"toast-close",type:"button",onClick:()=>a(o.id),children:"x"}),o.duration>0&&s.jsx("div",{className:`toast-progress toast-progress-${o.type}`})]},o.id))})]})}function wu(){const e=f.useContext(Pp);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function Zx({user:e,isOpen:t,onToggle:n,onLogout:r,onReturnToSuperadmin:a,showReturnToSuperadmin:i,getInitial:l}){return s.jsxs("div",{className:"rail-profile",children:[s.jsx("button",{className:`profile-button ${t?"active":""}`,type:"button",onClick:n,title:"Perfil","aria-label":"Perfil",children:s.jsx("span",{children:l(e.name)})}),t&&s.jsxs("div",{className:"profile-card",children:[s.jsx("div",{className:"profile-title",children:e.name}),s.jsx("div",{className:"profile-meta",children:e.email||"Sin correo"}),s.jsx("div",{className:"profile-role",children:e.role}),i?s.jsx("button",{className:"ghost",type:"button",onClick:a,children:"Volver a superadmin"}):null,s.jsx("button",{className:"primary",type:"button",onClick:r,children:"Salir"})]})]})}function ey({navItems:e,view:t,onSetView:n,theme:r,onToggleTheme:a,user:i,logoUrl:l,brandName:o,isProfileOpen:u,onToggleProfile:m,onLogout:w,onReturnToSuperadmin:v,showReturnToSuperadmin:x,getInitial:C,SunIcon:L,MoonIcon:R}){const g=(o||"P").trim().charAt(0)||"P";return s.jsxs("aside",{className:"nav-rail",children:[s.jsx("button",{className:"rail-logo",type:"button",title:o||"Logo",children:l?s.jsx("img",{src:l,alt:o||"Logo"}):s.jsx("span",{className:"logo-mark",children:g})}),s.jsx("nav",{className:"rail-nav",children:e.map(h=>{const p=h.icon;return s.jsx("button",{className:`rail-button ${t===h.id?"active":""}`,onClick:()=>h.enabled&&n(h.id),title:h.label,"aria-label":h.label,type:"button",disabled:!h.enabled,children:s.jsx(p,{className:"rail-icon"})},h.id)})}),s.jsx("div",{className:"rail-spacer"}),s.jsx("button",{className:"rail-button",type:"button",onClick:a,title:r==="dark"?"Tema claro":"Tema oscuro","aria-label":r==="dark"?"Tema claro":"Tema oscuro",children:r==="dark"?s.jsx(L,{className:"rail-icon"}):s.jsx(R,{className:"rail-icon"})}),s.jsx(Zx,{user:i,isOpen:u,onToggle:m,onLogout:w,onReturnToSuperadmin:v,showReturnToSuperadmin:x,getInitial:C})]})}function ty({activeConversation:e,conversations:t,channels:n,brandName:r,lastReadMap:a,filters:i,showFilters:l,users:o,tags:u,statusOptions:m,statusLabels:w,formatListTime:v,messageBlocks:x,messageDraft:C,messageMode:L,quickActions:R,tagInput:g,noteInput:h,notesList:p,latestNote:y,loadingConversation:S,isInfoOpen:D,hasUnread:z,scrollDayLabel:I,activeName:_,activePhone:P,activeStatusLabel:M,canManageStatus:K,currentUser:ue,messageInputRef:pe,chatBodyRef:We,setShowFilters:Se,setFilters:Ae,loadConversation:tt,handleBackToList:V,setIsInfoOpen:Q,handleChatScroll:ne,handleAssignSelf:re,handleStatusChange:de,handleToggleTag:be,handleAddTag:A,setNoteInput:H,handleAddNote:k,reassignUserId:U,setReassignUserId:q,handleReassignConversation:le,handleOpenTagManager:he,handleCloseTagManager:ce,showTagManager:Qe,tagManagerForm:Be,setTagManagerForm:ye,handleCreateTag:ve,handleDeleteTag:Te,handleQuickAction:Ft,handleSendMessage:Me,setMessageMode:Ye,setMessageDraft:He,scrollChatToBottom:at,getInitial:xt,PlusIcon:gn,SearchIcon:sn,VideoIcon:Xn,PhoneIcon:Wt,InfoIcon:rn,SendIcon:Ht}){const W=new Map((n||[]).map(T=>[T.phone_number_id,T.display_name||(T.phone_number_id?`Linea ${String(T.phone_number_id).slice(-4)}`:"")])),we=(e==null?void 0:e.assigned_user_id)&&e.assigned_user_id!==(ue==null?void 0:ue.id);function Ee(T){if(!T)return"Sin mensajes";const je=T.last_message_preview||T.last_message_text||T.last_message||"";return je||(T.last_message_type?`[${T.last_message_type}]`:"Sin mensajes")}return s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:`chat-shell ${e?"has-active":""}`,children:[s.jsxs("aside",{className:"chat-list-panel",children:[s.jsxs("div",{className:"chat-list-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"list-title",children:(r||"Perzivalh").toUpperCase()}),s.jsx("div",{className:"list-subtitle",children:"Chats"})]}),s.jsx("button",{className:"icon-button add-chat",type:"button",title:"Nuevo chat",children:s.jsx(gn,{className:"icon"})})]}),s.jsxs("div",{className:"chat-search",children:[s.jsx(sn,{className:"search-icon"}),s.jsx("input",{type:"text",placeholder:"Buscar pacientes o mensajes",value:i.search,onFocus:()=>Se(!0),onClick:()=>Se(!0),onChange:T=>Ae(je=>({...je,search:T.target.value}))}),l&&s.jsx("button",{className:"search-close",type:"button",onClick:()=>Se(!1),"aria-label":"Cerrar filtros",children:"x"})]}),l&&s.jsxs("div",{className:"chat-filters",children:[s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Status"}),s.jsxs("select",{value:i.status,onChange:T=>Ae(je=>({...je,status:T.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),m.map(T=>s.jsx("option",{value:T,children:w[T]||T},T))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Asignado"}),s.jsxs("select",{value:i.assigned_user_id,onChange:T=>Ae(je=>({...je,assigned_user_id:T.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"unassigned",children:"Sin asignar"}),o.map(T=>s.jsx("option",{value:T.id,children:T.name},T.id))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Tags"}),s.jsxs("select",{value:i.tag,onChange:T=>Ae(je=>({...je,tag:T.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),u.map(T=>s.jsx("option",{value:T.name,children:T.name},T.id))]})]})]}),s.jsxs("div",{className:"list-header",children:[s.jsxs("select",{className:"line-filter",value:i.phone_number_id,onChange:T=>Ae(je=>({...je,phone_number_id:T.target.value})),children:[s.jsx("option",{value:"",children:"Todas las lineas"}),(n||[]).map(T=>s.jsx("option",{value:T.phone_number_id,children:T.display_name||`Linea ${String(T.phone_number_id).slice(-4)}`},T.id))]}),s.jsx("span",{children:t.length})]}),s.jsx("div",{className:"conversation-list",children:t.map((T,je)=>{var _e,Pt,yt;const En=(e==null?void 0:e.id)===T.id,vn=T.status==="pending"&&!T.assigned_user_id,An=T.display_name||T.phone_e164||T.wa_id||"Sin nombre",it=Ee(T),Tn=Number(T.unread_count||T.unread_messages||T.unread||0),xn=((Pt=(_e=T.tags)==null?void 0:_e[0])==null?void 0:Pt.name)||"",qt=(yt=T.assigned_user)!=null&&yt.name?`Tomada por ${T.assigned_user.name}`:"",j=T.phone_number_id?W.get(T.phone_number_id)||`Linea ${String(T.phone_number_id).slice(-4)}`:"",$=(a==null?void 0:a[T.id])||null,G=T.last_message_at,se=G&&(!$||new Date(G).getTime()>new Date($).getTime())&&T.last_message_direction==="in";return s.jsxs("button",{className:`conversation-item ${En?"active":""}`,onClick:()=>tt(T.id),style:{animationDelay:`${Math.min(je,6)*60}ms`},children:[s.jsxs("div",{className:"avatar",children:[s.jsx("span",{children:xt(An)}),vn&&s.jsx("span",{className:"presence-dot"})]}),s.jsxs("div",{className:"conversation-body",children:[s.jsxs("div",{className:"conversation-row",children:[s.jsx("span",{className:"conversation-name",children:An}),s.jsxs("div",{className:"conversation-right",children:[s.jsx("span",{className:"conversation-time",children:v(T.last_message_at)}),Tn>0&&s.jsx("span",{className:"conversation-unread",children:Tn})]})]}),s.jsx("div",{className:`conversation-preview ${se?"unread":""}`,children:it}),s.jsxs("div",{className:"conversation-meta",children:[j&&s.jsx("span",{className:"status-pill line-pill",children:j}),qt&&s.jsx("span",{className:"status-pill assignee-pill",children:qt}),xn&&s.jsx("span",{className:"status-pill tag-pill",children:xn})]})]})]},T.id)})})]}),s.jsxs("div",{className:`chat-view ${D?"info-open":"info-closed"}`,children:[s.jsx("div",{className:"chat-main",children:s.jsxs("div",{className:"chat-card",children:[s.jsxs("header",{className:"chat-topbar",children:[s.jsxs("div",{className:"chat-title",children:[e&&s.jsx("button",{className:"back-button",type:"button",onClick:V,children:"Chats"}),s.jsx("div",{className:"chat-avatar",children:s.jsx("span",{children:xt(_)})}),s.jsxs("div",{children:[s.jsx("div",{className:"chat-name",children:_}),e?s.jsx("div",{className:"chat-status",children:M}):s.jsx("div",{className:"chat-status muted",children:"Elige una conversacion"})]})]}),s.jsxs("div",{className:"chat-actions",children:[s.jsx("button",{className:"icon-button",type:"button",title:"Video",children:s.jsx(Xn,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Llamar",children:s.jsx(Wt,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Buscar",children:s.jsx(sn,{className:"icon"})}),s.jsx("button",{className:`icon-button ${D?"active":""}`,type:"button",title:"Info",onClick:()=>Q(T=>!T),children:s.jsx(rn,{className:"icon"})})]})]}),s.jsxs("div",{className:"chat-body",ref:We,onScroll:ne,children:[I&&s.jsx("div",{className:"chat-day-sticky","aria-hidden":"true",children:I}),S&&s.jsx("div",{className:"empty",children:"Cargando..."}),!S&&!e&&s.jsx("div",{className:"empty",children:"Selecciona una conversacion"}),!S&&e&&s.jsx(s.Fragment,{children:x.length?x:s.jsx("div",{className:"empty-state",children:"Sin mensajes"})})]}),z&&s.jsx("button",{className:"new-message-banner",type:"button",onClick:at,children:"Nuevos mensajes"}),s.jsxs("form",{className:"chat-composer",onSubmit:Me,children:[we&&s.jsx("div",{className:"assign-warning",children:"Conversacion tomada por otro operador."}),R.length>0&&s.jsx("div",{className:"quick-actions",children:R.map(T=>s.jsx("button",{className:"quick-action",type:"button",onClick:()=>Ft(T),disabled:we,children:T},T))}),s.jsxs("div",{className:"composer-row",children:[s.jsxs("select",{className:"message-mode",value:L,onChange:T=>Ye(T.target.value),disabled:we,children:[s.jsx("option",{value:"text",children:"WhatsApp"}),s.jsx("option",{value:"note",children:"Nota interna"})]}),s.jsx("input",{ref:pe,type:"text",placeholder:"Escribe un mensaje...",value:C,onChange:T=>He(T.target.value),disabled:we}),s.jsx("button",{className:"send-button",type:"submit",disabled:we,children:s.jsx(Ht,{className:"icon"})})]})]})]})}),s.jsxs("aside",{className:"chat-info",children:[s.jsxs("div",{className:"info-card",children:[s.jsx("div",{className:"info-avatar",children:s.jsx("span",{children:xt(_)})}),s.jsx("div",{className:"info-name",children:_}),s.jsx("div",{className:"info-phone",children:P||"Sin telefono"})]}),s.jsxs("div",{className:"info-section",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("div",{className:"section-title",children:"Etiquetas"}),s.jsx("button",{className:"link-button",type:"button",onClick:he,children:"Gestionar"})]}),s.jsx("div",{className:"tag-list",children:((e==null?void 0:e.tags)||[]).length?e.tags.map(T=>s.jsxs("span",{className:"tag-chip",children:[s.jsx("span",{className:"tag-chip-label",children:T.name}),s.jsx("button",{className:"tag-remove",type:"button",title:"Quitar etiqueta",onClick:()=>be(T.name),children:"x"})]},T.name)):s.jsx("div",{className:"empty-state",children:"Sin etiquetas"})}),s.jsxs("form",{className:"tag-form",onSubmit:A,children:[s.jsxs("select",{value:g,onChange:T=>setTagInput(T.target.value),children:[s.jsx("option",{value:"",children:"Selecciona etiqueta..."}),u.filter(T=>!((e==null?void 0:e.tags)||[]).some(je=>je.name===T.name)).map(T=>s.jsx("option",{value:T.name,children:T.name},T.id))]}),s.jsx("button",{className:"icon-button",type:"submit",title:"Agregar",children:s.jsx(gn,{className:"icon"})})]})]}),s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Notas internas"}),p!=null&&p.length?s.jsx("div",{className:"notes-stack",children:p.slice(-5).map(T=>s.jsx("div",{className:"note-card",children:T.text},T.id))}):s.jsx("div",{className:"empty-state",children:"Sin notas internas"}),s.jsxs("form",{className:"note-form",onSubmit:k,children:[s.jsx("input",{type:"text",placeholder:"Agregar nota interna...",value:h,onChange:T=>H(T.target.value),disabled:!e}),s.jsx("button",{className:"icon-button",type:"submit",title:"Guardar nota",children:s.jsx(gn,{className:"icon"})})]})]}),e&&s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Acciones"}),s.jsxs("div",{className:"action-stack",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:re,disabled:we,children:"Tomar conversacion"}),K&&s.jsxs("div",{className:"reassign-card",children:[s.jsxs("select",{value:U,onChange:T=>q(T.target.value),children:[s.jsx("option",{value:"",children:"Reasignar a..."}),o.map(T=>s.jsx("option",{value:T.id,children:T.name},T.id))]}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:le,disabled:!U,children:"Reasignar"})]}),K&&s.jsxs("div",{className:"action-row",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>de("open"),children:"Reactivar bot"}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>de("pending"),children:"Liberar para otro operador"})]})]})]})]})]})]}),Qe&&s.jsx("div",{className:"modal-overlay",onClick:ce,children:s.jsxs("div",{className:"modal-card",onClick:T=>T.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Gestion de etiquetas"}),s.jsx("button",{className:"modal-close",type:"button",onClick:ce,children:"x"})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("form",{className:"tag-manager-form",onSubmit:ve,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:Be.name,onChange:T=>ye(je=>({...je,name:T.target.value})),placeholder:"Nombre de etiqueta"})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Color"}),s.jsx("input",{type:"color",value:Be.color,onChange:T=>ye(je=>({...je,color:T.target.value}))})]}),s.jsx("div",{className:"modal-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Crear etiqueta"})})]}),s.jsx("div",{className:"tag-manager-list",children:(u||[]).map(T=>s.jsxs("div",{className:"tag-manager-row",children:[s.jsx("span",{className:"tag-chip",style:{borderColor:T.color||"#cbd5f5"},children:s.jsx("span",{className:"tag-chip-label",children:T.name})}),s.jsx("div",{className:"tag-manager-actions",children:s.jsx("button",{className:"danger soft",type:"button",onClick:()=>Te(T.id,T.name),children:"Eliminar"})})]},T.id))})]})]})})]})}const ny=[{day:"2024-01-01",in_count:210,out_count:90},{day:"2024-01-04",in_count:280,out_count:120},{day:"2024-01-07",in_count:240,out_count:110},{day:"2024-01-10",in_count:320,out_count:140},{day:"2024-01-13",in_count:300,out_count:130},{day:"2024-01-17",in_count:310,out_count:135},{day:"2024-01-20",in_count:290,out_count:120},{day:"2024-01-24",in_count:260,out_count:115},{day:"2024-01-27",in_count:330,out_count:150},{day:"2024-01-30",in_count:340,out_count:160}];function sy(e){const t=e?new Date(e):null;if(!t||Number.isNaN(t.getTime()))return"--";const n=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];return`${String(t.getDate()).padStart(2,"0")} ${n[t.getMonth()].toUpperCase()}`}function Vd(e){return e.length?e.map((t,n)=>`${n===0?"M":"L"}${t.x} ${t.y}`).join(" "):""}function ry({statusCounts:e,metrics:t,onRefresh:n,brandName:r}){var _;const a=(r||"Empresa").trim(),i=a?`${a} Enterprise`:"Enterprise",l=(e.open||0)+(e.pending||0),o=t!=null&&t.avg_first_reply_seconds?Number(t.avg_first_reply_seconds)/60:null,u=o?`${o.toFixed(1)}m`:"-",m=(t==null?void 0:t.conversion_rate)??(t==null?void 0:t.conversion_rate_percent)??null,v=`${(m==null?18.4:m>1?m:m*100).toFixed(1)}%`,x=((_=t==null?void 0:t.message_volume)==null?void 0:_.length)>0?t.message_volume.slice(-10):ny,C=Math.max(...x.map(P=>P.in_count+P.out_count),1),L=x.length*42+30,R=220,g=150,h=180,p=x.map((P,M)=>{const ue=(P.in_count+P.out_count)/C*g,pe=P.in_count/C*g,We=P.out_count/C*g;return{x:22+M*42,totalHeight:ue,inHeight:pe,outHeight:We}}),y=Vd(p.map((P,M)=>({x:P.x+10,y:h-P.inHeight}))),S=Vd(p.map(P=>({x:P.x+10,y:h-P.outHeight}))),D=Array.from(new Set([0,Math.floor(x.length/3),Math.floor(2*x.length/3),x.length-1])),z=Math.round((t==null?void 0:t.team_efficiency)||94),I=((t==null?void 0:t.top_tags)||[]).slice(0,3);return s.jsxs("section",{className:"dashboard-layout",children:[s.jsxs("div",{className:"dashboard-main",children:[s.jsxs("header",{className:"dashboard-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dashboard-kicker",children:i}),s.jsx("h2",{className:"dashboard-title",children:"Dashboard"}),s.jsx("div",{className:"dashboard-subtitle",children:"Marketing Analytics & WhatsApp CRM Overview"})]}),s.jsxs("div",{className:"dashboard-actions",children:[s.jsxs("button",{className:"dash-filter",type:"button",children:[s.jsx("span",{className:"dash-filter-icon","aria-hidden":"true"}),"Ultimos 30 dias"]}),s.jsx("button",{className:"primary",type:"button",onClick:n,children:"Generar Reporte"})]})]}),s.jsxs("div",{className:"dashboard-kpis",children:[s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Conversaciones activas"}),s.jsx("div",{className:"dash-kpi-value",children:l.toLocaleString()})]}),s.jsx("div",{className:"dash-kpi-icon",children:"C"})]}),s.jsx("div",{className:"dash-kpi-change up",children:"+12.5%"})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tiempo de respuesta"}),s.jsx("div",{className:"dash-kpi-value",children:u})]}),s.jsx("div",{className:"dash-kpi-icon",children:"T"})]}),s.jsx("div",{className:"dash-kpi-change down",children:"-0.8m"})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tasa de conversion"}),s.jsx("div",{className:"dash-kpi-value",children:v})]}),s.jsx("div",{className:"dash-kpi-icon",children:"%"})]}),s.jsx("div",{className:"dash-kpi-change up",children:"+2.1%"})]})]}),s.jsxs("div",{className:"dash-card dash-chart-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-card-title",children:"Flujo de Mensajes"}),s.jsx("div",{className:"dash-card-subtitle",children:"Volumen diario"})]}),s.jsxs("div",{className:"dash-legend",children:[s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot in"})," Entrantes"]}),s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot out"})," Salientes"]})]})]}),s.jsx("div",{className:"dash-chart",children:s.jsxs("svg",{className:"dash-chart-svg",viewBox:`0 0 ${L} ${R}`,preserveAspectRatio:"none",children:[s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"60",x2:L,y2:"60"}),s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"120",x2:L,y2:"120"}),p.map((P,M)=>s.jsxs("g",{children:[s.jsx("rect",{className:"dash-bar in",x:P.x,y:h-P.inHeight,width:"20",height:P.inHeight,rx:"6"}),s.jsx("rect",{className:"dash-bar out",x:P.x,y:h-P.inHeight-P.outHeight,width:"20",height:P.outHeight,rx:"6"})]},`bar-${M}`)),s.jsx("path",{className:"dash-line in",d:y}),s.jsx("path",{className:"dash-line out",d:S})]})}),s.jsx("div",{className:"dash-chart-labels",children:D.map(P=>{var M;return s.jsx("span",{children:sy((M=x[P])==null?void 0:M.day)},`label-${P}`)})})]}),s.jsxs("div",{className:"dashboard-lower",children:[s.jsxs("div",{className:"dash-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsx("div",{className:"dash-card-title",children:"Ultimas etiquetas detectadas"}),s.jsx("button",{className:"link-button",type:"button",children:"Ver todo"})]}),s.jsxs("div",{className:"dash-tag-table",children:[s.jsxs("div",{className:"dash-tag-head",children:[s.jsx("span",{children:"Etiqueta"}),s.jsx("span",{children:"Frecuencia"}),s.jsx("span",{children:"Accion"})]}),I.map(P=>s.jsxs("div",{className:"dash-tag-row",children:[s.jsx("span",{className:"dash-tag-chip",children:P.name}),s.jsx("span",{className:"dash-tag-count",children:P.count}),s.jsx("span",{className:"dash-tag-action",children:">"})]},P.name)),!I.length&&s.jsx("div",{className:"empty-state",children:"Sin etiquetas recientes"})]})]}),s.jsxs("div",{className:"dash-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsx("div",{className:"dash-card-title",children:"Actividad de Campana"}),s.jsx("span",{className:"dash-pill",children:"Monitor"})]}),s.jsxs("div",{className:"dash-campaign",children:[s.jsx("div",{className:"dash-campaign-title",children:'Campana de Verano "Pies Sanos"'}),s.jsxs("div",{className:"dash-campaign-meta",children:[s.jsx("span",{className:"dash-pill solid",children:"84% enviado"}),s.jsx("span",{className:"dash-muted",children:"Hace 2 horas"})]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:"84%"}})}),s.jsx("div",{className:"dash-muted",children:"1,240 destinatarios"})]})]})]})]}),s.jsxs("aside",{className:"dashboard-side",children:[s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Performance de Operadores"}),s.jsx("div",{className:"dash-card-subtitle",children:"Top 5 leaderboard - hoy"}),s.jsx("div",{className:"dash-operator-list",children:[{name:"Lucia Fernandez",role:"Especialista CRM",resolved:84,pending:3},{name:"Ricardo Gomez",role:"Atencion Pacientes",resolved:71,pending:8},{name:"Ana Martinez",role:"Soporte Medico",resolved:65,pending:12}].map(P=>s.jsxs("div",{className:"dash-operator",children:[s.jsx("div",{className:"dash-operator-avatar",children:P.name[0]}),s.jsxs("div",{className:"dash-operator-meta",children:[s.jsx("div",{className:"dash-operator-name",children:P.name}),s.jsx("div",{className:"dash-operator-role",children:P.role}),s.jsxs("div",{className:"dash-operator-stats",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Resueltos"}),s.jsx("div",{className:"dash-stat-value",children:P.resolved})]}),s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Pendientes"}),s.jsx("div",{className:"dash-stat-value danger",children:P.pending})]})]})]})]},P.name))})]}),s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Eficiencia de Equipo"}),s.jsxs("div",{className:"dash-efficiency",children:[s.jsxs("div",{className:"dash-efficiency-value",children:[z,"%"]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:`${z}%`}})}),s.jsx("div",{className:"dash-muted",children:"Objetivo diario: 500 conversiones"})]})]})]})]})}const Fd={draft:"BORRADOR",scheduled:"PROGRAMADA",sending:"ENVIANDO",sent:"FINALIZADA",failed:"ERROR"},yi={APPROVED:{label:"APROBADA",className:"approved"},PENDING:{label:"PENDIENTE",className:"pending"},REJECTED:{label:"RECHAZADA",className:"rejected"},DRAFT:{label:"BORRADOR",className:"draft"},PAUSED:{label:"PAUSADA",className:"pending"},DISABLED:{label:"DESHABILITADA",className:"draft"}},Wd={MARKETING:"MARKETING",UTILITY:"UTILIDAD",AUTHENTICATION:"AUTENTICACION"},ji=[{id:"audiences",label:"Audiencias",title:"Audiencias",subtitle:"MDULO DE GESTIN Y CAMPAAS"},{id:"templates",label:"Biblioteca de Plantillas",title:"Biblioteca de Plantillas",subtitle:"Consulta y gestiona las plantillas de mensajes autorizadas por WhatsApp."},{id:"new",label:"Campaas",title:"Campaas",subtitle:"Historial de envos y difusin WhatsApp"}],ay={audiencias:"audiences",audiences:"audiences",templates:"templates",plantillas:"templates",biblioteca:"templates",nueva:"new",campaign:"new",campaigns:"new",nueva_campana:"new",history:"new",historial:"new"},Hd=[{id:"dynamic",label:"Audiencias Dinmicas",title:"Automatizacin de Audiencias y Tags",subtitle:"Unificacin de flujos de datos Perzivalh CRM",actionLabel:"Guardar Configuracin"},{id:"excel",label:"Importar Excel",title:"Importacin de Contactos Excel",subtitle:"Gestin de base de datos externa Perzivalh CRM",actionLabel:"Iniciar Importacin"},{id:"odoo",label:"Importar de Odoo",title:"Sincronizacin Inteligente Odoo",subtitle:"Automatizacin de audiencias Perzivalh OS",actionLabel:"Actualizar Lista Odoo"}],iy=[{value:"phone",label:"Telfono"},{value:"name",label:"Nombre Completo"},{value:"city",label:"Ciudad"},{value:"tags",label:"Etiquetas"},{value:"ignore",label:"Sin Mapear"}];function ly({campaignForm:e,setCampaignForm:t,campaignFilter:n,setCampaignFilter:r,templates:a,campaigns:i,selectedCampaignId:l,campaignMessages:o,users:u,tags:m,selectedTemplate:w,statusOptions:v,onCreateCampaign:x,onLoadCampaigns:C,onLoadCampaignMessages:L,onSendCampaign:R,onUpdateCampaign:g,onDeleteCampaign:h,onResendCampaign:p,campaignsTotal:y,formatDate:S,brandName:D}){var Ms;const z=(D||"Perzivalh").trim(),[I,_]=f.useState(""),[P,M]=f.useState("all"),[K,ue]=f.useState(!1),[pe,We]=f.useState(null),[Se,Ae]=f.useState(""),[tt,V]=f.useState(!1),[Q,ne]=f.useState(""),[re,de]=f.useState("all"),[be,A]=f.useState(!1),[H,k]=f.useState(null),[U,q]=f.useState(""),[le,he]=f.useState(e.send_now===!1||e.scheduled_for?"schedule":"now"),[ce,Qe]=f.useState(1),[Be]=f.useState(6),{pushToast:ye}=wu(),ve=f.useRef(null),[Te,Ft]=f.useState(!1),[Me,Ye]=f.useState("dynamic"),He=f.useMemo(()=>Hd.map(c=>({...c,subtitle:c.subtitle.replace(/Perzivalh/g,z)})),[z]),[at,xt]=f.useState({enabled:!1,phone_number_id:null}),[gn,sn]=f.useState(!1),[Xn,Wt]=f.useState([]),[rn,Ht]=f.useState(!1),[W,we]=f.useState(!1),[Ee,T]=f.useState(""),[je,En]=f.useState(null),[vn,An]=f.useState(""),[it,Tn]=f.useState(null),[xn,qt]=f.useState([]),[j,$]=f.useState({targetMode:"new",listName:"",targetSegmentId:"",prefix:"",ignoreDuplicates:!0}),[G,se]=f.useState(null),[_e,Pt]=f.useState(!1),[yt,jt]=f.useState({connected:!1}),[Ln,Mr]=f.useState(!1),[Dr,Ir]=f.useState(!1),[Le,ae]=f.useState(()=>{if(typeof window>"u")return"templates";const b=new URLSearchParams(window.location.search).get("tab");return b?ay[b]||b:"templates"}),[ee,Jn]=f.useState(null),[Mt,Rn]=f.useState(null),[Zn,As]=f.useState([]),[es,Ks]=f.useState(0),[On,ts]=f.useState(!1),[Xs,bl]=f.useState(""),[yn,Ts]=f.useState(1),[ns]=f.useState(10),[Qt,Cl]=f.useState({tag:"Todas",date:"Cualquier fecha",status:"Activos"}),[El,za]=f.useState(null);f.useEffect(()=>{const c=e.send_now===!1||e.scheduled_for?"schedule":"now";he(c)},[e.send_now,e.scheduled_for]);const[$a,_u]=f.useState([]);f.useEffect(()=>{ss(),Al()},[]),f.useEffect(()=>{Te&&(Su(),Nt(),Pn())},[Te]),f.useEffect(()=>{if(Le!=="new"||be)return;const c=setTimeout(()=>{Qe(1),C(1,Be,Q.trim())},350);return()=>clearTimeout(c)},[Q,Be,be,Le,C]),f.useEffect(()=>{!Te||Me!=="odoo"||Pn()},[Me,Te]),f.useEffect(()=>{ji.find(c=>c.id===Le)||ae("templates")},[Le]),f.useEffect(()=>{if(typeof window>"u")return;const c=new URLSearchParams(window.location.search);c.set("tab",Le);const b=`${window.location.pathname}?${c.toString()}`;window.history.replaceState({},"",b)},[Le]);async function ss(){try{const c=await me("/api/audiences?with_counts=true");c&&c.segments&&_u(c.segments)}catch(c){console.error("Failed to load segments",c)}}async function Al(){try{const c=await me("/api/contacts/stats");Jn(c||null)}catch(c){console.error("Failed to load Odoo stats",c),Jn(null)}}async function Su(){sn(!0);try{const c=await me("/api/audiences/automation-settings");xt((c==null?void 0:c.settings)||{enabled:!1,phone_number_id:null})}catch(c){console.error("Failed to load automation settings",c)}finally{sn(!1)}}async function Nt(){Ht(!0);try{const c=await me("/api/audiences/dynamic-tags");Wt((c==null?void 0:c.items)||[])}catch(c){console.error("Failed to load dynamic audiences",c)}finally{Ht(!1)}}async function Br(c=at.enabled){try{const b=await Ne("/api/audiences/automation-settings",{enabled:c});xt((b==null?void 0:b.settings)||{...at,enabled:c}),ye({message:"Configuracin guardada"})}catch(b){ye({type:"error",message:b.message||"No se pudo guardar"})}}async function Ct(c){xt(b=>({...b,enabled:c})),await Br(c)}async function Ua(){we(!0);try{await Ne("/api/audiences/sync-historical",{}),await Nt(),await ss(),ye({message:"Sincronizacin completa"})}catch(c){ye({type:"error",message:c.message||"Error al sincronizar"})}finally{we(!1)}}async function zr(){const c=Ee.trim();if(c)try{await Ne("/api/audiences/dynamic-tags",{name:c}),T(""),await Nt(),await ss(),ye({message:"Etiqueta creada correctamente"})}catch(b){ye({type:"error",message:b.message||"No se pudo crear etiqueta"})}}async function Pn(){Mr(!0);try{const c=await me("/api/contacts/odoo-status");jt(c||{connected:!1})}catch(c){console.error("Failed to load Odoo status",c),jt({connected:!1})}finally{Mr(!1)}}async function dt(){Ir(!0);try{await Ne("/api/contacts/refresh-odoo",{}),await Al(),ye({message:"Lista Odoo actualizada"})}catch(c){ye({type:"error",message:c.message||"Error al actualizar Odoo"})}finally{Ir(!1)}}async function Va(c){return new Promise((b,F)=>{const Z=new FileReader;Z.onload=()=>{const Re=(Z.result||"").toString().split(",")[1]||"";b(Re)},Z.onerror=()=>F(Z.error),Z.readAsDataURL(c)})}async function Js(c){var F;const b=(F=c.target.files)==null?void 0:F[0];if(b){En(b),se(null);try{const Z=await Va(b);An(Z);const ie=await Ne("/api/audiences/import-preview",{file_base64:Z,filename:b.name});Tn(ie),qt((ie==null?void 0:ie.mapping)||[])}catch(Z){Tn(null),qt([]),ye({type:"error",message:Z.message||"No se pudo leer el archivo"})}}}async function $r(){if(!je||!vn){ye({type:"error",message:"Selecciona un archivo vlido"});return}Pt(!0);try{const c={file_base64:vn,filename:je.name,mapping:xn,options:{baseTagName:j.listName,targetSegmentId:j.targetMode==="existing"?j.targetSegmentId:"",prefix:j.prefix,ignoreDuplicates:j.ignoreDuplicates}},b=await Ne("/api/audiences/import-excel",c);se(b),await ss(),await Nt(),ye({message:"Importacin completada"})}catch(c){ye({type:"error",message:c.message||"Error al importar"})}finally{Pt(!1)}}async function Fa(c,b={}){if(!c){As([]),Ks(0);return}const F=b.page||1,Z=b.search||"";ts(!0);try{if(c.type==="odoo"){const Bn=(F-1)*ns,ln=await me(`/api/contacts?search=${encodeURIComponent(Z)}&offset=${Bn}&limit=${ns}`);let Dt=(ln==null?void 0:ln.contacts)||[];Qt.tag!=="Todas"&&(Dt=Dt.filter(is=>{const Gt=is.tags_json||[];return Qt.tag==="Con etiquetas"?Array.isArray(Gt)&&Gt.length>0:Qt.tag==="Sin etiquetas"?!Array.isArray(Gt)||Gt.length===0:!0})),Qt.status!=="Activos"&&(Dt=Dt.filter(is=>{const Gt=(is.status||"ACTIVO").toUpperCase();return Qt.status==="Activos"?Gt==="ACTIVO":Gt!=="ACTIVO"})),As(Dt),Ks((ln==null?void 0:ln.total)||Dt.length);return}const ie=await me(`/api/audiences/${c.id}/preview?limit=200`),Re=(ie==null?void 0:ie.recipients)||[],Et=Z.trim().toLowerCase();let Dn=Et?Re.filter(Bn=>{var is,Gt;const ln=((is=Bn.name)==null?void 0:is.toLowerCase())||"",Dt=((Gt=Bn.phone_e164)==null?void 0:Gt.toLowerCase())||"";return ln.includes(Et)||Dt.includes(Et)}):Re;Qt.tag==="Sin etiquetas"&&(Dn=Dn.filter(Bn=>!Bn.tags||Bn.tags.length===0));const tr=(ie==null?void 0:ie.total)||Dn.length,In=(F-1)*ns,Fr=Dn.slice(In,In+ns);As(Fr),Ks(tr)}catch(ie){console.error("Failed to load audience contacts",ie),As([]),Ks(0)}finally{ts(!1)}}function Tl(c){Rn((c==null?void 0:c.id)||null),Ts(1)}async function Ll(){try{await Ne("/api/audiences/refresh-counts",{}),await ss(),er&&await Fa(er,{page:yn,search:Xs}),ye({message:"Conteos actualizados"})}catch(c){ye({type:"error",message:c.message||"No se pudo actualizar"})}}async function Rl(c){if(!(!c||c.type==="odoo"||c.isDefault||!window.confirm(`Eliminar la audiencia "${c.name}"? Esta accin la desactiva y no borra contactos.`)))try{await Un(`/api/audiences/${c.id}`),await ss(),Mt===c.id&&Rn(null),za(null),ye({message:"Audiencia eliminada"})}catch(F){ye({type:"error",message:F.message||"No se pudo eliminar"})}}async function lt(c){if(!c||c.type==="odoo"||c.isDefault)return;const b=window.prompt("Nuevo nombre de la audiencia:",c.name);if(!(!b||!b.trim()))try{await mc(`/api/audiences/${c.id}`,{name:b.trim()}),await ss(),za(null),ye({message:"Audiencia renombrada"})}catch(F){ye({type:"error",message:F.message||"No se pudo renombrar"})}}function Zs(c,b){Cl(F=>{const Z=F[c],ie=b.indexOf(Z),Re=b[(ie+1)%b.length];return{...F,[c]:Re}})}function nt(){if(Me==="dynamic"){Br();return}if(Me==="excel"){$r();return}Me==="odoo"&&dt()}const ht=f.useMemo(()=>{const c={id:"odoo",name:"odoo",subtitle:"Origen: Odoo",count:(ee==null?void 0:ee.total)||0,type:"odoo"},b=$a.map(F=>({id:F.id,name:F.name,subtitle:F.description||"Segmento personalizado",count:F.estimated_count||0,type:"segment",isDefault:(F.name||"").toUpperCase().startsWith("DEFAULT")}));return[c,...b]},[$a,ee]),Ur=f.useMemo(()=>{const c=Se.trim().toLowerCase();return c?ht.filter(b=>{var ie,Re;const F=((ie=b.name)==null?void 0:ie.toLowerCase())||"",Z=((Re=b.subtitle)==null?void 0:Re.toLowerCase())||"";return F.includes(c)||Z.includes(c)}):ht},[ht,Se]),er=f.useMemo(()=>ht.find(c=>c.id===Mt),[ht,Mt]),Wa=c=>{const b=(c==null?void 0:c.buttons_json)??(c==null?void 0:c.buttons)??[];if(Array.isArray(b))return b;if(typeof b=="string")try{const F=JSON.parse(b);return Array.isArray(F)?F:[]}catch{return[]}return[]},Ha=f.useMemo(()=>Wa(w),[w]),rs=f.useMemo(()=>Wa(pe),[pe]),jn=f.useMemo(()=>Math.max(1,Math.ceil(es/ns)),[es,ns]),Mn=f.useMemo(()=>{const c=[],b=Math.max(1,yn-1),F=Math.min(jn,b+2);for(let Z=b;Z<=F;Z+=1)c.push(Z);return c},[yn,jn]),as=f.useMemo(()=>{const c={all:i.length,sent:0,scheduled:0,draft:0,failed:0};return i.forEach(b=>{b.status==="sent"&&(c.sent+=1),b.status==="scheduled"&&(c.scheduled+=1),b.status==="draft"&&(c.draft+=1),b.status==="failed"&&(c.failed+=1)}),c},[i]),Ls=f.useMemo(()=>{const c=Q.trim().toLowerCase();return i.filter(b=>{const F=!c||(b.name||"").toLowerCase().includes(c),Z=re==="all"||b.status===re;return F&&Z})},[i,Q,re]),Rs=f.useMemo(()=>{const c=[],b=y||i.length,F=Math.max(1,Math.ceil(b/Be)),Z=Math.max(1,ce-1),ie=Math.min(F,Z+2);for(let Re=Z;Re<=ie;Re+=1)c.push(Re);return{pages:c,totalPages:F}},[y,i.length,ce,Be]);f.useEffect(()=>{Le==="audiences"&&!Mt&&ht.length&&Rn(ht[0].id)},[ht,Le,Mt]),f.useEffect(()=>{Le!=="new"&&be&&(A(!1),k(null),Ps())},[Le,be]),f.useEffect(()=>{Le==="audiences"&&Fa(er,{page:yn,search:Xs})},[Mt,yn,Xs,Le,er,Qt]);const Os=f.useMemo(()=>{const c=new Set;return(a||[]).forEach(b=>{b.category&&c.add(b.category)}),Array.from(c)},[a]),qa=f.useMemo(()=>{const c=I.trim().toLowerCase(),b=P==="all"?"":P.toLowerCase();return(a||[]).filter(F=>{var Dn,tr;const Z=((Dn=F.name)==null?void 0:Dn.toLowerCase())||"",ie=((tr=F.category)==null?void 0:tr.toLowerCase())||"";return(!c||Z.includes(c)||ie.includes(c))&&(!b||ie===b)})},[I,P,a]),Qa=f.useMemo(()=>{const c=U.trim().toLowerCase();return(a||[]).filter(b=>{var Z;const F=((Z=b.name)==null?void 0:Z.toLowerCase())||"";return!c||F.includes(c)})},[U,a]),Vr=f.useMemo(()=>n.segment_id?ht.find(c=>c.id===n.segment_id)||null:n.tag&&ht.find(c=>c.name===n.tag)||null,[ht,n.segment_id,n.tag]),Ga=f.useMemo(()=>n.segment_id?`segment:${n.segment_id}`:n.tag?`tag:${n.tag}`:n.assigned_user_id?`assigned:${n.assigned_user_id}`:n.status?`status:${n.status}`:n.verified_only?"verified":"",[n.segment_id,n.tag,n.assigned_user_id,n.status,n.verified_only]);function Ya(c){r(b=>{const F={...b,status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""};if(c.startsWith("segment:")){const Z=c.slice(8),ie=ht.find(Re=>Re.id===Z);F.segment_id=Z,F.segment_name=(ie==null?void 0:ie.name)||""}else c.startsWith("tag:")?F.tag=c.slice(4):c.startsWith("status:")?F.status=c.slice(7):c.startsWith("assigned:")?F.assigned_user_id=c.slice(9):c==="verified"&&(F.verified_only=!0);return F})}function Ol(c){if(!c)return"";const b=new Date(c);if(Number.isNaN(b.getTime()))return"";const F=Z=>String(Z).padStart(2,"0");return`${b.getFullYear()}-${F(b.getMonth()+1)}-${F(b.getDate())}T${F(b.getHours())}:${F(b.getMinutes())}`}function Pl(c){t(b=>({...b,template_id:c}))}function Ps(){t({name:"",template_id:"",scheduled_for:"",send_now:!0}),r({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),q("")}function Ml(c){if(!c)return;k(c),A(!0),t(F=>{var Z;return{...F,name:c.name||"",template_id:c.template_id||((Z=c.template)==null?void 0:Z.id)||"",scheduled_for:Ol(c.scheduled_for),send_now:!c.scheduled_for}});const b=c.audience_filter||{};r(F=>({...F,status:b.status||"",tag:b.tag||"",assigned_user_id:b.assigned_user_id||"",verified_only:!!b.verified_only,segment_id:b.segment_id||"",segment_name:b.segment_name||""}))}function Dl(c){!(c!=null&&c.id)||!h||!window.confirm(`Eliminar la campaa "${c.name}"?`)||h(c.id)}function Ka(c){!(c!=null&&c.id)||!p||!window.confirm(`Reenviar la campaa "${c.name}"?`)||p(c.id)}function an(c){if(c.preventDefault(),!e.name.trim()||!e.template_id)return;const b={};if(n.status&&(b.status=n.status),n.tag&&(b.tag=n.tag.trim()),n.assigned_user_id&&(b.assigned_user_id=n.assigned_user_id),n.verified_only&&(b.verified_only=!0),n.segment_id&&(b.segment_id=n.segment_id,n.segment_name&&(b.segment_name=n.segment_name)),H&&g){g(H.id,{name:e.name.trim(),template_id:e.template_id,audience_filter:b,scheduled_for:e.scheduled_for||null}),A(!1),k(null),Ps();return}x(c)}function Il(c){We(c),ue(!0)}const Bl=ji.find(c=>c.id===Le)||ji[1],zl={title:"Campaas",subtitle:"CONFIGURACIN DE NUEVO ENVO MASIVO"},Xa=He.find(c=>c.id===Me)||He[0],Ja=Te?Xa:Le==="new"&&be?zl:Bl;return s.jsxs("section",{className:"campaigns-page",children:[s.jsxs("div",{className:"campaigns-shell",children:[s.jsxs("header",{className:"campaigns-header",children:[s.jsxs("div",{className:"campaigns-title-block",children:[s.jsxs("div",{className:"campaigns-title-row",children:[Te&&s.jsx("button",{className:"campaigns-back",type:"button",onClick:()=>Ft(!1),"aria-label":"Volver",children:"<"}),s.jsx("span",{className:"campaigns-heading",children:Ja.title})]}),s.jsx("div",{className:`campaigns-subtitle ${Te?"campaigns-subtitle--upper":""}`,children:Ja.subtitle})]}),s.jsxs("div",{className:"campaigns-actions",children:[Te&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>Ft(!1),children:Me==="excel"?"Cancelar":"Descartar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:nt,disabled:Me==="excel"&&(_e||!vn||j.targetMode==="new"&&!j.listName.trim()||j.targetMode==="existing"&&!j.targetSegmentId)||Me==="odoo"&&Dr,children:Xa.actionLabel})]}),!Te&&Le==="audiences"&&s.jsxs("button",{className:"campaigns-primary campaigns-primary--dropdown",type:"button",onClick:()=>{Ft(!0),Ye("dynamic")},children:[s.jsx("span",{className:"campaigns-primary-icon",children:"+"}),"Nueva Audiencia"]}),!Te&&Le==="new"&&s.jsx(s.Fragment,{children:be?s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>{A(!1),k(null),Ps()},children:"Cancelar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>{var c,b;return(b=(c=ve.current)==null?void 0:c.requestSubmit)==null?void 0:b.call(c)},children:"Lanzar Campaa"})]}):s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>A(!0),children:"+ Lanzar Campaa"})})]})]}),!Te&&s.jsx("nav",{className:"campaigns-tabs",role:"tablist","aria-label":"Secciones de Campaas",children:ji.map(c=>s.jsx("button",{type:"button",role:"tab","aria-selected":Le===c.id,className:`campaigns-tab ${Le===c.id?"active":""}`,onClick:()=>ae(c.id),children:c.label},c.id))}),s.jsx("div",{className:"campaigns-tab-panel",children:Te?s.jsxs("section",{className:"audience-flow",children:[s.jsx("nav",{className:"audience-flow-tabs",role:"tablist","aria-label":"Flujo de nueva audiencia",children:Hd.map(c=>s.jsx("button",{type:"button",role:"tab","aria-selected":Me===c.id,className:`audience-flow-tab ${Me===c.id?"active":""}`,onClick:()=>Ye(c.id),children:c.label},c.id))}),s.jsxs("div",{className:"audience-flow-panel",children:[Me==="dynamic"&&s.jsxs("div",{className:"audience-flow-content",children:[s.jsxs("div",{className:"audience-hero",children:[s.jsxs("div",{className:"audience-hero-main",children:[s.jsx("div",{className:"audience-hero-title",children:"Sincronizacin Automtica Total"}),s.jsx("div",{className:"audience-hero-subtitle",children:"Vincula tus etiquetas directamente con Audiencias Dinmicas. La lgica del sistema es 1 Tag = 1 Audiencia."})]}),s.jsxs("label",{className:"audience-switch",children:[s.jsx("span",{children:"Estado"}),s.jsx("input",{type:"checkbox",checked:at.enabled,onChange:c=>Ct(c.target.checked),disabled:gn}),s.jsx("span",{children:at.enabled?"ACTIVO":"INACTIVO"})]})]}),s.jsxs("div",{className:"audience-rule-card",children:[s.jsx("div",{className:"audience-rule-title",children:"Regla de Automatizacin unificada"}),s.jsx("p",{children:"Cuando un operador o bot etiqueta a un contacto en el CRM, este se aade instantneamente a la lista de audiencia correspondiente. No requiere intervencin manual adicional."})]}),s.jsxs("div",{className:"audience-section-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audience-section-title",children:"Gestin de Etiquetas dinmicas"}),s.jsx("div",{className:"audience-section-subtitle",children:"Administra las etiquetas vinculadas que alimentan tus listas de envo en tiempo real."})]}),s.jsxs("div",{className:"audience-section-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:Ua,disabled:W,children:W?"Sincronizando...":"Sincronizar Datos Histricos"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:zr,disabled:!Ee.trim(),children:"Nueva Etiqueta / Audiencia"})]})]}),s.jsxs("div",{className:"audience-tags-grid",children:[rn&&s.jsx("div",{className:"empty-state",children:"Cargando etiquetas..."}),!rn&&Xn.length===0&&s.jsx("div",{className:"empty-state",children:"No hay etiquetas dinmicas an."}),!rn&&Xn.map(c=>{var b,F,Z,ie;return s.jsxs("div",{className:`audience-tag-card ${c.is_default?"default":""}`,children:[s.jsxs("div",{className:"audience-tag-head",children:[s.jsx("div",{className:"audience-tag-name",children:c.is_default?"DEFAULT":((b=c.tag)==null?void 0:b.name)||((F=c.segment)==null?void 0:F.name)}),s.jsx("div",{className:"audience-tag-count",children:((Z=c.segment)==null?void 0:Z.estimated_count)||0})]}),s.jsxs("div",{className:"audience-tag-meta",children:["Audiencia: ",((ie=c.segment)==null?void 0:ie.estimated_count)||0," contactos"]}),s.jsxs("div",{className:"audience-tag-status",children:[s.jsx("span",{className:"dot"}),"Sincronizado",s.jsx("span",{className:"audience-tag-time",children:c.last_synced_at?`  ${S(c.last_synced_at)}`:""})]})]},c.id)}),s.jsx("div",{className:"audience-tag-card add",children:s.jsxs("div",{className:"audience-tag-add",children:[s.jsx("div",{className:"audience-tag-add-icon",children:"+"}),s.jsx("input",{type:"text",placeholder:"Crear nueva etiqueta",value:Ee,onChange:c=>T(c.target.value)}),s.jsx("button",{type:"button",className:"campaigns-primary",onClick:zr,disabled:!Ee.trim(),children:"Crear"})]})})]})]}),Me==="excel"&&s.jsxs("div",{className:"audience-flow-content",children:[s.jsx("div",{className:"excel-dropzone",children:s.jsxs("div",{className:"excel-dropzone-inner",children:[s.jsx("div",{className:"excel-dropzone-icon",children:"?"}),s.jsx("div",{className:"excel-dropzone-title",children:"Sube tu archivo de Excel"}),s.jsxs("div",{className:"excel-dropzone-subtitle",children:["Arrastra y suelta tu archivo .xlsx o .csv aqu o"," ",s.jsxs("label",{className:"excel-link",children:["explora tus archivos",s.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:Js})]})]}),s.jsxs("div",{className:"excel-dropzone-tags",children:[s.jsx("span",{children:"Mximo 50MB"}),s.jsx("span",{children:"Hasta 50,000 filas"})]}),je&&s.jsx("div",{className:"excel-file-name",children:je.name})]})}),s.jsxs("div",{className:"excel-grid",children:[s.jsxs("div",{className:"excel-card",children:[s.jsx("div",{className:"excel-card-title",children:"Configuracin de Importacin"}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista de destino"}),s.jsxs("select",{value:j.targetMode,onChange:c=>$(b=>({...b,targetMode:c.target.value})),children:[s.jsx("option",{value:"new",children:"Crear Nueva Lista"}),s.jsx("option",{value:"existing",children:"Elegir Lista Existente"})]})]}),j.targetMode==="new"?s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Nombre de la nueva lista"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO",value:j.listName,onChange:c=>$(b=>({...b,listName:c.target.value}))})]}):s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista existente"}),s.jsxs("select",{value:j.targetSegmentId,onChange:c=>$(b=>({...b,targetSegmentId:c.target.value})),children:[s.jsx("option",{value:"",children:"Selecciona una lista"}),$a.map(c=>s.jsx("option",{value:c.id,children:c.name},c.id))]})]}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Prefijo de etiqueta (opcional)"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO_",value:j.prefix,onChange:c=>$(b=>({...b,prefix:c.target.value}))})]}),s.jsxs("label",{className:"excel-checkbox",children:[s.jsx("input",{type:"checkbox",checked:j.ignoreDuplicates,onChange:c=>$(b=>({...b,ignoreDuplicates:c.target.checked}))}),"Ignorar contactos duplicados"]}),G&&s.jsxs("div",{className:"excel-summary",children:["Procesadas: ",G.processed,"  Nuevos:"," ",G.created,"  Duplicados:"," ",G.skipped,"  Errores: ",G.errors]})]}),s.jsxs("div",{className:"excel-card",children:[s.jsxs("div",{className:"excel-card-title",children:["Vista previa de mapeo",s.jsxs("span",{className:"excel-pill",children:["Columnas detectadas: ",((Ms=it==null?void 0:it.columns)==null?void 0:Ms.length)||0]})]}),s.jsxs("div",{className:"excel-map-table",children:[s.jsxs("div",{className:"excel-map-head",children:[s.jsx("span",{children:"Columna Excel"}),s.jsx("span",{children:"Mapeo CRM"}),s.jsx("span",{children:"Ejemplo"})]}),((it==null?void 0:it.columns)||[]).map((c,b)=>{var F,Z;return s.jsxs("div",{className:"excel-map-row",children:[s.jsx("span",{children:c}),s.jsx("select",{value:xn[b]||"ignore",onChange:ie=>qt(Re=>{const Et=[...Re];return Et[b]=ie.target.value,Et}),children:iy.map(ie=>s.jsx("option",{value:ie.value,children:ie.label},ie.value))}),s.jsx("span",{children:((Z=(F=it==null?void 0:it.previewRows)==null?void 0:F[0])==null?void 0:Z[b])||"--"})]},`${c}-${b}`)}),!it&&s.jsx("div",{className:"empty-state",children:"Sube un archivo para ver el mapeo."})]})]})]})]}),Me==="odoo"&&s.jsxs("div",{className:"audience-flow-content odoo-flow",children:[s.jsxs("div",{className:"odoo-status",children:[s.jsx("span",{className:`odoo-indicator ${yt.connected?"on":"off"}`}),"Estado: ",yt.connected?"Odoo conectado":"Odoo no conectado"]}),s.jsxs("div",{className:"odoo-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:Pn,disabled:Ln,children:Ln?"Validando...":"Validar Conexin"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:dt,disabled:Dr,children:Dr?"Actualizando...":"Actualizar Lista Odoo"})]}),s.jsx("div",{className:"odoo-note",children:"Se importarn contactos y se crearn audiencias por etiqueta Automticamente."})]})]})]}):s.jsxs(s.Fragment,{children:[Le==="templates"&&s.jsxs("section",{className:"campaigns-panel templates-panel",children:[s.jsxs("div",{className:"templates-toolbar",children:[s.jsxs("label",{className:"templates-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar por nombre de plantilla...",value:I,onChange:c=>_(c.target.value)})]}),s.jsxs("select",{className:"templates-select",value:P,onChange:c=>M(c.target.value),children:[s.jsx("option",{value:"all",children:"Todas las categorias"}),Os.map(c=>s.jsx("option",{value:c.toLowerCase(),children:Wd[c]||c},c))]})]}),s.jsxs("div",{className:"template-grid template-grid--library",children:[qa.map(c=>{const b=(c.status||(c.is_active?"APPROVED":"PENDING")).toUpperCase(),F=yi[b]||yi.PENDING,Z=Wd[c.category]||c.category||"GENERAL",ie=c.id===e.template_id,Re=c.rejection_reason||c.rejectionReason||c.rejection_message||"",Et=b==="REJECTED"?"Ver detalles":"Previsualizar";return s.jsxs("div",{className:`template-card ${ie?"selected":""}`,children:[s.jsxs("div",{className:"template-head",children:[s.jsx("div",{className:"template-name",title:c.name,children:c.name}),s.jsx("span",{className:`template-status ${F.className}`,children:F.label})]}),s.jsx("div",{className:"template-category",children:Z}),s.jsx("div",{className:`template-preview ${b==="REJECTED"?"rejected":""}`,children:c.body_preview||c.body_text||"Sin preview"}),b==="REJECTED"&&Re&&s.jsxs("div",{className:"template-rejection",children:["Rechazada por Meta: ",Re]}),s.jsx("div",{className:"template-footer",children:s.jsx("button",{className:"template-action",type:"button",onClick:()=>Il(c),children:Et})})]},c.id)}),!qa.length&&s.jsx("div",{className:"empty-state",children:"Sin plantillas disponibles"})]})]}),Le==="audiences"&&s.jsx("section",{className:"campaigns-panel audiences-panel",children:s.jsxs("div",{className:"audiences-layout",children:[s.jsxs("div",{className:"audiences-list",children:[s.jsxs("label",{className:"audiences-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar lista...",value:Se,onChange:c=>Ae(c.target.value)})]}),s.jsxs("div",{className:"audience-list",children:[Ur.map(c=>{var b;return s.jsxs("button",{type:"button",className:`audience-card ${Mt===c.id?"active":""}`,onClick:()=>Tl(c),children:[s.jsxs("div",{className:"audience-title",children:[s.jsx("span",{children:c.name}),s.jsxs("div",{className:"audience-title-actions",children:[s.jsx("span",{className:"audience-count",children:((b=c.count)==null?void 0:b.toLocaleString("es-PE"))||0}),!c.isDefault&&c.type!=="odoo"&&s.jsxs("div",{className:"audience-menu-wrapper",children:[s.jsx("button",{className:"audience-menu",type:"button","aria-label":"Opciones de audiencia",onClick:F=>{F.stopPropagation(),za(Z=>Z===c.id?null:c.id)},children:"..."}),El===c.id&&s.jsxs("div",{className:"audience-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>lt(c),children:"Renombrar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>Rl(c),children:"Eliminar"})]})]})]})]}),s.jsx("div",{className:"audience-subtitle",children:c.subtitle})]},c.id)}),!Ur.length&&s.jsx("div",{className:"empty-state",children:"Sin audiencias disponibles"})]})]}),s.jsxs("div",{className:"audiences-table-panel",children:[s.jsxs("div",{className:"audiences-filters",children:[s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ETIQUETA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>Zs("tag",["Todas","Con etiquetas","Sin etiquetas"]),children:Qt.tag})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"FECHA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>Zs("date",["Cualquier fecha","ltimos 30 das"]),children:Qt.date})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ESTADO:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>Zs("status",["Activos","Inactivos"]),children:Qt.status})]}),s.jsxs("div",{className:"audiences-filter-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Descargar",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Actualizar",onClick:Ll,children:""})]})]}),s.jsxs("div",{className:"audiences-search-row",children:[s.jsxs("label",{className:"audiences-search-field",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar contacto en esta lista...",value:Xs,onChange:c=>{bl(c.target.value),Ts(1)}})]}),s.jsxs("div",{className:"audiences-total",children:[es.toLocaleString("es-PE")," contactos en total"]})]}),s.jsxs("div",{className:"audiences-table",children:[s.jsxs("div",{className:"audiences-table-head",children:[s.jsx("span",{}),s.jsx("span",{children:"CONTACTO"}),s.jsx("span",{children:"WHATSAPP"}),s.jsx("span",{children:"ETIQUETAS"}),s.jsx("span",{children:"FECHA REGISTRO"}),s.jsx("span",{children:"ESTADO"}),s.jsx("span",{})]}),On&&s.jsx("div",{className:"loading",children:"Cargando contactos..."}),!On&&Zn.length===0&&s.jsx("div",{className:"empty-state",children:"No hay contactos en esta audiencia."}),!On&&Zn.map(c=>{const b=c.name||"Sin nombre",F=c.email||"",Z=c.phone_e164||c.phone||"-",ie=Array.isArray(c.tags)?c.tags:c.tags?[c.tags]:[],Re=b.trim().slice(0,1).toUpperCase();return s.jsxs("div",{className:"audiences-table-row",children:[s.jsx("input",{type:"checkbox","aria-label":"Seleccionar contacto"}),s.jsxs("div",{className:"audiences-contact",children:[s.jsx("div",{className:"audiences-avatar",children:Re}),s.jsxs("div",{className:"audiences-contact-info",children:[s.jsx("div",{className:"audiences-contact-name",children:b}),F&&s.jsx("div",{className:"audiences-contact-email",children:F})]})]}),s.jsx("div",{children:Z}),s.jsx("div",{className:"audiences-tags",children:ie.length?ie.map(Et=>s.jsx("span",{className:"audiences-tag",children:Et},`${c.id}-${Et}`)):s.jsx("span",{className:"audiences-tag empty",children:""})}),s.jsx("div",{children:c.created_at?S(c.created_at):""}),s.jsx("div",{className:"audiences-status",children:(c.status||"ACTIVO").toUpperCase()}),s.jsx("button",{className:"audiences-menu",type:"button","aria-label":"Opciones",children:"..."})]},c.id||Z)})]}),s.jsxs("div",{className:"audiences-pagination",children:[s.jsxs("div",{className:"audiences-page-info",children:["Pgina ",yn," de ",jn]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:yn<=1,onClick:()=>Ts(c=>Math.max(1,c-1)),children:"<"}),Mn.map(c=>s.jsx("button",{className:`audiences-page-btn ${c===yn?"active":""}`,type:"button",onClick:()=>Ts(c),children:c},`aud-page-${c}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:yn>=jn,onClick:()=>Ts(c=>Math.min(jn,c+1)),children:">"})]})]})]})]})}),Le==="new"&&s.jsx("section",{className:"campaigns-panel campaigns-module",children:be?s.jsxs("div",{className:"campaigns-launch",children:[s.jsxs("form",{className:"campaigns-launch-form",ref:ve,onSubmit:an,children:[s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"1"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Nombre de la Campaa"}),s.jsx("input",{type:"text",placeholder:"Ej: Promocin Black Friday 2024",value:e.name,onChange:c=>t(b=>({...b,name:c.target.value}))})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"2"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Seleccionar Audiencia"}),s.jsxs("select",{value:Ga,onChange:c=>Ya(c.target.value),children:[s.jsx("option",{value:"",children:"Selecciona un segmento..."}),ht.filter(c=>c.type!=="odoo").map(c=>s.jsx("option",{value:`segment:${c.id}`,children:c.name},`seg-${c.id}`)),s.jsx("option",{value:"verified",children:"Solo verificados"}),s.jsx("option",{value:"assigned:unassigned",children:"Sin asignar"})]})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"3"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Elegir Plantilla de Meta"}),s.jsxs("div",{className:"launch-template-search",children:[s.jsx("input",{type:"text",placeholder:"Buscar plantilla...",value:U,onChange:c=>q(c.target.value)}),s.jsx("button",{type:"button",onClick:()=>q(""),children:"Limpiar"})]}),s.jsx("div",{className:"launch-templates-scroll",children:s.jsxs("div",{className:"launch-templates",children:[Qa.map(c=>{const b=c.status||"APPROVED",F=yi[b]||yi.APPROVED,Z=e.template_id===c.id;return s.jsxs("button",{className:`launch-template ${Z?"selected":""}`,type:"button",onClick:()=>Pl(c.id),children:[s.jsx("div",{className:"launch-template-icon"}),s.jsx("div",{className:"launch-template-title",children:c.name}),s.jsx("div",{className:"launch-template-preview",children:c.body_preview||c.body_text||"Sin preview"}),s.jsx("span",{className:`launch-template-status ${F.className}`,children:F.label})]},c.id)}),Qa.length===0&&s.jsx("div",{className:"launch-empty",children:"Sin plantillas"})]})})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"4"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Programacin"}),s.jsxs("div",{className:"launch-schedule",children:[s.jsx("button",{className:`launch-schedule-option ${le==="now"?"active":""}`,type:"button",onClick:()=>{he("now"),t(c=>({...c,scheduled_for:"",send_now:!0}))},children:"Enviar Ahora"}),s.jsx("button",{className:`launch-schedule-option ${le==="schedule"?"active":""}`,type:"button",onClick:()=>{he("schedule"),t(c=>({...c,send_now:!1}))},children:"Programar Envo"})]}),le==="schedule"&&s.jsx("input",{type:"datetime-local",value:e.scheduled_for,onChange:c=>t(b=>({...b,scheduled_for:c.target.value,send_now:!1}))})]})]})]}),s.jsxs("aside",{className:"campaigns-launch-preview",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:"Nombre del Cliente"}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(w==null?void 0:w.body_preview)||(w==null?void 0:w.body_text)||"Selecciona una plantilla para ver el contenido."}),Ha.length>0&&s.jsx("div",{className:"preview-actions",children:Ha.map((c,b)=>s.jsx("button",{type:"button",children:c.text||c.label||c.title||`Botn ${b+1}`},`preview-btn-${b}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Destinatarios"}),s.jsx("strong",{children:(Vr==null?void 0:Vr.count)||0})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:(w==null?void 0:w.name)||"Sin plantilla"})]})]})]})]}):s.jsxs("div",{className:"campaigns-dashboard",children:[s.jsxs("aside",{className:"campaigns-sidebar",children:[s.jsxs("label",{className:"campaigns-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar campaa...",value:Q,onChange:c=>ne(c.target.value)})]}),s.jsxs("div",{className:"campaigns-filters-list",children:[s.jsxs("button",{className:`campaigns-filter-item ${re==="all"?"active":""}`,type:"button",onClick:()=>de("all"),children:[s.jsx("span",{children:"Todas las Campaas"}),s.jsx("span",{className:"campaigns-filter-count",children:as.all})]}),s.jsxs("button",{className:`campaigns-filter-item ${re==="sent"?"active":""}`,type:"button",onClick:()=>de("sent"),children:[s.jsx("span",{children:"Enviadas"}),s.jsx("span",{className:"campaigns-filter-count",children:as.sent})]}),s.jsxs("button",{className:`campaigns-filter-item ${re==="scheduled"?"active":""}`,type:"button",onClick:()=>de("scheduled"),children:[s.jsx("span",{children:"Programadas"}),s.jsx("span",{className:"campaigns-filter-count",children:as.scheduled})]}),s.jsxs("button",{className:`campaigns-filter-item ${re==="draft"?"active":""}`,type:"button",onClick:()=>de("draft"),children:[s.jsx("span",{children:"Borradores"}),s.jsx("span",{className:"campaigns-filter-count",children:as.draft})]}),s.jsxs("button",{className:`campaigns-filter-item ${re==="failed"?"active":""}`,type:"button",onClick:()=>de("failed"),children:[s.jsx("span",{children:"Fallidas"}),s.jsx("span",{className:"campaigns-filter-count",children:as.failed})]})]}),s.jsxs("div",{className:"campaigns-quota",children:[s.jsx("div",{className:"campaigns-quota-title",children:"Cuota de mensajes"}),s.jsx("div",{className:"campaigns-quota-bar",children:s.jsx("div",{className:"campaigns-quota-fill",style:{width:"65%"}})}),s.jsx("div",{className:"campaigns-quota-meta",children:"65% usado"})]})]}),s.jsxs("div",{className:"campaigns-table-panel",children:[s.jsxs("div",{className:"campaigns-table-filters",children:[s.jsx("div",{className:"campaigns-filter-chip",children:"Canal: WhatsApp Business"}),s.jsx("div",{className:"campaigns-filter-chip",children:"Periodo: ltimos 30 das"}),s.jsxs("div",{className:"campaigns-table-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button",onClick:()=>C(ce,Be,Q.trim()),children:""})]})]}),s.jsxs("div",{className:"campaigns-table",children:[s.jsxs("div",{className:"campaigns-table-head",children:[s.jsx("span",{children:"Campaa"}),s.jsx("span",{children:"Fecha"}),s.jsx("span",{children:"Audiencia"}),s.jsx("span",{children:"Enviados"}),s.jsx("span",{children:"Ledos"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{})]}),Ls.map(c=>{const b=c.messages_count||c.audience_count||"--",F=c.read_count||"--",Z=c.reply_count||"--",ie=Fd[c.status]||c.status;return s.jsxs("div",{className:"campaigns-table-row",children:[s.jsxs("div",{className:"campaigns-table-title",children:[s.jsx("div",{className:"campaigns-table-name",children:c.name}),s.jsxs("div",{className:"campaigns-table-ref",children:["Ref: ",c.id.slice(0,10)]})]}),s.jsx("div",{className:"campaigns-table-date",children:S(c.created_at)}),s.jsx("div",{className:"campaigns-table-tags",children:s.jsx("span",{className:"campaigns-pill",children:c.audience_label||"Base General"})}),s.jsx("div",{className:"campaigns-metric",children:b}),s.jsx("div",{className:"campaigns-metric",children:F}),s.jsx("div",{className:"campaigns-metric",children:Z}),s.jsx("div",{className:`campaigns-status ${c.status}`,children:ie}),s.jsxs("div",{className:"campaigns-row-actions",children:[["draft","scheduled"].includes(c.status)&&s.jsx("button",{className:"campaigns-row-btn",type:"button",onClick:()=>Ml(c),children:"Editar"}),(c.status==="sent"||c.status==="failed")&&s.jsx("button",{className:"campaigns-row-btn",type:"button",onClick:()=>Ka(c),children:"Reenviar"}),["draft","failed","scheduled"].includes(c.status)&&s.jsx("button",{className:"campaigns-row-btn danger",type:"button",onClick:()=>Dl(c),children:"Eliminar"})]})]},c.id)}),!Ls.length&&s.jsx("div",{className:"empty-state",children:"Sin campaas registradas"})]}),s.jsxs("div",{className:"campaigns-table-footer",children:[s.jsxs("span",{children:["Mostrando ",Ls.length," de"," ",y||i.length," campaas"]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:ce<=1,onClick:()=>{const c=Math.max(1,ce-1);Qe(c),C(c,Be,Q.trim())},children:"<"}),Rs.pages.map(c=>s.jsx("button",{className:`audiences-page-btn ${c===ce?"active":""}`,type:"button",onClick:()=>{Qe(c),C(c,Be,Q.trim())},children:c},`camp-page-${c}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:ce>=Rs.totalPages,onClick:()=>{const c=Math.min(Rs.totalPages,ce+1);Qe(c),C(c,Be,Q.trim())},children:">"})]})]})]})]})}),Le==="history"&&s.jsxs("section",{className:"campaigns-panel campaigns-history",children:[s.jsxs("div",{className:"campaigns-history-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"campaigns-history-title",children:"Historial de Envos"}),s.jsx("div",{className:"campaigns-history-subtitle",children:"ltimos 30 das"})]}),s.jsx("button",{className:"campaigns-link",type:"button",onClick:C,children:"Ver todo el historial"})]}),s.jsxs("div",{className:"history-table history-table--main",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"Campaa / Fecha"}),s.jsx("span",{children:"Alcance"}),s.jsx("span",{children:"Tasa de lectura"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),i.map(c=>{const b=Fd[c.status]||c.status,F=c.audience_count||c.messages_count||c.total||"--";return s.jsxs("div",{className:"history-row",children:[s.jsxs("div",{className:"history-title",children:[s.jsx("div",{className:"history-name",children:c.name}),s.jsx("div",{className:"history-date",children:S(c.created_at)})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:F}),s.jsx("div",{className:"history-label",children:"contactos"})]}),s.jsxs("div",{className:"history-meter",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-bar",children:s.jsx("div",{className:"history-bar-fill",style:{width:"0%"}})})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-label",children:"mensajes"})]}),s.jsx("div",{className:`history-status ${c.status}`,children:b}),s.jsxs("div",{className:"history-actions",children:[s.jsx("button",{className:"campaigns-ghost small",type:"button",onClick:()=>L(c.id),children:"Ver mensajes"}),s.jsx("button",{className:"campaigns-danger small",type:"button",onClick:()=>R(c.id),disabled:c.status==="sending",children:"Enviar"})]})]},c.id)}),!i.length&&s.jsx("div",{className:"empty-state",children:"Sin Campaas registradas"})]}),l&&s.jsxs("div",{className:"campaigns-messages",children:[s.jsx("div",{className:"campaigns-history-title",children:"Mensajes"}),s.jsxs("div",{className:"history-table history-table--messages",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"WA"}),s.jsx("span",{children:"Status"}),s.jsx("span",{children:"Enviado"})]}),o.map(c=>s.jsxs("div",{className:"history-row",children:[s.jsx("span",{children:c.wa_id}),s.jsx("span",{children:c.status}),s.jsx("span",{children:S(c.sent_at)})]},c.id))]})]})]})]})})]}),K&&s.jsx("div",{className:"modal-overlay",onClick:()=>ue(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:c=>c.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Previsualizar plantilla"}),s.jsx("button",{className:"modal-close",onClick:()=>ue(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:z}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(pe==null?void 0:pe.body_preview)||(pe==null?void 0:pe.body_text)||"Sin previsualizacin disponible."}),rs.length>0&&s.jsx("div",{className:"preview-actions",children:rs.map((c,b)=>s.jsx("button",{type:"button",children:c.text||c.label||c.title||`Botn ${b+1}`},`preview-modal-btn-${b}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})})]})}function ma({variant:e="error",title:t,message:n,actionLabel:r,onAction:a,dismissLabel:i="Cerrar",onDismiss:l}){const o=e==="offline"?"x":"!";return s.jsxs("div",{className:`notice-banner notice-banner-${e}`,children:[s.jsx("div",{className:"notice-icon","aria-hidden":"true",children:o}),s.jsxs("div",{className:"notice-content",children:[t?s.jsx("div",{className:"notice-title",children:t}):null,s.jsx("div",{className:"notice-text",children:n})]}),s.jsxs("div",{className:"notice-actions",children:[r&&s.jsx("button",{className:"notice-action",type:"button",onClick:a,children:r}),l&&s.jsx("button",{className:"notice-close",type:"button",onClick:l,children:i})]})]})}const oy={admin:{title:"Administrador",subtitle:"Acceso total",tone:"alert"},recepcion:{title:"Operador",subtitle:"Atencion al cliente",tone:"info"},caja:{title:"Supervisor",subtitle:"Auditoria y gestion",tone:"dark"},marketing:{title:"Marketing",subtitle:"Crecimiento y campanas",tone:"info"},doctor:{title:"Doctor",subtitle:"Atencion al cliente",tone:"dark"}},qd=[{id:"chat",label:"Chat"},{id:"dashboard",label:"Dashboard"},{id:"campaigns",label:"Campanas"}],Qd=[{id:"general",label:"General"},{id:"users",label:"Gestion de Usuarios"},{id:"bot",label:"Configuracion de Bot"},{id:"templates",label:"Plantillas de Meta"},{id:"audit",label:"Registros / Auditoria"},{id:"odoo",label:"Integracion Odoo"}];function Gd(e){return oy[e]||{title:e,subtitle:"Acceso personalizado",tone:"info"}}function cy({settingsTab:e,setSettingsTab:t,rolePermissions:n,setRolePermissions:r,isAdmin:a,adminUsers:i,userForm:l,setUserForm:o,roleOptions:u,handleUserSubmit:m,handleUserDelete:w,defaultRolePermissions:v,handleRoleDelete:x}){const[C,L]=f.useState(""),[R,g]=f.useState(!1),[h,p]=f.useState(""),[y,S]=f.useState(null),[D,z]=f.useState(!1),[I,_]=f.useState("create"),[P,M]=f.useState("recepcion"),[K,ue]=f.useState({modules:{},settings:{}}),pe=f.useMemo(()=>{const A=C.trim().toLowerCase(),H=i||[];return A?H.filter(k=>{var le,he;const U=((le=k.name)==null?void 0:le.toLowerCase())||"",q=((he=k.email)==null?void 0:he.toLowerCase())||"";return U.includes(A)||q.includes(A)}):H},[i,C]);function We(A){const H=(n==null?void 0:n[A])||(v==null?void 0:v[A])||{modules:{},settings:{}};return{modules:{...H.modules||{}},settings:{...H.settings||{}}}}function Se(A,H="edit"){_(H),M(A),ue(We(A)),z(!0)}function Ae(A,H,k){ue(U=>{const q={...U},le={...q[A]||{}},he={...le[H]||{}},ce=!he[k];return he[k]=ce,k==="write"&&ce&&(he.read=!0),k==="read"&&!ce&&(he.write=!1),le[H]=he,q[A]=le,q})}function tt(){P&&(r(A=>({...A,[P]:K})),z(!1))}function V(){P&&x&&x(P),z(!1)}function Q(A,H,k,U){a&&r(q=>{var ye,ve;const le={...q},he={modules:{...(ye=le[A])==null?void 0:ye.modules},settings:{...(ve=le[A])==null?void 0:ve.settings}},ce={...he[H]},Qe={...ce[k]},Be=!Qe[U];return Qe[U]=Be,U==="write"&&Be&&(Qe.read=!0),U==="read"&&!Be&&(Qe.write=!1),ce[k]=Qe,he[H]=ce,le[A]=he,le})}function ne(A){return Gd(A).title.toUpperCase()}function re(A,H){return A!=null&&A.id?`OP-${A.id.slice(-4).toUpperCase()}`:`OP-${String(H+1).padStart(4,"0")}`}function de(A){o({id:A.id,name:A.name,email:A.email,role:A.role,password:"",is_active:A.is_active}),g(!0)}function be(){o({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),g(!0)}return s.jsxs("div",{className:"users-page",children:[s.jsxs("header",{className:"users-header",children:[s.jsxs("div",{className:"users-title-row",children:[s.jsx("span",{className:"users-kicker"}),s.jsxs("div",{children:[s.jsx("div",{className:"users-title",children:"Gestion de Usuarios"}),s.jsx("div",{className:"users-subtitle",children:"Administra los accesos y roles de los operadores de tu empresa."})]})]}),s.jsxs("div",{className:"users-actions",children:[e==="list"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"users-search",children:[s.jsx("span",{className:"users-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar usuario...",value:C,onChange:A=>L(A.target.value)})]}),s.jsx("button",{className:"settings-primary",type:"button",onClick:be,children:"Nuevo Usuario"})]}),e==="roles"&&s.jsx("button",{className:"settings-primary",type:"button",onClick:()=>Se("recepcion","create"),children:"+ Nuevo Rol"})]})]}),s.jsxs("div",{className:"users-tabs",children:[s.jsx("button",{className:`users-tab ${e==="list"?"active":""}`,type:"button",onClick:()=>t("list"),children:"Lista de Usuarios"}),s.jsx("button",{className:`users-tab ${e==="roles"?"active":""}`,type:"button",onClick:()=>t("roles"),children:"Roles y Permisos"})]}),e==="list"&&s.jsxs("div",{className:"users-table",children:[s.jsxs("div",{className:"users-table-head",children:[s.jsx("span",{children:"Nombre / Usuario"}),s.jsx("span",{children:"Email"}),s.jsx("span",{children:"Rol"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),pe.map((A,H)=>{var k;return s.jsxs("div",{className:"users-row",children:[s.jsxs("div",{className:"users-cell user-name",children:[s.jsx("div",{className:"user-avatar",children:((k=A.name)==null?void 0:k[0])||"?"}),s.jsxs("div",{children:[s.jsx("div",{className:"user-title",children:A.name}),s.jsx("div",{className:"user-id",children:re(A,H)})]})]}),s.jsx("div",{className:"users-cell",children:A.email}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`role-pill ${A.role}`,children:ne(A.role)})}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`status-pill ${A.is_active?"active":"inactive"}`,children:A.is_active?"Activo":"Inactivo"})}),s.jsx("div",{className:"users-cell",children:s.jsxs("div",{className:"users-actions-menu",children:[s.jsx("button",{className:"users-action",type:"button",onClick:()=>p(U=>U===A.id?"":A.id),children:"..."}),h===A.id&&s.jsxs("div",{className:"users-menu",children:[s.jsx("button",{type:"button",onClick:()=>{p(""),de(A)},children:"Editar"}),s.jsx("button",{type:"button",onClick:()=>{p(""),S(A)},children:"Eliminar"})]})]})})]},A.id)}),!pe.length&&s.jsx("div",{className:"empty-state",children:"Sin usuarios para mostrar"})]}),e==="roles"&&s.jsx("div",{className:"roles-grid",children:u.map(A=>{const H=Gd(A),k=n==null?void 0:n[A];return s.jsxs("div",{className:"role-card",children:[s.jsxs("div",{className:"role-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"role-title",children:H.title}),s.jsx("div",{className:`role-subtitle ${H.tone}`,children:H.subtitle})]}),s.jsx("button",{className:"role-edit",type:"button",onClick:()=>Se(A,"edit"),children:"edit"})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),qd.map(U=>{var q,le,he,ce;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((le=(q=k==null?void 0:k.modules)==null?void 0:q[U.id])==null?void 0:le.read)||!1,disabled:!a,onChange:()=>Q(A,"modules",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ce=(he=k==null?void 0:k.modules)==null?void 0:he[U.id])==null?void 0:ce.write)||!1,disabled:!a,onChange:()=>Q(A,"modules",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsx("div",{className:"role-settings-title",children:"Configuracion"}),Qd.map(U=>{var q,le,he,ce;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((le=(q=k==null?void 0:k.settings)==null?void 0:q[U.id])==null?void 0:le.read)||!1,disabled:!a,onChange:()=>Q(A,"settings",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ce=(he=k==null?void 0:k.settings)==null?void 0:he[U.id])==null?void 0:ce.write)||!1,disabled:!a,onChange:()=>Q(A,"settings",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]})]},A)})}),R&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:l.id?"Editar usuario":"Crear usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>g(!1),children:"x"})]}),s.jsxs("form",{className:"form-grid",onSubmit:async A=>{await m(A),g(!1)},children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:A=>o(H=>({...H,name:A.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:l.email,onChange:A=>o(H=>({...H,email:A.target.value})),disabled:!!l.id})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),s.jsx("select",{value:l.role,onChange:A=>o(H=>({...H,role:A.target.value})),children:u.map(A=>s.jsx("option",{value:A,children:A},A))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:l.password,onChange:A=>o(H=>({...H,password:A.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:A=>o(H=>({...H,is_active:A.target.checked}))}),"Activo"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"primary",type:"submit",children:l.id?"Guardar cambios":"Crear"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>g(!1),children:"Cancelar"})]})]})]})}),y&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Eliminar usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>S(null),children:"x"})]}),s.jsxs("p",{className:"modal-text",children:["Vas a desactivar a ",s.jsx("strong",{children:y.email}),". Continuar?"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"danger",type:"button",onClick:()=>{w==null||w(y.id),S(null)},children:"Eliminar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>S(null),children:"Cancelar"})]})]})}),D&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card modal-lg",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:I==="create"?"Nuevo rol":"Editar rol"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>z(!1),children:"x"})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),I==="edit"?s.jsx("select",{value:P,disabled:!0,children:u.map(A=>s.jsx("option",{value:A,children:A},A))}):s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"text",list:"role-options",placeholder:"nuevo-rol",value:P,onChange:A=>M(A.target.value)}),s.jsx("datalist",{id:"role-options",children:u.map(A=>s.jsx("option",{value:A},A))})]})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Modulos"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),qd.map(A=>{var H,k,U,q;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:A.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((k=(H=K==null?void 0:K.modules)==null?void 0:H[A.id])==null?void 0:k.read)||!1,onChange:()=>Ae("modules",A.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((q=(U=K==null?void 0:K.modules)==null?void 0:U[A.id])==null?void 0:q.write)||!1,onChange:()=>Ae("modules",A.id,"write")}),s.jsx("span",{})]})]},A.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Configuracion"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),Qd.map(A=>{var H,k,U,q;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:A.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((k=(H=K==null?void 0:K.settings)==null?void 0:H[A.id])==null?void 0:k.read)||!1,onChange:()=>Ae("settings",A.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((q=(U=K==null?void 0:K.settings)==null?void 0:U[A.id])==null?void 0:q.write)||!1,onChange:()=>Ae("settings",A.id,"write")}),s.jsx("span",{})]})]},A.id)})]})]}),s.jsxs("div",{className:"form-actions",children:[I==="edit"&&s.jsx("button",{className:"danger",type:"button",onClick:V,children:"Eliminar rol"}),s.jsx("button",{className:"primary",type:"button",onClick:tt,disabled:!P,children:"Guardar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>z(!1),children:"Cancelar"})]})]})})]})}function uy({branches:e,branchForm:t,setBranchForm:n,handleBranchSubmit:r,handleBranchDisable:a,services:i,serviceForm:l,setServiceForm:o,handleServiceSubmit:u,handleServiceDisable:m,handleServiceBranchToggle:w,tenantChannels:v,channelForm:x,setChannelForm:C,handleChannelSelect:L,handleChannelSubmit:R}){return s.jsxs("div",{className:"page-grid",children:[s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Sucursales"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Nombre"}),s.jsx("span",{children:"Codigo"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Accion"})]}),e.map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.name}),s.jsx("span",{children:g.code}),s.jsx("span",{children:g.is_active?"Activa":"Inactiva"}),s.jsxs("div",{className:"row-actions",children:[s.jsx("button",{className:"ghost",onClick:()=>n({id:g.id,code:g.code,name:g.name,address:g.address,lat:g.lat,lng:g.lng,hours_text:g.hours_text,phone:g.phone||"",is_active:g.is_active}),children:"Editar"}),s.jsx("button",{className:"danger",onClick:()=>a(g.id),children:"Desactivar"})]})]},g.id))]}),s.jsx("div",{className:"panel-title",children:t.id?"Editar sucursal":"Crear sucursal"}),s.jsxs("form",{className:"form-grid",onSubmit:r,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Codigo"}),s.jsx("input",{type:"text",value:t.code,onChange:g=>n(h=>({...h,code:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:t.name,onChange:g=>n(h=>({...h,name:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Direccion"}),s.jsx("input",{type:"text",value:t.address,onChange:g=>n(h=>({...h,address:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Lat"}),s.jsx("input",{type:"number",value:t.lat,onChange:g=>n(h=>({...h,lat:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Lng"}),s.jsx("input",{type:"number",value:t.lng,onChange:g=>n(h=>({...h,lng:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Telefono"}),s.jsx("input",{type:"text",value:t.phone,onChange:g=>n(h=>({...h,phone:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Horarios"}),s.jsx("textarea",{rows:"3",value:t.hours_text,onChange:g=>n(h=>({...h,hours_text:g.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:t.is_active,onChange:g=>n(h=>({...h,is_active:g.target.checked}))}),"Activa"]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Guardar"})})]})]}),s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Servicios"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Servicio"}),s.jsx("span",{children:"Precio"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Accion"})]}),i.map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.name}),s.jsxs("span",{children:["Bs ",g.price_bob]}),s.jsx("span",{children:g.is_active?"Activo":"Inactivo"}),s.jsxs("div",{className:"row-actions",children:[s.jsx("button",{className:"ghost",onClick:()=>o({id:g.id,code:g.code,name:g.name,subtitle:g.subtitle||"",description:g.description,price_bob:g.price_bob,duration_min:g.duration_min||"",image_url:g.image_url||"",is_featured:g.is_featured,is_active:g.is_active}),children:"Editar"}),s.jsx("button",{className:"danger",onClick:()=>m(g.id),children:"Desactivar"})]})]},g.id))]}),s.jsx("div",{className:"panel-title",children:l.id?"Editar servicio":"Crear servicio"}),s.jsxs("form",{className:"form-grid",onSubmit:u,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Codigo"}),s.jsx("input",{type:"text",value:l.code,onChange:g=>o(h=>({...h,code:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:g=>o(h=>({...h,name:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Subtitulo"}),s.jsx("input",{type:"text",value:l.subtitle,onChange:g=>o(h=>({...h,subtitle:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Descripcion"}),s.jsx("textarea",{rows:"3",value:l.description,onChange:g=>o(h=>({...h,description:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Precio (Bs)"}),s.jsx("input",{type:"number",value:l.price_bob,onChange:g=>o(h=>({...h,price_bob:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Duracion (min)"}),s.jsx("input",{type:"number",value:l.duration_min,onChange:g=>o(h=>({...h,duration_min:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Imagen URL"}),s.jsx("input",{type:"text",value:l.image_url,onChange:g=>o(h=>({...h,image_url:g.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_featured,onChange:g=>o(h=>({...h,is_featured:g.target.checked}))}),"Destacado"]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:g=>o(h=>({...h,is_active:g.target.checked}))}),"Activo"]}),l.id&&s.jsxs("div",{className:"field",children:[s.jsx("span",{children:"Disponibilidad por sucursal"}),s.jsx("div",{className:"chip-grid",children:e.map(g=>{var y,S;const h=(S=(y=i.find(D=>D.id===l.id))==null?void 0:y.branches)==null?void 0:S.find(D=>{var I;return(((I=D.branch)==null?void 0:I.id)||D.branch_id)===g.id}),p=(h==null?void 0:h.is_available)||!1;return s.jsxs("label",{className:"chip",children:[s.jsx("input",{type:"checkbox",checked:p,onChange:D=>w(i.find(z=>z.id===l.id),g.id,D.target.checked)}),g.name]},g.id)})})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Guardar"})})]})]}),s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Lineas de WhatsApp"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Nombre"}),s.jsx("span",{children:"Phone ID"}),s.jsx("span",{children:"Accion"})]}),(v||[]).map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.display_name||"Linea sin nombre"}),s.jsx("span",{children:g.phone_number_id}),s.jsx("button",{className:"ghost",onClick:()=>L(g),children:"Renombrar"})]},g.id)),!(v!=null&&v.length)&&s.jsx("div",{className:"empty-state",children:"Sin lineas registradas"})]}),s.jsx("div",{className:"panel-title",children:x.id?"Editar linea":"Selecciona una linea"}),s.jsxs("form",{className:"form-grid",onSubmit:R,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre visible"}),s.jsx("input",{type:"text",value:x.display_name,onChange:g=>C(h=>({...h,display_name:g.target.value})),disabled:!x.id})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",disabled:!x.id,children:"Guardar"})})]})]})]})}function dy(){var L,R,g,h,p,y,S,D,z,I;const[e,t]=f.useState([]),[n,r]=f.useState(null),[a,i]=f.useState(!0),[l,o]=f.useState("");f.useEffect(()=>{u()},[]);async function u(){i(!0);try{const[_,P]=await Promise.all([me("/api/admin/bots"),me("/api/admin/bots/metrics")]);t(_.bots||[]),r(P.metrics),o("")}catch(_){console.error(_),o(_.message||"Error al cargar datos")}finally{i(!1)}}async function m(_,P){try{await Ke(`/api/admin/bots/${_}`,{is_active:P}),t(M=>M.map(K=>K.id===_?{...K,is_active:P}:K))}catch(M){o(M.message||"Error al cambiar estado")}}const w=_=>{if(!_)return"Sin actividad reciente";const P=new Date(_),K=new Date-P,ue=Math.floor(K/6e4);if(ue<1)return"Hace un momento";if(ue<60)return`ltima actividad: hace ${ue} min`;const pe=Math.floor(ue/60);return pe<24?`ltima actividad: hace ${pe}h`:`ltima actividad: ${P.toLocaleDateString()}`},v=e.filter(_=>_.is_active).length,x=v>0?"ACTIVO":"INACTIVO",C=v>0?"active":"inactive";return s.jsxs("div",{className:"bot-section",children:[s.jsxs("div",{className:"bot-section-header",children:[s.jsxs("div",{className:"bot-section-title-area",children:[s.jsx("div",{className:"bot-section-icon",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"bot-section-title",children:"Gestin de Bots"}),s.jsx("p",{className:"bot-section-subtitle",children:"Administra los flujos automatizados y el rendimiento tcnico."})]})]}),s.jsxs("div",{className:"bot-section-global-toggle",children:[s.jsx("span",{className:"bot-toggle-label",children:"ESTADO DEL BOT:"}),s.jsxs("div",{className:`bot-toggle-pill ${C}`,children:[s.jsx("span",{className:"bot-toggle-dot"}),s.jsx("span",{children:x})]})]})]}),l&&s.jsx("div",{className:"bot-error",children:l}),s.jsxs("div",{className:"bot-section-content",children:[s.jsxs("div",{className:"bot-flows-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MONITOREO DE FLUJOS"})}),a?s.jsx("div",{className:"bot-loading",children:"Cargando bots..."}):e.length===0?s.jsxs("div",{className:"bot-empty",children:[s.jsx("p",{children:"No hay bots asignados a tu cuenta."}),s.jsx("p",{className:"bot-empty-hint",children:"Contacta con soporte si necesitas activar un bot."})]}):s.jsx("div",{className:"bot-flows-list",children:e.map(_=>s.jsxs("div",{className:"bot-flow-card",children:[s.jsxs("div",{className:"bot-flow-info",children:[s.jsx("span",{className:"bot-flow-icon",children:_.flow_icon||""}),s.jsxs("div",{children:[s.jsx("div",{className:"bot-flow-name",children:_.flow_name}),s.jsxs("div",{className:`bot-flow-status ${_.is_active?"active":"inactive"}`,children:[" ",_.is_active?"ACTIVO":"INACTIVO"]})]})]}),s.jsx("div",{className:"bot-flow-actions",children:s.jsxs("label",{className:"bot-toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:_.is_active,onChange:()=>m(_.id,!_.is_active)}),s.jsx("span",{className:"bot-toggle-slider"})]})}),s.jsx("div",{className:"bot-flow-meta",children:w(_.updated_at)}),_.flow_description&&s.jsx("div",{className:"bot-flow-desc",children:_.flow_description})]},_.id))})]}),s.jsxs("div",{className:"bot-metrics-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MTRICAS DE EFICACIA DETALLADAS"})}),s.jsxs("div",{className:"bot-metrics-grid",children:[s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:`bot-metric-badge ${((L=n==null?void 0:n.interactions)==null?void 0:L.change)>=0?"positive":"neutral"}`,children:[((R=n==null?void 0:n.interactions)==null?void 0:R.change)>0?"+":"",(g=n==null?void 0:n.interactions)==null?void 0:g.change,"% ",(h=n==null?void 0:n.interactions)==null?void 0:h.label]}),s.jsx("div",{className:"bot-metric-label",children:"INTERACCIONES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.interactions.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"Total de sesiones iniciadas hoy"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge neutral",children:["Objetivo: ",(p=n==null?void 0:n.resolution)==null?void 0:p.target,"%"]}),s.jsx("div",{className:"bot-metric-label",children:"RESOLUCIN FINAL"}),s.jsxs("div",{className:"bot-metric-value",children:[n?n.resolution.value:"--","%"]}),s.jsx("div",{className:"bot-metric-progress",children:s.jsx("div",{className:"bot-metric-progress-fill",style:{width:`${n?n.resolution.value:0}%`}})})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge sla",children:[" ",(y=n==null?void 0:n.uptime)==null?void 0:y.status]}),s.jsx("div",{className:"bot-metric-label",children:"VIDA DEL PROCESO"}),s.jsx("div",{className:"bot-metric-value",children:n?n.uptime.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"UPTIME SISTEMA"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:`bot-metric-icon ${((S=n==null?void 0:n.errors)==null?void 0:S.value)>0?"error":""}`,children:""}),s.jsx("div",{className:`bot-metric-badge ${((D=n==null?void 0:n.errors)==null?void 0:D.value)===0?"stable":"neutral"}`,children:(z=n==null?void 0:n.errors)==null?void 0:z.status}),s.jsx("div",{className:"bot-metric-label",children:"ERRORES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.errors.value:"--"}),s.jsxs("div",{className:`bot-metric-sub ${((I=n==null?void 0:n.errors)==null?void 0:I.critical)>0?"error-sub":""}`,children:["CRTICOS: ",n?n.errors.critical:0]})]})]})]})]})]})}const Yd={DRAFT:{bg:"#e3e8ef",text:"#475569",label:"BORRADOR"},PENDING:{bg:"#fef3c7",text:"#d97706",label:"PENDIENTE"},APPROVED:{bg:"#d1fae5",text:"#059669",label:"APROBADA"},REJECTED:{bg:"#fee2e2",text:"#dc2626",label:"RECHAZADA"},PAUSED:{bg:"#fef3c7",text:"#d97706",label:"PAUSADA"},DISABLED:{bg:"#e5e7eb",text:"#6b7280",label:"DESHABILITADA"}},hy=[{value:"UTILITY",label:"Utility"},{value:"MARKETING",label:"Marketing"},{value:"AUTHENTICATION",label:"Authentication"}],fy=[{value:"es",label:"Espaol (ES)"},{value:"en",label:"English (EN)"}];function py({templates:e=[],templateForm:t,setTemplateForm:n,handleTemplateSubmit:r,handleTemplateSubmitToMeta:a,handleTemplateDelete:i,handleSyncTemplates:l,onLoadTemplates:o,brandName:u=""}){var H;const m=(u||"PODOPIE").trim(),[w,v]=f.useState("list"),[x,C]=f.useState(null),[L,R]=f.useState(""),[g,h]=f.useState(!1),[p,y]=f.useState(""),[S,D]=f.useState(!1),[z,I]=f.useState(!1),[_,P]=f.useState(null),[M,K]=f.useState({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),[ue,pe]=f.useState([]);f.useEffect(()=>{o&&o()},[]);const We=async()=>{h(!0);try{await l()}finally{h(!1)}},Se=()=>{C(null),K({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),pe([]),v("editor")},Ae=k=>{C(k),K({name:k.name||"",category:k.category||"UTILITY",language:k.language||"es",body_text:k.body_text||k.body_preview||"",header_type:k.header_type||"",header_content:k.header_content||"",footer_text:k.footer_text||"",buttons:k.buttons_json||[]}),pe(k.variable_mappings||[]),v("editor")},tt=async k=>{!(k!=null&&k.id)||!i||!window.confirm(`Eliminar la plantilla "${k.name}"? Esta accin la ocultar localmente y la eliminar de Meta si aplica.`)||await i(k.id)},V=async k=>{k.preventDefault();const U={...M,id:x==null?void 0:x.id,variable_mappings:ue};if(n&&n(U),r){const q=await r(null,U);q&&C(q)}},Q=async()=>{if(a){D(!0);try{let k=x==null?void 0:x.id;if(!k){const U={...M,variable_mappings:ue},q=await r(null,U);k=q==null?void 0:q.id,q&&C(q)}k&&(await a(k),v("list"),C(null))}finally{D(!1)}}},ne=()=>{v("list"),C(null)},re=k=>{const U=(k==null?void 0:k.buttons_json)??(k==null?void 0:k.buttons)??[];if(Array.isArray(U))return U;if(typeof U=="string")try{const q=JSON.parse(U);return Array.isArray(q)?q:[]}catch{return[]}return[]},be=(k=>{const U=k.match(/\{\{(\d+)\}\}/g)||[];return[...new Set(U)].map(q=>parseInt(q.replace(/[{}]/g,"")))})(M.body_text),A=e.filter(k=>{var le;const U=!L||((le=k.name)==null?void 0:le.toLowerCase().includes(L.toLowerCase()))||(k.body_text||k.body_preview||"").toLowerCase().includes(L.toLowerCase()),q=!p||k.status===p;return U&&q});return w==="list"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"templates-section",children:[s.jsxs("div",{className:"templates-header",children:[s.jsxs("div",{className:"templates-title-row",children:[s.jsx("h1",{children:"Plantillas de Meta"}),s.jsxs("span",{className:"meta-connected-badge",children:[s.jsx("span",{className:"status-dot"}),"CONECTADO A META API"]})]}),s.jsxs("div",{className:"templates-actions",children:[s.jsx("div",{className:"search-input-wrap",children:s.jsx("input",{type:"text",placeholder:"Buscar plantillas...",value:L,onChange:k=>R(k.target.value)})}),s.jsxs("select",{value:p,onChange:k=>y(k.target.value),className:"status-filter-select",children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"APPROVED",children:"Aprobadas"}),s.jsx("option",{value:"PENDING",children:"Pendientes"}),s.jsx("option",{value:"REJECTED",children:"Rechazadas"}),s.jsx("option",{value:"DRAFT",children:"Borradores"})]}),s.jsx("button",{className:"btn-sync",onClick:We,disabled:g,children:g?" Sincronizando...":" Sincronizar"}),s.jsxs("button",{className:"btn-create-template",onClick:Se,children:[s.jsx("span",{children:"+"})," Crear Nueva Plantilla"]})]})]}),s.jsxs("div",{className:"templates-grid",children:[A.map(k=>{var q;const U=Yd[k.status]||Yd.DRAFT;return s.jsxs("div",{className:"template-card",onClick:()=>Ae(k),children:[s.jsxs("div",{className:"template-card-head",children:[s.jsx("div",{className:"template-category-icon",children:k.category==="MARKETING"?"":k.category==="UTILITY"?"":""}),s.jsx("span",{className:"template-status-badge",style:{backgroundColor:U.bg,color:U.text},children:U.label})]}),s.jsx("h3",{className:"template-card-name",children:k.name}),s.jsxs("div",{className:"template-card-meta",children:[s.jsx("span",{className:"tag-category",children:k.category}),s.jsx("span",{className:"tag-language",children:k.language==="es"?"ESPAOL (ES)":(q=k.language)==null?void 0:q.toUpperCase()})]}),(k.body_text||k.body_preview)&&s.jsxs("p",{className:"template-card-preview",children:[(k.body_text||k.body_preview).slice(0,80),"..."]}),s.jsxs("div",{className:"template-card-actions",children:[s.jsx("button",{className:"btn-preview",onClick:le=>{le.stopPropagation(),P(k),I(!0)},children:"Vista previa"}),s.jsx("button",{className:"btn-preview danger",onClick:le=>{le.stopPropagation(),tt(k)},children:"Eliminar"})]})]},k.id)}),s.jsxs("div",{className:"template-card template-card-create",onClick:Se,children:[s.jsx("div",{className:"create-icon",children:"+"}),s.jsx("h3",{children:"Crear nueva plantilla"}),s.jsx("p",{children:"Empieza a disear tu flujo de WhatsApp"})]})]}),A.length===0&&!L&&s.jsx("div",{className:"templates-empty",children:s.jsx("p",{children:"No hay plantillas. Crea una nueva o sincroniza desde Meta."})})]}),z&&s.jsx("div",{className:"modal-overlay",onClick:()=>I(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:k=>k.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Vista previa"}),s.jsx("button",{className:"modal-close",onClick:()=>I(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:m}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(_==null?void 0:_.body_preview)||(_==null?void 0:_.body_text)||"Sin previsualizacin disponible."}),re(_).length>0&&s.jsx("div",{className:"preview-actions",children:re(_).map((k,U)=>s.jsx("button",{type:"button",children:k.text||k.label||k.title||`Botn ${U+1}`},`prev-${U}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})})]}):s.jsxs("div",{className:"template-editor",children:[s.jsxs("div",{className:"editor-header",children:[s.jsxs("div",{className:"editor-breadcrumb",children:[s.jsx("button",{className:"btn-back",onClick:ne,children:" Volver"}),s.jsx("span",{className:"breadcrumb-sep",children:"/"}),s.jsx("span",{children:x?"Editar Plantilla":"Nueva Plantilla"})]}),s.jsxs("div",{className:"editor-actions",children:[s.jsx("button",{className:"btn-save-draft",onClick:V,children:" Guardar Borrador"}),((x==null?void 0:x.status)==="DRAFT"||(x==null?void 0:x.status)==="REJECTED"||!x)&&s.jsx("button",{className:"btn-primary",onClick:Q,disabled:S||!M.name||!M.body_text,children:S?"Enviando...":"Enviar a Meta"}),s.jsx("button",{className:"btn-discard",onClick:ne,children:" Descartar"})]})]}),s.jsxs("div",{className:"editor-layout",children:[s.jsxs("div",{className:"editor-form-panel",children:[s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" General Settings"}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Template Name"}),s.jsx("input",{type:"text",placeholder:"patient_appointment_reminder",value:M.name,onChange:k=>K({...M,name:k.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")})})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Category"}),s.jsx("select",{value:M.category,onChange:k=>K({...M,category:k.target.value}),children:hy.map(k=>s.jsx("option",{value:k.value,children:k.label},k.value))})]}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Language"}),s.jsx("select",{value:M.language,onChange:k=>K({...M,language:k.target.value}),children:fy.map(k=>s.jsx("option",{value:k.value,children:k.label},k.value))})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("div",{className:"form-section-header",children:[s.jsx("h3",{children:" Message Body"}),s.jsx("button",{className:"btn-insert-var",type:"button",onClick:()=>{const k=be.length+1;K({...M,body_text:M.body_text+`{{${k}}}`})},children:"+ Insert Variable"})]}),s.jsx("textarea",{rows:"6",placeholder:`Hola {{1}}, te recordamos tu cita en ${m} para el da {{2}} a las {{3}}. Por favor, confirma tu asistencia.`,value:M.body_text,onChange:k=>K({...M,body_text:k.target.value})}),s.jsxs("div",{className:"char-count",children:[M.body_text.length," / 1024"]})]})]}),s.jsxs("div",{className:"editor-preview-panel",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:m}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:M.body_text||"Tu mensaje aparecer aqu..."}),M.buttons&&M.buttons.length>0&&s.jsx("div",{className:"preview-actions",children:M.buttons.map((k,U)=>s.jsx("button",{type:"button",children:k.text||k.title||`Botn ${U+1}`},`btn-${U}`))}),s.jsx("div",{className:"preview-time",children:"10:42 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:M.name||"Sin nombre"})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Idioma"}),s.jsx("strong",{children:((H=M.language)==null?void 0:H.toUpperCase())||"ES"})]})]})]}),s.jsxs("div",{className:"editor-mapping-panel",children:[s.jsxs("div",{className:"mapping-tabs",children:[s.jsx("button",{className:"tab active",children:"VARIABLES"}),s.jsx("button",{className:"tab",children:"BUTTONS"})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsx("h4",{children:"ODOO FIELD MAPPING"}),be.length===0?s.jsxs("p",{className:"mapping-empty",children:["Agrega variables ","{{1}}",", ","{{2}}","... en tu mensaje"]}):be.map(k=>{const U=ue.find(q=>q.var_index===k)||{};return s.jsxs("div",{className:"mapping-item",children:[s.jsxs("div",{className:"mapping-var-badge",children:[`{{${k}}}`," Variable"]}),s.jsxs("select",{value:U.source_path||"",onChange:q=>{const le=ue.filter(he=>he.var_index!==k);le.push({var_index:k,source_type:"odoo",source_path:q.target.value}),pe(le)},children:[s.jsx("option",{value:"",children:"Select Odoo Field..."}),s.jsx("option",{value:"partner_id.name",children:"patient_id.name"}),s.jsx("option",{value:"start_date",children:"start_date (Formatted)"}),s.jsx("option",{value:"start_time",children:"start_time"}),s.jsx("option",{value:"partner_id.phone",children:"patient_phone"})]}),s.jsx("span",{className:`mapping-status ${U.source_path?"linked":"needs"}`,children:U.source_path?" Linked":" Needs mapping"})]},k)})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsxs("div",{className:"mapping-section-header",children:[s.jsx("h4",{children:"ACTION BUTTONS"}),s.jsx("button",{className:"btn-add-button",onClick:()=>{K({...M,buttons:[...M.buttons||[],{type:"QUICK_REPLY",text:""}]})},children:"+ Add Button"})]}),(M.buttons||[]).map((k,U)=>s.jsxs("div",{className:"button-item",children:[s.jsx("span",{className:"button-icon",children:""}),s.jsx("input",{type:"text",placeholder:"Button text",value:k.text||"",onChange:q=>{const le=[...M.buttons];le[U]={...le[U],text:q.target.value},K({...M,buttons:le})}}),s.jsx("button",{className:"btn-remove",onClick:()=>{const q=M.buttons.filter((le,he)=>he!==U);K({...M,buttons:q})},children:""})]},U))]}),s.jsxs("div",{className:"mapping-tip",children:[s.jsx("span",{className:"tip-icon",children:""}),s.jsx("span",{children:"Tip: Asegrate de que tus variables estn correctamente mapeadas a campos de Odoo antes de enviar."})]})]})]})]})}const Kd={campaigns:"",users:"",bot:"",chat:"",templates:"",audience:"",system:""},my={"user.created":"USUARIO CREADO","user.updated":"USUARIO EDITADO","user.disabled":"USUARIO ELIMINADO",template_draft_created:"PLANTILLA CREADA",template_draft_updated:"PLANTILLA EDITADA",template_submitted:"PLANTILLA ENVIADA",template_deleted:"PLANTILLA ELIMINADA",template_restored:"PLANTILLA RESTAURADA",audience_created:"SEGMENTO CREADO",audience_updated:"SEGMENTO EDITADO",audience_deleted:"SEGMENTO ELIMINADO","campaign.created":"CAMPAA CREADA","campaign.queued":"CAMPAA EN COLA","campaign.sending":"CAMPAA LANZADA","settings.updated":"CONFIG ACTUALIZADA","role_permissions.updated":"PERMISOS CAMBIADOS","role_permissions.deleted":"ROL ELIMINADO","conversation.status_changed":"CHAT ACTUALIZADO","conversation.tag_added":"TAG AGREGADO","conversation.tag_removed":"TAG ELIMINADO"};function Mp(e){var r;const t=((r=e==null?void 0:e.data_json)==null?void 0:r.entity)||"";if(t==="template")return"templates";if(t==="audience")return"audience";if(t==="campaign")return"campaigns";if(t==="conversation")return"chat";const n=(e==null?void 0:e.action)||"";return n.includes("user")?"users":n.includes("campaign")?"campaigns":n.includes("template")?"templates":n.includes("audience")?"audience":n.includes("bot")?"bot":n.includes("conversation")?"chat":"system"}function xo(e){if(!e)return{date:"--",time:"--"};const t=new Date(e);return Number.isNaN(t.getTime())?{date:"--",time:"--"}:{date:t.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}),time:t.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}}function gy(e,t="csv"){const r=[["timestamp","usuario","email","accion","modulo","data"].join(",")];e.forEach(m=>{var L,R;const w=((L=m.user)==null?void 0:L.name)||"Sistema",v=((R=m.user)==null?void 0:R.email)||"",x=Mp(m),C=[new Date(m.created_at).toISOString(),w,v,m.action,x,JSON.stringify(m.data_json||{})];r.push(C.map(g=>`"${String(g).replace(/"/g,'""')}"`).join(","))});const a=r.join(`
`),i=t==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv;charset=utf-8;",l=t==="excel"?"audit_logs.xlsx":"audit_logs.csv",o=new Blob([a],{type:i}),u=document.createElement("a");u.href=URL.createObjectURL(o),u.download=l,document.body.appendChild(u),u.click(),document.body.removeChild(u)}function vy(){var z,I;const[e,t]=f.useState(""),[n,r]=f.useState(""),[a,i]=f.useState(""),[l,o]=f.useState(1),[u]=f.useState(6),[m,w]=f.useState(0),[v,x]=f.useState([]),[C,L]=f.useState(!1),[R,g]=f.useState(null),h=Math.max(1,Math.ceil(m/u)),p=async({pageOverride:_}={})=>{L(!0);try{const P=new URLSearchParams;P.set("page",String(_||l)),P.set("page_size",String(u)),e.trim()&&P.set("q",e.trim()),n&&P.set("from",n),a&&P.set("to",a);const M=await me(`/api/admin/audit?${P.toString()}`);x(M.logs||[]),w(M.total||0)}finally{L(!1)}};f.useEffect(()=>{p()},[l]);const y=()=>{o(1),p({pageOverride:1})},S=async(_="csv")=>{const P=new URLSearchParams;P.set("page","1"),P.set("page_size","1000"),e.trim()&&P.set("q",e.trim()),n&&P.set("from",n),a&&P.set("to",a);const M=await me(`/api/admin/audit?${P.toString()}`);gy(M.logs||[],_)},D=f.useMemo(()=>{const _=[],P=Math.max(1,l-1),M=Math.min(h,P+2);for(let K=P;K<=M;K+=1)_.push(K);return _},[l,h]);return s.jsxs("div",{className:"audit-module",children:[s.jsxs("div",{className:"audit-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-title",children:"Registros / Auditoria"}),s.jsx("div",{className:"audit-subtitle",children:"Monitorea acciones de usuarios y eventos del sistema"})]}),s.jsxs("div",{className:"audit-export-group",children:[s.jsx("button",{className:"audit-export",type:"button",onClick:()=>S("excel"),children:" Exportar Excel"}),s.jsx("button",{className:"audit-export outline",type:"button",onClick:()=>S("csv"),children:" Exportar CSV"})]})]}),s.jsxs("div",{className:"audit-filters",children:[s.jsxs("div",{className:"audit-search",children:[s.jsx("span",{className:"audit-search-icon"}),s.jsx("input",{type:"text",placeholder:"Filtrar por usuario o accion..",value:e,onChange:_=>t(_.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Desde"}),s.jsx("input",{type:"date",value:n,onChange:_=>r(_.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Hasta"}),s.jsx("input",{type:"date",value:a,onChange:_=>i(_.target.value)})]}),s.jsx("button",{className:"audit-filter-btn",type:"button",onClick:y,children:"Filtrar"})]}),s.jsxs("div",{className:"audit-card",children:[s.jsxs("div",{className:"audit-table-head",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("span",{children:"Usuario"}),s.jsx("span",{children:"Accion"}),s.jsx("span",{children:"Modulo"})]}),C&&s.jsx("div",{className:"audit-empty",children:"Cargando registros..."}),!C&&!v.length&&s.jsx("div",{className:"audit-empty",children:"Sin registros para mostrar"}),!C&&v.map(_=>{var We,Se;const P=xo(_.created_at),M=Mp(_),K=my[_.action]||_.action,ue=((We=_.user)==null?void 0:We.name)||"System Bot",pe=((Se=_.user)==null?void 0:Se.email)||"automated@service";return s.jsxs("button",{type:"button",className:"audit-row",onClick:()=>g(_),children:[s.jsxs("div",{className:"audit-cell time",children:[s.jsx("div",{children:P.date}),s.jsx("div",{className:"audit-time",children:P.time})]}),s.jsxs("div",{className:"audit-cell user",children:[s.jsx("div",{className:"audit-avatar",children:(ue==null?void 0:ue[0])||"S"}),s.jsxs("div",{children:[s.jsx("div",{className:"audit-user-name",children:ue}),s.jsx("div",{className:"audit-user-email",children:pe})]})]}),s.jsx("div",{className:"audit-cell action",children:s.jsx("span",{className:"audit-action-pill",children:K})}),s.jsxs("div",{className:"audit-cell module",children:[s.jsx("span",{className:"audit-module-icon",children:Kd[M]||Kd.system}),M.charAt(0).toUpperCase()+M.slice(1)]})]},_.id)})]}),s.jsxs("div",{className:"audit-footer",children:[s.jsxs("div",{children:["Mostrando ",v.length," de ",m," registros"]}),s.jsxs("div",{className:"audit-pagination",children:[s.jsx("button",{type:"button",disabled:l<=1,onClick:()=>o(_=>Math.max(1,_-1)),children:""}),D.map(_=>s.jsx("button",{type:"button",className:_===l?"active":"",onClick:()=>o(_),children:_},_)),s.jsx("button",{type:"button",disabled:l>=h,onClick:()=>o(_=>Math.min(h,_+1)),children:""})]})]}),R&&s.jsx("div",{className:"audit-modal",children:s.jsxs("div",{className:"audit-modal-card",children:[s.jsxs("div",{className:"audit-modal-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-modal-title",children:"Detalle del registro"}),s.jsx("div",{className:"audit-modal-subtitle",children:R.action})]}),s.jsx("button",{type:"button",onClick:()=>g(null),children:""})]}),s.jsxs("div",{className:"audit-modal-body",children:[s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Usuario"}),s.jsx("strong",{children:((z=R.user)==null?void 0:z.name)||"System Bot"}),s.jsx("small",{children:((I=R.user)==null?void 0:I.email)||"automated@service"})]}),s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("strong",{children:xo(R.created_at).date}),s.jsx("small",{children:xo(R.created_at).time})]}),s.jsxs("div",{className:"audit-detail full",children:[s.jsx("span",{children:"Data"}),s.jsx("pre",{children:JSON.stringify(R.data_json||{},null,2)})]})]})]})})]})}function xy(){return s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Integracion Odoo"}),s.jsx("div",{className:"empty-state",children:"Seccion en construccion"})]})}function yy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("line",{x1:"4",y1:"6",x2:"20",y2:"6",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"6",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"18",x2:"20",y2:"18",strokeWidth:"2"}),s.jsx("circle",{cx:"11",cy:"18",r:"2",strokeWidth:"2"})]})}function jy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"9",cy:"8",r:"3",strokeWidth:"2"}),s.jsx("path",{d:"M4 20c0-3 2.7-5.5 6-5.5s6 2.5 6 5.5",strokeWidth:"2"}),s.jsx("circle",{cx:"17",cy:"9",r:"2",strokeWidth:"2"}),s.jsx("path",{d:"M14 20c0-1.8 1.4-3.4 3.2-4",strokeWidth:"2"})]})}function Ny(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"2"})]})}function wy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"4",width:"12",height:"16",rx:"2",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"9",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"13",x2:"15",y2:"13",strokeWidth:"2"})]})}function _y(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"5",width:"12",height:"15",rx:"2",strokeWidth:"2"}),s.jsx("path",{d:"M9 5h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 10h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 14h6",strokeWidth:"2"})]})}function Sy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M8 4h4a2 2 0 1 1 0 4h-1v2h2a2 2 0 1 1 0 4h-2v2H8a2 2 0 1 1-4 0V8a2 2 0 1 1 4 0z",strokeWidth:"2"})})}function ky({settingsSection:e,setSettingsSection:t,settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,currentRole:l,isAdmin:o,adminUsers:u,userForm:m,setUserForm:w,roleOptions:v,handleUserSubmit:x,settings:C,setSettings:L,handleSaveSettings:R,branches:g,services:h,branchForm:p,setBranchForm:y,handleBranchSubmit:S,handleBranchDisable:D,serviceForm:z,setServiceForm:I,handleServiceSubmit:_,handleServiceDisable:P,handleServiceBranchToggle:M,templates:K,templateForm:ue,setTemplateForm:pe,handleTemplateSubmit:We,handleTemplateSubmitToMeta:Se,handleTemplateDelete:Ae,handleSyncTemplates:tt,auditLogs:V,formatDate:Q,planName:ne,tenantChannels:re,channelForm:de,setChannelForm:be,handleChannelSelect:A,handleChannelSubmit:H,handleUserDelete:k,defaultRolePermissions:U,handleRoleDelete:q,useShellLayout:le=!1,pageError:he,isOffline:ce=!1,onDismissError:Qe,brandName:Be=""}){const ye=a==null?void 0:a[l],ve=[{title:"Principal",items:[{id:"general",label:"General",icon:yy},{id:"users",label:"Gestion de Usuarios",icon:jy},{id:"bot",label:"Configuracion de Bot",icon:Ny}]},{title:"Canales e Integraciones",items:[{id:"templates",label:"Plantillas de Meta",icon:wy},{id:"audit",label:"Registros / Auditoria",icon:_y},{id:"odoo",label:"Integracion Odoo",icon:Sy}]}];function Te(Ye){var He,at;return!!((at=(He=ye==null?void 0:ye.settings)==null?void 0:He[Ye])!=null&&at.read)}function Ft(Ye){Te(Ye)&&t(Ye)}const Me=s.jsxs(s.Fragment,{children:[s.jsxs("aside",{className:"settings-sidebar",children:[s.jsxs("div",{className:"settings-header",children:[s.jsx("div",{className:"settings-title",children:"CONFIGURACION"}),s.jsxs("div",{className:"settings-version",children:[(Be||"Empresa").toUpperCase()," OS V2.0"]})]}),ve.map(Ye=>s.jsxs("div",{className:"settings-group",children:[s.jsx("div",{className:"settings-group-title",children:Ye.title}),s.jsx("div",{className:"settings-group-list",children:Ye.items.map(He=>{const at=!Te(He.id),xt=He.icon;return s.jsxs("button",{className:`settings-item ${e===He.id?"active":""}`,type:"button",onClick:()=>Ft(He.id),disabled:at,children:[s.jsx("span",{className:"settings-icon","aria-hidden":"true",children:s.jsx(xt,{className:"settings-icon-svg"})}),He.label]},He.id)})})]},Ye.title)),s.jsxs("div",{className:"settings-plan",children:[s.jsx("div",{className:"settings-plan-label",children:"Plan actual"}),s.jsx("div",{className:"settings-plan-name",children:ne||"Sin plan"})]})]}),s.jsxs("div",{className:"settings-content",children:[e==="users"&&s.jsx(cy,{settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,isAdmin:o,adminUsers:u,userForm:m,setUserForm:w,roleOptions:v,handleUserSubmit:x,handleUserDelete:k,defaultRolePermissions:U,handleRoleDelete:q}),e==="general"&&s.jsx(uy,{branches:g,branchForm:p,setBranchForm:y,handleBranchSubmit:S,handleBranchDisable:D,services:h,serviceForm:z,setServiceForm:I,handleServiceSubmit:_,handleServiceDisable:P,handleServiceBranchToggle:M,tenantChannels:re,channelForm:de,setChannelForm:be,handleChannelSelect:A,handleChannelSubmit:H}),e==="bot"&&s.jsx(dy,{settings:C,setSettings:L,handleSaveSettings:R}),e==="templates"&&s.jsx(py,{templates:K,templateForm:ue,setTemplateForm:pe,handleTemplateSubmit:We,handleTemplateSubmitToMeta:Se,handleTemplateDelete:Ae,handleSyncTemplates:tt,brandName:Be}),e==="audit"&&s.jsx(vy,{auditLogs:V,formatDate:Q}),e==="odoo"&&s.jsx(xy,{}),ce?s.jsx(ma,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):he?s.jsx(ma,{variant:"error",title:"Ocurri un problema",message:he,dismissLabel:"Cerrar",onDismiss:Qe}):null]})]});return le?Me:s.jsx("section",{className:"settings-layout",children:Me})}function by(){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"1.8"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"1.8"})]})}function Cy({tenantId:e,tenantBots:t,availableFlows:n,loading:r,onAddBot:a,onRemoveBot:i}){const[l,o]=f.useState(""),u=new Set(t.map(v=>v.flow_id)),m=n.filter(v=>!u.has(v.id));function w(){l&&(a(l),o(""))}return s.jsxs("section",{className:"sa-bot-card","data-tenant":e||"",children:[s.jsxs("header",{className:"sa-bot-header",children:[s.jsx("div",{className:"sa-bot-icon-large","aria-hidden":"true",children:s.jsx(by,{})}),s.jsxs("div",{className:"sa-bot-title-group",children:[s.jsx("h3",{children:"Asignacion de Bots"}),s.jsx("p",{children:"Selecciona que flujos estaran disponibles para este cliente. Los flujos asignados apareceran inmediatamente en el panel del usuario."})]})]}),s.jsx("div",{className:"sa-bot-body",children:r?s.jsx("div",{className:"sa-bot-loading",children:"Cargando asignaciones..."}):t.length===0?s.jsxs("div",{className:"sa-bot-empty",children:[s.jsx("div",{className:"sa-bot-empty-icon",children:"+"}),s.jsx("div",{className:"sa-bot-empty-title",children:"Sin bots asignados"}),s.jsx("div",{className:"sa-bot-empty-sub",children:"Agrega un flujo desde el selector para activarlo en este tenant."})]}):s.jsx("div",{className:"sa-bot-grid",children:t.map(v=>s.jsxs("div",{className:"sa-assigned-bot",children:[s.jsx("div",{className:"sa-bot-item-icon",children:v.flow_icon||">"}),s.jsxs("div",{className:"sa-bot-item-info",children:[s.jsx("span",{className:"sa-bot-item-name",children:v.flow_name||v.flow_id}),s.jsx("span",{className:"sa-bot-item-desc",children:v.flow_description||"Sin descripcion"})]}),s.jsx("button",{type:"button",className:"sa-btn-remove",title:"Quitar bot del cliente",onClick:()=>i(v.id),children:"Quitar"})]},v.id))})}),s.jsxs("div",{className:"sa-bot-controls",children:[s.jsxs("div",{className:"sa-select-container",children:[s.jsx("label",{className:"sa-select-label",children:"Asignar bot"}),s.jsxs("select",{className:"sa-select-styled",value:l,onChange:v=>o(v.target.value),disabled:m.length===0,children:[s.jsx("option",{value:"",children:m.length===0?"No hay mas bots disponibles":"Selecciona un bot para asignar"}),m.map(v=>s.jsx("option",{value:v.id,children:v.name},v.id))]})]}),s.jsx("button",{type:"button",className:"sa-btn-assign",onClick:w,disabled:!l,children:"Asignar Bot"})]})]})}const Yt={name:"",slug:"",plan:"",db_url:"",phone_number_id:"",line_name:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",brand_name:"",logo_url:"",brand_primary:"#22d3ee",brand_accent:"#38bdf8",brand_bg:"#0b0f16",timezone:"",odoo_base_url:"",odoo_db_name:"",odoo_username:"",odoo_password:""},Ey=[{value:"starter",label:"Starter"},{value:"growth",label:"Growth"},{value:"scale",label:"Scale"},{value:"enterprise",label:"Enterprise"}];function Ay(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"4",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"4",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"})]})}function wc(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ty(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"3.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M19 12a7 7 0 0 0-.1-1.2l2-1.5-2-3.5-2.4.7a7.2 7.2 0 0 0-2-1.2L12 2 9.5 4.3a7.2 7.2 0 0 0-2 1.2l-2.4-.7-2 3.5 2 1.5A7 7 0 0 0 5 12c0 .4 0 .8.1 1.2l-2 1.5 2 3.5 2.4-.7a7.2 7.2 0 0 0 2 1.2L12 22l2.5-2.3a7.2 7.2 0 0 0 2-1.2l2.4.7 2-3.5-2-1.5c.1-.4.1-.8.1-1.2Z",strokeWidth:"1.2",strokeLinejoin:"round"})]})}function Ly(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M16.5 16.5 20 20",strokeWidth:"1.6",strokeLinecap:"round"})]})}function Ry(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 12h12",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m13 6 6 6-6 6",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Oy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M18 6 6 18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m6 6 12 12",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Py(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56",strokeWidth:"1.8",strokeLinecap:"round"})})}function Xd(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Jd(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m2 2 20 20",strokeWidth:"1.8",strokeLinecap:"round"})]})}function My(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 18h.01",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Dy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m15 5 4 4",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Iy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M3 6h18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",strokeWidth:"1.8",strokeLinecap:"round"})]})}const Zd={display_name:"",phone_number_id:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",is_active:!0,is_default:!1};function By({isOpen:e,onClose:t,initialData:n,onSave:r,tenantId:a}){const[i,l]=f.useState(Zd),[o,u]=f.useState(!1),[m,w]=f.useState(!1),[v,x]=f.useState(!1),[C,L]=f.useState(null);if(f.useEffect(()=>{e&&(l(n||{...Zd}),L(null))},[e,n]),!e)return null;const R=async g=>{if(g.preventDefault(),x(!0),L(null),!i.phone_number_id||!i.verify_token||!n&&!i.wa_token){L("Los campos ID de Telfono, Verify Token y Access Token son obligatorios."),x(!1);return}try{await r({...i,tenant_id:a}),t()}catch(h){console.error("Error saving channel:",h),L(h.message||"Error al guardar la lnea.")}finally{x(!1)}};return s.jsx("div",{className:"sa-modal-overlay",onClick:t,children:s.jsxs("div",{className:"sa-modal-content",onClick:g=>g.stopPropagation(),children:[s.jsxs("div",{className:"sa-modal-header",children:[s.jsx("div",{className:"sa-modal-title",children:n?"Editar Lnea WhatsApp":"Nueva Lnea WhatsApp"}),s.jsx("button",{className:"sa-modal-close",onClick:t,children:s.jsx(Oy,{width:24,height:24})})]}),s.jsxs("div",{className:"sa-modal-body",children:[C&&s.jsx("div",{className:"sa-alert",style:{marginBottom:"1rem"},children:C}),s.jsxs("div",{className:"sa-form-grid",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre para mostrar (Opcional)"}),s.jsx("input",{value:i.display_name||"",onChange:g=>l({...i,display_name:g.target.value}),placeholder:"Ej: Ventas Principal"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Phone Number ID *"}),s.jsx("input",{value:i.phone_number_id||"",onChange:g=>l({...i,phone_number_id:g.target.value}),placeholder:"Identificador del nmero de telfono"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"WABA ID (WhatsApp Business Account ID)"}),s.jsx("input",{value:i.waba_id||"",onChange:g=>l({...i,waba_id:g.target.value}),placeholder:"Identificador de la cuenta de WhatsApp Business"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Verify Token (Webhook) *"}),s.jsx("input",{value:i.verify_token||"",onChange:g=>l({...i,verify_token:g.target.value}),placeholder:"Token de verificacin webhook"})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"Permanent Access Token *"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:o?"text":"password",value:i.wa_token||"",onChange:g=>l({...i,wa_token:g.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"Token de acceso permanente",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>u(!o),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:o?s.jsx(Jd,{width:18,height:18}):s.jsx(Xd,{width:18,height:18})})]})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"App Secret (Opcional)"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:m?"text":"password",value:i.app_secret||"",onChange:g=>l({...i,app_secret:g.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"App Secret de Meta",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>w(!m),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:m?s.jsx(Jd,{width:18,height:18}):s.jsx(Xd,{width:18,height:18})})]})]})]}),s.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"2rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_active,onChange:g=>l({...i,is_active:g.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Activa"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_default,onChange:g=>l({...i,is_default:g.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Principal (Por Defecto)"]})]})]}),s.jsxs("div",{className:"sa-modal-footer",children:[s.jsx("button",{className:"sa-btn ghost",onClick:t,disabled:v,children:"Cancelar"}),s.jsx("button",{className:"sa-btn primary",onClick:R,disabled:v,children:v?s.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(Py,{width:16,height:16,className:"animate-spin"})," Guardando..."]}):"Guardar Lnea"})]})]})})}function zy({channels:e=[],tenantId:t,onRefresh:n}){const[r,a]=f.useState(!1),[i,l]=f.useState(null),o=()=>{l(null),a(!0)},u=v=>{l(v),a(!0)},m=async v=>{i?await Ke(`/api/superadmin/channels/${i.id}`,v):await Ne("/api/superadmin/channels",v),await n()},w=async v=>{if(confirm("Ests seguro de que deseas eliminar esta lnea? Esta accin no se puede deshacer."))try{await Un(`/api/superadmin/channels/${v}`),await n()}catch(x){console.error("Error deleting channel:",x),alert("No se pudo eliminar la lnea.")}};return s.jsxs("section",{className:"sa-lines-card",children:[s.jsxs("header",{className:"sa-lines-header",children:[s.jsxs("div",{className:"sa-lines-title",children:[s.jsx("div",{className:"sa-lines-icon",children:s.jsx(My,{width:24,height:24})}),s.jsxs("div",{children:[s.jsx("h3",{children:"Lneas de WhatsApp Cloud"}),s.jsx("p",{children:"Gestiona las conexiones activas de WhatsApp para este tenant."})]})]}),s.jsxs("button",{className:"sa-btn primary",onClick:o,children:[s.jsx(wc,{width:16,height:16,style:{marginRight:"0.5rem"}}),"Agregar Nueva Lnea"]})]}),s.jsx("div",{className:"sa-lines-body",children:s.jsxs("div",{className:"sa-lines-grid",children:[e.map(v=>s.jsxs("div",{className:`sa-line-card ${v.is_active?"":"opacity-75"}`,children:[s.jsxs("div",{className:"sa-line-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-line-name",children:v.display_name||"Sin nombre"}),s.jsxs("div",{className:"sa-line-meta",children:["ID: ",v.phone_number_id]})]}),s.jsx("div",{className:`sa-line-status ${v.is_active?"active":""}`,title:v.is_active?"Activo":"Inactivo"})]}),s.jsxs("div",{className:"sa-line-badges",children:[v.is_default&&s.jsx("span",{className:"sa-line-badge default",children:"DEFAULT"}),!v.is_active&&s.jsx("span",{className:"sa-status warn",children:"INACTIVO"})]}),s.jsxs("div",{className:"sa-line-details",children:[s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"WABA ID"}),s.jsx("span",{className:"sa-detail-value",children:v.waba_id||"-"})]}),s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"Verify Token"}),s.jsx("span",{className:"sa-detail-value",children:v.verify_token?`${v.verify_token.substring(0,16)}...`:"-"})]})]}),s.jsxs("div",{className:"sa-line-actions",children:[s.jsx("button",{className:"sa-btn ghost",onClick:()=>u(v),title:"Editar",children:s.jsx(Dy,{width:16,height:16})}),s.jsx("button",{className:"sa-btn ghost",onClick:()=>w(v.id),title:"Eliminar",style:{color:"#f87171"},children:s.jsx(Iy,{width:16,height:16})})]})]},v.id)),s.jsxs("button",{type:"button",className:"sa-line-add-card",onClick:o,children:[s.jsx("div",{className:"sa-add-icon-circle",children:s.jsx(wc,{width:24,height:24})}),s.jsx("span",{children:"Nueva Conexin"})]})]})}),s.jsx(By,{isOpen:r,onClose:()=>a(!1),initialData:i,onSave:m,tenantId:t})]})}function eh({route:e="/superadmin",onNavigate:t,onImpersonateTenant:n,onLogout:r=()=>{}}){const[a,i]=f.useState([]),[l,o]=f.useState([]),[u,m]=f.useState([]),[w,v]=f.useState(""),[x,C]=f.useState(""),[L,R]=f.useState("Verificacion de red: sistema ok"),[g,h]=f.useState(Yt),[p,y]=f.useState(!1),[S,D]=f.useState(!1),[z,I]=f.useState(""),[_,P]=f.useState(""),[M,K]=f.useState(!0),[ue,pe]=f.useState(Yt),[We,Se]=f.useState(!0),[Ae,tt]=f.useState(!1),V=f.useRef(""),[Q,ne]=f.useState([]),[re,de]=f.useState([]),[be,A]=f.useState(!1),{pushToast:H}=wu(),k=f.useMemo(()=>{if(!e)return"";const j=e.match(/^\/superadmin\/tenants\/([^/]+)\/?$/)||e.match(/^\/superadmin\/tenant\/([^/]+)\/?$/)||e.match(/^\/superadmin\/edit\/([^/]+)\/?$/);return j?j[1]:""},[e]),U=e.startsWith("/superadmin/new"),q=!!k,le=U||q,he=f.useCallback(j=>{if(t){t(j,{replace:!1});return}typeof window>"u"||window.history.pushState({},"",j)},[t]);async function ce(){try{const j=await me("/api/superadmin/tenants");i(j.tenants||[]);const $=await me("/api/superadmin/channels");o($.channels||[]),C("")}catch(j){C(j.message||"No se pudo cargar datos.")}}f.useEffect(()=>{ce(),Wt()},[]),f.useMemo(()=>{const j=new Map;return l.forEach($=>{const G=j.get($.tenant_id)||0;j.set($.tenant_id,G+1)}),j},[l]);const Qe=f.useMemo(()=>{const j=w.trim().toLowerCase();return j?a.filter($=>{const G=String($.name||"").toLowerCase(),se=String($.slug||"").toLowerCase(),_e=String($.id||"").toLowerCase();return G.includes(j)||se.includes(j)||_e.includes(j)}):a.slice()},[a,w]),Be=a.length,ye=a.filter(j=>j.is_active).length;a.filter(j=>j.has_database).length;const ve=a.filter(j=>j.has_odoo).length,Te=Be?Math.round(ve/Be*100):0;function Ft(j){if(!j)return"--";const $=new Date(j);return Number.isNaN($.getTime())?"--":$.toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"2-digit"})}function Me(j){return 10+Math.abs(Array.from(j).reduce((se,_e)=>se+_e.charCodeAt(0),0))%70}function Ye(){h(Yt),pe(Yt),P(""),K(!0),Se(!0),de([]),m([]),R("Verificacion de red: sistema ok"),V.current=""}function He(){Ye(),C(""),he("/superadmin/new")}function at(){V.current="",he("/superadmin")}async function xt(j){if(n)try{C(""),I(j),await n(j)}catch($){C($.message||"No se pudo entrar al tenant.")}finally{I("")}}function gn(j){const $={};return Object.keys(Yt).forEach(G=>{const se=j[G];$[G]=typeof se=="string"?se.trim():se||""}),{...Yt,...$}}async function sn(j){if(j){V.current=j,P(j),h(Yt),pe(Yt),K(!0),Se(!0),de([]),m([]),tt(!0),C("");try{const $=await me(`/api/superadmin/tenants/${j}/details`);if(V.current!==j)return;const G=$.tenant||{},se=$.branding||null,_e=$.odoo||null,Pt=$.database||null,yt=$.channel||null;m($.channels||[]);const jt=(se==null?void 0:se.colors)||{},Ln=gn({...Yt,name:G.name||"",slug:G.slug||"",plan:G.plan||"",db_url:(Pt==null?void 0:Pt.db_url)||"",brand_name:(se==null?void 0:se.brand_name)||"",logo_url:(se==null?void 0:se.logo_url)||"",brand_primary:(jt==null?void 0:jt.primary)||Yt.brand_primary,brand_accent:(jt==null?void 0:jt.accent)||Yt.brand_accent,brand_bg:(jt==null?void 0:jt.bg)||Yt.brand_bg,odoo_base_url:(_e==null?void 0:_e.base_url)||"",odoo_db_name:(_e==null?void 0:_e.db_name)||"",odoo_username:(_e==null?void 0:_e.username)||"",odoo_password:(_e==null?void 0:_e.password)||""});h(Ln),pe(Ln),P(G.id||j),K(!!G.is_active),Se(!!G.is_active),R("Modo edicion: cambios pendientes"),await rn(j)}catch($){C($.message||"No se pudo cargar tenant.")}finally{tt(!1)}}}async function Xn(j){if(j)try{const $=await me(`/api/superadmin/tenants/${j}/details`);if(_&&_!==j)return;m($.channels||[])}catch($){console.error("Error loading tenant channels",$)}}async function Wt(){try{const j=await me("/api/superadmin/flows");ne(j.flows||[])}catch(j){console.error("Error loading flows",j)}}async function rn(j){if(j){A(!0);try{const $=await me(`/api/superadmin/tenant-bots?tenant_id=${j}`);de($.tenant_bots||[])}catch($){console.error("Error loading tenant bots",$)}finally{A(!1)}}}async function Ht(j,$){try{await Ke(`/api/superadmin/tenant-bots/${j}`,{is_active:$}),de(G=>G.map(se=>se.id===j?{...se,is_active:$}:se))}catch(G){C(G.message||"Error al cambiar estado del bot.")}}async function W(j){if(_)try{const $=await Ne("/api/superadmin/tenant-bots",{tenant_id:_,flow_id:j});$.tenant_bot&&(de(G=>[$.tenant_bot,...G]),H({message:"Bot agregado correctamente"}))}catch($){C($.message||"Error al agregar bot."),H({type:"error",message:$.message||"Error al agregar bot"})}}async function we(j){const $=re.find(G=>G.id===j);try{await Un(`/api/superadmin/tenant-bots/${j}`),de(G=>G.filter(se=>se.id!==j)),H({message:"Bot eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{if(!$)return;const G=await Ne("/api/superadmin/tenant-bots",{tenant_id:$.tenant_id,flow_id:$.flow_id});G!=null&&G.tenant_bot&&$.is_active===!1&&await Ke(`/api/superadmin/tenant-bots/${G.tenant_bot.id}`,{is_active:!1}),await rn(_),H({message:"Bot restaurado"})}catch(G){H({type:"error",message:(G==null?void 0:G.message)||"No se pudo restaurar el bot"})}}})}catch(G){C(G.message||"Error al eliminar bot."),H({type:"error",message:G.message||"Error al eliminar bot"})}}async function Ee(j){C(""),he(`/superadmin/tenants/${j.id}`)}async function T(){await ce(),_&&await Xn(_)}function je(){const j=g.name.trim(),$=g.slug.trim(),G=g.db_url.trim();return!j||!$?{ok:!1,message:"Nombre y subdominio son requeridos."}:!_&&!G?{ok:!1,message:"Tenant DB URL es requerido."}:(g.brand_name.trim()||g.logo_url.trim()||g.brand_primary||g.brand_accent||g.brand_bg)&&!g.brand_name.trim()?{ok:!1,message:"Brand name es requerido."}:(g.odoo_base_url||g.odoo_db_name||g.odoo_username||g.odoo_password)&&(!g.odoo_base_url||!g.odoo_db_name||!g.odoo_username||!_&&!g.odoo_password)?{ok:!1,message:"Odoo incompleto: base_url, db_name, username, password."}:{ok:!0}}function En(j){if(!j)return"Verificacion completada";const $=[];if(j.database){const G=j.database.ok?"DB ok":"DB error",se=typeof j.database.latency_ms=="number"?` (${j.database.latency_ms}ms)`:"";$.push(`${G}${se}`)}if(j.odoo){const G=j.odoo.ok?"Odoo ok":"Odoo error",se=typeof j.odoo.latency_ms=="number"?` (${j.odoo.latency_ms}ms)`:"";$.push(`${G}${se}`)}return $.length?`Verificacion completada: ${$.join(" | ")}`:"Verificacion completada"}function vn(j){if(j!=null&&j.database&&!j.database.ok){const $=j.database.details||j.database.error;return An($||"Error en DB")}if(j!=null&&j.odoo&&!j.odoo.ok){const $=j.odoo.details||j.odoo.error;return An($||"Error en Odoo")}return"No se pudo validar conexion"}function An(j){const $=(j||"").toString(),G=$.toLowerCase();return G.includes("missing")?"Completa los campos de Odoo":G.includes("db_connection_failed")?"No se pudo conectar a la base de datos":G.includes("odoo")&&G.includes("failed")?"No se pudo autenticar en Odoo":$||"No se pudo validar conexion"}async function it(){const j=je();if(!j.ok){R(j.message);return}y(!0),R("Verificando conexion...");try{const $=await Ne("/api/superadmin/tenants/validate",{db_url:g.db_url.trim(),odoo_base_url:g.odoo_base_url.trim(),odoo_db_name:g.odoo_db_name.trim(),odoo_username:g.odoo_username.trim(),odoo_password:g.odoo_password.trim()}),G=En($.checks);R(G),$.ok?H({message:G}):H({type:"error",message:vn($.checks)})}catch($){R("Error validando conexion"),H({type:"error",message:$.message||"No se pudo validar conexion"})}finally{y(!1)}}async function Tn(j){var G;if(j.preventDefault(),q&&!qt)return;const $=je();if(!$.ok){C($.message);return}try{D(!0),C("");let se=_;if(se?await Ke(`/api/superadmin/tenants/${se}`,{name:g.name.trim(),slug:g.slug.trim(),plan:g.plan.trim(),is_active:M}):se=(G=(await Ne("/api/superadmin/tenants",{name:g.name.trim(),slug:g.slug.trim(),plan:g.plan.trim()})).tenant)==null?void 0:G.id,!se)throw new Error("tenant_not_ready");if(g.db_url.trim()&&await Ne(`/api/superadmin/tenants/${se}/database`,{db_url:g.db_url.trim()}),(g.brand_name.trim()||g.logo_url.trim())&&await Ke("/api/superadmin/branding",{tenant_id:se,brand_name:g.brand_name.trim(),logo_url:g.logo_url.trim()||null,colors:null}),g.odoo_base_url||g.odoo_db_name||g.odoo_username||g.odoo_password){const yt={tenant_id:se,base_url:g.odoo_base_url.trim(),db_name:g.odoo_db_name.trim(),username:g.odoo_username.trim()};g.odoo_password.trim()&&(yt.password=g.odoo_password.trim()),await Ke("/api/superadmin/odoo",yt)}if(await ce(),_){const yt=gn(g);h(yt),pe(yt),Se(M),R("Cambios guardados"),H({message:"Tenant actualizado correctamente"})}else Ye(),H({message:"Tenant creado correctamente"})}catch(se){C(se.message||"No se pudo guardar tenant."),H({type:"error",message:se.message||"No se pudo guardar tenant"})}finally{D(!1)}}async function xn(){if(!_)return;const j=!M;try{D(!0),C(""),await Ke(`/api/superadmin/tenants/${_}`,{is_active:j}),K(j),Se(j),R(j?"Tenant reactivado":"Tenant bloqueado"),await ce()}catch($){C($.message||"No se pudo cambiar estado del tenant.")}finally{D(!1)}}const qt=f.useMemo(()=>!_&&!q||M!==We?!0:Object.keys(ue).some(j=>{const $=String(g[j]??""),G=String(ue[j]??"");return $!==G}),[We,ue,M,_,q,g]);return f.useEffect(()=>{if(q&&k&&k!==_){sn(k);return}U&&(_||Ae)&&Ye()},[Ae,_,U,q,k]),s.jsxs("div",{className:"sa-shell",children:[s.jsxs("aside",{className:"sa-rail",children:[s.jsx("div",{className:"sa-rail-logo",children:"PRZV"}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${le?"":"active"}`,onClick:at,children:[s.jsx(Ay,{className:"sa-rail-icon"}),s.jsx("span",{children:"Dashboard"})]}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${U?"active":""}`,onClick:He,children:[s.jsx(wc,{className:"sa-rail-icon"}),s.jsx("span",{children:"Nuevo"})]}),s.jsxs("button",{type:"button",className:"sa-rail-btn",children:[s.jsx(Ty,{className:"sa-rail-icon"}),s.jsx("span",{children:"Ajustes"})]}),s.jsxs("div",{className:"sa-rail-footer",children:[s.jsx("div",{className:"sa-avatar",children:"SA"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-role",children:"Superadmin"}),s.jsx("div",{className:"sa-meta",children:"Control plane"})]})]})]}),s.jsxs("main",{className:"sa-main",children:[!le&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-topbar",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-kicker",children:"Panel de control Perzivalh"}),s.jsxs("div",{className:"sa-title",children:["Sistema operativo ",s.jsx("span",{className:"sa-dot"})]}),s.jsx("div",{className:"sa-subtitle",children:"Estado general del entorno"})]}),s.jsxs("div",{className:"sa-top-actions",children:[s.jsx("span",{className:"sa-version",children:"v0.4 stable"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:ce,children:"Recargar"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"}),s.jsx("button",{className:"sa-btn primary",type:"button",onClick:He,children:"Nuevo tenant"})]})]}),s.jsxs("section",{className:"sa-kpi-grid",children:[s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Total de empresas (tenants)"}),s.jsx("div",{className:"sa-kpi-value",children:Be}),s.jsxs("div",{className:"sa-kpi-meta",children:["+",ye," activas"]})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Usuarios activos totales"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"En tiempo real"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Mensajes hoy"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"Canal API"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Conexiones Odoo activas"}),s.jsxs("div",{className:"sa-kpi-value",children:[Te,"%"]}),s.jsxs("div",{className:"sa-kpi-meta",children:[ve," sincronizadas"]})]})]}),s.jsxs("section",{className:"sa-table-card",children:[s.jsxs("div",{className:"sa-table-header",children:[s.jsxs("div",{className:"sa-search",children:[s.jsx(Ly,{className:"sa-search-icon"}),s.jsx("input",{value:w,onChange:j=>v(j.target.value),placeholder:"Filtrar empresas..."})]}),s.jsxs("div",{className:"sa-table-actions",children:[s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Ordenar por salud"}),s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Exportar CSV"})]})]}),s.jsxs("div",{className:"sa-table",children:[s.jsxs("div",{className:"sa-table-head",children:[s.jsx("div",{children:"ID referencia"}),s.jsx("div",{children:"Nombre de la empresa"}),s.jsx("div",{children:"Estado"}),s.jsx("div",{children:"Uso de recursos"}),s.jsx("div",{children:"Tiempo de actividad"}),s.jsx("div",{children:"Acciones"})]}),Qe.length?Qe.map(j=>{var _e;const $=Me(j.id||"tenant"),G=j.has_database?"db":"no-db",se=j.has_database;return s.jsxs("div",{className:"sa-table-row",children:[s.jsx("div",{className:"sa-ref",children:((_e=j.slug)==null?void 0:_e.toUpperCase())||"TENANT"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-tenant-name",children:j.name}),s.jsx("div",{className:"sa-tenant-meta",children:j.id.slice(0,8)})]}),s.jsx("div",{className:`sa-status ${j.is_active?"ok":"warn"}`,children:j.is_active?"activo":"inactivo"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-progress",children:s.jsx("span",{className:`sa-progress-fill ${G}`,style:{width:`${$}%`}})}),s.jsxs("div",{className:"sa-tenant-meta",children:[$,"% carga"]})]}),s.jsx("div",{className:"sa-tenant-meta",children:Ft(j.created_at)}),s.jsx("div",{children:s.jsxs("div",{className:"sa-action-group",children:[s.jsx("button",{className:"sa-action",type:"button",onClick:()=>xt(j.id),disabled:!se||z===j.id,children:se?z===j.id?"Entrando...":"Entrar":"Sin DB"}),s.jsx("button",{className:"sa-link",type:"button",onClick:()=>Ee(j),children:s.jsx(Ry,{className:"sa-link-icon"})})]})})]},j.id)}):s.jsx("div",{className:"sa-empty",children:"Sin tenants para mostrar."})]}),s.jsxs("div",{className:"sa-footer-note",children:["Mostrando ",Qe.length||0," empresas en produccion"]})]})]}),le&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-create-header",children:[s.jsx("button",{className:"sa-back",type:"button",onClick:at,children:"Volver al dashboard"}),s.jsx("div",{className:"sa-create-title",children:q?"Editar tenant":"Registrar nuevo tenant"}),s.jsxs("div",{className:"sa-create-actions",children:[s.jsx("div",{className:"sa-create-meta",children:"Modo: superadmin"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"})]})]}),x?s.jsx("div",{className:"sa-alert",children:x}):null,s.jsxs("form",{className:"sa-form",onSubmit:Tn,children:[s.jsxs("div",{className:"sa-form-grid sa-form-grid-2",children:[s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Identidad del tenant"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre de la empresa"}),s.jsx("input",{value:g.name,onChange:j=>h({...g,name:j.target.value}),placeholder:"Ej. Empresa Alfa"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Subdominio reservado"}),s.jsx("input",{value:g.slug,onChange:j=>h({...g,slug:j.target.value}),placeholder:"alfa-salud"})]}),s.jsxs("div",{className:"sa-field sa-field-row",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Plan"}),s.jsxs("select",{value:g.plan,onChange:j=>h({...g,plan:j.target.value}),children:[s.jsx("option",{value:"",children:"Seleccionar"}),Ey.map(j=>s.jsx("option",{value:j.value,children:j.label},j.value))]})]}),q&&s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Estado del tenant"}),s.jsxs("select",{value:M?"active":"inactive",onChange:j=>K(j.target.value==="active"),children:[s.jsx("option",{value:"active",children:"Activo"}),s.jsx("option",{value:"inactive",children:"Bloqueado"})]})]})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Brand name"}),s.jsx("input",{value:g.brand_name,onChange:j=>h({...g,brand_name:j.target.value}),placeholder:"Perzivalh"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Logo URL"}),s.jsx("input",{value:g.logo_url,onChange:j=>h({...g,logo_url:j.target.value}),placeholder:"https://"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Paleta de colores"}),s.jsx("div",{className:"sa-note",children:"Personalizacin deshabilitada por ahora."})]}),!q&&s.jsx("div",{className:"sa-note",children:"Nota: al registrar un tenant se inicia el aprovisionamiento en el entorno de produccion."})]}),s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Variables de entorno (envs)"}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Base de datos"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Tenant DB URL"}),s.jsx("input",{value:g.db_url,onChange:j=>h({...g,db_url:j.target.value}),placeholder:"postgresql://..."})]})]}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Odoo (opcional)"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Base URL"}),s.jsx("input",{value:g.odoo_base_url,onChange:j=>h({...g,odoo_base_url:j.target.value}),placeholder:"https://odoo-instancia"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo DB Name"}),s.jsx("input",{value:g.odoo_db_name,onChange:j=>h({...g,odoo_db_name:j.target.value}),placeholder:"db_tenant_prod"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo User"}),s.jsx("input",{value:g.odoo_username,onChange:j=>h({...g,odoo_username:j.target.value}),placeholder:"usuario@empresa.com"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Password (opcional)"}),s.jsx("input",{type:"password",value:g.odoo_password,onChange:j=>h({...g,odoo_password:j.target.value}),placeholder:"********"})]})]})]})]}),s.jsxs("div",{className:"sa-form-actions",children:[s.jsx("div",{className:"sa-status-note",children:q?Ae?"Cargando datos...":qt?"Cambios pendientes":"Sin cambios":L}),s.jsx("div",{className:"sa-form-buttons",children:q?s.jsxs(s.Fragment,{children:[qt&&s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:S,children:S?"Guardando...":"Guardar cambios"}),s.jsx("button",{className:"sa-btn danger",type:"button",onClick:xn,disabled:S||!_,children:M?"Bloquear tenant":"Reactivar tenant"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:it,disabled:p||S,children:p?"Validando...":"Validar conexion"}),s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:S,children:S?"Guardando...":"Desplegar instancia"})]})})]})]}),_?s.jsx(zy,{channels:u.length?u:l.filter(j=>j.tenant_id===_),tenantId:_,onRefresh:T}):s.jsx("div",{style:{marginTop:"2rem",padding:"1rem",border:"1px dashed rgba(255,255,255,0.2)",borderRadius:"12px",color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",textAlign:"center"},children:"Crea el tenant primero para configurar las lneas de WhatsApp."}),_&&s.jsx(Cy,{tenantId:_,tenantBots:re,availableFlows:Q,loading:be,onToggleBot:Ht,onAddBot:W,onRemoveBot:we})]})]})]})}const th=["open","pending","assigned"],nh=["admin","recepcion","caja","marketing","doctor"],Vn={admin:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!0},campaigns:{read:!0,write:!0},settings:{read:!0,write:!0}},settings:{general:{read:!0,write:!0},users:{read:!0,write:!0},bot:{read:!0,write:!0},templates:{read:!0,write:!0},audit:{read:!0,write:!0},odoo:{read:!0,write:!0}}},recepcion:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},caja:{modules:{chat:{read:!0,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},marketing:{modules:{chat:{read:!1,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!0,write:!0},settings:{read:!0,write:!1}},settings:{general:{read:!0,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!0,write:!0},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},doctor:{modules:{chat:{read:!0,write:!1},dashboard:{read:!1,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}}};function yo(e){if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleString()}function $y(e){if(!e)return"-";const t=new Date(e);if(Number.isNaN(t.getTime()))return"-";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):i===1?"Ayer":["Dom","Lun","Mar","Mie","Jue","Vie","Sab"][t.getDay()]}function sh(e){if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?"Hoy":i===1?"Ayer":`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}function J(e){if(!e)return"Error inesperado";if(typeof e=="string")return e==="offline"?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":e==="network_error"?"No se pudo conectar con el servidor. Intenta de nuevo.":e==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":e;const t=e.message||"Error inesperado";return t==="offline"||t.toLowerCase().includes("failed to fetch")?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":t==="network_error"||t.toLowerCase().includes("networkerror")?"No se pudo conectar con el servidor. Intenta de nuevo.":t==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":t}function Uy(e,t){return e?t.includes(e.role):!1}function jo(e){if(!e||typeof e!="object")return{...Vn};const t={...Vn};return Object.entries(e).forEach(([n,r])=>{var a,i;!r||typeof r!="object"||(t[n]={modules:{...(a=Vn[n])==null?void 0:a.modules,...r.modules},settings:{...(i=Vn[n])==null?void 0:i.settings,...r.settings}})}),t}function wt(e,t,n,r="read"){var i;const a=(i=e==null?void 0:e[t])==null?void 0:i[n];return a?!!a[r]:!1}function No(e){const t=n=>n.status==="pending"&&!n.assigned_user_id?0:n.status==="pending"&&n.assigned_user_id?1:n.status==="assigned"?2:3;return[...e].sort((n,r)=>{const a=t(n),i=t(r);if(a!==i)return a-i;const l=new Date(n.last_message_at||n.created_at||0).getTime();return new Date(r.last_message_at||r.created_at||0).getTime()-l})}function Vy(e){const t=new URLSearchParams;Object.entries(e||{}).forEach(([r,a])=>{a==null||a===""||t.append(r,a)});const n=t.toString();return n?`?${n}`:""}function rh(e){if(!e)return"?";const t=e.trim();return t?t[0].toUpperCase():"?"}function ah(e){if(typeof document>"u")return;const t=document.documentElement.style;t.removeProperty("--accent"),t.removeProperty("--accent-strong"),t.removeProperty("--accent-soft"),t.removeProperty("--accent-soft-2"),t.removeProperty("--scroll-thumb"),t.removeProperty("--scroll-thumb-hover")}function Fy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M4.5 5.5h15v10H8l-3.5 3.5V5.5Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 9h8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 12.5h5",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Wy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"})]})}function Hy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 9a6 6 0 1 1 12 0c0 4.2 2 5.5 2 5.5H4S6 13.2 6 9Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M9.5 19a2.5 2.5 0 0 0 5 0",strokeWidth:"1.8"})]})}function qy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"2",strokeLinecap:"round"})]})}function Qy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"4",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 3v2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M12 18.5V21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M3 12h2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M18.5 12H21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 5.2l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 17l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 18.8 7 17",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 7l1.8-1.8",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Gy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M20 14.2A8.5 8.5 0 1 1 9.8 4 6.5 6.5 0 0 0 20 14.2Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function Yy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.8"}),s.jsx("path",{d:"M16.5 16.5 21 21",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ky(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Xy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3.5",y:"6",width:"11",height:"12",rx:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"m14.5 10 6-3v10l-6-3",strokeWidth:"1.8"})]})}function Jy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M6.5 4.5 9 3l2.5 4-2.5 1.5c1.2 2.3 3.2 4.3 5.5 5.5L16 11l4 2.5-1.5 2.5c-.7 1.2-2.2 1.7-3.6 1.3a15.9 15.9 0 0 1-7.7-7.7c-.4-1.4.1-2.9 1.3-3.6Z",strokeWidth:"1.6",strokeLinejoin:"round"})})}function Zy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"9",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 10v6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"7.5",r:"1",fill:"currentColor"})]})}function ej(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"m4 12 15-7-6 14-2.5-5.2L4 12Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function tj(){const[e,t]=f.useState(localStorage.getItem("token")||""),[n,r]=f.useState(()=>typeof window<"u"&&localStorage.getItem("superadmin_token")||""),[a,i]=f.useState(null),[l,o]=f.useState(null),[u,m]=f.useState(null),[w,v]=f.useState([]),[x,C]=f.useState({id:"",display_name:""}),[L,R]=f.useState(()=>{if(typeof window>"u")return{};try{return JSON.parse(localStorage.getItem("last_read_map")||"{}")}catch{return{}}}),[g,h]=f.useState({email:"",password:""}),[p,y]=f.useState(""),[S,D]=f.useState("chats"),[z,I]=f.useState(()=>typeof window<"u"?window.location.pathname:"/"),[_,P]=f.useState(()=>localStorage.getItem("theme")||"light"),[M,K]=f.useState(()=>typeof window<"u"&&window.navigator?!window.navigator.onLine:!1),[ue,pe]=f.useState(!1),[We,Se]=f.useState(!1),[Ae,tt]=f.useState(!1),[V,Q]=f.useState(!0),[ne,re]=f.useState(!1),[de,be]=f.useState(""),A=f.useRef(null),H=f.useRef(null),k=f.useRef(null),U=f.useRef({conversationId:null,lastId:null,length:0}),q=f.useRef(0),le=f.useRef(!1),he=f.useRef(0),[ce,Qe]=f.useState("users"),[Be,ye]=f.useState("list"),[ve,Te]=f.useState(()=>jo(null)),[Ft,Me]=f.useState(!1),[Ye,He]=f.useState(!1),[at,xt]=f.useState(!1),gn=f.useMemo(()=>{const d=Object.keys(ve||{}).filter(N=>!nh.includes(N));return[...nh,...d]},[ve]),[sn,Xn]=f.useState({status:"",assigned_user_id:"",tag:"",search:"",phone_number_id:""}),Wt=z.startsWith("/superadmin"),[rn,Ht]=f.useState([]),[W,we]=f.useState(null),[Ee,T]=f.useState([]),[je,En]=f.useState(""),[vn,An]=f.useState("text"),[it,Tn]=f.useState([]),[xn,qt]=f.useState([]),[j,$]=f.useState(""),[G,se]=f.useState(""),[_e,Pt]=f.useState(""),[yt,jt]=f.useState(!1),[Ln,Mr]=f.useState({name:"",color:"#6b7280"}),[Dr,Ir]=f.useState(!1),[Le,ae]=f.useState(""),{pushToast:ee}=wu(),Jn=f.useRef(new Map),Mt=f.useRef(new Map),Rn=f.useRef(new Map),Zn=f.useRef(new Map),As=f.useRef(new Map),[es,Ks]=f.useState(null),[On,ts]=f.useState([]),[Xs,bl]=f.useState([]),[yn,Ts]=f.useState(0),[ns,Qt]=f.useState([]),[Cl,El]=f.useState(""),[za,$a]=f.useState(null),[_u,ss]=f.useState([]),[Al,Su]=f.useState(null),[Nt,Br]=f.useState({name:"",template_id:"",scheduled_for:"",send_now:!0}),[Ct,Ua]=f.useState({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),[zr,Pn]=f.useState([]),[dt,Va]=f.useState({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),[Js,$r]=f.useState(null),[Fa,Tl]=f.useState([]),[Ll,Rl]=f.useState([]),[lt,Zs]=f.useState({id:"",code:"",name:"",address:"",lat:"",lng:"",hours_text:"",phone:"",is_active:!0}),[nt,ht]=f.useState({id:"",code:"",name:"",subtitle:"",description:"",price_bob:"",duration_min:"",image_url:"",is_featured:!1,is_active:!0}),[Ur,er]=f.useState({id:"",name:"",language:"es",category:"",body_preview:"",is_active:!0}),[Wa,Ha]=f.useState([]),rs=((l==null?void 0:l.brand_name)||(u==null?void 0:u.name)||"Perzivalh").trim(),[jn,Mn]=f.useState(!1),[as,Ls]=f.useState(!1),[Rs,Os]=f.useState(null),qa=48,Qa=80,Vr=60,Ga=320,Ya=120,Ol=5,Pl=2*60*1e3,Ps=f.useRef(new Map);function Ml(){const d=Ps.current;for(;d.size>Ol;){const N=d.keys().next().value;d.delete(N)}}function Dl(d){const N=Ps.current,E=N.get(d);return E?Date.now()-E.updatedAt>Pl?(N.delete(d),null):E:null}function Ka(d,N){const E=Ps.current;E.delete(d),E.set(d,{...N,updatedAt:Date.now()}),Ml()}const an=f.useCallback((d,N={})=>{if(typeof window>"u")return;const E=d||"/";if(window.location.pathname===E){I(E);return}N.replace?window.history.replaceState({},"",E):window.history.pushState({},"",E),I(E)},[]),Il=f.useMemo(()=>On.find(d=>d.id===Nt.template_id),[On,Nt.template_id]),Bl=f.useMemo(()=>{const d=[...Ee].reverse().find(N=>N.type==="note");return(d==null?void 0:d.text)||""},[Ee]),zl=f.useMemo(()=>Ee.filter(d=>d.type==="note"),[Ee]);f.useEffect(()=>{if(typeof window>"u")return;const d=()=>{I(window.location.pathname||"/")};return window.addEventListener("popstate",d),()=>window.removeEventListener("popstate",d)},[]),f.useEffect(()=>{ar(e||null)},[e]),f.useEffect(()=>{document.body.dataset.theme=_,localStorage.setItem("theme",_)},[_]),f.useEffect(()=>{if(typeof window>"u")return;const d=()=>{K(!window.navigator.onLine)};return d(),window.addEventListener("online",d),window.addEventListener("offline",d),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",d)}},[]),f.useEffect(()=>{re(!1),Q(!0),requestAnimationFrame(()=>{In()}),W&&Fr(W)},[W==null?void 0:W.id]),f.useEffect(()=>{S==="chats"&&(re(!1),Q(!0),requestAnimationFrame(()=>{In()}))},[S,W==null?void 0:W.id]),f.useEffect(()=>{var Ce;if(!W){be("");return}const d=Ee[Ee.length-1],N=(d==null?void 0:d.id)||(d==null?void 0:d.created_at)||(Ee.length?`${Ee.length}`:null),E=U.current,te=E.conversationId===W.id&&d&&E.lastId&&N!==E.lastId;if(le.current&&Ee.length>0){le.current=!1,requestAnimationFrame(()=>{In()});return}if(te?V?In():re(!0):V&&re(!1),U.current={conversationId:W.id,lastId:N,length:Ee.length},Dt(),V&&Ee.length>Ga){const X=Ee.slice(-Ga);T(X),Os(((Ce=X[0])==null?void 0:Ce.created_at)||null),Mn(!0)}},[Ee,W==null?void 0:W.id,V]),f.useEffect(()=>{var N;if(!(W!=null&&W.id)||!Ee.length)return;const d={messages:Ee.slice(-Ya),cursor:Rs||((N=Ee[0])==null?void 0:N.created_at)||null,hasMore:jn};Ka(W.id,d)},[Ee,Rs,jn,W==null?void 0:W.id]),f.useEffect(()=>{S!=="chats"&&Q(!1)},[S]),f.useEffect(()=>{if(!e)return;let d=!0;return me("/api/me").then(N=>{d&&i(N.user)}).catch(()=>{d&&(t(""),i(null))}),()=>{d=!1}},[e]),f.useEffect(()=>{if(!a||a.role==="superadmin"){o(null),v([]),ah();return}let d=!0;return me("/api/branding").then(N=>{d&&o(N.branding||null)}).catch(()=>{d&&o(null)}),me("/api/tenant").then(N=>{d&&m(N.tenant||null)}).catch(()=>{d&&m(null)}),me("/api/channels").then(N=>{d&&v(N.channels||[])}).catch(()=>{d&&v([])}),()=>{d=!1}},[a]),f.useEffect(()=>{ah()},[l]),f.useEffect(()=>{if(a){if(a.role==="superadmin"){Wt||an("/superadmin",{replace:!0});return}Wt&&an("/",{replace:!0})}},[a,Wt,an]),f.useEffect(()=>{a&&a.role!=="superadmin"&&(Xa(),Ms())},[a]),f.useEffect(()=>{a&&a.role!=="superadmin"&&Ja()},[a]),f.useEffect(()=>{!a||S!=="chats"||a.role!=="superadmin"&&c()},[a,S,sn]),f.useEffect(()=>{a&&a.role!=="superadmin"&&(S==="dashboard"&&ku(),S==="campaigns"&&(nr(),Za(1,6)))},[a,S]),f.useEffect(()=>{if(!a||S!=="admin")return;const d=(ve==null?void 0:ve[a.role])||Vn[a.role],N=wt(d,"settings","users"),E=wt(d,"settings","bot"),O=wt(d,"settings","general"),te=wt(d,"settings","templates"),Ce=wt(d,"settings","audit");ce==="users"&&N&&Wr(),ce==="bot"&&E&&Jp(),ce==="general"&&O&&ls(),ce==="templates"&&te&&nr(),ce==="audit"&&Ce&&hm()},[a,S,ce,ve]),f.useEffect(()=>{if(!a||S!=="admin")return;const d=(ve==null?void 0:ve[a.role])||Vn[a.role],E=["general","users","bot","templates","audit","odoo"].filter(O=>wt(d,"settings",O));if(!E.length){D(result.user.role==="superadmin"?"superadmin":"chats");return}E.includes(ce)||Qe(E[0])},[a,S,ce,ve]),f.useEffect(()=>{if(!e||(a==null?void 0:a.role)==="superadmin")return;const d=Xx(e),N={current:null},E=["/sounds/new-notification-09-352705.wav","/sounds/new-notification-09-352705.mp3"],O=()=>{if(N.current)return N.current;const X=new Audio(E[0]);X.volume=1;let oe=0;return X.addEventListener("error",()=>{oe+=1,oe<E.length&&(X.src=E[oe],X.load())}),N.current=X,X},te=()=>{const X=O();X.play().then(()=>{X.pause(),X.currentTime=0}).catch(()=>{})};window.addEventListener("click",te,{once:!0}),window.addEventListener("touchstart",te,{once:!0});const Ce=()=>{if(!(typeof window>"u"))try{const X=O();X.currentTime=0,X.play().catch(()=>{})}catch{}};return d.on("conversation:update",({conversation:X})=>{const oe=As.current.get(X.id);As.current.set(X.id,X.status),X.status==="pending"&&!X.assigned_user_id&&oe!=="pending"&&(Ce(),ee({message:"Nueva conversacin pendiente"})),Ht(ze=>{const Oe=ze.map(ft=>ft.id===X.id?{...ft,...X}:ft);return Oe.find(ft=>ft.id===X.id)||Oe.push(X),No(Oe)}),we(ze=>(ze==null?void 0:ze.id)===X.id?{...ze,...X}:ze)}),d.on("message:new",({conversation:X,message:oe})=>{X.status==="pending"&&!X.assigned_user_id&&Ce();const ze={...X,last_message_text:(oe==null?void 0:oe.text)||null,last_message_type:(oe==null?void 0:oe.type)||null,last_message_direction:(oe==null?void 0:oe.direction)||null,last_message_at:(oe==null?void 0:oe.created_at)||X.last_message_at};Ht(Oe=>{const ft=Oe.map(sr=>sr.id===X.id?{...sr,...ze}:sr);return ft.find(sr=>sr.id===X.id)||ft.push(ze),No(ft)}),we(Oe=>(Oe==null?void 0:Oe.id)===X.id?{...Oe,...ze}:Oe),T(Oe=>!W||W.id!==X.id?Oe:(Fr(ze),[...Oe,oe]))}),()=>{d.disconnect()}},[e,W]),f.useEffect(()=>{if(!a)return;if(a.role==="superadmin"){S!=="superadmin"&&D("superadmin");return}const d=(ve==null?void 0:ve[a.role])||Vn[a.role],N=wt(d,"modules","chat"),E=wt(d,"modules","dashboard"),O=wt(d,"modules","campaigns"),te=wt(d,"modules","settings");S==="chats"&&!N&&D(E?"dashboard":O?"campaigns":"admin"),S==="dashboard"&&!E&&D(N?"chats":O?"campaigns":"admin"),S==="campaigns"&&!O&&D(N?"chats":E?"dashboard":"admin"),S==="admin"&&!te&&D(N?"chats":E?"dashboard":"campaigns")},[a,S,ve]),f.useEffect(()=>{if(!a||a.role!=="admin"||!Ft||!Ye||at)return;const d=setTimeout(()=>{const N=he.current;xt(!0),Ke("/api/admin/role-permissions",{permissions:ve}).then(()=>{he.current===N&&He(!1)}).catch(E=>{ae(J(E))}).finally(()=>{xt(!1)})},350);return()=>clearTimeout(d)},[a,ve,Ye,Ft,at]);async function Xa(){try{const d=await me("/api/users");qt(d.users||[])}catch(d){ae(J(d))}}async function Ja(){try{const d=await me("/api/role-permissions"),N=jo(d.permissions||null);he.current=0,Te(N),He(!1),Me(!0)}catch(d){ae(J(d)),Me(!0)}}async function Ms(){try{const d=await me("/api/tags");Tn(d.tags||[])}catch(d){ae(J(d))}}async function c(){try{const d=Vy(sn),N=await me(`/api/conversations${d}`);Ht(No(N.conversations||[]))}catch(d){ae(J(d))}}async function b(d){var te,Ce;le.current=!0;const N=Dl(d),E=rn.find(X=>X.id===d);Ir(!N),ln(),E&&we(E),N&&(T(N.messages||[]),Os(N.cursor||null),Mn(!!N.hasMore),Dt(),requestAnimationFrame(()=>{In()}));const O=q.current+1;q.current=O;try{const X=`?limit=${Qa}&window_hours=${qa}`,oe=await me(`/api/conversations/${d}${X}`);if(q.current!==O)return;let ze=oe.conversation;const Oe=oe.messages||[];if((ze==null?void 0:ze.status)==="pending"&&!ze.assigned_user_id&&(a!=null&&a.id))try{ze=(await Ke(`/api/conversations/${d}/assign`,{})).conversation}catch(ft){String(J(ft)).includes("already_assigned")&&ee({type:"error",message:"Conversacin tomada por otro operador"})}we(ze),T(Oe),Mn(!!oe.has_more),Os(oe.next_cursor||((te=Oe[0])==null?void 0:te.created_at)||null),Ka(d,{messages:Oe.slice(-Ya),cursor:oe.next_cursor||((Ce=Oe[0])==null?void 0:Ce.created_at)||null,hasMore:!!oe.has_more}),Fr(ze)}catch(X){ae(J(X))}finally{q.current===O&&Ir(!1)}}async function F(d){var Ce;if(!jn||as)return;const N=Rs;if(!N){Mn(!1);return}Ls(!0);const E=H.current,O=E?E.scrollHeight:0,te=E?E.scrollTop:0;try{const X=`?limit=${Vr}&before=${encodeURIComponent(N)}`,oe=await me(`/api/conversations/${d}${X}`);if((W==null?void 0:W.id)!==d)return;const ze=oe.messages||[];ze.length?(T(Oe=>{const ft=new Set(Oe.map(Ul=>Ul.id));return[...ze.filter(Ul=>!ft.has(Ul.id)),...Oe]}),Os(oe.next_cursor||((Ce=ze[0])==null?void 0:Ce.created_at)||N),Mn(!!oe.has_more),requestAnimationFrame(()=>{const Oe=H.current;if(!Oe)return;const ft=Oe.scrollHeight;Oe.scrollTop=ft-O+te})):Mn(!1)}catch(X){ae(J(X))}finally{Ls(!1)}}async function Z(d){d.preventDefault(),y("");try{const N=await Ne("/api/auth/login",{email:g.email,password:g.password});t(N.token),ar(N.token),i(N.user),r(""),localStorage.removeItem("superadmin_token");const E=N.user.role==="superadmin";D(E?"superadmin":"chats"),E?an("/superadmin",{replace:!0}):Wt&&an("/",{replace:!0})}catch{y("Credenciales invalidas")}}function ie(){t(""),ar(null),i(null),Ht([]),we(null),T([]),D("chats"),tt(!1),Te(jo(null)),Me(!1),He(!1),xt(!1),he.current=0,r(""),localStorage.removeItem("superadmin_token"),an("/",{replace:!0})}async function Re(d){const N=await Ne(`/api/superadmin/tenants/${d}/impersonate`);!n&&e&&(localStorage.setItem("superadmin_token",e),r(e)),t(N.token),ar(N.token),i(N.user),D("chats"),an("/",{replace:!0})}function Et(){const d=n||(typeof window<"u"?localStorage.getItem("superadmin_token"):"");if(!d){ie();return}localStorage.removeItem("superadmin_token"),r(""),t(d),ar(d),i(null),D("chats"),an("/superadmin",{replace:!0})}function Dn(d){Te(N=>typeof d=="function"?d(N):d),he.current+=1,He(!0)}function tr(){P(d=>d==="light"?"dark":"light")}function In(){const d=H.current;d&&(d.scrollTop=d.scrollHeight,Q(!0),re(!1),Dt())}function Fr(d){!(d!=null&&d.id)||!(d!=null&&d.last_message_at)||R(N=>{const E={...N,[d.id]:d.last_message_at};return localStorage.setItem("last_read_map",JSON.stringify(E)),E})}function Bn(){const d=H.current;if(!d)return;const E=d.scrollHeight-d.scrollTop-d.clientHeight<24;Q(E),E&&re(!1),d.scrollTop<120&&jn&&!as&&W&&F(W.id),Dt()}function ln(){T([]),Os(null),Mn(!1),Ls(!1),U.current={conversationId:null,lastId:null,length:0}}function Dt(){k.current||(k.current=requestAnimationFrame(()=>{k.current=null,is()}))}function is(){const d=H.current;if(!d)return;const N=d.querySelectorAll(".day-pill");if(!N.length){be("");return}const E=d.scrollTop,O=12;let te=N[0];for(const X of N)if(X.offsetTop-O<=E)te=X;else break;const Ce=te.dataset.dayLabel||te.textContent||"";be(Ce)}function Gt(){we(null),ln()}function Dp(d){var N;En(d),(N=A.current)==null||N.focus()}async function Ip(d){if(d.preventDefault(),!W||!je.trim())return;const N=je.trim();En("");try{await Ne(`/api/conversations/${W.id}/messages`,{text:N,type:vn})}catch(E){ae(J(E))}}async function Bp(d){if(d.preventDefault(),!W||!G.trim())return;const N=G.trim();se("");try{const E=await Ne(`/api/conversations/${W.id}/messages`,{text:N,type:"note"});E!=null&&E.message&&T(O=>[...O,E.message]),E!=null&&E.conversation&&we(E.conversation)}catch(E){ae(J(E))}}async function zp(){if(W)try{const d=await Ke(`/api/conversations/${W.id}/assign`);we(d.conversation)}catch(d){const N=J(d)||"No se pudo tomar la conversacion";ee({type:"error",message:N})}}async function $p(){if(!(!W||!_e))try{const d=await Ke(`/api/conversations/${W.id}/assign`,{user_id:_e});we(d.conversation),Pt(""),ee({message:"Conversacin reasignada"})}catch(d){const N=J(d)||"No se pudo reasignar";ee({type:"error",message:N})}}async function Up(d){var N;if(W)try{let O=(await Ke(`/api/conversations/${W.id}/status`,{status:d})).conversation;if(d==="open"&&((N=O==null?void 0:O.tags)!=null&&N.length)){const te=O.tags.find(Ce=>(Ce.name||"").toLowerCase()==="pendiente");if(te)try{O=(await Ne(`/api/conversations/${O.id}/tags`,{add:[],remove:[te.name]})).conversation||O}catch{O={...O,tags:O.tags.filter(X=>X.name!==te.name)}}}we(O),Ht(te=>te.map(Ce=>Ce.id===O.id?{...Ce,...O}:Ce))}catch(E){ae(J(E))}}async function Vp(d){var E;if(!W)return;const N=((E=W.tags)==null?void 0:E.some(O=>O.name===d))||!1;if(N){const O=`${W.id}:${d}`;if(Zn.current.has(O))return;const te=W,Ce={...W,tags:(W.tags||[]).filter(oe=>oe.name!==d)};we(Ce);const X=setTimeout(async()=>{try{const oe=await Ne(`/api/conversations/${te.id}/tags`,{add:[],remove:[d]});(W==null?void 0:W.id)===te.id&&we(oe.conversation)}catch(oe){(W==null?void 0:W.id)===te.id&&we(te),ee({type:"error",message:J(oe)||"No se pudo eliminar el tag"})}finally{Zn.current.delete(O)}},8e3);Zn.current.set(O,{timer:X,snapshot:te}),ee({message:"Tag eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const oe=Zn.current.get(O);oe!=null&&oe.timer&&clearTimeout(oe.timer),oe!=null&&oe.snapshot?we(oe.snapshot):we(te),Zn.current.delete(O),ee({message:"Eliminacin cancelada"})}});return}try{const O=await Ne(`/api/conversations/${W.id}/tags`,{add:N?[]:[d],remove:N?[d]:[]});we(O.conversation)}catch(O){ae(J(O))}}async function Fp(d){if(d.preventDefault(),!j.trim()||!W)return;const N=j.trim();$("");try{const E=await Ne(`/api/conversations/${W.id}/tags`,{add:[N]});we(E.conversation),await Ms()}catch(E){ae(J(E))}}async function Wp(d){d.preventDefault();const N=Ln.name.trim();if(!N){ae("Completa el nombre de la etiqueta");return}try{await Ne("/api/tags",{name:N,color:Ln.color||null}),Mr({name:"",color:"#6b7280"}),await Ms(),ee({message:"Etiqueta creada"})}catch(E){ae(J(E))}}async function Hp(d,N){if(d)try{await Un(`/api/tags/${d}`),we(E=>E&&{...E,tags:(E.tags||[]).filter(O=>O.name!==N)}),await Ms(),ee({message:"Etiqueta eliminada"})}catch(E){ae(J(E))}}async function ku(){try{const d=await me("/api/dashboard/metrics");Ks(d)}catch(d){ae(J(d))}}async function nr(){try{const d=await me("/api/templates").catch(()=>me("/api/admin/templates"));ts(d.templates||[])}catch(d){ae(J(d))}}async function Za(d=1,N=6,E=""){try{const O=new URLSearchParams({page:String(d),page_size:String(N)});E&&O.set("q",E);const te=await me(`/api/admin/campaigns?${O.toString()}`);bl(te.campaigns||[]),Ts(Number.isFinite(te.total)?te.total:(te.campaigns||[]).length)}catch(O){ae(J(O))}}async function qp(d){El(d);try{const N=await me(`/api/admin/campaigns/${d}/messages`);Qt(N.messages||[])}catch(N){ae(J(N))}}async function Qp(d){var E;if(d.preventDefault(),!Nt.name.trim()||!Nt.template_id){ae("Completa el nombre y plantilla");return}const N={};Ct.status&&(N.status=Ct.status),Ct.tag&&(N.tag=Ct.tag.trim()),Ct.assigned_user_id&&(N.assigned_user_id=Ct.assigned_user_id),Ct.verified_only&&(N.verified_only=!0),Ct.segment_id&&(N.segment_id=Ct.segment_id,Ct.segment_name&&(N.segment_name=Ct.segment_name));try{const O=await Ne("/api/admin/campaigns",{name:Nt.name.trim(),template_id:Nt.template_id,audience_filter:N,scheduled_for:Nt.scheduled_for||null});if(Nt.send_now&&!Nt.scheduled_for){const te=(E=O==null?void 0:O.campaign)==null?void 0:E.id;te&&await Ne(`/api/admin/campaigns/${te}/send`,{})}Br({name:"",template_id:"",scheduled_for:"",send_now:!0}),Ua({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),await Za(1,6),ee({message:"Campaa creada correctamente"})}catch(O){ae(J(O)),ee({type:"error",message:J(O)||"Error al crear campaa"})}}async function Gp(d){try{await Ne(`/api/admin/campaigns/${d}/send`,{}),await Za(1,6)}catch(N){ae(J(N))}}async function Yp(){try{await me("/api/templates/sync"),await nr()}catch(d){ae(J(d))}}async function Wr(){try{const d=await me("/api/admin/users");Pn(d.users||[])}catch(d){ae(J(d))}}async function Kp(d){if(d.preventDefault(),!dt.name.trim()||!dt.role){ae("Completa los campos requeridos");return}try{dt.id?(await Ke(`/api/admin/users/${dt.id}`,{name:dt.name.trim(),role:dt.role,is_active:dt.is_active,password:dt.password||void 0}),ee({message:"Usuario actualizado correctamente"})):(await Ne("/api/admin/users",{name:dt.name.trim(),email:dt.email.trim().toLowerCase(),role:dt.role,password:dt.password}),ee({message:"Usuario creado correctamente"})),Va({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),await Wr()}catch(N){ae(J(N)),ee({type:"error",message:J(N)||"Error al guardar usuario"})}}async function Xp(d){if(!d||Jn.current.has(d))return;let N=null;try{N=zr.slice(),Pn(O=>O.filter(te=>te.id!==d));const E=setTimeout(async()=>{try{await Un(`/api/admin/users/${d}`),await Wr(),ee({message:"Usuario eliminado definitivamente"})}catch(O){N?Pn(N):await Wr(),ee({type:"error",message:J(O)||"No se pudo eliminar el usuario"})}finally{Jn.current.delete(d)}},8e3);Jn.current.set(d,{timer:E,snapshot:N}),ee({message:"Usuario eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const O=Jn.current.get(d);O!=null&&O.timer&&clearTimeout(O.timer),O!=null&&O.snapshot?Pn(O.snapshot):N?Pn(N):await Wr(),Jn.current.delete(d),ee({message:"Eliminacin cancelada"})}})}catch(E){ae(J(E)),ee({type:"error",message:J(E)||"Error al eliminar usuario"})}}async function Jp(){try{const d=await me("/api/admin/settings");$r(d.settings)}catch(d){ae(J(d))}}async function Zp(){if(Js)try{const d=await Ke("/api/admin/settings",{bot_enabled:Js.bot_enabled,auto_reply_enabled:Js.auto_reply_enabled});$r(d.settings)}catch(d){ae(J(d))}}async function ls(){try{const[d,N]=await Promise.all([me("/api/admin/branches"),me("/api/admin/services")]);Tl(d.branches||[]),Rl(N.services||[])}catch(d){ae(J(d))}}async function em(){try{const d=await me("/api/channels");v(d.channels||[])}catch{v([])}}function tm(d){C({id:d.id,display_name:d.display_name||""})}async function nm(d){if(d.preventDefault(),!!x.id)try{await Ke(`/api/channels/${x.id}`,{display_name:x.display_name.trim()}),C({id:"",display_name:""}),await em(),ee({message:"Canal actualizado correctamente"})}catch(N){ae(J(N)),ee({type:"error",message:J(N)||"Error al guardar canal"})}}async function sm(d){const N=ve==null?void 0:ve[d];if(!(!d||Mt.current.has(d)))try{Te(O=>{const te={...O};return delete te[d],te});const E=setTimeout(async()=>{try{await Un(`/api/admin/role-permissions/${d}`),ee({message:"Rol eliminado definitivamente"})}catch(O){N&&Te(te=>({...te,[d]:N})),ee({type:"error",message:J(O)||"No se pudo eliminar el rol"})}finally{Mt.current.delete(d)}},8e3);Mt.current.set(d,{timer:E,currentPermissions:N}),ee({message:"Rol eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const O=Mt.current.get(d);O!=null&&O.timer&&clearTimeout(O.timer),O!=null&&O.currentPermissions&&Te(te=>({...te,[d]:O.currentPermissions})),Mt.current.delete(d),ee({message:"Eliminacin cancelada"})}})}catch(E){ae(J(E)),ee({type:"error",message:J(E)||"Error al eliminar rol"})}}async function rm(d){if(d.preventDefault(),!lt.code.trim()||!lt.name.trim()){ae("Completa codigo y nombre");return}const N={code:lt.code.trim(),name:lt.name.trim(),address:lt.address.trim(),lat:lt.lat!==""?Number(lt.lat):0,lng:lt.lng!==""?Number(lt.lng):0,hours_text:lt.hours_text.trim(),phone:lt.phone.trim()||null,is_active:lt.is_active};try{lt.id?(await Ke(`/api/admin/branches/${lt.id}`,N),ee({message:"Sucursal actualizada correctamente"})):(await Ne("/api/admin/branches",N),ee({message:"Sucursal creada correctamente"})),Zs({id:"",code:"",name:"",address:"",lat:"",lng:"",hours_text:"",phone:"",is_active:!0}),await ls()}catch(E){ae(J(E)),ee({type:"error",message:J(E)||"Error al guardar sucursal"})}}async function am(d){try{await Un(`/api/admin/branches/${d}`),await ls(),ee({message:"Sucursal eliminada correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{await Ke(`/api/admin/branches/${d}`,{is_active:!0}),await ls(),ee({message:"Sucursal restaurada"})}catch(N){ee({type:"error",message:J(N)||"No se pudo restaurar la sucursal"})}}})}catch(N){ae(J(N)),ee({type:"error",message:J(N)||"Error al eliminar sucursal"})}}async function im(d){if(d.preventDefault(),!nt.code.trim()||!nt.name.trim()){ae("Completa codigo y nombre");return}const N={code:nt.code.trim(),name:nt.name.trim(),subtitle:nt.subtitle.trim()||null,description:nt.description.trim(),price_bob:nt.price_bob?Number(nt.price_bob):0,duration_min:nt.duration_min?Number(nt.duration_min):null,image_url:nt.image_url.trim()||null,is_featured:nt.is_featured,is_active:nt.is_active};try{nt.id?(await Ke(`/api/admin/services/${nt.id}`,N),ee({message:"Servicio actualizado correctamente"})):(await Ne("/api/admin/services",N),ee({message:"Servicio creado correctamente"})),ht({id:"",code:"",name:"",subtitle:"",description:"",price_bob:"",duration_min:"",image_url:"",is_featured:!1,is_active:!0}),await ls()}catch(E){ae(J(E)),ee({type:"error",message:J(E)||"Error al guardar servicio"})}}async function lm(d){try{await Un(`/api/admin/services/${d}`),await ls(),ee({message:"Servicio eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{await Ke(`/api/admin/services/${d}`,{is_active:!0}),await ls(),ee({message:"Servicio restaurado"})}catch(N){ee({type:"error",message:J(N)||"No se pudo restaurar el servicio"})}}})}catch(N){ae(J(N)),ee({type:"error",message:J(N)||"Error al eliminar servicio"})}}async function om(d,N,E){if(d)try{await Ne(`/api/admin/services/${d.id}/branches`,{branch_id:N,is_available:E}),await ls()}catch(O){ae(J(O))}}async function cm(d,N){d!=null&&d.preventDefault&&d.preventDefault();const E=N||Ur||{},O=typeof E.name=="string"?E.name.trim():"";if(!O)return ae("Completa el nombre"),null;const te={name:O,category:E.category||"UTILITY",language:E.language||"es",body_text:E.body_text||E.body_preview||"",header_type:E.header_type||null,header_content:E.header_content||null,footer_text:E.footer_text||null,buttons:E.buttons||E.buttons_json||[]},Ce=E.variable_mappings||E.variableMappings||[];try{let X=null;return E.id?(X=await mc(`/api/templates/${E.id}`,te),await mc(`/api/templates/${E.id}/mappings`,{mappings:Ce}),ee({message:"Borrador actualizado correctamente"})):(X=await Ne("/api/templates/draft",{...te,variable_mappings:Ce}),ee({message:"Borrador creado correctamente"})),await nr(),(X==null?void 0:X.template)||null}catch(X){return ae(J(X)),ee({type:"error",message:J(X)||"Error al guardar plantilla"}),null}}async function um(d){if(d)try{await Ne(`/api/templates/${d}/submit`,{}),await nr(),ee({message:"Plantilla enviada a revisin de Meta"})}catch(N){ae(J(N)),ee({type:"error",message:J(N)||"Error al enviar a Meta"})}}async function dm(d){if(d&&!Rn.current.has(d))try{const N=On.slice();ts(O=>O.filter(te=>te.id!==d));const E=setTimeout(async()=>{try{await Un(`/api/templates/${d}`),await nr(),ee({message:"Plantilla eliminada definitivamente"})}catch(O){ts(N),ee({type:"error",message:J(O)||"No se pudo eliminar la plantilla"})}finally{Rn.current.delete(d)}},8e3);Rn.current.set(d,{timer:E,snapshot:N}),ee({message:"Plantilla eliminada. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const O=Rn.current.get(d);O!=null&&O.timer&&clearTimeout(O.timer),O!=null&&O.snapshot?ts(O.snapshot):ts(N),Rn.current.delete(d),ee({message:"Eliminacin cancelada"})}})}catch(N){ae(J(N)),ee({type:"error",message:J(N)||"Error al eliminar plantilla"})}}async function hm(){try{const d=await me("/api/admin/audit?limit=200");Ha(d.logs||[])}catch(d){ae(J(d))}}const bu={open:0,pending:0,closed:0};((es==null?void 0:es.status_counts)||[]).forEach(d=>{bu[d.status]=d._count.status});const fm=Wt?"Acceso al control plane":"Acceso a bandeja multiusuario";if(!e||!a)return s.jsx("div",{className:"login-shell",children:s.jsxs("div",{className:"login-card",children:[s.jsx("div",{className:"login-title",children:"Perzivalh"}),s.jsx("div",{className:"login-subtitle",children:fm}),M?s.jsx(ma,{variant:"offline",title:"Sin conexin",message:"No tienes internet en este momento. Conctate y vuelve a intentar iniciar sesin.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):null,s.jsxs("form",{className:"login-form",onSubmit:Z,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:g.email,onChange:d=>h(N=>({...N,email:d.target.value})),required:!0})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:g.password,onChange:d=>h(N=>({...N,password:d.target.value})),required:!0})]}),p?s.jsx("div",{className:"error",children:p}):null,s.jsx("button",{className:"primary",type:"submit",children:"Entrar"})]})]})});if((a==null?void 0:a.role)==="superadmin"&&Wt)return s.jsx("main",{className:"superadmin-page",children:s.jsx(eh,{route:z,onNavigate:an,onImpersonateTenant:Re,onLogout:ie})});const Hr=(ve==null?void 0:ve[a.role])||Vn[a.role],pm=wt(Hr,"modules","chat"),mm=wt(Hr,"modules","dashboard"),gm=wt(Hr,"modules","campaigns"),vm=wt(Hr,"modules","settings"),xm=Uy(a,["admin"]),ym=wt(Hr,"modules","chat","write"),jm=[],Cu={open:"Bot activo",pending:"Pendiente",assigned:"Tomada"},Nm=W?W.display_name||W.phone_e164||W.wa_id:"Selecciona un chat",wm=(W==null?void 0:W.phone_e164)||(W==null?void 0:W.wa_id)||"",_m=W?Cu[W.status]||"Sin estado":"",Sm=[{id:"chats",label:"Chats",icon:Fy,enabled:pm},{id:"dashboard",label:"Dashboard",icon:Wy,enabled:mm},{id:"campaigns",label:"Campaas",icon:Hy,enabled:gm},{id:"admin",label:"Configuraciones",icon:qy,enabled:vm}],$l=[];let Eu="";Ee.forEach(d=>{const N=d.created_at,E=N?new Date(N):null,O=E&&!Number.isNaN(E.getTime())?`${E.getFullYear()}-${E.getMonth()}-${E.getDate()}`:"";if(O&&O!==Eu){const te=sh(N);$l.push(s.jsx("div",{className:"day-pill","data-day-label":te,children:te},`day-${O}`)),Eu=O}$l.push(s.jsxs("div",{className:`message ${d.direction} ${d.type==="note"?"note":""}`,"data-day-key":O,"data-day-label":O?sh(N):"",children:[s.jsx("div",{className:"message-text",children:d.text||`[${d.type}]`}),s.jsx("div",{className:"message-meta",children:yo(d.created_at)})]},d.id))});const km=!!n&&a.role!=="superadmin";return s.jsxs("div",{className:`app-shell ${S==="admin"?"admin-shell":""}`,children:[s.jsx(ey,{navItems:Sm,view:S,onSetView:D,theme:_,onToggleTheme:tr,user:a,logoUrl:(l==null?void 0:l.logo_url)||"",brandName:rs,isProfileOpen:Ae,onToggleProfile:()=>tt(d=>!d),onLogout:ie,onReturnToSuperadmin:Et,showReturnToSuperadmin:km,getInitial:rh,SunIcon:Qy,MoonIcon:Gy}),S==="admin"?s.jsx(ky,{settingsSection:ce,setSettingsSection:Qe,settingsTab:Be,setSettingsTab:ye,rolePermissions:ve,setRolePermissions:Dn,defaultRolePermissions:Vn,currentRole:a.role,isAdmin:xm,adminUsers:zr,userForm:dt,setUserForm:Va,roleOptions:gn,handleUserSubmit:Kp,handleUserDelete:Xp,settings:Js,setSettings:$r,handleSaveSettings:Zp,planName:(u==null?void 0:u.plan)||"",branches:Fa,services:Ll,branchForm:lt,setBranchForm:Zs,handleBranchSubmit:rm,handleBranchDisable:am,serviceForm:nt,setServiceForm:ht,handleServiceSubmit:im,handleServiceDisable:lm,handleServiceBranchToggle:om,tenantChannels:w,channelForm:x,setChannelForm:C,handleChannelSelect:tm,handleChannelSubmit:nm,handleRoleDelete:sm,templates:On,templateForm:Ur,setTemplateForm:er,handleTemplateSubmit:cm,handleTemplateSubmitToMeta:um,handleTemplateDelete:dm,handleSyncTemplates:Yp,auditLogs:Wa,formatDate:yo,useShellLayout:!0,pageError:Le,isOffline:M,onDismissError:()=>ae(""),brandName:rs}):S==="superadmin"?s.jsx("main",{className:"content content-page",children:s.jsx(eh,{onImpersonateTenant:Re,onLogout:ie})}):s.jsxs("main",{className:`content ${S==="chats"?"content-chats":"content-page"}`,children:[S==="chats"&&s.jsx(ty,{activeConversation:W,conversations:rn,channels:w,brandName:rs,lastReadMap:L,filters:sn,showFilters:ue,users:xn,tags:it,statusOptions:th,statusLabels:Cu,formatListTime:$y,messageBlocks:$l,messageDraft:je,messageMode:vn,quickActions:jm,tagInput:j,noteInput:G,notesList:zl,latestNote:Bl,loadingConversation:Dr,isInfoOpen:We,hasUnread:ne,scrollDayLabel:de,activeName:Nm,activePhone:wm,activeStatusLabel:_m,canManageStatus:ym,currentUser:a,messageInputRef:A,chatBodyRef:H,setShowFilters:pe,setFilters:Xn,loadConversation:b,handleBackToList:Gt,setIsInfoOpen:Se,handleChatScroll:Bn,handleAssignSelf:zp,handleStatusChange:Up,handleToggleTag:Vp,handleAddTag:Fp,setNoteInput:se,handleAddNote:Bp,reassignUserId:_e,setReassignUserId:Pt,handleReassignConversation:$p,handleOpenTagManager:()=>jt(!0),handleCloseTagManager:()=>jt(!1),showTagManager:yt,tagManagerForm:Ln,setTagManagerForm:Mr,handleCreateTag:Wp,handleDeleteTag:Hp,handleQuickAction:Dp,handleSendMessage:Ip,setMessageMode:An,setMessageDraft:En,scrollChatToBottom:In,getInitial:rh,PlusIcon:Ky,SearchIcon:Yy,VideoIcon:Xy,PhoneIcon:Jy,InfoIcon:Zy,SendIcon:ej}),S==="dashboard"&&s.jsx(ry,{statusCounts:bu,metrics:es,onRefresh:ku,brandName:rs}),S==="campaigns"&&s.jsx(ly,{campaignForm:Nt,setCampaignForm:Br,campaignFilter:Ct,setCampaignFilter:Ua,templates:On,campaigns:Xs,selectedCampaignId:Cl,campaignMessages:ns,users:xn,tags:it,selectedTemplate:Il,statusOptions:th,onCreateCampaign:Qp,onLoadCampaigns:Za,onLoadCampaignMessages:qp,onSendCampaign:Gp,formatDate:yo,brandName:rs}),M?s.jsx(ma,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):Le?s.jsx(ma,{variant:"error",title:"Ocurri un problema",message:Le,dismissLabel:"Cerrar",onDismiss:()=>ae("")}):null]})]})}const nj=yp(document.getElementById("root"));nj.render(s.jsx(Jx,{children:s.jsx(tj,{})}));
