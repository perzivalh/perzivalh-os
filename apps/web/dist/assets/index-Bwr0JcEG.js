(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var Hh={exports:{}},Ul={},qh={exports:{}},ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var si=Symbol.for("react.element"),bm=Symbol.for("react.portal"),Cm=Symbol.for("react.fragment"),Em=Symbol.for("react.strict_mode"),Am=Symbol.for("react.profiler"),Tm=Symbol.for("react.provider"),Lm=Symbol.for("react.context"),Rm=Symbol.for("react.forward_ref"),Om=Symbol.for("react.suspense"),Pm=Symbol.for("react.memo"),Mm=Symbol.for("react.lazy"),pd=Symbol.iterator;function Im(e){return e===null||typeof e!="object"?null:(e=pd&&e[pd]||e["@@iterator"],typeof e=="function"?e:null)}var Gh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Qh=Object.assign,Kh={};function Jr(e,t,n){this.props=e,this.context=t,this.refs=Kh,this.updater=n||Gh}Jr.prototype.isReactComponent={};Jr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Jr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Yh(){}Yh.prototype=Jr.prototype;function hu(e,t,n){this.props=e,this.context=t,this.refs=Kh,this.updater=n||Gh}var fu=hu.prototype=new Yh;fu.constructor=hu;Qh(fu,Jr.prototype);fu.isPureReactComponent=!0;var md=Array.isArray,Xh=Object.prototype.hasOwnProperty,pu={current:null},Jh={key:!0,ref:!0,__self:!0,__source:!0};function Zh(e,t,n){var r,a={},i=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)Xh.call(t,r)&&!Jh.hasOwnProperty(r)&&(a[r]=t[r]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var u=Array(c),m=0;m<c;m++)u[m]=arguments[m+2];a.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)a[r]===void 0&&(a[r]=c[r]);return{$$typeof:si,type:e,key:i,ref:l,props:a,_owner:pu.current}}function Dm(e,t){return{$$typeof:si,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function mu(e){return typeof e=="object"&&e!==null&&e.$$typeof===si}function Bm(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var gd=/\/+/g;function Oo(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Bm(""+e.key):t.toString(36)}function Zi(e,t,n,r,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case si:case bm:l=!0}}if(l)return l=e,a=a(l),e=r===""?"."+Oo(l,0):r,md(a)?(n="",e!=null&&(n=e.replace(gd,"$&/")+"/"),Zi(a,t,n,"",function(m){return m})):a!=null&&(mu(a)&&(a=Dm(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(gd,"$&/")+"/")+e)),t.push(a)),1;if(l=0,r=r===""?".":r+":",md(e))for(var c=0;c<e.length;c++){i=e[c];var u=r+Oo(i,c);l+=Zi(i,t,n,u,a)}else if(u=Im(e),typeof u=="function")for(e=u.call(e),c=0;!(i=e.next()).done;)i=i.value,u=r+Oo(i,c++),l+=Zi(i,t,n,u,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Ri(e,t,n){if(e==null)return e;var r=[],a=0;return Zi(e,r,"","",function(i){return t.call(n,i,a++)}),r}function zm(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ot={current:null},el={transition:null},$m={ReactCurrentDispatcher:Ot,ReactCurrentBatchConfig:el,ReactCurrentOwner:pu};function ef(){throw Error("act(...) is not supported in production builds of React.")}ye.Children={map:Ri,forEach:function(e,t,n){Ri(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ri(e,function(){t++}),t},toArray:function(e){return Ri(e,function(t){return t})||[]},only:function(e){if(!mu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ye.Component=Jr;ye.Fragment=Cm;ye.Profiler=Am;ye.PureComponent=hu;ye.StrictMode=Em;ye.Suspense=Om;ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$m;ye.act=ef;ye.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Qh({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=pu.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)Xh.call(t,u)&&!Jh.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&c!==void 0?c[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var m=0;m<u;m++)c[m]=arguments[m+2];r.children=c}return{$$typeof:si,type:e.type,key:a,ref:i,props:r,_owner:l}};ye.createContext=function(e){return e={$$typeof:Lm,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Tm,_context:e},e.Consumer=e};ye.createElement=Zh;ye.createFactory=function(e){var t=Zh.bind(null,e);return t.type=e,t};ye.createRef=function(){return{current:null}};ye.forwardRef=function(e){return{$$typeof:Rm,render:e}};ye.isValidElement=mu;ye.lazy=function(e){return{$$typeof:Mm,_payload:{_status:-1,_result:e},_init:zm}};ye.memo=function(e,t){return{$$typeof:Pm,type:e,compare:t===void 0?null:t}};ye.startTransition=function(e){var t=el.transition;el.transition={};try{e()}finally{el.transition=t}};ye.unstable_act=ef;ye.useCallback=function(e,t){return Ot.current.useCallback(e,t)};ye.useContext=function(e){return Ot.current.useContext(e)};ye.useDebugValue=function(){};ye.useDeferredValue=function(e){return Ot.current.useDeferredValue(e)};ye.useEffect=function(e,t){return Ot.current.useEffect(e,t)};ye.useId=function(){return Ot.current.useId()};ye.useImperativeHandle=function(e,t,n){return Ot.current.useImperativeHandle(e,t,n)};ye.useInsertionEffect=function(e,t){return Ot.current.useInsertionEffect(e,t)};ye.useLayoutEffect=function(e,t){return Ot.current.useLayoutEffect(e,t)};ye.useMemo=function(e,t){return Ot.current.useMemo(e,t)};ye.useReducer=function(e,t,n){return Ot.current.useReducer(e,t,n)};ye.useRef=function(e){return Ot.current.useRef(e)};ye.useState=function(e){return Ot.current.useState(e)};ye.useSyncExternalStore=function(e,t,n){return Ot.current.useSyncExternalStore(e,t,n)};ye.useTransition=function(){return Ot.current.useTransition()};ye.version="18.3.1";qh.exports=ye;var h=qh.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Um=h,Vm=Symbol.for("react.element"),Fm=Symbol.for("react.fragment"),Wm=Object.prototype.hasOwnProperty,Hm=Um.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qm={key:!0,ref:!0,__self:!0,__source:!0};function tf(e,t,n){var r,a={},i=null,l=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)Wm.call(t,r)&&!qm.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Vm,type:e,key:i,ref:l,props:a,_owner:Hm.current}}Ul.Fragment=Fm;Ul.jsx=tf;Ul.jsxs=tf;Hh.exports=Ul;var s=Hh.exports,nf={exports:{}},Kt={},sf={exports:{}},rf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,te){var Z=W.length;W.push(te);e:for(;0<Z;){var ce=Z-1>>>1,oe=W[ce];if(0<a(oe,te))W[ce]=te,W[Z]=oe,Z=ce;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var te=W[0],Z=W.pop();if(Z!==te){W[0]=Z;e:for(var ce=0,oe=W.length,Oe=oe>>>1;ce<Oe;){var A=2*(ce+1)-1,q=W[A],b=A+1,U=W[b];if(0>a(q,Z))b<oe&&0>a(U,q)?(W[ce]=U,W[b]=Z,ce=b):(W[ce]=q,W[A]=Z,ce=A);else if(b<oe&&0>a(U,Z))W[ce]=U,W[b]=Z,ce=b;else break e}}return te}function a(W,te){var Z=W.sortIndex-te.sortIndex;return Z!==0?Z:W.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var u=[],m=[],S=1,v=null,x=3,E=!1,L=!1,O=!1,g=typeof setTimeout=="function"?setTimeout:null,f=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(W){for(var te=n(m);te!==null;){if(te.callback===null)r(m);else if(te.startTime<=W)r(m),te.sortIndex=te.expirationTime,t(u,te);else break;te=n(m)}}function k(W){if(O=!1,j(W),!L)if(n(u)!==null)L=!0,Te(P);else{var te=n(m);te!==null&&Xe(k,te.startTime-W)}}function P(W,te){L=!1,O&&(O=!1,f(w),w=-1),E=!0;var Z=x;try{for(j(te),v=n(u);v!==null&&(!(v.expirationTime>te)||W&&!X());){var ce=v.callback;if(typeof ce=="function"){v.callback=null,x=v.priorityLevel;var oe=ce(v.expirationTime<=te);te=e.unstable_now(),typeof oe=="function"?v.callback=oe:v===n(u)&&r(u),j(te)}else r(u);v=n(u)}if(v!==null)var Oe=!0;else{var A=n(m);A!==null&&Xe(k,A.startTime-te),Oe=!1}return Oe}finally{v=null,x=Z,E=!1}}var $=!1,B=null,w=-1,D=5,R=-1;function X(){return!(e.unstable_now()-R<D)}function he(){if(B!==null){var W=e.unstable_now();R=W;var te=!0;try{te=B(!0,W)}finally{te?je():($=!1,B=null)}}else $=!1}var je;if(typeof p=="function")je=function(){p(he)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Re=Ee.port2;Ee.port1.onmessage=he,je=function(){Re.postMessage(null)}}else je=function(){g(he,0)};function Te(W){B=W,$||($=!0,je())}function Xe(W,te){w=g(function(){W(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){L||E||(L=!0,Te(P))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(W){switch(x){case 1:case 2:case 3:var te=3;break;default:te=x}var Z=x;x=te;try{return W()}finally{x=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,te){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Z=x;x=W;try{return te()}finally{x=Z}},e.unstable_scheduleCallback=function(W,te,Z){var ce=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ce+Z:ce):Z=ce,W){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=Z+oe,W={id:S++,callback:te,priorityLevel:W,startTime:Z,expirationTime:oe,sortIndex:-1},Z>ce?(W.sortIndex=Z,t(m,W),n(u)===null&&W===n(m)&&(O?(f(w),w=-1):O=!0,Xe(k,Z-ce))):(W.sortIndex=oe,t(u,W),L||E||(L=!0,Te(P))),W},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(W){var te=x;return function(){var Z=x;x=te;try{return W.apply(this,arguments)}finally{x=Z}}}})(rf);sf.exports=rf;var Gm=sf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qm=h,Qt=Gm;function z(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var af=new Set,$a={};function gr(e,t){Hr(e,t),Hr(e+"Capture",t)}function Hr(e,t){for($a[e]=t,e=0;e<t.length;e++)af.add(t[e])}var cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hc=Object.prototype.hasOwnProperty,Km=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vd={},xd={};function Ym(e){return hc.call(xd,e)?!0:hc.call(vd,e)?!1:Km.test(e)?xd[e]=!0:(vd[e]=!0,!1)}function Xm(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Jm(e,t,n,r){if(t===null||typeof t>"u"||Xm(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Pt(e,t,n,r,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ft[e]=new Pt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ft[t]=new Pt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ft[e]=new Pt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ft[e]=new Pt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ft[e]=new Pt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ft[e]=new Pt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ft[e]=new Pt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ft[e]=new Pt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ft[e]=new Pt(e,5,!1,e.toLowerCase(),null,!1,!1)});var gu=/[\-:]([a-z])/g;function vu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(gu,vu);ft[t]=new Pt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(gu,vu);ft[t]=new Pt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(gu,vu);ft[t]=new Pt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ft[e]=new Pt(e,1,!1,e.toLowerCase(),null,!1,!1)});ft.xlinkHref=new Pt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ft[e]=new Pt(e,1,!1,e.toLowerCase(),null,!0,!0)});function xu(e,t,n,r){var a=ft.hasOwnProperty(t)?ft[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Jm(t,n,a,r)&&(n=null),r||a===null?Ym(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var fs=Qm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oi=Symbol.for("react.element"),Cr=Symbol.for("react.portal"),Er=Symbol.for("react.fragment"),yu=Symbol.for("react.strict_mode"),fc=Symbol.for("react.profiler"),lf=Symbol.for("react.provider"),of=Symbol.for("react.context"),ju=Symbol.for("react.forward_ref"),pc=Symbol.for("react.suspense"),mc=Symbol.for("react.suspense_list"),Nu=Symbol.for("react.memo"),ks=Symbol.for("react.lazy"),cf=Symbol.for("react.offscreen"),yd=Symbol.iterator;function ga(e){return e===null||typeof e!="object"?null:(e=yd&&e[yd]||e["@@iterator"],typeof e=="function"?e:null)}var Fe=Object.assign,Po;function ka(e){if(Po===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Po=t&&t[1]||""}return`
`+Po+e}var Mo=!1;function Io(e,t){if(!e||Mo)return"";Mo=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(m){var r=m}Reflect.construct(e,[],t)}else{try{t.call()}catch(m){r=m}e.call(t.prototype)}else{try{throw Error()}catch(m){r=m}e()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var a=m.stack.split(`
`),i=r.stack.split(`
`),l=a.length-1,c=i.length-1;1<=l&&0<=c&&a[l]!==i[c];)c--;for(;1<=l&&0<=c;l--,c--)if(a[l]!==i[c]){if(l!==1||c!==1)do if(l--,c--,0>c||a[l]!==i[c]){var u=`
`+a[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=c);break}}}finally{Mo=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ka(e):""}function Zm(e){switch(e.tag){case 5:return ka(e.type);case 16:return ka("Lazy");case 13:return ka("Suspense");case 19:return ka("SuspenseList");case 0:case 2:case 15:return e=Io(e.type,!1),e;case 11:return e=Io(e.type.render,!1),e;case 1:return e=Io(e.type,!0),e;default:return""}}function gc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Er:return"Fragment";case Cr:return"Portal";case fc:return"Profiler";case yu:return"StrictMode";case pc:return"Suspense";case mc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case of:return(e.displayName||"Context")+".Consumer";case lf:return(e._context.displayName||"Context")+".Provider";case ju:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Nu:return t=e.displayName||null,t!==null?t:gc(e.type)||"Memo";case ks:t=e._payload,e=e._init;try{return gc(e(t))}catch{}}return null}function eg(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gc(t);case 8:return t===yu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function $s(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function uf(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function tg(e){var t=uf(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){r=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Pi(e){e._valueTracker||(e._valueTracker=tg(e))}function df(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=uf(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ml(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function vc(e,t){var n=t.checked;return Fe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function jd(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=$s(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function hf(e,t){t=t.checked,t!=null&&xu(e,"checked",t,!1)}function xc(e,t){hf(e,t);var n=$s(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?yc(e,t.type,n):t.hasOwnProperty("defaultValue")&&yc(e,t.type,$s(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Nd(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function yc(e,t,n){(t!=="number"||ml(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ba=Array.isArray;function zr(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+$s(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function jc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(z(91));return Fe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function wd(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(z(92));if(ba(n)){if(1<n.length)throw Error(z(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:$s(n)}}function ff(e,t){var n=$s(t.value),r=$s(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function _d(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function pf(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?pf(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Mi,mf=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Mi=Mi||document.createElement("div"),Mi.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Mi.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ua(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ta={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ng=["Webkit","ms","Moz","O"];Object.keys(Ta).forEach(function(e){ng.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ta[t]=Ta[e]})});function gf(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ta.hasOwnProperty(e)&&Ta[e]?(""+t).trim():t+"px"}function vf(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=gf(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var sg=Fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wc(e,t){if(t){if(sg[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(z(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(z(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(z(61))}if(t.style!=null&&typeof t.style!="object")throw Error(z(62))}}function _c(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sc=null;function wu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var kc=null,$r=null,Ur=null;function Sd(e){if(e=ii(e)){if(typeof kc!="function")throw Error(z(280));var t=e.stateNode;t&&(t=ql(t),kc(e.stateNode,e.type,t))}}function xf(e){$r?Ur?Ur.push(e):Ur=[e]:$r=e}function yf(){if($r){var e=$r,t=Ur;if(Ur=$r=null,Sd(e),t)for(e=0;e<t.length;e++)Sd(t[e])}}function jf(e,t){return e(t)}function Nf(){}var Do=!1;function wf(e,t,n){if(Do)return e(t,n);Do=!0;try{return jf(e,t,n)}finally{Do=!1,($r!==null||Ur!==null)&&(Nf(),yf())}}function Va(e,t){var n=e.stateNode;if(n===null)return null;var r=ql(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(z(231,t,typeof n));return n}var bc=!1;if(cs)try{var va={};Object.defineProperty(va,"passive",{get:function(){bc=!0}}),window.addEventListener("test",va,va),window.removeEventListener("test",va,va)}catch{bc=!1}function rg(e,t,n,r,a,i,l,c,u){var m=Array.prototype.slice.call(arguments,3);try{t.apply(n,m)}catch(S){this.onError(S)}}var La=!1,gl=null,vl=!1,Cc=null,ag={onError:function(e){La=!0,gl=e}};function ig(e,t,n,r,a,i,l,c,u){La=!1,gl=null,rg.apply(ag,arguments)}function lg(e,t,n,r,a,i,l,c,u){if(ig.apply(this,arguments),La){if(La){var m=gl;La=!1,gl=null}else throw Error(z(198));vl||(vl=!0,Cc=m)}}function vr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function _f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function kd(e){if(vr(e)!==e)throw Error(z(188))}function og(e){var t=e.alternate;if(!t){if(t=vr(e),t===null)throw Error(z(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return kd(a),e;if(i===r)return kd(a),t;i=i.sibling}throw Error(z(188))}if(n.return!==r.return)n=a,r=i;else{for(var l=!1,c=a.child;c;){if(c===n){l=!0,n=a,r=i;break}if(c===r){l=!0,r=a,n=i;break}c=c.sibling}if(!l){for(c=i.child;c;){if(c===n){l=!0,n=i,r=a;break}if(c===r){l=!0,r=i,n=a;break}c=c.sibling}if(!l)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?e:t}function Sf(e){return e=og(e),e!==null?kf(e):null}function kf(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=kf(e);if(t!==null)return t;e=e.sibling}return null}var bf=Qt.unstable_scheduleCallback,bd=Qt.unstable_cancelCallback,cg=Qt.unstable_shouldYield,ug=Qt.unstable_requestPaint,He=Qt.unstable_now,dg=Qt.unstable_getCurrentPriorityLevel,_u=Qt.unstable_ImmediatePriority,Cf=Qt.unstable_UserBlockingPriority,xl=Qt.unstable_NormalPriority,hg=Qt.unstable_LowPriority,Ef=Qt.unstable_IdlePriority,Vl=null,Bn=null;function fg(e){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(Vl,e,void 0,(e.current.flags&128)===128)}catch{}}var jn=Math.clz32?Math.clz32:gg,pg=Math.log,mg=Math.LN2;function gg(e){return e>>>=0,e===0?32:31-(pg(e)/mg|0)|0}var Ii=64,Di=4194304;function Ca(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function yl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,l=n&268435455;if(l!==0){var c=l&~a;c!==0?r=Ca(c):(i&=l,i!==0&&(r=Ca(i)))}else l=n&~a,l!==0?r=Ca(l):i!==0&&(r=Ca(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-jn(t),a=1<<n,r|=e[n],t&=~a;return r}function vg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xg(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-jn(i),c=1<<l,u=a[l];u===-1?(!(c&n)||c&r)&&(a[l]=vg(c,t)):u<=t&&(e.expiredLanes|=c),i&=~c}}function Ec(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Af(){var e=Ii;return Ii<<=1,!(Ii&4194240)&&(Ii=64),e}function Bo(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ri(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-jn(t),e[t]=n}function yg(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-jn(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}function Su(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-jn(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var Ae=0;function Tf(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Lf,ku,Rf,Of,Pf,Ac=!1,Bi=[],Ls=null,Rs=null,Os=null,Fa=new Map,Wa=new Map,Cs=[],jg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cd(e,t){switch(e){case"focusin":case"focusout":Ls=null;break;case"dragenter":case"dragleave":Rs=null;break;case"mouseover":case"mouseout":Os=null;break;case"pointerover":case"pointerout":Fa.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wa.delete(t.pointerId)}}function xa(e,t,n,r,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},t!==null&&(t=ii(t),t!==null&&ku(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Ng(e,t,n,r,a){switch(t){case"focusin":return Ls=xa(Ls,e,t,n,r,a),!0;case"dragenter":return Rs=xa(Rs,e,t,n,r,a),!0;case"mouseover":return Os=xa(Os,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Fa.set(i,xa(Fa.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Wa.set(i,xa(Wa.get(i)||null,e,t,n,r,a)),!0}return!1}function Mf(e){var t=ir(e.target);if(t!==null){var n=vr(t);if(n!==null){if(t=n.tag,t===13){if(t=_f(n),t!==null){e.blockedOn=t,Pf(e.priority,function(){Rf(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function tl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Tc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Sc=r,n.target.dispatchEvent(r),Sc=null}else return t=ii(n),t!==null&&ku(t),e.blockedOn=n,!1;t.shift()}return!0}function Ed(e,t,n){tl(e)&&n.delete(t)}function wg(){Ac=!1,Ls!==null&&tl(Ls)&&(Ls=null),Rs!==null&&tl(Rs)&&(Rs=null),Os!==null&&tl(Os)&&(Os=null),Fa.forEach(Ed),Wa.forEach(Ed)}function ya(e,t){e.blockedOn===t&&(e.blockedOn=null,Ac||(Ac=!0,Qt.unstable_scheduleCallback(Qt.unstable_NormalPriority,wg)))}function Ha(e){function t(a){return ya(a,e)}if(0<Bi.length){ya(Bi[0],e);for(var n=1;n<Bi.length;n++){var r=Bi[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ls!==null&&ya(Ls,e),Rs!==null&&ya(Rs,e),Os!==null&&ya(Os,e),Fa.forEach(t),Wa.forEach(t),n=0;n<Cs.length;n++)r=Cs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Cs.length&&(n=Cs[0],n.blockedOn===null);)Mf(n),n.blockedOn===null&&Cs.shift()}var Vr=fs.ReactCurrentBatchConfig,jl=!0;function _g(e,t,n,r){var a=Ae,i=Vr.transition;Vr.transition=null;try{Ae=1,bu(e,t,n,r)}finally{Ae=a,Vr.transition=i}}function Sg(e,t,n,r){var a=Ae,i=Vr.transition;Vr.transition=null;try{Ae=4,bu(e,t,n,r)}finally{Ae=a,Vr.transition=i}}function bu(e,t,n,r){if(jl){var a=Tc(e,t,n,r);if(a===null)Qo(e,t,r,Nl,n),Cd(e,r);else if(Ng(a,e,t,n,r))r.stopPropagation();else if(Cd(e,r),t&4&&-1<jg.indexOf(e)){for(;a!==null;){var i=ii(a);if(i!==null&&Lf(i),i=Tc(e,t,n,r),i===null&&Qo(e,t,r,Nl,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else Qo(e,t,r,null,n)}}var Nl=null;function Tc(e,t,n,r){if(Nl=null,e=wu(r),e=ir(e),e!==null)if(t=vr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=_f(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Nl=e,null}function If(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dg()){case _u:return 1;case Cf:return 4;case xl:case hg:return 16;case Ef:return 536870912;default:return 16}default:return 16}}var As=null,Cu=null,nl=null;function Df(){if(nl)return nl;var e,t=Cu,n=t.length,r,a="value"in As?As.value:As.textContent,i=a.length;for(e=0;e<n&&t[e]===a[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===a[i-r];r++);return nl=a.slice(e,1<r?1-r:void 0)}function sl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function zi(){return!0}function Ad(){return!1}function Yt(e){function t(n,r,a,i,l){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?zi:Ad,this.isPropagationStopped=Ad,this}return Fe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zi)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zi)},persist:function(){},isPersistent:zi}),t}var Zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eu=Yt(Zr),ai=Fe({},Zr,{view:0,detail:0}),kg=Yt(ai),zo,$o,ja,Fl=Fe({},ai,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Au,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ja&&(ja&&e.type==="mousemove"?(zo=e.screenX-ja.screenX,$o=e.screenY-ja.screenY):$o=zo=0,ja=e),zo)},movementY:function(e){return"movementY"in e?e.movementY:$o}}),Td=Yt(Fl),bg=Fe({},Fl,{dataTransfer:0}),Cg=Yt(bg),Eg=Fe({},ai,{relatedTarget:0}),Uo=Yt(Eg),Ag=Fe({},Zr,{animationName:0,elapsedTime:0,pseudoElement:0}),Tg=Yt(Ag),Lg=Fe({},Zr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Rg=Yt(Lg),Og=Fe({},Zr,{data:0}),Ld=Yt(Og),Pg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ig={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dg(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Ig[e])?!!t[e]:!1}function Au(){return Dg}var Bg=Fe({},ai,{key:function(e){if(e.key){var t=Pg[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=sl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Mg[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Au,charCode:function(e){return e.type==="keypress"?sl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?sl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),zg=Yt(Bg),$g=Fe({},Fl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rd=Yt($g),Ug=Fe({},ai,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Au}),Vg=Yt(Ug),Fg=Fe({},Zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wg=Yt(Fg),Hg=Fe({},Fl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qg=Yt(Hg),Gg=[9,13,27,32],Tu=cs&&"CompositionEvent"in window,Ra=null;cs&&"documentMode"in document&&(Ra=document.documentMode);var Qg=cs&&"TextEvent"in window&&!Ra,Bf=cs&&(!Tu||Ra&&8<Ra&&11>=Ra),Od=" ",Pd=!1;function zf(e,t){switch(e){case"keyup":return Gg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $f(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ar=!1;function Kg(e,t){switch(e){case"compositionend":return $f(t);case"keypress":return t.which!==32?null:(Pd=!0,Od);case"textInput":return e=t.data,e===Od&&Pd?null:e;default:return null}}function Yg(e,t){if(Ar)return e==="compositionend"||!Tu&&zf(e,t)?(e=Df(),nl=Cu=As=null,Ar=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bf&&t.locale!=="ko"?null:t.data;default:return null}}var Xg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Md(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xg[e.type]:t==="textarea"}function Uf(e,t,n,r){xf(r),t=wl(t,"onChange"),0<t.length&&(n=new Eu("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Oa=null,qa=null;function Jg(e){Jf(e,0)}function Wl(e){var t=Rr(e);if(df(t))return e}function Zg(e,t){if(e==="change")return t}var Vf=!1;if(cs){var Vo;if(cs){var Fo="oninput"in document;if(!Fo){var Id=document.createElement("div");Id.setAttribute("oninput","return;"),Fo=typeof Id.oninput=="function"}Vo=Fo}else Vo=!1;Vf=Vo&&(!document.documentMode||9<document.documentMode)}function Dd(){Oa&&(Oa.detachEvent("onpropertychange",Ff),qa=Oa=null)}function Ff(e){if(e.propertyName==="value"&&Wl(qa)){var t=[];Uf(t,qa,e,wu(e)),wf(Jg,t)}}function ev(e,t,n){e==="focusin"?(Dd(),Oa=t,qa=n,Oa.attachEvent("onpropertychange",Ff)):e==="focusout"&&Dd()}function tv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Wl(qa)}function nv(e,t){if(e==="click")return Wl(t)}function sv(e,t){if(e==="input"||e==="change")return Wl(t)}function rv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var wn=typeof Object.is=="function"?Object.is:rv;function Ga(e,t){if(wn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!hc.call(t,a)||!wn(e[a],t[a]))return!1}return!0}function Bd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function zd(e,t){var n=Bd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Bd(n)}}function Wf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Wf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Hf(){for(var e=window,t=ml();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ml(e.document)}return t}function Lu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function av(e){var t=Hf(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Wf(n.ownerDocument.documentElement,n)){if(r!==null&&Lu(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=zd(n,i);var l=zd(n,r);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var iv=cs&&"documentMode"in document&&11>=document.documentMode,Tr=null,Lc=null,Pa=null,Rc=!1;function $d(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Rc||Tr==null||Tr!==ml(r)||(r=Tr,"selectionStart"in r&&Lu(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Pa&&Ga(Pa,r)||(Pa=r,r=wl(Lc,"onSelect"),0<r.length&&(t=new Eu("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Tr)))}function $i(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Lr={animationend:$i("Animation","AnimationEnd"),animationiteration:$i("Animation","AnimationIteration"),animationstart:$i("Animation","AnimationStart"),transitionend:$i("Transition","TransitionEnd")},Wo={},qf={};cs&&(qf=document.createElement("div").style,"AnimationEvent"in window||(delete Lr.animationend.animation,delete Lr.animationiteration.animation,delete Lr.animationstart.animation),"TransitionEvent"in window||delete Lr.transitionend.transition);function Hl(e){if(Wo[e])return Wo[e];if(!Lr[e])return e;var t=Lr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in qf)return Wo[e]=t[n];return e}var Gf=Hl("animationend"),Qf=Hl("animationiteration"),Kf=Hl("animationstart"),Yf=Hl("transitionend"),Xf=new Map,Ud="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vs(e,t){Xf.set(e,t),gr(t,[e])}for(var Ho=0;Ho<Ud.length;Ho++){var qo=Ud[Ho],lv=qo.toLowerCase(),ov=qo[0].toUpperCase()+qo.slice(1);Vs(lv,"on"+ov)}Vs(Gf,"onAnimationEnd");Vs(Qf,"onAnimationIteration");Vs(Kf,"onAnimationStart");Vs("dblclick","onDoubleClick");Vs("focusin","onFocus");Vs("focusout","onBlur");Vs(Yf,"onTransitionEnd");Hr("onMouseEnter",["mouseout","mouseover"]);Hr("onMouseLeave",["mouseout","mouseover"]);Hr("onPointerEnter",["pointerout","pointerover"]);Hr("onPointerLeave",["pointerout","pointerover"]);gr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gr("onBeforeInput",["compositionend","keypress","textInput","paste"]);gr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ea="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ea));function Vd(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,lg(r,t,void 0,e),e.currentTarget=null}function Jf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var l=r.length-1;0<=l;l--){var c=r[l],u=c.instance,m=c.currentTarget;if(c=c.listener,u!==i&&a.isPropagationStopped())break e;Vd(a,c,m),i=u}else for(l=0;l<r.length;l++){if(c=r[l],u=c.instance,m=c.currentTarget,c=c.listener,u!==i&&a.isPropagationStopped())break e;Vd(a,c,m),i=u}}}if(vl)throw e=Cc,vl=!1,Cc=null,e}function Ie(e,t){var n=t[Dc];n===void 0&&(n=t[Dc]=new Set);var r=e+"__bubble";n.has(r)||(Zf(t,e,2,!1),n.add(r))}function Go(e,t,n){var r=0;t&&(r|=4),Zf(n,e,r,t)}var Ui="_reactListening"+Math.random().toString(36).slice(2);function Qa(e){if(!e[Ui]){e[Ui]=!0,af.forEach(function(n){n!=="selectionchange"&&(cv.has(n)||Go(n,!1,e),Go(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ui]||(t[Ui]=!0,Go("selectionchange",!1,t))}}function Zf(e,t,n,r){switch(If(t)){case 1:var a=_g;break;case 4:a=Sg;break;default:a=bu}n=a.bind(null,t,n,e),a=void 0,!bc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Qo(e,t,n,r,a){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var c=r.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(l===4)for(l=r.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;l=l.return}for(;c!==null;){if(l=ir(c),l===null)return;if(u=l.tag,u===5||u===6){r=i=l;continue e}c=c.parentNode}}r=r.return}wf(function(){var m=i,S=wu(n),v=[];e:{var x=Xf.get(e);if(x!==void 0){var E=Eu,L=e;switch(e){case"keypress":if(sl(n)===0)break e;case"keydown":case"keyup":E=zg;break;case"focusin":L="focus",E=Uo;break;case"focusout":L="blur",E=Uo;break;case"beforeblur":case"afterblur":E=Uo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=Td;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=Cg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=Vg;break;case Gf:case Qf:case Kf:E=Tg;break;case Yf:E=Wg;break;case"scroll":E=kg;break;case"wheel":E=qg;break;case"copy":case"cut":case"paste":E=Rg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=Rd}var O=(t&4)!==0,g=!O&&e==="scroll",f=O?x!==null?x+"Capture":null:x;O=[];for(var p=m,j;p!==null;){j=p;var k=j.stateNode;if(j.tag===5&&k!==null&&(j=k,f!==null&&(k=Va(p,f),k!=null&&O.push(Ka(p,k,j)))),g)break;p=p.return}0<O.length&&(x=new E(x,L,null,n,S),v.push({event:x,listeners:O}))}}if(!(t&7)){e:{if(x=e==="mouseover"||e==="pointerover",E=e==="mouseout"||e==="pointerout",x&&n!==Sc&&(L=n.relatedTarget||n.fromElement)&&(ir(L)||L[us]))break e;if((E||x)&&(x=S.window===S?S:(x=S.ownerDocument)?x.defaultView||x.parentWindow:window,E?(L=n.relatedTarget||n.toElement,E=m,L=L?ir(L):null,L!==null&&(g=vr(L),L!==g||L.tag!==5&&L.tag!==6)&&(L=null)):(E=null,L=m),E!==L)){if(O=Td,k="onMouseLeave",f="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(O=Rd,k="onPointerLeave",f="onPointerEnter",p="pointer"),g=E==null?x:Rr(E),j=L==null?x:Rr(L),x=new O(k,p+"leave",E,n,S),x.target=g,x.relatedTarget=j,k=null,ir(S)===m&&(O=new O(f,p+"enter",L,n,S),O.target=j,O.relatedTarget=g,k=O),g=k,E&&L)t:{for(O=E,f=L,p=0,j=O;j;j=kr(j))p++;for(j=0,k=f;k;k=kr(k))j++;for(;0<p-j;)O=kr(O),p--;for(;0<j-p;)f=kr(f),j--;for(;p--;){if(O===f||f!==null&&O===f.alternate)break t;O=kr(O),f=kr(f)}O=null}else O=null;E!==null&&Fd(v,x,E,O,!1),L!==null&&g!==null&&Fd(v,g,L,O,!0)}}e:{if(x=m?Rr(m):window,E=x.nodeName&&x.nodeName.toLowerCase(),E==="select"||E==="input"&&x.type==="file")var P=Zg;else if(Md(x))if(Vf)P=sv;else{P=tv;var $=ev}else(E=x.nodeName)&&E.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(P=nv);if(P&&(P=P(e,m))){Uf(v,P,n,S);break e}$&&$(e,x,m),e==="focusout"&&($=x._wrapperState)&&$.controlled&&x.type==="number"&&yc(x,"number",x.value)}switch($=m?Rr(m):window,e){case"focusin":(Md($)||$.contentEditable==="true")&&(Tr=$,Lc=m,Pa=null);break;case"focusout":Pa=Lc=Tr=null;break;case"mousedown":Rc=!0;break;case"contextmenu":case"mouseup":case"dragend":Rc=!1,$d(v,n,S);break;case"selectionchange":if(iv)break;case"keydown":case"keyup":$d(v,n,S)}var B;if(Tu)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Ar?zf(e,n)&&(w="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(Bf&&n.locale!=="ko"&&(Ar||w!=="onCompositionStart"?w==="onCompositionEnd"&&Ar&&(B=Df()):(As=S,Cu="value"in As?As.value:As.textContent,Ar=!0)),$=wl(m,w),0<$.length&&(w=new Ld(w,e,null,n,S),v.push({event:w,listeners:$}),B?w.data=B:(B=$f(n),B!==null&&(w.data=B)))),(B=Qg?Kg(e,n):Yg(e,n))&&(m=wl(m,"onBeforeInput"),0<m.length&&(S=new Ld("onBeforeInput","beforeinput",null,n,S),v.push({event:S,listeners:m}),S.data=B))}Jf(v,t)})}function Ka(e,t,n){return{instance:e,listener:t,currentTarget:n}}function wl(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Va(e,n),i!=null&&r.unshift(Ka(e,i,a)),i=Va(e,t),i!=null&&r.push(Ka(e,i,a))),e=e.return}return r}function kr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Fd(e,t,n,r,a){for(var i=t._reactName,l=[];n!==null&&n!==r;){var c=n,u=c.alternate,m=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&m!==null&&(c=m,a?(u=Va(n,i),u!=null&&l.unshift(Ka(n,u,c))):a||(u=Va(n,i),u!=null&&l.push(Ka(n,u,c)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var uv=/\r\n?/g,dv=/\u0000|\uFFFD/g;function Wd(e){return(typeof e=="string"?e:""+e).replace(uv,`
`).replace(dv,"")}function Vi(e,t,n){if(t=Wd(t),Wd(e)!==t&&n)throw Error(z(425))}function _l(){}var Oc=null,Pc=null;function Mc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ic=typeof setTimeout=="function"?setTimeout:void 0,hv=typeof clearTimeout=="function"?clearTimeout:void 0,Hd=typeof Promise=="function"?Promise:void 0,fv=typeof queueMicrotask=="function"?queueMicrotask:typeof Hd<"u"?function(e){return Hd.resolve(null).then(e).catch(pv)}:Ic;function pv(e){setTimeout(function(){throw e})}function Ko(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),Ha(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Ha(t)}function Ps(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function qd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ea=Math.random().toString(36).slice(2),Dn="__reactFiber$"+ea,Ya="__reactProps$"+ea,us="__reactContainer$"+ea,Dc="__reactEvents$"+ea,mv="__reactListeners$"+ea,gv="__reactHandles$"+ea;function ir(e){var t=e[Dn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[us]||n[Dn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=qd(e);e!==null;){if(n=e[Dn])return n;e=qd(e)}return t}e=n,n=e.parentNode}return null}function ii(e){return e=e[Dn]||e[us],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Rr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(z(33))}function ql(e){return e[Ya]||null}var Bc=[],Or=-1;function Fs(e){return{current:e}}function De(e){0>Or||(e.current=Bc[Or],Bc[Or]=null,Or--)}function Me(e,t){Or++,Bc[Or]=e.current,e.current=t}var Us={},wt=Fs(Us),Bt=Fs(!1),dr=Us;function qr(e,t){var n=e.type.contextTypes;if(!n)return Us;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function zt(e){return e=e.childContextTypes,e!=null}function Sl(){De(Bt),De(wt)}function Gd(e,t,n){if(wt.current!==Us)throw Error(z(168));Me(wt,t),Me(Bt,n)}function ep(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(z(108,eg(e)||"Unknown",a));return Fe({},n,r)}function kl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Us,dr=wt.current,Me(wt,e),Me(Bt,Bt.current),!0}function Qd(e,t,n){var r=e.stateNode;if(!r)throw Error(z(169));n?(e=ep(e,t,dr),r.__reactInternalMemoizedMergedChildContext=e,De(Bt),De(wt),Me(wt,e)):De(Bt),Me(Bt,n)}var rs=null,Gl=!1,Yo=!1;function tp(e){rs===null?rs=[e]:rs.push(e)}function vv(e){Gl=!0,tp(e)}function Ws(){if(!Yo&&rs!==null){Yo=!0;var e=0,t=Ae;try{var n=rs;for(Ae=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}rs=null,Gl=!1}catch(a){throw rs!==null&&(rs=rs.slice(e+1)),bf(_u,Ws),a}finally{Ae=t,Yo=!1}}return null}var Pr=[],Mr=0,bl=null,Cl=0,an=[],ln=0,hr=null,is=1,ls="";function rr(e,t){Pr[Mr++]=Cl,Pr[Mr++]=bl,bl=e,Cl=t}function np(e,t,n){an[ln++]=is,an[ln++]=ls,an[ln++]=hr,hr=e;var r=is;e=ls;var a=32-jn(r)-1;r&=~(1<<a),n+=1;var i=32-jn(t)+a;if(30<i){var l=a-a%5;i=(r&(1<<l)-1).toString(32),r>>=l,a-=l,is=1<<32-jn(t)+a|n<<a|r,ls=i+e}else is=1<<i|n<<a|r,ls=e}function Ru(e){e.return!==null&&(rr(e,1),np(e,1,0))}function Ou(e){for(;e===bl;)bl=Pr[--Mr],Pr[Mr]=null,Cl=Pr[--Mr],Pr[Mr]=null;for(;e===hr;)hr=an[--ln],an[ln]=null,ls=an[--ln],an[ln]=null,is=an[--ln],an[ln]=null}var Gt=null,qt=null,$e=!1,yn=null;function sp(e,t){var n=cn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Kd(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Gt=e,qt=Ps(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Gt=e,qt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=hr!==null?{id:is,overflow:ls}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=cn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Gt=e,qt=null,!0):!1;default:return!1}}function zc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function $c(e){if($e){var t=qt;if(t){var n=t;if(!Kd(e,t)){if(zc(e))throw Error(z(418));t=Ps(n.nextSibling);var r=Gt;t&&Kd(e,t)?sp(r,n):(e.flags=e.flags&-4097|2,$e=!1,Gt=e)}}else{if(zc(e))throw Error(z(418));e.flags=e.flags&-4097|2,$e=!1,Gt=e}}}function Yd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Gt=e}function Fi(e){if(e!==Gt)return!1;if(!$e)return Yd(e),$e=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Mc(e.type,e.memoizedProps)),t&&(t=qt)){if(zc(e))throw rp(),Error(z(418));for(;t;)sp(e,t),t=Ps(t.nextSibling)}if(Yd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(z(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){qt=Ps(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}qt=null}}else qt=Gt?Ps(e.stateNode.nextSibling):null;return!0}function rp(){for(var e=qt;e;)e=Ps(e.nextSibling)}function Gr(){qt=Gt=null,$e=!1}function Pu(e){yn===null?yn=[e]:yn.push(e)}var xv=fs.ReactCurrentBatchConfig;function Na(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,e));var a=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var c=a.refs;l===null?delete c[i]:c[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,e))}return e}function Wi(e,t){throw e=Object.prototype.toString.call(t),Error(z(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xd(e){var t=e._init;return t(e._payload)}function ap(e){function t(f,p){if(e){var j=f.deletions;j===null?(f.deletions=[p],f.flags|=16):j.push(p)}}function n(f,p){if(!e)return null;for(;p!==null;)t(f,p),p=p.sibling;return null}function r(f,p){for(f=new Map;p!==null;)p.key!==null?f.set(p.key,p):f.set(p.index,p),p=p.sibling;return f}function a(f,p){return f=Bs(f,p),f.index=0,f.sibling=null,f}function i(f,p,j){return f.index=j,e?(j=f.alternate,j!==null?(j=j.index,j<p?(f.flags|=2,p):j):(f.flags|=2,p)):(f.flags|=1048576,p)}function l(f){return e&&f.alternate===null&&(f.flags|=2),f}function c(f,p,j,k){return p===null||p.tag!==6?(p=sc(j,f.mode,k),p.return=f,p):(p=a(p,j),p.return=f,p)}function u(f,p,j,k){var P=j.type;return P===Er?S(f,p,j.props.children,k,j.key):p!==null&&(p.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===ks&&Xd(P)===p.type)?(k=a(p,j.props),k.ref=Na(f,p,j),k.return=f,k):(k=ul(j.type,j.key,j.props,null,f.mode,k),k.ref=Na(f,p,j),k.return=f,k)}function m(f,p,j,k){return p===null||p.tag!==4||p.stateNode.containerInfo!==j.containerInfo||p.stateNode.implementation!==j.implementation?(p=rc(j,f.mode,k),p.return=f,p):(p=a(p,j.children||[]),p.return=f,p)}function S(f,p,j,k,P){return p===null||p.tag!==7?(p=ur(j,f.mode,k,P),p.return=f,p):(p=a(p,j),p.return=f,p)}function v(f,p,j){if(typeof p=="string"&&p!==""||typeof p=="number")return p=sc(""+p,f.mode,j),p.return=f,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Oi:return j=ul(p.type,p.key,p.props,null,f.mode,j),j.ref=Na(f,null,p),j.return=f,j;case Cr:return p=rc(p,f.mode,j),p.return=f,p;case ks:var k=p._init;return v(f,k(p._payload),j)}if(ba(p)||ga(p))return p=ur(p,f.mode,j,null),p.return=f,p;Wi(f,p)}return null}function x(f,p,j,k){var P=p!==null?p.key:null;if(typeof j=="string"&&j!==""||typeof j=="number")return P!==null?null:c(f,p,""+j,k);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Oi:return j.key===P?u(f,p,j,k):null;case Cr:return j.key===P?m(f,p,j,k):null;case ks:return P=j._init,x(f,p,P(j._payload),k)}if(ba(j)||ga(j))return P!==null?null:S(f,p,j,k,null);Wi(f,j)}return null}function E(f,p,j,k,P){if(typeof k=="string"&&k!==""||typeof k=="number")return f=f.get(j)||null,c(p,f,""+k,P);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Oi:return f=f.get(k.key===null?j:k.key)||null,u(p,f,k,P);case Cr:return f=f.get(k.key===null?j:k.key)||null,m(p,f,k,P);case ks:var $=k._init;return E(f,p,j,$(k._payload),P)}if(ba(k)||ga(k))return f=f.get(j)||null,S(p,f,k,P,null);Wi(p,k)}return null}function L(f,p,j,k){for(var P=null,$=null,B=p,w=p=0,D=null;B!==null&&w<j.length;w++){B.index>w?(D=B,B=null):D=B.sibling;var R=x(f,B,j[w],k);if(R===null){B===null&&(B=D);break}e&&B&&R.alternate===null&&t(f,B),p=i(R,p,w),$===null?P=R:$.sibling=R,$=R,B=D}if(w===j.length)return n(f,B),$e&&rr(f,w),P;if(B===null){for(;w<j.length;w++)B=v(f,j[w],k),B!==null&&(p=i(B,p,w),$===null?P=B:$.sibling=B,$=B);return $e&&rr(f,w),P}for(B=r(f,B);w<j.length;w++)D=E(B,f,w,j[w],k),D!==null&&(e&&D.alternate!==null&&B.delete(D.key===null?w:D.key),p=i(D,p,w),$===null?P=D:$.sibling=D,$=D);return e&&B.forEach(function(X){return t(f,X)}),$e&&rr(f,w),P}function O(f,p,j,k){var P=ga(j);if(typeof P!="function")throw Error(z(150));if(j=P.call(j),j==null)throw Error(z(151));for(var $=P=null,B=p,w=p=0,D=null,R=j.next();B!==null&&!R.done;w++,R=j.next()){B.index>w?(D=B,B=null):D=B.sibling;var X=x(f,B,R.value,k);if(X===null){B===null&&(B=D);break}e&&B&&X.alternate===null&&t(f,B),p=i(X,p,w),$===null?P=X:$.sibling=X,$=X,B=D}if(R.done)return n(f,B),$e&&rr(f,w),P;if(B===null){for(;!R.done;w++,R=j.next())R=v(f,R.value,k),R!==null&&(p=i(R,p,w),$===null?P=R:$.sibling=R,$=R);return $e&&rr(f,w),P}for(B=r(f,B);!R.done;w++,R=j.next())R=E(B,f,w,R.value,k),R!==null&&(e&&R.alternate!==null&&B.delete(R.key===null?w:R.key),p=i(R,p,w),$===null?P=R:$.sibling=R,$=R);return e&&B.forEach(function(he){return t(f,he)}),$e&&rr(f,w),P}function g(f,p,j,k){if(typeof j=="object"&&j!==null&&j.type===Er&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case Oi:e:{for(var P=j.key,$=p;$!==null;){if($.key===P){if(P=j.type,P===Er){if($.tag===7){n(f,$.sibling),p=a($,j.props.children),p.return=f,f=p;break e}}else if($.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===ks&&Xd(P)===$.type){n(f,$.sibling),p=a($,j.props),p.ref=Na(f,$,j),p.return=f,f=p;break e}n(f,$);break}else t(f,$);$=$.sibling}j.type===Er?(p=ur(j.props.children,f.mode,k,j.key),p.return=f,f=p):(k=ul(j.type,j.key,j.props,null,f.mode,k),k.ref=Na(f,p,j),k.return=f,f=k)}return l(f);case Cr:e:{for($=j.key;p!==null;){if(p.key===$)if(p.tag===4&&p.stateNode.containerInfo===j.containerInfo&&p.stateNode.implementation===j.implementation){n(f,p.sibling),p=a(p,j.children||[]),p.return=f,f=p;break e}else{n(f,p);break}else t(f,p);p=p.sibling}p=rc(j,f.mode,k),p.return=f,f=p}return l(f);case ks:return $=j._init,g(f,p,$(j._payload),k)}if(ba(j))return L(f,p,j,k);if(ga(j))return O(f,p,j,k);Wi(f,j)}return typeof j=="string"&&j!==""||typeof j=="number"?(j=""+j,p!==null&&p.tag===6?(n(f,p.sibling),p=a(p,j),p.return=f,f=p):(n(f,p),p=sc(j,f.mode,k),p.return=f,f=p),l(f)):n(f,p)}return g}var Qr=ap(!0),ip=ap(!1),El=Fs(null),Al=null,Ir=null,Mu=null;function Iu(){Mu=Ir=Al=null}function Du(e){var t=El.current;De(El),e._currentValue=t}function Uc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Fr(e,t){Al=e,Mu=Ir=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Dt=!0),e.firstContext=null)}function dn(e){var t=e._currentValue;if(Mu!==e)if(e={context:e,memoizedValue:t,next:null},Ir===null){if(Al===null)throw Error(z(308));Ir=e,Al.dependencies={lanes:0,firstContext:e}}else Ir=Ir.next=e;return t}var lr=null;function Bu(e){lr===null?lr=[e]:lr.push(e)}function lp(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,Bu(t)):(n.next=a.next,a.next=n),t.interleaved=n,ds(e,r)}function ds(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var bs=!1;function zu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function op(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function os(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ms(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ne&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,ds(e,n)}return a=r.interleaved,a===null?(t.next=t,Bu(r)):(t.next=a.next,a.next=t),r.interleaved=t,ds(e,n)}function rl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Su(e,n)}}function Jd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=l:i=i.next=l,n=n.next}while(n!==null);i===null?a=i=t:i=i.next=t}else a=i=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Tl(e,t,n,r){var a=e.updateQueue;bs=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var u=c,m=u.next;u.next=null,l===null?i=m:l.next=m,l=u;var S=e.alternate;S!==null&&(S=S.updateQueue,c=S.lastBaseUpdate,c!==l&&(c===null?S.firstBaseUpdate=m:c.next=m,S.lastBaseUpdate=u))}if(i!==null){var v=a.baseState;l=0,S=m=u=null,c=i;do{var x=c.lane,E=c.eventTime;if((r&x)===x){S!==null&&(S=S.next={eventTime:E,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var L=e,O=c;switch(x=t,E=n,O.tag){case 1:if(L=O.payload,typeof L=="function"){v=L.call(E,v,x);break e}v=L;break e;case 3:L.flags=L.flags&-65537|128;case 0:if(L=O.payload,x=typeof L=="function"?L.call(E,v,x):L,x==null)break e;v=Fe({},v,x);break e;case 2:bs=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,x=a.effects,x===null?a.effects=[c]:x.push(c))}else E={eventTime:E,lane:x,tag:c.tag,payload:c.payload,callback:c.callback,next:null},S===null?(m=S=E,u=v):S=S.next=E,l|=x;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;x=c,c=x.next,x.next=null,a.lastBaseUpdate=x,a.shared.pending=null}}while(!0);if(S===null&&(u=v),a.baseState=u,a.firstBaseUpdate=m,a.lastBaseUpdate=S,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);pr|=l,e.lanes=l,e.memoizedState=v}}function Zd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(z(191,a));a.call(r)}}}var li={},zn=Fs(li),Xa=Fs(li),Ja=Fs(li);function or(e){if(e===li)throw Error(z(174));return e}function $u(e,t){switch(Me(Ja,t),Me(Xa,e),Me(zn,li),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Nc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Nc(t,e)}De(zn),Me(zn,t)}function Kr(){De(zn),De(Xa),De(Ja)}function cp(e){or(Ja.current);var t=or(zn.current),n=Nc(t,e.type);t!==n&&(Me(Xa,e),Me(zn,n))}function Uu(e){Xa.current===e&&(De(zn),De(Xa))}var Ue=Fs(0);function Ll(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Xo=[];function Vu(){for(var e=0;e<Xo.length;e++)Xo[e]._workInProgressVersionPrimary=null;Xo.length=0}var al=fs.ReactCurrentDispatcher,Jo=fs.ReactCurrentBatchConfig,fr=0,Ve=null,et=null,at=null,Rl=!1,Ma=!1,Za=0,yv=0;function yt(){throw Error(z(321))}function Fu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!wn(e[n],t[n]))return!1;return!0}function Wu(e,t,n,r,a,i){if(fr=i,Ve=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,al.current=e===null||e.memoizedState===null?_v:Sv,e=n(r,a),Ma){i=0;do{if(Ma=!1,Za=0,25<=i)throw Error(z(301));i+=1,at=et=null,t.updateQueue=null,al.current=kv,e=n(r,a)}while(Ma)}if(al.current=Ol,t=et!==null&&et.next!==null,fr=0,at=et=Ve=null,Rl=!1,t)throw Error(z(300));return e}function Hu(){var e=Za!==0;return Za=0,e}function Mn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return at===null?Ve.memoizedState=at=e:at=at.next=e,at}function hn(){if(et===null){var e=Ve.alternate;e=e!==null?e.memoizedState:null}else e=et.next;var t=at===null?Ve.memoizedState:at.next;if(t!==null)at=t,et=e;else{if(e===null)throw Error(z(310));et=e,e={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},at===null?Ve.memoizedState=at=e:at=at.next=e}return at}function ei(e,t){return typeof t=="function"?t(e):t}function Zo(e){var t=hn(),n=t.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=e;var r=et,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var c=l=null,u=null,m=i;do{var S=m.lane;if((fr&S)===S)u!==null&&(u=u.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:e(r,m.action);else{var v={lane:S,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};u===null?(c=u=v,l=r):u=u.next=v,Ve.lanes|=S,pr|=S}m=m.next}while(m!==null&&m!==i);u===null?l=r:u.next=c,wn(r,t.memoizedState)||(Dt=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do i=a.lane,Ve.lanes|=i,pr|=i,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ec(e){var t=hn(),n=t.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(a!==null){n.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);wn(i,t.memoizedState)||(Dt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function up(){}function dp(e,t){var n=Ve,r=hn(),a=t(),i=!wn(r.memoizedState,a);if(i&&(r.memoizedState=a,Dt=!0),r=r.queue,qu(pp.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||at!==null&&at.memoizedState.tag&1){if(n.flags|=2048,ti(9,fp.bind(null,n,r,a,t),void 0,null),it===null)throw Error(z(349));fr&30||hp(n,t,a)}return a}function hp(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function fp(e,t,n,r){t.value=n,t.getSnapshot=r,mp(t)&&gp(e)}function pp(e,t,n){return n(function(){mp(t)&&gp(e)})}function mp(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!wn(e,n)}catch{return!0}}function gp(e){var t=ds(e,1);t!==null&&Nn(t,e,1,-1)}function eh(e){var t=Mn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:e},t.queue=e,e=e.dispatch=wv.bind(null,Ve,e),[t.memoizedState,e]}function ti(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function vp(){return hn().memoizedState}function il(e,t,n,r){var a=Mn();Ve.flags|=e,a.memoizedState=ti(1|t,n,void 0,r===void 0?null:r)}function Ql(e,t,n,r){var a=hn();r=r===void 0?null:r;var i=void 0;if(et!==null){var l=et.memoizedState;if(i=l.destroy,r!==null&&Fu(r,l.deps)){a.memoizedState=ti(t,n,i,r);return}}Ve.flags|=e,a.memoizedState=ti(1|t,n,i,r)}function th(e,t){return il(8390656,8,e,t)}function qu(e,t){return Ql(2048,8,e,t)}function xp(e,t){return Ql(4,2,e,t)}function yp(e,t){return Ql(4,4,e,t)}function jp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Np(e,t,n){return n=n!=null?n.concat([e]):null,Ql(4,4,jp.bind(null,t,e),n)}function Gu(){}function wp(e,t){var n=hn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Fu(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function _p(e,t){var n=hn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Fu(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Sp(e,t,n){return fr&21?(wn(n,t)||(n=Af(),Ve.lanes|=n,pr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Dt=!0),e.memoizedState=n)}function jv(e,t){var n=Ae;Ae=n!==0&&4>n?n:4,e(!0);var r=Jo.transition;Jo.transition={};try{e(!1),t()}finally{Ae=n,Jo.transition=r}}function kp(){return hn().memoizedState}function Nv(e,t,n){var r=Ds(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},bp(e))Cp(t,n);else if(n=lp(e,t,n,r),n!==null){var a=Rt();Nn(n,e,r,a),Ep(n,t,r)}}function wv(e,t,n){var r=Ds(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(bp(e))Cp(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,c=i(l,n);if(a.hasEagerState=!0,a.eagerState=c,wn(c,l)){var u=t.interleaved;u===null?(a.next=a,Bu(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}n=lp(e,t,a,r),n!==null&&(a=Rt(),Nn(n,e,r,a),Ep(n,t,r))}}function bp(e){var t=e.alternate;return e===Ve||t!==null&&t===Ve}function Cp(e,t){Ma=Rl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ep(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Su(e,n)}}var Ol={readContext:dn,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useInsertionEffect:yt,useLayoutEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useMutableSource:yt,useSyncExternalStore:yt,useId:yt,unstable_isNewReconciler:!1},_v={readContext:dn,useCallback:function(e,t){return Mn().memoizedState=[e,t===void 0?null:t],e},useContext:dn,useEffect:th,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,il(4194308,4,jp.bind(null,t,e),n)},useLayoutEffect:function(e,t){return il(4194308,4,e,t)},useInsertionEffect:function(e,t){return il(4,2,e,t)},useMemo:function(e,t){var n=Mn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Mn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Nv.bind(null,Ve,e),[r.memoizedState,e]},useRef:function(e){var t=Mn();return e={current:e},t.memoizedState=e},useState:eh,useDebugValue:Gu,useDeferredValue:function(e){return Mn().memoizedState=e},useTransition:function(){var e=eh(!1),t=e[0];return e=jv.bind(null,e[1]),Mn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ve,a=Mn();if($e){if(n===void 0)throw Error(z(407));n=n()}else{if(n=t(),it===null)throw Error(z(349));fr&30||hp(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,th(pp.bind(null,r,i,e),[e]),r.flags|=2048,ti(9,fp.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Mn(),t=it.identifierPrefix;if($e){var n=ls,r=is;n=(r&~(1<<32-jn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Za++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=yv++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Sv={readContext:dn,useCallback:wp,useContext:dn,useEffect:qu,useImperativeHandle:Np,useInsertionEffect:xp,useLayoutEffect:yp,useMemo:_p,useReducer:Zo,useRef:vp,useState:function(){return Zo(ei)},useDebugValue:Gu,useDeferredValue:function(e){var t=hn();return Sp(t,et.memoizedState,e)},useTransition:function(){var e=Zo(ei)[0],t=hn().memoizedState;return[e,t]},useMutableSource:up,useSyncExternalStore:dp,useId:kp,unstable_isNewReconciler:!1},kv={readContext:dn,useCallback:wp,useContext:dn,useEffect:qu,useImperativeHandle:Np,useInsertionEffect:xp,useLayoutEffect:yp,useMemo:_p,useReducer:ec,useRef:vp,useState:function(){return ec(ei)},useDebugValue:Gu,useDeferredValue:function(e){var t=hn();return et===null?t.memoizedState=e:Sp(t,et.memoizedState,e)},useTransition:function(){var e=ec(ei)[0],t=hn().memoizedState;return[e,t]},useMutableSource:up,useSyncExternalStore:dp,useId:kp,unstable_isNewReconciler:!1};function gn(e,t){if(e&&e.defaultProps){t=Fe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Vc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Fe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Kl={isMounted:function(e){return(e=e._reactInternals)?vr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Rt(),a=Ds(e),i=os(r,a);i.payload=t,n!=null&&(i.callback=n),t=Ms(e,i,a),t!==null&&(Nn(t,e,a,r),rl(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Rt(),a=Ds(e),i=os(r,a);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Ms(e,i,a),t!==null&&(Nn(t,e,a,r),rl(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Rt(),r=Ds(e),a=os(n,r);a.tag=2,t!=null&&(a.callback=t),t=Ms(e,a,r),t!==null&&(Nn(t,e,r,n),rl(t,e,r))}};function nh(e,t,n,r,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,l):t.prototype&&t.prototype.isPureReactComponent?!Ga(n,r)||!Ga(a,i):!0}function Ap(e,t,n){var r=!1,a=Us,i=t.contextType;return typeof i=="object"&&i!==null?i=dn(i):(a=zt(t)?dr:wt.current,r=t.contextTypes,i=(r=r!=null)?qr(e,a):Us),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Kl,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function sh(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Kl.enqueueReplaceState(t,t.state,null)}function Fc(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},zu(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=dn(i):(i=zt(t)?dr:wt.current,a.context=qr(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Vc(e,t,i,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Kl.enqueueReplaceState(a,a.state,null),Tl(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Yr(e,t){try{var n="",r=t;do n+=Zm(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function tc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Wc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var bv=typeof WeakMap=="function"?WeakMap:Map;function Tp(e,t,n){n=os(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ml||(Ml=!0,eu=r),Wc(e,t)},n}function Lp(e,t,n){n=os(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){Wc(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Wc(e,t),typeof r!="function"&&(Is===null?Is=new Set([this]):Is.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function rh(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new bv;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=$v.bind(null,e,t,n),t.then(e,e))}function ah(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ih(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=os(-1,1),t.tag=2,Ms(n,t,1))),n.lanes|=1),e)}var Cv=fs.ReactCurrentOwner,Dt=!1;function Lt(e,t,n,r){t.child=e===null?ip(t,null,n,r):Qr(t,e.child,n,r)}function lh(e,t,n,r,a){n=n.render;var i=t.ref;return Fr(t,a),r=Wu(e,t,n,r,i,a),n=Hu(),e!==null&&!Dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,hs(e,t,a)):($e&&n&&Ru(t),t.flags|=1,Lt(e,t,r,a),t.child)}function oh(e,t,n,r,a){if(e===null){var i=n.type;return typeof i=="function"&&!td(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Rp(e,t,i,r,a)):(e=ul(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ga,n(l,r)&&e.ref===t.ref)return hs(e,t,a)}return t.flags|=1,e=Bs(i,r),e.ref=t.ref,e.return=t,t.child=e}function Rp(e,t,n,r,a){if(e!==null){var i=e.memoizedProps;if(Ga(i,r)&&e.ref===t.ref)if(Dt=!1,t.pendingProps=r=i,(e.lanes&a)!==0)e.flags&131072&&(Dt=!0);else return t.lanes=e.lanes,hs(e,t,a)}return Hc(e,t,n,r,a)}function Op(e,t,n){var r=t.pendingProps,a=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Me(Br,Ht),Ht|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Me(Br,Ht),Ht|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Me(Br,Ht),Ht|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Me(Br,Ht),Ht|=r;return Lt(e,t,a,n),t.child}function Pp(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Hc(e,t,n,r,a){var i=zt(n)?dr:wt.current;return i=qr(t,i),Fr(t,a),n=Wu(e,t,n,r,i,a),r=Hu(),e!==null&&!Dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,hs(e,t,a)):($e&&r&&Ru(t),t.flags|=1,Lt(e,t,n,a),t.child)}function ch(e,t,n,r,a){if(zt(n)){var i=!0;kl(t)}else i=!1;if(Fr(t,a),t.stateNode===null)ll(e,t),Ap(t,n,r),Fc(t,n,r,a),r=!0;else if(e===null){var l=t.stateNode,c=t.memoizedProps;l.props=c;var u=l.context,m=n.contextType;typeof m=="object"&&m!==null?m=dn(m):(m=zt(n)?dr:wt.current,m=qr(t,m));var S=n.getDerivedStateFromProps,v=typeof S=="function"||typeof l.getSnapshotBeforeUpdate=="function";v||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==r||u!==m)&&sh(t,l,r,m),bs=!1;var x=t.memoizedState;l.state=x,Tl(t,r,l,a),u=t.memoizedState,c!==r||x!==u||Bt.current||bs?(typeof S=="function"&&(Vc(t,n,S,r),u=t.memoizedState),(c=bs||nh(t,n,c,r,x,u,m))?(v||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),l.props=r,l.state=u,l.context=m,r=c):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,op(e,t),c=t.memoizedProps,m=t.type===t.elementType?c:gn(t.type,c),l.props=m,v=t.pendingProps,x=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=dn(u):(u=zt(n)?dr:wt.current,u=qr(t,u));var E=n.getDerivedStateFromProps;(S=typeof E=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==v||x!==u)&&sh(t,l,r,u),bs=!1,x=t.memoizedState,l.state=x,Tl(t,r,l,a);var L=t.memoizedState;c!==v||x!==L||Bt.current||bs?(typeof E=="function"&&(Vc(t,n,E,r),L=t.memoizedState),(m=bs||nh(t,n,m,r,x,L,u)||!1)?(S||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,L,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,L,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=L),l.props=r,l.state=L,l.context=u,r=m):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),r=!1)}return qc(e,t,n,r,i,a)}function qc(e,t,n,r,a,i){Pp(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return a&&Qd(t,n,!1),hs(e,t,i);r=t.stateNode,Cv.current=t;var c=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=Qr(t,e.child,null,i),t.child=Qr(t,null,c,i)):Lt(e,t,c,i),t.memoizedState=r.state,a&&Qd(t,n,!0),t.child}function Mp(e){var t=e.stateNode;t.pendingContext?Gd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Gd(e,t.context,!1),$u(e,t.containerInfo)}function uh(e,t,n,r,a){return Gr(),Pu(a),t.flags|=256,Lt(e,t,n,r),t.child}var Gc={dehydrated:null,treeContext:null,retryLane:0};function Qc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ip(e,t,n){var r=t.pendingProps,a=Ue.current,i=!1,l=(t.flags&128)!==0,c;if((c=l)||(c=e!==null&&e.memoizedState===null?!1:(a&2)!==0),c?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Me(Ue,a&1),e===null)return $c(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,i?(r=t.mode,i=t.child,l={mode:"hidden",children:l},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Jl(l,r,0,null),e=ur(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Qc(n),t.memoizedState=Gc,e):Qu(t,l));if(a=e.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return Ev(e,t,l,r,c,a,n);if(i){i=r.fallback,l=t.mode,a=e.child,c=a.sibling;var u={mode:"hidden",children:r.children};return!(l&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Bs(a,u),r.subtreeFlags=a.subtreeFlags&14680064),c!==null?i=Bs(c,i):(i=ur(i,l,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,l=e.child.memoizedState,l=l===null?Qc(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=Gc,r}return i=e.child,e=i.sibling,r=Bs(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Qu(e,t){return t=Jl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Hi(e,t,n,r){return r!==null&&Pu(r),Qr(t,e.child,null,n),e=Qu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ev(e,t,n,r,a,i,l){if(n)return t.flags&256?(t.flags&=-257,r=tc(Error(z(422))),Hi(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=Jl({mode:"visible",children:r.children},a,0,null),i=ur(i,a,l,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Qr(t,e.child,null,l),t.child.memoizedState=Qc(l),t.memoizedState=Gc,i);if(!(t.mode&1))return Hi(e,t,l,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(z(419)),r=tc(i,r,void 0),Hi(e,t,l,r)}if(c=(l&e.childLanes)!==0,Dt||c){if(r=it,r!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,ds(e,a),Nn(r,e,a,-1))}return ed(),r=tc(Error(z(421))),Hi(e,t,l,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Uv.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,qt=Ps(a.nextSibling),Gt=t,$e=!0,yn=null,e!==null&&(an[ln++]=is,an[ln++]=ls,an[ln++]=hr,is=e.id,ls=e.overflow,hr=t),t=Qu(t,r.children),t.flags|=4096,t)}function dh(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Uc(e.return,t,n)}function nc(e,t,n,r,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Dp(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Lt(e,t,r.children,n),r=Ue.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&dh(e,n,t);else if(e.tag===19)dh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Me(Ue,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&Ll(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),nc(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Ll(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}nc(t,!0,n,null,i);break;case"together":nc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ll(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function hs(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),pr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(z(153));if(t.child!==null){for(e=t.child,n=Bs(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Bs(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Av(e,t,n){switch(t.tag){case 3:Mp(t),Gr();break;case 5:cp(t);break;case 1:zt(t.type)&&kl(t);break;case 4:$u(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Me(El,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Me(Ue,Ue.current&1),t.flags|=128,null):n&t.child.childLanes?Ip(e,t,n):(Me(Ue,Ue.current&1),e=hs(e,t,n),e!==null?e.sibling:null);Me(Ue,Ue.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Dp(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Me(Ue,Ue.current),r)break;return null;case 22:case 23:return t.lanes=0,Op(e,t,n)}return hs(e,t,n)}var Bp,Kc,zp,$p;Bp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Kc=function(){};zp=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,or(zn.current);var i=null;switch(n){case"input":a=vc(e,a),r=vc(e,r),i=[];break;case"select":a=Fe({},a,{value:void 0}),r=Fe({},r,{value:void 0}),i=[];break;case"textarea":a=jc(e,a),r=jc(e,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=_l)}wc(n,r);var l;n=null;for(m in a)if(!r.hasOwnProperty(m)&&a.hasOwnProperty(m)&&a[m]!=null)if(m==="style"){var c=a[m];for(l in c)c.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&($a.hasOwnProperty(m)?i||(i=[]):(i=i||[]).push(m,null));for(m in r){var u=r[m];if(c=a!=null?a[m]:void 0,r.hasOwnProperty(m)&&u!==c&&(u!=null||c!=null))if(m==="style")if(c){for(l in c)!c.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&c[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(i||(i=[]),i.push(m,n)),n=u;else m==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(m,u)):m==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(m,""+u):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&($a.hasOwnProperty(m)?(u!=null&&m==="onScroll"&&Ie("scroll",e),i||c===u||(i=[])):(i=i||[]).push(m,u))}n&&(i=i||[]).push("style",n);var m=i;(t.updateQueue=m)&&(t.flags|=4)}};$p=function(e,t,n,r){n!==r&&(t.flags|=4)};function wa(e,t){if(!$e)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Tv(e,t,n){var r=t.pendingProps;switch(Ou(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(t),null;case 1:return zt(t.type)&&Sl(),jt(t),null;case 3:return r=t.stateNode,Kr(),De(Bt),De(wt),Vu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Fi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,yn!==null&&(su(yn),yn=null))),Kc(e,t),jt(t),null;case 5:Uu(t);var a=or(Ja.current);if(n=t.type,e!==null&&t.stateNode!=null)zp(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(z(166));return jt(t),null}if(e=or(zn.current),Fi(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Dn]=t,r[Ya]=i,e=(t.mode&1)!==0,n){case"dialog":Ie("cancel",r),Ie("close",r);break;case"iframe":case"object":case"embed":Ie("load",r);break;case"video":case"audio":for(a=0;a<Ea.length;a++)Ie(Ea[a],r);break;case"source":Ie("error",r);break;case"img":case"image":case"link":Ie("error",r),Ie("load",r);break;case"details":Ie("toggle",r);break;case"input":jd(r,i),Ie("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ie("invalid",r);break;case"textarea":wd(r,i),Ie("invalid",r)}wc(n,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&Vi(r.textContent,c,e),a=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&Vi(r.textContent,c,e),a=["children",""+c]):$a.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&Ie("scroll",r)}switch(n){case"input":Pi(r),Nd(r,i,!0);break;case"textarea":Pi(r),_d(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=_l)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=pf(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[Dn]=t,e[Ya]=r,Bp(e,t,!1,!1),t.stateNode=e;e:{switch(l=_c(n,r),n){case"dialog":Ie("cancel",e),Ie("close",e),a=r;break;case"iframe":case"object":case"embed":Ie("load",e),a=r;break;case"video":case"audio":for(a=0;a<Ea.length;a++)Ie(Ea[a],e);a=r;break;case"source":Ie("error",e),a=r;break;case"img":case"image":case"link":Ie("error",e),Ie("load",e),a=r;break;case"details":Ie("toggle",e),a=r;break;case"input":jd(e,r),a=vc(e,r),Ie("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Fe({},r,{value:void 0}),Ie("invalid",e);break;case"textarea":wd(e,r),a=jc(e,r),Ie("invalid",e);break;default:a=r}wc(n,a),c=a;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?vf(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&mf(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ua(e,u):typeof u=="number"&&Ua(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&($a.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ie("scroll",e):u!=null&&xu(e,i,u,l))}switch(n){case"input":Pi(e),Nd(e,r,!1);break;case"textarea":Pi(e),_d(e);break;case"option":r.value!=null&&e.setAttribute("value",""+$s(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?zr(e,!!r.multiple,i,!1):r.defaultValue!=null&&zr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=_l)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return jt(t),null;case 6:if(e&&t.stateNode!=null)$p(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(z(166));if(n=or(Ja.current),or(zn.current),Fi(t)){if(r=t.stateNode,n=t.memoizedProps,r[Dn]=t,(i=r.nodeValue!==n)&&(e=Gt,e!==null))switch(e.tag){case 3:Vi(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Vi(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Dn]=t,t.stateNode=r}return jt(t),null;case 13:if(De(Ue),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($e&&qt!==null&&t.mode&1&&!(t.flags&128))rp(),Gr(),t.flags|=98560,i=!1;else if(i=Fi(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(z(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(z(317));i[Dn]=t}else Gr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;jt(t),i=!1}else yn!==null&&(su(yn),yn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ue.current&1?tt===0&&(tt=3):ed())),t.updateQueue!==null&&(t.flags|=4),jt(t),null);case 4:return Kr(),Kc(e,t),e===null&&Qa(t.stateNode.containerInfo),jt(t),null;case 10:return Du(t.type._context),jt(t),null;case 17:return zt(t.type)&&Sl(),jt(t),null;case 19:if(De(Ue),i=t.memoizedState,i===null)return jt(t),null;if(r=(t.flags&128)!==0,l=i.rendering,l===null)if(r)wa(i,!1);else{if(tt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Ll(e),l!==null){for(t.flags|=128,wa(i,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Me(Ue,Ue.current&1|2),t.child}e=e.sibling}i.tail!==null&&He()>Xr&&(t.flags|=128,r=!0,wa(i,!1),t.lanes=4194304)}else{if(!r)if(e=Ll(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),wa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!$e)return jt(t),null}else 2*He()-i.renderingStartTime>Xr&&n!==1073741824&&(t.flags|=128,r=!0,wa(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(n=i.last,n!==null?n.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=He(),t.sibling=null,n=Ue.current,Me(Ue,r?n&1|2:n&1),t):(jt(t),null);case 22:case 23:return Zu(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Ht&1073741824&&(jt(t),t.subtreeFlags&6&&(t.flags|=8192)):jt(t),null;case 24:return null;case 25:return null}throw Error(z(156,t.tag))}function Lv(e,t){switch(Ou(t),t.tag){case 1:return zt(t.type)&&Sl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Kr(),De(Bt),De(wt),Vu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Uu(t),null;case 13:if(De(Ue),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(z(340));Gr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return De(Ue),null;case 4:return Kr(),null;case 10:return Du(t.type._context),null;case 22:case 23:return Zu(),null;case 24:return null;default:return null}}var qi=!1,Nt=!1,Rv=typeof WeakSet=="function"?WeakSet:Set,K=null;function Dr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){We(e,t,r)}else n.current=null}function Yc(e,t,n){try{n()}catch(r){We(e,t,r)}}var hh=!1;function Ov(e,t){if(Oc=jl,e=Hf(),Lu(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var l=0,c=-1,u=-1,m=0,S=0,v=e,x=null;t:for(;;){for(var E;v!==n||a!==0&&v.nodeType!==3||(c=l+a),v!==i||r!==0&&v.nodeType!==3||(u=l+r),v.nodeType===3&&(l+=v.nodeValue.length),(E=v.firstChild)!==null;)x=v,v=E;for(;;){if(v===e)break t;if(x===n&&++m===a&&(c=l),x===i&&++S===r&&(u=l),(E=v.nextSibling)!==null)break;v=x,x=v.parentNode}v=E}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Pc={focusedElem:e,selectionRange:n},jl=!1,K=t;K!==null;)if(t=K,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,K=e;else for(;K!==null;){t=K;try{var L=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(L!==null){var O=L.memoizedProps,g=L.memoizedState,f=t.stateNode,p=f.getSnapshotBeforeUpdate(t.elementType===t.type?O:gn(t.type,O),g);f.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var j=t.stateNode.containerInfo;j.nodeType===1?j.textContent="":j.nodeType===9&&j.documentElement&&j.removeChild(j.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(k){We(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,K=e;break}K=t.return}return L=hh,hh=!1,L}function Ia(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Yc(t,n,i)}a=a.next}while(a!==r)}}function Yl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Xc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Up(e){var t=e.alternate;t!==null&&(e.alternate=null,Up(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Dn],delete t[Ya],delete t[Dc],delete t[mv],delete t[gv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Vp(e){return e.tag===5||e.tag===3||e.tag===4}function fh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Vp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Jc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=_l));else if(r!==4&&(e=e.child,e!==null))for(Jc(e,t,n),e=e.sibling;e!==null;)Jc(e,t,n),e=e.sibling}function Zc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Zc(e,t,n),e=e.sibling;e!==null;)Zc(e,t,n),e=e.sibling}var dt=null,vn=!1;function Ss(e,t,n){for(n=n.child;n!==null;)Fp(e,t,n),n=n.sibling}function Fp(e,t,n){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(Vl,n)}catch{}switch(n.tag){case 5:Nt||Dr(n,t);case 6:var r=dt,a=vn;dt=null,Ss(e,t,n),dt=r,vn=a,dt!==null&&(vn?(e=dt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):dt.removeChild(n.stateNode));break;case 18:dt!==null&&(vn?(e=dt,n=n.stateNode,e.nodeType===8?Ko(e.parentNode,n):e.nodeType===1&&Ko(e,n),Ha(e)):Ko(dt,n.stateNode));break;case 4:r=dt,a=vn,dt=n.stateNode.containerInfo,vn=!0,Ss(e,t,n),dt=r,vn=a;break;case 0:case 11:case 14:case 15:if(!Nt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Yc(n,t,l),a=a.next}while(a!==r)}Ss(e,t,n);break;case 1:if(!Nt&&(Dr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){We(n,t,c)}Ss(e,t,n);break;case 21:Ss(e,t,n);break;case 22:n.mode&1?(Nt=(r=Nt)||n.memoizedState!==null,Ss(e,t,n),Nt=r):Ss(e,t,n);break;default:Ss(e,t,n)}}function ph(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Rv),t.forEach(function(r){var a=Vv.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function mn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,l=t,c=l;e:for(;c!==null;){switch(c.tag){case 5:dt=c.stateNode,vn=!1;break e;case 3:dt=c.stateNode.containerInfo,vn=!0;break e;case 4:dt=c.stateNode.containerInfo,vn=!0;break e}c=c.return}if(dt===null)throw Error(z(160));Fp(i,l,a),dt=null,vn=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(m){We(a,t,m)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Wp(t,e),t=t.sibling}function Wp(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mn(t,e),Pn(e),r&4){try{Ia(3,e,e.return),Yl(3,e)}catch(O){We(e,e.return,O)}try{Ia(5,e,e.return)}catch(O){We(e,e.return,O)}}break;case 1:mn(t,e),Pn(e),r&512&&n!==null&&Dr(n,n.return);break;case 5:if(mn(t,e),Pn(e),r&512&&n!==null&&Dr(n,n.return),e.flags&32){var a=e.stateNode;try{Ua(a,"")}catch(O){We(e,e.return,O)}}if(r&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=n!==null?n.memoizedProps:i,c=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&hf(a,i),_c(c,l);var m=_c(c,i);for(l=0;l<u.length;l+=2){var S=u[l],v=u[l+1];S==="style"?vf(a,v):S==="dangerouslySetInnerHTML"?mf(a,v):S==="children"?Ua(a,v):xu(a,S,v,m)}switch(c){case"input":xc(a,i);break;case"textarea":ff(a,i);break;case"select":var x=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var E=i.value;E!=null?zr(a,!!i.multiple,E,!1):x!==!!i.multiple&&(i.defaultValue!=null?zr(a,!!i.multiple,i.defaultValue,!0):zr(a,!!i.multiple,i.multiple?[]:"",!1))}a[Ya]=i}catch(O){We(e,e.return,O)}}break;case 6:if(mn(t,e),Pn(e),r&4){if(e.stateNode===null)throw Error(z(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(O){We(e,e.return,O)}}break;case 3:if(mn(t,e),Pn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ha(t.containerInfo)}catch(O){We(e,e.return,O)}break;case 4:mn(t,e),Pn(e);break;case 13:mn(t,e),Pn(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Xu=He())),r&4&&ph(e);break;case 22:if(S=n!==null&&n.memoizedState!==null,e.mode&1?(Nt=(m=Nt)||S,mn(t,e),Nt=m):mn(t,e),Pn(e),r&8192){if(m=e.memoizedState!==null,(e.stateNode.isHidden=m)&&!S&&e.mode&1)for(K=e,S=e.child;S!==null;){for(v=K=S;K!==null;){switch(x=K,E=x.child,x.tag){case 0:case 11:case 14:case 15:Ia(4,x,x.return);break;case 1:Dr(x,x.return);var L=x.stateNode;if(typeof L.componentWillUnmount=="function"){r=x,n=x.return;try{t=r,L.props=t.memoizedProps,L.state=t.memoizedState,L.componentWillUnmount()}catch(O){We(r,n,O)}}break;case 5:Dr(x,x.return);break;case 22:if(x.memoizedState!==null){gh(v);continue}}E!==null?(E.return=x,K=E):gh(v)}S=S.sibling}e:for(S=null,v=e;;){if(v.tag===5){if(S===null){S=v;try{a=v.stateNode,m?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=v.stateNode,u=v.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=gf("display",l))}catch(O){We(e,e.return,O)}}}else if(v.tag===6){if(S===null)try{v.stateNode.nodeValue=m?"":v.memoizedProps}catch(O){We(e,e.return,O)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===e)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===e)break e;for(;v.sibling===null;){if(v.return===null||v.return===e)break e;S===v&&(S=null),v=v.return}S===v&&(S=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:mn(t,e),Pn(e),r&4&&ph(e);break;case 21:break;default:mn(t,e),Pn(e)}}function Pn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Vp(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(Ua(a,""),r.flags&=-33);var i=fh(e);Zc(e,i,a);break;case 3:case 4:var l=r.stateNode.containerInfo,c=fh(e);Jc(e,c,l);break;default:throw Error(z(161))}}catch(u){We(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Pv(e,t,n){K=e,Hp(e)}function Hp(e,t,n){for(var r=(e.mode&1)!==0;K!==null;){var a=K,i=a.child;if(a.tag===22&&r){var l=a.memoizedState!==null||qi;if(!l){var c=a.alternate,u=c!==null&&c.memoizedState!==null||Nt;c=qi;var m=Nt;if(qi=l,(Nt=u)&&!m)for(K=a;K!==null;)l=K,u=l.child,l.tag===22&&l.memoizedState!==null?vh(a):u!==null?(u.return=l,K=u):vh(a);for(;i!==null;)K=i,Hp(i),i=i.sibling;K=a,qi=c,Nt=m}mh(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,K=i):mh(e)}}function mh(e){for(;K!==null;){var t=K;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Nt||Yl(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Nt)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:gn(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Zd(t,i,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Zd(t,l,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var m=t.alternate;if(m!==null){var S=m.memoizedState;if(S!==null){var v=S.dehydrated;v!==null&&Ha(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}Nt||t.flags&512&&Xc(t)}catch(x){We(t,t.return,x)}}if(t===e){K=null;break}if(n=t.sibling,n!==null){n.return=t.return,K=n;break}K=t.return}}function gh(e){for(;K!==null;){var t=K;if(t===e){K=null;break}var n=t.sibling;if(n!==null){n.return=t.return,K=n;break}K=t.return}}function vh(e){for(;K!==null;){var t=K;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Yl(4,t)}catch(u){We(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(u){We(t,a,u)}}var i=t.return;try{Xc(t)}catch(u){We(t,i,u)}break;case 5:var l=t.return;try{Xc(t)}catch(u){We(t,l,u)}}}catch(u){We(t,t.return,u)}if(t===e){K=null;break}var c=t.sibling;if(c!==null){c.return=t.return,K=c;break}K=t.return}}var Mv=Math.ceil,Pl=fs.ReactCurrentDispatcher,Ku=fs.ReactCurrentOwner,un=fs.ReactCurrentBatchConfig,Ne=0,it=null,Ke=null,ht=0,Ht=0,Br=Fs(0),tt=0,ni=null,pr=0,Xl=0,Yu=0,Da=null,It=null,Xu=0,Xr=1/0,ss=null,Ml=!1,eu=null,Is=null,Gi=!1,Ts=null,Il=0,Ba=0,tu=null,ol=-1,cl=0;function Rt(){return Ne&6?He():ol!==-1?ol:ol=He()}function Ds(e){return e.mode&1?Ne&2&&ht!==0?ht&-ht:xv.transition!==null?(cl===0&&(cl=Af()),cl):(e=Ae,e!==0||(e=window.event,e=e===void 0?16:If(e.type)),e):1}function Nn(e,t,n,r){if(50<Ba)throw Ba=0,tu=null,Error(z(185));ri(e,n,r),(!(Ne&2)||e!==it)&&(e===it&&(!(Ne&2)&&(Xl|=n),tt===4&&Es(e,ht)),$t(e,r),n===1&&Ne===0&&!(t.mode&1)&&(Xr=He()+500,Gl&&Ws()))}function $t(e,t){var n=e.callbackNode;xg(e,t);var r=yl(e,e===it?ht:0);if(r===0)n!==null&&bd(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&bd(n),t===1)e.tag===0?vv(xh.bind(null,e)):tp(xh.bind(null,e)),fv(function(){!(Ne&6)&&Ws()}),n=null;else{switch(Tf(r)){case 1:n=_u;break;case 4:n=Cf;break;case 16:n=xl;break;case 536870912:n=Ef;break;default:n=xl}n=Zp(n,qp.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function qp(e,t){if(ol=-1,cl=0,Ne&6)throw Error(z(327));var n=e.callbackNode;if(Wr()&&e.callbackNode!==n)return null;var r=yl(e,e===it?ht:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Dl(e,r);else{t=r;var a=Ne;Ne|=2;var i=Qp();(it!==e||ht!==t)&&(ss=null,Xr=He()+500,cr(e,t));do try{Bv();break}catch(c){Gp(e,c)}while(!0);Iu(),Pl.current=i,Ne=a,Ke!==null?t=0:(it=null,ht=0,t=tt)}if(t!==0){if(t===2&&(a=Ec(e),a!==0&&(r=a,t=nu(e,a))),t===1)throw n=ni,cr(e,0),Es(e,r),$t(e,He()),n;if(t===6)Es(e,r);else{if(a=e.current.alternate,!(r&30)&&!Iv(a)&&(t=Dl(e,r),t===2&&(i=Ec(e),i!==0&&(r=i,t=nu(e,i))),t===1))throw n=ni,cr(e,0),Es(e,r),$t(e,He()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(z(345));case 2:ar(e,It,ss);break;case 3:if(Es(e,r),(r&130023424)===r&&(t=Xu+500-He(),10<t)){if(yl(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){Rt(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Ic(ar.bind(null,e,It,ss),t);break}ar(e,It,ss);break;case 4:if(Es(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var l=31-jn(r);i=1<<l,l=t[l],l>a&&(a=l),r&=~i}if(r=a,r=He()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Mv(r/1960))-r,10<r){e.timeoutHandle=Ic(ar.bind(null,e,It,ss),r);break}ar(e,It,ss);break;case 5:ar(e,It,ss);break;default:throw Error(z(329))}}}return $t(e,He()),e.callbackNode===n?qp.bind(null,e):null}function nu(e,t){var n=Da;return e.current.memoizedState.isDehydrated&&(cr(e,t).flags|=256),e=Dl(e,t),e!==2&&(t=It,It=n,t!==null&&su(t)),e}function su(e){It===null?It=e:It.push.apply(It,e)}function Iv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!wn(i(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Es(e,t){for(t&=~Yu,t&=~Xl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-jn(t),r=1<<n;e[n]=-1,t&=~r}}function xh(e){if(Ne&6)throw Error(z(327));Wr();var t=yl(e,0);if(!(t&1))return $t(e,He()),null;var n=Dl(e,t);if(e.tag!==0&&n===2){var r=Ec(e);r!==0&&(t=r,n=nu(e,r))}if(n===1)throw n=ni,cr(e,0),Es(e,t),$t(e,He()),n;if(n===6)throw Error(z(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ar(e,It,ss),$t(e,He()),null}function Ju(e,t){var n=Ne;Ne|=1;try{return e(t)}finally{Ne=n,Ne===0&&(Xr=He()+500,Gl&&Ws())}}function mr(e){Ts!==null&&Ts.tag===0&&!(Ne&6)&&Wr();var t=Ne;Ne|=1;var n=un.transition,r=Ae;try{if(un.transition=null,Ae=1,e)return e()}finally{Ae=r,un.transition=n,Ne=t,!(Ne&6)&&Ws()}}function Zu(){Ht=Br.current,De(Br)}function cr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,hv(n)),Ke!==null)for(n=Ke.return;n!==null;){var r=n;switch(Ou(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Sl();break;case 3:Kr(),De(Bt),De(wt),Vu();break;case 5:Uu(r);break;case 4:Kr();break;case 13:De(Ue);break;case 19:De(Ue);break;case 10:Du(r.type._context);break;case 22:case 23:Zu()}n=n.return}if(it=e,Ke=e=Bs(e.current,null),ht=Ht=t,tt=0,ni=null,Yu=Xl=pr=0,It=Da=null,lr!==null){for(t=0;t<lr.length;t++)if(n=lr[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var l=i.next;i.next=a,r.next=l}n.pending=r}lr=null}return e}function Gp(e,t){do{var n=Ke;try{if(Iu(),al.current=Ol,Rl){for(var r=Ve.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Rl=!1}if(fr=0,at=et=Ve=null,Ma=!1,Za=0,Ku.current=null,n===null||n.return===null){tt=1,ni=t,Ke=null;break}e:{var i=e,l=n.return,c=n,u=t;if(t=ht,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var m=u,S=c,v=S.tag;if(!(S.mode&1)&&(v===0||v===11||v===15)){var x=S.alternate;x?(S.updateQueue=x.updateQueue,S.memoizedState=x.memoizedState,S.lanes=x.lanes):(S.updateQueue=null,S.memoizedState=null)}var E=ah(l);if(E!==null){E.flags&=-257,ih(E,l,c,i,t),E.mode&1&&rh(i,m,t),t=E,u=m;var L=t.updateQueue;if(L===null){var O=new Set;O.add(u),t.updateQueue=O}else L.add(u);break e}else{if(!(t&1)){rh(i,m,t),ed();break e}u=Error(z(426))}}else if($e&&c.mode&1){var g=ah(l);if(g!==null){!(g.flags&65536)&&(g.flags|=256),ih(g,l,c,i,t),Pu(Yr(u,c));break e}}i=u=Yr(u,c),tt!==4&&(tt=2),Da===null?Da=[i]:Da.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var f=Tp(i,u,t);Jd(i,f);break e;case 1:c=u;var p=i.type,j=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(Is===null||!Is.has(j)))){i.flags|=65536,t&=-t,i.lanes|=t;var k=Lp(i,c,t);Jd(i,k);break e}}i=i.return}while(i!==null)}Yp(n)}catch(P){t=P,Ke===n&&n!==null&&(Ke=n=n.return);continue}break}while(!0)}function Qp(){var e=Pl.current;return Pl.current=Ol,e===null?Ol:e}function ed(){(tt===0||tt===3||tt===2)&&(tt=4),it===null||!(pr&268435455)&&!(Xl&268435455)||Es(it,ht)}function Dl(e,t){var n=Ne;Ne|=2;var r=Qp();(it!==e||ht!==t)&&(ss=null,cr(e,t));do try{Dv();break}catch(a){Gp(e,a)}while(!0);if(Iu(),Ne=n,Pl.current=r,Ke!==null)throw Error(z(261));return it=null,ht=0,tt}function Dv(){for(;Ke!==null;)Kp(Ke)}function Bv(){for(;Ke!==null&&!cg();)Kp(Ke)}function Kp(e){var t=Jp(e.alternate,e,Ht);e.memoizedProps=e.pendingProps,t===null?Yp(e):Ke=t,Ku.current=null}function Yp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Lv(n,t),n!==null){n.flags&=32767,Ke=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{tt=6,Ke=null;return}}else if(n=Tv(n,t,Ht),n!==null){Ke=n;return}if(t=t.sibling,t!==null){Ke=t;return}Ke=t=e}while(t!==null);tt===0&&(tt=5)}function ar(e,t,n){var r=Ae,a=un.transition;try{un.transition=null,Ae=1,zv(e,t,n,r)}finally{un.transition=a,Ae=r}return null}function zv(e,t,n,r){do Wr();while(Ts!==null);if(Ne&6)throw Error(z(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(z(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(yg(e,i),e===it&&(Ke=it=null,ht=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Gi||(Gi=!0,Zp(xl,function(){return Wr(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=un.transition,un.transition=null;var l=Ae;Ae=1;var c=Ne;Ne|=4,Ku.current=null,Ov(e,n),Wp(n,e),av(Pc),jl=!!Oc,Pc=Oc=null,e.current=n,Pv(n),ug(),Ne=c,Ae=l,un.transition=i}else e.current=n;if(Gi&&(Gi=!1,Ts=e,Il=a),i=e.pendingLanes,i===0&&(Is=null),fg(n.stateNode),$t(e,He()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Ml)throw Ml=!1,e=eu,eu=null,e;return Il&1&&e.tag!==0&&Wr(),i=e.pendingLanes,i&1?e===tu?Ba++:(Ba=0,tu=e):Ba=0,Ws(),null}function Wr(){if(Ts!==null){var e=Tf(Il),t=un.transition,n=Ae;try{if(un.transition=null,Ae=16>e?16:e,Ts===null)var r=!1;else{if(e=Ts,Ts=null,Il=0,Ne&6)throw Error(z(331));var a=Ne;for(Ne|=4,K=e.current;K!==null;){var i=K,l=i.child;if(K.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var m=c[u];for(K=m;K!==null;){var S=K;switch(S.tag){case 0:case 11:case 15:Ia(8,S,i)}var v=S.child;if(v!==null)v.return=S,K=v;else for(;K!==null;){S=K;var x=S.sibling,E=S.return;if(Up(S),S===m){K=null;break}if(x!==null){x.return=E,K=x;break}K=E}}}var L=i.alternate;if(L!==null){var O=L.child;if(O!==null){L.child=null;do{var g=O.sibling;O.sibling=null,O=g}while(O!==null)}}K=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,K=l;else e:for(;K!==null;){if(i=K,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ia(9,i,i.return)}var f=i.sibling;if(f!==null){f.return=i.return,K=f;break e}K=i.return}}var p=e.current;for(K=p;K!==null;){l=K;var j=l.child;if(l.subtreeFlags&2064&&j!==null)j.return=l,K=j;else e:for(l=p;K!==null;){if(c=K,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Yl(9,c)}}catch(P){We(c,c.return,P)}if(c===l){K=null;break e}var k=c.sibling;if(k!==null){k.return=c.return,K=k;break e}K=c.return}}if(Ne=a,Ws(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(Vl,e)}catch{}r=!0}return r}finally{Ae=n,un.transition=t}}return!1}function yh(e,t,n){t=Yr(n,t),t=Tp(e,t,1),e=Ms(e,t,1),t=Rt(),e!==null&&(ri(e,1,t),$t(e,t))}function We(e,t,n){if(e.tag===3)yh(e,e,n);else for(;t!==null;){if(t.tag===3){yh(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Is===null||!Is.has(r))){e=Yr(n,e),e=Lp(t,e,1),t=Ms(t,e,1),e=Rt(),t!==null&&(ri(t,1,e),$t(t,e));break}}t=t.return}}function $v(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Rt(),e.pingedLanes|=e.suspendedLanes&n,it===e&&(ht&n)===n&&(tt===4||tt===3&&(ht&130023424)===ht&&500>He()-Xu?cr(e,0):Yu|=n),$t(e,t)}function Xp(e,t){t===0&&(e.mode&1?(t=Di,Di<<=1,!(Di&130023424)&&(Di=4194304)):t=1);var n=Rt();e=ds(e,t),e!==null&&(ri(e,t,n),$t(e,n))}function Uv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Xp(e,n)}function Vv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(t),Xp(e,n)}var Jp;Jp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Bt.current)Dt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Dt=!1,Av(e,t,n);Dt=!!(e.flags&131072)}else Dt=!1,$e&&t.flags&1048576&&np(t,Cl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ll(e,t),e=t.pendingProps;var a=qr(t,wt.current);Fr(t,n),a=Wu(null,t,r,e,a,n);var i=Hu();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,zt(r)?(i=!0,kl(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,zu(t),a.updater=Kl,t.stateNode=a,a._reactInternals=t,Fc(t,r,e,n),t=qc(null,t,r,!0,i,n)):(t.tag=0,$e&&i&&Ru(t),Lt(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ll(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=Wv(r),e=gn(r,e),a){case 0:t=Hc(null,t,r,e,n);break e;case 1:t=ch(null,t,r,e,n);break e;case 11:t=lh(null,t,r,e,n);break e;case 14:t=oh(null,t,r,gn(r.type,e),n);break e}throw Error(z(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),Hc(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),ch(e,t,r,a,n);case 3:e:{if(Mp(t),e===null)throw Error(z(387));r=t.pendingProps,i=t.memoizedState,a=i.element,op(e,t),Tl(t,r,null,n);var l=t.memoizedState;if(r=l.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Yr(Error(z(423)),t),t=uh(e,t,r,n,a);break e}else if(r!==a){a=Yr(Error(z(424)),t),t=uh(e,t,r,n,a);break e}else for(qt=Ps(t.stateNode.containerInfo.firstChild),Gt=t,$e=!0,yn=null,n=ip(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gr(),r===a){t=hs(e,t,n);break e}Lt(e,t,r,n)}t=t.child}return t;case 5:return cp(t),e===null&&$c(t),r=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,Mc(r,a)?l=null:i!==null&&Mc(r,i)&&(t.flags|=32),Pp(e,t),Lt(e,t,l,n),t.child;case 6:return e===null&&$c(t),null;case 13:return Ip(e,t,n);case 4:return $u(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Qr(t,null,r,n):Lt(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),lh(e,t,r,a,n);case 7:return Lt(e,t,t.pendingProps,n),t.child;case 8:return Lt(e,t,t.pendingProps.children,n),t.child;case 12:return Lt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,Me(El,r._currentValue),r._currentValue=l,i!==null)if(wn(i.value,l)){if(i.children===a.children&&!Bt.current){t=hs(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var c=i.dependencies;if(c!==null){l=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=os(-1,n&-n),u.tag=2;var m=i.updateQueue;if(m!==null){m=m.shared;var S=m.pending;S===null?u.next=u:(u.next=S.next,S.next=u),m.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Uc(i.return,n,t),c.lanes|=n;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(z(341));l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),Uc(l,n,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}Lt(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Fr(t,n),a=dn(a),r=r(a),t.flags|=1,Lt(e,t,r,n),t.child;case 14:return r=t.type,a=gn(r,t.pendingProps),a=gn(r.type,a),oh(e,t,r,a,n);case 15:return Rp(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),ll(e,t),t.tag=1,zt(r)?(e=!0,kl(t)):e=!1,Fr(t,n),Ap(t,r,a),Fc(t,r,a,n),qc(null,t,r,!0,e,n);case 19:return Dp(e,t,n);case 22:return Op(e,t,n)}throw Error(z(156,t.tag))};function Zp(e,t){return bf(e,t)}function Fv(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cn(e,t,n,r){return new Fv(e,t,n,r)}function td(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Wv(e){if(typeof e=="function")return td(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ju)return 11;if(e===Nu)return 14}return 2}function Bs(e,t){var n=e.alternate;return n===null?(n=cn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ul(e,t,n,r,a,i){var l=2;if(r=e,typeof e=="function")td(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Er:return ur(n.children,a,i,t);case yu:l=8,a|=8;break;case fc:return e=cn(12,n,t,a|2),e.elementType=fc,e.lanes=i,e;case pc:return e=cn(13,n,t,a),e.elementType=pc,e.lanes=i,e;case mc:return e=cn(19,n,t,a),e.elementType=mc,e.lanes=i,e;case cf:return Jl(n,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case lf:l=10;break e;case of:l=9;break e;case ju:l=11;break e;case Nu:l=14;break e;case ks:l=16,r=null;break e}throw Error(z(130,e==null?e:typeof e,""))}return t=cn(l,n,t,a),t.elementType=e,t.type=r,t.lanes=i,t}function ur(e,t,n,r){return e=cn(7,e,r,t),e.lanes=n,e}function Jl(e,t,n,r){return e=cn(22,e,r,t),e.elementType=cf,e.lanes=n,e.stateNode={isHidden:!1},e}function sc(e,t,n){return e=cn(6,e,null,t),e.lanes=n,e}function rc(e,t,n){return t=cn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Hv(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bo(0),this.expirationTimes=Bo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bo(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function nd(e,t,n,r,a,i,l,c,u){return e=new Hv(e,t,n,c,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=cn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zu(i),e}function qv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Cr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function em(e){if(!e)return Us;e=e._reactInternals;e:{if(vr(e)!==e||e.tag!==1)throw Error(z(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(zt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(z(171))}if(e.tag===1){var n=e.type;if(zt(n))return ep(e,n,t)}return t}function tm(e,t,n,r,a,i,l,c,u){return e=nd(n,r,!0,e,a,i,l,c,u),e.context=em(null),n=e.current,r=Rt(),a=Ds(n),i=os(r,a),i.callback=t??null,Ms(n,i,a),e.current.lanes=a,ri(e,a,r),$t(e,r),e}function Zl(e,t,n,r){var a=t.current,i=Rt(),l=Ds(a);return n=em(n),t.context===null?t.context=n:t.pendingContext=n,t=os(i,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ms(a,t,l),e!==null&&(Nn(e,a,l,i),rl(e,a,l)),l}function Bl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function jh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function sd(e,t){jh(e,t),(e=e.alternate)&&jh(e,t)}function Gv(){return null}var nm=typeof reportError=="function"?reportError:function(e){console.error(e)};function rd(e){this._internalRoot=e}eo.prototype.render=rd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(z(409));Zl(e,t,null,null)};eo.prototype.unmount=rd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;mr(function(){Zl(null,e,null,null)}),t[us]=null}};function eo(e){this._internalRoot=e}eo.prototype.unstable_scheduleHydration=function(e){if(e){var t=Of();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Cs.length&&t!==0&&t<Cs[n].priority;n++);Cs.splice(n,0,e),n===0&&Mf(e)}};function ad(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function to(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Nh(){}function Qv(e,t,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var m=Bl(l);i.call(m)}}var l=tm(t,r,e,0,null,!1,!1,"",Nh);return e._reactRootContainer=l,e[us]=l.current,Qa(e.nodeType===8?e.parentNode:e),mr(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var c=r;r=function(){var m=Bl(u);c.call(m)}}var u=nd(e,0,!1,null,null,!1,!1,"",Nh);return e._reactRootContainer=u,e[us]=u.current,Qa(e.nodeType===8?e.parentNode:e),mr(function(){Zl(t,u,n,r)}),u}function no(e,t,n,r,a){var i=n._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var c=a;a=function(){var u=Bl(l);c.call(u)}}Zl(t,l,e,a)}else l=Qv(n,t,e,a,r);return Bl(l)}Lf=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ca(t.pendingLanes);n!==0&&(Su(t,n|1),$t(t,He()),!(Ne&6)&&(Xr=He()+500,Ws()))}break;case 13:mr(function(){var r=ds(e,1);if(r!==null){var a=Rt();Nn(r,e,1,a)}}),sd(e,1)}};ku=function(e){if(e.tag===13){var t=ds(e,134217728);if(t!==null){var n=Rt();Nn(t,e,134217728,n)}sd(e,134217728)}};Rf=function(e){if(e.tag===13){var t=Ds(e),n=ds(e,t);if(n!==null){var r=Rt();Nn(n,e,t,r)}sd(e,t)}};Of=function(){return Ae};Pf=function(e,t){var n=Ae;try{return Ae=e,t()}finally{Ae=n}};kc=function(e,t,n){switch(t){case"input":if(xc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=ql(r);if(!a)throw Error(z(90));df(r),xc(r,a)}}}break;case"textarea":ff(e,n);break;case"select":t=n.value,t!=null&&zr(e,!!n.multiple,t,!1)}};jf=Ju;Nf=mr;var Kv={usingClientEntryPoint:!1,Events:[ii,Rr,ql,xf,yf,Ju]},_a={findFiberByHostInstance:ir,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Yv={bundleType:_a.bundleType,version:_a.version,rendererPackageName:_a.rendererPackageName,rendererConfig:_a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Sf(e),e===null?null:e.stateNode},findFiberByHostInstance:_a.findFiberByHostInstance||Gv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qi.isDisabled&&Qi.supportsFiber)try{Vl=Qi.inject(Yv),Bn=Qi}catch{}}Kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kv;Kt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ad(t))throw Error(z(200));return qv(e,t,null,n)};Kt.createRoot=function(e,t){if(!ad(e))throw Error(z(299));var n=!1,r="",a=nm;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=nd(e,1,!1,null,null,n,!1,r,a),e[us]=t.current,Qa(e.nodeType===8?e.parentNode:e),new rd(t)};Kt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(z(188)):(e=Object.keys(e).join(","),Error(z(268,e)));return e=Sf(t),e=e===null?null:e.stateNode,e};Kt.flushSync=function(e){return mr(e)};Kt.hydrate=function(e,t,n){if(!to(t))throw Error(z(200));return no(null,e,t,!0,n)};Kt.hydrateRoot=function(e,t,n){if(!ad(e))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",l=nm;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=tm(t,null,e,1,n??null,a,!1,i,l),e[us]=t.current,Qa(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new eo(t)};Kt.render=function(e,t,n){if(!to(t))throw Error(z(200));return no(null,e,t,!1,n)};Kt.unmountComponentAtNode=function(e){if(!to(e))throw Error(z(40));return e._reactRootContainer?(mr(function(){no(null,null,e,!1,function(){e._reactRootContainer=null,e[us]=null})}),!0):!1};Kt.unstable_batchedUpdates=Ju;Kt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!to(n))throw Error(z(200));if(e==null||e._reactInternals===void 0)throw Error(z(38));return no(e,t,n,!1,r)};Kt.version="18.3.1-next-f1338f8080-20240426";function sm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sm)}catch(e){console.error(e)}}sm(),nf.exports=Kt;var Xv=nf.exports,rm,wh=Xv;rm=wh.createRoot,wh.hydrateRoot;const Jv="http://localhost:3000";let ru=localStorage.getItem("token");function br(e){ru=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}async function oi(e,t={}){const n={"Content-Type":"application/json",...t.headers||{}};if(ru&&(n.Authorization=`Bearer ${ru}`),typeof window<"u"&&navigator&&navigator.onLine===!1)throw new Error("offline");let r;try{r=await fetch(`${Jv}${e}`,{...t,headers:n})}catch(a){throw typeof window<"u"&&navigator&&navigator.onLine===!1?new Error("offline"):a instanceof TypeError?new Error("network_error"):a}if(!r.ok){const i=(await r.json().catch(()=>({}))).error||"request_failed";throw new Error(i)}return r.json()}function me(e){return oi(e,{method:"GET"})}function we(e,t){return oi(e,{method:"POST",body:JSON.stringify(t||{})})}function Qe(e,t){return oi(e,{method:"PATCH",body:JSON.stringify(t||{})})}function zl(e,t){return oi(e,{method:"PUT",body:JSON.stringify(t||{})})}function In(e){return oi(e,{method:"DELETE"})}const Un=Object.create(null);Un.open="0";Un.close="1";Un.ping="2";Un.pong="3";Un.message="4";Un.upgrade="5";Un.noop="6";const dl=Object.create(null);Object.keys(Un).forEach(e=>{dl[Un[e]]=e});const au={type:"error",data:"parser error"},am=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",im=typeof ArrayBuffer=="function",lm=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,id=({type:e,data:t},n,r)=>am&&t instanceof Blob?n?r(t):_h(t,r):im&&(t instanceof ArrayBuffer||lm(t))?n?r(t):_h(new Blob([t]),r):r(Un[e]+(t||"")),_h=(e,t)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];t("b"+(r||""))},n.readAsDataURL(e)};function Sh(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let ac;function Zv(e,t){if(am&&e.data instanceof Blob)return e.data.arrayBuffer().then(Sh).then(t);if(im&&(e.data instanceof ArrayBuffer||lm(e.data)))return t(Sh(e.data));id(e,!1,n=>{ac||(ac=new TextEncoder),t(ac.encode(n))})}const kh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Aa=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<kh.length;e++)Aa[kh.charCodeAt(e)]=e;const ex=e=>{let t=e.length*.75,n=e.length,r,a=0,i,l,c,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const m=new ArrayBuffer(t),S=new Uint8Array(m);for(r=0;r<n;r+=4)i=Aa[e.charCodeAt(r)],l=Aa[e.charCodeAt(r+1)],c=Aa[e.charCodeAt(r+2)],u=Aa[e.charCodeAt(r+3)],S[a++]=i<<2|l>>4,S[a++]=(l&15)<<4|c>>2,S[a++]=(c&3)<<6|u&63;return m},tx=typeof ArrayBuffer=="function",ld=(e,t)=>{if(typeof e!="string")return{type:"message",data:om(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:nx(e.substring(1),t)}:dl[n]?e.length>1?{type:dl[n],data:e.substring(1)}:{type:dl[n]}:au},nx=(e,t)=>{if(tx){const n=ex(e);return om(n,t)}else return{base64:!0,data:e}},om=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},cm="",sx=(e,t)=>{const n=e.length,r=new Array(n);let a=0;e.forEach((i,l)=>{id(i,!1,c=>{r[l]=c,++a===n&&t(r.join(cm))})})},rx=(e,t)=>{const n=e.split(cm),r=[];for(let a=0;a<n.length;a++){const i=ld(n[a],t);if(r.push(i),i.type==="error")break}return r};function ax(){return new TransformStream({transform(e,t){Zv(e,n=>{const r=n.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const i=new DataView(a.buffer);i.setUint8(0,126),i.setUint16(1,r)}else{a=new Uint8Array(9);const i=new DataView(a.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(a[0]|=128),t.enqueue(a),t.enqueue(n)})}})}let ic;function Ki(e){return e.reduce((t,n)=>t+n.length,0)}function Yi(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let a=0;a<t;a++)n[a]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function ix(e,t){ic||(ic=new TextDecoder);const n=[];let r=0,a=-1,i=!1;return new TransformStream({transform(l,c){for(n.push(l);;){if(r===0){if(Ki(n)<1)break;const u=Yi(n,1);i=(u[0]&128)===128,a=u[0]&127,a<126?r=3:a===126?r=1:r=2}else if(r===1){if(Ki(n)<2)break;const u=Yi(n,2);a=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),r=3}else if(r===2){if(Ki(n)<8)break;const u=Yi(n,8),m=new DataView(u.buffer,u.byteOffset,u.length),S=m.getUint32(0);if(S>Math.pow(2,21)-1){c.enqueue(au);break}a=S*Math.pow(2,32)+m.getUint32(4),r=3}else{if(Ki(n)<a)break;const u=Yi(n,a);c.enqueue(ld(i?u:ic.decode(u),t)),r=0}if(a===0||a>e){c.enqueue(au);break}}}})}const um=4;function Ye(e){if(e)return lx(e)}function lx(e){for(var t in Ye.prototype)e[t]=Ye.prototype[t];return e}Ye.prototype.on=Ye.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Ye.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};Ye.prototype.off=Ye.prototype.removeListener=Ye.prototype.removeAllListeners=Ye.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,a=0;a<n.length;a++)if(r=n[a],r===t||r.fn===t){n.splice(a,1);break}return n.length===0&&delete this._callbacks["$"+e],this};Ye.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,a=n.length;r<a;++r)n[r].apply(this,t)}return this};Ye.prototype.emitReserved=Ye.prototype.emit;Ye.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Ye.prototype.hasListeners=function(e){return!!this.listeners(e).length};const so=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),on=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),ox="arraybuffer";function dm(e,...t){return t.reduce((n,r)=>(e.hasOwnProperty(r)&&(n[r]=e[r]),n),{})}const cx=on.setTimeout,ux=on.clearTimeout;function ro(e,t){t.useNativeTimers?(e.setTimeoutFn=cx.bind(on),e.clearTimeoutFn=ux.bind(on)):(e.setTimeoutFn=on.setTimeout.bind(on),e.clearTimeoutFn=on.clearTimeout.bind(on))}const dx=1.33;function hx(e){return typeof e=="string"?fx(e):Math.ceil((e.byteLength||e.size)*dx)}function fx(e){let t=0,n=0;for(let r=0,a=e.length;r<a;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function hm(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function px(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function mx(e){let t={},n=e.split("&");for(let r=0,a=n.length;r<a;r++){let i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class gx extends Error{constructor(t,n,r){super(t),this.description=n,this.context=r,this.type="TransportError"}}class od extends Ye{constructor(t){super(),this.writable=!1,ro(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,r){return super.emitReserved("error",new gx(t,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=ld(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=px(t);return n.length?"?"+n:""}}class vx extends od{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};rx(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,sx(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=hm()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let fm=!1;try{fm=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const xx=fm;function yx(){}class jx extends vx{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,n){const r=this.request({method:"POST",data:t});r.on("success",n),r.on("error",(a,i)=>{this.onError("xhr post error",a,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=t}}class $n extends Ye{constructor(t,n,r){super(),this.createRequest=t,ro(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const n=dm(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&r.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var a;r.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=$n.requestsCount++,$n.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=yx,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete $n.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}$n.requestsCount=0;$n.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",bh);else if(typeof addEventListener=="function"){const e="onpagehide"in on?"pagehide":"unload";addEventListener(e,bh,!1)}}function bh(){for(let e in $n.requests)$n.requests.hasOwnProperty(e)&&$n.requests[e].abort()}const Nx=function(){const e=pm({xdomain:!1});return e&&e.responseType!==null}();class wx extends jx{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=Nx&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new $n(pm,this.uri(),t)}}function pm(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||xx))return new XMLHttpRequest}catch{}if(!t)try{return new on[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const mm=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class _x extends od{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,r=mm?{}:dm(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,r)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;id(r,this.supportsBinary,i=>{try{this.doWrite(r,i)}catch{}a&&so(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=hm()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const lc=on.WebSocket||on.MozWebSocket;class Sx extends _x{createSocket(t,n,r){return mm?new lc(t,n,r):n?new lc(t,n):new lc(t)}doWrite(t,n){this.ws.send(n)}}class kx extends od{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=ix(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),a=ax();a.readable.pipeTo(t.writable),this._writer=a.writable.getWriter();const i=()=>{r.read().then(({done:c,value:u})=>{c||(this.onPacket(u),i())}).catch(c=>{})};i();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;this._writer.write(r).then(()=>{a&&so(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const bx={websocket:Sx,webtransport:kx,polling:wx},Cx=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ex=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function iu(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");n!=-1&&r!=-1&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let a=Cx.exec(e||""),i={},l=14;for(;l--;)i[Ex[l]]=a[l]||"";return n!=-1&&r!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=Ax(i,i.path),i.queryKey=Tx(i,i.query),i}function Ax(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function Tx(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,a,i){a&&(n[a]=i)}),n}const lu=typeof addEventListener=="function"&&typeof removeEventListener=="function",hl=[];lu&&addEventListener("offline",()=>{hl.forEach(e=>e())},!1);class zs extends Ye{constructor(t,n){if(super(),this.binaryType=ox,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const r=iu(t);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=iu(n.host).host);ro(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const a=r.prototype.name;this.transports.push(a),this._transportsByName[a]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=mx(this.opts.query)),lu&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},hl.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=um,n.transport=t,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&zs.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",zs.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const a=this.writeBuffer[r].data;if(a&&(n+=hx(a)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,so(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,r){return this._sendPacket("message",t,n,r),this}send(t,n,r){return this._sendPacket("message",t,n,r),this}_sendPacket(t,n,r,a){if(typeof n=="function"&&(a=n,n=void 0),typeof r=="function"&&(a=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:t,data:n,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(zs.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),lu&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=hl.indexOf(this._offlineEventListener);r!==-1&&hl.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}zs.protocol=um;class Lx extends zs{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),r=!1;zs.priorWebsocketSuccess=!1;const a=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",v=>{if(!r)if(v.type==="pong"&&v.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;zs.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(S(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const x=new Error("probe error");x.transport=n.name,this.emitReserved("upgradeError",x)}}))};function i(){r||(r=!0,S(),n.close(),n=null)}const l=v=>{const x=new Error("probe error: "+v);x.transport=n.name,i(),this.emitReserved("upgradeError",x)};function c(){l("transport closed")}function u(){l("socket closed")}function m(v){n&&v.name!==n.name&&i()}const S=()=>{n.removeListener("open",a),n.removeListener("error",l),n.removeListener("close",c),this.off("close",u),this.off("upgrading",m)};n.once("open",a),n.once("error",l),n.once("close",c),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}let Rx=class extends Lx{constructor(t,n={}){const r=typeof t=="object"?t:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(a=>bx[a]).filter(a=>!!a)),super(t,r)}};function Ox(e,t="",n){let r=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),r=iu(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}const Px=typeof ArrayBuffer=="function",Mx=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,gm=Object.prototype.toString,Ix=typeof Blob=="function"||typeof Blob<"u"&&gm.call(Blob)==="[object BlobConstructor]",Dx=typeof File=="function"||typeof File<"u"&&gm.call(File)==="[object FileConstructor]";function cd(e){return Px&&(e instanceof ArrayBuffer||Mx(e))||Ix&&e instanceof Blob||Dx&&e instanceof File}function fl(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(fl(e[n]))return!0;return!1}if(cd(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return fl(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&fl(e[n]))return!0;return!1}function Bx(e){const t=[],n=e.data,r=e;return r.data=ou(n,t),r.attachments=t.length,{packet:r,buffers:t}}function ou(e,t){if(!e)return e;if(cd(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=ou(e[r],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=ou(e[r],t));return n}return e}function zx(e,t){return e.data=cu(e.data,t),delete e.attachments,e}function cu(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=cu(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=cu(e[n],t));return e}const vm=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],$x=5;var de;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(de||(de={}));class Ux{constructor(t){this.replacer=t}encode(t){return(t.type===de.EVENT||t.type===de.ACK)&&fl(t)?this.encodeAsBinary({type:t.type===de.EVENT?de.BINARY_EVENT:de.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===de.BINARY_EVENT||t.type===de.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=Bx(t),r=this.encodeAsString(n.packet),a=n.buffers;return a.unshift(r),a}}class ud extends Ye{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const r=n.type===de.BINARY_EVENT;r||n.type===de.BINARY_ACK?(n.type=r?de.EVENT:de.ACK,this.reconstructor=new Vx(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(cd(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const r={type:Number(t.charAt(0))};if(de[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===de.BINARY_EVENT||r.type===de.BINARY_ACK){const i=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const l=t.substring(i,n);if(l!=Number(l)||t.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(l)}if(t.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););r.nsp=t.substring(i,n)}else r.nsp="/";const a=t.charAt(n+1);if(a!==""&&Number(a)==a){const i=n+1;for(;++n;){const l=t.charAt(n);if(l==null||Number(l)!=l){--n;break}if(n===t.length)break}r.id=Number(t.substring(i,n+1))}if(t.charAt(++n)){const i=this.tryParse(t.substr(n));if(ud.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case de.CONNECT:return $l(n);case de.DISCONNECT:return n===void 0;case de.CONNECT_ERROR:return typeof n=="string"||$l(n);case de.EVENT:case de.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&vm.indexOf(n[0])===-1);case de.ACK:case de.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Vx{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=zx(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Fx(e){return typeof e=="string"}const Wx=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};function Hx(e){return e===void 0||Wx(e)}function $l(e){return Object.prototype.toString.call(e)==="[object Object]"}function qx(e,t){switch(e){case de.CONNECT:return t===void 0||$l(t);case de.DISCONNECT:return t===void 0;case de.EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&vm.indexOf(t[0])===-1);case de.ACK:return Array.isArray(t);case de.CONNECT_ERROR:return typeof t=="string"||$l(t);default:return!1}}function Gx(e){return Fx(e.nsp)&&Hx(e.id)&&qx(e.type,e.data)}const Qx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ud,Encoder:Ux,get PacketType(){return de},isPacketValid:Gx,protocol:$x},Symbol.toStringTag,{value:"Module"}));function xn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Kx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class xm extends Ye{constructor(t,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[xn(t,"open",this.onopen.bind(this)),xn(t,"packet",this.onpacket.bind(this)),xn(t,"error",this.onerror.bind(this)),xn(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var r,a,i;if(Kx.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const l={type:de.EVENT,data:n};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const S=this.ids++,v=n.pop();this._registerAckCallback(S,v),l.id=S}const c=(a=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||a===void 0?void 0:a.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!c||(u?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(t,n){var r;const a=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(a===void 0){this.acks[t]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===t&&this.sendBuffer.splice(c,1);n.call(this,new Error("operation has timed out"))},a),l=(...c)=>{this.io.clearTimeoutFn(i),n.apply(this,c)};l.withError=!0,this.acks[t]=l}emitWithAck(t,...n){return new Promise((r,a)=>{const i=(l,c)=>l?a(l):r(c);i.withError=!0,n.push(i),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((a,...i)=>(this._queue[0],a!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(a)):(this._queue.shift(),n&&n(null,...i)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:de.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case de.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case de.EVENT:case de.BINARY_EVENT:this.onevent(t);break;case de.ACK:case de.BINARY_ACK:this.onack(t);break;case de.DISCONNECT:this.ondisconnect();break;case de.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let r=!1;return function(...a){r||(r=!0,n.packet({type:de.ACK,id:t,data:a}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:de.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,t.data)}}}function ta(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}ta.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};ta.prototype.reset=function(){this.attempts=0};ta.prototype.setMin=function(e){this.ms=e};ta.prototype.setMax=function(e){this.max=e};ta.prototype.setJitter=function(e){this.jitter=e};class uu extends Ye{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,ro(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new ta({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const a=n.parser||Qx;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Rx(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const a=xn(n,"open",function(){r.onopen(),t&&t()}),i=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),t?t(c):this.maybeReconnectOnOpen()},l=xn(n,"error",i);if(this._timeout!==!1){const c=this._timeout,u=this.setTimeoutFn(()=>{a(),i(new Error("timeout")),n.close()},c);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(a),this.subs.push(l),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(xn(t,"ping",this.onping.bind(this)),xn(t,"data",this.ondata.bind(this)),xn(t,"error",this.onerror.bind(this)),xn(t,"close",this.onclose.bind(this)),xn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){so(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new xm(this,t,n),this.nsps[t]=r),r}_destroy(t){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let r=0;r<n.length;r++)this.engine.write(n[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(a=>{a?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",a)):t.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Sa={};function pl(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=Ox(e,t.path||"/socket.io"),r=n.source,a=n.id,i=n.path,l=Sa[a]&&i in Sa[a].nsps,c=t.forceNew||t["force new connection"]||t.multiplex===!1||l;let u;return c?u=new uu(r,t):(Sa[a]||(Sa[a]=new uu(r,t)),u=Sa[a]),n.query&&!t.query&&(t.query=n.queryKey),u.socket(n.path,t)}Object.assign(pl,{Manager:uu,Socket:xm,io:pl,connect:pl});const Yx="http://localhost:3000";function Xx(e){return pl(Yx,{auth:{token:e}})}const ym=h.createContext(null);function Jx({children:e}){const[t,n]=h.useState([]),r=h.useRef(new Map),a=c=>{n(m=>m.filter(S=>S.id!==c));const u=r.current.get(c);u&&(clearTimeout(u),r.current.delete(c))},i=({message:c,type:u="success",actionLabel:m,onAction:S,duration:v=6e3})=>{const x=`${Date.now()}-${Math.random().toString(36).slice(2,8)}`;if(n(E=>[...E,{id:x,message:c,type:u,actionLabel:m,onAction:S,duration:v}]),v>0){const E=setTimeout(()=>a(x),v);r.current.set(x,E)}return x},l=c=>c==="error"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 4.5c.5 0 .95.26 1.2.68l6.5 11.25a1.35 1.35 0 0 1-1.2 2.02H5.5a1.35 1.35 0 0 1-1.2-2.02L10.8 5.18c.25-.42.7-.68 1.2-.68Zm0 4.25a.9.9 0 0 0-.9.9v5.5a.9.9 0 1 0 1.8 0v-5.5a.9.9 0 0 0-.9-.9Zm0 8.3a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Z",fill:"currentColor"})}):c==="info"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 3.5a8.5 8.5 0 1 1 0 17 8.5 8.5 0 0 1 0-17Zm0 3.9a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Zm-1.2 4.2h2.4v6.1h-2.4v-6.1Z",fill:"currentColor"})}):s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M9.5 16.6 5.6 12.7a1 1 0 1 1 1.4-1.4l2.5 2.5 7.5-7.5a1 1 0 1 1 1.4 1.4l-8.9 8.9a1 1 0 0 1-1.4 0Z",fill:"currentColor"})});return s.jsxs(ym.Provider,{value:{pushToast:i,removeToast:a},children:[e,s.jsx("div",{className:"toast-container",children:t.map(c=>s.jsxs("div",{className:`toast toast-${c.type}`,style:{"--toast-duration":`${c.duration}ms`},children:[s.jsx("div",{className:"toast-icon",children:l(c.type)}),s.jsx("div",{className:"toast-message",children:c.message}),c.actionLabel&&s.jsx("button",{className:"toast-action",type:"button",onClick:()=>{c.onAction&&Promise.resolve(c.onAction()).catch(()=>{}),a(c.id)},children:c.actionLabel}),s.jsx("button",{className:"toast-close",type:"button",onClick:()=>a(c.id),children:"x"}),c.duration>0&&s.jsx("div",{className:`toast-progress toast-progress-${c.type}`})]},c.id))})]})}function dd(){const e=h.useContext(ym);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function Zx({user:e,isOpen:t,onToggle:n,onLogout:r,onReturnToSuperadmin:a,showReturnToSuperadmin:i,getInitial:l}){return s.jsxs("div",{className:"rail-profile",children:[s.jsx("button",{className:`profile-button ${t?"active":""}`,type:"button",onClick:n,title:"Perfil","aria-label":"Perfil",children:s.jsx("span",{children:l(e.name)})}),t&&s.jsxs("div",{className:"profile-card",children:[s.jsx("div",{className:"profile-title",children:e.name}),s.jsx("div",{className:"profile-meta",children:e.email||"Sin correo"}),s.jsx("div",{className:"profile-role",children:e.role}),i?s.jsx("button",{className:"ghost",type:"button",onClick:a,children:"Volver a superadmin"}):null,s.jsx("button",{className:"primary",type:"button",onClick:r,children:"Salir"})]})]})}function ey({navItems:e,view:t,onSetView:n,theme:r,onToggleTheme:a,user:i,logoUrl:l,brandName:c,isProfileOpen:u,onToggleProfile:m,onLogout:S,onReturnToSuperadmin:v,showReturnToSuperadmin:x,getInitial:E,SunIcon:L,MoonIcon:O}){const g=(c||"P").trim().charAt(0)||"P";return s.jsxs("aside",{className:"nav-rail",children:[s.jsx("button",{className:"rail-logo",type:"button",title:c||"Logo",children:l?s.jsx("img",{src:l,alt:c||"Logo"}):s.jsx("span",{className:"logo-mark",children:g})}),s.jsx("nav",{className:"rail-nav",children:e.map(f=>{const p=f.icon;return s.jsx("button",{className:`rail-button ${t===f.id?"active":""}`,onClick:()=>f.enabled&&n(f.id),title:f.label,"aria-label":f.label,type:"button",disabled:!f.enabled,children:s.jsx(p,{className:"rail-icon"})},f.id)})}),s.jsx("div",{className:"rail-spacer"}),s.jsx("button",{className:"rail-button",type:"button",onClick:a,title:r==="dark"?"Tema claro":"Tema oscuro","aria-label":r==="dark"?"Tema claro":"Tema oscuro",children:r==="dark"?s.jsx(L,{className:"rail-icon"}):s.jsx(O,{className:"rail-icon"})}),s.jsx(Zx,{user:i,isOpen:u,onToggle:m,onLogout:S,onReturnToSuperadmin:v,showReturnToSuperadmin:x,getInitial:E})]})}function ty({activeConversation:e,conversations:t,channels:n,brandName:r,lastReadMap:a,filters:i,showFilters:l,users:c,tags:u,statusOptions:m,statusLabels:S,formatListTime:v,messageBlocks:x,messageDraft:E,messageMode:L,quickActions:O,tagInput:g,noteInput:f,notesList:p,latestNote:j,loadingConversation:k,isInfoOpen:P,hasUnread:$,scrollDayLabel:B,activeName:w,activePhone:D,activeStatusLabel:R,canManageStatus:X,currentUser:he,messageInputRef:je,chatBodyRef:Ee,setShowFilters:Re,setFilters:Te,loadConversation:Xe,handleBackToList:W,setIsInfoOpen:te,handleChatScroll:Z,handleAssignSelf:ce,handleStatusChange:oe,handleToggleTag:Oe,handleAddTag:A,setNoteInput:q,handleAddNote:b,reassignUserId:U,setReassignUserId:G,handleReassignConversation:ie,handleOpenTagManager:fe,handleCloseTagManager:pe,showTagManager:nt,tagManagerForm:lt,setTagManagerForm:_t,handleCreateTag:ge,handleDeleteTag:St,handleQuickAction:Mt,handleSendMessage:Ut,setMessageMode:qe,setMessageDraft:be,scrollChatToBottom:st,getInitial:kt,PlusIcon:Xt,SearchIcon:ot,VideoIcon:_n,PhoneIcon:Je,InfoIcon:ve,SendIcon:Jt}){const F=new Map((n||[]).map(T=>[T.phone_number_id,T.display_name||(T.phone_number_id?`Linea ${String(T.phone_number_id).slice(-4)}`:"")])),_e=(e==null?void 0:e.assigned_user_id)&&e.assigned_user_id!==(he==null?void 0:he.id);function xe(T){if(!T)return"Sin mensajes";const Ce=T.last_message_preview||T.last_message_text||T.last_message||"";return Ce||(T.last_message_type?`[${T.last_message_type}]`:"Sin mensajes")}return s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:`chat-shell ${e?"has-active":""}`,children:[s.jsxs("aside",{className:"chat-list-panel",children:[s.jsxs("div",{className:"chat-list-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"list-title",children:(r||"Perzivalh").toUpperCase()}),s.jsx("div",{className:"list-subtitle",children:"Chats"})]}),s.jsx("button",{className:"icon-button add-chat",type:"button",title:"Nuevo chat",children:s.jsx(Xt,{className:"icon"})})]}),s.jsxs("div",{className:"chat-search",children:[s.jsx(ot,{className:"search-icon"}),s.jsx("input",{type:"text",placeholder:"Buscar pacientes o mensajes",value:i.search,onFocus:()=>Re(!0),onClick:()=>Re(!0),onChange:T=>Te(Ce=>({...Ce,search:T.target.value}))}),l&&s.jsx("button",{className:"search-close",type:"button",onClick:()=>Re(!1),"aria-label":"Cerrar filtros",children:"x"})]}),l&&s.jsxs("div",{className:"chat-filters",children:[s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Status"}),s.jsxs("select",{value:i.status,onChange:T=>Te(Ce=>({...Ce,status:T.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),m.map(T=>s.jsx("option",{value:T,children:S[T]||T},T))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Asignado"}),s.jsxs("select",{value:i.assigned_user_id,onChange:T=>Te(Ce=>({...Ce,assigned_user_id:T.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"unassigned",children:"Sin asignar"}),c.map(T=>s.jsx("option",{value:T.id,children:T.name},T.id))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Tags"}),s.jsxs("select",{value:i.tag,onChange:T=>Te(Ce=>({...Ce,tag:T.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),u.map(T=>s.jsx("option",{value:T.name,children:T.name},T.id))]})]})]}),s.jsxs("div",{className:"list-header",children:[s.jsxs("select",{className:"line-filter",value:i.phone_number_id,onChange:T=>Te(Ce=>({...Ce,phone_number_id:T.target.value})),children:[s.jsx("option",{value:"",children:"Todas las lineas"}),(n||[]).map(T=>s.jsx("option",{value:T.phone_number_id,children:T.display_name||`Linea ${String(T.phone_number_id).slice(-4)}`},T.id))]}),s.jsx("span",{children:t.length})]}),s.jsx("div",{className:"conversation-list",children:t.map((T,Ce)=>{var Se,pt,bt;const Zt=(e==null?void 0:e.id)===T.id,Sn=T.status==="pending"&&!T.assigned_user_id,Vn=T.display_name||T.phone_e164||T.wa_id||"Sin nombre",Fn=xe(T),Wn=Number(T.unread_count||T.unread_messages||T.unread||0),Hn=((pt=(Se=T.tags)==null?void 0:Se[0])==null?void 0:pt.name)||"",en=(bt=T.assigned_user)!=null&&bt.name?`Tomada por ${T.assigned_user.name}`:"",_=T.phone_number_id?F.get(T.phone_number_id)||`Linea ${String(T.phone_number_id).slice(-4)}`:"",V=(a==null?void 0:a[T.id])||null,Q=T.last_message_at,re=Q&&(!V||new Date(Q).getTime()>new Date(V).getTime())&&T.last_message_direction==="in";return s.jsxs("button",{className:`conversation-item ${Zt?"active":""}`,onClick:()=>Xe(T.id),style:{animationDelay:`${Math.min(Ce,6)*60}ms`},children:[s.jsxs("div",{className:"avatar",children:[s.jsx("span",{children:kt(Vn)}),Sn&&s.jsx("span",{className:"presence-dot"})]}),s.jsxs("div",{className:"conversation-body",children:[s.jsxs("div",{className:"conversation-row",children:[s.jsx("span",{className:"conversation-name",children:Vn}),s.jsxs("div",{className:"conversation-right",children:[s.jsx("span",{className:"conversation-time",children:v(T.last_message_at)}),Wn>0&&s.jsx("span",{className:"conversation-unread",children:Wn})]})]}),s.jsx("div",{className:`conversation-preview ${re?"unread":""}`,children:Fn}),s.jsxs("div",{className:"conversation-meta",children:[_&&s.jsx("span",{className:"status-pill line-pill",children:_}),en&&s.jsx("span",{className:"status-pill assignee-pill",children:en}),Hn&&s.jsx("span",{className:"status-pill tag-pill",children:Hn})]})]})]},T.id)})})]}),s.jsxs("div",{className:`chat-view ${P?"info-open":"info-closed"}`,children:[s.jsx("div",{className:"chat-main",children:s.jsxs("div",{className:"chat-card",children:[s.jsxs("header",{className:"chat-topbar",children:[s.jsxs("div",{className:"chat-title",children:[e&&s.jsx("button",{className:"back-button",type:"button",onClick:W,children:"Chats"}),s.jsx("div",{className:"chat-avatar",children:s.jsx("span",{children:kt(w)})}),s.jsxs("div",{children:[s.jsx("div",{className:"chat-name",children:w}),e?s.jsx("div",{className:"chat-status",children:R}):s.jsx("div",{className:"chat-status muted",children:"Elige una conversacion"})]})]}),s.jsxs("div",{className:"chat-actions",children:[s.jsx("button",{className:"icon-button",type:"button",title:"Video",children:s.jsx(_n,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Llamar",children:s.jsx(Je,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Buscar",children:s.jsx(ot,{className:"icon"})}),s.jsx("button",{className:`icon-button ${P?"active":""}`,type:"button",title:"Info",onClick:()=>te(T=>!T),children:s.jsx(ve,{className:"icon"})})]})]}),s.jsxs("div",{className:"chat-body",ref:Ee,onScroll:Z,children:[B&&s.jsx("div",{className:"chat-day-sticky","aria-hidden":"true",children:B}),k&&s.jsx("div",{className:"empty",children:"Cargando..."}),!k&&!e&&s.jsx("div",{className:"empty",children:"Selecciona una conversacion"}),!k&&e&&s.jsx(s.Fragment,{children:x.length?x:s.jsx("div",{className:"empty-state",children:"Sin mensajes"})})]}),$&&s.jsx("button",{className:"new-message-banner",type:"button",onClick:st,children:"Nuevos mensajes"}),s.jsxs("form",{className:"chat-composer",onSubmit:Ut,children:[_e&&s.jsx("div",{className:"assign-warning",children:"Conversacion tomada por otro operador."}),O.length>0&&s.jsx("div",{className:"quick-actions",children:O.map(T=>s.jsx("button",{className:"quick-action",type:"button",onClick:()=>Mt(T),disabled:_e,children:T},T))}),s.jsxs("div",{className:"composer-row",children:[s.jsxs("select",{className:"message-mode",value:L,onChange:T=>qe(T.target.value),disabled:_e,children:[s.jsx("option",{value:"text",children:"WhatsApp"}),s.jsx("option",{value:"note",children:"Nota interna"})]}),s.jsx("input",{ref:je,type:"text",placeholder:"Escribe un mensaje...",value:E,onChange:T=>be(T.target.value),disabled:_e}),s.jsx("button",{className:"send-button",type:"submit",disabled:_e,children:s.jsx(Jt,{className:"icon"})})]})]})]})}),s.jsxs("aside",{className:"chat-info",children:[s.jsxs("div",{className:"info-card",children:[s.jsx("div",{className:"info-avatar",children:s.jsx("span",{children:kt(w)})}),s.jsx("div",{className:"info-name",children:w}),s.jsx("div",{className:"info-phone",children:D||"Sin telefono"})]}),s.jsxs("div",{className:"info-section",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("div",{className:"section-title",children:"Etiquetas"}),s.jsx("button",{className:"link-button",type:"button",onClick:fe,children:"Gestionar"})]}),s.jsx("div",{className:"tag-list",children:((e==null?void 0:e.tags)||[]).length?e.tags.map(T=>s.jsxs("span",{className:"tag-chip",children:[s.jsx("span",{className:"tag-chip-label",children:T.name}),s.jsx("button",{className:"tag-remove",type:"button",title:"Quitar etiqueta",onClick:()=>Oe(T.name),children:"x"})]},T.name)):s.jsx("div",{className:"empty-state",children:"Sin etiquetas"})}),s.jsxs("form",{className:"tag-form",onSubmit:A,children:[s.jsxs("select",{value:g,onChange:T=>setTagInput(T.target.value),children:[s.jsx("option",{value:"",children:"Selecciona etiqueta..."}),u.filter(T=>!((e==null?void 0:e.tags)||[]).some(Ce=>Ce.name===T.name)).map(T=>s.jsx("option",{value:T.name,children:T.name},T.id))]}),s.jsx("button",{className:"icon-button",type:"submit",title:"Agregar",children:s.jsx(Xt,{className:"icon"})})]})]}),s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Notas internas"}),p!=null&&p.length?s.jsx("div",{className:"notes-stack",children:p.slice(-5).map(T=>s.jsx("div",{className:"note-card",children:T.text},T.id))}):s.jsx("div",{className:"empty-state",children:"Sin notas internas"}),s.jsxs("form",{className:"note-form",onSubmit:b,children:[s.jsx("input",{type:"text",placeholder:"Agregar nota interna...",value:f,onChange:T=>q(T.target.value),disabled:!e}),s.jsx("button",{className:"icon-button",type:"submit",title:"Guardar nota",children:s.jsx(Xt,{className:"icon"})})]})]}),e&&s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Acciones"}),s.jsxs("div",{className:"action-stack",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:ce,disabled:_e,children:"Tomar conversacion"}),X&&s.jsxs("div",{className:"reassign-card",children:[s.jsxs("select",{value:U,onChange:T=>G(T.target.value),children:[s.jsx("option",{value:"",children:"Reasignar a..."}),c.map(T=>s.jsx("option",{value:T.id,children:T.name},T.id))]}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:ie,disabled:!U,children:"Reasignar"})]}),X&&s.jsxs("div",{className:"action-row",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>oe("open"),children:"Reactivar bot"}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>oe("pending"),children:"Liberar para otro operador"})]})]})]})]})]})]}),nt&&s.jsx("div",{className:"modal-overlay",onClick:pe,children:s.jsxs("div",{className:"modal-card",onClick:T=>T.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Gestion de etiquetas"}),s.jsx("button",{className:"modal-close",type:"button",onClick:pe,children:"x"})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("form",{className:"tag-manager-form",onSubmit:ge,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:lt.name,onChange:T=>_t(Ce=>({...Ce,name:T.target.value})),placeholder:"Nombre de etiqueta"})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Color"}),s.jsx("input",{type:"color",value:lt.color,onChange:T=>_t(Ce=>({...Ce,color:T.target.value}))})]}),s.jsx("div",{className:"modal-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Crear etiqueta"})})]}),s.jsx("div",{className:"tag-manager-list",children:(u||[]).map(T=>s.jsxs("div",{className:"tag-manager-row",children:[s.jsx("span",{className:"tag-chip",style:{borderColor:T.color||"#cbd5f5"},children:s.jsx("span",{className:"tag-chip-label",children:T.name})}),s.jsx("div",{className:"tag-manager-actions",children:s.jsx("button",{className:"danger soft",type:"button",onClick:()=>St(T.id,T.name),children:"Eliminar"})})]},T.id))})]})]})})]})}const ny=[{day:"2024-01-01",in_count:210,out_count:90},{day:"2024-01-04",in_count:280,out_count:120},{day:"2024-01-07",in_count:240,out_count:110},{day:"2024-01-10",in_count:320,out_count:140},{day:"2024-01-13",in_count:300,out_count:130},{day:"2024-01-17",in_count:310,out_count:135},{day:"2024-01-20",in_count:290,out_count:120},{day:"2024-01-24",in_count:260,out_count:115},{day:"2024-01-27",in_count:330,out_count:150},{day:"2024-01-30",in_count:340,out_count:160}];function sy(e){const t=e?new Date(e):null;if(!t||Number.isNaN(t.getTime()))return"--";const n=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];return`${String(t.getDate()).padStart(2,"0")} ${n[t.getMonth()].toUpperCase()}`}function Ch(e){return e.length?e.map((t,n)=>`${n===0?"M":"L"}${t.x} ${t.y}`).join(" "):""}function ry({statusCounts:e,metrics:t,onRefresh:n,brandName:r}){var w;const a=(r||"Empresa").trim(),i=a?`${a} Enterprise`:"Enterprise",l=(e.open||0)+(e.pending||0),c=t!=null&&t.avg_first_reply_seconds?Number(t.avg_first_reply_seconds)/60:null,u=c?`${c.toFixed(1)}m`:"-",m=(t==null?void 0:t.conversion_rate)??(t==null?void 0:t.conversion_rate_percent)??null,v=`${(m==null?18.4:m>1?m:m*100).toFixed(1)}%`,x=((w=t==null?void 0:t.message_volume)==null?void 0:w.length)>0?t.message_volume.slice(-10):ny,E=Math.max(...x.map(D=>D.in_count+D.out_count),1),L=x.length*42+30,O=220,g=150,f=180,p=x.map((D,R)=>{const he=(D.in_count+D.out_count)/E*g,je=D.in_count/E*g,Ee=D.out_count/E*g;return{x:22+R*42,totalHeight:he,inHeight:je,outHeight:Ee}}),j=Ch(p.map((D,R)=>({x:D.x+10,y:f-D.inHeight}))),k=Ch(p.map(D=>({x:D.x+10,y:f-D.outHeight}))),P=Array.from(new Set([0,Math.floor(x.length/3),Math.floor(2*x.length/3),x.length-1])),$=Math.round((t==null?void 0:t.team_efficiency)||94),B=((t==null?void 0:t.top_tags)||[]).slice(0,3);return s.jsxs("section",{className:"dashboard-layout",children:[s.jsxs("div",{className:"dashboard-main",children:[s.jsxs("header",{className:"dashboard-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dashboard-kicker",children:i}),s.jsx("h2",{className:"dashboard-title",children:"Dashboard"}),s.jsx("div",{className:"dashboard-subtitle",children:"Marketing Analytics & WhatsApp CRM Overview"})]}),s.jsxs("div",{className:"dashboard-actions",children:[s.jsxs("button",{className:"dash-filter",type:"button",children:[s.jsx("span",{className:"dash-filter-icon","aria-hidden":"true"}),"Ultimos 30 dias"]}),s.jsx("button",{className:"primary",type:"button",onClick:n,children:"Generar Reporte"})]})]}),s.jsxs("div",{className:"dashboard-kpis",children:[s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Conversaciones activas"}),s.jsx("div",{className:"dash-kpi-value",children:l.toLocaleString()})]}),s.jsx("div",{className:"dash-kpi-icon",children:"C"})]}),s.jsx("div",{className:"dash-kpi-change up",children:"+12.5%"})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tiempo de respuesta"}),s.jsx("div",{className:"dash-kpi-value",children:u})]}),s.jsx("div",{className:"dash-kpi-icon",children:"T"})]}),s.jsx("div",{className:"dash-kpi-change down",children:"-0.8m"})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tasa de conversion"}),s.jsx("div",{className:"dash-kpi-value",children:v})]}),s.jsx("div",{className:"dash-kpi-icon",children:"%"})]}),s.jsx("div",{className:"dash-kpi-change up",children:"+2.1%"})]})]}),s.jsxs("div",{className:"dash-card dash-chart-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-card-title",children:"Flujo de Mensajes"}),s.jsx("div",{className:"dash-card-subtitle",children:"Volumen diario"})]}),s.jsxs("div",{className:"dash-legend",children:[s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot in"})," Entrantes"]}),s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot out"})," Salientes"]})]})]}),s.jsx("div",{className:"dash-chart",children:s.jsxs("svg",{className:"dash-chart-svg",viewBox:`0 0 ${L} ${O}`,preserveAspectRatio:"none",children:[s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"60",x2:L,y2:"60"}),s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"120",x2:L,y2:"120"}),p.map((D,R)=>s.jsxs("g",{children:[s.jsx("rect",{className:"dash-bar in",x:D.x,y:f-D.inHeight,width:"20",height:D.inHeight,rx:"6"}),s.jsx("rect",{className:"dash-bar out",x:D.x,y:f-D.inHeight-D.outHeight,width:"20",height:D.outHeight,rx:"6"})]},`bar-${R}`)),s.jsx("path",{className:"dash-line in",d:j}),s.jsx("path",{className:"dash-line out",d:k})]})}),s.jsx("div",{className:"dash-chart-labels",children:P.map(D=>{var R;return s.jsx("span",{children:sy((R=x[D])==null?void 0:R.day)},`label-${D}`)})})]}),s.jsxs("div",{className:"dashboard-lower",children:[s.jsxs("div",{className:"dash-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsx("div",{className:"dash-card-title",children:"Ultimas etiquetas detectadas"}),s.jsx("button",{className:"link-button",type:"button",children:"Ver todo"})]}),s.jsxs("div",{className:"dash-tag-table",children:[s.jsxs("div",{className:"dash-tag-head",children:[s.jsx("span",{children:"Etiqueta"}),s.jsx("span",{children:"Frecuencia"}),s.jsx("span",{children:"Accion"})]}),B.map(D=>s.jsxs("div",{className:"dash-tag-row",children:[s.jsx("span",{className:"dash-tag-chip",children:D.name}),s.jsx("span",{className:"dash-tag-count",children:D.count}),s.jsx("span",{className:"dash-tag-action",children:">"})]},D.name)),!B.length&&s.jsx("div",{className:"empty-state",children:"Sin etiquetas recientes"})]})]}),s.jsxs("div",{className:"dash-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsx("div",{className:"dash-card-title",children:"Actividad de Campana"}),s.jsx("span",{className:"dash-pill",children:"Monitor"})]}),s.jsxs("div",{className:"dash-campaign",children:[s.jsx("div",{className:"dash-campaign-title",children:'Campana de Verano "Pies Sanos"'}),s.jsxs("div",{className:"dash-campaign-meta",children:[s.jsx("span",{className:"dash-pill solid",children:"84% enviado"}),s.jsx("span",{className:"dash-muted",children:"Hace 2 horas"})]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:"84%"}})}),s.jsx("div",{className:"dash-muted",children:"1,240 destinatarios"})]})]})]})]}),s.jsxs("aside",{className:"dashboard-side",children:[s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Performance de Operadores"}),s.jsx("div",{className:"dash-card-subtitle",children:"Top 5 leaderboard - hoy"}),s.jsx("div",{className:"dash-operator-list",children:[{name:"Lucia Fernandez",role:"Especialista CRM",resolved:84,pending:3},{name:"Ricardo Gomez",role:"Atencion Pacientes",resolved:71,pending:8},{name:"Ana Martinez",role:"Soporte Medico",resolved:65,pending:12}].map(D=>s.jsxs("div",{className:"dash-operator",children:[s.jsx("div",{className:"dash-operator-avatar",children:D.name[0]}),s.jsxs("div",{className:"dash-operator-meta",children:[s.jsx("div",{className:"dash-operator-name",children:D.name}),s.jsx("div",{className:"dash-operator-role",children:D.role}),s.jsxs("div",{className:"dash-operator-stats",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Resueltos"}),s.jsx("div",{className:"dash-stat-value",children:D.resolved})]}),s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Pendientes"}),s.jsx("div",{className:"dash-stat-value danger",children:D.pending})]})]})]})]},D.name))})]}),s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Eficiencia de Equipo"}),s.jsxs("div",{className:"dash-efficiency",children:[s.jsxs("div",{className:"dash-efficiency-value",children:[$,"%"]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:`${$}%`}})}),s.jsx("div",{className:"dash-muted",children:"Objetivo diario: 500 conversiones"})]})]})]})]})}const Eh={draft:"BORRADOR",scheduled:"PROGRAMADA",running:"ENVIANDO",sending:"ENVIANDO",completed:"FINALIZADA",sent:"FINALIZADA",paused:"PAUSADA",failed:"ERROR"},Xi={APPROVED:{label:"APROBADA",className:"approved"},PENDING:{label:"PENDIENTE",className:"pending"},REJECTED:{label:"RECHAZADA",className:"rejected"},DRAFT:{label:"BORRADOR",className:"draft"},PAUSED:{label:"PAUSADA",className:"pending"},DISABLED:{label:"DESHABILITADA",className:"draft"}},Ah={MARKETING:"MARKETING",UTILITY:"UTILIDAD",AUTHENTICATION:"AUTENTICACION"},Ji=[{id:"audiences",label:"Audiencias",title:"Audiencias",subtitle:"MDULO DE GESTIN Y CAMPAAS"},{id:"templates",label:"Biblioteca de Plantillas",title:"Biblioteca de Plantillas",subtitle:"Consulta y gestiona las plantillas de mensajes autorizadas por WhatsApp."},{id:"new",label:"Campaas",title:"Campaas",subtitle:"Historial de envos y difusin WhatsApp"}],ay={audiencias:"audiences",audiences:"audiences",templates:"templates",plantillas:"templates",biblioteca:"templates",nueva:"new",campaign:"new",campaigns:"new",nueva_campana:"new",history:"new",historial:"new"},Th=[{id:"dynamic",label:"Audiencias Dinmicas",title:"Automatizacin de Audiencias y Tags",subtitle:"Unificacin de flujos de datos Perzivalh CRM",actionLabel:"Guardar Configuracin"},{id:"excel",label:"Importar Excel",title:"Importacin de Contactos Excel",subtitle:"Gestin de base de datos externa Perzivalh CRM",actionLabel:"Iniciar Importacin"},{id:"odoo",label:"Importar de Odoo",title:"Sincronizacin Inteligente Odoo",subtitle:"Automatizacin de audiencias Perzivalh OS",actionLabel:"Actualizar Lista Odoo"}],iy=[{value:"phone",label:"Telfono"},{value:"name",label:"Nombre Completo"},{value:"city",label:"Ciudad"},{value:"tags",label:"Etiquetas"},{value:"ignore",label:"Sin Mapear"}];function ly({campaignForm:e,setCampaignForm:t,campaignFilter:n,setCampaignFilter:r,templates:a,campaigns:i,selectedCampaignId:l,campaignMessages:c,users:u,tags:m,channels:S,selectedTemplate:v,statusOptions:x,onCreateCampaign:E,onLoadCampaigns:L,onLoadCampaignMessages:O,onSendCampaign:g,onUpdateCampaign:f,onDeleteCampaign:p,onResendCampaign:j,campaignsTotal:k,formatDate:P,brandName:$}){var Ai,Ti,Li;const B=($||"Perzivalh").trim(),[w,D]=h.useState(""),[R,X]=h.useState("all"),[he,je]=h.useState(!1),[Ee,Re]=h.useState(null),[Te,Xe]=h.useState(""),[W,te]=h.useState(!1),[Z,ce]=h.useState(""),[oe,Oe]=h.useState("all"),[A,q]=h.useState(!1),[b,U]=h.useState(null),[G,ie]=h.useState(""),[fe,pe]=h.useState(null),[nt,lt]=h.useState("down"),[_t,ge]=h.useState(null),[St,Mt]=h.useState(!1),[Ut,qe]=h.useState(!1),[be,st]=h.useState({id:"",name:"",phone:"",email:"",vat:""}),[kt,Xt]=h.useState(e.send_now===!1||e.scheduled_for?"schedule":"now"),[ot,_n]=h.useState(1),[Je]=h.useState(6),{pushToast:ve}=dd(),Jt=h.useRef(null),[F,_e]=h.useState(!1),[xe,T]=h.useState("dynamic"),Ce=h.useMemo(()=>Th.map(o=>({...o,subtitle:o.subtitle.replace(/Perzivalh/g,B)})),[B]),[Zt,Sn]=h.useState({enabled:!1,phone_number_id:null}),[Vn,Fn]=h.useState(!1),[Wn,Hn]=h.useState([]),[en,_]=h.useState(!1),[V,Q]=h.useState(!1),[re,Se]=h.useState(""),[pt,bt]=h.useState(null),[mt,qn]=h.useState(""),[Vt,na]=h.useState(null),[sa,ps]=h.useState([]),[ee,se]=h.useState({targetMode:"new",listName:"",targetSegmentId:"",prefix:"",ignoreDuplicates:!0}),[fn,Gn]=h.useState(null),[Hs,ms]=h.useState(!1),[ra,qs]=h.useState({connected:!1}),[ci,gs]=h.useState(!1),[Qn,ui]=h.useState(!1),[vs,ao]=h.useState(null),[Be,di]=h.useState(()=>{if(typeof window>"u")return"templates";const y=new URLSearchParams(window.location.search).get("tab");return y?ay[y]||y:"templates"}),[xr,hi]=h.useState(null),[kn,fi]=h.useState(null),[Gs,Qs]=h.useState([]),[pi,aa]=h.useState(0),[mi,Ft]=h.useState(!1),[bn,Ct]=h.useState(""),[Kn,Yn]=h.useState(new Set),[xs,rt]=h.useState(""),[Ks,Ys]=h.useState(!1),[gt,Xs]=h.useState(1),[ys]=h.useState(10),[tn,io]=h.useState({tag:"Todas",date:"Cualquier fecha",status:"Activos"}),[ct,yr]=h.useState(null),Ge=h.useRef(null),Wt=h.useMemo(()=>(S||[]).filter(o=>o==null?void 0:o.phone_number_id),[S]),[js,gi]=h.useState(""),ke=h.useMemo(()=>Wt.find(o=>o.phone_number_id===js)||Wt[0]||null,[Wt,js]),Js=(ke==null?void 0:ke.display_name)||(ke==null?void 0:ke.phone_number_id)||"";h.useEffect(()=>{const o=e.send_now===!1||e.scheduled_for?"schedule":"now";Xt(o)},[e.send_now,e.scheduled_for]);const[Xn,jr]=h.useState([]);h.useEffect(()=>{vt(),ia()},[]),h.useEffect(()=>{!js&&Wt.length&&gi(Wt[0].phone_number_id)},[Wt,js]),h.useEffect(()=>{F&&(la(),Ns(),Nr())},[F,js]),h.useEffect(()=>{if(Be!=="new"||A)return;const o=setTimeout(()=>{_n(1),L(1,Je,Z.trim())},350);return()=>clearTimeout(o)},[Z,Je,A,Be,L]),h.useEffect(()=>{!F||xe!=="odoo"||Nr()},[xe,F]),h.useEffect(()=>{Ji.find(o=>o.id===Be)||di("templates")},[Be]),h.useEffect(()=>{if(typeof window>"u")return;const o=new URLSearchParams(window.location.search);o.set("tab",Be);const y=`${window.location.pathname}?${o.toString()}`;window.history.replaceState({},"",y)},[Be]);async function vt(){try{const o=await me("/api/audiences?with_counts=true");o&&o.segments&&jr(o.segments)}catch(o){console.error("Failed to load segments",o)}}async function ia(){try{const o=await me("/api/contacts/stats");hi(o||null)}catch(o){console.error("Failed to load Odoo stats",o),hi(null)}}async function la(){Fn(!0);try{const o=ke!=null&&ke.phone_number_id?`?phone_number_id=${encodeURIComponent(ke.phone_number_id)}`:"",y=await me(`/api/audiences/automation-settings${o}`);Sn((y==null?void 0:y.settings)||{enabled:!1,phone_number_id:null})}catch(o){console.error("Failed to load automation settings",o)}finally{Fn(!1)}}async function Ns(){_(!0);try{const o=new URLSearchParams;ke!=null&&ke.phone_number_id&&o.set("phone_number_id",ke.phone_number_id),Js&&o.set("line_name",Js);const y=o.toString(),M=await me(`/api/audiences/dynamic-tags${y?`?${y}`:""}`);Hn((M==null?void 0:M.items)||[])}catch(o){console.error("Failed to load dynamic audiences",o)}finally{_(!1)}}async function ws(o=Zt.enabled){try{const y=await we("/api/audiences/automation-settings",{enabled:o,phone_number_id:(ke==null?void 0:ke.phone_number_id)||null,line_name:Js||null});Sn((y==null?void 0:y.settings)||{...Zt,enabled:o}),ve({message:"Configuracin guardada"})}catch(y){ve({type:"error",message:y.message||"No se pudo guardar"})}}async function lo(o){Sn(y=>({...y,enabled:o})),await ws(o)}async function oo(){Q(!0);try{await we("/api/audiences/sync-historical",{phone_number_id:(ke==null?void 0:ke.phone_number_id)||null,line_name:Js||null}),await Ns(),await vt(),ve({message:"Sincronizacin completa"})}catch(o){ve({type:"error",message:o.message||"Error al sincronizar"})}finally{Q(!1)}}async function vi(){const o=re.trim();if(o)try{await we("/api/audiences/dynamic-tags",{name:o,phone_number_id:(ke==null?void 0:ke.phone_number_id)||null,line_name:Js||null}),Se(""),await Ns(),await vt(),ve({message:"Etiqueta creada correctamente"})}catch(y){ve({type:"error",message:y.message||"No se pudo crear etiqueta"})}}async function Nr(){gs(!0);try{const o=await me("/api/contacts/odoo-status");qs(o||{connected:!1})}catch(o){console.error("Failed to load Odoo status",o),qs({connected:!1})}finally{gs(!1)}}async function oa(){ui(!0),ao(null);try{const o=await we("/api/contacts/refresh-odoo",{});ao(o||null),await ia(),ve({message:"Lista Odoo actualizada"})}catch(o){ve({type:"error",message:o.message||"Error al actualizar Odoo"})}finally{ui(!1)}}async function co(o){return new Promise((y,M)=>{const H=new FileReader;H.onload=()=>{const ue=(H.result||"").toString().split(",")[1]||"";y(ue)},H.onerror=()=>M(H.error),H.readAsDataURL(o)})}async function xi(o){var M;const y=(M=o.target.files)==null?void 0:M[0];if(y){bt(y),Gn(null);try{const H=await co(y);qn(H);const Y=await we("/api/audiences/import-preview",{file_base64:H,filename:y.name});na(Y),ps((Y==null?void 0:Y.mapping)||[])}catch(H){na(null),ps([]),ve({type:"error",message:H.message||"No se pudo leer el archivo"})}}}function ca(){bt(null),qn(""),na(null),ps([]),Gn(null)}async function uo(){if(!pt||!mt){ve({type:"error",message:"Selecciona un archivo vlido"});return}ms(!0);try{const o={file_base64:mt,filename:pt.name,mapping:sa,options:{baseTagName:ee.listName,targetSegmentId:ee.targetMode==="existing"?ee.targetSegmentId:"",prefix:ee.prefix,ignoreDuplicates:ee.ignoreDuplicates,phoneNumberId:(ke==null?void 0:ke.phone_number_id)||null}},y=await we("/api/audiences/import-excel",o);Gn(y),await vt(),await Ns(),ve({message:"Importacin completada"})}catch(o){ve({type:"error",message:o.message||"Error al importar"})}finally{ms(!1)}}async function Zs(o,y={}){if(!o){Qs([]),aa(0);return}const M=y.page||1,H=y.search||"";Ft(!0);try{if(o.type==="odoo"){const ns=(M-1)*ys,Rn=await me(`/api/contacts?search=${encodeURIComponent(H)}&offset=${ns}&limit=${ys}`);let On=(Rn==null?void 0:Rn.contacts)||[];tn.tag!=="Todas"&&(On=On.filter(_s=>{const sn=_s.tags_json||[];return tn.tag==="Con etiquetas"?Array.isArray(sn)&&sn.length>0:tn.tag==="Sin etiquetas"?!Array.isArray(sn)||sn.length===0:!0})),tn.status!=="Activos"&&(On=On.filter(_s=>{const sn=(_s.status||"ACTIVO").toUpperCase();return tn.status==="Activos"?sn==="ACTIVO":sn!=="ACTIVO"})),Qs(On),aa((Rn==null?void 0:Rn.total)||On.length);return}const Y=H?1e3:200,ue=await me(`/api/audiences/${o.id}/preview?limit=${Y}`),Ze=(ue==null?void 0:ue.recipients)||[],At=H.trim().toLowerCase();let nn=At?Ze.filter(ns=>{var _s,sn;const Rn=((_s=ns.name)==null?void 0:_s.toLowerCase())||"",On=((sn=ns.phone_e164)==null?void 0:sn.toLowerCase())||"";return Rn.includes(At)||On.includes(At)}):Ze;tn.tag==="Sin etiquetas"&&(nn=nn.filter(ns=>!ns.tags||ns.tags.length===0));const ts=At?nn.length:(ue==null?void 0:ue.total)||nn.length,_r=(M-1)*ys,To=nn.slice(_r,_r+ys);Qs(To),aa(ts)}catch(Y){console.error("Failed to load audience contacts",Y),Qs([]),aa(0)}finally{Ft(!1)}}function yi(o){fi((o==null?void 0:o.id)||null),Xs(1),Yn(new Set),rt("")}async function pn(){try{await we("/api/audiences/refresh-counts",{}),await vt(),Et&&await Zs(Et,{page:gt,search:bn}),ve({message:"Conteos actualizados"})}catch(o){ve({type:"error",message:o.message||"No se pudo actualizar"})}}async function ho(o){if(!(!o||o.type==="odoo"||o.isDefault||!window.confirm(`Eliminar la audiencia "${o.name}"? Esta accin la desactiva y no borra contactos.`)))try{await In(`/api/audiences/${o.id}`),await vt(),kn===o.id&&fi(null),yr(null),ve({message:"Audiencia eliminada"})}catch(M){ve({type:"error",message:M.message||"No se pudo eliminar"})}}async function fo(o){if(!o||o.type==="odoo"||o.isDefault)return;const y=window.prompt("Nuevo nombre de la audiencia:",o.name);if(!(!y||!y.trim()))try{await zl(`/api/audiences/${o.id}`,{name:y.trim()}),await vt(),yr(null),ve({message:"Audiencia renombrada"})}catch(M){ve({type:"error",message:M.message||"No se pudo renombrar"})}}function ua(o,y){io(M=>{const H=M[o],Y=y.indexOf(H),ue=y[(Y+1)%y.length];return{...M,[o]:ue}})}function po(){if(xe==="dynamic"){ws();return}if(xe==="excel"){uo();return}xe==="odoo"&&oa()}const ut=h.useMemo(()=>{const o={id:"odoo",name:"odoo",subtitle:"Origen: Odoo",count:(xr==null?void 0:xr.total)||0,type:"odoo"},y=Xn.map(M=>{var H;return{id:M.id,name:M.name,subtitle:M.description||"Segmento personalizado",count:M.estimated_count||0,type:"segment",isDefault:(M.name||"").toUpperCase().startsWith("DEFAULT"),rules:M.rules_json,tagName:Array.isArray(M.rules_json)&&((H=M.rules_json.find(Y=>(Y.type||Y.field)==="tag"&&Y.value))==null?void 0:H.value)||""}});return[o,...y]},[Xn,xr]),er=h.useMemo(()=>{const o=Te.trim().toLowerCase();return o?ut.filter(y=>{var Y,ue;const M=((Y=y.name)==null?void 0:Y.toLowerCase())||"",H=((ue=y.subtitle)==null?void 0:ue.toLowerCase())||"";return M.includes(o)||H.includes(o)}):ut},[ut,Te]),Et=h.useMemo(()=>ut.find(o=>o.id===kn),[ut,kn]),ji=o=>{const y=(o==null?void 0:o.buttons_json)??(o==null?void 0:o.buttons)??[];if(Array.isArray(y))return y;if(typeof y=="string")try{const M=JSON.parse(y);return Array.isArray(M)?M:[]}catch{return[]}return[]},Ni=h.useMemo(()=>ji(v),[v]),wi=h.useMemo(()=>ji(Ee),[Ee]),Cn=h.useMemo(()=>Math.max(1,Math.ceil(pi/ys)),[pi,ys]),_i=h.useMemo(()=>{const o=[],y=Math.max(1,gt-1),M=Math.min(Cn,y+2);for(let H=y;H<=M;H+=1)o.push(H);return o},[gt,Cn]),da=o=>o==="sent"?"completed":o==="sending"?"running":o||"",tr=h.useMemo(()=>{const o={all:i.length,completed:0,scheduled:0,draft:0,failed:0,running:0};return i.forEach(y=>{const M=da(y.status);M==="completed"&&(o.completed+=1),M==="scheduled"&&(o.scheduled+=1),M==="draft"&&(o.draft+=1),M==="failed"&&(o.failed+=1),M==="running"&&(o.running+=1)}),o},[i]),ha=h.useMemo(()=>{const o=Z.trim().toLowerCase();return i.filter(y=>{const M=!o||(y.name||"").toLowerCase().includes(o),H=da(y.status);return M&&(oe==="all"||H===oe)})},[i,Z,oe]),En=h.useMemo(()=>{const o=[],y=k||i.length,M=Math.max(1,Math.ceil(y/Je)),H=Math.max(1,ot-1),Y=Math.min(M,H+2);for(let ue=H;ue<=Y;ue+=1)o.push(ue);return{pages:o,totalPages:M}},[k,i.length,ot,Je]);h.useEffect(()=>{Be==="audiences"&&!kn&&ut.length&&fi(ut[0].id)},[ut,Be,kn]),h.useEffect(()=>{Be!=="new"&&A&&(q(!1),U(null),Tn())},[Be,A]),h.useEffect(()=>{if(Be!=="audiences")return;const o=setTimeout(()=>{Zs(Et,{page:gt,search:bn})},300);return()=>clearTimeout(o)},[kn,gt,bn,Be,Et,tn]),h.useEffect(()=>{Yn(new Set),rt("")},[kn]);const Jn=h.useMemo(()=>Gs.filter(o=>o.conversation_id||o.conversationId),[Gs]),Zn=h.useMemo(()=>{const o=new Map(Gs.map(y=>[y.conversation_id||y.conversationId||"",y]));return Array.from(Kn).map(y=>o.get(y)).filter(Boolean)},[Gs,Kn]),es=(Et==null?void 0:Et.tagName)||"",nr=h.useMemo(()=>ut.filter(o=>o.tagName),[ut]),fa=nr.find(o=>o.id===xs),An=(fa==null?void 0:fa.tagName)||"";h.useEffect(()=>{if(!Ge.current)return;const o=Jn.length,y=Kn.size;Ge.current.indeterminate=y>0&&y<o},[Jn.length,Kn]);function mo(o){if(!o){Yn(new Set);return}const y=new Set(Jn.map(M=>M.conversation_id||M.conversationId||""));Yn(y)}function go(o){const y=o.conversation_id||o.conversationId||"";y&&Yn(M=>{const H=new Set(M);return H.has(y)?H.delete(y):H.add(y),H})}async function pa(o){if(!Zn.length||Ks)return;if((o==="add"||o==="move")&&!An){ve({type:"error",message:"Selecciona una audiencia destino vlida."});return}if((o==="remove"||o==="move")&&!es){ve({type:"error",message:"La audiencia actual no permite quitar contactos."});return}if(An&&An===es&&o!=="remove"){ve({type:"error",message:"La audiencia destino debe ser diferente a la actual."});return}const M=Zn.map(Y=>({contact:Y,conversationId:Y.conversation_id||Y.conversationId||""})).filter(Y=>Y.conversationId),H=Zn.length-M.length;if(!M.length){ve({type:"error",message:"No hay contactos compatibles para esta accin."});return}Ys(!0);try{await Promise.all(M.map(({conversationId:Y})=>we(`/api/conversations/${Y}/tags`,{add:o==="add"||o==="move"?[An]:[],remove:o==="remove"||o==="move"?[es]:[]}))),H&&ve({type:"error",message:`${H} contacto(s) no se pudieron actualizar.`}),Yn(new Set),rt(""),await vt(),await Zs(Et,{page:gt,search:bn}),ve({message:"Cambios aplicados correctamente."})}catch(Y){ve({type:"error",message:Y.message||"No se pudo actualizar."})}finally{Ys(!1)}}const vo=h.useMemo(()=>{const o=new Set;return(a||[]).forEach(y=>{y.category&&o.add(y.category)}),Array.from(o)},[a]),Si=h.useMemo(()=>{const o=w.trim().toLowerCase(),y=R==="all"?"":R.toLowerCase();return(a||[]).filter(M=>{var At,nn;const H=((At=M.name)==null?void 0:At.toLowerCase())||"",Y=((nn=M.category)==null?void 0:nn.toLowerCase())||"";return(!o||H.includes(o)||Y.includes(o))&&(!y||Y===y)})},[w,R,a]),ki=h.useMemo(()=>{const o=G.trim().toLowerCase();return(a||[]).filter(y=>{var H;const M=((H=y.name)==null?void 0:H.toLowerCase())||"";return!o||M.includes(o)})},[G,a]),ma=h.useMemo(()=>n.segment_id?ut.find(o=>o.id===n.segment_id)||null:n.tag&&ut.find(o=>o.name===n.tag)||null,[ut,n.segment_id,n.tag]),xo=h.useMemo(()=>n.segment_id?`segment:${n.segment_id}`:n.tag?`tag:${n.tag}`:n.assigned_user_id?`assigned:${n.assigned_user_id}`:n.status?`status:${n.status}`:n.verified_only?"verified":"",[n.segment_id,n.tag,n.assigned_user_id,n.status,n.verified_only]);function yo(o){r(y=>{const M={...y,status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""};if(o.startsWith("segment:")){const H=o.slice(8),Y=ut.find(ue=>ue.id===H);M.segment_id=H,M.segment_name=(Y==null?void 0:Y.name)||""}else o.startsWith("tag:")?M.tag=o.slice(4):o.startsWith("status:")?M.status=o.slice(7):o.startsWith("assigned:")?M.assigned_user_id=o.slice(9):o==="verified"&&(M.verified_only=!0);return M})}function jo(o){if(!o)return"";const y=new Date(o);if(Number.isNaN(y.getTime()))return"";const M=H=>String(H).padStart(2,"0");return`${y.getFullYear()}-${M(y.getMonth()+1)}-${M(y.getDate())}T${M(y.getHours())}:${M(y.getMinutes())}`}function bi(o){t(y=>({...y,template_id:o}))}function Tn(){t({name:"",template_id:"",scheduled_for:"",send_now:!0}),r({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),ie("")}function wr(o){var Y;if(!o)return;U(o),q(!0),ie(""),t(ue=>{var Ze;return{...ue,name:o.name||"",template_id:o.template_id||((Ze=o.template)==null?void 0:Ze.id)||"",scheduled_for:jo(o.scheduled_for||o.scheduled_at),send_now:!(o.scheduled_for||o.scheduled_at)}});const y=o.audience_filter||{},M=y.segment_id||o.segment_id||"",H=y.segment_name||((Y=o.segment)==null?void 0:Y.name)||"";r(ue=>({...ue,status:y.status||"",tag:y.tag||"",assigned_user_id:y.assigned_user_id||"",verified_only:!!y.verified_only,segment_id:M,segment_name:H}))}function No(o){!(o!=null&&o.id)||!p||!window.confirm(`Eliminar la campaa "${o.name}"?`)||p(o.id)}function wo(o){!(o!=null&&o.id)||!j||!window.confirm(`Reenviar la campaa "${o.name}"?`)||j(o.id)}function _o(o,y){if(pe(M=>M===o?null:o),y!=null&&y.currentTarget&&typeof window<"u"){const M=y.currentTarget.getBoundingClientRect(),H=window.innerHeight-M.bottom,Y=M.top,ue=H<180&&Y>H;lt(ue?"up":"down")}}function So(o){ge(y=>y===o?null:o)}function sr(o){o!=null&&o.id&&(st({id:o.id,name:o.name||"",phone:o.phone_e164||o.phone||"",email:o.email||"",vat:o.vat||""}),Mt(!0),ge(null))}async function ko(o){if(o.preventDefault(),!!be.id){qe(!0);try{const y=await zl(`/api/contacts/${be.id}`,{name:be.name,phone:be.phone,email:be.email,vat:be.vat});y!=null&&y.contact&&Qs(M=>M.map(H=>H.id===y.contact.id?y.contact:H)),Mt(!1),ve({message:"Contacto actualizado"}),await Zs(Et,{page:gt,search:bn})}catch(y){ve({type:"error",message:y.message||"No se pudo actualizar"})}finally{qe(!1)}}}async function bo(o){if(!(!(o!=null&&o.id)||!window.confirm(`Eliminar el contacto "${o.name||o.phone_e164||"Sin nombre"}"?`)))try{await In(`/api/contacts/${o.id}`),Qs(M=>M.filter(H=>H.id!==o.id)),ge(null),ve({message:"Contacto eliminado"}),await Zs(Et,{page:gt,search:bn})}catch(M){ve({type:"error",message:M.message||"No se pudo eliminar"})}}function Co(o){if(o.preventDefault(),!e.name.trim()||!e.template_id)return;const y={};if(n.status&&(y.status=n.status),n.tag&&(y.tag=n.tag.trim()),n.assigned_user_id&&(y.assigned_user_id=n.assigned_user_id),n.verified_only&&(y.verified_only=!0),n.segment_id&&(y.segment_id=n.segment_id,n.segment_name&&(y.segment_name=n.segment_name)),b&&f){f(b.id,{name:e.name.trim(),template_id:e.template_id,segment_id:n.segment_id||null,audience_filter:y,scheduled_for:e.scheduled_for||null}),q(!1),U(null),Tn();return}E(o)}function Eo(o){Re(o),je(!0)}const Ln=Ji.find(o=>o.id===Be)||Ji[1],Ao={title:"Campaas",subtitle:"CONFIGURACIN DE NUEVO ENVO MASIVO"},Ci=Ce.find(o=>o.id===xe)||Ce[0],Ei=F?Ci:Be==="new"&&A?Ao:Ln;return s.jsxs("section",{className:"campaigns-page",children:[s.jsxs("div",{className:"campaigns-shell",children:[s.jsxs("header",{className:"campaigns-header",children:[s.jsxs("div",{className:"campaigns-title-block",children:[s.jsxs("div",{className:"campaigns-title-row",children:[F&&s.jsx("button",{className:"campaigns-back",type:"button",onClick:()=>_e(!1),"aria-label":"Volver",children:"<"}),s.jsx("span",{className:"campaigns-heading",children:Ei.title})]}),s.jsx("div",{className:`campaigns-subtitle ${F?"campaigns-subtitle--upper":""}`,children:Ei.subtitle})]}),s.jsxs("div",{className:"campaigns-actions",children:[F&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>_e(!1),children:xe==="excel"?"Cancelar":"Descartar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:po,disabled:xe==="excel"&&(Hs||!mt||ee.targetMode==="new"&&!ee.listName.trim()||ee.targetMode==="existing"&&!ee.targetSegmentId)||xe==="odoo"&&Qn,children:Ci.actionLabel})]}),!F&&Be==="audiences"&&s.jsxs("button",{className:"campaigns-primary campaigns-primary--dropdown",type:"button",onClick:()=>{_e(!0),T("dynamic")},children:[s.jsx("span",{className:"campaigns-primary-icon",children:"+"}),"Nueva Audiencia"]}),!F&&Be==="new"&&s.jsx(s.Fragment,{children:A?s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>{q(!1),U(null),Tn()},children:"Cancelar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>{var o,y;return(y=(o=Jt.current)==null?void 0:o.requestSubmit)==null?void 0:y.call(o)},children:b?"Guardar cambios":"Lanzar Campaa"})]}):s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>q(!0),children:"+ Lanzar Campaa"})})]})]}),!F&&s.jsx("nav",{className:"campaigns-tabs",role:"tablist","aria-label":"Secciones de Campaas",children:Ji.map(o=>s.jsx("button",{type:"button",role:"tab","aria-selected":Be===o.id,className:`campaigns-tab ${Be===o.id?"active":""}`,onClick:()=>di(o.id),children:o.label},o.id))}),s.jsx("div",{className:"campaigns-tab-panel",children:F?s.jsxs("section",{className:"audience-flow",children:[s.jsx("nav",{className:"audience-flow-tabs",role:"tablist","aria-label":"Flujo de nueva audiencia",children:Th.map(o=>s.jsx("button",{type:"button",role:"tab","aria-selected":xe===o.id,className:`audience-flow-tab ${xe===o.id?"active":""}`,onClick:()=>T(o.id),children:o.label},o.id))}),s.jsxs("div",{className:"audience-flow-panel",children:[xe==="dynamic"&&s.jsxs("div",{className:"audience-flow-content",children:[s.jsxs("div",{className:"audience-hero",children:[s.jsxs("div",{className:"audience-hero-main",children:[s.jsx("div",{className:"audience-hero-title",children:"Sincronizacin Automtica Total"}),s.jsx("div",{className:"audience-hero-subtitle",children:"Vincula tus etiquetas directamente con Audiencias Dinmicas. La lgica del sistema es 1 Tag = 1 Audiencia."}),s.jsxs("div",{className:"audience-line-picker",children:[s.jsx("span",{children:"Lnea activa"}),s.jsxs("select",{value:(ke==null?void 0:ke.phone_number_id)||"",onChange:o=>gi(o.target.value),disabled:!Wt.length,children:[!Wt.length&&s.jsx("option",{value:"",children:"Sin lneas registradas"}),Wt.map(o=>s.jsx("option",{value:o.phone_number_id,children:o.display_name||o.phone_number_id},o.id))]})]})]}),s.jsxs("label",{className:"audience-switch",children:[s.jsx("span",{children:"Estado"}),s.jsx("input",{type:"checkbox",checked:Zt.enabled,onChange:o=>lo(o.target.checked),disabled:Vn||!Wt.length}),s.jsx("span",{children:Zt.enabled?"ACTIVO":"INACTIVO"})]})]}),s.jsxs("div",{className:"audience-rule-card",children:[s.jsx("div",{className:"audience-rule-title",children:"Regla de Automatizacin unificada"}),s.jsx("p",{children:"Cuando un operador o bot etiqueta a un contacto en el CRM, este se aade instantneamente a la lista de audiencia correspondiente. No requiere intervencin manual adicional."})]}),s.jsxs("div",{className:"audience-section-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audience-section-title",children:"Gestin de Etiquetas dinmicas"}),s.jsx("div",{className:"audience-section-subtitle",children:"Administra las etiquetas vinculadas que alimentan tus listas de envo en tiempo real."})]}),s.jsxs("div",{className:"audience-section-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:oo,disabled:V,children:V?"Sincronizando...":"Sincronizar Datos Histricos"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:vi,disabled:!re.trim(),children:"Nueva Etiqueta / Audiencia"})]})]}),s.jsxs("div",{className:"audience-tags-grid",children:[en&&s.jsx("div",{className:"empty-state",children:"Cargando etiquetas..."}),!en&&Wn.length===0&&s.jsx("div",{className:"empty-state",children:"No hay etiquetas dinmicas an."}),!en&&Wn.map(o=>{var y,M,H,Y,ue;return s.jsxs("div",{className:`audience-tag-card ${o.is_default?"default":""}`,children:[s.jsxs("div",{className:"audience-tag-head",children:[s.jsx("div",{className:"audience-tag-name",children:o.is_default?((y=o.segment)==null?void 0:y.name)||"DEFAULT":((M=o.tag)==null?void 0:M.name)||((H=o.segment)==null?void 0:H.name)}),s.jsx("div",{className:"audience-tag-count",children:((Y=o.segment)==null?void 0:Y.estimated_count)||0})]}),s.jsxs("div",{className:"audience-tag-meta",children:["Audiencia: ",((ue=o.segment)==null?void 0:ue.estimated_count)||0," contactos"]}),s.jsxs("div",{className:"audience-tag-status",children:[s.jsx("span",{className:"dot"}),"Sincronizado",s.jsx("span",{className:"audience-tag-time",children:o.last_synced_at?`  ${P(o.last_synced_at)}`:""})]})]},o.id)}),s.jsx("div",{className:"audience-tag-card add",children:s.jsxs("div",{className:"audience-tag-add",children:[s.jsx("div",{className:"audience-tag-add-icon",children:"+"}),s.jsx("input",{type:"text",placeholder:"Crear nueva etiqueta",value:re,onChange:o=>Se(o.target.value)}),s.jsx("button",{type:"button",className:"campaigns-primary",onClick:vi,disabled:!re.trim(),children:"Crear"})]})})]})]}),xe==="excel"&&s.jsxs("div",{className:"audience-flow-content",children:[pt?s.jsxs("div",{className:"excel-file-panel",children:[s.jsxs("div",{children:[s.jsx("div",{className:"excel-file-title",children:"Archivo cargado"}),s.jsx("div",{className:"excel-file-name",children:pt.name})]}),s.jsxs("div",{className:"excel-file-actions",children:[s.jsxs("label",{className:"excel-link",children:["Cambiar archivo",s.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:xi})]}),s.jsx("button",{className:"campaigns-danger",type:"button",onClick:ca,children:"Eliminar archivo"})]})]}):s.jsx("div",{className:"excel-dropzone",children:s.jsxs("div",{className:"excel-dropzone-inner",children:[s.jsx("div",{className:"excel-dropzone-icon",children:"?"}),s.jsx("div",{className:"excel-dropzone-title",children:"Sube tu archivo de Excel"}),s.jsxs("div",{className:"excel-dropzone-subtitle",children:["Arrastra y suelta tu archivo .xlsx o .csv aqu o"," ",s.jsxs("label",{className:"excel-link",children:["explora tus archivos",s.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:xi})]})]}),s.jsxs("div",{className:"excel-dropzone-tags",children:[s.jsx("span",{children:"Mximo 50MB"}),s.jsx("span",{children:"Hasta 50,000 filas"})]})]})}),pt?s.jsxs("div",{className:"excel-grid",children:[s.jsxs("div",{className:"excel-card",children:[s.jsx("div",{className:"excel-card-title",children:"Configuracin de Importacin"}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista de destino"}),s.jsxs("select",{value:ee.targetMode,onChange:o=>se(y=>({...y,targetMode:o.target.value})),children:[s.jsx("option",{value:"new",children:"Crear Nueva Lista"}),s.jsx("option",{value:"existing",children:"Elegir Lista Existente"})]})]}),ee.targetMode==="new"?s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Nombre de la nueva lista"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO",value:ee.listName,onChange:o=>se(y=>({...y,listName:o.target.value}))})]}):s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista existente"}),s.jsxs("select",{value:ee.targetSegmentId,onChange:o=>se(y=>({...y,targetSegmentId:o.target.value})),children:[s.jsx("option",{value:"",children:"Selecciona una lista"}),Xn.map(o=>s.jsx("option",{value:o.id,children:o.name},o.id))]})]}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Prefijo de etiqueta (opcional)"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO_",value:ee.prefix,onChange:o=>se(y=>({...y,prefix:o.target.value}))})]}),s.jsxs("label",{className:"excel-checkbox",children:[s.jsx("input",{type:"checkbox",checked:ee.ignoreDuplicates,onChange:o=>se(y=>({...y,ignoreDuplicates:o.target.checked}))}),"Ignorar contactos duplicados"]}),fn&&s.jsxs("div",{className:"excel-summary",children:["Procesadas: ",fn.processed,"  Nuevos:"," ",fn.created,"  Duplicados:"," ",fn.skipped,"  Errores: ",fn.errors]})]}),s.jsxs("div",{className:"excel-card",children:[s.jsxs("div",{className:"excel-card-title",children:["Vista previa de mapeo",s.jsxs("span",{className:"excel-pill",children:["Columnas detectadas: ",((Ai=Vt==null?void 0:Vt.columns)==null?void 0:Ai.length)||0]})]}),s.jsxs("div",{className:"excel-map-table",children:[s.jsxs("div",{className:"excel-map-head",children:[s.jsx("span",{children:"Columna Excel"}),s.jsx("span",{children:"Mapeo CRM"}),s.jsx("span",{children:"Ejemplo"})]}),((Vt==null?void 0:Vt.columns)||[]).map((o,y)=>{var M,H;return s.jsxs("div",{className:"excel-map-row",children:[s.jsx("span",{children:o}),s.jsx("select",{value:sa[y]||"ignore",onChange:Y=>ps(ue=>{const Ze=[...ue];return Ze[y]=Y.target.value,Ze}),children:iy.map(Y=>s.jsx("option",{value:Y.value,children:Y.label},Y.value))}),s.jsx("span",{children:((H=(M=Vt==null?void 0:Vt.previewRows)==null?void 0:M[0])==null?void 0:H[y])||"--"})]},`${o}-${y}`)}),!Vt&&s.jsx("div",{className:"empty-state",children:"Sube un archivo para ver el mapeo."})]})]})]}):s.jsxs("div",{className:"excel-placeholder",children:[s.jsx("div",{className:"excel-placeholder-title",children:"Agrega un archivo para continuar"}),s.jsx("div",{className:"excel-placeholder-subtitle",children:"Luego podrs mapear todas las columnas a los campos del CRM."})]})]}),xe==="odoo"&&s.jsxs("div",{className:"audience-flow-content odoo-flow",children:[s.jsxs("div",{className:"odoo-status",children:[s.jsx("span",{className:`odoo-indicator ${ra.connected?"on":"off"}`}),"Estado: ",ra.connected?"Odoo conectado":"Odoo no conectado"]}),s.jsxs("div",{className:"odoo-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:Nr,disabled:ci,children:ci?"Validando...":"Validar Conexin"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:oa,disabled:Qn,children:Qn?"Actualizando...":"Actualizar Lista Odoo"})]}),s.jsx("div",{className:"odoo-note",children:"Se importarn contactos y se crearn audiencias por etiqueta Automticamente."}),vs&&s.jsxs("div",{className:"odoo-summary",children:[s.jsx("div",{className:"odoo-summary-title",children:"Resultado de sincronizacin"}),s.jsxs("div",{className:"odoo-summary-metrics",children:[s.jsxs("span",{children:["Aadidos: ",vs.created||0]}),s.jsxs("span",{children:["Actualizados: ",vs.updated||0]}),s.jsxs("span",{children:["Omitidos: ",vs.skipped||0]})]}),(Li=(Ti=vs.preview)==null?void 0:Ti.created)!=null&&Li.length?s.jsxs("div",{className:"odoo-preview",children:[s.jsx("div",{className:"odoo-preview-title",children:"Contactos aadidos"}),s.jsx("ul",{children:vs.preview.created.map(o=>s.jsxs("li",{children:[s.jsx("strong",{children:o.name||"Sin nombre"})," ",s.jsx("span",{children:o.phone_e164||""})]},`${o.phone_e164||o.name}-${o.id||""}`))})]}):null]})]})]})]}):s.jsxs(s.Fragment,{children:[Be==="templates"&&s.jsxs("section",{className:"campaigns-panel templates-panel",children:[s.jsxs("div",{className:"templates-toolbar",children:[s.jsxs("label",{className:"templates-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar por nombre de plantilla...",value:w,onChange:o=>D(o.target.value)})]}),s.jsxs("select",{className:"templates-select",value:R,onChange:o=>X(o.target.value),children:[s.jsx("option",{value:"all",children:"Todas las categorias"}),vo.map(o=>s.jsx("option",{value:o.toLowerCase(),children:Ah[o]||o},o))]})]}),s.jsxs("div",{className:"template-grid template-grid--library",children:[Si.map(o=>{const y=(o.status||(o.is_active?"APPROVED":"PENDING")).toUpperCase(),M=Xi[y]||Xi.PENDING,H=Ah[o.category]||o.category||"GENERAL",Y=o.id===e.template_id,ue=o.rejection_reason||o.rejectionReason||o.rejection_message||"",Ze=y==="REJECTED"?"Ver detalles":"Previsualizar";return s.jsxs("div",{className:`template-card ${Y?"selected":""}`,children:[s.jsxs("div",{className:"template-head",children:[s.jsx("div",{className:"template-name",title:o.name,children:o.name}),s.jsx("span",{className:`template-status ${M.className}`,children:M.label})]}),s.jsx("div",{className:"template-category",children:H}),s.jsx("div",{className:`template-preview ${y==="REJECTED"?"rejected":""}`,children:o.body_preview||o.body_text||"Sin preview"}),y==="REJECTED"&&ue&&s.jsxs("div",{className:"template-rejection",children:["Rechazada por Meta: ",ue]}),s.jsx("div",{className:"template-footer",children:s.jsx("button",{className:"template-action",type:"button",onClick:()=>Eo(o),children:Ze})})]},o.id)}),!Si.length&&s.jsx("div",{className:"empty-state",children:"Sin plantillas disponibles"})]})]}),Be==="audiences"&&s.jsx("section",{className:"campaigns-panel audiences-panel",children:s.jsxs("div",{className:"audiences-layout",children:[s.jsxs("div",{className:"audiences-list",children:[s.jsxs("label",{className:"audiences-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar lista...",value:Te,onChange:o=>Xe(o.target.value)})]}),s.jsxs("div",{className:"audience-list",children:[er.map(o=>{var y;return s.jsxs("button",{type:"button",className:`audience-card ${kn===o.id?"active":""}`,onClick:()=>yi(o),children:[s.jsxs("div",{className:"audience-title",children:[s.jsx("span",{children:o.name}),s.jsxs("div",{className:"audience-title-actions",children:[s.jsx("span",{className:"audience-count",children:((y=o.count)==null?void 0:y.toLocaleString("es-PE"))||0}),!o.isDefault&&o.type!=="odoo"&&s.jsxs("div",{className:"audience-menu-wrapper",children:[s.jsx("button",{className:"audience-menu",type:"button","aria-label":"Opciones de audiencia",onClick:M=>{M.stopPropagation(),yr(H=>H===o.id?null:o.id)},children:"..."}),ct===o.id&&s.jsxs("div",{className:"audience-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>fo(o),children:"Renombrar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>ho(o),children:"Eliminar"})]})]})]})]}),s.jsx("div",{className:"audience-subtitle",children:o.subtitle})]},o.id)}),!er.length&&s.jsx("div",{className:"empty-state",children:"Sin audiencias disponibles"})]})]}),s.jsxs("div",{className:"audiences-table-panel",children:[s.jsxs("div",{className:"audiences-filters",children:[s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ETIQUETA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>ua("tag",["Todas","Con etiquetas","Sin etiquetas"]),children:tn.tag})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"FECHA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>ua("date",["Cualquier fecha","ltimos 30 das"]),children:tn.date})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ESTADO:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>ua("status",["Activos","Inactivos"]),children:tn.status})]}),s.jsxs("div",{className:"audiences-filter-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Descargar",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Actualizar",onClick:pn,children:""})]})]}),s.jsxs("div",{className:"audiences-search-row",children:[s.jsxs("label",{className:"audiences-search-field",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar contacto en esta lista...",value:bn,onChange:o=>{Ct(o.target.value),Xs(1)}})]}),s.jsxs("div",{className:"audiences-total",children:[pi.toLocaleString("es-PE")," contactos en total"]})]}),s.jsxs("div",{className:"audiences-bulk",children:[s.jsxs("div",{className:"audiences-bulk-info",children:[Zn.length," seleccionados"]}),s.jsxs("select",{className:"audiences-bulk-select",value:xs,onChange:o=>rt(o.target.value),children:[s.jsx("option",{value:"",children:"Selecciona audiencia destino..."}),nr.map(o=>s.jsx("option",{value:o.id,children:o.name},`bulk-${o.id}`))]}),s.jsx("button",{className:"audiences-bulk-btn",type:"button",disabled:Ks||!Zn.length||!An||An===es,onClick:()=>pa("add"),children:"Aadir"}),s.jsx("button",{className:"audiences-bulk-btn",type:"button",disabled:Ks||!Zn.length||!An||An===es,onClick:()=>pa("move"),children:"Mover"}),s.jsx("button",{className:"audiences-bulk-btn danger",type:"button",disabled:Ks||!Zn.length||!es,onClick:()=>pa("remove"),children:"Eliminar"})]}),(Et==null?void 0:Et.type)==="odoo"&&s.jsx("div",{className:"audiences-bulk-note",children:"Las acciones masivas solo aplican a contactos con conversacin de WhatsApp."}),s.jsxs("div",{className:"audiences-table",children:[s.jsxs("div",{className:"audiences-table-head",children:[s.jsx("span",{children:s.jsx("input",{ref:Ge,type:"checkbox","aria-label":"Seleccionar todos",checked:Jn.length>0&&Kn.size===Jn.length,onChange:o=>mo(o.target.checked)})}),s.jsx("span",{children:"CONTACTO"}),s.jsx("span",{children:"WHATSAPP"}),s.jsx("span",{children:"ETIQUETAS"}),s.jsx("span",{children:"FECHA REGISTRO"}),s.jsx("span",{children:"ESTADO"}),s.jsx("span",{})]}),mi&&s.jsx("div",{className:"loading",children:"Cargando contactos..."}),!mi&&Gs.length===0&&s.jsx("div",{className:"empty-state",children:"No hay contactos en esta audiencia."}),!mi&&Gs.map(o=>{const y=o.name||"Sin nombre",M=o.email||"",H=o.phone_e164||o.phone||"-",Y=Array.isArray(o.tags)?o.tags:o.tags?[o.tags]:[],ue=y.trim().slice(0,1).toUpperCase(),Ze=o.conversation_id||o.conversationId||"";return s.jsxs("div",{className:"audiences-table-row",children:[s.jsx("input",{type:"checkbox","aria-label":"Seleccionar contacto",checked:Kn.has(Ze),onChange:()=>go(o),disabled:!Ze}),s.jsxs("div",{className:"audiences-contact",children:[s.jsx("div",{className:"audiences-avatar",children:ue}),s.jsxs("div",{className:"audiences-contact-info",children:[s.jsx("div",{className:"audiences-contact-name",children:y}),M&&s.jsx("div",{className:"audiences-contact-email",children:M})]})]}),s.jsx("div",{children:H}),s.jsx("div",{className:"audiences-tags",children:Y.length?Y.map(At=>s.jsx("span",{className:"audiences-tag",children:At},`${o.id}-${At}`)):s.jsx("span",{className:"audiences-tag empty",children:""})}),s.jsx("div",{children:o.created_at?P(o.created_at):""}),s.jsx("div",{className:"audiences-status",children:(o.status||"ACTIVO").toUpperCase()}),s.jsxs("div",{className:"audiences-menu-wrapper",children:[s.jsx("button",{className:"audiences-menu",type:"button","aria-label":"Opciones",onClick:()=>So(o.id),disabled:!o.id,children:"..."}),_t===o.id&&s.jsxs("div",{className:"audiences-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>sr(o),children:"Editar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>bo(o),children:"Eliminar"})]})]})]},o.id||H)})]}),s.jsxs("div",{className:"audiences-pagination",children:[s.jsxs("div",{className:"audiences-page-info",children:["Pgina ",gt," de ",Cn]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:gt<=1,onClick:()=>Xs(o=>Math.max(1,o-1)),children:"<"}),_i.map(o=>s.jsx("button",{className:`audiences-page-btn ${o===gt?"active":""}`,type:"button",onClick:()=>Xs(o),children:o},`aud-page-${o}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:gt>=Cn,onClick:()=>Xs(o=>Math.min(Cn,o+1)),children:">"})]})]})]})]})}),Be==="new"&&s.jsx("section",{className:"campaigns-panel campaigns-module",children:A?s.jsxs("div",{className:"campaigns-launch",children:[s.jsxs("form",{className:"campaigns-launch-form",ref:Jt,onSubmit:Co,children:[s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"1"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Nombre de la Campaa"}),s.jsx("input",{type:"text",placeholder:"Ej: Promocin Black Friday 2024",value:e.name,onChange:o=>t(y=>({...y,name:o.target.value}))})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"2"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Seleccionar Audiencia"}),s.jsxs("select",{value:xo,onChange:o=>yo(o.target.value),children:[s.jsx("option",{value:"",children:"Selecciona un segmento..."}),ut.filter(o=>o.type!=="odoo").map(o=>s.jsx("option",{value:`segment:${o.id}`,children:o.name},`seg-${o.id}`)),s.jsx("option",{value:"verified",children:"Solo verificados"}),s.jsx("option",{value:"assigned:unassigned",children:"Sin asignar"})]})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"3"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Elegir Plantilla de Meta"}),s.jsxs("div",{className:"launch-template-search",children:[s.jsx("input",{type:"text",placeholder:"Buscar plantilla...",value:G,onChange:o=>ie(o.target.value)}),s.jsx("button",{type:"button",onClick:()=>ie(""),children:"Limpiar"})]}),s.jsx("div",{className:"launch-templates-scroll",children:s.jsxs("div",{className:"launch-templates",children:[ki.map(o=>{const y=o.status||"APPROVED",M=Xi[y]||Xi.APPROVED,H=e.template_id===o.id;return s.jsxs("button",{className:`launch-template ${H?"selected":""}`,type:"button",onClick:()=>bi(o.id),children:[s.jsx("div",{className:"launch-template-icon"}),s.jsx("div",{className:"launch-template-title",children:o.name}),s.jsx("div",{className:"launch-template-preview",children:o.body_preview||o.body_text||"Sin preview"}),s.jsx("span",{className:`launch-template-status ${M.className}`,children:M.label})]},o.id)}),ki.length===0&&s.jsx("div",{className:"launch-empty",children:"Sin plantillas"})]})})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"4"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Programacin"}),s.jsxs("div",{className:"launch-schedule",children:[s.jsx("button",{className:`launch-schedule-option ${kt==="now"?"active":""}`,type:"button",onClick:()=>{Xt("now"),t(o=>({...o,scheduled_for:"",send_now:!0}))},children:"Enviar Ahora"}),s.jsx("button",{className:`launch-schedule-option ${kt==="schedule"?"active":""}`,type:"button",onClick:()=>{Xt("schedule"),t(o=>({...o,send_now:!1}))},children:"Programar Envo"})]}),kt==="schedule"&&s.jsx("input",{type:"datetime-local",value:e.scheduled_for,onChange:o=>t(y=>({...y,scheduled_for:o.target.value,send_now:!1}))})]})]})]}),s.jsxs("aside",{className:"campaigns-launch-preview",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:"Nombre del Cliente"}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(v==null?void 0:v.body_preview)||(v==null?void 0:v.body_text)||"Selecciona una plantilla para ver el contenido."}),Ni.length>0&&s.jsx("div",{className:"preview-actions",children:Ni.map((o,y)=>s.jsx("button",{type:"button",children:o.text||o.label||o.title||`Botn ${y+1}`},`preview-btn-${y}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Destinatarios"}),s.jsx("strong",{children:(ma==null?void 0:ma.count)||0})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:(v==null?void 0:v.name)||"Sin plantilla"})]})]})]})]}):s.jsxs("div",{className:"campaigns-dashboard",children:[s.jsxs("aside",{className:"campaigns-sidebar",children:[s.jsxs("label",{className:"campaigns-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar campaa...",value:Z,onChange:o=>ce(o.target.value)})]}),s.jsxs("div",{className:"campaigns-filters-list",children:[s.jsxs("button",{className:`campaigns-filter-item ${oe==="all"?"active":""}`,type:"button",onClick:()=>Oe("all"),children:[s.jsx("span",{children:"Todas las Campaas"}),s.jsx("span",{className:"campaigns-filter-count",children:tr.all})]}),s.jsxs("button",{className:`campaigns-filter-item ${oe==="completed"?"active":""}`,type:"button",onClick:()=>Oe("completed"),children:[s.jsx("span",{children:"Enviadas"}),s.jsx("span",{className:"campaigns-filter-count",children:tr.completed})]}),s.jsxs("button",{className:`campaigns-filter-item ${oe==="scheduled"?"active":""}`,type:"button",onClick:()=>Oe("scheduled"),children:[s.jsx("span",{children:"Programadas"}),s.jsx("span",{className:"campaigns-filter-count",children:tr.scheduled})]}),s.jsxs("button",{className:`campaigns-filter-item ${oe==="draft"?"active":""}`,type:"button",onClick:()=>Oe("draft"),children:[s.jsx("span",{children:"Borradores"}),s.jsx("span",{className:"campaigns-filter-count",children:tr.draft})]}),s.jsxs("button",{className:`campaigns-filter-item ${oe==="failed"?"active":""}`,type:"button",onClick:()=>Oe("failed"),children:[s.jsx("span",{children:"Fallidas"}),s.jsx("span",{className:"campaigns-filter-count",children:tr.failed})]})]}),s.jsxs("div",{className:"campaigns-quota",children:[s.jsx("div",{className:"campaigns-quota-title",children:"Cuota de mensajes"}),s.jsx("div",{className:"campaigns-quota-bar",children:s.jsx("div",{className:"campaigns-quota-fill",style:{width:"65%"}})}),s.jsx("div",{className:"campaigns-quota-meta",children:"65% usado"})]})]}),s.jsxs("div",{className:"campaigns-table-panel",children:[s.jsxs("div",{className:"campaigns-table-filters",children:[s.jsx("div",{className:"campaigns-filter-chip",children:"Canal: WhatsApp Business"}),s.jsx("div",{className:"campaigns-filter-chip",children:"Periodo: ltimos 30 das"}),s.jsxs("div",{className:"campaigns-table-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button",onClick:()=>L(ot,Je,Z.trim()),children:""})]})]}),s.jsxs("div",{className:"campaigns-table",children:[s.jsxs("div",{className:"campaigns-table-head",children:[s.jsx("span",{children:"Campaa"}),s.jsx("span",{children:"Fecha"}),s.jsx("span",{children:"Audiencia"}),s.jsx("span",{children:"Enviados"}),s.jsx("span",{children:"Ledos"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{})]}),ha.map(o=>{const y=o.messages_count||o.audience_count||"--",M=o.read_count||"--",H=o.reply_count||"--",Y=da(o.status),ue=Eh[Y]||Y,Ze=["running","sending"].includes(Y),At=["completed","failed"].includes(Y),nn=!Ze,ts=!Ze;return s.jsxs("div",{className:"campaigns-table-row",children:[s.jsxs("div",{className:"campaigns-table-title",children:[s.jsx("div",{className:"campaigns-table-name",children:o.name}),s.jsxs("div",{className:"campaigns-table-ref",children:["Ref: ",o.id.slice(0,10)]})]}),s.jsx("div",{className:"campaigns-table-date",children:P(o.created_at)}),s.jsx("div",{className:"campaigns-table-tags",children:s.jsx("span",{className:"campaigns-pill",children:o.audience_label||"Base General"})}),s.jsx("div",{className:"campaigns-metric",children:y}),s.jsx("div",{className:"campaigns-metric",children:M}),s.jsx("div",{className:"campaigns-metric",children:H}),s.jsx("div",{className:`campaigns-status ${Y}`,children:ue}),s.jsx("div",{className:"campaigns-row-actions",children:s.jsxs("div",{className:"campaigns-row-menu",children:[s.jsx("button",{className:"campaigns-row-menu-btn",type:"button","aria-label":"Opciones",onClick:_r=>_o(o.id,_r),children:"..."}),fe===o.id&&s.jsxs("div",{className:`campaigns-row-dropdown ${nt==="up"?"drop-up":""}`,children:[nn&&s.jsx("button",{type:"button",onClick:()=>{wr(o),pe(null)},children:"Editar"}),At&&s.jsx("button",{type:"button",onClick:()=>{wo(o),pe(null)},children:"Reenviar"}),ts&&s.jsx("button",{type:"button",className:"danger",onClick:()=>{No(o),pe(null)},children:"Eliminar"})]})]})})]},o.id)}),!ha.length&&s.jsx("div",{className:"empty-state",children:"Sin campaas registradas"})]}),s.jsxs("div",{className:"campaigns-table-footer",children:[s.jsxs("span",{children:["Mostrando ",ha.length," de"," ",k||i.length," campaas"]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:ot<=1,onClick:()=>{const o=Math.max(1,ot-1);_n(o),L(o,Je,Z.trim())},children:"<"}),En.pages.map(o=>s.jsx("button",{className:`audiences-page-btn ${o===ot?"active":""}`,type:"button",onClick:()=>{_n(o),L(o,Je,Z.trim())},children:o},`camp-page-${o}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:ot>=En.totalPages,onClick:()=>{const o=Math.min(En.totalPages,ot+1);_n(o),L(o,Je,Z.trim())},children:">"})]})]})]})]})}),Be==="history"&&s.jsxs("section",{className:"campaigns-panel campaigns-history",children:[s.jsxs("div",{className:"campaigns-history-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"campaigns-history-title",children:"Historial de Envos"}),s.jsx("div",{className:"campaigns-history-subtitle",children:"ltimos 30 das"})]}),s.jsx("button",{className:"campaigns-link",type:"button",onClick:L,children:"Ver todo el historial"})]}),s.jsxs("div",{className:"history-table history-table--main",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"Campaa / Fecha"}),s.jsx("span",{children:"Alcance"}),s.jsx("span",{children:"Tasa de lectura"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),i.map(o=>{const y=Eh[o.status]||o.status,M=o.audience_count||o.messages_count||o.total||"--";return s.jsxs("div",{className:"history-row",children:[s.jsxs("div",{className:"history-title",children:[s.jsx("div",{className:"history-name",children:o.name}),s.jsx("div",{className:"history-date",children:P(o.created_at)})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:M}),s.jsx("div",{className:"history-label",children:"contactos"})]}),s.jsxs("div",{className:"history-meter",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-bar",children:s.jsx("div",{className:"history-bar-fill",style:{width:"0%"}})})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-label",children:"mensajes"})]}),s.jsx("div",{className:`history-status ${o.status}`,children:y}),s.jsxs("div",{className:"history-actions",children:[s.jsx("button",{className:"campaigns-ghost small",type:"button",onClick:()=>O(o.id),children:"Ver mensajes"}),s.jsx("button",{className:"campaigns-danger small",type:"button",onClick:()=>g(o.id),disabled:o.status==="sending",children:"Enviar"})]})]},o.id)}),!i.length&&s.jsx("div",{className:"empty-state",children:"Sin Campaas registradas"})]}),l&&s.jsxs("div",{className:"campaigns-messages",children:[s.jsx("div",{className:"campaigns-history-title",children:"Mensajes"}),s.jsxs("div",{className:"history-table history-table--messages",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"WA"}),s.jsx("span",{children:"Status"}),s.jsx("span",{children:"Enviado"})]}),c.map(o=>s.jsxs("div",{className:"history-row",children:[s.jsx("span",{children:o.wa_id}),s.jsx("span",{children:o.status}),s.jsx("span",{children:P(o.sent_at)})]},o.id))]})]})]})]})})]}),he&&s.jsx("div",{className:"modal-overlay",onClick:()=>je(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Previsualizar plantilla"}),s.jsx("button",{className:"modal-close",onClick:()=>je(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:B}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(Ee==null?void 0:Ee.body_preview)||(Ee==null?void 0:Ee.body_text)||"Sin previsualizacin disponible."}),wi.length>0&&s.jsx("div",{className:"preview-actions",children:wi.map((o,y)=>s.jsx("button",{type:"button",children:o.text||o.label||o.title||`Botn ${y+1}`},`preview-modal-btn-${y}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})}),St&&s.jsx("div",{className:"modal-overlay",onClick:()=>Mt(!1),children:s.jsxs("div",{className:"modal-content",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Editar contacto"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>Mt(!1),children:"x"})]}),s.jsxs("form",{className:"modal-body",onSubmit:ko,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:be.name,onChange:o=>st(y=>({...y,name:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Telfono"}),s.jsx("input",{type:"text",value:be.phone,onChange:o=>st(y=>({...y,phone:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:be.email,onChange:o=>st(y=>({...y,email:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"CI / NIT"}),s.jsx("input",{type:"text",value:be.vat,onChange:o=>st(y=>({...y,vat:o.target.value}))})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{className:"btn-secondary",type:"button",onClick:()=>Mt(!1),children:"Cancelar"}),s.jsx("button",{className:"btn-primary",type:"submit",disabled:Ut,children:Ut?"Guardando...":"Guardar"})]})]})]})})]})}function za({variant:e="error",title:t,message:n,actionLabel:r,onAction:a,dismissLabel:i="Cerrar",onDismiss:l}){const c=e==="offline"?"x":"!";return s.jsxs("div",{className:`notice-banner notice-banner-${e}`,children:[s.jsx("div",{className:"notice-icon","aria-hidden":"true",children:c}),s.jsxs("div",{className:"notice-content",children:[t?s.jsx("div",{className:"notice-title",children:t}):null,s.jsx("div",{className:"notice-text",children:n})]}),s.jsxs("div",{className:"notice-actions",children:[r&&s.jsx("button",{className:"notice-action",type:"button",onClick:a,children:r}),l&&s.jsx("button",{className:"notice-close",type:"button",onClick:l,children:i})]})]})}const oy={admin:{title:"Administrador",subtitle:"Acceso total",tone:"alert"},recepcion:{title:"Operador",subtitle:"Atencion al cliente",tone:"info"},caja:{title:"Supervisor",subtitle:"Auditoria y gestion",tone:"dark"},marketing:{title:"Marketing",subtitle:"Crecimiento y campanas",tone:"info"},doctor:{title:"Doctor",subtitle:"Atencion al cliente",tone:"dark"}},Lh=[{id:"chat",label:"Chat"},{id:"dashboard",label:"Dashboard"},{id:"campaigns",label:"Campanas"}],Rh=[{id:"general",label:"General"},{id:"users",label:"Gestion de Usuarios"},{id:"bot",label:"Configuracion de Bot"},{id:"templates",label:"Plantillas de Meta"},{id:"audit",label:"Registros / Auditoria"},{id:"odoo",label:"Integracion Odoo"}];function Oh(e){return oy[e]||{title:e,subtitle:"Acceso personalizado",tone:"info"}}function cy({settingsTab:e,setSettingsTab:t,rolePermissions:n,setRolePermissions:r,isAdmin:a,adminUsers:i,userForm:l,setUserForm:c,roleOptions:u,handleUserSubmit:m,handleUserDelete:S,defaultRolePermissions:v,handleRoleDelete:x}){const[E,L]=h.useState(""),[O,g]=h.useState(!1),[f,p]=h.useState(""),[j,k]=h.useState(null),[P,$]=h.useState(!1),[B,w]=h.useState("create"),[D,R]=h.useState("recepcion"),[X,he]=h.useState({modules:{},settings:{}}),je=h.useMemo(()=>{const A=E.trim().toLowerCase(),q=i||[];return A?q.filter(b=>{var ie,fe;const U=((ie=b.name)==null?void 0:ie.toLowerCase())||"",G=((fe=b.email)==null?void 0:fe.toLowerCase())||"";return U.includes(A)||G.includes(A)}):q},[i,E]);function Ee(A){const q=(n==null?void 0:n[A])||(v==null?void 0:v[A])||{modules:{},settings:{}};return{modules:{...q.modules||{}},settings:{...q.settings||{}}}}function Re(A,q="edit"){w(q),R(A),he(Ee(A)),$(!0)}function Te(A,q,b){he(U=>{const G={...U},ie={...G[A]||{}},fe={...ie[q]||{}},pe=!fe[b];return fe[b]=pe,b==="write"&&pe&&(fe.read=!0),b==="read"&&!pe&&(fe.write=!1),ie[q]=fe,G[A]=ie,G})}function Xe(){D&&(r(A=>({...A,[D]:X})),$(!1))}function W(){D&&x&&x(D),$(!1)}function te(A,q,b,U){a&&r(G=>{var _t,ge;const ie={...G},fe={modules:{...(_t=ie[A])==null?void 0:_t.modules},settings:{...(ge=ie[A])==null?void 0:ge.settings}},pe={...fe[q]},nt={...pe[b]},lt=!nt[U];return nt[U]=lt,U==="write"&&lt&&(nt.read=!0),U==="read"&&!lt&&(nt.write=!1),pe[b]=nt,fe[q]=pe,ie[A]=fe,ie})}function Z(A){return Oh(A).title.toUpperCase()}function ce(A,q){return A!=null&&A.id?`OP-${A.id.slice(-4).toUpperCase()}`:`OP-${String(q+1).padStart(4,"0")}`}function oe(A){c({id:A.id,name:A.name,email:A.email,role:A.role,password:"",is_active:A.is_active}),g(!0)}function Oe(){c({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),g(!0)}return s.jsxs("div",{className:"users-page",children:[s.jsxs("header",{className:"users-header",children:[s.jsxs("div",{className:"users-title-row",children:[s.jsx("span",{className:"users-kicker"}),s.jsxs("div",{children:[s.jsx("div",{className:"users-title",children:"Gestion de Usuarios"}),s.jsx("div",{className:"users-subtitle",children:"Administra los accesos y roles de los operadores de tu empresa."})]})]}),s.jsxs("div",{className:"users-actions",children:[e==="list"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"users-search",children:[s.jsx("span",{className:"users-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar usuario...",value:E,onChange:A=>L(A.target.value)})]}),s.jsx("button",{className:"settings-primary",type:"button",onClick:Oe,children:"Nuevo Usuario"})]}),e==="roles"&&s.jsx("button",{className:"settings-primary",type:"button",onClick:()=>Re("recepcion","create"),children:"+ Nuevo Rol"})]})]}),s.jsxs("div",{className:"users-tabs",children:[s.jsx("button",{className:`users-tab ${e==="list"?"active":""}`,type:"button",onClick:()=>t("list"),children:"Lista de Usuarios"}),s.jsx("button",{className:`users-tab ${e==="roles"?"active":""}`,type:"button",onClick:()=>t("roles"),children:"Roles y Permisos"})]}),e==="list"&&s.jsxs("div",{className:"users-table",children:[s.jsxs("div",{className:"users-table-head",children:[s.jsx("span",{children:"Nombre / Usuario"}),s.jsx("span",{children:"Email"}),s.jsx("span",{children:"Rol"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),je.map((A,q)=>{var b;return s.jsxs("div",{className:"users-row",children:[s.jsxs("div",{className:"users-cell user-name",children:[s.jsx("div",{className:"user-avatar",children:((b=A.name)==null?void 0:b[0])||"?"}),s.jsxs("div",{children:[s.jsx("div",{className:"user-title",children:A.name}),s.jsx("div",{className:"user-id",children:ce(A,q)})]})]}),s.jsx("div",{className:"users-cell",children:A.email}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`role-pill ${A.role}`,children:Z(A.role)})}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`status-pill ${A.is_active?"active":"inactive"}`,children:A.is_active?"Activo":"Inactivo"})}),s.jsx("div",{className:"users-cell",children:s.jsxs("div",{className:"users-actions-menu",children:[s.jsx("button",{className:"users-action",type:"button",onClick:()=>p(U=>U===A.id?"":A.id),children:"..."}),f===A.id&&s.jsxs("div",{className:"users-menu",children:[s.jsx("button",{type:"button",onClick:()=>{p(""),oe(A)},children:"Editar"}),s.jsx("button",{type:"button",onClick:()=>{p(""),k(A)},children:"Eliminar"})]})]})})]},A.id)}),!je.length&&s.jsx("div",{className:"empty-state",children:"Sin usuarios para mostrar"})]}),e==="roles"&&s.jsx("div",{className:"roles-grid",children:u.map(A=>{const q=Oh(A),b=n==null?void 0:n[A];return s.jsxs("div",{className:"role-card",children:[s.jsxs("div",{className:"role-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"role-title",children:q.title}),s.jsx("div",{className:`role-subtitle ${q.tone}`,children:q.subtitle})]}),s.jsx("button",{className:"role-edit",type:"button",onClick:()=>Re(A,"edit"),children:"edit"})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),Lh.map(U=>{var G,ie,fe,pe;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ie=(G=b==null?void 0:b.modules)==null?void 0:G[U.id])==null?void 0:ie.read)||!1,disabled:!a,onChange:()=>te(A,"modules",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((pe=(fe=b==null?void 0:b.modules)==null?void 0:fe[U.id])==null?void 0:pe.write)||!1,disabled:!a,onChange:()=>te(A,"modules",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsx("div",{className:"role-settings-title",children:"Configuracion"}),Rh.map(U=>{var G,ie,fe,pe;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ie=(G=b==null?void 0:b.settings)==null?void 0:G[U.id])==null?void 0:ie.read)||!1,disabled:!a,onChange:()=>te(A,"settings",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((pe=(fe=b==null?void 0:b.settings)==null?void 0:fe[U.id])==null?void 0:pe.write)||!1,disabled:!a,onChange:()=>te(A,"settings",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]})]},A)})}),O&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:l.id?"Editar usuario":"Crear usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>g(!1),children:"x"})]}),s.jsxs("form",{className:"form-grid",onSubmit:async A=>{await m(A),g(!1)},children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:A=>c(q=>({...q,name:A.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:l.email,onChange:A=>c(q=>({...q,email:A.target.value})),disabled:!!l.id})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),s.jsx("select",{value:l.role,onChange:A=>c(q=>({...q,role:A.target.value})),children:u.map(A=>s.jsx("option",{value:A,children:A},A))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:l.password,onChange:A=>c(q=>({...q,password:A.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:A=>c(q=>({...q,is_active:A.target.checked}))}),"Activo"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"primary",type:"submit",children:l.id?"Guardar cambios":"Crear"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>g(!1),children:"Cancelar"})]})]})]})}),j&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Eliminar usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>k(null),children:"x"})]}),s.jsxs("p",{className:"modal-text",children:["Vas a desactivar a ",s.jsx("strong",{children:j.email}),". Continuar?"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"danger",type:"button",onClick:()=>{S==null||S(j.id),k(null)},children:"Eliminar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>k(null),children:"Cancelar"})]})]})}),P&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card modal-lg",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:B==="create"?"Nuevo rol":"Editar rol"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>$(!1),children:"x"})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),B==="edit"?s.jsx("select",{value:D,disabled:!0,children:u.map(A=>s.jsx("option",{value:A,children:A},A))}):s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"text",list:"role-options",placeholder:"nuevo-rol",value:D,onChange:A=>R(A.target.value)}),s.jsx("datalist",{id:"role-options",children:u.map(A=>s.jsx("option",{value:A},A))})]})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Modulos"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),Lh.map(A=>{var q,b,U,G;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:A.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((b=(q=X==null?void 0:X.modules)==null?void 0:q[A.id])==null?void 0:b.read)||!1,onChange:()=>Te("modules",A.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((G=(U=X==null?void 0:X.modules)==null?void 0:U[A.id])==null?void 0:G.write)||!1,onChange:()=>Te("modules",A.id,"write")}),s.jsx("span",{})]})]},A.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Configuracion"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),Rh.map(A=>{var q,b,U,G;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:A.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((b=(q=X==null?void 0:X.settings)==null?void 0:q[A.id])==null?void 0:b.read)||!1,onChange:()=>Te("settings",A.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((G=(U=X==null?void 0:X.settings)==null?void 0:U[A.id])==null?void 0:G.write)||!1,onChange:()=>Te("settings",A.id,"write")}),s.jsx("span",{})]})]},A.id)})]})]}),s.jsxs("div",{className:"form-actions",children:[B==="edit"&&s.jsx("button",{className:"danger",type:"button",onClick:W,children:"Eliminar rol"}),s.jsx("button",{className:"primary",type:"button",onClick:Xe,disabled:!D,children:"Guardar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>$(!1),children:"Cancelar"})]})]})})]})}function uy({branches:e,branchForm:t,setBranchForm:n,handleBranchSubmit:r,handleBranchDisable:a,services:i,serviceForm:l,setServiceForm:c,handleServiceSubmit:u,handleServiceDisable:m,handleServiceBranchToggle:S,tenantChannels:v,channelForm:x,setChannelForm:E,handleChannelSelect:L,handleChannelSubmit:O}){return s.jsxs("div",{className:"page-grid",children:[s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Sucursales"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Nombre"}),s.jsx("span",{children:"Codigo"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Accion"})]}),e.map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.name}),s.jsx("span",{children:g.code}),s.jsx("span",{children:g.is_active?"Activa":"Inactiva"}),s.jsxs("div",{className:"row-actions",children:[s.jsx("button",{className:"ghost",onClick:()=>n({id:g.id,code:g.code,name:g.name,address:g.address,lat:g.lat,lng:g.lng,hours_text:g.hours_text,phone:g.phone||"",is_active:g.is_active}),children:"Editar"}),s.jsx("button",{className:"danger",onClick:()=>a(g.id),children:"Desactivar"})]})]},g.id))]}),s.jsx("div",{className:"panel-title",children:t.id?"Editar sucursal":"Crear sucursal"}),s.jsxs("form",{className:"form-grid",onSubmit:r,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Codigo"}),s.jsx("input",{type:"text",value:t.code,onChange:g=>n(f=>({...f,code:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:t.name,onChange:g=>n(f=>({...f,name:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Direccion"}),s.jsx("input",{type:"text",value:t.address,onChange:g=>n(f=>({...f,address:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Lat"}),s.jsx("input",{type:"number",value:t.lat,onChange:g=>n(f=>({...f,lat:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Lng"}),s.jsx("input",{type:"number",value:t.lng,onChange:g=>n(f=>({...f,lng:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Telefono"}),s.jsx("input",{type:"text",value:t.phone,onChange:g=>n(f=>({...f,phone:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Horarios"}),s.jsx("textarea",{rows:"3",value:t.hours_text,onChange:g=>n(f=>({...f,hours_text:g.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:t.is_active,onChange:g=>n(f=>({...f,is_active:g.target.checked}))}),"Activa"]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Guardar"})})]})]}),s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Servicios"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Servicio"}),s.jsx("span",{children:"Precio"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Accion"})]}),i.map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.name}),s.jsxs("span",{children:["Bs ",g.price_bob]}),s.jsx("span",{children:g.is_active?"Activo":"Inactivo"}),s.jsxs("div",{className:"row-actions",children:[s.jsx("button",{className:"ghost",onClick:()=>c({id:g.id,code:g.code,name:g.name,subtitle:g.subtitle||"",description:g.description,price_bob:g.price_bob,duration_min:g.duration_min||"",image_url:g.image_url||"",is_featured:g.is_featured,is_active:g.is_active}),children:"Editar"}),s.jsx("button",{className:"danger",onClick:()=>m(g.id),children:"Desactivar"})]})]},g.id))]}),s.jsx("div",{className:"panel-title",children:l.id?"Editar servicio":"Crear servicio"}),s.jsxs("form",{className:"form-grid",onSubmit:u,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Codigo"}),s.jsx("input",{type:"text",value:l.code,onChange:g=>c(f=>({...f,code:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:g=>c(f=>({...f,name:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Subtitulo"}),s.jsx("input",{type:"text",value:l.subtitle,onChange:g=>c(f=>({...f,subtitle:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Descripcion"}),s.jsx("textarea",{rows:"3",value:l.description,onChange:g=>c(f=>({...f,description:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Precio (Bs)"}),s.jsx("input",{type:"number",value:l.price_bob,onChange:g=>c(f=>({...f,price_bob:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Duracion (min)"}),s.jsx("input",{type:"number",value:l.duration_min,onChange:g=>c(f=>({...f,duration_min:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Imagen URL"}),s.jsx("input",{type:"text",value:l.image_url,onChange:g=>c(f=>({...f,image_url:g.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_featured,onChange:g=>c(f=>({...f,is_featured:g.target.checked}))}),"Destacado"]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:g=>c(f=>({...f,is_active:g.target.checked}))}),"Activo"]}),l.id&&s.jsxs("div",{className:"field",children:[s.jsx("span",{children:"Disponibilidad por sucursal"}),s.jsx("div",{className:"chip-grid",children:e.map(g=>{var j,k;const f=(k=(j=i.find(P=>P.id===l.id))==null?void 0:j.branches)==null?void 0:k.find(P=>{var B;return(((B=P.branch)==null?void 0:B.id)||P.branch_id)===g.id}),p=(f==null?void 0:f.is_available)||!1;return s.jsxs("label",{className:"chip",children:[s.jsx("input",{type:"checkbox",checked:p,onChange:P=>S(i.find($=>$.id===l.id),g.id,P.target.checked)}),g.name]},g.id)})})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Guardar"})})]})]}),s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Lineas de WhatsApp"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Nombre"}),s.jsx("span",{children:"Phone ID"}),s.jsx("span",{children:"Accion"})]}),(v||[]).map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.display_name||"Linea sin nombre"}),s.jsx("span",{children:g.phone_number_id}),s.jsx("button",{className:"ghost",onClick:()=>L(g),children:"Renombrar"})]},g.id)),!(v!=null&&v.length)&&s.jsx("div",{className:"empty-state",children:"Sin lineas registradas"})]}),s.jsx("div",{className:"panel-title",children:x.id?"Editar linea":"Selecciona una linea"}),s.jsxs("form",{className:"form-grid",onSubmit:O,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre visible"}),s.jsx("input",{type:"text",value:x.display_name,onChange:g=>E(f=>({...f,display_name:g.target.value})),disabled:!x.id})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",disabled:!x.id,children:"Guardar"})})]})]})]})}function dy(){var L,O,g,f,p,j,k,P,$,B;const[e,t]=h.useState([]),[n,r]=h.useState(null),[a,i]=h.useState(!0),[l,c]=h.useState("");h.useEffect(()=>{u()},[]);async function u(){i(!0);try{const[w,D]=await Promise.all([me("/api/admin/bots"),me("/api/admin/bots/metrics")]);t(w.bots||[]),r(D.metrics),c("")}catch(w){console.error(w),c(w.message||"Error al cargar datos")}finally{i(!1)}}async function m(w,D){try{await Qe(`/api/admin/bots/${w}`,{is_active:D}),t(R=>R.map(X=>X.id===w?{...X,is_active:D}:X))}catch(R){c(R.message||"Error al cambiar estado")}}const S=w=>{if(!w)return"Sin actividad reciente";const D=new Date(w),X=new Date-D,he=Math.floor(X/6e4);if(he<1)return"Hace un momento";if(he<60)return`ltima actividad: hace ${he} min`;const je=Math.floor(he/60);return je<24?`ltima actividad: hace ${je}h`:`ltima actividad: ${D.toLocaleDateString()}`},v=e.filter(w=>w.is_active).length,x=v>0?"ACTIVO":"INACTIVO",E=v>0?"active":"inactive";return s.jsxs("div",{className:"bot-section",children:[s.jsxs("div",{className:"bot-section-header",children:[s.jsxs("div",{className:"bot-section-title-area",children:[s.jsx("div",{className:"bot-section-icon",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"bot-section-title",children:"Gestin de Bots"}),s.jsx("p",{className:"bot-section-subtitle",children:"Administra los flujos automatizados y el rendimiento tcnico."})]})]}),s.jsxs("div",{className:"bot-section-global-toggle",children:[s.jsx("span",{className:"bot-toggle-label",children:"ESTADO DEL BOT:"}),s.jsxs("div",{className:`bot-toggle-pill ${E}`,children:[s.jsx("span",{className:"bot-toggle-dot"}),s.jsx("span",{children:x})]})]})]}),l&&s.jsx("div",{className:"bot-error",children:l}),s.jsxs("div",{className:"bot-section-content",children:[s.jsxs("div",{className:"bot-flows-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MONITOREO DE FLUJOS"})}),a?s.jsx("div",{className:"bot-loading",children:"Cargando bots..."}):e.length===0?s.jsxs("div",{className:"bot-empty",children:[s.jsx("p",{children:"No hay bots asignados a tu cuenta."}),s.jsx("p",{className:"bot-empty-hint",children:"Contacta con soporte si necesitas activar un bot."})]}):s.jsx("div",{className:"bot-flows-list",children:e.map(w=>s.jsxs("div",{className:"bot-flow-card",children:[s.jsxs("div",{className:"bot-flow-info",children:[s.jsx("span",{className:"bot-flow-icon",children:w.flow_icon||""}),s.jsxs("div",{children:[s.jsx("div",{className:"bot-flow-name",children:w.flow_name}),s.jsxs("div",{className:`bot-flow-status ${w.is_active?"active":"inactive"}`,children:[" ",w.is_active?"ACTIVO":"INACTIVO"]})]})]}),s.jsx("div",{className:"bot-flow-actions",children:s.jsxs("label",{className:"bot-toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:w.is_active,onChange:()=>m(w.id,!w.is_active)}),s.jsx("span",{className:"bot-toggle-slider"})]})}),s.jsx("div",{className:"bot-flow-meta",children:S(w.updated_at)}),w.flow_description&&s.jsx("div",{className:"bot-flow-desc",children:w.flow_description})]},w.id))})]}),s.jsxs("div",{className:"bot-metrics-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MTRICAS DE EFICACIA DETALLADAS"})}),s.jsxs("div",{className:"bot-metrics-grid",children:[s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:`bot-metric-badge ${((L=n==null?void 0:n.interactions)==null?void 0:L.change)>=0?"positive":"neutral"}`,children:[((O=n==null?void 0:n.interactions)==null?void 0:O.change)>0?"+":"",(g=n==null?void 0:n.interactions)==null?void 0:g.change,"% ",(f=n==null?void 0:n.interactions)==null?void 0:f.label]}),s.jsx("div",{className:"bot-metric-label",children:"INTERACCIONES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.interactions.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"Total de sesiones iniciadas hoy"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge neutral",children:["Objetivo: ",(p=n==null?void 0:n.resolution)==null?void 0:p.target,"%"]}),s.jsx("div",{className:"bot-metric-label",children:"RESOLUCIN FINAL"}),s.jsxs("div",{className:"bot-metric-value",children:[n?n.resolution.value:"--","%"]}),s.jsx("div",{className:"bot-metric-progress",children:s.jsx("div",{className:"bot-metric-progress-fill",style:{width:`${n?n.resolution.value:0}%`}})})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge sla",children:[" ",(j=n==null?void 0:n.uptime)==null?void 0:j.status]}),s.jsx("div",{className:"bot-metric-label",children:"VIDA DEL PROCESO"}),s.jsx("div",{className:"bot-metric-value",children:n?n.uptime.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"UPTIME SISTEMA"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:`bot-metric-icon ${((k=n==null?void 0:n.errors)==null?void 0:k.value)>0?"error":""}`,children:""}),s.jsx("div",{className:`bot-metric-badge ${((P=n==null?void 0:n.errors)==null?void 0:P.value)===0?"stable":"neutral"}`,children:($=n==null?void 0:n.errors)==null?void 0:$.status}),s.jsx("div",{className:"bot-metric-label",children:"ERRORES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.errors.value:"--"}),s.jsxs("div",{className:`bot-metric-sub ${((B=n==null?void 0:n.errors)==null?void 0:B.critical)>0?"error-sub":""}`,children:["CRTICOS: ",n?n.errors.critical:0]})]})]})]})]})]})}const Ph={DRAFT:{bg:"#e3e8ef",text:"#475569",label:"BORRADOR"},PENDING:{bg:"#fef3c7",text:"#d97706",label:"PENDIENTE"},APPROVED:{bg:"#d1fae5",text:"#059669",label:"APROBADA"},REJECTED:{bg:"#fee2e2",text:"#dc2626",label:"RECHAZADA"},PAUSED:{bg:"#fef3c7",text:"#d97706",label:"PAUSADA"},DISABLED:{bg:"#e5e7eb",text:"#6b7280",label:"DESHABILITADA"}},hy=[{value:"UTILITY",label:"Utility"},{value:"MARKETING",label:"Marketing"},{value:"AUTHENTICATION",label:"Authentication"}],fy=[{value:"es",label:"Espaol (ES)"},{value:"en",label:"English (EN)"}];function py({templates:e=[],templateForm:t,setTemplateForm:n,handleTemplateSubmit:r,handleTemplateSubmitToMeta:a,handleTemplateDelete:i,handleSyncTemplates:l,onLoadTemplates:c,brandName:u=""}){var q;const m=(u||"PODOPIE").trim(),[S,v]=h.useState("list"),[x,E]=h.useState(null),[L,O]=h.useState(""),[g,f]=h.useState(!1),[p,j]=h.useState(""),[k,P]=h.useState(!1),[$,B]=h.useState(!1),[w,D]=h.useState(null),[R,X]=h.useState({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),[he,je]=h.useState([]);h.useEffect(()=>{c&&c()},[]);const Ee=async()=>{f(!0);try{await l()}finally{f(!1)}},Re=()=>{E(null),X({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),je([]),v("editor")},Te=b=>{E(b),X({name:b.name||"",category:b.category||"UTILITY",language:b.language||"es",body_text:b.body_text||b.body_preview||"",header_type:b.header_type||"",header_content:b.header_content||"",footer_text:b.footer_text||"",buttons:b.buttons_json||[]}),je(b.variable_mappings||[]),v("editor")},Xe=async b=>{!(b!=null&&b.id)||!i||!window.confirm(`Eliminar la plantilla "${b.name}"? Esta accin la ocultar localmente y la eliminar de Meta si aplica.`)||await i(b.id)},W=async b=>{b.preventDefault();const U={...R,id:x==null?void 0:x.id,variable_mappings:he};if(n&&n(U),r){const G=await r(null,U);G&&E(G)}},te=async()=>{if(a){P(!0);try{let b=x==null?void 0:x.id;if(!b){const U={...R,variable_mappings:he},G=await r(null,U);b=G==null?void 0:G.id,G&&E(G)}b&&(await a(b),v("list"),E(null))}finally{P(!1)}}},Z=()=>{v("list"),E(null)},ce=b=>{const U=(b==null?void 0:b.buttons_json)??(b==null?void 0:b.buttons)??[];if(Array.isArray(U))return U;if(typeof U=="string")try{const G=JSON.parse(U);return Array.isArray(G)?G:[]}catch{return[]}return[]},Oe=(b=>{const U=b.match(/\{\{(\d+)\}\}/g)||[];return[...new Set(U)].map(G=>parseInt(G.replace(/[{}]/g,"")))})(R.body_text),A=e.filter(b=>{var ie;const U=!L||((ie=b.name)==null?void 0:ie.toLowerCase().includes(L.toLowerCase()))||(b.body_text||b.body_preview||"").toLowerCase().includes(L.toLowerCase()),G=!p||b.status===p;return U&&G});return S==="list"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"templates-section",children:[s.jsxs("div",{className:"templates-header",children:[s.jsxs("div",{className:"templates-title-row",children:[s.jsx("h1",{children:"Plantillas de Meta"}),s.jsxs("span",{className:"meta-connected-badge",children:[s.jsx("span",{className:"status-dot"}),"CONECTADO A META API"]})]}),s.jsxs("div",{className:"templates-actions",children:[s.jsx("div",{className:"search-input-wrap",children:s.jsx("input",{type:"text",placeholder:"Buscar plantillas...",value:L,onChange:b=>O(b.target.value)})}),s.jsxs("select",{value:p,onChange:b=>j(b.target.value),className:"status-filter-select",children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"APPROVED",children:"Aprobadas"}),s.jsx("option",{value:"PENDING",children:"Pendientes"}),s.jsx("option",{value:"REJECTED",children:"Rechazadas"}),s.jsx("option",{value:"DRAFT",children:"Borradores"})]}),s.jsx("button",{className:"btn-sync",onClick:Ee,disabled:g,children:g?" Sincronizando...":" Sincronizar"}),s.jsxs("button",{className:"btn-create-template",onClick:Re,children:[s.jsx("span",{children:"+"})," Crear Nueva Plantilla"]})]})]}),s.jsxs("div",{className:"templates-grid",children:[A.map(b=>{var G;const U=Ph[b.status]||Ph.DRAFT;return s.jsxs("div",{className:"template-card",onClick:()=>Te(b),children:[s.jsxs("div",{className:"template-card-head",children:[s.jsx("div",{className:"template-category-icon",children:b.category==="MARKETING"?"":b.category==="UTILITY"?"":""}),s.jsx("span",{className:"template-status-badge",style:{backgroundColor:U.bg,color:U.text},children:U.label})]}),s.jsx("h3",{className:"template-card-name",children:b.name}),s.jsxs("div",{className:"template-card-meta",children:[s.jsx("span",{className:"tag-category",children:b.category}),s.jsx("span",{className:"tag-language",children:b.language==="es"?"ESPAOL (ES)":(G=b.language)==null?void 0:G.toUpperCase()})]}),(b.body_text||b.body_preview)&&s.jsxs("p",{className:"template-card-preview",children:[(b.body_text||b.body_preview).slice(0,80),"..."]}),s.jsxs("div",{className:"template-card-actions",children:[s.jsx("button",{className:"btn-preview",onClick:ie=>{ie.stopPropagation(),D(b),B(!0)},children:"Vista previa"}),s.jsx("button",{className:"btn-preview danger",onClick:ie=>{ie.stopPropagation(),Xe(b)},children:"Eliminar"})]})]},b.id)}),s.jsxs("div",{className:"template-card template-card-create",onClick:Re,children:[s.jsx("div",{className:"create-icon",children:"+"}),s.jsx("h3",{children:"Crear nueva plantilla"}),s.jsx("p",{children:"Empieza a disear tu flujo de WhatsApp"})]})]}),A.length===0&&!L&&s.jsx("div",{className:"templates-empty",children:s.jsx("p",{children:"No hay plantillas. Crea una nueva o sincroniza desde Meta."})})]}),$&&s.jsx("div",{className:"modal-overlay",onClick:()=>B(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:b=>b.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Vista previa"}),s.jsx("button",{className:"modal-close",onClick:()=>B(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:m}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(w==null?void 0:w.body_preview)||(w==null?void 0:w.body_text)||"Sin previsualizacin disponible."}),ce(w).length>0&&s.jsx("div",{className:"preview-actions",children:ce(w).map((b,U)=>s.jsx("button",{type:"button",children:b.text||b.label||b.title||`Botn ${U+1}`},`prev-${U}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})})]}):s.jsxs("div",{className:"template-editor",children:[s.jsxs("div",{className:"editor-header",children:[s.jsxs("div",{className:"editor-breadcrumb",children:[s.jsx("button",{className:"btn-back",onClick:Z,children:" Volver"}),s.jsx("span",{className:"breadcrumb-sep",children:"/"}),s.jsx("span",{children:x?"Editar Plantilla":"Nueva Plantilla"})]}),s.jsxs("div",{className:"editor-actions",children:[s.jsx("button",{className:"btn-save-draft",onClick:W,children:" Guardar Borrador"}),((x==null?void 0:x.status)==="DRAFT"||(x==null?void 0:x.status)==="REJECTED"||!x)&&s.jsx("button",{className:"btn-primary",onClick:te,disabled:k||!R.name||!R.body_text,children:k?"Enviando...":"Enviar a Meta"}),s.jsx("button",{className:"btn-discard",onClick:Z,children:" Descartar"})]})]}),s.jsxs("div",{className:"editor-layout",children:[s.jsxs("div",{className:"editor-form-panel",children:[s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" General Settings"}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Template Name"}),s.jsx("input",{type:"text",placeholder:"patient_appointment_reminder",value:R.name,onChange:b=>X({...R,name:b.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")})})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Category"}),s.jsx("select",{value:R.category,onChange:b=>X({...R,category:b.target.value}),children:hy.map(b=>s.jsx("option",{value:b.value,children:b.label},b.value))})]}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Language"}),s.jsx("select",{value:R.language,onChange:b=>X({...R,language:b.target.value}),children:fy.map(b=>s.jsx("option",{value:b.value,children:b.label},b.value))})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("div",{className:"form-section-header",children:[s.jsx("h3",{children:" Message Body"}),s.jsx("button",{className:"btn-insert-var",type:"button",onClick:()=>{const b=Oe.length+1;X({...R,body_text:R.body_text+`{{${b}}}`})},children:"+ Insert Variable"})]}),s.jsx("textarea",{rows:"6",placeholder:`Hola {{1}}, te recordamos tu cita en ${m} para el da {{2}} a las {{3}}. Por favor, confirma tu asistencia.`,value:R.body_text,onChange:b=>X({...R,body_text:b.target.value})}),s.jsxs("div",{className:"char-count",children:[R.body_text.length," / 1024"]})]})]}),s.jsxs("div",{className:"editor-preview-panel",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:m}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:R.body_text||"Tu mensaje aparecer aqu..."}),R.buttons&&R.buttons.length>0&&s.jsx("div",{className:"preview-actions",children:R.buttons.map((b,U)=>s.jsx("button",{type:"button",children:b.text||b.title||`Botn ${U+1}`},`btn-${U}`))}),s.jsx("div",{className:"preview-time",children:"10:42 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:R.name||"Sin nombre"})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Idioma"}),s.jsx("strong",{children:((q=R.language)==null?void 0:q.toUpperCase())||"ES"})]})]})]}),s.jsxs("div",{className:"editor-mapping-panel",children:[s.jsxs("div",{className:"mapping-tabs",children:[s.jsx("button",{className:"tab active",children:"VARIABLES"}),s.jsx("button",{className:"tab",children:"BUTTONS"})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsx("h4",{children:"ODOO FIELD MAPPING"}),Oe.length===0?s.jsxs("p",{className:"mapping-empty",children:["Agrega variables ","{{1}}",", ","{{2}}","... en tu mensaje"]}):Oe.map(b=>{const U=he.find(G=>G.var_index===b)||{};return s.jsxs("div",{className:"mapping-item",children:[s.jsxs("div",{className:"mapping-var-badge",children:[`{{${b}}}`," Variable"]}),s.jsxs("select",{value:U.source_path||"",onChange:G=>{const ie=he.filter(fe=>fe.var_index!==b);ie.push({var_index:b,source_type:"odoo",source_path:G.target.value}),je(ie)},children:[s.jsx("option",{value:"",children:"Select Odoo Field..."}),s.jsx("option",{value:"partner_id.name",children:"patient_id.name"}),s.jsx("option",{value:"start_date",children:"start_date (Formatted)"}),s.jsx("option",{value:"start_time",children:"start_time"}),s.jsx("option",{value:"partner_id.phone",children:"patient_phone"})]}),s.jsx("span",{className:`mapping-status ${U.source_path?"linked":"needs"}`,children:U.source_path?" Linked":" Needs mapping"})]},b)})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsxs("div",{className:"mapping-section-header",children:[s.jsx("h4",{children:"ACTION BUTTONS"}),s.jsx("button",{className:"btn-add-button",onClick:()=>{X({...R,buttons:[...R.buttons||[],{type:"QUICK_REPLY",text:""}]})},children:"+ Add Button"})]}),(R.buttons||[]).map((b,U)=>s.jsxs("div",{className:"button-item",children:[s.jsx("span",{className:"button-icon",children:""}),s.jsx("input",{type:"text",placeholder:"Button text",value:b.text||"",onChange:G=>{const ie=[...R.buttons];ie[U]={...ie[U],text:G.target.value},X({...R,buttons:ie})}}),s.jsx("button",{className:"btn-remove",onClick:()=>{const G=R.buttons.filter((ie,fe)=>fe!==U);X({...R,buttons:G})},children:""})]},U))]}),s.jsxs("div",{className:"mapping-tip",children:[s.jsx("span",{className:"tip-icon",children:""}),s.jsx("span",{children:"Tip: Asegrate de que tus variables estn correctamente mapeadas a campos de Odoo antes de enviar."})]})]})]})]})}const Mh={campaigns:"",users:"",bot:"",chat:"",templates:"",audience:"",system:""},my={"user.created":"USUARIO CREADO","user.updated":"USUARIO EDITADO","user.disabled":"USUARIO ELIMINADO",template_draft_created:"PLANTILLA CREADA",template_draft_updated:"PLANTILLA EDITADA",template_submitted:"PLANTILLA ENVIADA",template_deleted:"PLANTILLA ELIMINADA",template_restored:"PLANTILLA RESTAURADA",audience_created:"SEGMENTO CREADO",audience_updated:"SEGMENTO EDITADO",audience_deleted:"SEGMENTO ELIMINADO","campaign.created":"CAMPAA CREADA","campaign.queued":"CAMPAA EN COLA","campaign.sending":"CAMPAA LANZADA","settings.updated":"CONFIG ACTUALIZADA","role_permissions.updated":"PERMISOS CAMBIADOS","role_permissions.deleted":"ROL ELIMINADO","conversation.status_changed":"CHAT ACTUALIZADO","conversation.tag_added":"TAG AGREGADO","conversation.tag_removed":"TAG ELIMINADO"};function jm(e){var r;const t=((r=e==null?void 0:e.data_json)==null?void 0:r.entity)||"";if(t==="template")return"templates";if(t==="audience")return"audience";if(t==="campaign")return"campaigns";if(t==="conversation")return"chat";const n=(e==null?void 0:e.action)||"";return n.includes("user")?"users":n.includes("campaign")?"campaigns":n.includes("template")?"templates":n.includes("audience")?"audience":n.includes("bot")?"bot":n.includes("conversation")?"chat":"system"}function oc(e){if(!e)return{date:"--",time:"--"};const t=new Date(e);return Number.isNaN(t.getTime())?{date:"--",time:"--"}:{date:t.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}),time:t.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}}function gy(e,t="csv"){const r=[["timestamp","usuario","email","accion","modulo","data"].join(",")];e.forEach(m=>{var L,O;const S=((L=m.user)==null?void 0:L.name)||"Sistema",v=((O=m.user)==null?void 0:O.email)||"",x=jm(m),E=[new Date(m.created_at).toISOString(),S,v,m.action,x,JSON.stringify(m.data_json||{})];r.push(E.map(g=>`"${String(g).replace(/"/g,'""')}"`).join(","))});const a=r.join(`
`),i=t==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv;charset=utf-8;",l=t==="excel"?"audit_logs.xlsx":"audit_logs.csv",c=new Blob([a],{type:i}),u=document.createElement("a");u.href=URL.createObjectURL(c),u.download=l,document.body.appendChild(u),u.click(),document.body.removeChild(u)}function vy(){var $,B;const[e,t]=h.useState(""),[n,r]=h.useState(""),[a,i]=h.useState(""),[l,c]=h.useState(1),[u]=h.useState(6),[m,S]=h.useState(0),[v,x]=h.useState([]),[E,L]=h.useState(!1),[O,g]=h.useState(null),f=Math.max(1,Math.ceil(m/u)),p=async({pageOverride:w}={})=>{L(!0);try{const D=new URLSearchParams;D.set("page",String(w||l)),D.set("page_size",String(u)),e.trim()&&D.set("q",e.trim()),n&&D.set("from",n),a&&D.set("to",a);const R=await me(`/api/admin/audit?${D.toString()}`);x(R.logs||[]),S(R.total||0)}finally{L(!1)}};h.useEffect(()=>{p()},[l]);const j=()=>{c(1),p({pageOverride:1})},k=async(w="csv")=>{const D=new URLSearchParams;D.set("page","1"),D.set("page_size","1000"),e.trim()&&D.set("q",e.trim()),n&&D.set("from",n),a&&D.set("to",a);const R=await me(`/api/admin/audit?${D.toString()}`);gy(R.logs||[],w)},P=h.useMemo(()=>{const w=[],D=Math.max(1,l-1),R=Math.min(f,D+2);for(let X=D;X<=R;X+=1)w.push(X);return w},[l,f]);return s.jsxs("div",{className:"audit-module",children:[s.jsxs("div",{className:"audit-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-title",children:"Registros / Auditoria"}),s.jsx("div",{className:"audit-subtitle",children:"Monitorea acciones de usuarios y eventos del sistema"})]}),s.jsxs("div",{className:"audit-export-group",children:[s.jsx("button",{className:"audit-export",type:"button",onClick:()=>k("excel"),children:" Exportar Excel"}),s.jsx("button",{className:"audit-export outline",type:"button",onClick:()=>k("csv"),children:" Exportar CSV"})]})]}),s.jsxs("div",{className:"audit-filters",children:[s.jsxs("div",{className:"audit-search",children:[s.jsx("span",{className:"audit-search-icon"}),s.jsx("input",{type:"text",placeholder:"Filtrar por usuario o accion..",value:e,onChange:w=>t(w.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Desde"}),s.jsx("input",{type:"date",value:n,onChange:w=>r(w.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Hasta"}),s.jsx("input",{type:"date",value:a,onChange:w=>i(w.target.value)})]}),s.jsx("button",{className:"audit-filter-btn",type:"button",onClick:j,children:"Filtrar"})]}),s.jsxs("div",{className:"audit-card",children:[s.jsxs("div",{className:"audit-table-head",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("span",{children:"Usuario"}),s.jsx("span",{children:"Accion"}),s.jsx("span",{children:"Modulo"})]}),E&&s.jsx("div",{className:"audit-empty",children:"Cargando registros..."}),!E&&!v.length&&s.jsx("div",{className:"audit-empty",children:"Sin registros para mostrar"}),!E&&v.map(w=>{var Ee,Re;const D=oc(w.created_at),R=jm(w),X=my[w.action]||w.action,he=((Ee=w.user)==null?void 0:Ee.name)||"System Bot",je=((Re=w.user)==null?void 0:Re.email)||"automated@service";return s.jsxs("button",{type:"button",className:"audit-row",onClick:()=>g(w),children:[s.jsxs("div",{className:"audit-cell time",children:[s.jsx("div",{children:D.date}),s.jsx("div",{className:"audit-time",children:D.time})]}),s.jsxs("div",{className:"audit-cell user",children:[s.jsx("div",{className:"audit-avatar",children:(he==null?void 0:he[0])||"S"}),s.jsxs("div",{children:[s.jsx("div",{className:"audit-user-name",children:he}),s.jsx("div",{className:"audit-user-email",children:je})]})]}),s.jsx("div",{className:"audit-cell action",children:s.jsx("span",{className:"audit-action-pill",children:X})}),s.jsxs("div",{className:"audit-cell module",children:[s.jsx("span",{className:"audit-module-icon",children:Mh[R]||Mh.system}),R.charAt(0).toUpperCase()+R.slice(1)]})]},w.id)})]}),s.jsxs("div",{className:"audit-footer",children:[s.jsxs("div",{children:["Mostrando ",v.length," de ",m," registros"]}),s.jsxs("div",{className:"audit-pagination",children:[s.jsx("button",{type:"button",disabled:l<=1,onClick:()=>c(w=>Math.max(1,w-1)),children:""}),P.map(w=>s.jsx("button",{type:"button",className:w===l?"active":"",onClick:()=>c(w),children:w},w)),s.jsx("button",{type:"button",disabled:l>=f,onClick:()=>c(w=>Math.min(f,w+1)),children:""})]})]}),O&&s.jsx("div",{className:"audit-modal",children:s.jsxs("div",{className:"audit-modal-card",children:[s.jsxs("div",{className:"audit-modal-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-modal-title",children:"Detalle del registro"}),s.jsx("div",{className:"audit-modal-subtitle",children:O.action})]}),s.jsx("button",{type:"button",onClick:()=>g(null),children:""})]}),s.jsxs("div",{className:"audit-modal-body",children:[s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Usuario"}),s.jsx("strong",{children:(($=O.user)==null?void 0:$.name)||"System Bot"}),s.jsx("small",{children:((B=O.user)==null?void 0:B.email)||"automated@service"})]}),s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("strong",{children:oc(O.created_at).date}),s.jsx("small",{children:oc(O.created_at).time})]}),s.jsxs("div",{className:"audit-detail full",children:[s.jsx("span",{children:"Data"}),s.jsx("pre",{children:JSON.stringify(O.data_json||{},null,2)})]})]})]})})]})}function xy(){return s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Integracion Odoo"}),s.jsx("div",{className:"empty-state",children:"Seccion en construccion"})]})}function yy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("line",{x1:"4",y1:"6",x2:"20",y2:"6",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"6",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"18",x2:"20",y2:"18",strokeWidth:"2"}),s.jsx("circle",{cx:"11",cy:"18",r:"2",strokeWidth:"2"})]})}function jy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"9",cy:"8",r:"3",strokeWidth:"2"}),s.jsx("path",{d:"M4 20c0-3 2.7-5.5 6-5.5s6 2.5 6 5.5",strokeWidth:"2"}),s.jsx("circle",{cx:"17",cy:"9",r:"2",strokeWidth:"2"}),s.jsx("path",{d:"M14 20c0-1.8 1.4-3.4 3.2-4",strokeWidth:"2"})]})}function Ny(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"2"})]})}function wy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"4",width:"12",height:"16",rx:"2",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"9",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"13",x2:"15",y2:"13",strokeWidth:"2"})]})}function _y(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"5",width:"12",height:"15",rx:"2",strokeWidth:"2"}),s.jsx("path",{d:"M9 5h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 10h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 14h6",strokeWidth:"2"})]})}function Sy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M8 4h4a2 2 0 1 1 0 4h-1v2h2a2 2 0 1 1 0 4h-2v2H8a2 2 0 1 1-4 0V8a2 2 0 1 1 4 0z",strokeWidth:"2"})})}function ky({settingsSection:e,setSettingsSection:t,settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,currentRole:l,isAdmin:c,adminUsers:u,userForm:m,setUserForm:S,roleOptions:v,handleUserSubmit:x,settings:E,setSettings:L,handleSaveSettings:O,branches:g,services:f,branchForm:p,setBranchForm:j,handleBranchSubmit:k,handleBranchDisable:P,serviceForm:$,setServiceForm:B,handleServiceSubmit:w,handleServiceDisable:D,handleServiceBranchToggle:R,templates:X,templateForm:he,setTemplateForm:je,handleTemplateSubmit:Ee,handleTemplateSubmitToMeta:Re,handleTemplateDelete:Te,handleSyncTemplates:Xe,auditLogs:W,formatDate:te,planName:Z,tenantChannels:ce,channelForm:oe,setChannelForm:Oe,handleChannelSelect:A,handleChannelSubmit:q,handleUserDelete:b,defaultRolePermissions:U,handleRoleDelete:G,useShellLayout:ie=!1,pageError:fe,isOffline:pe=!1,onDismissError:nt,brandName:lt=""}){const _t=a==null?void 0:a[l],ge=[{title:"Principal",items:[{id:"general",label:"General",icon:yy},{id:"users",label:"Gestion de Usuarios",icon:jy},{id:"bot",label:"Configuracion de Bot",icon:Ny}]},{title:"Canales e Integraciones",items:[{id:"templates",label:"Plantillas de Meta",icon:wy},{id:"audit",label:"Registros / Auditoria",icon:_y},{id:"odoo",label:"Integracion Odoo",icon:Sy}]}];function St(qe){var be,st;return!!((st=(be=_t==null?void 0:_t.settings)==null?void 0:be[qe])!=null&&st.read)}function Mt(qe){St(qe)&&t(qe)}const Ut=s.jsxs(s.Fragment,{children:[s.jsxs("aside",{className:"settings-sidebar",children:[s.jsxs("div",{className:"settings-header",children:[s.jsx("div",{className:"settings-title",children:"CONFIGURACION"}),s.jsxs("div",{className:"settings-version",children:[(lt||"Empresa").toUpperCase()," OS V2.0"]})]}),ge.map(qe=>s.jsxs("div",{className:"settings-group",children:[s.jsx("div",{className:"settings-group-title",children:qe.title}),s.jsx("div",{className:"settings-group-list",children:qe.items.map(be=>{const st=!St(be.id),kt=be.icon;return s.jsxs("button",{className:`settings-item ${e===be.id?"active":""}`,type:"button",onClick:()=>Mt(be.id),disabled:st,children:[s.jsx("span",{className:"settings-icon","aria-hidden":"true",children:s.jsx(kt,{className:"settings-icon-svg"})}),be.label]},be.id)})})]},qe.title)),s.jsxs("div",{className:"settings-plan",children:[s.jsx("div",{className:"settings-plan-label",children:"Plan actual"}),s.jsx("div",{className:"settings-plan-name",children:Z||"Sin plan"})]})]}),s.jsxs("div",{className:"settings-content",children:[e==="users"&&s.jsx(cy,{settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,isAdmin:c,adminUsers:u,userForm:m,setUserForm:S,roleOptions:v,handleUserSubmit:x,handleUserDelete:b,defaultRolePermissions:U,handleRoleDelete:G}),e==="general"&&s.jsx(uy,{branches:g,branchForm:p,setBranchForm:j,handleBranchSubmit:k,handleBranchDisable:P,services:f,serviceForm:$,setServiceForm:B,handleServiceSubmit:w,handleServiceDisable:D,handleServiceBranchToggle:R,tenantChannels:ce,channelForm:oe,setChannelForm:Oe,handleChannelSelect:A,handleChannelSubmit:q}),e==="bot"&&s.jsx(dy,{settings:E,setSettings:L,handleSaveSettings:O}),e==="templates"&&s.jsx(py,{templates:X,templateForm:he,setTemplateForm:je,handleTemplateSubmit:Ee,handleTemplateSubmitToMeta:Re,handleTemplateDelete:Te,handleSyncTemplates:Xe,brandName:lt}),e==="audit"&&s.jsx(vy,{auditLogs:W,formatDate:te}),e==="odoo"&&s.jsx(xy,{}),pe?s.jsx(za,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):fe?s.jsx(za,{variant:"error",title:"Ocurri un problema",message:fe,dismissLabel:"Cerrar",onDismiss:nt}):null]})]});return ie?Ut:s.jsx("section",{className:"settings-layout",children:Ut})}function by(){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"1.8"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"1.8"})]})}function Cy({tenantId:e,tenantBots:t,availableFlows:n,loading:r,onAddBot:a,onRemoveBot:i}){const[l,c]=h.useState(""),u=new Set(t.map(v=>v.flow_id)),m=n.filter(v=>!u.has(v.id));function S(){l&&(a(l),c(""))}return s.jsxs("section",{className:"sa-bot-card","data-tenant":e||"",children:[s.jsxs("header",{className:"sa-bot-header",children:[s.jsx("div",{className:"sa-bot-icon-large","aria-hidden":"true",children:s.jsx(by,{})}),s.jsxs("div",{className:"sa-bot-title-group",children:[s.jsx("h3",{children:"Asignacion de Bots"}),s.jsx("p",{children:"Selecciona que flujos estaran disponibles para este cliente. Los flujos asignados apareceran inmediatamente en el panel del usuario."})]})]}),s.jsx("div",{className:"sa-bot-body",children:r?s.jsx("div",{className:"sa-bot-loading",children:"Cargando asignaciones..."}):t.length===0?s.jsxs("div",{className:"sa-bot-empty",children:[s.jsx("div",{className:"sa-bot-empty-icon",children:"+"}),s.jsx("div",{className:"sa-bot-empty-title",children:"Sin bots asignados"}),s.jsx("div",{className:"sa-bot-empty-sub",children:"Agrega un flujo desde el selector para activarlo en este tenant."})]}):s.jsx("div",{className:"sa-bot-grid",children:t.map(v=>s.jsxs("div",{className:"sa-assigned-bot",children:[s.jsx("div",{className:"sa-bot-item-icon",children:v.flow_icon||">"}),s.jsxs("div",{className:"sa-bot-item-info",children:[s.jsx("span",{className:"sa-bot-item-name",children:v.flow_name||v.flow_id}),s.jsx("span",{className:"sa-bot-item-desc",children:v.flow_description||"Sin descripcion"})]}),s.jsx("button",{type:"button",className:"sa-btn-remove",title:"Quitar bot del cliente",onClick:()=>i(v.id),children:"Quitar"})]},v.id))})}),s.jsxs("div",{className:"sa-bot-controls",children:[s.jsxs("div",{className:"sa-select-container",children:[s.jsx("label",{className:"sa-select-label",children:"Asignar bot"}),s.jsxs("select",{className:"sa-select-styled",value:l,onChange:v=>c(v.target.value),disabled:m.length===0,children:[s.jsx("option",{value:"",children:m.length===0?"No hay mas bots disponibles":"Selecciona un bot para asignar"}),m.map(v=>s.jsx("option",{value:v.id,children:v.name},v.id))]})]}),s.jsx("button",{type:"button",className:"sa-btn-assign",onClick:S,disabled:!l,children:"Asignar Bot"})]})]})}const rn={name:"",slug:"",plan:"",db_url:"",phone_number_id:"",line_name:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",brand_name:"",logo_url:"",brand_primary:"#22d3ee",brand_accent:"#38bdf8",brand_bg:"#0b0f16",timezone:"",odoo_base_url:"",odoo_db_name:"",odoo_username:"",odoo_password:""},Ey=[{value:"starter",label:"Starter"},{value:"growth",label:"Growth"},{value:"scale",label:"Scale"},{value:"enterprise",label:"Enterprise"}];function Ay(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"4",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"4",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"})]})}function du(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ty(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"3.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M19 12a7 7 0 0 0-.1-1.2l2-1.5-2-3.5-2.4.7a7.2 7.2 0 0 0-2-1.2L12 2 9.5 4.3a7.2 7.2 0 0 0-2 1.2l-2.4-.7-2 3.5 2 1.5A7 7 0 0 0 5 12c0 .4 0 .8.1 1.2l-2 1.5 2 3.5 2.4-.7a7.2 7.2 0 0 0 2 1.2L12 22l2.5-2.3a7.2 7.2 0 0 0 2-1.2l2.4.7 2-3.5-2-1.5c.1-.4.1-.8.1-1.2Z",strokeWidth:"1.2",strokeLinejoin:"round"})]})}function Ly(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M16.5 16.5 20 20",strokeWidth:"1.6",strokeLinecap:"round"})]})}function Ry(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 12h12",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m13 6 6 6-6 6",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Oy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M18 6 6 18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m6 6 12 12",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Py(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56",strokeWidth:"1.8",strokeLinecap:"round"})})}function Ih(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Dh(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m2 2 20 20",strokeWidth:"1.8",strokeLinecap:"round"})]})}function My(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 18h.01",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Iy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m15 5 4 4",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Dy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M3 6h18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",strokeWidth:"1.8",strokeLinecap:"round"})]})}const Bh={display_name:"",phone_number_id:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",is_active:!0,is_default:!1};function By({isOpen:e,onClose:t,initialData:n,onSave:r,tenantId:a}){const[i,l]=h.useState(Bh),[c,u]=h.useState(!1),[m,S]=h.useState(!1),[v,x]=h.useState(!1),[E,L]=h.useState(null);if(h.useEffect(()=>{e&&(l(n||{...Bh}),L(null))},[e,n]),!e)return null;const O=async g=>{if(g.preventDefault(),x(!0),L(null),!i.phone_number_id||!i.verify_token||!n&&!i.wa_token){L("Los campos ID de Telfono, Verify Token y Access Token son obligatorios."),x(!1);return}try{await r({...i,tenant_id:a}),t()}catch(f){console.error("Error saving channel:",f),L(f.message||"Error al guardar la lnea.")}finally{x(!1)}};return s.jsx("div",{className:"sa-modal-overlay",onClick:t,children:s.jsxs("div",{className:"sa-modal-content",onClick:g=>g.stopPropagation(),children:[s.jsxs("div",{className:"sa-modal-header",children:[s.jsx("div",{className:"sa-modal-title",children:n?"Editar Lnea WhatsApp":"Nueva Lnea WhatsApp"}),s.jsx("button",{className:"sa-modal-close",onClick:t,children:s.jsx(Oy,{width:24,height:24})})]}),s.jsxs("div",{className:"sa-modal-body",children:[E&&s.jsx("div",{className:"sa-alert",style:{marginBottom:"1rem"},children:E}),s.jsxs("div",{className:"sa-form-grid",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre para mostrar (Opcional)"}),s.jsx("input",{value:i.display_name||"",onChange:g=>l({...i,display_name:g.target.value}),placeholder:"Ej: Ventas Principal"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Phone Number ID *"}),s.jsx("input",{value:i.phone_number_id||"",onChange:g=>l({...i,phone_number_id:g.target.value}),placeholder:"Identificador del nmero de telfono"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"WABA ID (WhatsApp Business Account ID)"}),s.jsx("input",{value:i.waba_id||"",onChange:g=>l({...i,waba_id:g.target.value}),placeholder:"Identificador de la cuenta de WhatsApp Business"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Verify Token (Webhook) *"}),s.jsx("input",{value:i.verify_token||"",onChange:g=>l({...i,verify_token:g.target.value}),placeholder:"Token de verificacin webhook"})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"Permanent Access Token *"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:c?"text":"password",value:i.wa_token||"",onChange:g=>l({...i,wa_token:g.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"Token de acceso permanente",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>u(!c),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:c?s.jsx(Dh,{width:18,height:18}):s.jsx(Ih,{width:18,height:18})})]})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"App Secret (Opcional)"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:m?"text":"password",value:i.app_secret||"",onChange:g=>l({...i,app_secret:g.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"App Secret de Meta",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>S(!m),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:m?s.jsx(Dh,{width:18,height:18}):s.jsx(Ih,{width:18,height:18})})]})]})]}),s.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"2rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_active,onChange:g=>l({...i,is_active:g.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Activa"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_default,onChange:g=>l({...i,is_default:g.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Principal (Por Defecto)"]})]})]}),s.jsxs("div",{className:"sa-modal-footer",children:[s.jsx("button",{className:"sa-btn ghost",onClick:t,disabled:v,children:"Cancelar"}),s.jsx("button",{className:"sa-btn primary",onClick:O,disabled:v,children:v?s.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(Py,{width:16,height:16,className:"animate-spin"})," Guardando..."]}):"Guardar Lnea"})]})]})})}function zy({channels:e=[],tenantId:t,onRefresh:n}){const[r,a]=h.useState(!1),[i,l]=h.useState(null),c=()=>{l(null),a(!0)},u=v=>{l(v),a(!0)},m=async v=>{i?await Qe(`/api/superadmin/channels/${i.id}`,v):await we("/api/superadmin/channels",v),await n()},S=async v=>{if(confirm("Ests seguro de que deseas eliminar esta lnea? Esta accin no se puede deshacer."))try{await In(`/api/superadmin/channels/${v}`),await n()}catch(x){console.error("Error deleting channel:",x),alert("No se pudo eliminar la lnea.")}};return s.jsxs("section",{className:"sa-lines-card",children:[s.jsxs("header",{className:"sa-lines-header",children:[s.jsxs("div",{className:"sa-lines-title",children:[s.jsx("div",{className:"sa-lines-icon",children:s.jsx(My,{width:24,height:24})}),s.jsxs("div",{children:[s.jsx("h3",{children:"Lneas de WhatsApp Cloud"}),s.jsx("p",{children:"Gestiona las conexiones activas de WhatsApp para este tenant."})]})]}),s.jsxs("button",{className:"sa-btn primary",onClick:c,children:[s.jsx(du,{width:16,height:16,style:{marginRight:"0.5rem"}}),"Agregar Nueva Lnea"]})]}),s.jsx("div",{className:"sa-lines-body",children:s.jsxs("div",{className:"sa-lines-grid",children:[e.map(v=>s.jsxs("div",{className:`sa-line-card ${v.is_active?"":"opacity-75"}`,children:[s.jsxs("div",{className:"sa-line-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-line-name",children:v.display_name||"Sin nombre"}),s.jsxs("div",{className:"sa-line-meta",children:["ID: ",v.phone_number_id]})]}),s.jsx("div",{className:`sa-line-status ${v.is_active?"active":""}`,title:v.is_active?"Activo":"Inactivo"})]}),s.jsxs("div",{className:"sa-line-badges",children:[v.is_default&&s.jsx("span",{className:"sa-line-badge default",children:"DEFAULT"}),!v.is_active&&s.jsx("span",{className:"sa-status warn",children:"INACTIVO"})]}),s.jsxs("div",{className:"sa-line-details",children:[s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"WABA ID"}),s.jsx("span",{className:"sa-detail-value",children:v.waba_id||"-"})]}),s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"Verify Token"}),s.jsx("span",{className:"sa-detail-value",children:v.verify_token?`${v.verify_token.substring(0,16)}...`:"-"})]})]}),s.jsxs("div",{className:"sa-line-actions",children:[s.jsx("button",{className:"sa-btn ghost",onClick:()=>u(v),title:"Editar",children:s.jsx(Iy,{width:16,height:16})}),s.jsx("button",{className:"sa-btn ghost",onClick:()=>S(v.id),title:"Eliminar",style:{color:"#f87171"},children:s.jsx(Dy,{width:16,height:16})})]})]},v.id)),s.jsxs("button",{type:"button",className:"sa-line-add-card",onClick:c,children:[s.jsx("div",{className:"sa-add-icon-circle",children:s.jsx(du,{width:24,height:24})}),s.jsx("span",{children:"Nueva Conexin"})]})]})}),s.jsx(By,{isOpen:r,onClose:()=>a(!1),initialData:i,onSave:m,tenantId:t})]})}function zh({route:e="/superadmin",onNavigate:t,onImpersonateTenant:n,onLogout:r=()=>{}}){const[a,i]=h.useState([]),[l,c]=h.useState([]),[u,m]=h.useState([]),[S,v]=h.useState(""),[x,E]=h.useState(""),[L,O]=h.useState("Verificacion de red: sistema ok"),[g,f]=h.useState(rn),[p,j]=h.useState(!1),[k,P]=h.useState(!1),[$,B]=h.useState(""),[w,D]=h.useState(""),[R,X]=h.useState(!0),[he,je]=h.useState(rn),[Ee,Re]=h.useState(!0),[Te,Xe]=h.useState(!1),W=h.useRef(""),[te,Z]=h.useState([]),[ce,oe]=h.useState([]),[Oe,A]=h.useState(!1),{pushToast:q}=dd(),b=h.useMemo(()=>{if(!e)return"";const _=e.match(/^\/superadmin\/tenants\/([^/]+)\/?$/)||e.match(/^\/superadmin\/tenant\/([^/]+)\/?$/)||e.match(/^\/superadmin\/edit\/([^/]+)\/?$/);return _?_[1]:""},[e]),U=e.startsWith("/superadmin/new"),G=!!b,ie=U||G,fe=h.useCallback(_=>{if(t){t(_,{replace:!1});return}typeof window>"u"||window.history.pushState({},"",_)},[t]);async function pe(){try{const _=await me("/api/superadmin/tenants");i(_.tenants||[]);const V=await me("/api/superadmin/channels");c(V.channels||[]),E("")}catch(_){E(_.message||"No se pudo cargar datos.")}}h.useEffect(()=>{pe(),Je()},[]),h.useMemo(()=>{const _=new Map;return l.forEach(V=>{const Q=_.get(V.tenant_id)||0;_.set(V.tenant_id,Q+1)}),_},[l]);const nt=h.useMemo(()=>{const _=S.trim().toLowerCase();return _?a.filter(V=>{const Q=String(V.name||"").toLowerCase(),re=String(V.slug||"").toLowerCase(),Se=String(V.id||"").toLowerCase();return Q.includes(_)||re.includes(_)||Se.includes(_)}):a.slice()},[a,S]),lt=a.length,_t=a.filter(_=>_.is_active).length;a.filter(_=>_.has_database).length;const ge=a.filter(_=>_.has_odoo).length,St=lt?Math.round(ge/lt*100):0;function Mt(_){if(!_)return"--";const V=new Date(_);return Number.isNaN(V.getTime())?"--":V.toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"2-digit"})}function Ut(_){return 10+Math.abs(Array.from(_).reduce((re,Se)=>re+Se.charCodeAt(0),0))%70}function qe(){f(rn),je(rn),D(""),X(!0),Re(!0),oe([]),m([]),O("Verificacion de red: sistema ok"),W.current=""}function be(){qe(),E(""),fe("/superadmin/new")}function st(){W.current="",fe("/superadmin")}async function kt(_){if(n)try{E(""),B(_),await n(_)}catch(V){E(V.message||"No se pudo entrar al tenant.")}finally{B("")}}function Xt(_){const V={};return Object.keys(rn).forEach(Q=>{const re=_[Q];V[Q]=typeof re=="string"?re.trim():re||""}),{...rn,...V}}async function ot(_){if(_){W.current=_,D(_),f(rn),je(rn),X(!0),Re(!0),oe([]),m([]),Xe(!0),E("");try{const V=await me(`/api/superadmin/tenants/${_}/details`);if(W.current!==_)return;const Q=V.tenant||{},re=V.branding||null,Se=V.odoo||null,pt=V.database||null,bt=V.channel||null;m(V.channels||[]);const mt=(re==null?void 0:re.colors)||{},qn=Xt({...rn,name:Q.name||"",slug:Q.slug||"",plan:Q.plan||"",db_url:(pt==null?void 0:pt.db_url)||"",brand_name:(re==null?void 0:re.brand_name)||"",logo_url:(re==null?void 0:re.logo_url)||"",brand_primary:(mt==null?void 0:mt.primary)||rn.brand_primary,brand_accent:(mt==null?void 0:mt.accent)||rn.brand_accent,brand_bg:(mt==null?void 0:mt.bg)||rn.brand_bg,odoo_base_url:(Se==null?void 0:Se.base_url)||"",odoo_db_name:(Se==null?void 0:Se.db_name)||"",odoo_username:(Se==null?void 0:Se.username)||"",odoo_password:(Se==null?void 0:Se.password)||""});f(qn),je(qn),D(Q.id||_),X(!!Q.is_active),Re(!!Q.is_active),O("Modo edicion: cambios pendientes"),await ve(_)}catch(V){E(V.message||"No se pudo cargar tenant.")}finally{Xe(!1)}}}async function _n(_){if(_)try{const V=await me(`/api/superadmin/tenants/${_}/details`);if(w&&w!==_)return;m(V.channels||[])}catch(V){console.error("Error loading tenant channels",V)}}async function Je(){try{const _=await me("/api/superadmin/flows");Z(_.flows||[])}catch(_){console.error("Error loading flows",_)}}async function ve(_){if(_){A(!0);try{const V=await me(`/api/superadmin/tenant-bots?tenant_id=${_}`);oe(V.tenant_bots||[])}catch(V){console.error("Error loading tenant bots",V)}finally{A(!1)}}}async function Jt(_,V){try{await Qe(`/api/superadmin/tenant-bots/${_}`,{is_active:V}),oe(Q=>Q.map(re=>re.id===_?{...re,is_active:V}:re))}catch(Q){E(Q.message||"Error al cambiar estado del bot.")}}async function F(_){if(w)try{const V=await we("/api/superadmin/tenant-bots",{tenant_id:w,flow_id:_});V.tenant_bot&&(oe(Q=>[V.tenant_bot,...Q]),q({message:"Bot agregado correctamente"}))}catch(V){E(V.message||"Error al agregar bot."),q({type:"error",message:V.message||"Error al agregar bot"})}}async function _e(_){const V=ce.find(Q=>Q.id===_);try{await In(`/api/superadmin/tenant-bots/${_}`),oe(Q=>Q.filter(re=>re.id!==_)),q({message:"Bot eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{if(!V)return;const Q=await we("/api/superadmin/tenant-bots",{tenant_id:V.tenant_id,flow_id:V.flow_id});Q!=null&&Q.tenant_bot&&V.is_active===!1&&await Qe(`/api/superadmin/tenant-bots/${Q.tenant_bot.id}`,{is_active:!1}),await ve(w),q({message:"Bot restaurado"})}catch(Q){q({type:"error",message:(Q==null?void 0:Q.message)||"No se pudo restaurar el bot"})}}})}catch(Q){E(Q.message||"Error al eliminar bot."),q({type:"error",message:Q.message||"Error al eliminar bot"})}}async function xe(_){E(""),fe(`/superadmin/tenants/${_.id}`)}async function T(){await pe(),w&&await _n(w)}function Ce(){const _=g.name.trim(),V=g.slug.trim(),Q=g.db_url.trim();return!_||!V?{ok:!1,message:"Nombre y subdominio son requeridos."}:!w&&!Q?{ok:!1,message:"Tenant DB URL es requerido."}:(g.brand_name.trim()||g.logo_url.trim()||g.brand_primary||g.brand_accent||g.brand_bg)&&!g.brand_name.trim()?{ok:!1,message:"Brand name es requerido."}:(g.odoo_base_url||g.odoo_db_name||g.odoo_username||g.odoo_password)&&(!g.odoo_base_url||!g.odoo_db_name||!g.odoo_username||!w&&!g.odoo_password)?{ok:!1,message:"Odoo incompleto: base_url, db_name, username, password."}:{ok:!0}}function Zt(_){if(!_)return"Verificacion completada";const V=[];if(_.database){const Q=_.database.ok?"DB ok":"DB error",re=typeof _.database.latency_ms=="number"?` (${_.database.latency_ms}ms)`:"";V.push(`${Q}${re}`)}if(_.odoo){const Q=_.odoo.ok?"Odoo ok":"Odoo error",re=typeof _.odoo.latency_ms=="number"?` (${_.odoo.latency_ms}ms)`:"";V.push(`${Q}${re}`)}return V.length?`Verificacion completada: ${V.join(" | ")}`:"Verificacion completada"}function Sn(_){if(_!=null&&_.database&&!_.database.ok){const V=_.database.details||_.database.error;return Vn(V||"Error en DB")}if(_!=null&&_.odoo&&!_.odoo.ok){const V=_.odoo.details||_.odoo.error;return Vn(V||"Error en Odoo")}return"No se pudo validar conexion"}function Vn(_){const V=(_||"").toString(),Q=V.toLowerCase();return Q.includes("missing")?"Completa los campos de Odoo":Q.includes("db_connection_failed")?"No se pudo conectar a la base de datos":Q.includes("odoo")&&Q.includes("failed")?"No se pudo autenticar en Odoo":V||"No se pudo validar conexion"}async function Fn(){const _=Ce();if(!_.ok){O(_.message);return}j(!0),O("Verificando conexion...");try{const V=await we("/api/superadmin/tenants/validate",{db_url:g.db_url.trim(),odoo_base_url:g.odoo_base_url.trim(),odoo_db_name:g.odoo_db_name.trim(),odoo_username:g.odoo_username.trim(),odoo_password:g.odoo_password.trim()}),Q=Zt(V.checks);O(Q),V.ok?q({message:Q}):q({type:"error",message:Sn(V.checks)})}catch(V){O("Error validando conexion"),q({type:"error",message:V.message||"No se pudo validar conexion"})}finally{j(!1)}}async function Wn(_){var Q;if(_.preventDefault(),G&&!en)return;const V=Ce();if(!V.ok){E(V.message);return}try{P(!0),E("");let re=w;if(re?await Qe(`/api/superadmin/tenants/${re}`,{name:g.name.trim(),slug:g.slug.trim(),plan:g.plan.trim(),is_active:R}):re=(Q=(await we("/api/superadmin/tenants",{name:g.name.trim(),slug:g.slug.trim(),plan:g.plan.trim()})).tenant)==null?void 0:Q.id,!re)throw new Error("tenant_not_ready");if(g.db_url.trim()&&await we(`/api/superadmin/tenants/${re}/database`,{db_url:g.db_url.trim()}),(g.brand_name.trim()||g.logo_url.trim())&&await Qe("/api/superadmin/branding",{tenant_id:re,brand_name:g.brand_name.trim(),logo_url:g.logo_url.trim()||null,colors:null}),g.odoo_base_url||g.odoo_db_name||g.odoo_username||g.odoo_password){const bt={tenant_id:re,base_url:g.odoo_base_url.trim(),db_name:g.odoo_db_name.trim(),username:g.odoo_username.trim()};g.odoo_password.trim()&&(bt.password=g.odoo_password.trim()),await Qe("/api/superadmin/odoo",bt)}if(await pe(),w){const bt=Xt(g);f(bt),je(bt),Re(R),O("Cambios guardados"),q({message:"Tenant actualizado correctamente"})}else qe(),q({message:"Tenant creado correctamente"})}catch(re){E(re.message||"No se pudo guardar tenant."),q({type:"error",message:re.message||"No se pudo guardar tenant"})}finally{P(!1)}}async function Hn(){if(!w)return;const _=!R;try{P(!0),E(""),await Qe(`/api/superadmin/tenants/${w}`,{is_active:_}),X(_),Re(_),O(_?"Tenant reactivado":"Tenant bloqueado"),await pe()}catch(V){E(V.message||"No se pudo cambiar estado del tenant.")}finally{P(!1)}}const en=h.useMemo(()=>!w&&!G||R!==Ee?!0:Object.keys(he).some(_=>{const V=String(g[_]??""),Q=String(he[_]??"");return V!==Q}),[Ee,he,R,w,G,g]);return h.useEffect(()=>{if(G&&b&&b!==w){ot(b);return}U&&(w||Te)&&qe()},[Te,w,U,G,b]),s.jsxs("div",{className:"sa-shell",children:[s.jsxs("aside",{className:"sa-rail",children:[s.jsx("div",{className:"sa-rail-logo",children:"PRZV"}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${ie?"":"active"}`,onClick:st,children:[s.jsx(Ay,{className:"sa-rail-icon"}),s.jsx("span",{children:"Dashboard"})]}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${U?"active":""}`,onClick:be,children:[s.jsx(du,{className:"sa-rail-icon"}),s.jsx("span",{children:"Nuevo"})]}),s.jsxs("button",{type:"button",className:"sa-rail-btn",children:[s.jsx(Ty,{className:"sa-rail-icon"}),s.jsx("span",{children:"Ajustes"})]}),s.jsxs("div",{className:"sa-rail-footer",children:[s.jsx("div",{className:"sa-avatar",children:"SA"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-role",children:"Superadmin"}),s.jsx("div",{className:"sa-meta",children:"Control plane"})]})]})]}),s.jsxs("main",{className:"sa-main",children:[!ie&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-topbar",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-kicker",children:"Panel de control Perzivalh"}),s.jsxs("div",{className:"sa-title",children:["Sistema operativo ",s.jsx("span",{className:"sa-dot"})]}),s.jsx("div",{className:"sa-subtitle",children:"Estado general del entorno"})]}),s.jsxs("div",{className:"sa-top-actions",children:[s.jsx("span",{className:"sa-version",children:"v0.4 stable"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:pe,children:"Recargar"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"}),s.jsx("button",{className:"sa-btn primary",type:"button",onClick:be,children:"Nuevo tenant"})]})]}),s.jsxs("section",{className:"sa-kpi-grid",children:[s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Total de empresas (tenants)"}),s.jsx("div",{className:"sa-kpi-value",children:lt}),s.jsxs("div",{className:"sa-kpi-meta",children:["+",_t," activas"]})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Usuarios activos totales"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"En tiempo real"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Mensajes hoy"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"Canal API"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Conexiones Odoo activas"}),s.jsxs("div",{className:"sa-kpi-value",children:[St,"%"]}),s.jsxs("div",{className:"sa-kpi-meta",children:[ge," sincronizadas"]})]})]}),s.jsxs("section",{className:"sa-table-card",children:[s.jsxs("div",{className:"sa-table-header",children:[s.jsxs("div",{className:"sa-search",children:[s.jsx(Ly,{className:"sa-search-icon"}),s.jsx("input",{value:S,onChange:_=>v(_.target.value),placeholder:"Filtrar empresas..."})]}),s.jsxs("div",{className:"sa-table-actions",children:[s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Ordenar por salud"}),s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Exportar CSV"})]})]}),s.jsxs("div",{className:"sa-table",children:[s.jsxs("div",{className:"sa-table-head",children:[s.jsx("div",{children:"ID referencia"}),s.jsx("div",{children:"Nombre de la empresa"}),s.jsx("div",{children:"Estado"}),s.jsx("div",{children:"Uso de recursos"}),s.jsx("div",{children:"Tiempo de actividad"}),s.jsx("div",{children:"Acciones"})]}),nt.length?nt.map(_=>{var Se;const V=Ut(_.id||"tenant"),Q=_.has_database?"db":"no-db",re=_.has_database;return s.jsxs("div",{className:"sa-table-row",children:[s.jsx("div",{className:"sa-ref",children:((Se=_.slug)==null?void 0:Se.toUpperCase())||"TENANT"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-tenant-name",children:_.name}),s.jsx("div",{className:"sa-tenant-meta",children:_.id.slice(0,8)})]}),s.jsx("div",{className:`sa-status ${_.is_active?"ok":"warn"}`,children:_.is_active?"activo":"inactivo"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-progress",children:s.jsx("span",{className:`sa-progress-fill ${Q}`,style:{width:`${V}%`}})}),s.jsxs("div",{className:"sa-tenant-meta",children:[V,"% carga"]})]}),s.jsx("div",{className:"sa-tenant-meta",children:Mt(_.created_at)}),s.jsx("div",{children:s.jsxs("div",{className:"sa-action-group",children:[s.jsx("button",{className:"sa-action",type:"button",onClick:()=>kt(_.id),disabled:!re||$===_.id,children:re?$===_.id?"Entrando...":"Entrar":"Sin DB"}),s.jsx("button",{className:"sa-link",type:"button",onClick:()=>xe(_),children:s.jsx(Ry,{className:"sa-link-icon"})})]})})]},_.id)}):s.jsx("div",{className:"sa-empty",children:"Sin tenants para mostrar."})]}),s.jsxs("div",{className:"sa-footer-note",children:["Mostrando ",nt.length||0," empresas en produccion"]})]})]}),ie&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-create-header",children:[s.jsx("button",{className:"sa-back",type:"button",onClick:st,children:"Volver al dashboard"}),s.jsx("div",{className:"sa-create-title",children:G?"Editar tenant":"Registrar nuevo tenant"}),s.jsxs("div",{className:"sa-create-actions",children:[s.jsx("div",{className:"sa-create-meta",children:"Modo: superadmin"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"})]})]}),x?s.jsx("div",{className:"sa-alert",children:x}):null,s.jsxs("form",{className:"sa-form",onSubmit:Wn,children:[s.jsxs("div",{className:"sa-form-grid sa-form-grid-2",children:[s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Identidad del tenant"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre de la empresa"}),s.jsx("input",{value:g.name,onChange:_=>f({...g,name:_.target.value}),placeholder:"Ej. Empresa Alfa"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Subdominio reservado"}),s.jsx("input",{value:g.slug,onChange:_=>f({...g,slug:_.target.value}),placeholder:"alfa-salud"})]}),s.jsxs("div",{className:"sa-field sa-field-row",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Plan"}),s.jsxs("select",{value:g.plan,onChange:_=>f({...g,plan:_.target.value}),children:[s.jsx("option",{value:"",children:"Seleccionar"}),Ey.map(_=>s.jsx("option",{value:_.value,children:_.label},_.value))]})]}),G&&s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Estado del tenant"}),s.jsxs("select",{value:R?"active":"inactive",onChange:_=>X(_.target.value==="active"),children:[s.jsx("option",{value:"active",children:"Activo"}),s.jsx("option",{value:"inactive",children:"Bloqueado"})]})]})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Brand name"}),s.jsx("input",{value:g.brand_name,onChange:_=>f({...g,brand_name:_.target.value}),placeholder:"Perzivalh"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Logo URL"}),s.jsx("input",{value:g.logo_url,onChange:_=>f({...g,logo_url:_.target.value}),placeholder:"https://"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Paleta de colores"}),s.jsx("div",{className:"sa-note",children:"Personalizacin deshabilitada por ahora."})]}),!G&&s.jsx("div",{className:"sa-note",children:"Nota: al registrar un tenant se inicia el aprovisionamiento en el entorno de produccion."})]}),s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Variables de entorno (envs)"}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Base de datos"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Tenant DB URL"}),s.jsx("input",{value:g.db_url,onChange:_=>f({...g,db_url:_.target.value}),placeholder:"postgresql://..."})]})]}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Odoo (opcional)"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Base URL"}),s.jsx("input",{value:g.odoo_base_url,onChange:_=>f({...g,odoo_base_url:_.target.value}),placeholder:"https://odoo-instancia"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo DB Name"}),s.jsx("input",{value:g.odoo_db_name,onChange:_=>f({...g,odoo_db_name:_.target.value}),placeholder:"db_tenant_prod"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo User"}),s.jsx("input",{value:g.odoo_username,onChange:_=>f({...g,odoo_username:_.target.value}),placeholder:"usuario@empresa.com"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Password (opcional)"}),s.jsx("input",{type:"password",value:g.odoo_password,onChange:_=>f({...g,odoo_password:_.target.value}),placeholder:"********"})]})]})]})]}),s.jsxs("div",{className:"sa-form-actions",children:[s.jsx("div",{className:"sa-status-note",children:G?Te?"Cargando datos...":en?"Cambios pendientes":"Sin cambios":L}),s.jsx("div",{className:"sa-form-buttons",children:G?s.jsxs(s.Fragment,{children:[en&&s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:k,children:k?"Guardando...":"Guardar cambios"}),s.jsx("button",{className:"sa-btn danger",type:"button",onClick:Hn,disabled:k||!w,children:R?"Bloquear tenant":"Reactivar tenant"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:Fn,disabled:p||k,children:p?"Validando...":"Validar conexion"}),s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:k,children:k?"Guardando...":"Desplegar instancia"})]})})]})]}),w?s.jsx(zy,{channels:u.length?u:l.filter(_=>_.tenant_id===w),tenantId:w,onRefresh:T}):s.jsx("div",{style:{marginTop:"2rem",padding:"1rem",border:"1px dashed rgba(255,255,255,0.2)",borderRadius:"12px",color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",textAlign:"center"},children:"Crea el tenant primero para configurar las lneas de WhatsApp."}),w&&s.jsx(Cy,{tenantId:w,tenantBots:ce,availableFlows:te,loading:Oe,onToggleBot:Jt,onAddBot:F,onRemoveBot:_e})]})]})]})}const $h=["open","pending","assigned"],Uh=["admin","recepcion","caja","marketing","doctor"],as={admin:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!0},campaigns:{read:!0,write:!0},settings:{read:!0,write:!0}},settings:{general:{read:!0,write:!0},users:{read:!0,write:!0},bot:{read:!0,write:!0},templates:{read:!0,write:!0},audit:{read:!0,write:!0},odoo:{read:!0,write:!0}}},recepcion:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},caja:{modules:{chat:{read:!0,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},marketing:{modules:{chat:{read:!1,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!0,write:!0},settings:{read:!0,write:!1}},settings:{general:{read:!0,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!0,write:!0},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},doctor:{modules:{chat:{read:!0,write:!1},dashboard:{read:!1,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}}};function cc(e){if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleString()}function $y(e){if(!e)return"-";const t=new Date(e);if(Number.isNaN(t.getTime()))return"-";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):i===1?"Ayer":["Dom","Lun","Mar","Mie","Jue","Vie","Sab"][t.getDay()]}function Vh(e){if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?"Hoy":i===1?"Ayer":`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}function ne(e){if(!e)return"Error inesperado";if(typeof e=="string")return e==="offline"?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":e==="network_error"?"No se pudo conectar con el servidor. Intenta de nuevo.":e==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":e;const t=e.message||"Error inesperado";return t==="offline"||t.toLowerCase().includes("failed to fetch")?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":t==="network_error"||t.toLowerCase().includes("networkerror")?"No se pudo conectar con el servidor. Intenta de nuevo.":t==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":t}function Uy(e,t){return e?t.includes(e.role):!1}function uc(e){if(!e||typeof e!="object")return{...as};const t={...as};return Object.entries(e).forEach(([n,r])=>{var a,i;!r||typeof r!="object"||(t[n]={modules:{...(a=as[n])==null?void 0:a.modules,...r.modules},settings:{...(i=as[n])==null?void 0:i.settings,...r.settings}})}),t}function Tt(e,t,n,r="read"){var i;const a=(i=e==null?void 0:e[t])==null?void 0:i[n];return a?!!a[r]:!1}function dc(e){const t=n=>n.status==="pending"&&!n.assigned_user_id?0:n.status==="pending"&&n.assigned_user_id?1:n.status==="assigned"?2:3;return[...e].sort((n,r)=>{const a=t(n),i=t(r);if(a!==i)return a-i;const l=new Date(n.last_message_at||n.created_at||0).getTime();return new Date(r.last_message_at||r.created_at||0).getTime()-l})}function Vy(e){const t=new URLSearchParams;Object.entries(e||{}).forEach(([r,a])=>{a==null||a===""||t.append(r,a)});const n=t.toString();return n?`?${n}`:""}function Fh(e){if(!e)return"?";const t=e.trim();return t?t[0].toUpperCase():"?"}function Wh(e){if(typeof document>"u")return;const t=document.documentElement.style;t.removeProperty("--accent"),t.removeProperty("--accent-strong"),t.removeProperty("--accent-soft"),t.removeProperty("--accent-soft-2"),t.removeProperty("--scroll-thumb"),t.removeProperty("--scroll-thumb-hover")}function Fy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M4.5 5.5h15v10H8l-3.5 3.5V5.5Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 9h8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 12.5h5",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Wy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"})]})}function Hy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 9a6 6 0 1 1 12 0c0 4.2 2 5.5 2 5.5H4S6 13.2 6 9Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M9.5 19a2.5 2.5 0 0 0 5 0",strokeWidth:"1.8"})]})}function qy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"2",strokeLinecap:"round"})]})}function Gy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"4",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 3v2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M12 18.5V21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M3 12h2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M18.5 12H21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 5.2l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 17l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 18.8 7 17",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 7l1.8-1.8",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Qy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M20 14.2A8.5 8.5 0 1 1 9.8 4 6.5 6.5 0 0 0 20 14.2Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function Ky(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.8"}),s.jsx("path",{d:"M16.5 16.5 21 21",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Yy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Xy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3.5",y:"6",width:"11",height:"12",rx:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"m14.5 10 6-3v10l-6-3",strokeWidth:"1.8"})]})}function Jy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M6.5 4.5 9 3l2.5 4-2.5 1.5c1.2 2.3 3.2 4.3 5.5 5.5L16 11l4 2.5-1.5 2.5c-.7 1.2-2.2 1.7-3.6 1.3a15.9 15.9 0 0 1-7.7-7.7c-.4-1.4.1-2.9 1.3-3.6Z",strokeWidth:"1.6",strokeLinejoin:"round"})})}function Zy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"9",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 10v6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"7.5",r:"1",fill:"currentColor"})]})}function ej(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"m4 12 15-7-6 14-2.5-5.2L4 12Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function tj(){const[e,t]=h.useState(localStorage.getItem("token")||""),[n,r]=h.useState(()=>typeof window<"u"&&localStorage.getItem("superadmin_token")||""),[a,i]=h.useState(null),[l,c]=h.useState(null),[u,m]=h.useState(null),[S,v]=h.useState([]),[x,E]=h.useState({id:"",display_name:""}),[L,O]=h.useState(()=>{if(typeof window>"u")return{};try{return JSON.parse(localStorage.getItem("last_read_map")||"{}")}catch{return{}}}),[g,f]=h.useState({email:"",password:""}),[p,j]=h.useState(""),[k,P]=h.useState("chats"),[$,B]=h.useState(()=>typeof window<"u"?window.location.pathname:"/"),[w,D]=h.useState(()=>localStorage.getItem("theme")||"light"),[R,X]=h.useState(()=>typeof window<"u"&&window.navigator?!window.navigator.onLine:!1),[he,je]=h.useState(!1),[Ee,Re]=h.useState(!1),[Te,Xe]=h.useState(!1),[W,te]=h.useState(!0),[Z,ce]=h.useState(!1),[oe,Oe]=h.useState(""),A=h.useRef(null),q=h.useRef(null),b=h.useRef(null),U=h.useRef({conversationId:null,lastId:null,length:0}),G=h.useRef(0),ie=h.useRef(!1),fe=h.useRef(0),[pe,nt]=h.useState("users"),[lt,_t]=h.useState("list"),[ge,St]=h.useState(()=>uc(null)),[Mt,Ut]=h.useState(!1),[qe,be]=h.useState(!1),[st,kt]=h.useState(!1),Xt=h.useMemo(()=>{const d=Object.keys(ge||{}).filter(N=>!Uh.includes(N));return[...Uh,...d]},[ge]),[ot,_n]=h.useState({status:"",assigned_user_id:"",tag:"",search:"",phone_number_id:""}),Je=$.startsWith("/superadmin"),[ve,Jt]=h.useState([]),[F,_e]=h.useState(null),[xe,T]=h.useState([]),[Ce,Zt]=h.useState(""),[Sn,Vn]=h.useState("text"),[Fn,Wn]=h.useState([]),[Hn,en]=h.useState([]),[_,V]=h.useState(""),[Q,re]=h.useState(""),[Se,pt]=h.useState(""),[bt,mt]=h.useState(!1),[qn,Vt]=h.useState({name:"",color:"#6b7280"}),[na,sa]=h.useState(!1),[ps,ee]=h.useState(""),{pushToast:se}=dd(),fn=h.useRef(new Map),Gn=h.useRef(new Map),Hs=h.useRef(new Map),ms=h.useRef(new Map),ra=h.useRef(new Map),[qs,ci]=h.useState(null),[gs,Qn]=h.useState([]),[ui,vs]=h.useState([]),[ao,Be]=h.useState(0),[di,xr]=h.useState([]),[hi,kn]=h.useState(""),[fi,Gs]=h.useState(null),[Qs,pi]=h.useState([]),[aa,mi]=h.useState(null),[Ft,bn]=h.useState({name:"",template_id:"",scheduled_for:"",send_now:!0}),[Ct,Kn]=h.useState({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),[Yn,xs]=h.useState([]),[rt,Ks]=h.useState({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),[Ys,gt]=h.useState(null),[Xs,ys]=h.useState([]),[tn,io]=h.useState([]),[ct,yr]=h.useState({id:"",code:"",name:"",address:"",lat:"",lng:"",hours_text:"",phone:"",is_active:!0}),[Ge,Wt]=h.useState({id:"",code:"",name:"",subtitle:"",description:"",price_bob:"",duration_min:"",image_url:"",is_featured:!1,is_active:!0}),[js,gi]=h.useState({id:"",name:"",language:"es",category:"",body_preview:"",is_active:!0}),[ke,Js]=h.useState([]),Xn=((l==null?void 0:l.brand_name)||(u==null?void 0:u.name)||"Perzivalh").trim(),[jr,vt]=h.useState(!1),[ia,la]=h.useState(!1),[Ns,ws]=h.useState(null),lo=48,oo=80,vi=60,Nr=320,oa=120,co=5,xi=2*60*1e3,ca=h.useRef(new Map);function uo(){const d=ca.current;for(;d.size>co;){const N=d.keys().next().value;d.delete(N)}}function Zs(d){const N=ca.current,C=N.get(d);return C?Date.now()-C.updatedAt>xi?(N.delete(d),null):C:null}function yi(d,N){const C=ca.current;C.delete(d),C.set(d,{...N,updatedAt:Date.now()}),uo()}const pn=h.useCallback((d,N={})=>{if(typeof window>"u")return;const C=d||"/";if(window.location.pathname===C){B(C);return}N.replace?window.history.replaceState({},"",C):window.history.pushState({},"",C),B(C)},[]),ho=h.useMemo(()=>gs.find(d=>d.id===Ft.template_id),[gs,Ft.template_id]),fo=h.useMemo(()=>{const d=[...xe].reverse().find(N=>N.type==="note");return(d==null?void 0:d.text)||""},[xe]),ua=h.useMemo(()=>xe.filter(d=>d.type==="note"),[xe]);h.useEffect(()=>{if(typeof window>"u")return;const d=()=>{B(window.location.pathname||"/")};return window.addEventListener("popstate",d),()=>window.removeEventListener("popstate",d)},[]),h.useEffect(()=>{br(e||null)},[e]),h.useEffect(()=>{document.body.dataset.theme=w,localStorage.setItem("theme",w)},[w]),h.useEffect(()=>{if(typeof window>"u")return;const d=()=>{X(!window.navigator.onLine)};return d(),window.addEventListener("online",d),window.addEventListener("offline",d),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",d)}},[]),h.useEffect(()=>{ce(!1),te(!0),requestAnimationFrame(()=>{En()}),F&&Jn(F)},[F==null?void 0:F.id]),h.useEffect(()=>{k==="chats"&&(ce(!1),te(!0),requestAnimationFrame(()=>{En()}))},[k,F==null?void 0:F.id]),h.useEffect(()=>{var Le;if(!F){Oe("");return}const d=xe[xe.length-1],N=(d==null?void 0:d.id)||(d==null?void 0:d.created_at)||(xe.length?`${xe.length}`:null),C=U.current,ae=C.conversationId===F.id&&d&&C.lastId&&N!==C.lastId;if(ie.current&&xe.length>0){ie.current=!1,requestAnimationFrame(()=>{En()});return}if(ae?W?En():ce(!0):W&&ce(!1),U.current={conversationId:F.id,lastId:N,length:xe.length},nr(),W&&xe.length>Nr){const J=xe.slice(-Nr);T(J),ws(((Le=J[0])==null?void 0:Le.created_at)||null),vt(!0)}},[xe,F==null?void 0:F.id,W]),h.useEffect(()=>{var N;if(!(F!=null&&F.id)||!xe.length)return;const d={messages:xe.slice(-oa),cursor:Ns||((N=xe[0])==null?void 0:N.created_at)||null,hasMore:jr};yi(F.id,d)},[xe,Ns,jr,F==null?void 0:F.id]),h.useEffect(()=>{k!=="chats"&&te(!1)},[k]),h.useEffect(()=>{if(!e)return;let d=!0;return me("/api/me").then(N=>{d&&i(N.user)}).catch(()=>{d&&(t(""),i(null))}),()=>{d=!1}},[e]),h.useEffect(()=>{if(!a||a.role==="superadmin"){c(null),v([]),Wh();return}let d=!0;return me("/api/branding").then(N=>{d&&c(N.branding||null)}).catch(()=>{d&&c(null)}),me("/api/tenant").then(N=>{d&&m(N.tenant||null)}).catch(()=>{d&&m(null)}),me("/api/channels").then(N=>{d&&v(N.channels||[])}).catch(()=>{d&&v([])}),()=>{d=!1}},[a]),h.useEffect(()=>{Wh()},[l]),h.useEffect(()=>{if(a){if(a.role==="superadmin"){Je||pn("/superadmin",{replace:!0});return}Je&&pn("/",{replace:!0})}},[a,Je,pn]),h.useEffect(()=>{a&&a.role!=="superadmin"&&(po(),er())},[a]),h.useEffect(()=>{a&&a.role!=="superadmin"&&ut()},[a]),h.useEffect(()=>{!a||k!=="chats"||a.role!=="superadmin"&&Et()},[a,k,ot]),h.useEffect(()=>{a&&a.role!=="superadmin"&&(k==="dashboard"&&bi(),k==="campaigns"&&(Tn(),wr(1,6)))},[a,k]),h.useEffect(()=>{if(!a||k!=="admin")return;const d=(ge==null?void 0:ge[a.role])||as[a.role],N=Tt(d,"settings","users"),C=Tt(d,"settings","bot"),I=Tt(d,"settings","general"),ae=Tt(d,"settings","templates"),Le=Tt(d,"settings","audit");pe==="users"&&N&&sr(),pe==="bot"&&C&&Co(),pe==="general"&&I&&Ln(),pe==="templates"&&ae&&Tn(),pe==="audit"&&Le&&Ze()},[a,k,pe,ge]),h.useEffect(()=>{if(!a||k!=="admin")return;const d=(ge==null?void 0:ge[a.role])||as[a.role],C=["general","users","bot","templates","audit","odoo"].filter(I=>Tt(d,"settings",I));if(!C.length){P(result.user.role==="superadmin"?"superadmin":"chats");return}C.includes(pe)||nt(C[0])},[a,k,pe,ge]),h.useEffect(()=>{if(!e||(a==null?void 0:a.role)==="superadmin")return;const d=Xx(e),N={current:null},C=["/sounds/new-notification-09-352705.wav","/sounds/new-notification-09-352705.mp3"],I=()=>{if(N.current)return N.current;const J=new Audio(C[0]);J.volume=1;let le=0;return J.addEventListener("error",()=>{le+=1,le<C.length&&(J.src=C[le],J.load())}),N.current=J,J},ae=()=>{const J=I();J.play().then(()=>{J.pause(),J.currentTime=0}).catch(()=>{})};window.addEventListener("click",ae,{once:!0}),window.addEventListener("touchstart",ae,{once:!0});const Le=()=>{if(!(typeof window>"u"))try{const J=I();J.currentTime=0,J.play().catch(()=>{})}catch{}};return d.on("conversation:update",({conversation:J})=>{const le=ra.current.get(J.id);ra.current.set(J.id,J.status),J.status==="pending"&&!J.assigned_user_id&&le!=="pending"&&(Le(),se({message:"Nueva conversacin pendiente"})),Jt(ze=>{const Pe=ze.map(xt=>xt.id===J.id?{...xt,...J}:xt);return Pe.find(xt=>xt.id===J.id)||Pe.push(J),dc(Pe)}),_e(ze=>(ze==null?void 0:ze.id)===J.id?{...ze,...J}:ze)}),d.on("message:new",({conversation:J,message:le})=>{J.status==="pending"&&!J.assigned_user_id&&Le();const ze={...J,last_message_text:(le==null?void 0:le.text)||null,last_message_type:(le==null?void 0:le.type)||null,last_message_direction:(le==null?void 0:le.direction)||null,last_message_at:(le==null?void 0:le.created_at)||J.last_message_at};Jt(Pe=>{const xt=Pe.map(Sr=>Sr.id===J.id?{...Sr,...ze}:Sr);return xt.find(Sr=>Sr.id===J.id)||xt.push(ze),dc(xt)}),_e(Pe=>(Pe==null?void 0:Pe.id)===J.id?{...Pe,...ze}:Pe),T(Pe=>!F||F.id!==J.id?Pe:(Jn(ze),[...Pe,le]))}),()=>{d.disconnect()}},[e,F]),h.useEffect(()=>{if(!a)return;if(a.role==="superadmin"){k!=="superadmin"&&P("superadmin");return}const d=(ge==null?void 0:ge[a.role])||as[a.role],N=Tt(d,"modules","chat"),C=Tt(d,"modules","dashboard"),I=Tt(d,"modules","campaigns"),ae=Tt(d,"modules","settings");k==="chats"&&!N&&P(C?"dashboard":I?"campaigns":"admin"),k==="dashboard"&&!C&&P(N?"chats":I?"campaigns":"admin"),k==="campaigns"&&!I&&P(N?"chats":C?"dashboard":"admin"),k==="admin"&&!ae&&P(N?"chats":C?"dashboard":"campaigns")},[a,k,ge]),h.useEffect(()=>{if(!a||a.role!=="admin"||!Mt||!qe||st)return;const d=setTimeout(()=>{const N=fe.current;kt(!0),Qe("/api/admin/role-permissions",{permissions:ge}).then(()=>{fe.current===N&&be(!1)}).catch(C=>{ee(ne(C))}).finally(()=>{kt(!1)})},350);return()=>clearTimeout(d)},[a,ge,qe,Mt,st]);async function po(){try{const d=await me("/api/users");en(d.users||[])}catch(d){ee(ne(d))}}async function ut(){try{const d=await me("/api/role-permissions"),N=uc(d.permissions||null);fe.current=0,St(N),be(!1),Ut(!0)}catch(d){ee(ne(d)),Ut(!0)}}async function er(){try{const d=await me("/api/tags");Wn(d.tags||[])}catch(d){ee(ne(d))}}async function Et(){try{const d=Vy(ot),N=await me(`/api/conversations${d}`);Jt(dc(N.conversations||[]))}catch(d){ee(ne(d))}}async function ji(d){var ae,Le;ie.current=!0;const N=Zs(d),C=ve.find(J=>J.id===d);sa(!N),es(),C&&_e(C),N&&(T(N.messages||[]),ws(N.cursor||null),vt(!!N.hasMore),nr(),requestAnimationFrame(()=>{En()}));const I=G.current+1;G.current=I;try{const J=`?limit=${oo}&window_hours=${lo}`,le=await me(`/api/conversations/${d}${J}`);if(G.current!==I)return;let ze=le.conversation;const Pe=le.messages||[];if((ze==null?void 0:ze.status)==="pending"&&!ze.assigned_user_id&&(a!=null&&a.id))try{ze=(await Qe(`/api/conversations/${d}/assign`,{})).conversation}catch(xt){String(ne(xt)).includes("already_assigned")&&se({type:"error",message:"Conversacin tomada por otro operador"})}_e(ze),T(Pe),vt(!!le.has_more),ws(le.next_cursor||((ae=Pe[0])==null?void 0:ae.created_at)||null),yi(d,{messages:Pe.slice(-oa),cursor:le.next_cursor||((Le=Pe[0])==null?void 0:Le.created_at)||null,hasMore:!!le.has_more}),Jn(ze)}catch(J){ee(ne(J))}finally{G.current===I&&sa(!1)}}async function Ni(d){var Le;if(!jr||ia)return;const N=Ns;if(!N){vt(!1);return}la(!0);const C=q.current,I=C?C.scrollHeight:0,ae=C?C.scrollTop:0;try{const J=`?limit=${vi}&before=${encodeURIComponent(N)}`,le=await me(`/api/conversations/${d}${J}`);if((F==null?void 0:F.id)!==d)return;const ze=le.messages||[];ze.length?(T(Pe=>{const xt=new Set(Pe.map(Ro=>Ro.id));return[...ze.filter(Ro=>!xt.has(Ro.id)),...Pe]}),ws(le.next_cursor||((Le=ze[0])==null?void 0:Le.created_at)||N),vt(!!le.has_more),requestAnimationFrame(()=>{const Pe=q.current;if(!Pe)return;const xt=Pe.scrollHeight;Pe.scrollTop=xt-I+ae})):vt(!1)}catch(J){ee(ne(J))}finally{la(!1)}}async function wi(d){d.preventDefault(),j("");try{const N=await we("/api/auth/login",{email:g.email,password:g.password});t(N.token),br(N.token),i(N.user),r(""),localStorage.removeItem("superadmin_token");const C=N.user.role==="superadmin";P(C?"superadmin":"chats"),C?pn("/superadmin",{replace:!0}):Je&&pn("/",{replace:!0})}catch{j("Credenciales invalidas")}}function Cn(){t(""),br(null),i(null),Jt([]),_e(null),T([]),P("chats"),Xe(!1),St(uc(null)),Ut(!1),be(!1),kt(!1),fe.current=0,r(""),localStorage.removeItem("superadmin_token"),pn("/",{replace:!0})}async function _i(d){const N=await we(`/api/superadmin/tenants/${d}/impersonate`);!n&&e&&(localStorage.setItem("superadmin_token",e),r(e)),t(N.token),br(N.token),i(N.user),P("chats"),pn("/",{replace:!0})}function da(){const d=n||(typeof window<"u"?localStorage.getItem("superadmin_token"):"");if(!d){Cn();return}localStorage.removeItem("superadmin_token"),r(""),t(d),br(d),i(null),P("chats"),pn("/superadmin",{replace:!0})}function tr(d){St(N=>typeof d=="function"?d(N):d),fe.current+=1,be(!0)}function ha(){D(d=>d==="light"?"dark":"light")}function En(){const d=q.current;d&&(d.scrollTop=d.scrollHeight,te(!0),ce(!1),nr())}function Jn(d){!(d!=null&&d.id)||!(d!=null&&d.last_message_at)||O(N=>{const C={...N,[d.id]:d.last_message_at};return localStorage.setItem("last_read_map",JSON.stringify(C)),C})}function Zn(){const d=q.current;if(!d)return;const C=d.scrollHeight-d.scrollTop-d.clientHeight<24;te(C),C&&ce(!1),d.scrollTop<120&&jr&&!ia&&F&&Ni(F.id),nr()}function es(){T([]),ws(null),vt(!1),la(!1),U.current={conversationId:null,lastId:null,length:0}}function nr(){b.current||(b.current=requestAnimationFrame(()=>{b.current=null,fa()}))}function fa(){const d=q.current;if(!d)return;const N=d.querySelectorAll(".day-pill");if(!N.length){Oe("");return}const C=d.scrollTop,I=12;let ae=N[0];for(const J of N)if(J.offsetTop-I<=C)ae=J;else break;const Le=ae.dataset.dayLabel||ae.textContent||"";Oe(Le)}function An(){_e(null),es()}function mo(d){var N;Zt(d),(N=A.current)==null||N.focus()}async function go(d){if(d.preventDefault(),!F||!Ce.trim())return;const N=Ce.trim();Zt("");try{await we(`/api/conversations/${F.id}/messages`,{text:N,type:Sn})}catch(C){ee(ne(C))}}async function pa(d){if(d.preventDefault(),!F||!Q.trim())return;const N=Q.trim();re("");try{const C=await we(`/api/conversations/${F.id}/messages`,{text:N,type:"note"});C!=null&&C.message&&T(I=>[...I,C.message]),C!=null&&C.conversation&&_e(C.conversation)}catch(C){ee(ne(C))}}async function vo(){if(F)try{const d=await Qe(`/api/conversations/${F.id}/assign`);_e(d.conversation)}catch(d){const N=ne(d)||"No se pudo tomar la conversacion";se({type:"error",message:N})}}async function Si(){if(!(!F||!Se))try{const d=await Qe(`/api/conversations/${F.id}/assign`,{user_id:Se});_e(d.conversation),pt(""),se({message:"Conversacin reasignada"})}catch(d){const N=ne(d)||"No se pudo reasignar";se({type:"error",message:N})}}async function ki(d){var N;if(F)try{let I=(await Qe(`/api/conversations/${F.id}/status`,{status:d})).conversation;if(d==="open"&&((N=I==null?void 0:I.tags)!=null&&N.length)){const ae=I.tags.find(Le=>(Le.name||"").toLowerCase()==="pendiente");if(ae)try{I=(await we(`/api/conversations/${I.id}/tags`,{add:[],remove:[ae.name]})).conversation||I}catch{I={...I,tags:I.tags.filter(J=>J.name!==ae.name)}}}_e(I),Jt(ae=>ae.map(Le=>Le.id===I.id?{...Le,...I}:Le))}catch(C){ee(ne(C))}}async function ma(d){var C;if(!F)return;const N=((C=F.tags)==null?void 0:C.some(I=>I.name===d))||!1;if(N){const I=`${F.id}:${d}`;if(ms.current.has(I))return;const ae=F,Le={...F,tags:(F.tags||[]).filter(le=>le.name!==d)};_e(Le);const J=setTimeout(async()=>{try{const le=await we(`/api/conversations/${ae.id}/tags`,{add:[],remove:[d]});(F==null?void 0:F.id)===ae.id&&_e(le.conversation)}catch(le){(F==null?void 0:F.id)===ae.id&&_e(ae),se({type:"error",message:ne(le)||"No se pudo eliminar el tag"})}finally{ms.current.delete(I)}},8e3);ms.current.set(I,{timer:J,snapshot:ae}),se({message:"Tag eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const le=ms.current.get(I);le!=null&&le.timer&&clearTimeout(le.timer),le!=null&&le.snapshot?_e(le.snapshot):_e(ae),ms.current.delete(I),se({message:"Eliminacin cancelada"})}});return}try{const I=await we(`/api/conversations/${F.id}/tags`,{add:N?[]:[d],remove:N?[d]:[]});_e(I.conversation)}catch(I){ee(ne(I))}}async function xo(d){if(d.preventDefault(),!_.trim()||!F)return;const N=_.trim();V("");try{const C=await we(`/api/conversations/${F.id}/tags`,{add:[N]});_e(C.conversation),await er()}catch(C){ee(ne(C))}}async function yo(d){d.preventDefault();const N=qn.name.trim();if(!N){ee("Completa el nombre de la etiqueta");return}try{await we("/api/tags",{name:N,color:qn.color||null}),Vt({name:"",color:"#6b7280"}),await er(),se({message:"Etiqueta creada"})}catch(C){ee(ne(C))}}async function jo(d,N){if(d)try{await In(`/api/tags/${d}`),_e(C=>C&&{...C,tags:(C.tags||[]).filter(I=>I.name!==N)}),await er(),se({message:"Etiqueta eliminada"})}catch(C){ee(ne(C))}}async function bi(){try{const d=await me("/api/dashboard/metrics");ci(d)}catch(d){ee(ne(d))}}async function Tn(){try{const d=await me("/api/templates").catch(()=>me("/api/admin/templates"));Qn(d.templates||[])}catch(d){ee(ne(d))}}async function wr(d=1,N=6,C=""){try{const I=new URLSearchParams({offset:String((d-1)*N),limit:String(N)});C&&I.set("q",C);const ae=await me(`/api/campaigns?${I.toString()}`);vs(ae.campaigns||[]),Be(Number.isFinite(ae.total)?ae.total:(ae.campaigns||[]).length)}catch(I){ee(ne(I))}}async function No(d){kn(d);try{const N=await me(`/api/admin/campaigns/${d}/messages`);xr(N.messages||[])}catch(N){ee(ne(N))}}async function wo(d){var N;if(d.preventDefault(),!Ft.name.trim()||!Ft.template_id){ee("Completa el nombre y plantilla");return}Ct.status&&Ct.status,Ct.tag&&Ct.tag.trim(),Ct.assigned_user_id&&Ct.assigned_user_id,Ct.verified_only,Ct.segment_id&&(Ct.segment_id,Ct.segment_name&&Ct.segment_name);try{const C=await we("/api/campaigns",{name:Ft.name.trim(),template_id:Ft.template_id,segment_id:Ct.segment_id||null,scheduled_at:Ft.scheduled_for||null});if(Ft.send_now&&!Ft.scheduled_for){const I=(N=C==null?void 0:C.campaign)==null?void 0:N.id;I&&await we(`/api/campaigns/${I}/launch`,{})}bn({name:"",template_id:"",scheduled_for:"",send_now:!0}),Kn({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),await wr(1,6),se({message:"Campaa creada correctamente"})}catch(C){ee(ne(C)),se({type:"error",message:ne(C)||"Error al crear campaa"})}}async function _o(d){try{await we(`/api/campaigns/${d}/launch`,{}),await wr(1,6)}catch(N){ee(ne(N))}}async function So(){try{await me("/api/templates/sync"),await Tn()}catch(d){ee(ne(d))}}async function sr(){try{const d=await me("/api/admin/users");xs(d.users||[])}catch(d){ee(ne(d))}}async function ko(d){if(d.preventDefault(),!rt.name.trim()||!rt.role){ee("Completa los campos requeridos");return}try{rt.id?(await Qe(`/api/admin/users/${rt.id}`,{name:rt.name.trim(),role:rt.role,is_active:rt.is_active,password:rt.password||void 0}),se({message:"Usuario actualizado correctamente"})):(await we("/api/admin/users",{name:rt.name.trim(),email:rt.email.trim().toLowerCase(),role:rt.role,password:rt.password}),se({message:"Usuario creado correctamente"})),Ks({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),await sr()}catch(N){ee(ne(N)),se({type:"error",message:ne(N)||"Error al guardar usuario"})}}async function bo(d){if(!d||fn.current.has(d))return;let N=null;try{N=Yn.slice(),xs(I=>I.filter(ae=>ae.id!==d));const C=setTimeout(async()=>{try{await In(`/api/admin/users/${d}`),await sr(),se({message:"Usuario eliminado definitivamente"})}catch(I){N?xs(N):await sr(),se({type:"error",message:ne(I)||"No se pudo eliminar el usuario"})}finally{fn.current.delete(d)}},8e3);fn.current.set(d,{timer:C,snapshot:N}),se({message:"Usuario eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const I=fn.current.get(d);I!=null&&I.timer&&clearTimeout(I.timer),I!=null&&I.snapshot?xs(I.snapshot):N?xs(N):await sr(),fn.current.delete(d),se({message:"Eliminacin cancelada"})}})}catch(C){ee(ne(C)),se({type:"error",message:ne(C)||"Error al eliminar usuario"})}}async function Co(){try{const d=await me("/api/admin/settings");gt(d.settings)}catch(d){ee(ne(d))}}async function Eo(){if(Ys)try{const d=await Qe("/api/admin/settings",{bot_enabled:Ys.bot_enabled,auto_reply_enabled:Ys.auto_reply_enabled});gt(d.settings)}catch(d){ee(ne(d))}}async function Ln(){try{const[d,N]=await Promise.all([me("/api/admin/branches"),me("/api/admin/services")]);ys(d.branches||[]),io(N.services||[])}catch(d){ee(ne(d))}}async function Ao(){try{const d=await me("/api/channels");v(d.channels||[])}catch{v([])}}function Ci(d){E({id:d.id,display_name:d.display_name||""})}async function Ei(d){if(d.preventDefault(),!!x.id)try{await Qe(`/api/channels/${x.id}`,{display_name:x.display_name.trim()}),E({id:"",display_name:""}),await Ao(),se({message:"Canal actualizado correctamente"})}catch(N){ee(ne(N)),se({type:"error",message:ne(N)||"Error al guardar canal"})}}async function Ai(d){const N=ge==null?void 0:ge[d];if(!(!d||Gn.current.has(d)))try{St(I=>{const ae={...I};return delete ae[d],ae});const C=setTimeout(async()=>{try{await In(`/api/admin/role-permissions/${d}`),se({message:"Rol eliminado definitivamente"})}catch(I){N&&St(ae=>({...ae,[d]:N})),se({type:"error",message:ne(I)||"No se pudo eliminar el rol"})}finally{Gn.current.delete(d)}},8e3);Gn.current.set(d,{timer:C,currentPermissions:N}),se({message:"Rol eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const I=Gn.current.get(d);I!=null&&I.timer&&clearTimeout(I.timer),I!=null&&I.currentPermissions&&St(ae=>({...ae,[d]:I.currentPermissions})),Gn.current.delete(d),se({message:"Eliminacin cancelada"})}})}catch(C){ee(ne(C)),se({type:"error",message:ne(C)||"Error al eliminar rol"})}}async function Ti(d){if(d.preventDefault(),!ct.code.trim()||!ct.name.trim()){ee("Completa codigo y nombre");return}const N={code:ct.code.trim(),name:ct.name.trim(),address:ct.address.trim(),lat:ct.lat!==""?Number(ct.lat):0,lng:ct.lng!==""?Number(ct.lng):0,hours_text:ct.hours_text.trim(),phone:ct.phone.trim()||null,is_active:ct.is_active};try{ct.id?(await Qe(`/api/admin/branches/${ct.id}`,N),se({message:"Sucursal actualizada correctamente"})):(await we("/api/admin/branches",N),se({message:"Sucursal creada correctamente"})),yr({id:"",code:"",name:"",address:"",lat:"",lng:"",hours_text:"",phone:"",is_active:!0}),await Ln()}catch(C){ee(ne(C)),se({type:"error",message:ne(C)||"Error al guardar sucursal"})}}async function Li(d){try{await In(`/api/admin/branches/${d}`),await Ln(),se({message:"Sucursal eliminada correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{await Qe(`/api/admin/branches/${d}`,{is_active:!0}),await Ln(),se({message:"Sucursal restaurada"})}catch(N){se({type:"error",message:ne(N)||"No se pudo restaurar la sucursal"})}}})}catch(N){ee(ne(N)),se({type:"error",message:ne(N)||"Error al eliminar sucursal"})}}async function o(d){if(d.preventDefault(),!Ge.code.trim()||!Ge.name.trim()){ee("Completa codigo y nombre");return}const N={code:Ge.code.trim(),name:Ge.name.trim(),subtitle:Ge.subtitle.trim()||null,description:Ge.description.trim(),price_bob:Ge.price_bob?Number(Ge.price_bob):0,duration_min:Ge.duration_min?Number(Ge.duration_min):null,image_url:Ge.image_url.trim()||null,is_featured:Ge.is_featured,is_active:Ge.is_active};try{Ge.id?(await Qe(`/api/admin/services/${Ge.id}`,N),se({message:"Servicio actualizado correctamente"})):(await we("/api/admin/services",N),se({message:"Servicio creado correctamente"})),Wt({id:"",code:"",name:"",subtitle:"",description:"",price_bob:"",duration_min:"",image_url:"",is_featured:!1,is_active:!0}),await Ln()}catch(C){ee(ne(C)),se({type:"error",message:ne(C)||"Error al guardar servicio"})}}async function y(d){try{await In(`/api/admin/services/${d}`),await Ln(),se({message:"Servicio eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{await Qe(`/api/admin/services/${d}`,{is_active:!0}),await Ln(),se({message:"Servicio restaurado"})}catch(N){se({type:"error",message:ne(N)||"No se pudo restaurar el servicio"})}}})}catch(N){ee(ne(N)),se({type:"error",message:ne(N)||"Error al eliminar servicio"})}}async function M(d,N,C){if(d)try{await we(`/api/admin/services/${d.id}/branches`,{branch_id:N,is_available:C}),await Ln()}catch(I){ee(ne(I))}}async function H(d,N){d!=null&&d.preventDefault&&d.preventDefault();const C=N||js||{},I=typeof C.name=="string"?C.name.trim():"";if(!I)return ee("Completa el nombre"),null;const ae={name:I,category:C.category||"UTILITY",language:C.language||"es",body_text:C.body_text||C.body_preview||"",header_type:C.header_type||null,header_content:C.header_content||null,footer_text:C.footer_text||null,buttons:C.buttons||C.buttons_json||[]},Le=C.variable_mappings||C.variableMappings||[];try{let J=null;return C.id?(J=await zl(`/api/templates/${C.id}`,ae),await zl(`/api/templates/${C.id}/mappings`,{mappings:Le}),se({message:"Borrador actualizado correctamente"})):(J=await we("/api/templates/draft",{...ae,variable_mappings:Le}),se({message:"Borrador creado correctamente"})),await Tn(),(J==null?void 0:J.template)||null}catch(J){return ee(ne(J)),se({type:"error",message:ne(J)||"Error al guardar plantilla"}),null}}async function Y(d){if(d)try{await we(`/api/templates/${d}/submit`,{}),await Tn(),se({message:"Plantilla enviada a revisin de Meta"})}catch(N){ee(ne(N)),se({type:"error",message:ne(N)||"Error al enviar a Meta"})}}async function ue(d){if(d&&!Hs.current.has(d))try{const N=gs.slice();Qn(I=>I.filter(ae=>ae.id!==d));const C=setTimeout(async()=>{try{await In(`/api/templates/${d}`),await Tn(),se({message:"Plantilla eliminada definitivamente"})}catch(I){Qn(N),se({type:"error",message:ne(I)||"No se pudo eliminar la plantilla"})}finally{Hs.current.delete(d)}},8e3);Hs.current.set(d,{timer:C,snapshot:N}),se({message:"Plantilla eliminada. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const I=Hs.current.get(d);I!=null&&I.timer&&clearTimeout(I.timer),I!=null&&I.snapshot?Qn(I.snapshot):Qn(N),Hs.current.delete(d),se({message:"Eliminacin cancelada"})}})}catch(N){ee(ne(N)),se({type:"error",message:ne(N)||"Error al eliminar plantilla"})}}async function Ze(){try{const d=await me("/api/admin/audit?limit=200");Js(d.logs||[])}catch(d){ee(ne(d))}}const At={open:0,pending:0,closed:0};((qs==null?void 0:qs.status_counts)||[]).forEach(d=>{At[d.status]=d._count.status});const nn=Je?"Acceso al control plane":"Acceso a bandeja multiusuario";if(!e||!a)return s.jsx("div",{className:"login-shell",children:s.jsxs("div",{className:"login-card",children:[s.jsx("div",{className:"login-title",children:"Perzivalh"}),s.jsx("div",{className:"login-subtitle",children:nn}),R?s.jsx(za,{variant:"offline",title:"Sin conexin",message:"No tienes internet en este momento. Conctate y vuelve a intentar iniciar sesin.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):null,s.jsxs("form",{className:"login-form",onSubmit:wi,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:g.email,onChange:d=>f(N=>({...N,email:d.target.value})),required:!0})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:g.password,onChange:d=>f(N=>({...N,password:d.target.value})),required:!0})]}),p?s.jsx("div",{className:"error",children:p}):null,s.jsx("button",{className:"primary",type:"submit",children:"Entrar"})]})]})});if((a==null?void 0:a.role)==="superadmin"&&Je)return s.jsx("main",{className:"superadmin-page",children:s.jsx(zh,{route:$,onNavigate:pn,onImpersonateTenant:_i,onLogout:Cn})});const ts=(ge==null?void 0:ge[a.role])||as[a.role],_r=Tt(ts,"modules","chat"),To=Tt(ts,"modules","dashboard"),ns=Tt(ts,"modules","campaigns"),Rn=Tt(ts,"modules","settings"),On=Uy(a,["admin"]),_s=Tt(ts,"modules","chat","write"),sn=[],hd={open:"Bot activo",pending:"Pendiente",assigned:"Tomada"},Nm=F?F.display_name||F.phone_e164||F.wa_id:"Selecciona un chat",wm=(F==null?void 0:F.phone_e164)||(F==null?void 0:F.wa_id)||"",_m=F?hd[F.status]||"Sin estado":"",Sm=[{id:"chats",label:"Chats",icon:Fy,enabled:_r},{id:"dashboard",label:"Dashboard",icon:Wy,enabled:To},{id:"campaigns",label:"Campaas",icon:Hy,enabled:ns},{id:"admin",label:"Configuraciones",icon:qy,enabled:Rn}],Lo=[];let fd="";xe.forEach(d=>{const N=d.created_at,C=N?new Date(N):null,I=C&&!Number.isNaN(C.getTime())?`${C.getFullYear()}-${C.getMonth()}-${C.getDate()}`:"";if(I&&I!==fd){const ae=Vh(N);Lo.push(s.jsx("div",{className:"day-pill","data-day-label":ae,children:ae},`day-${I}`)),fd=I}Lo.push(s.jsxs("div",{className:`message ${d.direction} ${d.type==="note"?"note":""}`,"data-day-key":I,"data-day-label":I?Vh(N):"",children:[s.jsx("div",{className:"message-text",children:d.text||`[${d.type}]`}),s.jsx("div",{className:"message-meta",children:cc(d.created_at)})]},d.id))});const km=!!n&&a.role!=="superadmin";return s.jsxs("div",{className:`app-shell ${k==="admin"?"admin-shell":""}`,children:[s.jsx(ey,{navItems:Sm,view:k,onSetView:P,theme:w,onToggleTheme:ha,user:a,logoUrl:(l==null?void 0:l.logo_url)||"",brandName:Xn,isProfileOpen:Te,onToggleProfile:()=>Xe(d=>!d),onLogout:Cn,onReturnToSuperadmin:da,showReturnToSuperadmin:km,getInitial:Fh,SunIcon:Gy,MoonIcon:Qy}),k==="admin"?s.jsx(ky,{settingsSection:pe,setSettingsSection:nt,settingsTab:lt,setSettingsTab:_t,rolePermissions:ge,setRolePermissions:tr,defaultRolePermissions:as,currentRole:a.role,isAdmin:On,adminUsers:Yn,userForm:rt,setUserForm:Ks,roleOptions:Xt,handleUserSubmit:ko,handleUserDelete:bo,settings:Ys,setSettings:gt,handleSaveSettings:Eo,planName:(u==null?void 0:u.plan)||"",branches:Xs,services:tn,branchForm:ct,setBranchForm:yr,handleBranchSubmit:Ti,handleBranchDisable:Li,serviceForm:Ge,setServiceForm:Wt,handleServiceSubmit:o,handleServiceDisable:y,handleServiceBranchToggle:M,tenantChannels:S,channelForm:x,setChannelForm:E,handleChannelSelect:Ci,handleChannelSubmit:Ei,handleRoleDelete:Ai,templates:gs,templateForm:js,setTemplateForm:gi,handleTemplateSubmit:H,handleTemplateSubmitToMeta:Y,handleTemplateDelete:ue,handleSyncTemplates:So,auditLogs:ke,formatDate:cc,useShellLayout:!0,pageError:ps,isOffline:R,onDismissError:()=>ee(""),brandName:Xn}):k==="superadmin"?s.jsx("main",{className:"content content-page",children:s.jsx(zh,{onImpersonateTenant:_i,onLogout:Cn})}):s.jsxs("main",{className:`content ${k==="chats"?"content-chats":"content-page"}`,children:[k==="chats"&&s.jsx(ty,{activeConversation:F,conversations:ve,channels:S,brandName:Xn,lastReadMap:L,filters:ot,showFilters:he,users:Hn,tags:Fn,statusOptions:$h,statusLabels:hd,formatListTime:$y,messageBlocks:Lo,messageDraft:Ce,messageMode:Sn,quickActions:sn,tagInput:_,noteInput:Q,notesList:ua,latestNote:fo,loadingConversation:na,isInfoOpen:Ee,hasUnread:Z,scrollDayLabel:oe,activeName:Nm,activePhone:wm,activeStatusLabel:_m,canManageStatus:_s,currentUser:a,messageInputRef:A,chatBodyRef:q,setShowFilters:je,setFilters:_n,loadConversation:ji,handleBackToList:An,setIsInfoOpen:Re,handleChatScroll:Zn,handleAssignSelf:vo,handleStatusChange:ki,handleToggleTag:ma,handleAddTag:xo,setNoteInput:re,handleAddNote:pa,reassignUserId:Se,setReassignUserId:pt,handleReassignConversation:Si,handleOpenTagManager:()=>mt(!0),handleCloseTagManager:()=>mt(!1),showTagManager:bt,tagManagerForm:qn,setTagManagerForm:Vt,handleCreateTag:yo,handleDeleteTag:jo,handleQuickAction:mo,handleSendMessage:go,setMessageMode:Vn,setMessageDraft:Zt,scrollChatToBottom:En,getInitial:Fh,PlusIcon:Yy,SearchIcon:Ky,VideoIcon:Xy,PhoneIcon:Jy,InfoIcon:Zy,SendIcon:ej}),k==="dashboard"&&s.jsx(ry,{statusCounts:At,metrics:qs,onRefresh:bi,brandName:Xn}),k==="campaigns"&&s.jsx(ly,{campaignForm:Ft,setCampaignForm:bn,campaignFilter:Ct,setCampaignFilter:Kn,templates:gs,campaigns:ui,selectedCampaignId:hi,campaignMessages:di,users:Hn,tags:Fn,channels:S,selectedTemplate:ho,statusOptions:$h,onCreateCampaign:wo,onLoadCampaigns:wr,onLoadCampaignMessages:No,onSendCampaign:_o,formatDate:cc,brandName:Xn}),R?s.jsx(za,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):ps?s.jsx(za,{variant:"error",title:"Ocurri un problema",message:ps,dismissLabel:"Cerrar",onDismiss:()=>ee("")}):null]})]})}const nj=rm(document.getElementById("root"));nj.render(s.jsx(Jx,{children:s.jsx(tj,{})}));
