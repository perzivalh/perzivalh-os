(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var jh={exports:{}},Sl={},Nh={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Va=Symbol.for("react.element"),bm=Symbol.for("react.portal"),Cm=Symbol.for("react.fragment"),Em=Symbol.for("react.strict_mode"),Am=Symbol.for("react.profiler"),Tm=Symbol.for("react.provider"),Lm=Symbol.for("react.context"),Rm=Symbol.for("react.forward_ref"),Om=Symbol.for("react.suspense"),Pm=Symbol.for("react.memo"),Mm=Symbol.for("react.lazy"),Fu=Symbol.iterator;function Dm(e){return e===null||typeof e!="object"?null:(e=Fu&&e[Fu]||e["@@iterator"],typeof e=="function"?e:null)}var wh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_h=Object.assign,Sh={};function Dr(e,t,n){this.props=e,this.context=t,this.refs=Sh,this.updater=n||wh}Dr.prototype.isReactComponent={};Dr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Dr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function kh(){}kh.prototype=Dr.prototype;function zc(e,t,n){this.props=e,this.context=t,this.refs=Sh,this.updater=n||wh}var $c=zc.prototype=new kh;$c.constructor=zc;_h($c,Dr.prototype);$c.isPureReactComponent=!0;var Wu=Array.isArray,bh=Object.prototype.hasOwnProperty,Uc={current:null},Ch={key:!0,ref:!0,__self:!0,__source:!0};function Eh(e,t,n){var r,a={},i=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)bh.call(t,r)&&!Ch.hasOwnProperty(r)&&(a[r]=t[r]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var u=Array(c),m=0;m<c;m++)u[m]=arguments[m+2];a.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)a[r]===void 0&&(a[r]=c[r]);return{$$typeof:Va,type:e,key:i,ref:l,props:a,_owner:Uc.current}}function Im(e,t){return{$$typeof:Va,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Vc(e){return typeof e=="object"&&e!==null&&e.$$typeof===Va}function Bm(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Hu=/\/+/g;function ao(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Bm(""+e.key):t.toString(36)}function Di(e,t,n,r,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Va:case bm:l=!0}}if(l)return l=e,a=a(l),e=r===""?"."+ao(l,0):r,Wu(a)?(n="",e!=null&&(n=e.replace(Hu,"$&/")+"/"),Di(a,t,n,"",function(m){return m})):a!=null&&(Vc(a)&&(a=Im(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(Hu,"$&/")+"/")+e)),t.push(a)),1;if(l=0,r=r===""?".":r+":",Wu(e))for(var c=0;c<e.length;c++){i=e[c];var u=r+ao(i,c);l+=Di(i,t,n,u,a)}else if(u=Dm(e),typeof u=="function")for(e=u.call(e),c=0;!(i=e.next()).done;)i=i.value,u=r+ao(i,c++),l+=Di(i,t,n,u,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function mi(e,t,n){if(e==null)return e;var r=[],a=0;return Di(e,r,"","",function(i){return t.call(n,i,a++)}),r}function zm(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Tt={current:null},Ii={transition:null},$m={ReactCurrentDispatcher:Tt,ReactCurrentBatchConfig:Ii,ReactCurrentOwner:Uc};function Ah(){throw Error("act(...) is not supported in production builds of React.")}ge.Children={map:mi,forEach:function(e,t,n){mi(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return mi(e,function(){t++}),t},toArray:function(e){return mi(e,function(t){return t})||[]},only:function(e){if(!Vc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ge.Component=Dr;ge.Fragment=Cm;ge.Profiler=Am;ge.PureComponent=zc;ge.StrictMode=Em;ge.Suspense=Om;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$m;ge.act=Ah;ge.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=_h({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=Uc.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)bh.call(t,u)&&!Ch.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&c!==void 0?c[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var m=0;m<u;m++)c[m]=arguments[m+2];r.children=c}return{$$typeof:Va,type:e.type,key:a,ref:i,props:r,_owner:l}};ge.createContext=function(e){return e={$$typeof:Lm,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Tm,_context:e},e.Consumer=e};ge.createElement=Eh;ge.createFactory=function(e){var t=Eh.bind(null,e);return t.type=e,t};ge.createRef=function(){return{current:null}};ge.forwardRef=function(e){return{$$typeof:Rm,render:e}};ge.isValidElement=Vc;ge.lazy=function(e){return{$$typeof:Mm,_payload:{_status:-1,_result:e},_init:zm}};ge.memo=function(e,t){return{$$typeof:Pm,type:e,compare:t===void 0?null:t}};ge.startTransition=function(e){var t=Ii.transition;Ii.transition={};try{e()}finally{Ii.transition=t}};ge.unstable_act=Ah;ge.useCallback=function(e,t){return Tt.current.useCallback(e,t)};ge.useContext=function(e){return Tt.current.useContext(e)};ge.useDebugValue=function(){};ge.useDeferredValue=function(e){return Tt.current.useDeferredValue(e)};ge.useEffect=function(e,t){return Tt.current.useEffect(e,t)};ge.useId=function(){return Tt.current.useId()};ge.useImperativeHandle=function(e,t,n){return Tt.current.useImperativeHandle(e,t,n)};ge.useInsertionEffect=function(e,t){return Tt.current.useInsertionEffect(e,t)};ge.useLayoutEffect=function(e,t){return Tt.current.useLayoutEffect(e,t)};ge.useMemo=function(e,t){return Tt.current.useMemo(e,t)};ge.useReducer=function(e,t,n){return Tt.current.useReducer(e,t,n)};ge.useRef=function(e){return Tt.current.useRef(e)};ge.useState=function(e){return Tt.current.useState(e)};ge.useSyncExternalStore=function(e,t,n){return Tt.current.useSyncExternalStore(e,t,n)};ge.useTransition=function(){return Tt.current.useTransition()};ge.version="18.3.1";Nh.exports=ge;var f=Nh.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Um=f,Vm=Symbol.for("react.element"),Fm=Symbol.for("react.fragment"),Wm=Object.prototype.hasOwnProperty,Hm=Um.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qm={key:!0,ref:!0,__self:!0,__source:!0};function Th(e,t,n){var r,a={},i=null,l=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)Wm.call(t,r)&&!qm.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Vm,type:e,key:i,ref:l,props:a,_owner:Hm.current}}Sl.Fragment=Fm;Sl.jsx=Th;Sl.jsxs=Th;jh.exports=Sl;var s=jh.exports,Lh={exports:{}},Gt={},Rh={exports:{}},Oh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,G){var ne=F.length;F.push(G);e:for(;0<ne;){var ie=ne-1>>>1,he=F[ie];if(0<a(he,G))F[ie]=G,F[ne]=he,ne=ie;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var G=F[0],ne=F.pop();if(ne!==G){F[0]=ne;e:for(var ie=0,he=F.length,Ce=he>>>1;ie<Ce;){var A=2*(ie+1)-1,H=F[A],b=A+1,U=F[b];if(0>a(H,ne))b<he&&0>a(U,H)?(F[ie]=U,F[b]=ne,ie=b):(F[ie]=H,F[A]=ne,ie=A);else if(b<he&&0>a(U,ne))F[ie]=U,F[b]=ne,ie=b;else break e}}return G}function a(F,G){var ne=F.sortIndex-G.sortIndex;return ne!==0?ne:F.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var u=[],m=[],N=1,v=null,x=3,C=!1,L=!1,R=!1,g=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(F){for(var G=n(m);G!==null;){if(G.callback===null)r(m);else if(G.startTime<=F)r(m),G.sortIndex=G.expirationTime,t(u,G);else break;G=n(m)}}function S(F){if(R=!1,y(F),!L)if(n(u)!==null)L=!0,Te(D);else{var G=n(m);G!==null&&rt(S,G.startTime-F)}}function D(F,G){L=!1,R&&(R=!1,h(_),_=-1),C=!0;var ne=x;try{for(y(G),v=n(u);v!==null&&(!(v.expirationTime>G)||F&&!X());){var ie=v.callback;if(typeof ie=="function"){v.callback=null,x=v.priorityLevel;var he=ie(v.expirationTime<=G);G=e.unstable_now(),typeof he=="function"?v.callback=he:v===n(u)&&r(u),y(G)}else r(u);v=n(u)}if(v!==null)var Ce=!0;else{var A=n(m);A!==null&&rt(S,A.startTime-G),Ce=!1}return Ce}finally{v=null,x=ne,C=!1}}var $=!1,I=null,_=-1,O=5,P=-1;function X(){return!(e.unstable_now()-P<O)}function de(){if(I!==null){var F=e.unstable_now();P=F;var G=!0;try{G=I(!0,F)}finally{G?pe():($=!1,I=null)}}else $=!1}var pe;if(typeof p=="function")pe=function(){p(de)};else if(typeof MessageChannel<"u"){var Fe=new MessageChannel,ke=Fe.port2;Fe.port1.onmessage=de,pe=function(){ke.postMessage(null)}}else pe=function(){g(de,0)};function Te(F){I=F,$||($=!0,pe())}function rt(F,G){_=g(function(){F(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){L||C||(L=!0,Te(D))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(F){switch(x){case 1:case 2:case 3:var G=3;break;default:G=x}var ne=x;x=G;try{return F()}finally{x=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,G){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var ne=x;x=F;try{return G()}finally{x=ne}},e.unstable_scheduleCallback=function(F,G,ne){var ie=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ie+ne:ie):ne=ie,F){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=ne+he,F={id:N++,callback:G,priorityLevel:F,startTime:ne,expirationTime:he,sortIndex:-1},ne>ie?(F.sortIndex=ne,t(m,F),n(u)===null&&F===n(m)&&(R?(h(_),_=-1):R=!0,rt(S,ne-ie))):(F.sortIndex=he,t(u,F),L||C||(L=!0,Te(D))),F},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(F){var G=x;return function(){var ne=x;x=G;try{return F.apply(this,arguments)}finally{x=ne}}}})(Oh);Rh.exports=Oh;var Gm=Rh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qm=f,qt=Gm;function z(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ph=new Set,ka={};function Ks(e,t){Ar(e,t),Ar(e+"Capture",t)}function Ar(e,t){for(ka[e]=t,e=0;e<t.length;e++)Ph.add(t[e])}var Hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zo=Object.prototype.hasOwnProperty,Ym=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qu={},Gu={};function Km(e){return zo.call(Gu,e)?!0:zo.call(qu,e)?!1:Ym.test(e)?Gu[e]=!0:(qu[e]=!0,!1)}function Xm(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Jm(e,t,n,r){if(t===null||typeof t>"u"||Xm(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Lt(e,t,n,r,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){gt[e]=new Lt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];gt[t]=new Lt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){gt[e]=new Lt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){gt[e]=new Lt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){gt[e]=new Lt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){gt[e]=new Lt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){gt[e]=new Lt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){gt[e]=new Lt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){gt[e]=new Lt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Fc=/[\-:]([a-z])/g;function Wc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Fc,Wc);gt[t]=new Lt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Fc,Wc);gt[t]=new Lt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Fc,Wc);gt[t]=new Lt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){gt[e]=new Lt(e,1,!1,e.toLowerCase(),null,!1,!1)});gt.xlinkHref=new Lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){gt[e]=new Lt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Hc(e,t,n,r){var a=gt.hasOwnProperty(t)?gt[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Jm(t,n,a,r)&&(n=null),r||a===null?Km(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Yn=Qm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,gi=Symbol.for("react.element"),dr=Symbol.for("react.portal"),hr=Symbol.for("react.fragment"),qc=Symbol.for("react.strict_mode"),$o=Symbol.for("react.profiler"),Mh=Symbol.for("react.provider"),Dh=Symbol.for("react.context"),Gc=Symbol.for("react.forward_ref"),Uo=Symbol.for("react.suspense"),Vo=Symbol.for("react.suspense_list"),Qc=Symbol.for("react.memo"),us=Symbol.for("react.lazy"),Ih=Symbol.for("react.offscreen"),Qu=Symbol.iterator;function ta(e){return e===null||typeof e!="object"?null:(e=Qu&&e[Qu]||e["@@iterator"],typeof e=="function"?e:null)}var Ve=Object.assign,io;function ua(e){if(io===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);io=t&&t[1]||""}return`
`+io+e}var lo=!1;function oo(e,t){if(!e||lo)return"";lo=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(m){var r=m}Reflect.construct(e,[],t)}else{try{t.call()}catch(m){r=m}e.call(t.prototype)}else{try{throw Error()}catch(m){r=m}e()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var a=m.stack.split(`
`),i=r.stack.split(`
`),l=a.length-1,c=i.length-1;1<=l&&0<=c&&a[l]!==i[c];)c--;for(;1<=l&&0<=c;l--,c--)if(a[l]!==i[c]){if(l!==1||c!==1)do if(l--,c--,0>c||a[l]!==i[c]){var u=`
`+a[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=c);break}}}finally{lo=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ua(e):""}function Zm(e){switch(e.tag){case 5:return ua(e.type);case 16:return ua("Lazy");case 13:return ua("Suspense");case 19:return ua("SuspenseList");case 0:case 2:case 15:return e=oo(e.type,!1),e;case 11:return e=oo(e.type.render,!1),e;case 1:return e=oo(e.type,!0),e;default:return""}}function Fo(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case hr:return"Fragment";case dr:return"Portal";case $o:return"Profiler";case qc:return"StrictMode";case Uo:return"Suspense";case Vo:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Dh:return(e.displayName||"Context")+".Consumer";case Mh:return(e._context.displayName||"Context")+".Provider";case Gc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Qc:return t=e.displayName||null,t!==null?t:Fo(e.type)||"Memo";case us:t=e._payload,e=e._init;try{return Fo(e(t))}catch{}}return null}function eg(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fo(t);case 8:return t===qc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ks(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Bh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function tg(e){var t=Bh(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){r=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function vi(e){e._valueTracker||(e._valueTracker=tg(e))}function zh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Bh(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ji(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Wo(e,t){var n=t.checked;return Ve({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Yu(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ks(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function $h(e,t){t=t.checked,t!=null&&Hc(e,"checked",t,!1)}function Ho(e,t){$h(e,t);var n=ks(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?qo(e,t.type,n):t.hasOwnProperty("defaultValue")&&qo(e,t.type,ks(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ku(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function qo(e,t,n){(t!=="number"||Ji(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var da=Array.isArray;function _r(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ks(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Go(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(z(91));return Ve({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Xu(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(z(92));if(da(n)){if(1<n.length)throw Error(z(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ks(n)}}function Uh(e,t){var n=ks(t.value),r=ks(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Ju(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Vh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qo(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Vh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var xi,Fh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(xi=xi||document.createElement("div"),xi.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=xi.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ba(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ma={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ng=["Webkit","ms","Moz","O"];Object.keys(ma).forEach(function(e){ng.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ma[t]=ma[e]})});function Wh(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ma.hasOwnProperty(e)&&ma[e]?(""+t).trim():t+"px"}function Hh(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=Wh(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var sg=Ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yo(e,t){if(t){if(sg[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(z(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(z(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(z(61))}if(t.style!=null&&typeof t.style!="object")throw Error(z(62))}}function Ko(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xo=null;function Yc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Jo=null,Sr=null,kr=null;function Zu(e){if(e=Ha(e)){if(typeof Jo!="function")throw Error(z(280));var t=e.stateNode;t&&(t=Al(t),Jo(e.stateNode,e.type,t))}}function qh(e){Sr?kr?kr.push(e):kr=[e]:Sr=e}function Gh(){if(Sr){var e=Sr,t=kr;if(kr=Sr=null,Zu(e),t)for(e=0;e<t.length;e++)Zu(t[e])}}function Qh(e,t){return e(t)}function Yh(){}var co=!1;function Kh(e,t,n){if(co)return e(t,n);co=!0;try{return Qh(e,t,n)}finally{co=!1,(Sr!==null||kr!==null)&&(Yh(),Gh())}}function Ca(e,t){var n=e.stateNode;if(n===null)return null;var r=Al(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(z(231,t,typeof n));return n}var Zo=!1;if(Hn)try{var na={};Object.defineProperty(na,"passive",{get:function(){Zo=!0}}),window.addEventListener("test",na,na),window.removeEventListener("test",na,na)}catch{Zo=!1}function rg(e,t,n,r,a,i,l,c,u){var m=Array.prototype.slice.call(arguments,3);try{t.apply(n,m)}catch(N){this.onError(N)}}var ga=!1,Zi=null,el=!1,ec=null,ag={onError:function(e){ga=!0,Zi=e}};function ig(e,t,n,r,a,i,l,c,u){ga=!1,Zi=null,rg.apply(ag,arguments)}function lg(e,t,n,r,a,i,l,c,u){if(ig.apply(this,arguments),ga){if(ga){var m=Zi;ga=!1,Zi=null}else throw Error(z(198));el||(el=!0,ec=m)}}function Xs(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Xh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ed(e){if(Xs(e)!==e)throw Error(z(188))}function og(e){var t=e.alternate;if(!t){if(t=Xs(e),t===null)throw Error(z(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return ed(a),e;if(i===r)return ed(a),t;i=i.sibling}throw Error(z(188))}if(n.return!==r.return)n=a,r=i;else{for(var l=!1,c=a.child;c;){if(c===n){l=!0,n=a,r=i;break}if(c===r){l=!0,r=a,n=i;break}c=c.sibling}if(!l){for(c=i.child;c;){if(c===n){l=!0,n=i,r=a;break}if(c===r){l=!0,r=i,n=a;break}c=c.sibling}if(!l)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?e:t}function Jh(e){return e=og(e),e!==null?Zh(e):null}function Zh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Zh(e);if(t!==null)return t;e=e.sibling}return null}var ef=qt.unstable_scheduleCallback,td=qt.unstable_cancelCallback,cg=qt.unstable_shouldYield,ug=qt.unstable_requestPaint,Ge=qt.unstable_now,dg=qt.unstable_getCurrentPriorityLevel,Kc=qt.unstable_ImmediatePriority,tf=qt.unstable_UserBlockingPriority,tl=qt.unstable_NormalPriority,hg=qt.unstable_LowPriority,nf=qt.unstable_IdlePriority,kl=null,An=null;function fg(e){if(An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(kl,e,void 0,(e.current.flags&128)===128)}catch{}}var vn=Math.clz32?Math.clz32:gg,pg=Math.log,mg=Math.LN2;function gg(e){return e>>>=0,e===0?32:31-(pg(e)/mg|0)|0}var yi=64,ji=4194304;function ha(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function nl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,l=n&268435455;if(l!==0){var c=l&~a;c!==0?r=ha(c):(i&=l,i!==0&&(r=ha(i)))}else l=n&~a,l!==0?r=ha(l):i!==0&&(r=ha(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-vn(t),a=1<<n,r|=e[n],t&=~a;return r}function vg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xg(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-vn(i),c=1<<l,u=a[l];u===-1?(!(c&n)||c&r)&&(a[l]=vg(c,t)):u<=t&&(e.expiredLanes|=c),i&=~c}}function tc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function sf(){var e=yi;return yi<<=1,!(yi&4194240)&&(yi=64),e}function uo(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Fa(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-vn(t),e[t]=n}function yg(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-vn(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}function Xc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-vn(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var be=0;function rf(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var af,Jc,lf,of,cf,nc=!1,Ni=[],gs=null,vs=null,xs=null,Ea=new Map,Aa=new Map,hs=[],jg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nd(e,t){switch(e){case"focusin":case"focusout":gs=null;break;case"dragenter":case"dragleave":vs=null;break;case"mouseover":case"mouseout":xs=null;break;case"pointerover":case"pointerout":Ea.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Aa.delete(t.pointerId)}}function sa(e,t,n,r,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Ha(t),t!==null&&Jc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Ng(e,t,n,r,a){switch(t){case"focusin":return gs=sa(gs,e,t,n,r,a),!0;case"dragenter":return vs=sa(vs,e,t,n,r,a),!0;case"mouseover":return xs=sa(xs,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Ea.set(i,sa(Ea.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Aa.set(i,sa(Aa.get(i)||null,e,t,n,r,a)),!0}return!1}function uf(e){var t=$s(e.target);if(t!==null){var n=Xs(t);if(n!==null){if(t=n.tag,t===13){if(t=Xh(n),t!==null){e.blockedOn=t,cf(e.priority,function(){lf(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Bi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=sc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Xo=r,n.target.dispatchEvent(r),Xo=null}else return t=Ha(n),t!==null&&Jc(t),e.blockedOn=n,!1;t.shift()}return!0}function sd(e,t,n){Bi(e)&&n.delete(t)}function wg(){nc=!1,gs!==null&&Bi(gs)&&(gs=null),vs!==null&&Bi(vs)&&(vs=null),xs!==null&&Bi(xs)&&(xs=null),Ea.forEach(sd),Aa.forEach(sd)}function ra(e,t){e.blockedOn===t&&(e.blockedOn=null,nc||(nc=!0,qt.unstable_scheduleCallback(qt.unstable_NormalPriority,wg)))}function Ta(e){function t(a){return ra(a,e)}if(0<Ni.length){ra(Ni[0],e);for(var n=1;n<Ni.length;n++){var r=Ni[n];r.blockedOn===e&&(r.blockedOn=null)}}for(gs!==null&&ra(gs,e),vs!==null&&ra(vs,e),xs!==null&&ra(xs,e),Ea.forEach(t),Aa.forEach(t),n=0;n<hs.length;n++)r=hs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<hs.length&&(n=hs[0],n.blockedOn===null);)uf(n),n.blockedOn===null&&hs.shift()}var br=Yn.ReactCurrentBatchConfig,sl=!0;function _g(e,t,n,r){var a=be,i=br.transition;br.transition=null;try{be=1,Zc(e,t,n,r)}finally{be=a,br.transition=i}}function Sg(e,t,n,r){var a=be,i=br.transition;br.transition=null;try{be=4,Zc(e,t,n,r)}finally{be=a,br.transition=i}}function Zc(e,t,n,r){if(sl){var a=sc(e,t,n,r);if(a===null)No(e,t,r,rl,n),nd(e,r);else if(Ng(a,e,t,n,r))r.stopPropagation();else if(nd(e,r),t&4&&-1<jg.indexOf(e)){for(;a!==null;){var i=Ha(a);if(i!==null&&af(i),i=sc(e,t,n,r),i===null&&No(e,t,r,rl,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else No(e,t,r,null,n)}}var rl=null;function sc(e,t,n,r){if(rl=null,e=Yc(r),e=$s(e),e!==null)if(t=Xs(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Xh(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return rl=e,null}function df(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dg()){case Kc:return 1;case tf:return 4;case tl:case hg:return 16;case nf:return 536870912;default:return 16}default:return 16}}var ps=null,eu=null,zi=null;function hf(){if(zi)return zi;var e,t=eu,n=t.length,r,a="value"in ps?ps.value:ps.textContent,i=a.length;for(e=0;e<n&&t[e]===a[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===a[i-r];r++);return zi=a.slice(e,1<r?1-r:void 0)}function $i(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function wi(){return!0}function rd(){return!1}function Qt(e){function t(n,r,a,i,l){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?wi:rd,this.isPropagationStopped=rd,this}return Ve(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=wi)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=wi)},persist:function(){},isPersistent:wi}),t}var Ir={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tu=Qt(Ir),Wa=Ve({},Ir,{view:0,detail:0}),kg=Qt(Wa),ho,fo,aa,bl=Ve({},Wa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==aa&&(aa&&e.type==="mousemove"?(ho=e.screenX-aa.screenX,fo=e.screenY-aa.screenY):fo=ho=0,aa=e),ho)},movementY:function(e){return"movementY"in e?e.movementY:fo}}),ad=Qt(bl),bg=Ve({},bl,{dataTransfer:0}),Cg=Qt(bg),Eg=Ve({},Wa,{relatedTarget:0}),po=Qt(Eg),Ag=Ve({},Ir,{animationName:0,elapsedTime:0,pseudoElement:0}),Tg=Qt(Ag),Lg=Ve({},Ir,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Rg=Qt(Lg),Og=Ve({},Ir,{data:0}),id=Qt(Og),Pg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ig(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Dg[e])?!!t[e]:!1}function nu(){return Ig}var Bg=Ve({},Wa,{key:function(e){if(e.key){var t=Pg[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=$i(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Mg[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nu,charCode:function(e){return e.type==="keypress"?$i(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?$i(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),zg=Qt(Bg),$g=Ve({},bl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ld=Qt($g),Ug=Ve({},Wa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nu}),Vg=Qt(Ug),Fg=Ve({},Ir,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wg=Qt(Fg),Hg=Ve({},bl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qg=Qt(Hg),Gg=[9,13,27,32],su=Hn&&"CompositionEvent"in window,va=null;Hn&&"documentMode"in document&&(va=document.documentMode);var Qg=Hn&&"TextEvent"in window&&!va,ff=Hn&&(!su||va&&8<va&&11>=va),od=" ",cd=!1;function pf(e,t){switch(e){case"keyup":return Gg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fr=!1;function Yg(e,t){switch(e){case"compositionend":return mf(t);case"keypress":return t.which!==32?null:(cd=!0,od);case"textInput":return e=t.data,e===od&&cd?null:e;default:return null}}function Kg(e,t){if(fr)return e==="compositionend"||!su&&pf(e,t)?(e=hf(),zi=eu=ps=null,fr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ff&&t.locale!=="ko"?null:t.data;default:return null}}var Xg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ud(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xg[e.type]:t==="textarea"}function gf(e,t,n,r){qh(r),t=al(t,"onChange"),0<t.length&&(n=new tu("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var xa=null,La=null;function Jg(e){Cf(e,0)}function Cl(e){var t=gr(e);if(zh(t))return e}function Zg(e,t){if(e==="change")return t}var vf=!1;if(Hn){var mo;if(Hn){var go="oninput"in document;if(!go){var dd=document.createElement("div");dd.setAttribute("oninput","return;"),go=typeof dd.oninput=="function"}mo=go}else mo=!1;vf=mo&&(!document.documentMode||9<document.documentMode)}function hd(){xa&&(xa.detachEvent("onpropertychange",xf),La=xa=null)}function xf(e){if(e.propertyName==="value"&&Cl(La)){var t=[];gf(t,La,e,Yc(e)),Kh(Jg,t)}}function ev(e,t,n){e==="focusin"?(hd(),xa=t,La=n,xa.attachEvent("onpropertychange",xf)):e==="focusout"&&hd()}function tv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Cl(La)}function nv(e,t){if(e==="click")return Cl(t)}function sv(e,t){if(e==="input"||e==="change")return Cl(t)}function rv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var yn=typeof Object.is=="function"?Object.is:rv;function Ra(e,t){if(yn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!zo.call(t,a)||!yn(e[a],t[a]))return!1}return!0}function fd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pd(e,t){var n=fd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=fd(n)}}function yf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?yf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function jf(){for(var e=window,t=Ji();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ji(e.document)}return t}function ru(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function av(e){var t=jf(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&yf(n.ownerDocument.documentElement,n)){if(r!==null&&ru(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=pd(n,i);var l=pd(n,r);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var iv=Hn&&"documentMode"in document&&11>=document.documentMode,pr=null,rc=null,ya=null,ac=!1;function md(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ac||pr==null||pr!==Ji(r)||(r=pr,"selectionStart"in r&&ru(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ya&&Ra(ya,r)||(ya=r,r=al(rc,"onSelect"),0<r.length&&(t=new tu("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=pr)))}function _i(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var mr={animationend:_i("Animation","AnimationEnd"),animationiteration:_i("Animation","AnimationIteration"),animationstart:_i("Animation","AnimationStart"),transitionend:_i("Transition","TransitionEnd")},vo={},Nf={};Hn&&(Nf=document.createElement("div").style,"AnimationEvent"in window||(delete mr.animationend.animation,delete mr.animationiteration.animation,delete mr.animationstart.animation),"TransitionEvent"in window||delete mr.transitionend.transition);function El(e){if(vo[e])return vo[e];if(!mr[e])return e;var t=mr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Nf)return vo[e]=t[n];return e}var wf=El("animationend"),_f=El("animationiteration"),Sf=El("animationstart"),kf=El("transitionend"),bf=new Map,gd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cs(e,t){bf.set(e,t),Ks(t,[e])}for(var xo=0;xo<gd.length;xo++){var yo=gd[xo],lv=yo.toLowerCase(),ov=yo[0].toUpperCase()+yo.slice(1);Cs(lv,"on"+ov)}Cs(wf,"onAnimationEnd");Cs(_f,"onAnimationIteration");Cs(Sf,"onAnimationStart");Cs("dblclick","onDoubleClick");Cs("focusin","onFocus");Cs("focusout","onBlur");Cs(kf,"onTransitionEnd");Ar("onMouseEnter",["mouseout","mouseover"]);Ar("onMouseLeave",["mouseout","mouseover"]);Ar("onPointerEnter",["pointerout","pointerover"]);Ar("onPointerLeave",["pointerout","pointerover"]);Ks("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ks("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ks("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ks("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ks("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ks("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cv=new Set("cancel close invalid load scroll toggle".split(" ").concat(fa));function vd(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,lg(r,t,void 0,e),e.currentTarget=null}function Cf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var l=r.length-1;0<=l;l--){var c=r[l],u=c.instance,m=c.currentTarget;if(c=c.listener,u!==i&&a.isPropagationStopped())break e;vd(a,c,m),i=u}else for(l=0;l<r.length;l++){if(c=r[l],u=c.instance,m=c.currentTarget,c=c.listener,u!==i&&a.isPropagationStopped())break e;vd(a,c,m),i=u}}}if(el)throw e=ec,el=!1,ec=null,e}function Me(e,t){var n=t[uc];n===void 0&&(n=t[uc]=new Set);var r=e+"__bubble";n.has(r)||(Ef(t,e,2,!1),n.add(r))}function jo(e,t,n){var r=0;t&&(r|=4),Ef(n,e,r,t)}var Si="_reactListening"+Math.random().toString(36).slice(2);function Oa(e){if(!e[Si]){e[Si]=!0,Ph.forEach(function(n){n!=="selectionchange"&&(cv.has(n)||jo(n,!1,e),jo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Si]||(t[Si]=!0,jo("selectionchange",!1,t))}}function Ef(e,t,n,r){switch(df(t)){case 1:var a=_g;break;case 4:a=Sg;break;default:a=Zc}n=a.bind(null,t,n,e),a=void 0,!Zo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function No(e,t,n,r,a){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var c=r.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(l===4)for(l=r.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;l=l.return}for(;c!==null;){if(l=$s(c),l===null)return;if(u=l.tag,u===5||u===6){r=i=l;continue e}c=c.parentNode}}r=r.return}Kh(function(){var m=i,N=Yc(n),v=[];e:{var x=bf.get(e);if(x!==void 0){var C=tu,L=e;switch(e){case"keypress":if($i(n)===0)break e;case"keydown":case"keyup":C=zg;break;case"focusin":L="focus",C=po;break;case"focusout":L="blur",C=po;break;case"beforeblur":case"afterblur":C=po;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=ad;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Cg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=Vg;break;case wf:case _f:case Sf:C=Tg;break;case kf:C=Wg;break;case"scroll":C=kg;break;case"wheel":C=qg;break;case"copy":case"cut":case"paste":C=Rg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=ld}var R=(t&4)!==0,g=!R&&e==="scroll",h=R?x!==null?x+"Capture":null:x;R=[];for(var p=m,y;p!==null;){y=p;var S=y.stateNode;if(y.tag===5&&S!==null&&(y=S,h!==null&&(S=Ca(p,h),S!=null&&R.push(Pa(p,S,y)))),g)break;p=p.return}0<R.length&&(x=new C(x,L,null,n,N),v.push({event:x,listeners:R}))}}if(!(t&7)){e:{if(x=e==="mouseover"||e==="pointerover",C=e==="mouseout"||e==="pointerout",x&&n!==Xo&&(L=n.relatedTarget||n.fromElement)&&($s(L)||L[qn]))break e;if((C||x)&&(x=N.window===N?N:(x=N.ownerDocument)?x.defaultView||x.parentWindow:window,C?(L=n.relatedTarget||n.toElement,C=m,L=L?$s(L):null,L!==null&&(g=Xs(L),L!==g||L.tag!==5&&L.tag!==6)&&(L=null)):(C=null,L=m),C!==L)){if(R=ad,S="onMouseLeave",h="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(R=ld,S="onPointerLeave",h="onPointerEnter",p="pointer"),g=C==null?x:gr(C),y=L==null?x:gr(L),x=new R(S,p+"leave",C,n,N),x.target=g,x.relatedTarget=y,S=null,$s(N)===m&&(R=new R(h,p+"enter",L,n,N),R.target=y,R.relatedTarget=g,S=R),g=S,C&&L)t:{for(R=C,h=L,p=0,y=R;y;y=cr(y))p++;for(y=0,S=h;S;S=cr(S))y++;for(;0<p-y;)R=cr(R),p--;for(;0<y-p;)h=cr(h),y--;for(;p--;){if(R===h||h!==null&&R===h.alternate)break t;R=cr(R),h=cr(h)}R=null}else R=null;C!==null&&xd(v,x,C,R,!1),L!==null&&g!==null&&xd(v,g,L,R,!0)}}e:{if(x=m?gr(m):window,C=x.nodeName&&x.nodeName.toLowerCase(),C==="select"||C==="input"&&x.type==="file")var D=Zg;else if(ud(x))if(vf)D=sv;else{D=tv;var $=ev}else(C=x.nodeName)&&C.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(D=nv);if(D&&(D=D(e,m))){gf(v,D,n,N);break e}$&&$(e,x,m),e==="focusout"&&($=x._wrapperState)&&$.controlled&&x.type==="number"&&qo(x,"number",x.value)}switch($=m?gr(m):window,e){case"focusin":(ud($)||$.contentEditable==="true")&&(pr=$,rc=m,ya=null);break;case"focusout":ya=rc=pr=null;break;case"mousedown":ac=!0;break;case"contextmenu":case"mouseup":case"dragend":ac=!1,md(v,n,N);break;case"selectionchange":if(iv)break;case"keydown":case"keyup":md(v,n,N)}var I;if(su)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else fr?pf(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(ff&&n.locale!=="ko"&&(fr||_!=="onCompositionStart"?_==="onCompositionEnd"&&fr&&(I=hf()):(ps=N,eu="value"in ps?ps.value:ps.textContent,fr=!0)),$=al(m,_),0<$.length&&(_=new id(_,e,null,n,N),v.push({event:_,listeners:$}),I?_.data=I:(I=mf(n),I!==null&&(_.data=I)))),(I=Qg?Yg(e,n):Kg(e,n))&&(m=al(m,"onBeforeInput"),0<m.length&&(N=new id("onBeforeInput","beforeinput",null,n,N),v.push({event:N,listeners:m}),N.data=I))}Cf(v,t)})}function Pa(e,t,n){return{instance:e,listener:t,currentTarget:n}}function al(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ca(e,n),i!=null&&r.unshift(Pa(e,i,a)),i=Ca(e,t),i!=null&&r.push(Pa(e,i,a))),e=e.return}return r}function cr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function xd(e,t,n,r,a){for(var i=t._reactName,l=[];n!==null&&n!==r;){var c=n,u=c.alternate,m=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&m!==null&&(c=m,a?(u=Ca(n,i),u!=null&&l.unshift(Pa(n,u,c))):a||(u=Ca(n,i),u!=null&&l.push(Pa(n,u,c)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var uv=/\r\n?/g,dv=/\u0000|\uFFFD/g;function yd(e){return(typeof e=="string"?e:""+e).replace(uv,`
`).replace(dv,"")}function ki(e,t,n){if(t=yd(t),yd(e)!==t&&n)throw Error(z(425))}function il(){}var ic=null,lc=null;function oc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var cc=typeof setTimeout=="function"?setTimeout:void 0,hv=typeof clearTimeout=="function"?clearTimeout:void 0,jd=typeof Promise=="function"?Promise:void 0,fv=typeof queueMicrotask=="function"?queueMicrotask:typeof jd<"u"?function(e){return jd.resolve(null).then(e).catch(pv)}:cc;function pv(e){setTimeout(function(){throw e})}function wo(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),Ta(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Ta(t)}function ys(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Nd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Br=Math.random().toString(36).slice(2),En="__reactFiber$"+Br,Ma="__reactProps$"+Br,qn="__reactContainer$"+Br,uc="__reactEvents$"+Br,mv="__reactListeners$"+Br,gv="__reactHandles$"+Br;function $s(e){var t=e[En];if(t)return t;for(var n=e.parentNode;n;){if(t=n[qn]||n[En]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Nd(e);e!==null;){if(n=e[En])return n;e=Nd(e)}return t}e=n,n=e.parentNode}return null}function Ha(e){return e=e[En]||e[qn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function gr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(z(33))}function Al(e){return e[Ma]||null}var dc=[],vr=-1;function Es(e){return{current:e}}function De(e){0>vr||(e.current=dc[vr],dc[vr]=null,vr--)}function Re(e,t){vr++,dc[vr]=e.current,e.current=t}var bs={},St=Es(bs),Dt=Es(!1),Hs=bs;function Tr(e,t){var n=e.type.contextTypes;if(!n)return bs;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function It(e){return e=e.childContextTypes,e!=null}function ll(){De(Dt),De(St)}function wd(e,t,n){if(St.current!==bs)throw Error(z(168));Re(St,t),Re(Dt,n)}function Af(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(z(108,eg(e)||"Unknown",a));return Ve({},n,r)}function ol(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bs,Hs=St.current,Re(St,e),Re(Dt,Dt.current),!0}function _d(e,t,n){var r=e.stateNode;if(!r)throw Error(z(169));n?(e=Af(e,t,Hs),r.__reactInternalMemoizedMergedChildContext=e,De(Dt),De(St),Re(St,e)):De(Dt),Re(Dt,n)}var $n=null,Tl=!1,_o=!1;function Tf(e){$n===null?$n=[e]:$n.push(e)}function vv(e){Tl=!0,Tf(e)}function As(){if(!_o&&$n!==null){_o=!0;var e=0,t=be;try{var n=$n;for(be=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}$n=null,Tl=!1}catch(a){throw $n!==null&&($n=$n.slice(e+1)),ef(Kc,As),a}finally{be=t,_o=!1}}return null}var xr=[],yr=0,cl=null,ul=0,Xt=[],Jt=0,qs=null,Vn=1,Fn="";function Bs(e,t){xr[yr++]=ul,xr[yr++]=cl,cl=e,ul=t}function Lf(e,t,n){Xt[Jt++]=Vn,Xt[Jt++]=Fn,Xt[Jt++]=qs,qs=e;var r=Vn;e=Fn;var a=32-vn(r)-1;r&=~(1<<a),n+=1;var i=32-vn(t)+a;if(30<i){var l=a-a%5;i=(r&(1<<l)-1).toString(32),r>>=l,a-=l,Vn=1<<32-vn(t)+a|n<<a|r,Fn=i+e}else Vn=1<<i|n<<a|r,Fn=e}function au(e){e.return!==null&&(Bs(e,1),Lf(e,1,0))}function iu(e){for(;e===cl;)cl=xr[--yr],xr[yr]=null,ul=xr[--yr],xr[yr]=null;for(;e===qs;)qs=Xt[--Jt],Xt[Jt]=null,Fn=Xt[--Jt],Xt[Jt]=null,Vn=Xt[--Jt],Xt[Jt]=null}var Ht=null,Wt=null,ze=!1,gn=null;function Rf(e,t){var n=en(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Sd(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ht=e,Wt=ys(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ht=e,Wt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=qs!==null?{id:Vn,overflow:Fn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=en(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ht=e,Wt=null,!0):!1;default:return!1}}function hc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function fc(e){if(ze){var t=Wt;if(t){var n=t;if(!Sd(e,t)){if(hc(e))throw Error(z(418));t=ys(n.nextSibling);var r=Ht;t&&Sd(e,t)?Rf(r,n):(e.flags=e.flags&-4097|2,ze=!1,Ht=e)}}else{if(hc(e))throw Error(z(418));e.flags=e.flags&-4097|2,ze=!1,Ht=e}}}function kd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ht=e}function bi(e){if(e!==Ht)return!1;if(!ze)return kd(e),ze=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!oc(e.type,e.memoizedProps)),t&&(t=Wt)){if(hc(e))throw Of(),Error(z(418));for(;t;)Rf(e,t),t=ys(t.nextSibling)}if(kd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(z(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Wt=ys(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Wt=null}}else Wt=Ht?ys(e.stateNode.nextSibling):null;return!0}function Of(){for(var e=Wt;e;)e=ys(e.nextSibling)}function Lr(){Wt=Ht=null,ze=!1}function lu(e){gn===null?gn=[e]:gn.push(e)}var xv=Yn.ReactCurrentBatchConfig;function ia(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,e));var a=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var c=a.refs;l===null?delete c[i]:c[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,e))}return e}function Ci(e,t){throw e=Object.prototype.toString.call(t),Error(z(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bd(e){var t=e._init;return t(e._payload)}function Pf(e){function t(h,p){if(e){var y=h.deletions;y===null?(h.deletions=[p],h.flags|=16):y.push(p)}}function n(h,p){if(!e)return null;for(;p!==null;)t(h,p),p=p.sibling;return null}function r(h,p){for(h=new Map;p!==null;)p.key!==null?h.set(p.key,p):h.set(p.index,p),p=p.sibling;return h}function a(h,p){return h=_s(h,p),h.index=0,h.sibling=null,h}function i(h,p,y){return h.index=y,e?(y=h.alternate,y!==null?(y=y.index,y<p?(h.flags|=2,p):y):(h.flags|=2,p)):(h.flags|=1048576,p)}function l(h){return e&&h.alternate===null&&(h.flags|=2),h}function c(h,p,y,S){return p===null||p.tag!==6?(p=To(y,h.mode,S),p.return=h,p):(p=a(p,y),p.return=h,p)}function u(h,p,y,S){var D=y.type;return D===hr?N(h,p,y.props.children,S,y.key):p!==null&&(p.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===us&&bd(D)===p.type)?(S=a(p,y.props),S.ref=ia(h,p,y),S.return=h,S):(S=Gi(y.type,y.key,y.props,null,h.mode,S),S.ref=ia(h,p,y),S.return=h,S)}function m(h,p,y,S){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=Lo(y,h.mode,S),p.return=h,p):(p=a(p,y.children||[]),p.return=h,p)}function N(h,p,y,S,D){return p===null||p.tag!==7?(p=Ws(y,h.mode,S,D),p.return=h,p):(p=a(p,y),p.return=h,p)}function v(h,p,y){if(typeof p=="string"&&p!==""||typeof p=="number")return p=To(""+p,h.mode,y),p.return=h,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case gi:return y=Gi(p.type,p.key,p.props,null,h.mode,y),y.ref=ia(h,null,p),y.return=h,y;case dr:return p=Lo(p,h.mode,y),p.return=h,p;case us:var S=p._init;return v(h,S(p._payload),y)}if(da(p)||ta(p))return p=Ws(p,h.mode,y,null),p.return=h,p;Ci(h,p)}return null}function x(h,p,y,S){var D=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return D!==null?null:c(h,p,""+y,S);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case gi:return y.key===D?u(h,p,y,S):null;case dr:return y.key===D?m(h,p,y,S):null;case us:return D=y._init,x(h,p,D(y._payload),S)}if(da(y)||ta(y))return D!==null?null:N(h,p,y,S,null);Ci(h,y)}return null}function C(h,p,y,S,D){if(typeof S=="string"&&S!==""||typeof S=="number")return h=h.get(y)||null,c(p,h,""+S,D);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case gi:return h=h.get(S.key===null?y:S.key)||null,u(p,h,S,D);case dr:return h=h.get(S.key===null?y:S.key)||null,m(p,h,S,D);case us:var $=S._init;return C(h,p,y,$(S._payload),D)}if(da(S)||ta(S))return h=h.get(y)||null,N(p,h,S,D,null);Ci(p,S)}return null}function L(h,p,y,S){for(var D=null,$=null,I=p,_=p=0,O=null;I!==null&&_<y.length;_++){I.index>_?(O=I,I=null):O=I.sibling;var P=x(h,I,y[_],S);if(P===null){I===null&&(I=O);break}e&&I&&P.alternate===null&&t(h,I),p=i(P,p,_),$===null?D=P:$.sibling=P,$=P,I=O}if(_===y.length)return n(h,I),ze&&Bs(h,_),D;if(I===null){for(;_<y.length;_++)I=v(h,y[_],S),I!==null&&(p=i(I,p,_),$===null?D=I:$.sibling=I,$=I);return ze&&Bs(h,_),D}for(I=r(h,I);_<y.length;_++)O=C(I,h,_,y[_],S),O!==null&&(e&&O.alternate!==null&&I.delete(O.key===null?_:O.key),p=i(O,p,_),$===null?D=O:$.sibling=O,$=O);return e&&I.forEach(function(X){return t(h,X)}),ze&&Bs(h,_),D}function R(h,p,y,S){var D=ta(y);if(typeof D!="function")throw Error(z(150));if(y=D.call(y),y==null)throw Error(z(151));for(var $=D=null,I=p,_=p=0,O=null,P=y.next();I!==null&&!P.done;_++,P=y.next()){I.index>_?(O=I,I=null):O=I.sibling;var X=x(h,I,P.value,S);if(X===null){I===null&&(I=O);break}e&&I&&X.alternate===null&&t(h,I),p=i(X,p,_),$===null?D=X:$.sibling=X,$=X,I=O}if(P.done)return n(h,I),ze&&Bs(h,_),D;if(I===null){for(;!P.done;_++,P=y.next())P=v(h,P.value,S),P!==null&&(p=i(P,p,_),$===null?D=P:$.sibling=P,$=P);return ze&&Bs(h,_),D}for(I=r(h,I);!P.done;_++,P=y.next())P=C(I,h,_,P.value,S),P!==null&&(e&&P.alternate!==null&&I.delete(P.key===null?_:P.key),p=i(P,p,_),$===null?D=P:$.sibling=P,$=P);return e&&I.forEach(function(de){return t(h,de)}),ze&&Bs(h,_),D}function g(h,p,y,S){if(typeof y=="object"&&y!==null&&y.type===hr&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case gi:e:{for(var D=y.key,$=p;$!==null;){if($.key===D){if(D=y.type,D===hr){if($.tag===7){n(h,$.sibling),p=a($,y.props.children),p.return=h,h=p;break e}}else if($.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===us&&bd(D)===$.type){n(h,$.sibling),p=a($,y.props),p.ref=ia(h,$,y),p.return=h,h=p;break e}n(h,$);break}else t(h,$);$=$.sibling}y.type===hr?(p=Ws(y.props.children,h.mode,S,y.key),p.return=h,h=p):(S=Gi(y.type,y.key,y.props,null,h.mode,S),S.ref=ia(h,p,y),S.return=h,h=S)}return l(h);case dr:e:{for($=y.key;p!==null;){if(p.key===$)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){n(h,p.sibling),p=a(p,y.children||[]),p.return=h,h=p;break e}else{n(h,p);break}else t(h,p);p=p.sibling}p=Lo(y,h.mode,S),p.return=h,h=p}return l(h);case us:return $=y._init,g(h,p,$(y._payload),S)}if(da(y))return L(h,p,y,S);if(ta(y))return R(h,p,y,S);Ci(h,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,p!==null&&p.tag===6?(n(h,p.sibling),p=a(p,y),p.return=h,h=p):(n(h,p),p=To(y,h.mode,S),p.return=h,h=p),l(h)):n(h,p)}return g}var Rr=Pf(!0),Mf=Pf(!1),dl=Es(null),hl=null,jr=null,ou=null;function cu(){ou=jr=hl=null}function uu(e){var t=dl.current;De(dl),e._currentValue=t}function pc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Cr(e,t){hl=e,ou=jr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Mt=!0),e.firstContext=null)}function nn(e){var t=e._currentValue;if(ou!==e)if(e={context:e,memoizedValue:t,next:null},jr===null){if(hl===null)throw Error(z(308));jr=e,hl.dependencies={lanes:0,firstContext:e}}else jr=jr.next=e;return t}var Us=null;function du(e){Us===null?Us=[e]:Us.push(e)}function Df(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,du(t)):(n.next=a.next,a.next=n),t.interleaved=n,Gn(e,r)}function Gn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ds=!1;function hu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function If(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Wn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function js(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,we&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Gn(e,n)}return a=r.interleaved,a===null?(t.next=t,du(r)):(t.next=a.next,a.next=t),r.interleaved=t,Gn(e,n)}function Ui(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Xc(e,n)}}function Cd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=l:i=i.next=l,n=n.next}while(n!==null);i===null?a=i=t:i=i.next=t}else a=i=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function fl(e,t,n,r){var a=e.updateQueue;ds=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var u=c,m=u.next;u.next=null,l===null?i=m:l.next=m,l=u;var N=e.alternate;N!==null&&(N=N.updateQueue,c=N.lastBaseUpdate,c!==l&&(c===null?N.firstBaseUpdate=m:c.next=m,N.lastBaseUpdate=u))}if(i!==null){var v=a.baseState;l=0,N=m=u=null,c=i;do{var x=c.lane,C=c.eventTime;if((r&x)===x){N!==null&&(N=N.next={eventTime:C,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var L=e,R=c;switch(x=t,C=n,R.tag){case 1:if(L=R.payload,typeof L=="function"){v=L.call(C,v,x);break e}v=L;break e;case 3:L.flags=L.flags&-65537|128;case 0:if(L=R.payload,x=typeof L=="function"?L.call(C,v,x):L,x==null)break e;v=Ve({},v,x);break e;case 2:ds=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,x=a.effects,x===null?a.effects=[c]:x.push(c))}else C={eventTime:C,lane:x,tag:c.tag,payload:c.payload,callback:c.callback,next:null},N===null?(m=N=C,u=v):N=N.next=C,l|=x;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;x=c,c=x.next,x.next=null,a.lastBaseUpdate=x,a.shared.pending=null}}while(!0);if(N===null&&(u=v),a.baseState=u,a.firstBaseUpdate=m,a.lastBaseUpdate=N,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Qs|=l,e.lanes=l,e.memoizedState=v}}function Ed(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(z(191,a));a.call(r)}}}var qa={},Tn=Es(qa),Da=Es(qa),Ia=Es(qa);function Vs(e){if(e===qa)throw Error(z(174));return e}function fu(e,t){switch(Re(Ia,t),Re(Da,e),Re(Tn,qa),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Qo(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Qo(t,e)}De(Tn),Re(Tn,t)}function Or(){De(Tn),De(Da),De(Ia)}function Bf(e){Vs(Ia.current);var t=Vs(Tn.current),n=Qo(t,e.type);t!==n&&(Re(Da,e),Re(Tn,n))}function pu(e){Da.current===e&&(De(Tn),De(Da))}var $e=Es(0);function pl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var So=[];function mu(){for(var e=0;e<So.length;e++)So[e]._workInProgressVersionPrimary=null;So.length=0}var Vi=Yn.ReactCurrentDispatcher,ko=Yn.ReactCurrentBatchConfig,Gs=0,Ue=null,nt=null,it=null,ml=!1,ja=!1,Ba=0,yv=0;function Nt(){throw Error(z(321))}function gu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!yn(e[n],t[n]))return!1;return!0}function vu(e,t,n,r,a,i){if(Gs=i,Ue=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Vi.current=e===null||e.memoizedState===null?_v:Sv,e=n(r,a),ja){i=0;do{if(ja=!1,Ba=0,25<=i)throw Error(z(301));i+=1,it=nt=null,t.updateQueue=null,Vi.current=kv,e=n(r,a)}while(ja)}if(Vi.current=gl,t=nt!==null&&nt.next!==null,Gs=0,it=nt=Ue=null,ml=!1,t)throw Error(z(300));return e}function xu(){var e=Ba!==0;return Ba=0,e}function bn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return it===null?Ue.memoizedState=it=e:it=it.next=e,it}function sn(){if(nt===null){var e=Ue.alternate;e=e!==null?e.memoizedState:null}else e=nt.next;var t=it===null?Ue.memoizedState:it.next;if(t!==null)it=t,nt=e;else{if(e===null)throw Error(z(310));nt=e,e={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},it===null?Ue.memoizedState=it=e:it=it.next=e}return it}function za(e,t){return typeof t=="function"?t(e):t}function bo(e){var t=sn(),n=t.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=e;var r=nt,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var c=l=null,u=null,m=i;do{var N=m.lane;if((Gs&N)===N)u!==null&&(u=u.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:e(r,m.action);else{var v={lane:N,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};u===null?(c=u=v,l=r):u=u.next=v,Ue.lanes|=N,Qs|=N}m=m.next}while(m!==null&&m!==i);u===null?l=r:u.next=c,yn(r,t.memoizedState)||(Mt=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do i=a.lane,Ue.lanes|=i,Qs|=i,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Co(e){var t=sn(),n=t.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(a!==null){n.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);yn(i,t.memoizedState)||(Mt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function zf(){}function $f(e,t){var n=Ue,r=sn(),a=t(),i=!yn(r.memoizedState,a);if(i&&(r.memoizedState=a,Mt=!0),r=r.queue,yu(Ff.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||it!==null&&it.memoizedState.tag&1){if(n.flags|=2048,$a(9,Vf.bind(null,n,r,a,t),void 0,null),lt===null)throw Error(z(349));Gs&30||Uf(n,t,a)}return a}function Uf(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ue.updateQueue,t===null?(t={lastEffect:null,stores:null},Ue.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Vf(e,t,n,r){t.value=n,t.getSnapshot=r,Wf(t)&&Hf(e)}function Ff(e,t,n){return n(function(){Wf(t)&&Hf(e)})}function Wf(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!yn(e,n)}catch{return!0}}function Hf(e){var t=Gn(e,1);t!==null&&xn(t,e,1,-1)}function Ad(e){var t=bn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:za,lastRenderedState:e},t.queue=e,e=e.dispatch=wv.bind(null,Ue,e),[t.memoizedState,e]}function $a(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ue.updateQueue,t===null?(t={lastEffect:null,stores:null},Ue.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function qf(){return sn().memoizedState}function Fi(e,t,n,r){var a=bn();Ue.flags|=e,a.memoizedState=$a(1|t,n,void 0,r===void 0?null:r)}function Ll(e,t,n,r){var a=sn();r=r===void 0?null:r;var i=void 0;if(nt!==null){var l=nt.memoizedState;if(i=l.destroy,r!==null&&gu(r,l.deps)){a.memoizedState=$a(t,n,i,r);return}}Ue.flags|=e,a.memoizedState=$a(1|t,n,i,r)}function Td(e,t){return Fi(8390656,8,e,t)}function yu(e,t){return Ll(2048,8,e,t)}function Gf(e,t){return Ll(4,2,e,t)}function Qf(e,t){return Ll(4,4,e,t)}function Yf(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Kf(e,t,n){return n=n!=null?n.concat([e]):null,Ll(4,4,Yf.bind(null,t,e),n)}function ju(){}function Xf(e,t){var n=sn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&gu(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Jf(e,t){var n=sn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&gu(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Zf(e,t,n){return Gs&21?(yn(n,t)||(n=sf(),Ue.lanes|=n,Qs|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Mt=!0),e.memoizedState=n)}function jv(e,t){var n=be;be=n!==0&&4>n?n:4,e(!0);var r=ko.transition;ko.transition={};try{e(!1),t()}finally{be=n,ko.transition=r}}function ep(){return sn().memoizedState}function Nv(e,t,n){var r=ws(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},tp(e))np(t,n);else if(n=Df(e,t,n,r),n!==null){var a=At();xn(n,e,r,a),sp(n,t,r)}}function wv(e,t,n){var r=ws(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(tp(e))np(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,c=i(l,n);if(a.hasEagerState=!0,a.eagerState=c,yn(c,l)){var u=t.interleaved;u===null?(a.next=a,du(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}n=Df(e,t,a,r),n!==null&&(a=At(),xn(n,e,r,a),sp(n,t,r))}}function tp(e){var t=e.alternate;return e===Ue||t!==null&&t===Ue}function np(e,t){ja=ml=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sp(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Xc(e,n)}}var gl={readContext:nn,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useInsertionEffect:Nt,useLayoutEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useMutableSource:Nt,useSyncExternalStore:Nt,useId:Nt,unstable_isNewReconciler:!1},_v={readContext:nn,useCallback:function(e,t){return bn().memoizedState=[e,t===void 0?null:t],e},useContext:nn,useEffect:Td,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Fi(4194308,4,Yf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fi(4,2,e,t)},useMemo:function(e,t){var n=bn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=bn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Nv.bind(null,Ue,e),[r.memoizedState,e]},useRef:function(e){var t=bn();return e={current:e},t.memoizedState=e},useState:Ad,useDebugValue:ju,useDeferredValue:function(e){return bn().memoizedState=e},useTransition:function(){var e=Ad(!1),t=e[0];return e=jv.bind(null,e[1]),bn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ue,a=bn();if(ze){if(n===void 0)throw Error(z(407));n=n()}else{if(n=t(),lt===null)throw Error(z(349));Gs&30||Uf(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,Td(Ff.bind(null,r,i,e),[e]),r.flags|=2048,$a(9,Vf.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=bn(),t=lt.identifierPrefix;if(ze){var n=Fn,r=Vn;n=(r&~(1<<32-vn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ba++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=yv++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Sv={readContext:nn,useCallback:Xf,useContext:nn,useEffect:yu,useImperativeHandle:Kf,useInsertionEffect:Gf,useLayoutEffect:Qf,useMemo:Jf,useReducer:bo,useRef:qf,useState:function(){return bo(za)},useDebugValue:ju,useDeferredValue:function(e){var t=sn();return Zf(t,nt.memoizedState,e)},useTransition:function(){var e=bo(za)[0],t=sn().memoizedState;return[e,t]},useMutableSource:zf,useSyncExternalStore:$f,useId:ep,unstable_isNewReconciler:!1},kv={readContext:nn,useCallback:Xf,useContext:nn,useEffect:yu,useImperativeHandle:Kf,useInsertionEffect:Gf,useLayoutEffect:Qf,useMemo:Jf,useReducer:Co,useRef:qf,useState:function(){return Co(za)},useDebugValue:ju,useDeferredValue:function(e){var t=sn();return nt===null?t.memoizedState=e:Zf(t,nt.memoizedState,e)},useTransition:function(){var e=Co(za)[0],t=sn().memoizedState;return[e,t]},useMutableSource:zf,useSyncExternalStore:$f,useId:ep,unstable_isNewReconciler:!1};function fn(e,t){if(e&&e.defaultProps){t=Ve({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function mc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Ve({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Rl={isMounted:function(e){return(e=e._reactInternals)?Xs(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=At(),a=ws(e),i=Wn(r,a);i.payload=t,n!=null&&(i.callback=n),t=js(e,i,a),t!==null&&(xn(t,e,a,r),Ui(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=At(),a=ws(e),i=Wn(r,a);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=js(e,i,a),t!==null&&(xn(t,e,a,r),Ui(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=At(),r=ws(e),a=Wn(n,r);a.tag=2,t!=null&&(a.callback=t),t=js(e,a,r),t!==null&&(xn(t,e,r,n),Ui(t,e,r))}};function Ld(e,t,n,r,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,l):t.prototype&&t.prototype.isPureReactComponent?!Ra(n,r)||!Ra(a,i):!0}function rp(e,t,n){var r=!1,a=bs,i=t.contextType;return typeof i=="object"&&i!==null?i=nn(i):(a=It(t)?Hs:St.current,r=t.contextTypes,i=(r=r!=null)?Tr(e,a):bs),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Rl,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Rd(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Rl.enqueueReplaceState(t,t.state,null)}function gc(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},hu(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=nn(i):(i=It(t)?Hs:St.current,a.context=Tr(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(mc(e,t,i,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Rl.enqueueReplaceState(a,a.state,null),fl(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Pr(e,t){try{var n="",r=t;do n+=Zm(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Eo(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function vc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var bv=typeof WeakMap=="function"?WeakMap:Map;function ap(e,t,n){n=Wn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){xl||(xl=!0,Cc=r),vc(e,t)},n}function ip(e,t,n){n=Wn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){vc(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){vc(e,t),typeof r!="function"&&(Ns===null?Ns=new Set([this]):Ns.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function Od(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new bv;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=$v.bind(null,e,t,n),t.then(e,e))}function Pd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Md(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Wn(-1,1),t.tag=2,js(n,t,1))),n.lanes|=1),e)}var Cv=Yn.ReactCurrentOwner,Mt=!1;function Et(e,t,n,r){t.child=e===null?Mf(t,null,n,r):Rr(t,e.child,n,r)}function Dd(e,t,n,r,a){n=n.render;var i=t.ref;return Cr(t,a),r=vu(e,t,n,r,i,a),n=xu(),e!==null&&!Mt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Qn(e,t,a)):(ze&&n&&au(t),t.flags|=1,Et(e,t,r,a),t.child)}function Id(e,t,n,r,a){if(e===null){var i=n.type;return typeof i=="function"&&!Eu(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,lp(e,t,i,r,a)):(e=Gi(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ra,n(l,r)&&e.ref===t.ref)return Qn(e,t,a)}return t.flags|=1,e=_s(i,r),e.ref=t.ref,e.return=t,t.child=e}function lp(e,t,n,r,a){if(e!==null){var i=e.memoizedProps;if(Ra(i,r)&&e.ref===t.ref)if(Mt=!1,t.pendingProps=r=i,(e.lanes&a)!==0)e.flags&131072&&(Mt=!0);else return t.lanes=e.lanes,Qn(e,t,a)}return xc(e,t,n,r,a)}function op(e,t,n){var r=t.pendingProps,a=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Re(wr,Ft),Ft|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Re(wr,Ft),Ft|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Re(wr,Ft),Ft|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Re(wr,Ft),Ft|=r;return Et(e,t,a,n),t.child}function cp(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function xc(e,t,n,r,a){var i=It(n)?Hs:St.current;return i=Tr(t,i),Cr(t,a),n=vu(e,t,n,r,i,a),r=xu(),e!==null&&!Mt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Qn(e,t,a)):(ze&&r&&au(t),t.flags|=1,Et(e,t,n,a),t.child)}function Bd(e,t,n,r,a){if(It(n)){var i=!0;ol(t)}else i=!1;if(Cr(t,a),t.stateNode===null)Wi(e,t),rp(t,n,r),gc(t,n,r,a),r=!0;else if(e===null){var l=t.stateNode,c=t.memoizedProps;l.props=c;var u=l.context,m=n.contextType;typeof m=="object"&&m!==null?m=nn(m):(m=It(n)?Hs:St.current,m=Tr(t,m));var N=n.getDerivedStateFromProps,v=typeof N=="function"||typeof l.getSnapshotBeforeUpdate=="function";v||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==r||u!==m)&&Rd(t,l,r,m),ds=!1;var x=t.memoizedState;l.state=x,fl(t,r,l,a),u=t.memoizedState,c!==r||x!==u||Dt.current||ds?(typeof N=="function"&&(mc(t,n,N,r),u=t.memoizedState),(c=ds||Ld(t,n,c,r,x,u,m))?(v||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),l.props=r,l.state=u,l.context=m,r=c):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,If(e,t),c=t.memoizedProps,m=t.type===t.elementType?c:fn(t.type,c),l.props=m,v=t.pendingProps,x=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=nn(u):(u=It(n)?Hs:St.current,u=Tr(t,u));var C=n.getDerivedStateFromProps;(N=typeof C=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==v||x!==u)&&Rd(t,l,r,u),ds=!1,x=t.memoizedState,l.state=x,fl(t,r,l,a);var L=t.memoizedState;c!==v||x!==L||Dt.current||ds?(typeof C=="function"&&(mc(t,n,C,r),L=t.memoizedState),(m=ds||Ld(t,n,m,r,x,L,u)||!1)?(N||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,L,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,L,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=L),l.props=r,l.state=L,l.context=u,r=m):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),r=!1)}return yc(e,t,n,r,i,a)}function yc(e,t,n,r,a,i){cp(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return a&&_d(t,n,!1),Qn(e,t,i);r=t.stateNode,Cv.current=t;var c=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=Rr(t,e.child,null,i),t.child=Rr(t,null,c,i)):Et(e,t,c,i),t.memoizedState=r.state,a&&_d(t,n,!0),t.child}function up(e){var t=e.stateNode;t.pendingContext?wd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&wd(e,t.context,!1),fu(e,t.containerInfo)}function zd(e,t,n,r,a){return Lr(),lu(a),t.flags|=256,Et(e,t,n,r),t.child}var jc={dehydrated:null,treeContext:null,retryLane:0};function Nc(e){return{baseLanes:e,cachePool:null,transitions:null}}function dp(e,t,n){var r=t.pendingProps,a=$e.current,i=!1,l=(t.flags&128)!==0,c;if((c=l)||(c=e!==null&&e.memoizedState===null?!1:(a&2)!==0),c?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Re($e,a&1),e===null)return fc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,i?(r=t.mode,i=t.child,l={mode:"hidden",children:l},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Ml(l,r,0,null),e=Ws(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Nc(n),t.memoizedState=jc,e):Nu(t,l));if(a=e.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return Ev(e,t,l,r,c,a,n);if(i){i=r.fallback,l=t.mode,a=e.child,c=a.sibling;var u={mode:"hidden",children:r.children};return!(l&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=_s(a,u),r.subtreeFlags=a.subtreeFlags&14680064),c!==null?i=_s(c,i):(i=Ws(i,l,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,l=e.child.memoizedState,l=l===null?Nc(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=jc,r}return i=e.child,e=i.sibling,r=_s(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Nu(e,t){return t=Ml({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ei(e,t,n,r){return r!==null&&lu(r),Rr(t,e.child,null,n),e=Nu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ev(e,t,n,r,a,i,l){if(n)return t.flags&256?(t.flags&=-257,r=Eo(Error(z(422))),Ei(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=Ml({mode:"visible",children:r.children},a,0,null),i=Ws(i,a,l,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Rr(t,e.child,null,l),t.child.memoizedState=Nc(l),t.memoizedState=jc,i);if(!(t.mode&1))return Ei(e,t,l,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(z(419)),r=Eo(i,r,void 0),Ei(e,t,l,r)}if(c=(l&e.childLanes)!==0,Mt||c){if(r=lt,r!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Gn(e,a),xn(r,e,a,-1))}return Cu(),r=Eo(Error(z(421))),Ei(e,t,l,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Uv.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Wt=ys(a.nextSibling),Ht=t,ze=!0,gn=null,e!==null&&(Xt[Jt++]=Vn,Xt[Jt++]=Fn,Xt[Jt++]=qs,Vn=e.id,Fn=e.overflow,qs=t),t=Nu(t,r.children),t.flags|=4096,t)}function $d(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),pc(e.return,t,n)}function Ao(e,t,n,r,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function hp(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Et(e,t,r.children,n),r=$e.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$d(e,n,t);else if(e.tag===19)$d(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Re($e,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&pl(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ao(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&pl(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ao(t,!0,n,null,i);break;case"together":Ao(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wi(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Qs|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(z(153));if(t.child!==null){for(e=t.child,n=_s(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=_s(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Av(e,t,n){switch(t.tag){case 3:up(t),Lr();break;case 5:Bf(t);break;case 1:It(t.type)&&ol(t);break;case 4:fu(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Re(dl,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Re($e,$e.current&1),t.flags|=128,null):n&t.child.childLanes?dp(e,t,n):(Re($e,$e.current&1),e=Qn(e,t,n),e!==null?e.sibling:null);Re($e,$e.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return hp(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Re($e,$e.current),r)break;return null;case 22:case 23:return t.lanes=0,op(e,t,n)}return Qn(e,t,n)}var fp,wc,pp,mp;fp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};wc=function(){};pp=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Vs(Tn.current);var i=null;switch(n){case"input":a=Wo(e,a),r=Wo(e,r),i=[];break;case"select":a=Ve({},a,{value:void 0}),r=Ve({},r,{value:void 0}),i=[];break;case"textarea":a=Go(e,a),r=Go(e,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=il)}Yo(n,r);var l;n=null;for(m in a)if(!r.hasOwnProperty(m)&&a.hasOwnProperty(m)&&a[m]!=null)if(m==="style"){var c=a[m];for(l in c)c.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(ka.hasOwnProperty(m)?i||(i=[]):(i=i||[]).push(m,null));for(m in r){var u=r[m];if(c=a!=null?a[m]:void 0,r.hasOwnProperty(m)&&u!==c&&(u!=null||c!=null))if(m==="style")if(c){for(l in c)!c.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&c[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(i||(i=[]),i.push(m,n)),n=u;else m==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(m,u)):m==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(m,""+u):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(ka.hasOwnProperty(m)?(u!=null&&m==="onScroll"&&Me("scroll",e),i||c===u||(i=[])):(i=i||[]).push(m,u))}n&&(i=i||[]).push("style",n);var m=i;(t.updateQueue=m)&&(t.flags|=4)}};mp=function(e,t,n,r){n!==r&&(t.flags|=4)};function la(e,t){if(!ze)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function wt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Tv(e,t,n){var r=t.pendingProps;switch(iu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wt(t),null;case 1:return It(t.type)&&ll(),wt(t),null;case 3:return r=t.stateNode,Or(),De(Dt),De(St),mu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(bi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,gn!==null&&(Tc(gn),gn=null))),wc(e,t),wt(t),null;case 5:pu(t);var a=Vs(Ia.current);if(n=t.type,e!==null&&t.stateNode!=null)pp(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(z(166));return wt(t),null}if(e=Vs(Tn.current),bi(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[En]=t,r[Ma]=i,e=(t.mode&1)!==0,n){case"dialog":Me("cancel",r),Me("close",r);break;case"iframe":case"object":case"embed":Me("load",r);break;case"video":case"audio":for(a=0;a<fa.length;a++)Me(fa[a],r);break;case"source":Me("error",r);break;case"img":case"image":case"link":Me("error",r),Me("load",r);break;case"details":Me("toggle",r);break;case"input":Yu(r,i),Me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Me("invalid",r);break;case"textarea":Xu(r,i),Me("invalid",r)}Yo(n,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&ki(r.textContent,c,e),a=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&ki(r.textContent,c,e),a=["children",""+c]):ka.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&Me("scroll",r)}switch(n){case"input":vi(r),Ku(r,i,!0);break;case"textarea":vi(r),Ju(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=il)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Vh(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[En]=t,e[Ma]=r,fp(e,t,!1,!1),t.stateNode=e;e:{switch(l=Ko(n,r),n){case"dialog":Me("cancel",e),Me("close",e),a=r;break;case"iframe":case"object":case"embed":Me("load",e),a=r;break;case"video":case"audio":for(a=0;a<fa.length;a++)Me(fa[a],e);a=r;break;case"source":Me("error",e),a=r;break;case"img":case"image":case"link":Me("error",e),Me("load",e),a=r;break;case"details":Me("toggle",e),a=r;break;case"input":Yu(e,r),a=Wo(e,r),Me("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Ve({},r,{value:void 0}),Me("invalid",e);break;case"textarea":Xu(e,r),a=Go(e,r),Me("invalid",e);break;default:a=r}Yo(n,a),c=a;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?Hh(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Fh(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ba(e,u):typeof u=="number"&&ba(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ka.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Me("scroll",e):u!=null&&Hc(e,i,u,l))}switch(n){case"input":vi(e),Ku(e,r,!1);break;case"textarea":vi(e),Ju(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ks(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?_r(e,!!r.multiple,i,!1):r.defaultValue!=null&&_r(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=il)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return wt(t),null;case 6:if(e&&t.stateNode!=null)mp(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(z(166));if(n=Vs(Ia.current),Vs(Tn.current),bi(t)){if(r=t.stateNode,n=t.memoizedProps,r[En]=t,(i=r.nodeValue!==n)&&(e=Ht,e!==null))switch(e.tag){case 3:ki(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ki(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[En]=t,t.stateNode=r}return wt(t),null;case 13:if(De($e),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ze&&Wt!==null&&t.mode&1&&!(t.flags&128))Of(),Lr(),t.flags|=98560,i=!1;else if(i=bi(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(z(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(z(317));i[En]=t}else Lr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;wt(t),i=!1}else gn!==null&&(Tc(gn),gn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||$e.current&1?st===0&&(st=3):Cu())),t.updateQueue!==null&&(t.flags|=4),wt(t),null);case 4:return Or(),wc(e,t),e===null&&Oa(t.stateNode.containerInfo),wt(t),null;case 10:return uu(t.type._context),wt(t),null;case 17:return It(t.type)&&ll(),wt(t),null;case 19:if(De($e),i=t.memoizedState,i===null)return wt(t),null;if(r=(t.flags&128)!==0,l=i.rendering,l===null)if(r)la(i,!1);else{if(st!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=pl(e),l!==null){for(t.flags|=128,la(i,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Re($e,$e.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ge()>Mr&&(t.flags|=128,r=!0,la(i,!1),t.lanes=4194304)}else{if(!r)if(e=pl(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),la(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!ze)return wt(t),null}else 2*Ge()-i.renderingStartTime>Mr&&n!==1073741824&&(t.flags|=128,r=!0,la(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(n=i.last,n!==null?n.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ge(),t.sibling=null,n=$e.current,Re($e,r?n&1|2:n&1),t):(wt(t),null);case 22:case 23:return bu(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Ft&1073741824&&(wt(t),t.subtreeFlags&6&&(t.flags|=8192)):wt(t),null;case 24:return null;case 25:return null}throw Error(z(156,t.tag))}function Lv(e,t){switch(iu(t),t.tag){case 1:return It(t.type)&&ll(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Or(),De(Dt),De(St),mu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return pu(t),null;case 13:if(De($e),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(z(340));Lr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return De($e),null;case 4:return Or(),null;case 10:return uu(t.type._context),null;case 22:case 23:return bu(),null;case 24:return null;default:return null}}var Ai=!1,_t=!1,Rv=typeof WeakSet=="function"?WeakSet:Set,Y=null;function Nr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qe(e,t,r)}else n.current=null}function _c(e,t,n){try{n()}catch(r){qe(e,t,r)}}var Ud=!1;function Ov(e,t){if(ic=sl,e=jf(),ru(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var l=0,c=-1,u=-1,m=0,N=0,v=e,x=null;t:for(;;){for(var C;v!==n||a!==0&&v.nodeType!==3||(c=l+a),v!==i||r!==0&&v.nodeType!==3||(u=l+r),v.nodeType===3&&(l+=v.nodeValue.length),(C=v.firstChild)!==null;)x=v,v=C;for(;;){if(v===e)break t;if(x===n&&++m===a&&(c=l),x===i&&++N===r&&(u=l),(C=v.nextSibling)!==null)break;v=x,x=v.parentNode}v=C}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(lc={focusedElem:e,selectionRange:n},sl=!1,Y=t;Y!==null;)if(t=Y,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Y=e;else for(;Y!==null;){t=Y;try{var L=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(L!==null){var R=L.memoizedProps,g=L.memoizedState,h=t.stateNode,p=h.getSnapshotBeforeUpdate(t.elementType===t.type?R:fn(t.type,R),g);h.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(S){qe(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,Y=e;break}Y=t.return}return L=Ud,Ud=!1,L}function Na(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&_c(t,n,i)}a=a.next}while(a!==r)}}function Ol(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Sc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function gp(e){var t=e.alternate;t!==null&&(e.alternate=null,gp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[En],delete t[Ma],delete t[uc],delete t[mv],delete t[gv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function vp(e){return e.tag===5||e.tag===3||e.tag===4}function Vd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||vp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function kc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=il));else if(r!==4&&(e=e.child,e!==null))for(kc(e,t,n),e=e.sibling;e!==null;)kc(e,t,n),e=e.sibling}function bc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(bc(e,t,n),e=e.sibling;e!==null;)bc(e,t,n),e=e.sibling}var pt=null,pn=!1;function cs(e,t,n){for(n=n.child;n!==null;)xp(e,t,n),n=n.sibling}function xp(e,t,n){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(kl,n)}catch{}switch(n.tag){case 5:_t||Nr(n,t);case 6:var r=pt,a=pn;pt=null,cs(e,t,n),pt=r,pn=a,pt!==null&&(pn?(e=pt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):pt.removeChild(n.stateNode));break;case 18:pt!==null&&(pn?(e=pt,n=n.stateNode,e.nodeType===8?wo(e.parentNode,n):e.nodeType===1&&wo(e,n),Ta(e)):wo(pt,n.stateNode));break;case 4:r=pt,a=pn,pt=n.stateNode.containerInfo,pn=!0,cs(e,t,n),pt=r,pn=a;break;case 0:case 11:case 14:case 15:if(!_t&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&_c(n,t,l),a=a.next}while(a!==r)}cs(e,t,n);break;case 1:if(!_t&&(Nr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){qe(n,t,c)}cs(e,t,n);break;case 21:cs(e,t,n);break;case 22:n.mode&1?(_t=(r=_t)||n.memoizedState!==null,cs(e,t,n),_t=r):cs(e,t,n);break;default:cs(e,t,n)}}function Fd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Rv),t.forEach(function(r){var a=Vv.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function hn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,l=t,c=l;e:for(;c!==null;){switch(c.tag){case 5:pt=c.stateNode,pn=!1;break e;case 3:pt=c.stateNode.containerInfo,pn=!0;break e;case 4:pt=c.stateNode.containerInfo,pn=!0;break e}c=c.return}if(pt===null)throw Error(z(160));xp(i,l,a),pt=null,pn=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(m){qe(a,t,m)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)yp(t,e),t=t.sibling}function yp(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hn(t,e),kn(e),r&4){try{Na(3,e,e.return),Ol(3,e)}catch(R){qe(e,e.return,R)}try{Na(5,e,e.return)}catch(R){qe(e,e.return,R)}}break;case 1:hn(t,e),kn(e),r&512&&n!==null&&Nr(n,n.return);break;case 5:if(hn(t,e),kn(e),r&512&&n!==null&&Nr(n,n.return),e.flags&32){var a=e.stateNode;try{ba(a,"")}catch(R){qe(e,e.return,R)}}if(r&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=n!==null?n.memoizedProps:i,c=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&$h(a,i),Ko(c,l);var m=Ko(c,i);for(l=0;l<u.length;l+=2){var N=u[l],v=u[l+1];N==="style"?Hh(a,v):N==="dangerouslySetInnerHTML"?Fh(a,v):N==="children"?ba(a,v):Hc(a,N,v,m)}switch(c){case"input":Ho(a,i);break;case"textarea":Uh(a,i);break;case"select":var x=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var C=i.value;C!=null?_r(a,!!i.multiple,C,!1):x!==!!i.multiple&&(i.defaultValue!=null?_r(a,!!i.multiple,i.defaultValue,!0):_r(a,!!i.multiple,i.multiple?[]:"",!1))}a[Ma]=i}catch(R){qe(e,e.return,R)}}break;case 6:if(hn(t,e),kn(e),r&4){if(e.stateNode===null)throw Error(z(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(R){qe(e,e.return,R)}}break;case 3:if(hn(t,e),kn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ta(t.containerInfo)}catch(R){qe(e,e.return,R)}break;case 4:hn(t,e),kn(e);break;case 13:hn(t,e),kn(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Su=Ge())),r&4&&Fd(e);break;case 22:if(N=n!==null&&n.memoizedState!==null,e.mode&1?(_t=(m=_t)||N,hn(t,e),_t=m):hn(t,e),kn(e),r&8192){if(m=e.memoizedState!==null,(e.stateNode.isHidden=m)&&!N&&e.mode&1)for(Y=e,N=e.child;N!==null;){for(v=Y=N;Y!==null;){switch(x=Y,C=x.child,x.tag){case 0:case 11:case 14:case 15:Na(4,x,x.return);break;case 1:Nr(x,x.return);var L=x.stateNode;if(typeof L.componentWillUnmount=="function"){r=x,n=x.return;try{t=r,L.props=t.memoizedProps,L.state=t.memoizedState,L.componentWillUnmount()}catch(R){qe(r,n,R)}}break;case 5:Nr(x,x.return);break;case 22:if(x.memoizedState!==null){Hd(v);continue}}C!==null?(C.return=x,Y=C):Hd(v)}N=N.sibling}e:for(N=null,v=e;;){if(v.tag===5){if(N===null){N=v;try{a=v.stateNode,m?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=v.stateNode,u=v.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=Wh("display",l))}catch(R){qe(e,e.return,R)}}}else if(v.tag===6){if(N===null)try{v.stateNode.nodeValue=m?"":v.memoizedProps}catch(R){qe(e,e.return,R)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===e)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===e)break e;for(;v.sibling===null;){if(v.return===null||v.return===e)break e;N===v&&(N=null),v=v.return}N===v&&(N=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:hn(t,e),kn(e),r&4&&Fd(e);break;case 21:break;default:hn(t,e),kn(e)}}function kn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(vp(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(ba(a,""),r.flags&=-33);var i=Vd(e);bc(e,i,a);break;case 3:case 4:var l=r.stateNode.containerInfo,c=Vd(e);kc(e,c,l);break;default:throw Error(z(161))}}catch(u){qe(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Pv(e,t,n){Y=e,jp(e)}function jp(e,t,n){for(var r=(e.mode&1)!==0;Y!==null;){var a=Y,i=a.child;if(a.tag===22&&r){var l=a.memoizedState!==null||Ai;if(!l){var c=a.alternate,u=c!==null&&c.memoizedState!==null||_t;c=Ai;var m=_t;if(Ai=l,(_t=u)&&!m)for(Y=a;Y!==null;)l=Y,u=l.child,l.tag===22&&l.memoizedState!==null?qd(a):u!==null?(u.return=l,Y=u):qd(a);for(;i!==null;)Y=i,jp(i),i=i.sibling;Y=a,Ai=c,_t=m}Wd(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Y=i):Wd(e)}}function Wd(e){for(;Y!==null;){var t=Y;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:_t||Ol(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!_t)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:fn(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Ed(t,i,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Ed(t,l,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var m=t.alternate;if(m!==null){var N=m.memoizedState;if(N!==null){var v=N.dehydrated;v!==null&&Ta(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}_t||t.flags&512&&Sc(t)}catch(x){qe(t,t.return,x)}}if(t===e){Y=null;break}if(n=t.sibling,n!==null){n.return=t.return,Y=n;break}Y=t.return}}function Hd(e){for(;Y!==null;){var t=Y;if(t===e){Y=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Y=n;break}Y=t.return}}function qd(e){for(;Y!==null;){var t=Y;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ol(4,t)}catch(u){qe(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(u){qe(t,a,u)}}var i=t.return;try{Sc(t)}catch(u){qe(t,i,u)}break;case 5:var l=t.return;try{Sc(t)}catch(u){qe(t,l,u)}}}catch(u){qe(t,t.return,u)}if(t===e){Y=null;break}var c=t.sibling;if(c!==null){c.return=t.return,Y=c;break}Y=t.return}}var Mv=Math.ceil,vl=Yn.ReactCurrentDispatcher,wu=Yn.ReactCurrentOwner,tn=Yn.ReactCurrentBatchConfig,we=0,lt=null,Xe=null,mt=0,Ft=0,wr=Es(0),st=0,Ua=null,Qs=0,Pl=0,_u=0,wa=null,Pt=null,Su=0,Mr=1/0,zn=null,xl=!1,Cc=null,Ns=null,Ti=!1,ms=null,yl=0,_a=0,Ec=null,Hi=-1,qi=0;function At(){return we&6?Ge():Hi!==-1?Hi:Hi=Ge()}function ws(e){return e.mode&1?we&2&&mt!==0?mt&-mt:xv.transition!==null?(qi===0&&(qi=sf()),qi):(e=be,e!==0||(e=window.event,e=e===void 0?16:df(e.type)),e):1}function xn(e,t,n,r){if(50<_a)throw _a=0,Ec=null,Error(z(185));Fa(e,n,r),(!(we&2)||e!==lt)&&(e===lt&&(!(we&2)&&(Pl|=n),st===4&&fs(e,mt)),Bt(e,r),n===1&&we===0&&!(t.mode&1)&&(Mr=Ge()+500,Tl&&As()))}function Bt(e,t){var n=e.callbackNode;xg(e,t);var r=nl(e,e===lt?mt:0);if(r===0)n!==null&&td(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&td(n),t===1)e.tag===0?vv(Gd.bind(null,e)):Tf(Gd.bind(null,e)),fv(function(){!(we&6)&&As()}),n=null;else{switch(rf(r)){case 1:n=Kc;break;case 4:n=tf;break;case 16:n=tl;break;case 536870912:n=nf;break;default:n=tl}n=Ep(n,Np.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Np(e,t){if(Hi=-1,qi=0,we&6)throw Error(z(327));var n=e.callbackNode;if(Er()&&e.callbackNode!==n)return null;var r=nl(e,e===lt?mt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=jl(e,r);else{t=r;var a=we;we|=2;var i=_p();(lt!==e||mt!==t)&&(zn=null,Mr=Ge()+500,Fs(e,t));do try{Bv();break}catch(c){wp(e,c)}while(!0);cu(),vl.current=i,we=a,Xe!==null?t=0:(lt=null,mt=0,t=st)}if(t!==0){if(t===2&&(a=tc(e),a!==0&&(r=a,t=Ac(e,a))),t===1)throw n=Ua,Fs(e,0),fs(e,r),Bt(e,Ge()),n;if(t===6)fs(e,r);else{if(a=e.current.alternate,!(r&30)&&!Dv(a)&&(t=jl(e,r),t===2&&(i=tc(e),i!==0&&(r=i,t=Ac(e,i))),t===1))throw n=Ua,Fs(e,0),fs(e,r),Bt(e,Ge()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(z(345));case 2:zs(e,Pt,zn);break;case 3:if(fs(e,r),(r&130023424)===r&&(t=Su+500-Ge(),10<t)){if(nl(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){At(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=cc(zs.bind(null,e,Pt,zn),t);break}zs(e,Pt,zn);break;case 4:if(fs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var l=31-vn(r);i=1<<l,l=t[l],l>a&&(a=l),r&=~i}if(r=a,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Mv(r/1960))-r,10<r){e.timeoutHandle=cc(zs.bind(null,e,Pt,zn),r);break}zs(e,Pt,zn);break;case 5:zs(e,Pt,zn);break;default:throw Error(z(329))}}}return Bt(e,Ge()),e.callbackNode===n?Np.bind(null,e):null}function Ac(e,t){var n=wa;return e.current.memoizedState.isDehydrated&&(Fs(e,t).flags|=256),e=jl(e,t),e!==2&&(t=Pt,Pt=n,t!==null&&Tc(t)),e}function Tc(e){Pt===null?Pt=e:Pt.push.apply(Pt,e)}function Dv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!yn(i(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function fs(e,t){for(t&=~_u,t&=~Pl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-vn(t),r=1<<n;e[n]=-1,t&=~r}}function Gd(e){if(we&6)throw Error(z(327));Er();var t=nl(e,0);if(!(t&1))return Bt(e,Ge()),null;var n=jl(e,t);if(e.tag!==0&&n===2){var r=tc(e);r!==0&&(t=r,n=Ac(e,r))}if(n===1)throw n=Ua,Fs(e,0),fs(e,t),Bt(e,Ge()),n;if(n===6)throw Error(z(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,zs(e,Pt,zn),Bt(e,Ge()),null}function ku(e,t){var n=we;we|=1;try{return e(t)}finally{we=n,we===0&&(Mr=Ge()+500,Tl&&As())}}function Ys(e){ms!==null&&ms.tag===0&&!(we&6)&&Er();var t=we;we|=1;var n=tn.transition,r=be;try{if(tn.transition=null,be=1,e)return e()}finally{be=r,tn.transition=n,we=t,!(we&6)&&As()}}function bu(){Ft=wr.current,De(wr)}function Fs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,hv(n)),Xe!==null)for(n=Xe.return;n!==null;){var r=n;switch(iu(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ll();break;case 3:Or(),De(Dt),De(St),mu();break;case 5:pu(r);break;case 4:Or();break;case 13:De($e);break;case 19:De($e);break;case 10:uu(r.type._context);break;case 22:case 23:bu()}n=n.return}if(lt=e,Xe=e=_s(e.current,null),mt=Ft=t,st=0,Ua=null,_u=Pl=Qs=0,Pt=wa=null,Us!==null){for(t=0;t<Us.length;t++)if(n=Us[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var l=i.next;i.next=a,r.next=l}n.pending=r}Us=null}return e}function wp(e,t){do{var n=Xe;try{if(cu(),Vi.current=gl,ml){for(var r=Ue.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}ml=!1}if(Gs=0,it=nt=Ue=null,ja=!1,Ba=0,wu.current=null,n===null||n.return===null){st=1,Ua=t,Xe=null;break}e:{var i=e,l=n.return,c=n,u=t;if(t=mt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var m=u,N=c,v=N.tag;if(!(N.mode&1)&&(v===0||v===11||v===15)){var x=N.alternate;x?(N.updateQueue=x.updateQueue,N.memoizedState=x.memoizedState,N.lanes=x.lanes):(N.updateQueue=null,N.memoizedState=null)}var C=Pd(l);if(C!==null){C.flags&=-257,Md(C,l,c,i,t),C.mode&1&&Od(i,m,t),t=C,u=m;var L=t.updateQueue;if(L===null){var R=new Set;R.add(u),t.updateQueue=R}else L.add(u);break e}else{if(!(t&1)){Od(i,m,t),Cu();break e}u=Error(z(426))}}else if(ze&&c.mode&1){var g=Pd(l);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Md(g,l,c,i,t),lu(Pr(u,c));break e}}i=u=Pr(u,c),st!==4&&(st=2),wa===null?wa=[i]:wa.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var h=ap(i,u,t);Cd(i,h);break e;case 1:c=u;var p=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ns===null||!Ns.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var S=ip(i,c,t);Cd(i,S);break e}}i=i.return}while(i!==null)}kp(n)}catch(D){t=D,Xe===n&&n!==null&&(Xe=n=n.return);continue}break}while(!0)}function _p(){var e=vl.current;return vl.current=gl,e===null?gl:e}function Cu(){(st===0||st===3||st===2)&&(st=4),lt===null||!(Qs&268435455)&&!(Pl&268435455)||fs(lt,mt)}function jl(e,t){var n=we;we|=2;var r=_p();(lt!==e||mt!==t)&&(zn=null,Fs(e,t));do try{Iv();break}catch(a){wp(e,a)}while(!0);if(cu(),we=n,vl.current=r,Xe!==null)throw Error(z(261));return lt=null,mt=0,st}function Iv(){for(;Xe!==null;)Sp(Xe)}function Bv(){for(;Xe!==null&&!cg();)Sp(Xe)}function Sp(e){var t=Cp(e.alternate,e,Ft);e.memoizedProps=e.pendingProps,t===null?kp(e):Xe=t,wu.current=null}function kp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Lv(n,t),n!==null){n.flags&=32767,Xe=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{st=6,Xe=null;return}}else if(n=Tv(n,t,Ft),n!==null){Xe=n;return}if(t=t.sibling,t!==null){Xe=t;return}Xe=t=e}while(t!==null);st===0&&(st=5)}function zs(e,t,n){var r=be,a=tn.transition;try{tn.transition=null,be=1,zv(e,t,n,r)}finally{tn.transition=a,be=r}return null}function zv(e,t,n,r){do Er();while(ms!==null);if(we&6)throw Error(z(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(z(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(yg(e,i),e===lt&&(Xe=lt=null,mt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ti||(Ti=!0,Ep(tl,function(){return Er(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=tn.transition,tn.transition=null;var l=be;be=1;var c=we;we|=4,wu.current=null,Ov(e,n),yp(n,e),av(lc),sl=!!ic,lc=ic=null,e.current=n,Pv(n),ug(),we=c,be=l,tn.transition=i}else e.current=n;if(Ti&&(Ti=!1,ms=e,yl=a),i=e.pendingLanes,i===0&&(Ns=null),fg(n.stateNode),Bt(e,Ge()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(xl)throw xl=!1,e=Cc,Cc=null,e;return yl&1&&e.tag!==0&&Er(),i=e.pendingLanes,i&1?e===Ec?_a++:(_a=0,Ec=e):_a=0,As(),null}function Er(){if(ms!==null){var e=rf(yl),t=tn.transition,n=be;try{if(tn.transition=null,be=16>e?16:e,ms===null)var r=!1;else{if(e=ms,ms=null,yl=0,we&6)throw Error(z(331));var a=we;for(we|=4,Y=e.current;Y!==null;){var i=Y,l=i.child;if(Y.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var m=c[u];for(Y=m;Y!==null;){var N=Y;switch(N.tag){case 0:case 11:case 15:Na(8,N,i)}var v=N.child;if(v!==null)v.return=N,Y=v;else for(;Y!==null;){N=Y;var x=N.sibling,C=N.return;if(gp(N),N===m){Y=null;break}if(x!==null){x.return=C,Y=x;break}Y=C}}}var L=i.alternate;if(L!==null){var R=L.child;if(R!==null){L.child=null;do{var g=R.sibling;R.sibling=null,R=g}while(R!==null)}}Y=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,Y=l;else e:for(;Y!==null;){if(i=Y,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Na(9,i,i.return)}var h=i.sibling;if(h!==null){h.return=i.return,Y=h;break e}Y=i.return}}var p=e.current;for(Y=p;Y!==null;){l=Y;var y=l.child;if(l.subtreeFlags&2064&&y!==null)y.return=l,Y=y;else e:for(l=p;Y!==null;){if(c=Y,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Ol(9,c)}}catch(D){qe(c,c.return,D)}if(c===l){Y=null;break e}var S=c.sibling;if(S!==null){S.return=c.return,Y=S;break e}Y=c.return}}if(we=a,As(),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(kl,e)}catch{}r=!0}return r}finally{be=n,tn.transition=t}}return!1}function Qd(e,t,n){t=Pr(n,t),t=ap(e,t,1),e=js(e,t,1),t=At(),e!==null&&(Fa(e,1,t),Bt(e,t))}function qe(e,t,n){if(e.tag===3)Qd(e,e,n);else for(;t!==null;){if(t.tag===3){Qd(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ns===null||!Ns.has(r))){e=Pr(n,e),e=ip(t,e,1),t=js(t,e,1),e=At(),t!==null&&(Fa(t,1,e),Bt(t,e));break}}t=t.return}}function $v(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=At(),e.pingedLanes|=e.suspendedLanes&n,lt===e&&(mt&n)===n&&(st===4||st===3&&(mt&130023424)===mt&&500>Ge()-Su?Fs(e,0):_u|=n),Bt(e,t)}function bp(e,t){t===0&&(e.mode&1?(t=ji,ji<<=1,!(ji&130023424)&&(ji=4194304)):t=1);var n=At();e=Gn(e,t),e!==null&&(Fa(e,t,n),Bt(e,n))}function Uv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),bp(e,n)}function Vv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(t),bp(e,n)}var Cp;Cp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Dt.current)Mt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Mt=!1,Av(e,t,n);Mt=!!(e.flags&131072)}else Mt=!1,ze&&t.flags&1048576&&Lf(t,ul,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wi(e,t),e=t.pendingProps;var a=Tr(t,St.current);Cr(t,n),a=vu(null,t,r,e,a,n);var i=xu();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,It(r)?(i=!0,ol(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,hu(t),a.updater=Rl,t.stateNode=a,a._reactInternals=t,gc(t,r,e,n),t=yc(null,t,r,!0,i,n)):(t.tag=0,ze&&i&&au(t),Et(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wi(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=Wv(r),e=fn(r,e),a){case 0:t=xc(null,t,r,e,n);break e;case 1:t=Bd(null,t,r,e,n);break e;case 11:t=Dd(null,t,r,e,n);break e;case 14:t=Id(null,t,r,fn(r.type,e),n);break e}throw Error(z(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:fn(r,a),xc(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:fn(r,a),Bd(e,t,r,a,n);case 3:e:{if(up(t),e===null)throw Error(z(387));r=t.pendingProps,i=t.memoizedState,a=i.element,If(e,t),fl(t,r,null,n);var l=t.memoizedState;if(r=l.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Pr(Error(z(423)),t),t=zd(e,t,r,n,a);break e}else if(r!==a){a=Pr(Error(z(424)),t),t=zd(e,t,r,n,a);break e}else for(Wt=ys(t.stateNode.containerInfo.firstChild),Ht=t,ze=!0,gn=null,n=Mf(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Lr(),r===a){t=Qn(e,t,n);break e}Et(e,t,r,n)}t=t.child}return t;case 5:return Bf(t),e===null&&fc(t),r=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,oc(r,a)?l=null:i!==null&&oc(r,i)&&(t.flags|=32),cp(e,t),Et(e,t,l,n),t.child;case 6:return e===null&&fc(t),null;case 13:return dp(e,t,n);case 4:return fu(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Rr(t,null,r,n):Et(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:fn(r,a),Dd(e,t,r,a,n);case 7:return Et(e,t,t.pendingProps,n),t.child;case 8:return Et(e,t,t.pendingProps.children,n),t.child;case 12:return Et(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,Re(dl,r._currentValue),r._currentValue=l,i!==null)if(yn(i.value,l)){if(i.children===a.children&&!Dt.current){t=Qn(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var c=i.dependencies;if(c!==null){l=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Wn(-1,n&-n),u.tag=2;var m=i.updateQueue;if(m!==null){m=m.shared;var N=m.pending;N===null?u.next=u:(u.next=N.next,N.next=u),m.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),pc(i.return,n,t),c.lanes|=n;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(z(341));l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),pc(l,n,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}Et(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Cr(t,n),a=nn(a),r=r(a),t.flags|=1,Et(e,t,r,n),t.child;case 14:return r=t.type,a=fn(r,t.pendingProps),a=fn(r.type,a),Id(e,t,r,a,n);case 15:return lp(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:fn(r,a),Wi(e,t),t.tag=1,It(r)?(e=!0,ol(t)):e=!1,Cr(t,n),rp(t,r,a),gc(t,r,a,n),yc(null,t,r,!0,e,n);case 19:return hp(e,t,n);case 22:return op(e,t,n)}throw Error(z(156,t.tag))};function Ep(e,t){return ef(e,t)}function Fv(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(e,t,n,r){return new Fv(e,t,n,r)}function Eu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Wv(e){if(typeof e=="function")return Eu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Gc)return 11;if(e===Qc)return 14}return 2}function _s(e,t){var n=e.alternate;return n===null?(n=en(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Gi(e,t,n,r,a,i){var l=2;if(r=e,typeof e=="function")Eu(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case hr:return Ws(n.children,a,i,t);case qc:l=8,a|=8;break;case $o:return e=en(12,n,t,a|2),e.elementType=$o,e.lanes=i,e;case Uo:return e=en(13,n,t,a),e.elementType=Uo,e.lanes=i,e;case Vo:return e=en(19,n,t,a),e.elementType=Vo,e.lanes=i,e;case Ih:return Ml(n,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Mh:l=10;break e;case Dh:l=9;break e;case Gc:l=11;break e;case Qc:l=14;break e;case us:l=16,r=null;break e}throw Error(z(130,e==null?e:typeof e,""))}return t=en(l,n,t,a),t.elementType=e,t.type=r,t.lanes=i,t}function Ws(e,t,n,r){return e=en(7,e,r,t),e.lanes=n,e}function Ml(e,t,n,r){return e=en(22,e,r,t),e.elementType=Ih,e.lanes=n,e.stateNode={isHidden:!1},e}function To(e,t,n){return e=en(6,e,null,t),e.lanes=n,e}function Lo(e,t,n){return t=en(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Hv(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uo(0),this.expirationTimes=uo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uo(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Au(e,t,n,r,a,i,l,c,u){return e=new Hv(e,t,n,c,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=en(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hu(i),e}function qv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Ap(e){if(!e)return bs;e=e._reactInternals;e:{if(Xs(e)!==e||e.tag!==1)throw Error(z(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(It(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(z(171))}if(e.tag===1){var n=e.type;if(It(n))return Af(e,n,t)}return t}function Tp(e,t,n,r,a,i,l,c,u){return e=Au(n,r,!0,e,a,i,l,c,u),e.context=Ap(null),n=e.current,r=At(),a=ws(n),i=Wn(r,a),i.callback=t??null,js(n,i,a),e.current.lanes=a,Fa(e,a,r),Bt(e,r),e}function Dl(e,t,n,r){var a=t.current,i=At(),l=ws(a);return n=Ap(n),t.context===null?t.context=n:t.pendingContext=n,t=Wn(i,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=js(a,t,l),e!==null&&(xn(e,a,l,i),Ui(e,a,l)),l}function Nl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Yd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Tu(e,t){Yd(e,t),(e=e.alternate)&&Yd(e,t)}function Gv(){return null}var Lp=typeof reportError=="function"?reportError:function(e){console.error(e)};function Lu(e){this._internalRoot=e}Il.prototype.render=Lu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(z(409));Dl(e,t,null,null)};Il.prototype.unmount=Lu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ys(function(){Dl(null,e,null,null)}),t[qn]=null}};function Il(e){this._internalRoot=e}Il.prototype.unstable_scheduleHydration=function(e){if(e){var t=of();e={blockedOn:null,target:e,priority:t};for(var n=0;n<hs.length&&t!==0&&t<hs[n].priority;n++);hs.splice(n,0,e),n===0&&uf(e)}};function Ru(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Bl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Kd(){}function Qv(e,t,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var m=Nl(l);i.call(m)}}var l=Tp(t,r,e,0,null,!1,!1,"",Kd);return e._reactRootContainer=l,e[qn]=l.current,Oa(e.nodeType===8?e.parentNode:e),Ys(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var c=r;r=function(){var m=Nl(u);c.call(m)}}var u=Au(e,0,!1,null,null,!1,!1,"",Kd);return e._reactRootContainer=u,e[qn]=u.current,Oa(e.nodeType===8?e.parentNode:e),Ys(function(){Dl(t,u,n,r)}),u}function zl(e,t,n,r,a){var i=n._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var c=a;a=function(){var u=Nl(l);c.call(u)}}Dl(t,l,e,a)}else l=Qv(n,t,e,a,r);return Nl(l)}af=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ha(t.pendingLanes);n!==0&&(Xc(t,n|1),Bt(t,Ge()),!(we&6)&&(Mr=Ge()+500,As()))}break;case 13:Ys(function(){var r=Gn(e,1);if(r!==null){var a=At();xn(r,e,1,a)}}),Tu(e,1)}};Jc=function(e){if(e.tag===13){var t=Gn(e,134217728);if(t!==null){var n=At();xn(t,e,134217728,n)}Tu(e,134217728)}};lf=function(e){if(e.tag===13){var t=ws(e),n=Gn(e,t);if(n!==null){var r=At();xn(n,e,t,r)}Tu(e,t)}};of=function(){return be};cf=function(e,t){var n=be;try{return be=e,t()}finally{be=n}};Jo=function(e,t,n){switch(t){case"input":if(Ho(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Al(r);if(!a)throw Error(z(90));zh(r),Ho(r,a)}}}break;case"textarea":Uh(e,n);break;case"select":t=n.value,t!=null&&_r(e,!!n.multiple,t,!1)}};Qh=ku;Yh=Ys;var Yv={usingClientEntryPoint:!1,Events:[Ha,gr,Al,qh,Gh,ku]},oa={findFiberByHostInstance:$s,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Kv={bundleType:oa.bundleType,version:oa.version,rendererPackageName:oa.rendererPackageName,rendererConfig:oa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Yn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Jh(e),e===null?null:e.stateNode},findFiberByHostInstance:oa.findFiberByHostInstance||Gv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Li=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Li.isDisabled&&Li.supportsFiber)try{kl=Li.inject(Kv),An=Li}catch{}}Gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yv;Gt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ru(t))throw Error(z(200));return qv(e,t,null,n)};Gt.createRoot=function(e,t){if(!Ru(e))throw Error(z(299));var n=!1,r="",a=Lp;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Au(e,1,!1,null,null,n,!1,r,a),e[qn]=t.current,Oa(e.nodeType===8?e.parentNode:e),new Lu(t)};Gt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(z(188)):(e=Object.keys(e).join(","),Error(z(268,e)));return e=Jh(t),e=e===null?null:e.stateNode,e};Gt.flushSync=function(e){return Ys(e)};Gt.hydrate=function(e,t,n){if(!Bl(t))throw Error(z(200));return zl(null,e,t,!0,n)};Gt.hydrateRoot=function(e,t,n){if(!Ru(e))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",l=Lp;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=Tp(t,null,e,1,n??null,a,!1,i,l),e[qn]=t.current,Oa(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Il(t)};Gt.render=function(e,t,n){if(!Bl(t))throw Error(z(200));return zl(null,e,t,!1,n)};Gt.unmountComponentAtNode=function(e){if(!Bl(e))throw Error(z(40));return e._reactRootContainer?(Ys(function(){zl(null,null,e,!1,function(){e._reactRootContainer=null,e[qn]=null})}),!0):!1};Gt.unstable_batchedUpdates=ku;Gt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Bl(n))throw Error(z(200));if(e==null||e._reactInternals===void 0)throw Error(z(38));return zl(e,t,n,!1,r)};Gt.version="18.3.1-next-f1338f8080-20240426";function Rp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rp)}catch(e){console.error(e)}}Rp(),Lh.exports=Gt;var Xv=Lh.exports,Op,Xd=Xv;Op=Xd.createRoot,Xd.hydrateRoot;const Jv="http://localhost:3000";let Lc=localStorage.getItem("token");function ur(e){Lc=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}async function Ga(e,t={}){const n={"Content-Type":"application/json",...t.headers||{}};if(Lc&&(n.Authorization=`Bearer ${Lc}`),typeof window<"u"&&navigator&&navigator.onLine===!1)throw new Error("offline");let r;try{r=await fetch(`${Jv}${e}`,{...t,headers:n})}catch(a){throw typeof window<"u"&&navigator&&navigator.onLine===!1?new Error("offline"):a instanceof TypeError?new Error("network_error"):a}if(!r.ok){const i=(await r.json().catch(()=>({}))).error||"request_failed";throw new Error(i)}return r.json()}function me(e){return Ga(e,{method:"GET"})}function Se(e,t){return Ga(e,{method:"POST",body:JSON.stringify(t||{})})}function Ke(e,t){return Ga(e,{method:"PATCH",body:JSON.stringify(t||{})})}function wl(e,t){return Ga(e,{method:"PUT",body:JSON.stringify(t||{})})}function Cn(e){return Ga(e,{method:"DELETE"})}const Rn=Object.create(null);Rn.open="0";Rn.close="1";Rn.ping="2";Rn.pong="3";Rn.message="4";Rn.upgrade="5";Rn.noop="6";const Qi=Object.create(null);Object.keys(Rn).forEach(e=>{Qi[Rn[e]]=e});const Rc={type:"error",data:"parser error"},Pp=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Mp=typeof ArrayBuffer=="function",Dp=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Ou=({type:e,data:t},n,r)=>Pp&&t instanceof Blob?n?r(t):Jd(t,r):Mp&&(t instanceof ArrayBuffer||Dp(t))?n?r(t):Jd(new Blob([t]),r):r(Rn[e]+(t||"")),Jd=(e,t)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];t("b"+(r||""))},n.readAsDataURL(e)};function Zd(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Ro;function Zv(e,t){if(Pp&&e.data instanceof Blob)return e.data.arrayBuffer().then(Zd).then(t);if(Mp&&(e.data instanceof ArrayBuffer||Dp(e.data)))return t(Zd(e.data));Ou(e,!1,n=>{Ro||(Ro=new TextEncoder),t(Ro.encode(n))})}const eh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pa=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<eh.length;e++)pa[eh.charCodeAt(e)]=e;const ex=e=>{let t=e.length*.75,n=e.length,r,a=0,i,l,c,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const m=new ArrayBuffer(t),N=new Uint8Array(m);for(r=0;r<n;r+=4)i=pa[e.charCodeAt(r)],l=pa[e.charCodeAt(r+1)],c=pa[e.charCodeAt(r+2)],u=pa[e.charCodeAt(r+3)],N[a++]=i<<2|l>>4,N[a++]=(l&15)<<4|c>>2,N[a++]=(c&3)<<6|u&63;return m},tx=typeof ArrayBuffer=="function",Pu=(e,t)=>{if(typeof e!="string")return{type:"message",data:Ip(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:nx(e.substring(1),t)}:Qi[n]?e.length>1?{type:Qi[n],data:e.substring(1)}:{type:Qi[n]}:Rc},nx=(e,t)=>{if(tx){const n=ex(e);return Ip(n,t)}else return{base64:!0,data:e}},Ip=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Bp="",sx=(e,t)=>{const n=e.length,r=new Array(n);let a=0;e.forEach((i,l)=>{Ou(i,!1,c=>{r[l]=c,++a===n&&t(r.join(Bp))})})},rx=(e,t)=>{const n=e.split(Bp),r=[];for(let a=0;a<n.length;a++){const i=Pu(n[a],t);if(r.push(i),i.type==="error")break}return r};function ax(){return new TransformStream({transform(e,t){Zv(e,n=>{const r=n.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const i=new DataView(a.buffer);i.setUint8(0,126),i.setUint16(1,r)}else{a=new Uint8Array(9);const i=new DataView(a.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(a[0]|=128),t.enqueue(a),t.enqueue(n)})}})}let Oo;function Ri(e){return e.reduce((t,n)=>t+n.length,0)}function Oi(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let a=0;a<t;a++)n[a]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function ix(e,t){Oo||(Oo=new TextDecoder);const n=[];let r=0,a=-1,i=!1;return new TransformStream({transform(l,c){for(n.push(l);;){if(r===0){if(Ri(n)<1)break;const u=Oi(n,1);i=(u[0]&128)===128,a=u[0]&127,a<126?r=3:a===126?r=1:r=2}else if(r===1){if(Ri(n)<2)break;const u=Oi(n,2);a=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),r=3}else if(r===2){if(Ri(n)<8)break;const u=Oi(n,8),m=new DataView(u.buffer,u.byteOffset,u.length),N=m.getUint32(0);if(N>Math.pow(2,21)-1){c.enqueue(Rc);break}a=N*Math.pow(2,32)+m.getUint32(4),r=3}else{if(Ri(n)<a)break;const u=Oi(n,a);c.enqueue(Pu(i?u:Oo.decode(u),t)),r=0}if(a===0||a>e){c.enqueue(Rc);break}}}})}const zp=4;function Je(e){if(e)return lx(e)}function lx(e){for(var t in Je.prototype)e[t]=Je.prototype[t];return e}Je.prototype.on=Je.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Je.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};Je.prototype.off=Je.prototype.removeListener=Je.prototype.removeAllListeners=Je.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,a=0;a<n.length;a++)if(r=n[a],r===t||r.fn===t){n.splice(a,1);break}return n.length===0&&delete this._callbacks["$"+e],this};Je.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,a=n.length;r<a;++r)n[r].apply(this,t)}return this};Je.prototype.emitReserved=Je.prototype.emit;Je.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Je.prototype.hasListeners=function(e){return!!this.listeners(e).length};const $l=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),Zt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),ox="arraybuffer";function $p(e,...t){return t.reduce((n,r)=>(e.hasOwnProperty(r)&&(n[r]=e[r]),n),{})}const cx=Zt.setTimeout,ux=Zt.clearTimeout;function Ul(e,t){t.useNativeTimers?(e.setTimeoutFn=cx.bind(Zt),e.clearTimeoutFn=ux.bind(Zt)):(e.setTimeoutFn=Zt.setTimeout.bind(Zt),e.clearTimeoutFn=Zt.clearTimeout.bind(Zt))}const dx=1.33;function hx(e){return typeof e=="string"?fx(e):Math.ceil((e.byteLength||e.size)*dx)}function fx(e){let t=0,n=0;for(let r=0,a=e.length;r<a;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function Up(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function px(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function mx(e){let t={},n=e.split("&");for(let r=0,a=n.length;r<a;r++){let i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class gx extends Error{constructor(t,n,r){super(t),this.description=n,this.context=r,this.type="TransportError"}}class Mu extends Je{constructor(t){super(),this.writable=!1,Ul(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,r){return super.emitReserved("error",new gx(t,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=Pu(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=px(t);return n.length?"?"+n:""}}class vx extends Mu{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};rx(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,sx(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=Up()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let Vp=!1;try{Vp=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const xx=Vp;function yx(){}class jx extends vx{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,n){const r=this.request({method:"POST",data:t});r.on("success",n),r.on("error",(a,i)=>{this.onError("xhr post error",a,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=t}}class Ln extends Je{constructor(t,n,r){super(),this.createRequest=t,Ul(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const n=$p(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&r.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var a;r.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=Ln.requestsCount++,Ln.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=yx,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ln.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Ln.requestsCount=0;Ln.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",th);else if(typeof addEventListener=="function"){const e="onpagehide"in Zt?"pagehide":"unload";addEventListener(e,th,!1)}}function th(){for(let e in Ln.requests)Ln.requests.hasOwnProperty(e)&&Ln.requests[e].abort()}const Nx=function(){const e=Fp({xdomain:!1});return e&&e.responseType!==null}();class wx extends jx{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=Nx&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Ln(Fp,this.uri(),t)}}function Fp(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||xx))return new XMLHttpRequest}catch{}if(!t)try{return new Zt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Wp=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class _x extends Mu{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,r=Wp?{}:$p(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,r)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;Ou(r,this.supportsBinary,i=>{try{this.doWrite(r,i)}catch{}a&&$l(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=Up()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const Po=Zt.WebSocket||Zt.MozWebSocket;class Sx extends _x{createSocket(t,n,r){return Wp?new Po(t,n,r):n?new Po(t,n):new Po(t)}doWrite(t,n){this.ws.send(n)}}class kx extends Mu{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=ix(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),a=ax();a.readable.pipeTo(t.writable),this._writer=a.writable.getWriter();const i=()=>{r.read().then(({done:c,value:u})=>{c||(this.onPacket(u),i())}).catch(c=>{})};i();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;this._writer.write(r).then(()=>{a&&$l(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const bx={websocket:Sx,webtransport:kx,polling:wx},Cx=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ex=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Oc(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");n!=-1&&r!=-1&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let a=Cx.exec(e||""),i={},l=14;for(;l--;)i[Ex[l]]=a[l]||"";return n!=-1&&r!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=Ax(i,i.path),i.queryKey=Tx(i,i.query),i}function Ax(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function Tx(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,a,i){a&&(n[a]=i)}),n}const Pc=typeof addEventListener=="function"&&typeof removeEventListener=="function",Yi=[];Pc&&addEventListener("offline",()=>{Yi.forEach(e=>e())},!1);class Ss extends Je{constructor(t,n){if(super(),this.binaryType=ox,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const r=Oc(t);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=Oc(n.host).host);Ul(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const a=r.prototype.name;this.transports.push(a),this._transportsByName[a]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=mx(this.opts.query)),Pc&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Yi.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=zp,n.transport=t,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Ss.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Ss.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const a=this.writeBuffer[r].data;if(a&&(n+=hx(a)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,$l(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,r){return this._sendPacket("message",t,n,r),this}send(t,n,r){return this._sendPacket("message",t,n,r),this}_sendPacket(t,n,r,a){if(typeof n=="function"&&(a=n,n=void 0),typeof r=="function"&&(a=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:t,data:n,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(Ss.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Pc&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=Yi.indexOf(this._offlineEventListener);r!==-1&&Yi.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}Ss.protocol=zp;class Lx extends Ss{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),r=!1;Ss.priorWebsocketSuccess=!1;const a=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",v=>{if(!r)if(v.type==="pong"&&v.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Ss.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(N(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const x=new Error("probe error");x.transport=n.name,this.emitReserved("upgradeError",x)}}))};function i(){r||(r=!0,N(),n.close(),n=null)}const l=v=>{const x=new Error("probe error: "+v);x.transport=n.name,i(),this.emitReserved("upgradeError",x)};function c(){l("transport closed")}function u(){l("socket closed")}function m(v){n&&v.name!==n.name&&i()}const N=()=>{n.removeListener("open",a),n.removeListener("error",l),n.removeListener("close",c),this.off("close",u),this.off("upgrading",m)};n.once("open",a),n.once("error",l),n.once("close",c),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}let Rx=class extends Lx{constructor(t,n={}){const r=typeof t=="object"?t:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(a=>bx[a]).filter(a=>!!a)),super(t,r)}};function Ox(e,t="",n){let r=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),r=Oc(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}const Px=typeof ArrayBuffer=="function",Mx=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Hp=Object.prototype.toString,Dx=typeof Blob=="function"||typeof Blob<"u"&&Hp.call(Blob)==="[object BlobConstructor]",Ix=typeof File=="function"||typeof File<"u"&&Hp.call(File)==="[object FileConstructor]";function Du(e){return Px&&(e instanceof ArrayBuffer||Mx(e))||Dx&&e instanceof Blob||Ix&&e instanceof File}function Ki(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(Ki(e[n]))return!0;return!1}if(Du(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Ki(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&Ki(e[n]))return!0;return!1}function Bx(e){const t=[],n=e.data,r=e;return r.data=Mc(n,t),r.attachments=t.length,{packet:r,buffers:t}}function Mc(e,t){if(!e)return e;if(Du(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=Mc(e[r],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=Mc(e[r],t));return n}return e}function zx(e,t){return e.data=Dc(e.data,t),delete e.attachments,e}function Dc(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=Dc(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Dc(e[n],t));return e}const qp=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],$x=5;var fe;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(fe||(fe={}));class Ux{constructor(t){this.replacer=t}encode(t){return(t.type===fe.EVENT||t.type===fe.ACK)&&Ki(t)?this.encodeAsBinary({type:t.type===fe.EVENT?fe.BINARY_EVENT:fe.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===fe.BINARY_EVENT||t.type===fe.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=Bx(t),r=this.encodeAsString(n.packet),a=n.buffers;return a.unshift(r),a}}class Iu extends Je{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const r=n.type===fe.BINARY_EVENT;r||n.type===fe.BINARY_ACK?(n.type=r?fe.EVENT:fe.ACK,this.reconstructor=new Vx(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(Du(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const r={type:Number(t.charAt(0))};if(fe[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===fe.BINARY_EVENT||r.type===fe.BINARY_ACK){const i=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const l=t.substring(i,n);if(l!=Number(l)||t.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(l)}if(t.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););r.nsp=t.substring(i,n)}else r.nsp="/";const a=t.charAt(n+1);if(a!==""&&Number(a)==a){const i=n+1;for(;++n;){const l=t.charAt(n);if(l==null||Number(l)!=l){--n;break}if(n===t.length)break}r.id=Number(t.substring(i,n+1))}if(t.charAt(++n)){const i=this.tryParse(t.substr(n));if(Iu.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case fe.CONNECT:return _l(n);case fe.DISCONNECT:return n===void 0;case fe.CONNECT_ERROR:return typeof n=="string"||_l(n);case fe.EVENT:case fe.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&qp.indexOf(n[0])===-1);case fe.ACK:case fe.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Vx{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=zx(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Fx(e){return typeof e=="string"}const Wx=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};function Hx(e){return e===void 0||Wx(e)}function _l(e){return Object.prototype.toString.call(e)==="[object Object]"}function qx(e,t){switch(e){case fe.CONNECT:return t===void 0||_l(t);case fe.DISCONNECT:return t===void 0;case fe.EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&qp.indexOf(t[0])===-1);case fe.ACK:return Array.isArray(t);case fe.CONNECT_ERROR:return typeof t=="string"||_l(t);default:return!1}}function Gx(e){return Fx(e.nsp)&&Hx(e.id)&&qx(e.type,e.data)}const Qx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Iu,Encoder:Ux,get PacketType(){return fe},isPacketValid:Gx,protocol:$x},Symbol.toStringTag,{value:"Module"}));function mn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Yx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Gp extends Je{constructor(t,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[mn(t,"open",this.onopen.bind(this)),mn(t,"packet",this.onpacket.bind(this)),mn(t,"error",this.onerror.bind(this)),mn(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var r,a,i;if(Yx.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const l={type:fe.EVENT,data:n};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const N=this.ids++,v=n.pop();this._registerAckCallback(N,v),l.id=N}const c=(a=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||a===void 0?void 0:a.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!c||(u?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(t,n){var r;const a=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(a===void 0){this.acks[t]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===t&&this.sendBuffer.splice(c,1);n.call(this,new Error("operation has timed out"))},a),l=(...c)=>{this.io.clearTimeoutFn(i),n.apply(this,c)};l.withError=!0,this.acks[t]=l}emitWithAck(t,...n){return new Promise((r,a)=>{const i=(l,c)=>l?a(l):r(c);i.withError=!0,n.push(i),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((a,...i)=>(this._queue[0],a!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(a)):(this._queue.shift(),n&&n(null,...i)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:fe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case fe.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case fe.EVENT:case fe.BINARY_EVENT:this.onevent(t);break;case fe.ACK:case fe.BINARY_ACK:this.onack(t);break;case fe.DISCONNECT:this.ondisconnect();break;case fe.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let r=!1;return function(...a){r||(r=!0,n.packet({type:fe.ACK,id:t,data:a}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:fe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,t.data)}}}function zr(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}zr.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};zr.prototype.reset=function(){this.attempts=0};zr.prototype.setMin=function(e){this.ms=e};zr.prototype.setMax=function(e){this.max=e};zr.prototype.setJitter=function(e){this.jitter=e};class Ic extends Je{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,Ul(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new zr({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const a=n.parser||Qx;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Rx(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const a=mn(n,"open",function(){r.onopen(),t&&t()}),i=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),t?t(c):this.maybeReconnectOnOpen()},l=mn(n,"error",i);if(this._timeout!==!1){const c=this._timeout,u=this.setTimeoutFn(()=>{a(),i(new Error("timeout")),n.close()},c);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(a),this.subs.push(l),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(mn(t,"ping",this.onping.bind(this)),mn(t,"data",this.ondata.bind(this)),mn(t,"error",this.onerror.bind(this)),mn(t,"close",this.onclose.bind(this)),mn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){$l(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new Gp(this,t,n),this.nsps[t]=r),r}_destroy(t){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let r=0;r<n.length;r++)this.engine.write(n[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(a=>{a?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",a)):t.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const ca={};function Xi(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=Ox(e,t.path||"/socket.io"),r=n.source,a=n.id,i=n.path,l=ca[a]&&i in ca[a].nsps,c=t.forceNew||t["force new connection"]||t.multiplex===!1||l;let u;return c?u=new Ic(r,t):(ca[a]||(ca[a]=new Ic(r,t)),u=ca[a]),n.query&&!t.query&&(t.query=n.queryKey),u.socket(n.path,t)}Object.assign(Xi,{Manager:Ic,Socket:Gp,io:Xi,connect:Xi});const Kx="http://localhost:3000";function Xx(e){return Xi(Kx,{auth:{token:e}})}const Qp=f.createContext(null);function Jx({children:e}){const[t,n]=f.useState([]),r=f.useRef(new Map),a=c=>{n(m=>m.filter(N=>N.id!==c));const u=r.current.get(c);u&&(clearTimeout(u),r.current.delete(c))},i=({message:c,type:u="success",actionLabel:m,onAction:N,duration:v=6e3})=>{const x=`${Date.now()}-${Math.random().toString(36).slice(2,8)}`;if(n(C=>[...C,{id:x,message:c,type:u,actionLabel:m,onAction:N,duration:v}]),v>0){const C=setTimeout(()=>a(x),v);r.current.set(x,C)}return x},l=c=>c==="error"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 4.5c.5 0 .95.26 1.2.68l6.5 11.25a1.35 1.35 0 0 1-1.2 2.02H5.5a1.35 1.35 0 0 1-1.2-2.02L10.8 5.18c.25-.42.7-.68 1.2-.68Zm0 4.25a.9.9 0 0 0-.9.9v5.5a.9.9 0 1 0 1.8 0v-5.5a.9.9 0 0 0-.9-.9Zm0 8.3a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Z",fill:"currentColor"})}):c==="info"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 3.5a8.5 8.5 0 1 1 0 17 8.5 8.5 0 0 1 0-17Zm0 3.9a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Zm-1.2 4.2h2.4v6.1h-2.4v-6.1Z",fill:"currentColor"})}):s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M9.5 16.6 5.6 12.7a1 1 0 1 1 1.4-1.4l2.5 2.5 7.5-7.5a1 1 0 1 1 1.4 1.4l-8.9 8.9a1 1 0 0 1-1.4 0Z",fill:"currentColor"})});return s.jsxs(Qp.Provider,{value:{pushToast:i,removeToast:a},children:[e,s.jsx("div",{className:"toast-container",children:t.map(c=>s.jsxs("div",{className:`toast toast-${c.type}`,style:{"--toast-duration":`${c.duration}ms`},children:[s.jsx("div",{className:"toast-icon",children:l(c.type)}),s.jsx("div",{className:"toast-message",children:c.message}),c.actionLabel&&s.jsx("button",{className:"toast-action",type:"button",onClick:()=>{c.onAction&&Promise.resolve(c.onAction()).catch(()=>{}),a(c.id)},children:c.actionLabel}),s.jsx("button",{className:"toast-close",type:"button",onClick:()=>a(c.id),children:"x"}),c.duration>0&&s.jsx("div",{className:`toast-progress toast-progress-${c.type}`})]},c.id))})]})}function Bu(){const e=f.useContext(Qp);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function Zx({user:e,isOpen:t,onToggle:n,onLogout:r,onReturnToSuperadmin:a,showReturnToSuperadmin:i,getInitial:l}){return s.jsxs("div",{className:"rail-profile",children:[s.jsx("button",{className:`profile-button ${t?"active":""}`,type:"button",onClick:n,title:"Perfil","aria-label":"Perfil",children:s.jsx("span",{children:l(e.name)})}),t&&s.jsxs("div",{className:"profile-card",children:[s.jsx("div",{className:"profile-title",children:e.name}),s.jsx("div",{className:"profile-meta",children:e.email||"Sin correo"}),s.jsx("div",{className:"profile-role",children:e.role}),i?s.jsx("button",{className:"ghost",type:"button",onClick:a,children:"Volver a superadmin"}):null,s.jsx("button",{className:"primary",type:"button",onClick:r,children:"Salir"})]})]})}function ey({navItems:e,view:t,onSetView:n,theme:r,onToggleTheme:a,user:i,logoUrl:l,brandName:c,isProfileOpen:u,onToggleProfile:m,onLogout:N,onReturnToSuperadmin:v,showReturnToSuperadmin:x,getInitial:C,SunIcon:L,MoonIcon:R}){const g=(c||"P").trim().charAt(0)||"P";return s.jsxs("aside",{className:"nav-rail",children:[s.jsx("button",{className:"rail-logo",type:"button",title:c||"Logo",children:l?s.jsx("img",{src:l,alt:c||"Logo"}):s.jsx("span",{className:"logo-mark",children:g})}),s.jsx("nav",{className:"rail-nav",children:e.map(h=>{const p=h.icon;return s.jsx("button",{className:`rail-button ${t===h.id?"active":""}`,onClick:()=>h.enabled&&n(h.id),title:h.label,"aria-label":h.label,type:"button",disabled:!h.enabled,children:s.jsx(p,{className:"rail-icon"})},h.id)})}),s.jsx("div",{className:"rail-spacer"}),s.jsx("button",{className:"rail-button",type:"button",onClick:a,title:r==="dark"?"Tema claro":"Tema oscuro","aria-label":r==="dark"?"Tema claro":"Tema oscuro",children:r==="dark"?s.jsx(L,{className:"rail-icon"}):s.jsx(R,{className:"rail-icon"})}),s.jsx(Zx,{user:i,isOpen:u,onToggle:m,onLogout:N,onReturnToSuperadmin:v,showReturnToSuperadmin:x,getInitial:C})]})}function ty({activeConversation:e,conversations:t,channels:n,brandName:r,lastReadMap:a,filters:i,showFilters:l,users:c,tags:u,statusOptions:m,statusLabels:N,formatListTime:v,messageBlocks:x,messageDraft:C,messageMode:L,quickActions:R,tagInput:g,noteInput:h,notesList:p,latestNote:y,loadingConversation:S,isInfoOpen:D,hasUnread:$,scrollDayLabel:I,activeName:_,activePhone:O,activeStatusLabel:P,canManageStatus:X,currentUser:de,messageInputRef:pe,chatBodyRef:Fe,setShowFilters:ke,setFilters:Te,loadConversation:rt,handleBackToList:F,setIsInfoOpen:G,handleChatScroll:ne,handleAssignSelf:ie,handleStatusChange:he,handleToggleTag:Ce,handleAddTag:A,setNoteInput:H,handleAddNote:b,reassignUserId:U,setReassignUserId:q,handleReassignConversation:le,handleOpenTagManager:ce,handleCloseTagManager:ve,showTagManager:at,tagManagerForm:ot,setTagManagerForm:ct,handleCreateTag:xe,handleDeleteTag:Ze,handleQuickAction:rn,handleSendMessage:zt,setMessageMode:Ee,setMessageDraft:Oe,scrollChatToBottom:vt,getInitial:kt,PlusIcon:ut,SearchIcon:$t,VideoIcon:Rt,PhoneIcon:ye,InfoIcon:jn,SendIcon:We}){const W=new Map((n||[]).map(T=>[T.phone_number_id,T.display_name||(T.phone_number_id?`Linea ${String(T.phone_number_id).slice(-4)}`:"")])),ue=(e==null?void 0:e.assigned_user_id)&&e.assigned_user_id!==(de==null?void 0:de.id);function Pe(T){if(!T)return"Sin mensajes";const _e=T.last_message_preview||T.last_message_text||T.last_message||"";return _e||(T.last_message_type?`[${T.last_message_type}]`:"Sin mensajes")}return s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:`chat-shell ${e?"has-active":""}`,children:[s.jsxs("aside",{className:"chat-list-panel",children:[s.jsxs("div",{className:"chat-list-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"list-title",children:(r||"Perzivalh").toUpperCase()}),s.jsx("div",{className:"list-subtitle",children:"Chats"})]}),s.jsx("button",{className:"icon-button add-chat",type:"button",title:"Nuevo chat",children:s.jsx(ut,{className:"icon"})})]}),s.jsxs("div",{className:"chat-search",children:[s.jsx($t,{className:"search-icon"}),s.jsx("input",{type:"text",placeholder:"Buscar pacientes o mensajes",value:i.search,onFocus:()=>ke(!0),onClick:()=>ke(!0),onChange:T=>Te(_e=>({..._e,search:T.target.value}))}),l&&s.jsx("button",{className:"search-close",type:"button",onClick:()=>ke(!1),"aria-label":"Cerrar filtros",children:"x"})]}),l&&s.jsxs("div",{className:"chat-filters",children:[s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Status"}),s.jsxs("select",{value:i.status,onChange:T=>Te(_e=>({..._e,status:T.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),m.map(T=>s.jsx("option",{value:T,children:N[T]||T},T))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Asignado"}),s.jsxs("select",{value:i.assigned_user_id,onChange:T=>Te(_e=>({..._e,assigned_user_id:T.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"unassigned",children:"Sin asignar"}),c.map(T=>s.jsx("option",{value:T.id,children:T.name},T.id))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Tags"}),s.jsxs("select",{value:i.tag,onChange:T=>Te(_e=>({..._e,tag:T.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),u.map(T=>s.jsx("option",{value:T.name,children:T.name},T.id))]})]})]}),s.jsxs("div",{className:"list-header",children:[s.jsxs("select",{className:"line-filter",value:i.phone_number_id,onChange:T=>Te(_e=>({..._e,phone_number_id:T.target.value})),children:[s.jsx("option",{value:"",children:"Todas las lineas"}),(n||[]).map(T=>s.jsx("option",{value:T.phone_number_id,children:T.display_name||`Linea ${String(T.phone_number_id).slice(-4)}`},T.id))]}),s.jsx("span",{children:t.length})]}),s.jsx("div",{className:"conversation-list",children:t.map((T,_e)=>{var je,Yt,xt;const an=(e==null?void 0:e.id)===T.id,Kn=T.status==="pending"&&!T.assigned_user_id,Nn=T.display_name||T.phone_e164||T.wa_id||"Sin nombre",On=Pe(T),Xn=Number(T.unread_count||T.unread_messages||T.unread||0),ln=((Yt=(je=T.tags)==null?void 0:je[0])==null?void 0:Yt.name)||"",on=(xt=T.assigned_user)!=null&&xt.name?`Tomada por ${T.assigned_user.name}`:"",k=T.phone_number_id?W.get(T.phone_number_id)||`Linea ${String(T.phone_number_id).slice(-4)}`:"",V=(a==null?void 0:a[T.id])||null,Q=T.last_message_at,ae=Q&&(!V||new Date(Q).getTime()>new Date(V).getTime())&&T.last_message_direction==="in";return s.jsxs("button",{className:`conversation-item ${an?"active":""}`,onClick:()=>rt(T.id),style:{animationDelay:`${Math.min(_e,6)*60}ms`},children:[s.jsxs("div",{className:"avatar",children:[s.jsx("span",{children:kt(Nn)}),Kn&&s.jsx("span",{className:"presence-dot"})]}),s.jsxs("div",{className:"conversation-body",children:[s.jsxs("div",{className:"conversation-row",children:[s.jsx("span",{className:"conversation-name",children:Nn}),s.jsxs("div",{className:"conversation-right",children:[s.jsx("span",{className:"conversation-time",children:v(T.last_message_at)}),Xn>0&&s.jsx("span",{className:"conversation-unread",children:Xn})]})]}),s.jsx("div",{className:`conversation-preview ${ae?"unread":""}`,children:On}),s.jsxs("div",{className:"conversation-meta",children:[k&&s.jsx("span",{className:"status-pill line-pill",children:k}),on&&s.jsx("span",{className:"status-pill assignee-pill",children:on}),ln&&s.jsx("span",{className:"status-pill tag-pill",children:ln})]})]})]},T.id)})})]}),s.jsxs("div",{className:`chat-view ${D?"info-open":"info-closed"}`,children:[s.jsx("div",{className:"chat-main",children:s.jsxs("div",{className:"chat-card",children:[s.jsxs("header",{className:"chat-topbar",children:[s.jsxs("div",{className:"chat-title",children:[e&&s.jsx("button",{className:"back-button",type:"button",onClick:F,children:"Chats"}),s.jsx("div",{className:"chat-avatar",children:s.jsx("span",{children:kt(_)})}),s.jsxs("div",{children:[s.jsx("div",{className:"chat-name",children:_}),e?s.jsx("div",{className:"chat-status",children:P}):s.jsx("div",{className:"chat-status muted",children:"Elige una conversacion"})]})]}),s.jsxs("div",{className:"chat-actions",children:[s.jsx("button",{className:"icon-button",type:"button",title:"Video",children:s.jsx(Rt,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Llamar",children:s.jsx(ye,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Buscar",children:s.jsx($t,{className:"icon"})}),s.jsx("button",{className:`icon-button ${D?"active":""}`,type:"button",title:"Info",onClick:()=>G(T=>!T),children:s.jsx(jn,{className:"icon"})})]})]}),s.jsxs("div",{className:"chat-body",ref:Fe,onScroll:ne,children:[I&&s.jsx("div",{className:"chat-day-sticky","aria-hidden":"true",children:I}),S&&s.jsx("div",{className:"empty",children:"Cargando..."}),!S&&!e&&s.jsx("div",{className:"empty",children:"Selecciona una conversacion"}),!S&&e&&s.jsx(s.Fragment,{children:x.length?x:s.jsx("div",{className:"empty-state",children:"Sin mensajes"})})]}),$&&s.jsx("button",{className:"new-message-banner",type:"button",onClick:vt,children:"Nuevos mensajes"}),s.jsxs("form",{className:"chat-composer",onSubmit:zt,children:[ue&&s.jsx("div",{className:"assign-warning",children:"Conversacion tomada por otro operador."}),R.length>0&&s.jsx("div",{className:"quick-actions",children:R.map(T=>s.jsx("button",{className:"quick-action",type:"button",onClick:()=>rn(T),disabled:ue,children:T},T))}),s.jsxs("div",{className:"composer-row",children:[s.jsxs("select",{className:"message-mode",value:L,onChange:T=>Ee(T.target.value),disabled:ue,children:[s.jsx("option",{value:"text",children:"WhatsApp"}),s.jsx("option",{value:"note",children:"Nota interna"})]}),s.jsx("input",{ref:pe,type:"text",placeholder:"Escribe un mensaje...",value:C,onChange:T=>Oe(T.target.value),disabled:ue}),s.jsx("button",{className:"send-button",type:"submit",disabled:ue,children:s.jsx(We,{className:"icon"})})]})]})]})}),s.jsxs("aside",{className:"chat-info",children:[s.jsxs("div",{className:"info-card",children:[s.jsx("div",{className:"info-avatar",children:s.jsx("span",{children:kt(_)})}),s.jsx("div",{className:"info-name",children:_}),s.jsx("div",{className:"info-phone",children:O||"Sin telefono"})]}),s.jsxs("div",{className:"info-section",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("div",{className:"section-title",children:"Etiquetas"}),s.jsx("button",{className:"link-button",type:"button",onClick:ce,children:"Gestionar"})]}),s.jsx("div",{className:"tag-list",children:((e==null?void 0:e.tags)||[]).length?e.tags.map(T=>s.jsxs("span",{className:"tag-chip",children:[s.jsx("span",{className:"tag-chip-label",children:T.name}),s.jsx("button",{className:"tag-remove",type:"button",title:"Quitar etiqueta",onClick:()=>Ce(T.name),children:"x"})]},T.name)):s.jsx("div",{className:"empty-state",children:"Sin etiquetas"})}),s.jsxs("form",{className:"tag-form",onSubmit:A,children:[s.jsxs("select",{value:g,onChange:T=>setTagInput(T.target.value),children:[s.jsx("option",{value:"",children:"Selecciona etiqueta..."}),u.filter(T=>!((e==null?void 0:e.tags)||[]).some(_e=>_e.name===T.name)).map(T=>s.jsx("option",{value:T.name,children:T.name},T.id))]}),s.jsx("button",{className:"icon-button",type:"submit",title:"Agregar",children:s.jsx(ut,{className:"icon"})})]})]}),s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Notas internas"}),p!=null&&p.length?s.jsx("div",{className:"notes-stack",children:p.slice(-5).map(T=>s.jsx("div",{className:"note-card",children:T.text},T.id))}):s.jsx("div",{className:"empty-state",children:"Sin notas internas"}),s.jsxs("form",{className:"note-form",onSubmit:b,children:[s.jsx("input",{type:"text",placeholder:"Agregar nota interna...",value:h,onChange:T=>H(T.target.value),disabled:!e}),s.jsx("button",{className:"icon-button",type:"submit",title:"Guardar nota",children:s.jsx(ut,{className:"icon"})})]})]}),e&&s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Acciones"}),s.jsxs("div",{className:"action-stack",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:ie,disabled:ue,children:"Tomar conversacion"}),X&&s.jsxs("div",{className:"reassign-card",children:[s.jsxs("select",{value:U,onChange:T=>q(T.target.value),children:[s.jsx("option",{value:"",children:"Reasignar a..."}),c.map(T=>s.jsx("option",{value:T.id,children:T.name},T.id))]}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:le,disabled:!U,children:"Reasignar"})]}),X&&s.jsxs("div",{className:"action-row",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>he("open"),children:"Reactivar bot"}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>he("pending"),children:"Liberar para otro operador"})]})]})]})]})]})]}),at&&s.jsx("div",{className:"modal-overlay",onClick:ve,children:s.jsxs("div",{className:"modal-card",onClick:T=>T.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Gestion de etiquetas"}),s.jsx("button",{className:"modal-close",type:"button",onClick:ve,children:"x"})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("form",{className:"tag-manager-form",onSubmit:xe,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:ot.name,onChange:T=>ct(_e=>({..._e,name:T.target.value})),placeholder:"Nombre de etiqueta"})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Color"}),s.jsx("input",{type:"color",value:ot.color,onChange:T=>ct(_e=>({..._e,color:T.target.value}))})]}),s.jsx("div",{className:"modal-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Crear etiqueta"})})]}),s.jsx("div",{className:"tag-manager-list",children:(u||[]).map(T=>s.jsxs("div",{className:"tag-manager-row",children:[s.jsx("span",{className:"tag-chip",style:{borderColor:T.color||"#cbd5f5"},children:s.jsx("span",{className:"tag-chip-label",children:T.name})}),s.jsx("div",{className:"tag-manager-actions",children:s.jsx("button",{className:"danger soft",type:"button",onClick:()=>Ze(T.id,T.name),children:"Eliminar"})})]},T.id))})]})]})})]})}const ny=[{day:"2024-01-01",in_count:210,out_count:90},{day:"2024-01-04",in_count:280,out_count:120},{day:"2024-01-07",in_count:240,out_count:110},{day:"2024-01-10",in_count:320,out_count:140},{day:"2024-01-13",in_count:300,out_count:130},{day:"2024-01-17",in_count:310,out_count:135},{day:"2024-01-20",in_count:290,out_count:120},{day:"2024-01-24",in_count:260,out_count:115},{day:"2024-01-27",in_count:330,out_count:150},{day:"2024-01-30",in_count:340,out_count:160}];function sy(e){const t=e?new Date(e):null;if(!t||Number.isNaN(t.getTime()))return"--";const n=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];return`${String(t.getDate()).padStart(2,"0")} ${n[t.getMonth()].toUpperCase()}`}function nh(e){return e.length?e.map((t,n)=>`${n===0?"M":"L"}${t.x} ${t.y}`).join(" "):""}function ry({statusCounts:e,metrics:t,onRefresh:n,brandName:r}){var _;const a=(r||"Empresa").trim(),i=a?`${a} Enterprise`:"Enterprise",l=(e.open||0)+(e.pending||0),c=t!=null&&t.avg_first_reply_seconds?Number(t.avg_first_reply_seconds)/60:null,u=c?`${c.toFixed(1)}m`:"-",m=(t==null?void 0:t.conversion_rate)??(t==null?void 0:t.conversion_rate_percent)??null,v=`${(m==null?18.4:m>1?m:m*100).toFixed(1)}%`,x=((_=t==null?void 0:t.message_volume)==null?void 0:_.length)>0?t.message_volume.slice(-10):ny,C=Math.max(...x.map(O=>O.in_count+O.out_count),1),L=x.length*42+30,R=220,g=150,h=180,p=x.map((O,P)=>{const de=(O.in_count+O.out_count)/C*g,pe=O.in_count/C*g,Fe=O.out_count/C*g;return{x:22+P*42,totalHeight:de,inHeight:pe,outHeight:Fe}}),y=nh(p.map((O,P)=>({x:O.x+10,y:h-O.inHeight}))),S=nh(p.map(O=>({x:O.x+10,y:h-O.outHeight}))),D=Array.from(new Set([0,Math.floor(x.length/3),Math.floor(2*x.length/3),x.length-1])),$=Math.round((t==null?void 0:t.team_efficiency)||94),I=((t==null?void 0:t.top_tags)||[]).slice(0,3);return s.jsxs("section",{className:"dashboard-layout",children:[s.jsxs("div",{className:"dashboard-main",children:[s.jsxs("header",{className:"dashboard-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dashboard-kicker",children:i}),s.jsx("h2",{className:"dashboard-title",children:"Dashboard"}),s.jsx("div",{className:"dashboard-subtitle",children:"Marketing Analytics & WhatsApp CRM Overview"})]}),s.jsxs("div",{className:"dashboard-actions",children:[s.jsxs("button",{className:"dash-filter",type:"button",children:[s.jsx("span",{className:"dash-filter-icon","aria-hidden":"true"}),"Ultimos 30 dias"]}),s.jsx("button",{className:"primary",type:"button",onClick:n,children:"Generar Reporte"})]})]}),s.jsxs("div",{className:"dashboard-kpis",children:[s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Conversaciones activas"}),s.jsx("div",{className:"dash-kpi-value",children:l.toLocaleString()})]}),s.jsx("div",{className:"dash-kpi-icon",children:"C"})]}),s.jsx("div",{className:"dash-kpi-change up",children:"+12.5%"})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tiempo de respuesta"}),s.jsx("div",{className:"dash-kpi-value",children:u})]}),s.jsx("div",{className:"dash-kpi-icon",children:"T"})]}),s.jsx("div",{className:"dash-kpi-change down",children:"-0.8m"})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tasa de conversion"}),s.jsx("div",{className:"dash-kpi-value",children:v})]}),s.jsx("div",{className:"dash-kpi-icon",children:"%"})]}),s.jsx("div",{className:"dash-kpi-change up",children:"+2.1%"})]})]}),s.jsxs("div",{className:"dash-card dash-chart-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-card-title",children:"Flujo de Mensajes"}),s.jsx("div",{className:"dash-card-subtitle",children:"Volumen diario"})]}),s.jsxs("div",{className:"dash-legend",children:[s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot in"})," Entrantes"]}),s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot out"})," Salientes"]})]})]}),s.jsx("div",{className:"dash-chart",children:s.jsxs("svg",{className:"dash-chart-svg",viewBox:`0 0 ${L} ${R}`,preserveAspectRatio:"none",children:[s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"60",x2:L,y2:"60"}),s.jsx("line",{className:"dash-chart-grid",x1:"0",y1:"120",x2:L,y2:"120"}),p.map((O,P)=>s.jsxs("g",{children:[s.jsx("rect",{className:"dash-bar in",x:O.x,y:h-O.inHeight,width:"20",height:O.inHeight,rx:"6"}),s.jsx("rect",{className:"dash-bar out",x:O.x,y:h-O.inHeight-O.outHeight,width:"20",height:O.outHeight,rx:"6"})]},`bar-${P}`)),s.jsx("path",{className:"dash-line in",d:y}),s.jsx("path",{className:"dash-line out",d:S})]})}),s.jsx("div",{className:"dash-chart-labels",children:D.map(O=>{var P;return s.jsx("span",{children:sy((P=x[O])==null?void 0:P.day)},`label-${O}`)})})]}),s.jsxs("div",{className:"dashboard-lower",children:[s.jsxs("div",{className:"dash-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsx("div",{className:"dash-card-title",children:"Ultimas etiquetas detectadas"}),s.jsx("button",{className:"link-button",type:"button",children:"Ver todo"})]}),s.jsxs("div",{className:"dash-tag-table",children:[s.jsxs("div",{className:"dash-tag-head",children:[s.jsx("span",{children:"Etiqueta"}),s.jsx("span",{children:"Frecuencia"}),s.jsx("span",{children:"Accion"})]}),I.map(O=>s.jsxs("div",{className:"dash-tag-row",children:[s.jsx("span",{className:"dash-tag-chip",children:O.name}),s.jsx("span",{className:"dash-tag-count",children:O.count}),s.jsx("span",{className:"dash-tag-action",children:">"})]},O.name)),!I.length&&s.jsx("div",{className:"empty-state",children:"Sin etiquetas recientes"})]})]}),s.jsxs("div",{className:"dash-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsx("div",{className:"dash-card-title",children:"Actividad de Campana"}),s.jsx("span",{className:"dash-pill",children:"Monitor"})]}),s.jsxs("div",{className:"dash-campaign",children:[s.jsx("div",{className:"dash-campaign-title",children:'Campana de Verano "Pies Sanos"'}),s.jsxs("div",{className:"dash-campaign-meta",children:[s.jsx("span",{className:"dash-pill solid",children:"84% enviado"}),s.jsx("span",{className:"dash-muted",children:"Hace 2 horas"})]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:"84%"}})}),s.jsx("div",{className:"dash-muted",children:"1,240 destinatarios"})]})]})]})]}),s.jsxs("aside",{className:"dashboard-side",children:[s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Performance de Operadores"}),s.jsx("div",{className:"dash-card-subtitle",children:"Top 5 leaderboard - hoy"}),s.jsx("div",{className:"dash-operator-list",children:[{name:"Lucia Fernandez",role:"Especialista CRM",resolved:84,pending:3},{name:"Ricardo Gomez",role:"Atencion Pacientes",resolved:71,pending:8},{name:"Ana Martinez",role:"Soporte Medico",resolved:65,pending:12}].map(O=>s.jsxs("div",{className:"dash-operator",children:[s.jsx("div",{className:"dash-operator-avatar",children:O.name[0]}),s.jsxs("div",{className:"dash-operator-meta",children:[s.jsx("div",{className:"dash-operator-name",children:O.name}),s.jsx("div",{className:"dash-operator-role",children:O.role}),s.jsxs("div",{className:"dash-operator-stats",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Resueltos"}),s.jsx("div",{className:"dash-stat-value",children:O.resolved})]}),s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Pendientes"}),s.jsx("div",{className:"dash-stat-value danger",children:O.pending})]})]})]})]},O.name))})]}),s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Eficiencia de Equipo"}),s.jsxs("div",{className:"dash-efficiency",children:[s.jsxs("div",{className:"dash-efficiency-value",children:[$,"%"]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:`${$}%`}})}),s.jsx("div",{className:"dash-muted",children:"Objetivo diario: 500 conversiones"})]})]})]})]})}const sh={draft:"BORRADOR",scheduled:"PROGRAMADA",running:"ENVIANDO",sending:"ENVIANDO",completed:"FINALIZADA",sent:"FINALIZADA",paused:"PAUSADA",failed:"ERROR"},Pi={APPROVED:{label:"APROBADA",className:"approved"},PENDING:{label:"PENDIENTE",className:"pending"},REJECTED:{label:"RECHAZADA",className:"rejected"},DRAFT:{label:"BORRADOR",className:"draft"},PAUSED:{label:"PAUSADA",className:"pending"},DISABLED:{label:"DESHABILITADA",className:"draft"}},rh={MARKETING:"MARKETING",UTILITY:"UTILIDAD",AUTHENTICATION:"AUTENTICACION"},Mi=[{id:"audiences",label:"Audiencias",title:"Audiencias",subtitle:"MDULO DE GESTIN Y CAMPAAS"},{id:"templates",label:"Biblioteca de Plantillas",title:"Biblioteca de Plantillas",subtitle:"Consulta y gestiona las plantillas de mensajes autorizadas por WhatsApp."},{id:"new",label:"Campaas",title:"Campaas",subtitle:"Historial de envos y difusin WhatsApp"}],ay={audiencias:"audiences",audiences:"audiences",templates:"templates",plantillas:"templates",biblioteca:"templates",nueva:"new",campaign:"new",campaigns:"new",nueva_campana:"new",history:"new",historial:"new"},ah=[{id:"dynamic",label:"Audiencias Dinmicas",title:"Automatizacin de Audiencias y Tags",subtitle:"Unificacin de flujos de datos Perzivalh CRM",actionLabel:"Guardar Configuracin"},{id:"excel",label:"Importar Excel",title:"Importacin de Contactos Excel",subtitle:"Gestin de base de datos externa Perzivalh CRM",actionLabel:"Iniciar Importacin"},{id:"odoo",label:"Importar de Odoo",title:"Sincronizacin Inteligente Odoo",subtitle:"Automatizacin de audiencias Perzivalh OS",actionLabel:"Actualizar Lista Odoo"}],iy=[{value:"phone",label:"Telfono"},{value:"name",label:"Nombre Completo"},{value:"city",label:"Ciudad"},{value:"tags",label:"Etiquetas"},{value:"ignore",label:"Sin Mapear"}];function ly({campaignForm:e,setCampaignForm:t,campaignFilter:n,setCampaignFilter:r,templates:a,campaigns:i,selectedCampaignId:l,campaignMessages:c,users:u,tags:m,selectedTemplate:N,statusOptions:v,onCreateCampaign:x,onLoadCampaigns:C,onLoadCampaignMessages:L,onSendCampaign:R,onUpdateCampaign:g,onDeleteCampaign:h,onResendCampaign:p,campaignsTotal:y,formatDate:S,brandName:D}){var pi;const $=(D||"Perzivalh").trim(),[I,_]=f.useState(""),[O,P]=f.useState("all"),[X,de]=f.useState(!1),[pe,Fe]=f.useState(null),[ke,Te]=f.useState(""),[rt,F]=f.useState(!1),[G,ne]=f.useState(""),[ie,he]=f.useState("all"),[Ce,A]=f.useState(!1),[H,b]=f.useState(null),[U,q]=f.useState(""),[le,ce]=f.useState(null),[ve,at]=f.useState("down"),[ot,ct]=f.useState(null),[xe,Ze]=f.useState(!1),[rn,zt]=f.useState(!1),[Ee,Oe]=f.useState({id:"",name:"",phone:"",email:"",vat:""}),[vt,kt]=f.useState(e.send_now===!1||e.scheduled_for?"schedule":"now"),[ut,$t]=f.useState(1),[Rt]=f.useState(6),{pushToast:ye}=Bu(),jn=f.useRef(null),[We,W]=f.useState(!1),[ue,Pe]=f.useState("dynamic"),T=f.useMemo(()=>ah.map(o=>({...o,subtitle:o.subtitle.replace(/Perzivalh/g,$)})),[$]),[_e,an]=f.useState({enabled:!1,phone_number_id:null}),[Kn,Nn]=f.useState(!1),[On,Xn]=f.useState([]),[ln,on]=f.useState(!1),[k,V]=f.useState(!1),[Q,ae]=f.useState(""),[je,Yt]=f.useState(null),[xt,Ot]=f.useState(""),[dt,$r]=f.useState(null),[Qa,Js]=f.useState([]),[et,se]=f.useState({targetMode:"new",listName:"",targetSegmentId:"",prefix:"",ignoreDuplicates:!0}),[ee,Jn]=f.useState(null),[Ts,Zn]=f.useState(!1),[es,Ur]=f.useState({connected:!1}),[Ls,Ya]=f.useState(!1),[Pn,ts]=f.useState(!1),[Ie,Ka]=f.useState(()=>{if(typeof window>"u")return"templates";const w=new URLSearchParams(window.location.search).get("tab");return w?ay[w]||w:"templates"}),[Vr,Xa]=f.useState(null),[Mn,Fr]=f.useState(null),[Ja,ns]=f.useState([]),[Za,Wr]=f.useState(0),[ei,Vl]=f.useState(!1),[Rs,zu]=f.useState(""),[He,ss]=f.useState(1),[Qe]=f.useState(10),[Ut,ti]=f.useState({tag:"Todas",date:"Cualquier fecha",status:"Activos"}),[Os,ht]=f.useState(null);f.useEffect(()=>{const o=e.send_now===!1||e.scheduled_for?"schedule":"now";kt(o)},[e.send_now,e.scheduled_for]);const[Zs,er]=f.useState([]);f.useEffect(()=>{cn(),ni()},[]),f.useEffect(()=>{We&&(Fl(),tr(),nr())},[We]),f.useEffect(()=>{if(Ie!=="new"||Ce)return;const o=setTimeout(()=>{$t(1),C(1,Rt,G.trim())},350);return()=>clearTimeout(o)},[G,Rt,Ce,Ie,C]),f.useEffect(()=>{!We||ue!=="odoo"||nr()},[ue,We]),f.useEffect(()=>{Mi.find(o=>o.id===Ie)||Ka("templates")},[Ie]),f.useEffect(()=>{if(typeof window>"u")return;const o=new URLSearchParams(window.location.search);o.set("tab",Ie);const w=`${window.location.pathname}?${o.toString()}`;window.history.replaceState({},"",w)},[Ie]);async function cn(){try{const o=await me("/api/audiences?with_counts=true");o&&o.segments&&er(o.segments)}catch(o){console.error("Failed to load segments",o)}}async function ni(){try{const o=await me("/api/contacts/stats");Xa(o||null)}catch(o){console.error("Failed to load Odoo stats",o),Xa(null)}}async function Fl(){Nn(!0);try{const o=await me("/api/audiences/automation-settings");an((o==null?void 0:o.settings)||{enabled:!1,phone_number_id:null})}catch(o){console.error("Failed to load automation settings",o)}finally{Nn(!1)}}async function tr(){on(!0);try{const o=await me("/api/audiences/dynamic-tags");Xn((o==null?void 0:o.items)||[])}catch(o){console.error("Failed to load dynamic audiences",o)}finally{on(!1)}}async function si(o=_e.enabled){try{const w=await Se("/api/audiences/automation-settings",{enabled:o});an((w==null?void 0:w.settings)||{..._e,enabled:o}),ye({message:"Configuracin guardada"})}catch(w){ye({type:"error",message:w.message||"No se pudo guardar"})}}async function ft(o){an(w=>({...w,enabled:o})),await si(o)}async function ri(){V(!0);try{await Se("/api/audiences/sync-historical",{}),await tr(),await cn(),ye({message:"Sincronizacin completa"})}catch(o){ye({type:"error",message:o.message||"Error al sincronizar"})}finally{V(!1)}}async function tt(){const o=Q.trim();if(o)try{await Se("/api/audiences/dynamic-tags",{name:o}),ae(""),await tr(),await cn(),ye({message:"Etiqueta creada correctamente"})}catch(w){ye({type:"error",message:w.message||"No se pudo crear etiqueta"})}}async function nr(){Ya(!0);try{const o=await me("/api/contacts/odoo-status");Ur(o||{connected:!1})}catch(o){console.error("Failed to load Odoo status",o),Ur({connected:!1})}finally{Ya(!1)}}async function Hr(){ts(!0);try{await Se("/api/contacts/refresh-odoo",{}),await ni(),ye({message:"Lista Odoo actualizada"})}catch(o){ye({type:"error",message:o.message||"Error al actualizar Odoo"})}finally{ts(!1)}}async function Wl(o){return new Promise((w,B)=>{const K=new FileReader;K.onload=()=>{const Ne=(K.result||"").toString().split(",")[1]||"";w(Ne)},K.onerror=()=>B(K.error),K.readAsDataURL(o)})}async function Hl(o){var B;const w=(B=o.target.files)==null?void 0:B[0];if(w){Yt(w),Jn(null);try{const K=await Wl(w);Ot(K);const te=await Se("/api/audiences/import-preview",{file_base64:K,filename:w.name});$r(te),Js((te==null?void 0:te.mapping)||[])}catch(K){$r(null),Js([]),ye({type:"error",message:K.message||"No se pudo leer el archivo"})}}}async function ql(){if(!je||!xt){ye({type:"error",message:"Selecciona un archivo vlido"});return}Zn(!0);try{const o={file_base64:xt,filename:je.name,mapping:Qa,options:{baseTagName:et.listName,targetSegmentId:et.targetMode==="existing"?et.targetSegmentId:"",prefix:et.prefix,ignoreDuplicates:et.ignoreDuplicates}},w=await Se("/api/audiences/import-excel",o);Jn(w),await cn(),await tr(),ye({message:"Importacin completada"})}catch(o){ye({type:"error",message:o.message||"Error al importar"})}finally{Zn(!1)}}async function wn(o,w={}){if(!o){ns([]),Wr(0);return}const B=w.page||1,K=w.search||"";Vl(!0);try{if(o.type==="odoo"){const Bn=(B-1)*Qe,_n=await me(`/api/contacts?search=${encodeURIComponent(K)}&offset=${Bn}&limit=${Qe}`);let Sn=(_n==null?void 0:_n.contacts)||[];Ut.tag!=="Todas"&&(Sn=Sn.filter(ls=>{const yt=ls.tags_json||[];return Ut.tag==="Con etiquetas"?Array.isArray(yt)&&yt.length>0:Ut.tag==="Sin etiquetas"?!Array.isArray(yt)||yt.length===0:!0})),Ut.status!=="Activos"&&(Sn=Sn.filter(ls=>{const yt=(ls.status||"ACTIVO").toUpperCase();return Ut.status==="Activos"?yt==="ACTIVO":yt!=="ACTIVO"})),ns(Sn),Wr((_n==null?void 0:_n.total)||Sn.length);return}const te=await me(`/api/audiences/${o.id}/preview?limit=200`),Ne=(te==null?void 0:te.recipients)||[],Ye=K.trim().toLowerCase();let un=Ye?Ne.filter(Bn=>{var ls,yt;const _n=((ls=Bn.name)==null?void 0:ls.toLowerCase())||"",Sn=((yt=Bn.phone_e164)==null?void 0:yt.toLowerCase())||"";return _n.includes(Ye)||Sn.includes(Ye)}):Ne;Ut.tag==="Sin etiquetas"&&(un=un.filter(Bn=>!Bn.tags||Bn.tags.length===0));const In=(te==null?void 0:te.total)||un.length,dn=(B-1)*Qe,is=un.slice(dn,dn+Qe);ns(is),Wr(In)}catch(te){console.error("Failed to load audience contacts",te),ns([]),Wr(0)}finally{Vl(!1)}}function sr(o){Fr((o==null?void 0:o.id)||null),ss(1)}async function Dn(){try{await Se("/api/audiences/refresh-counts",{}),await cn(),rs&&await wn(rs,{page:He,search:Rs}),ye({message:"Conteos actualizados"})}catch(o){ye({type:"error",message:o.message||"No se pudo actualizar"})}}async function ai(o){if(!(!o||o.type==="odoo"||o.isDefault||!window.confirm(`Eliminar la audiencia "${o.name}"? Esta accin la desactiva y no borra contactos.`)))try{await Cn(`/api/audiences/${o.id}`),await cn(),Mn===o.id&&Fr(null),ht(null),ye({message:"Audiencia eliminada"})}catch(B){ye({type:"error",message:B.message||"No se pudo eliminar"})}}async function qr(o){if(!o||o.type==="odoo"||o.isDefault)return;const w=window.prompt("Nuevo nombre de la audiencia:",o.name);if(!(!w||!w.trim()))try{await wl(`/api/audiences/${o.id}`,{name:w.trim()}),await cn(),ht(null),ye({message:"Audiencia renombrada"})}catch(B){ye({type:"error",message:B.message||"No se pudo renombrar"})}}function Ps(o,w){ti(B=>{const K=B[o],te=w.indexOf(K),Ne=w[(te+1)%w.length];return{...B,[o]:Ne}})}function Ms(){if(ue==="dynamic"){si();return}if(ue==="excel"){ql();return}ue==="odoo"&&Hr()}const bt=f.useMemo(()=>{const o={id:"odoo",name:"odoo",subtitle:"Origen: Odoo",count:(Vr==null?void 0:Vr.total)||0,type:"odoo"},w=Zs.map(B=>({id:B.id,name:B.name,subtitle:B.description||"Segmento personalizado",count:B.estimated_count||0,type:"segment",isDefault:(B.name||"").toUpperCase().startsWith("DEFAULT")}));return[o,...w]},[Zs,Vr]),ii=f.useMemo(()=>{const o=ke.trim().toLowerCase();return o?bt.filter(w=>{var te,Ne;const B=((te=w.name)==null?void 0:te.toLowerCase())||"",K=((Ne=w.subtitle)==null?void 0:Ne.toLowerCase())||"";return B.includes(o)||K.includes(o)}):bt},[bt,ke]),rs=f.useMemo(()=>bt.find(o=>o.id===Mn),[bt,Mn]),Gr=o=>{const w=(o==null?void 0:o.buttons_json)??(o==null?void 0:o.buttons)??[];if(Array.isArray(w))return w;if(typeof w=="string")try{const B=JSON.parse(w);return Array.isArray(B)?B:[]}catch{return[]}return[]},Qr=f.useMemo(()=>Gr(N),[N]),li=f.useMemo(()=>Gr(pe),[pe]),Ds=f.useMemo(()=>Math.max(1,Math.ceil(Za/Qe)),[Za,Qe]),Yr=f.useMemo(()=>{const o=[],w=Math.max(1,He-1),B=Math.min(Ds,w+2);for(let K=w;K<=B;K+=1)o.push(K);return o},[He,Ds]),Kr=o=>o==="sent"?"completed":o==="sending"?"running":o||"",Is=f.useMemo(()=>{const o={all:i.length,completed:0,scheduled:0,draft:0,failed:0,running:0};return i.forEach(w=>{const B=Kr(w.status);B==="completed"&&(o.completed+=1),B==="scheduled"&&(o.scheduled+=1),B==="draft"&&(o.draft+=1),B==="failed"&&(o.failed+=1),B==="running"&&(o.running+=1)}),o},[i]),rr=f.useMemo(()=>{const o=G.trim().toLowerCase();return i.filter(w=>{const B=!o||(w.name||"").toLowerCase().includes(o),K=Kr(w.status);return B&&(ie==="all"||K===ie)})},[i,G,ie]),Vt=f.useMemo(()=>{const o=[],w=y||i.length,B=Math.max(1,Math.ceil(w/Rt)),K=Math.max(1,ut-1),te=Math.min(B,K+2);for(let Ne=K;Ne<=te;Ne+=1)o.push(Ne);return{pages:o,totalPages:B}},[y,i.length,ut,Rt]);f.useEffect(()=>{Ie==="audiences"&&!Mn&&bt.length&&Fr(bt[0].id)},[bt,Ie,Mn]),f.useEffect(()=>{Ie!=="new"&&Ce&&(A(!1),b(null),Jr())},[Ie,Ce]),f.useEffect(()=>{Ie==="audiences"&&wn(rs,{page:He,search:Rs})},[Mn,He,Rs,Ie,rs,Ut]);const Gl=f.useMemo(()=>{const o=new Set;return(a||[]).forEach(w=>{w.category&&o.add(w.category)}),Array.from(o)},[a]),oi=f.useMemo(()=>{const o=I.trim().toLowerCase(),w=O==="all"?"":O.toLowerCase();return(a||[]).filter(B=>{var un,In;const K=((un=B.name)==null?void 0:un.toLowerCase())||"",te=((In=B.category)==null?void 0:In.toLowerCase())||"";return(!o||K.includes(o)||te.includes(o))&&(!w||te===w)})},[I,O,a]),ci=f.useMemo(()=>{const o=U.trim().toLowerCase();return(a||[]).filter(w=>{var K;const B=((K=w.name)==null?void 0:K.toLowerCase())||"";return!o||B.includes(o)})},[U,a]),Xr=f.useMemo(()=>n.segment_id?bt.find(o=>o.id===n.segment_id)||null:n.tag&&bt.find(o=>o.name===n.tag)||null,[bt,n.segment_id,n.tag]),Ql=f.useMemo(()=>n.segment_id?`segment:${n.segment_id}`:n.tag?`tag:${n.tag}`:n.assigned_user_id?`assigned:${n.assigned_user_id}`:n.status?`status:${n.status}`:n.verified_only?"verified":"",[n.segment_id,n.tag,n.assigned_user_id,n.status,n.verified_only]);function ar(o){r(w=>{const B={...w,status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""};if(o.startsWith("segment:")){const K=o.slice(8),te=bt.find(Ne=>Ne.id===K);B.segment_id=K,B.segment_name=(te==null?void 0:te.name)||""}else o.startsWith("tag:")?B.tag=o.slice(4):o.startsWith("status:")?B.status=o.slice(7):o.startsWith("assigned:")?B.assigned_user_id=o.slice(9):o==="verified"&&(B.verified_only=!0);return B})}function Yl(o){if(!o)return"";const w=new Date(o);if(Number.isNaN(w.getTime()))return"";const B=K=>String(K).padStart(2,"0");return`${w.getFullYear()}-${B(w.getMonth()+1)}-${B(w.getDate())}T${B(w.getHours())}:${B(w.getMinutes())}`}function Kl(o){t(w=>({...w,template_id:o}))}function Jr(){t({name:"",template_id:"",scheduled_for:"",send_now:!0}),r({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),q("")}function Xl(o){var te;if(!o)return;b(o),A(!0),q(""),t(Ne=>{var Ye;return{...Ne,name:o.name||"",template_id:o.template_id||((Ye=o.template)==null?void 0:Ye.id)||"",scheduled_for:Yl(o.scheduled_for||o.scheduled_at),send_now:!(o.scheduled_for||o.scheduled_at)}});const w=o.audience_filter||{},B=w.segment_id||o.segment_id||"",K=w.segment_name||((te=o.segment)==null?void 0:te.name)||"";r(Ne=>({...Ne,status:w.status||"",tag:w.tag||"",assigned_user_id:w.assigned_user_id||"",verified_only:!!w.verified_only,segment_id:B,segment_name:K}))}function ir(o){!(o!=null&&o.id)||!h||!window.confirm(`Eliminar la campaa "${o.name}"?`)||h(o.id)}function ui(o){!(o!=null&&o.id)||!p||!window.confirm(`Reenviar la campaa "${o.name}"?`)||p(o.id)}function Jl(o,w){if(ce(B=>B===o?null:o),w!=null&&w.currentTarget&&typeof window<"u"){const B=w.currentTarget.getBoundingClientRect(),K=window.innerHeight-B.bottom,te=B.top,Ne=K<180&&te>K;at(Ne?"up":"down")}}function Zl(o){ct(w=>w===o?null:o)}function eo(o){o!=null&&o.id&&(Oe({id:o.id,name:o.name||"",phone:o.phone_e164||o.phone||"",email:o.email||"",vat:o.vat||""}),Ze(!0),ct(null))}async function as(o){if(o.preventDefault(),!!Ee.id){zt(!0);try{const w=await wl(`/api/contacts/${Ee.id}`,{name:Ee.name,phone:Ee.phone,email:Ee.email,vat:Ee.vat});w!=null&&w.contact&&ns(B=>B.map(K=>K.id===w.contact.id?w.contact:K)),Ze(!1),ye({message:"Contacto actualizado"}),await wn(rs,{page:He,search:Rs})}catch(w){ye({type:"error",message:w.message||"No se pudo actualizar"})}finally{zt(!1)}}}async function Zr(o){if(!(!(o!=null&&o.id)||!window.confirm(`Eliminar el contacto "${o.name||o.phone_e164||"Sin nombre"}"?`)))try{await Cn(`/api/contacts/${o.id}`),ns(B=>B.filter(K=>K.id!==o.id)),ct(null),ye({message:"Contacto eliminado"}),await wn(rs,{page:He,search:Rs})}catch(B){ye({type:"error",message:B.message||"No se pudo eliminar"})}}function to(o){if(o.preventDefault(),!e.name.trim()||!e.template_id)return;const w={};if(n.status&&(w.status=n.status),n.tag&&(w.tag=n.tag.trim()),n.assigned_user_id&&(w.assigned_user_id=n.assigned_user_id),n.verified_only&&(w.verified_only=!0),n.segment_id&&(w.segment_id=n.segment_id,n.segment_name&&(w.segment_name=n.segment_name)),H&&g){g(H.id,{name:e.name.trim(),template_id:e.template_id,segment_id:n.segment_id||null,audience_filter:w,scheduled_for:e.scheduled_for||null}),A(!1),b(null),Jr();return}x(o)}function di(o){Fe(o),de(!0)}const lr=Mi.find(o=>o.id===Ie)||Mi[1],no={title:"Campaas",subtitle:"CONFIGURACIN DE NUEVO ENVO MASIVO"},hi=T.find(o=>o.id===ue)||T[0],fi=We?hi:Ie==="new"&&Ce?no:lr;return s.jsxs("section",{className:"campaigns-page",children:[s.jsxs("div",{className:"campaigns-shell",children:[s.jsxs("header",{className:"campaigns-header",children:[s.jsxs("div",{className:"campaigns-title-block",children:[s.jsxs("div",{className:"campaigns-title-row",children:[We&&s.jsx("button",{className:"campaigns-back",type:"button",onClick:()=>W(!1),"aria-label":"Volver",children:"<"}),s.jsx("span",{className:"campaigns-heading",children:fi.title})]}),s.jsx("div",{className:`campaigns-subtitle ${We?"campaigns-subtitle--upper":""}`,children:fi.subtitle})]}),s.jsxs("div",{className:"campaigns-actions",children:[We&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>W(!1),children:ue==="excel"?"Cancelar":"Descartar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:Ms,disabled:ue==="excel"&&(Ts||!xt||et.targetMode==="new"&&!et.listName.trim()||et.targetMode==="existing"&&!et.targetSegmentId)||ue==="odoo"&&Pn,children:hi.actionLabel})]}),!We&&Ie==="audiences"&&s.jsxs("button",{className:"campaigns-primary campaigns-primary--dropdown",type:"button",onClick:()=>{W(!0),Pe("dynamic")},children:[s.jsx("span",{className:"campaigns-primary-icon",children:"+"}),"Nueva Audiencia"]}),!We&&Ie==="new"&&s.jsx(s.Fragment,{children:Ce?s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>{A(!1),b(null),Jr()},children:"Cancelar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>{var o,w;return(w=(o=jn.current)==null?void 0:o.requestSubmit)==null?void 0:w.call(o)},children:H?"Guardar cambios":"Lanzar Campaa"})]}):s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>A(!0),children:"+ Lanzar Campaa"})})]})]}),!We&&s.jsx("nav",{className:"campaigns-tabs",role:"tablist","aria-label":"Secciones de Campaas",children:Mi.map(o=>s.jsx("button",{type:"button",role:"tab","aria-selected":Ie===o.id,className:`campaigns-tab ${Ie===o.id?"active":""}`,onClick:()=>Ka(o.id),children:o.label},o.id))}),s.jsx("div",{className:"campaigns-tab-panel",children:We?s.jsxs("section",{className:"audience-flow",children:[s.jsx("nav",{className:"audience-flow-tabs",role:"tablist","aria-label":"Flujo de nueva audiencia",children:ah.map(o=>s.jsx("button",{type:"button",role:"tab","aria-selected":ue===o.id,className:`audience-flow-tab ${ue===o.id?"active":""}`,onClick:()=>Pe(o.id),children:o.label},o.id))}),s.jsxs("div",{className:"audience-flow-panel",children:[ue==="dynamic"&&s.jsxs("div",{className:"audience-flow-content",children:[s.jsxs("div",{className:"audience-hero",children:[s.jsxs("div",{className:"audience-hero-main",children:[s.jsx("div",{className:"audience-hero-title",children:"Sincronizacin Automtica Total"}),s.jsx("div",{className:"audience-hero-subtitle",children:"Vincula tus etiquetas directamente con Audiencias Dinmicas. La lgica del sistema es 1 Tag = 1 Audiencia."})]}),s.jsxs("label",{className:"audience-switch",children:[s.jsx("span",{children:"Estado"}),s.jsx("input",{type:"checkbox",checked:_e.enabled,onChange:o=>ft(o.target.checked),disabled:Kn}),s.jsx("span",{children:_e.enabled?"ACTIVO":"INACTIVO"})]})]}),s.jsxs("div",{className:"audience-rule-card",children:[s.jsx("div",{className:"audience-rule-title",children:"Regla de Automatizacin unificada"}),s.jsx("p",{children:"Cuando un operador o bot etiqueta a un contacto en el CRM, este se aade instantneamente a la lista de audiencia correspondiente. No requiere intervencin manual adicional."})]}),s.jsxs("div",{className:"audience-section-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audience-section-title",children:"Gestin de Etiquetas dinmicas"}),s.jsx("div",{className:"audience-section-subtitle",children:"Administra las etiquetas vinculadas que alimentan tus listas de envo en tiempo real."})]}),s.jsxs("div",{className:"audience-section-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:ri,disabled:k,children:k?"Sincronizando...":"Sincronizar Datos Histricos"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:tt,disabled:!Q.trim(),children:"Nueva Etiqueta / Audiencia"})]})]}),s.jsxs("div",{className:"audience-tags-grid",children:[ln&&s.jsx("div",{className:"empty-state",children:"Cargando etiquetas..."}),!ln&&On.length===0&&s.jsx("div",{className:"empty-state",children:"No hay etiquetas dinmicas an."}),!ln&&On.map(o=>{var w,B,K,te;return s.jsxs("div",{className:`audience-tag-card ${o.is_default?"default":""}`,children:[s.jsxs("div",{className:"audience-tag-head",children:[s.jsx("div",{className:"audience-tag-name",children:o.is_default?"DEFAULT":((w=o.tag)==null?void 0:w.name)||((B=o.segment)==null?void 0:B.name)}),s.jsx("div",{className:"audience-tag-count",children:((K=o.segment)==null?void 0:K.estimated_count)||0})]}),s.jsxs("div",{className:"audience-tag-meta",children:["Audiencia: ",((te=o.segment)==null?void 0:te.estimated_count)||0," contactos"]}),s.jsxs("div",{className:"audience-tag-status",children:[s.jsx("span",{className:"dot"}),"Sincronizado",s.jsx("span",{className:"audience-tag-time",children:o.last_synced_at?`  ${S(o.last_synced_at)}`:""})]})]},o.id)}),s.jsx("div",{className:"audience-tag-card add",children:s.jsxs("div",{className:"audience-tag-add",children:[s.jsx("div",{className:"audience-tag-add-icon",children:"+"}),s.jsx("input",{type:"text",placeholder:"Crear nueva etiqueta",value:Q,onChange:o=>ae(o.target.value)}),s.jsx("button",{type:"button",className:"campaigns-primary",onClick:tt,disabled:!Q.trim(),children:"Crear"})]})})]})]}),ue==="excel"&&s.jsxs("div",{className:"audience-flow-content",children:[s.jsx("div",{className:"excel-dropzone",children:s.jsxs("div",{className:"excel-dropzone-inner",children:[s.jsx("div",{className:"excel-dropzone-icon",children:"?"}),s.jsx("div",{className:"excel-dropzone-title",children:"Sube tu archivo de Excel"}),s.jsxs("div",{className:"excel-dropzone-subtitle",children:["Arrastra y suelta tu archivo .xlsx o .csv aqu o"," ",s.jsxs("label",{className:"excel-link",children:["explora tus archivos",s.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:Hl})]})]}),s.jsxs("div",{className:"excel-dropzone-tags",children:[s.jsx("span",{children:"Mximo 50MB"}),s.jsx("span",{children:"Hasta 50,000 filas"})]}),je&&s.jsx("div",{className:"excel-file-name",children:je.name})]})}),s.jsxs("div",{className:"excel-grid",children:[s.jsxs("div",{className:"excel-card",children:[s.jsx("div",{className:"excel-card-title",children:"Configuracin de Importacin"}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista de destino"}),s.jsxs("select",{value:et.targetMode,onChange:o=>se(w=>({...w,targetMode:o.target.value})),children:[s.jsx("option",{value:"new",children:"Crear Nueva Lista"}),s.jsx("option",{value:"existing",children:"Elegir Lista Existente"})]})]}),et.targetMode==="new"?s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Nombre de la nueva lista"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO",value:et.listName,onChange:o=>se(w=>({...w,listName:o.target.value}))})]}):s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista existente"}),s.jsxs("select",{value:et.targetSegmentId,onChange:o=>se(w=>({...w,targetSegmentId:o.target.value})),children:[s.jsx("option",{value:"",children:"Selecciona una lista"}),Zs.map(o=>s.jsx("option",{value:o.id,children:o.name},o.id))]})]}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Prefijo de etiqueta (opcional)"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO_",value:et.prefix,onChange:o=>se(w=>({...w,prefix:o.target.value}))})]}),s.jsxs("label",{className:"excel-checkbox",children:[s.jsx("input",{type:"checkbox",checked:et.ignoreDuplicates,onChange:o=>se(w=>({...w,ignoreDuplicates:o.target.checked}))}),"Ignorar contactos duplicados"]}),ee&&s.jsxs("div",{className:"excel-summary",children:["Procesadas: ",ee.processed,"  Nuevos:"," ",ee.created,"  Duplicados:"," ",ee.skipped,"  Errores: ",ee.errors]})]}),s.jsxs("div",{className:"excel-card",children:[s.jsxs("div",{className:"excel-card-title",children:["Vista previa de mapeo",s.jsxs("span",{className:"excel-pill",children:["Columnas detectadas: ",((pi=dt==null?void 0:dt.columns)==null?void 0:pi.length)||0]})]}),s.jsxs("div",{className:"excel-map-table",children:[s.jsxs("div",{className:"excel-map-head",children:[s.jsx("span",{children:"Columna Excel"}),s.jsx("span",{children:"Mapeo CRM"}),s.jsx("span",{children:"Ejemplo"})]}),((dt==null?void 0:dt.columns)||[]).map((o,w)=>{var B,K;return s.jsxs("div",{className:"excel-map-row",children:[s.jsx("span",{children:o}),s.jsx("select",{value:Qa[w]||"ignore",onChange:te=>Js(Ne=>{const Ye=[...Ne];return Ye[w]=te.target.value,Ye}),children:iy.map(te=>s.jsx("option",{value:te.value,children:te.label},te.value))}),s.jsx("span",{children:((K=(B=dt==null?void 0:dt.previewRows)==null?void 0:B[0])==null?void 0:K[w])||"--"})]},`${o}-${w}`)}),!dt&&s.jsx("div",{className:"empty-state",children:"Sube un archivo para ver el mapeo."})]})]})]})]}),ue==="odoo"&&s.jsxs("div",{className:"audience-flow-content odoo-flow",children:[s.jsxs("div",{className:"odoo-status",children:[s.jsx("span",{className:`odoo-indicator ${es.connected?"on":"off"}`}),"Estado: ",es.connected?"Odoo conectado":"Odoo no conectado"]}),s.jsxs("div",{className:"odoo-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:nr,disabled:Ls,children:Ls?"Validando...":"Validar Conexin"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:Hr,disabled:Pn,children:Pn?"Actualizando...":"Actualizar Lista Odoo"})]}),s.jsx("div",{className:"odoo-note",children:"Se importarn contactos y se crearn audiencias por etiqueta Automticamente."})]})]})]}):s.jsxs(s.Fragment,{children:[Ie==="templates"&&s.jsxs("section",{className:"campaigns-panel templates-panel",children:[s.jsxs("div",{className:"templates-toolbar",children:[s.jsxs("label",{className:"templates-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar por nombre de plantilla...",value:I,onChange:o=>_(o.target.value)})]}),s.jsxs("select",{className:"templates-select",value:O,onChange:o=>P(o.target.value),children:[s.jsx("option",{value:"all",children:"Todas las categorias"}),Gl.map(o=>s.jsx("option",{value:o.toLowerCase(),children:rh[o]||o},o))]})]}),s.jsxs("div",{className:"template-grid template-grid--library",children:[oi.map(o=>{const w=(o.status||(o.is_active?"APPROVED":"PENDING")).toUpperCase(),B=Pi[w]||Pi.PENDING,K=rh[o.category]||o.category||"GENERAL",te=o.id===e.template_id,Ne=o.rejection_reason||o.rejectionReason||o.rejection_message||"",Ye=w==="REJECTED"?"Ver detalles":"Previsualizar";return s.jsxs("div",{className:`template-card ${te?"selected":""}`,children:[s.jsxs("div",{className:"template-head",children:[s.jsx("div",{className:"template-name",title:o.name,children:o.name}),s.jsx("span",{className:`template-status ${B.className}`,children:B.label})]}),s.jsx("div",{className:"template-category",children:K}),s.jsx("div",{className:`template-preview ${w==="REJECTED"?"rejected":""}`,children:o.body_preview||o.body_text||"Sin preview"}),w==="REJECTED"&&Ne&&s.jsxs("div",{className:"template-rejection",children:["Rechazada por Meta: ",Ne]}),s.jsx("div",{className:"template-footer",children:s.jsx("button",{className:"template-action",type:"button",onClick:()=>di(o),children:Ye})})]},o.id)}),!oi.length&&s.jsx("div",{className:"empty-state",children:"Sin plantillas disponibles"})]})]}),Ie==="audiences"&&s.jsx("section",{className:"campaigns-panel audiences-panel",children:s.jsxs("div",{className:"audiences-layout",children:[s.jsxs("div",{className:"audiences-list",children:[s.jsxs("label",{className:"audiences-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar lista...",value:ke,onChange:o=>Te(o.target.value)})]}),s.jsxs("div",{className:"audience-list",children:[ii.map(o=>{var w;return s.jsxs("button",{type:"button",className:`audience-card ${Mn===o.id?"active":""}`,onClick:()=>sr(o),children:[s.jsxs("div",{className:"audience-title",children:[s.jsx("span",{children:o.name}),s.jsxs("div",{className:"audience-title-actions",children:[s.jsx("span",{className:"audience-count",children:((w=o.count)==null?void 0:w.toLocaleString("es-PE"))||0}),!o.isDefault&&o.type!=="odoo"&&s.jsxs("div",{className:"audience-menu-wrapper",children:[s.jsx("button",{className:"audience-menu",type:"button","aria-label":"Opciones de audiencia",onClick:B=>{B.stopPropagation(),ht(K=>K===o.id?null:o.id)},children:"..."}),Os===o.id&&s.jsxs("div",{className:"audience-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>qr(o),children:"Renombrar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>ai(o),children:"Eliminar"})]})]})]})]}),s.jsx("div",{className:"audience-subtitle",children:o.subtitle})]},o.id)}),!ii.length&&s.jsx("div",{className:"empty-state",children:"Sin audiencias disponibles"})]})]}),s.jsxs("div",{className:"audiences-table-panel",children:[s.jsxs("div",{className:"audiences-filters",children:[s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ETIQUETA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>Ps("tag",["Todas","Con etiquetas","Sin etiquetas"]),children:Ut.tag})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"FECHA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>Ps("date",["Cualquier fecha","ltimos 30 das"]),children:Ut.date})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ESTADO:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>Ps("status",["Activos","Inactivos"]),children:Ut.status})]}),s.jsxs("div",{className:"audiences-filter-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Descargar",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Actualizar",onClick:Dn,children:""})]})]}),s.jsxs("div",{className:"audiences-search-row",children:[s.jsxs("label",{className:"audiences-search-field",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar contacto en esta lista...",value:Rs,onChange:o=>{zu(o.target.value),ss(1)}})]}),s.jsxs("div",{className:"audiences-total",children:[Za.toLocaleString("es-PE")," contactos en total"]})]}),s.jsxs("div",{className:"audiences-table",children:[s.jsxs("div",{className:"audiences-table-head",children:[s.jsx("span",{}),s.jsx("span",{children:"CONTACTO"}),s.jsx("span",{children:"WHATSAPP"}),s.jsx("span",{children:"ETIQUETAS"}),s.jsx("span",{children:"FECHA REGISTRO"}),s.jsx("span",{children:"ESTADO"}),s.jsx("span",{})]}),ei&&s.jsx("div",{className:"loading",children:"Cargando contactos..."}),!ei&&Ja.length===0&&s.jsx("div",{className:"empty-state",children:"No hay contactos en esta audiencia."}),!ei&&Ja.map(o=>{const w=o.name||"Sin nombre",B=o.email||"",K=o.phone_e164||o.phone||"-",te=Array.isArray(o.tags)?o.tags:o.tags?[o.tags]:[],Ne=w.trim().slice(0,1).toUpperCase();return s.jsxs("div",{className:"audiences-table-row",children:[s.jsx("input",{type:"checkbox","aria-label":"Seleccionar contacto"}),s.jsxs("div",{className:"audiences-contact",children:[s.jsx("div",{className:"audiences-avatar",children:Ne}),s.jsxs("div",{className:"audiences-contact-info",children:[s.jsx("div",{className:"audiences-contact-name",children:w}),B&&s.jsx("div",{className:"audiences-contact-email",children:B})]})]}),s.jsx("div",{children:K}),s.jsx("div",{className:"audiences-tags",children:te.length?te.map(Ye=>s.jsx("span",{className:"audiences-tag",children:Ye},`${o.id}-${Ye}`)):s.jsx("span",{className:"audiences-tag empty",children:""})}),s.jsx("div",{children:o.created_at?S(o.created_at):""}),s.jsx("div",{className:"audiences-status",children:(o.status||"ACTIVO").toUpperCase()}),s.jsxs("div",{className:"audiences-menu-wrapper",children:[s.jsx("button",{className:"audiences-menu",type:"button","aria-label":"Opciones",onClick:()=>Zl(o.id),disabled:!o.id,children:"..."}),ot===o.id&&s.jsxs("div",{className:"audiences-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>eo(o),children:"Editar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>Zr(o),children:"Eliminar"})]})]})]},o.id||K)})]}),s.jsxs("div",{className:"audiences-pagination",children:[s.jsxs("div",{className:"audiences-page-info",children:["Pgina ",He," de ",Ds]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:He<=1,onClick:()=>ss(o=>Math.max(1,o-1)),children:"<"}),Yr.map(o=>s.jsx("button",{className:`audiences-page-btn ${o===He?"active":""}`,type:"button",onClick:()=>ss(o),children:o},`aud-page-${o}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:He>=Ds,onClick:()=>ss(o=>Math.min(Ds,o+1)),children:">"})]})]})]})]})}),Ie==="new"&&s.jsx("section",{className:"campaigns-panel campaigns-module",children:Ce?s.jsxs("div",{className:"campaigns-launch",children:[s.jsxs("form",{className:"campaigns-launch-form",ref:jn,onSubmit:to,children:[s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"1"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Nombre de la Campaa"}),s.jsx("input",{type:"text",placeholder:"Ej: Promocin Black Friday 2024",value:e.name,onChange:o=>t(w=>({...w,name:o.target.value}))})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"2"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Seleccionar Audiencia"}),s.jsxs("select",{value:Ql,onChange:o=>ar(o.target.value),children:[s.jsx("option",{value:"",children:"Selecciona un segmento..."}),bt.filter(o=>o.type!=="odoo").map(o=>s.jsx("option",{value:`segment:${o.id}`,children:o.name},`seg-${o.id}`)),s.jsx("option",{value:"verified",children:"Solo verificados"}),s.jsx("option",{value:"assigned:unassigned",children:"Sin asignar"})]})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"3"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Elegir Plantilla de Meta"}),s.jsxs("div",{className:"launch-template-search",children:[s.jsx("input",{type:"text",placeholder:"Buscar plantilla...",value:U,onChange:o=>q(o.target.value)}),s.jsx("button",{type:"button",onClick:()=>q(""),children:"Limpiar"})]}),s.jsx("div",{className:"launch-templates-scroll",children:s.jsxs("div",{className:"launch-templates",children:[ci.map(o=>{const w=o.status||"APPROVED",B=Pi[w]||Pi.APPROVED,K=e.template_id===o.id;return s.jsxs("button",{className:`launch-template ${K?"selected":""}`,type:"button",onClick:()=>Kl(o.id),children:[s.jsx("div",{className:"launch-template-icon"}),s.jsx("div",{className:"launch-template-title",children:o.name}),s.jsx("div",{className:"launch-template-preview",children:o.body_preview||o.body_text||"Sin preview"}),s.jsx("span",{className:`launch-template-status ${B.className}`,children:B.label})]},o.id)}),ci.length===0&&s.jsx("div",{className:"launch-empty",children:"Sin plantillas"})]})})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"4"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Programacin"}),s.jsxs("div",{className:"launch-schedule",children:[s.jsx("button",{className:`launch-schedule-option ${vt==="now"?"active":""}`,type:"button",onClick:()=>{kt("now"),t(o=>({...o,scheduled_for:"",send_now:!0}))},children:"Enviar Ahora"}),s.jsx("button",{className:`launch-schedule-option ${vt==="schedule"?"active":""}`,type:"button",onClick:()=>{kt("schedule"),t(o=>({...o,send_now:!1}))},children:"Programar Envo"})]}),vt==="schedule"&&s.jsx("input",{type:"datetime-local",value:e.scheduled_for,onChange:o=>t(w=>({...w,scheduled_for:o.target.value,send_now:!1}))})]})]})]}),s.jsxs("aside",{className:"campaigns-launch-preview",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:"Nombre del Cliente"}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(N==null?void 0:N.body_preview)||(N==null?void 0:N.body_text)||"Selecciona una plantilla para ver el contenido."}),Qr.length>0&&s.jsx("div",{className:"preview-actions",children:Qr.map((o,w)=>s.jsx("button",{type:"button",children:o.text||o.label||o.title||`Botn ${w+1}`},`preview-btn-${w}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Destinatarios"}),s.jsx("strong",{children:(Xr==null?void 0:Xr.count)||0})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:(N==null?void 0:N.name)||"Sin plantilla"})]})]})]})]}):s.jsxs("div",{className:"campaigns-dashboard",children:[s.jsxs("aside",{className:"campaigns-sidebar",children:[s.jsxs("label",{className:"campaigns-search",children:[s.jsx("span",{className:"template-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar campaa...",value:G,onChange:o=>ne(o.target.value)})]}),s.jsxs("div",{className:"campaigns-filters-list",children:[s.jsxs("button",{className:`campaigns-filter-item ${ie==="all"?"active":""}`,type:"button",onClick:()=>he("all"),children:[s.jsx("span",{children:"Todas las Campaas"}),s.jsx("span",{className:"campaigns-filter-count",children:Is.all})]}),s.jsxs("button",{className:`campaigns-filter-item ${ie==="completed"?"active":""}`,type:"button",onClick:()=>he("completed"),children:[s.jsx("span",{children:"Enviadas"}),s.jsx("span",{className:"campaigns-filter-count",children:Is.completed})]}),s.jsxs("button",{className:`campaigns-filter-item ${ie==="scheduled"?"active":""}`,type:"button",onClick:()=>he("scheduled"),children:[s.jsx("span",{children:"Programadas"}),s.jsx("span",{className:"campaigns-filter-count",children:Is.scheduled})]}),s.jsxs("button",{className:`campaigns-filter-item ${ie==="draft"?"active":""}`,type:"button",onClick:()=>he("draft"),children:[s.jsx("span",{children:"Borradores"}),s.jsx("span",{className:"campaigns-filter-count",children:Is.draft})]}),s.jsxs("button",{className:`campaigns-filter-item ${ie==="failed"?"active":""}`,type:"button",onClick:()=>he("failed"),children:[s.jsx("span",{children:"Fallidas"}),s.jsx("span",{className:"campaigns-filter-count",children:Is.failed})]})]}),s.jsxs("div",{className:"campaigns-quota",children:[s.jsx("div",{className:"campaigns-quota-title",children:"Cuota de mensajes"}),s.jsx("div",{className:"campaigns-quota-bar",children:s.jsx("div",{className:"campaigns-quota-fill",style:{width:"65%"}})}),s.jsx("div",{className:"campaigns-quota-meta",children:"65% usado"})]})]}),s.jsxs("div",{className:"campaigns-table-panel",children:[s.jsxs("div",{className:"campaigns-table-filters",children:[s.jsx("div",{className:"campaigns-filter-chip",children:"Canal: WhatsApp Business"}),s.jsx("div",{className:"campaigns-filter-chip",children:"Periodo: ltimos 30 das"}),s.jsxs("div",{className:"campaigns-table-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button",onClick:()=>C(ut,Rt,G.trim()),children:""})]})]}),s.jsxs("div",{className:"campaigns-table",children:[s.jsxs("div",{className:"campaigns-table-head",children:[s.jsx("span",{children:"Campaa"}),s.jsx("span",{children:"Fecha"}),s.jsx("span",{children:"Audiencia"}),s.jsx("span",{children:"Enviados"}),s.jsx("span",{children:"Ledos"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{})]}),rr.map(o=>{const w=o.messages_count||o.audience_count||"--",B=o.read_count||"--",K=o.reply_count||"--",te=Kr(o.status),Ne=sh[te]||te,Ye=["running","sending"].includes(te),un=["completed","failed"].includes(te),In=!Ye,dn=!Ye;return s.jsxs("div",{className:"campaigns-table-row",children:[s.jsxs("div",{className:"campaigns-table-title",children:[s.jsx("div",{className:"campaigns-table-name",children:o.name}),s.jsxs("div",{className:"campaigns-table-ref",children:["Ref: ",o.id.slice(0,10)]})]}),s.jsx("div",{className:"campaigns-table-date",children:S(o.created_at)}),s.jsx("div",{className:"campaigns-table-tags",children:s.jsx("span",{className:"campaigns-pill",children:o.audience_label||"Base General"})}),s.jsx("div",{className:"campaigns-metric",children:w}),s.jsx("div",{className:"campaigns-metric",children:B}),s.jsx("div",{className:"campaigns-metric",children:K}),s.jsx("div",{className:`campaigns-status ${te}`,children:Ne}),s.jsx("div",{className:"campaigns-row-actions",children:s.jsxs("div",{className:"campaigns-row-menu",children:[s.jsx("button",{className:"campaigns-row-menu-btn",type:"button","aria-label":"Opciones",onClick:is=>Jl(o.id,is),children:"..."}),le===o.id&&s.jsxs("div",{className:`campaigns-row-dropdown ${ve==="up"?"drop-up":""}`,children:[In&&s.jsx("button",{type:"button",onClick:()=>{Xl(o),ce(null)},children:"Editar"}),un&&s.jsx("button",{type:"button",onClick:()=>{ui(o),ce(null)},children:"Reenviar"}),dn&&s.jsx("button",{type:"button",className:"danger",onClick:()=>{ir(o),ce(null)},children:"Eliminar"})]})]})})]},o.id)}),!rr.length&&s.jsx("div",{className:"empty-state",children:"Sin campaas registradas"})]}),s.jsxs("div",{className:"campaigns-table-footer",children:[s.jsxs("span",{children:["Mostrando ",rr.length," de"," ",y||i.length," campaas"]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:ut<=1,onClick:()=>{const o=Math.max(1,ut-1);$t(o),C(o,Rt,G.trim())},children:"<"}),Vt.pages.map(o=>s.jsx("button",{className:`audiences-page-btn ${o===ut?"active":""}`,type:"button",onClick:()=>{$t(o),C(o,Rt,G.trim())},children:o},`camp-page-${o}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:ut>=Vt.totalPages,onClick:()=>{const o=Math.min(Vt.totalPages,ut+1);$t(o),C(o,Rt,G.trim())},children:">"})]})]})]})]})}),Ie==="history"&&s.jsxs("section",{className:"campaigns-panel campaigns-history",children:[s.jsxs("div",{className:"campaigns-history-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"campaigns-history-title",children:"Historial de Envos"}),s.jsx("div",{className:"campaigns-history-subtitle",children:"ltimos 30 das"})]}),s.jsx("button",{className:"campaigns-link",type:"button",onClick:C,children:"Ver todo el historial"})]}),s.jsxs("div",{className:"history-table history-table--main",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"Campaa / Fecha"}),s.jsx("span",{children:"Alcance"}),s.jsx("span",{children:"Tasa de lectura"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),i.map(o=>{const w=sh[o.status]||o.status,B=o.audience_count||o.messages_count||o.total||"--";return s.jsxs("div",{className:"history-row",children:[s.jsxs("div",{className:"history-title",children:[s.jsx("div",{className:"history-name",children:o.name}),s.jsx("div",{className:"history-date",children:S(o.created_at)})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:B}),s.jsx("div",{className:"history-label",children:"contactos"})]}),s.jsxs("div",{className:"history-meter",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-bar",children:s.jsx("div",{className:"history-bar-fill",style:{width:"0%"}})})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-label",children:"mensajes"})]}),s.jsx("div",{className:`history-status ${o.status}`,children:w}),s.jsxs("div",{className:"history-actions",children:[s.jsx("button",{className:"campaigns-ghost small",type:"button",onClick:()=>L(o.id),children:"Ver mensajes"}),s.jsx("button",{className:"campaigns-danger small",type:"button",onClick:()=>R(o.id),disabled:o.status==="sending",children:"Enviar"})]})]},o.id)}),!i.length&&s.jsx("div",{className:"empty-state",children:"Sin Campaas registradas"})]}),l&&s.jsxs("div",{className:"campaigns-messages",children:[s.jsx("div",{className:"campaigns-history-title",children:"Mensajes"}),s.jsxs("div",{className:"history-table history-table--messages",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"WA"}),s.jsx("span",{children:"Status"}),s.jsx("span",{children:"Enviado"})]}),c.map(o=>s.jsxs("div",{className:"history-row",children:[s.jsx("span",{children:o.wa_id}),s.jsx("span",{children:o.status}),s.jsx("span",{children:S(o.sent_at)})]},o.id))]})]})]})]})})]}),X&&s.jsx("div",{className:"modal-overlay",onClick:()=>de(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Previsualizar plantilla"}),s.jsx("button",{className:"modal-close",onClick:()=>de(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:$}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(pe==null?void 0:pe.body_preview)||(pe==null?void 0:pe.body_text)||"Sin previsualizacin disponible."}),li.length>0&&s.jsx("div",{className:"preview-actions",children:li.map((o,w)=>s.jsx("button",{type:"button",children:o.text||o.label||o.title||`Botn ${w+1}`},`preview-modal-btn-${w}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})}),xe&&s.jsx("div",{className:"modal-overlay",onClick:()=>Ze(!1),children:s.jsxs("div",{className:"modal-content",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Editar contacto"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>Ze(!1),children:"x"})]}),s.jsxs("form",{className:"modal-body",onSubmit:as,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:Ee.name,onChange:o=>Oe(w=>({...w,name:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Telfono"}),s.jsx("input",{type:"text",value:Ee.phone,onChange:o=>Oe(w=>({...w,phone:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:Ee.email,onChange:o=>Oe(w=>({...w,email:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"CI / NIT"}),s.jsx("input",{type:"text",value:Ee.vat,onChange:o=>Oe(w=>({...w,vat:o.target.value}))})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{className:"btn-secondary",type:"button",onClick:()=>Ze(!1),children:"Cancelar"}),s.jsx("button",{className:"btn-primary",type:"submit",disabled:rn,children:rn?"Guardando...":"Guardar"})]})]})]})})]})}function Sa({variant:e="error",title:t,message:n,actionLabel:r,onAction:a,dismissLabel:i="Cerrar",onDismiss:l}){const c=e==="offline"?"x":"!";return s.jsxs("div",{className:`notice-banner notice-banner-${e}`,children:[s.jsx("div",{className:"notice-icon","aria-hidden":"true",children:c}),s.jsxs("div",{className:"notice-content",children:[t?s.jsx("div",{className:"notice-title",children:t}):null,s.jsx("div",{className:"notice-text",children:n})]}),s.jsxs("div",{className:"notice-actions",children:[r&&s.jsx("button",{className:"notice-action",type:"button",onClick:a,children:r}),l&&s.jsx("button",{className:"notice-close",type:"button",onClick:l,children:i})]})]})}const oy={admin:{title:"Administrador",subtitle:"Acceso total",tone:"alert"},recepcion:{title:"Operador",subtitle:"Atencion al cliente",tone:"info"},caja:{title:"Supervisor",subtitle:"Auditoria y gestion",tone:"dark"},marketing:{title:"Marketing",subtitle:"Crecimiento y campanas",tone:"info"},doctor:{title:"Doctor",subtitle:"Atencion al cliente",tone:"dark"}},ih=[{id:"chat",label:"Chat"},{id:"dashboard",label:"Dashboard"},{id:"campaigns",label:"Campanas"}],lh=[{id:"general",label:"General"},{id:"users",label:"Gestion de Usuarios"},{id:"bot",label:"Configuracion de Bot"},{id:"templates",label:"Plantillas de Meta"},{id:"audit",label:"Registros / Auditoria"},{id:"odoo",label:"Integracion Odoo"}];function oh(e){return oy[e]||{title:e,subtitle:"Acceso personalizado",tone:"info"}}function cy({settingsTab:e,setSettingsTab:t,rolePermissions:n,setRolePermissions:r,isAdmin:a,adminUsers:i,userForm:l,setUserForm:c,roleOptions:u,handleUserSubmit:m,handleUserDelete:N,defaultRolePermissions:v,handleRoleDelete:x}){const[C,L]=f.useState(""),[R,g]=f.useState(!1),[h,p]=f.useState(""),[y,S]=f.useState(null),[D,$]=f.useState(!1),[I,_]=f.useState("create"),[O,P]=f.useState("recepcion"),[X,de]=f.useState({modules:{},settings:{}}),pe=f.useMemo(()=>{const A=C.trim().toLowerCase(),H=i||[];return A?H.filter(b=>{var le,ce;const U=((le=b.name)==null?void 0:le.toLowerCase())||"",q=((ce=b.email)==null?void 0:ce.toLowerCase())||"";return U.includes(A)||q.includes(A)}):H},[i,C]);function Fe(A){const H=(n==null?void 0:n[A])||(v==null?void 0:v[A])||{modules:{},settings:{}};return{modules:{...H.modules||{}},settings:{...H.settings||{}}}}function ke(A,H="edit"){_(H),P(A),de(Fe(A)),$(!0)}function Te(A,H,b){de(U=>{const q={...U},le={...q[A]||{}},ce={...le[H]||{}},ve=!ce[b];return ce[b]=ve,b==="write"&&ve&&(ce.read=!0),b==="read"&&!ve&&(ce.write=!1),le[H]=ce,q[A]=le,q})}function rt(){O&&(r(A=>({...A,[O]:X})),$(!1))}function F(){O&&x&&x(O),$(!1)}function G(A,H,b,U){a&&r(q=>{var ct,xe;const le={...q},ce={modules:{...(ct=le[A])==null?void 0:ct.modules},settings:{...(xe=le[A])==null?void 0:xe.settings}},ve={...ce[H]},at={...ve[b]},ot=!at[U];return at[U]=ot,U==="write"&&ot&&(at.read=!0),U==="read"&&!ot&&(at.write=!1),ve[b]=at,ce[H]=ve,le[A]=ce,le})}function ne(A){return oh(A).title.toUpperCase()}function ie(A,H){return A!=null&&A.id?`OP-${A.id.slice(-4).toUpperCase()}`:`OP-${String(H+1).padStart(4,"0")}`}function he(A){c({id:A.id,name:A.name,email:A.email,role:A.role,password:"",is_active:A.is_active}),g(!0)}function Ce(){c({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),g(!0)}return s.jsxs("div",{className:"users-page",children:[s.jsxs("header",{className:"users-header",children:[s.jsxs("div",{className:"users-title-row",children:[s.jsx("span",{className:"users-kicker"}),s.jsxs("div",{children:[s.jsx("div",{className:"users-title",children:"Gestion de Usuarios"}),s.jsx("div",{className:"users-subtitle",children:"Administra los accesos y roles de los operadores de tu empresa."})]})]}),s.jsxs("div",{className:"users-actions",children:[e==="list"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"users-search",children:[s.jsx("span",{className:"users-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar usuario...",value:C,onChange:A=>L(A.target.value)})]}),s.jsx("button",{className:"settings-primary",type:"button",onClick:Ce,children:"Nuevo Usuario"})]}),e==="roles"&&s.jsx("button",{className:"settings-primary",type:"button",onClick:()=>ke("recepcion","create"),children:"+ Nuevo Rol"})]})]}),s.jsxs("div",{className:"users-tabs",children:[s.jsx("button",{className:`users-tab ${e==="list"?"active":""}`,type:"button",onClick:()=>t("list"),children:"Lista de Usuarios"}),s.jsx("button",{className:`users-tab ${e==="roles"?"active":""}`,type:"button",onClick:()=>t("roles"),children:"Roles y Permisos"})]}),e==="list"&&s.jsxs("div",{className:"users-table",children:[s.jsxs("div",{className:"users-table-head",children:[s.jsx("span",{children:"Nombre / Usuario"}),s.jsx("span",{children:"Email"}),s.jsx("span",{children:"Rol"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),pe.map((A,H)=>{var b;return s.jsxs("div",{className:"users-row",children:[s.jsxs("div",{className:"users-cell user-name",children:[s.jsx("div",{className:"user-avatar",children:((b=A.name)==null?void 0:b[0])||"?"}),s.jsxs("div",{children:[s.jsx("div",{className:"user-title",children:A.name}),s.jsx("div",{className:"user-id",children:ie(A,H)})]})]}),s.jsx("div",{className:"users-cell",children:A.email}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`role-pill ${A.role}`,children:ne(A.role)})}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`status-pill ${A.is_active?"active":"inactive"}`,children:A.is_active?"Activo":"Inactivo"})}),s.jsx("div",{className:"users-cell",children:s.jsxs("div",{className:"users-actions-menu",children:[s.jsx("button",{className:"users-action",type:"button",onClick:()=>p(U=>U===A.id?"":A.id),children:"..."}),h===A.id&&s.jsxs("div",{className:"users-menu",children:[s.jsx("button",{type:"button",onClick:()=>{p(""),he(A)},children:"Editar"}),s.jsx("button",{type:"button",onClick:()=>{p(""),S(A)},children:"Eliminar"})]})]})})]},A.id)}),!pe.length&&s.jsx("div",{className:"empty-state",children:"Sin usuarios para mostrar"})]}),e==="roles"&&s.jsx("div",{className:"roles-grid",children:u.map(A=>{const H=oh(A),b=n==null?void 0:n[A];return s.jsxs("div",{className:"role-card",children:[s.jsxs("div",{className:"role-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"role-title",children:H.title}),s.jsx("div",{className:`role-subtitle ${H.tone}`,children:H.subtitle})]}),s.jsx("button",{className:"role-edit",type:"button",onClick:()=>ke(A,"edit"),children:"edit"})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),ih.map(U=>{var q,le,ce,ve;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((le=(q=b==null?void 0:b.modules)==null?void 0:q[U.id])==null?void 0:le.read)||!1,disabled:!a,onChange:()=>G(A,"modules",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ve=(ce=b==null?void 0:b.modules)==null?void 0:ce[U.id])==null?void 0:ve.write)||!1,disabled:!a,onChange:()=>G(A,"modules",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsx("div",{className:"role-settings-title",children:"Configuracion"}),lh.map(U=>{var q,le,ce,ve;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((le=(q=b==null?void 0:b.settings)==null?void 0:q[U.id])==null?void 0:le.read)||!1,disabled:!a,onChange:()=>G(A,"settings",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ve=(ce=b==null?void 0:b.settings)==null?void 0:ce[U.id])==null?void 0:ve.write)||!1,disabled:!a,onChange:()=>G(A,"settings",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]})]},A)})}),R&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:l.id?"Editar usuario":"Crear usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>g(!1),children:"x"})]}),s.jsxs("form",{className:"form-grid",onSubmit:async A=>{await m(A),g(!1)},children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:A=>c(H=>({...H,name:A.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:l.email,onChange:A=>c(H=>({...H,email:A.target.value})),disabled:!!l.id})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),s.jsx("select",{value:l.role,onChange:A=>c(H=>({...H,role:A.target.value})),children:u.map(A=>s.jsx("option",{value:A,children:A},A))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:l.password,onChange:A=>c(H=>({...H,password:A.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:A=>c(H=>({...H,is_active:A.target.checked}))}),"Activo"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"primary",type:"submit",children:l.id?"Guardar cambios":"Crear"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>g(!1),children:"Cancelar"})]})]})]})}),y&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Eliminar usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>S(null),children:"x"})]}),s.jsxs("p",{className:"modal-text",children:["Vas a desactivar a ",s.jsx("strong",{children:y.email}),". Continuar?"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"danger",type:"button",onClick:()=>{N==null||N(y.id),S(null)},children:"Eliminar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>S(null),children:"Cancelar"})]})]})}),D&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card modal-lg",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:I==="create"?"Nuevo rol":"Editar rol"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>$(!1),children:"x"})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),I==="edit"?s.jsx("select",{value:O,disabled:!0,children:u.map(A=>s.jsx("option",{value:A,children:A},A))}):s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"text",list:"role-options",placeholder:"nuevo-rol",value:O,onChange:A=>P(A.target.value)}),s.jsx("datalist",{id:"role-options",children:u.map(A=>s.jsx("option",{value:A},A))})]})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Modulos"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),ih.map(A=>{var H,b,U,q;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:A.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((b=(H=X==null?void 0:X.modules)==null?void 0:H[A.id])==null?void 0:b.read)||!1,onChange:()=>Te("modules",A.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((q=(U=X==null?void 0:X.modules)==null?void 0:U[A.id])==null?void 0:q.write)||!1,onChange:()=>Te("modules",A.id,"write")}),s.jsx("span",{})]})]},A.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Configuracion"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),lh.map(A=>{var H,b,U,q;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:A.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((b=(H=X==null?void 0:X.settings)==null?void 0:H[A.id])==null?void 0:b.read)||!1,onChange:()=>Te("settings",A.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((q=(U=X==null?void 0:X.settings)==null?void 0:U[A.id])==null?void 0:q.write)||!1,onChange:()=>Te("settings",A.id,"write")}),s.jsx("span",{})]})]},A.id)})]})]}),s.jsxs("div",{className:"form-actions",children:[I==="edit"&&s.jsx("button",{className:"danger",type:"button",onClick:F,children:"Eliminar rol"}),s.jsx("button",{className:"primary",type:"button",onClick:rt,disabled:!O,children:"Guardar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>$(!1),children:"Cancelar"})]})]})})]})}function uy({branches:e,branchForm:t,setBranchForm:n,handleBranchSubmit:r,handleBranchDisable:a,services:i,serviceForm:l,setServiceForm:c,handleServiceSubmit:u,handleServiceDisable:m,handleServiceBranchToggle:N,tenantChannels:v,channelForm:x,setChannelForm:C,handleChannelSelect:L,handleChannelSubmit:R}){return s.jsxs("div",{className:"page-grid",children:[s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Sucursales"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Nombre"}),s.jsx("span",{children:"Codigo"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Accion"})]}),e.map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.name}),s.jsx("span",{children:g.code}),s.jsx("span",{children:g.is_active?"Activa":"Inactiva"}),s.jsxs("div",{className:"row-actions",children:[s.jsx("button",{className:"ghost",onClick:()=>n({id:g.id,code:g.code,name:g.name,address:g.address,lat:g.lat,lng:g.lng,hours_text:g.hours_text,phone:g.phone||"",is_active:g.is_active}),children:"Editar"}),s.jsx("button",{className:"danger",onClick:()=>a(g.id),children:"Desactivar"})]})]},g.id))]}),s.jsx("div",{className:"panel-title",children:t.id?"Editar sucursal":"Crear sucursal"}),s.jsxs("form",{className:"form-grid",onSubmit:r,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Codigo"}),s.jsx("input",{type:"text",value:t.code,onChange:g=>n(h=>({...h,code:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:t.name,onChange:g=>n(h=>({...h,name:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Direccion"}),s.jsx("input",{type:"text",value:t.address,onChange:g=>n(h=>({...h,address:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Lat"}),s.jsx("input",{type:"number",value:t.lat,onChange:g=>n(h=>({...h,lat:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Lng"}),s.jsx("input",{type:"number",value:t.lng,onChange:g=>n(h=>({...h,lng:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Telefono"}),s.jsx("input",{type:"text",value:t.phone,onChange:g=>n(h=>({...h,phone:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Horarios"}),s.jsx("textarea",{rows:"3",value:t.hours_text,onChange:g=>n(h=>({...h,hours_text:g.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:t.is_active,onChange:g=>n(h=>({...h,is_active:g.target.checked}))}),"Activa"]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Guardar"})})]})]}),s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Servicios"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Servicio"}),s.jsx("span",{children:"Precio"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Accion"})]}),i.map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.name}),s.jsxs("span",{children:["Bs ",g.price_bob]}),s.jsx("span",{children:g.is_active?"Activo":"Inactivo"}),s.jsxs("div",{className:"row-actions",children:[s.jsx("button",{className:"ghost",onClick:()=>c({id:g.id,code:g.code,name:g.name,subtitle:g.subtitle||"",description:g.description,price_bob:g.price_bob,duration_min:g.duration_min||"",image_url:g.image_url||"",is_featured:g.is_featured,is_active:g.is_active}),children:"Editar"}),s.jsx("button",{className:"danger",onClick:()=>m(g.id),children:"Desactivar"})]})]},g.id))]}),s.jsx("div",{className:"panel-title",children:l.id?"Editar servicio":"Crear servicio"}),s.jsxs("form",{className:"form-grid",onSubmit:u,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Codigo"}),s.jsx("input",{type:"text",value:l.code,onChange:g=>c(h=>({...h,code:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:g=>c(h=>({...h,name:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Subtitulo"}),s.jsx("input",{type:"text",value:l.subtitle,onChange:g=>c(h=>({...h,subtitle:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Descripcion"}),s.jsx("textarea",{rows:"3",value:l.description,onChange:g=>c(h=>({...h,description:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Precio (Bs)"}),s.jsx("input",{type:"number",value:l.price_bob,onChange:g=>c(h=>({...h,price_bob:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Duracion (min)"}),s.jsx("input",{type:"number",value:l.duration_min,onChange:g=>c(h=>({...h,duration_min:g.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Imagen URL"}),s.jsx("input",{type:"text",value:l.image_url,onChange:g=>c(h=>({...h,image_url:g.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_featured,onChange:g=>c(h=>({...h,is_featured:g.target.checked}))}),"Destacado"]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:g=>c(h=>({...h,is_active:g.target.checked}))}),"Activo"]}),l.id&&s.jsxs("div",{className:"field",children:[s.jsx("span",{children:"Disponibilidad por sucursal"}),s.jsx("div",{className:"chip-grid",children:e.map(g=>{var y,S;const h=(S=(y=i.find(D=>D.id===l.id))==null?void 0:y.branches)==null?void 0:S.find(D=>{var I;return(((I=D.branch)==null?void 0:I.id)||D.branch_id)===g.id}),p=(h==null?void 0:h.is_available)||!1;return s.jsxs("label",{className:"chip",children:[s.jsx("input",{type:"checkbox",checked:p,onChange:D=>N(i.find($=>$.id===l.id),g.id,D.target.checked)}),g.name]},g.id)})})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Guardar"})})]})]}),s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Lineas de WhatsApp"}),s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head",children:[s.jsx("span",{children:"Nombre"}),s.jsx("span",{children:"Phone ID"}),s.jsx("span",{children:"Accion"})]}),(v||[]).map(g=>s.jsxs("div",{className:"table-row",children:[s.jsx("span",{children:g.display_name||"Linea sin nombre"}),s.jsx("span",{children:g.phone_number_id}),s.jsx("button",{className:"ghost",onClick:()=>L(g),children:"Renombrar"})]},g.id)),!(v!=null&&v.length)&&s.jsx("div",{className:"empty-state",children:"Sin lineas registradas"})]}),s.jsx("div",{className:"panel-title",children:x.id?"Editar linea":"Selecciona una linea"}),s.jsxs("form",{className:"form-grid",onSubmit:R,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre visible"}),s.jsx("input",{type:"text",value:x.display_name,onChange:g=>C(h=>({...h,display_name:g.target.value})),disabled:!x.id})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"primary",type:"submit",disabled:!x.id,children:"Guardar"})})]})]})]})}function dy(){var L,R,g,h,p,y,S,D,$,I;const[e,t]=f.useState([]),[n,r]=f.useState(null),[a,i]=f.useState(!0),[l,c]=f.useState("");f.useEffect(()=>{u()},[]);async function u(){i(!0);try{const[_,O]=await Promise.all([me("/api/admin/bots"),me("/api/admin/bots/metrics")]);t(_.bots||[]),r(O.metrics),c("")}catch(_){console.error(_),c(_.message||"Error al cargar datos")}finally{i(!1)}}async function m(_,O){try{await Ke(`/api/admin/bots/${_}`,{is_active:O}),t(P=>P.map(X=>X.id===_?{...X,is_active:O}:X))}catch(P){c(P.message||"Error al cambiar estado")}}const N=_=>{if(!_)return"Sin actividad reciente";const O=new Date(_),X=new Date-O,de=Math.floor(X/6e4);if(de<1)return"Hace un momento";if(de<60)return`ltima actividad: hace ${de} min`;const pe=Math.floor(de/60);return pe<24?`ltima actividad: hace ${pe}h`:`ltima actividad: ${O.toLocaleDateString()}`},v=e.filter(_=>_.is_active).length,x=v>0?"ACTIVO":"INACTIVO",C=v>0?"active":"inactive";return s.jsxs("div",{className:"bot-section",children:[s.jsxs("div",{className:"bot-section-header",children:[s.jsxs("div",{className:"bot-section-title-area",children:[s.jsx("div",{className:"bot-section-icon",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"bot-section-title",children:"Gestin de Bots"}),s.jsx("p",{className:"bot-section-subtitle",children:"Administra los flujos automatizados y el rendimiento tcnico."})]})]}),s.jsxs("div",{className:"bot-section-global-toggle",children:[s.jsx("span",{className:"bot-toggle-label",children:"ESTADO DEL BOT:"}),s.jsxs("div",{className:`bot-toggle-pill ${C}`,children:[s.jsx("span",{className:"bot-toggle-dot"}),s.jsx("span",{children:x})]})]})]}),l&&s.jsx("div",{className:"bot-error",children:l}),s.jsxs("div",{className:"bot-section-content",children:[s.jsxs("div",{className:"bot-flows-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MONITOREO DE FLUJOS"})}),a?s.jsx("div",{className:"bot-loading",children:"Cargando bots..."}):e.length===0?s.jsxs("div",{className:"bot-empty",children:[s.jsx("p",{children:"No hay bots asignados a tu cuenta."}),s.jsx("p",{className:"bot-empty-hint",children:"Contacta con soporte si necesitas activar un bot."})]}):s.jsx("div",{className:"bot-flows-list",children:e.map(_=>s.jsxs("div",{className:"bot-flow-card",children:[s.jsxs("div",{className:"bot-flow-info",children:[s.jsx("span",{className:"bot-flow-icon",children:_.flow_icon||""}),s.jsxs("div",{children:[s.jsx("div",{className:"bot-flow-name",children:_.flow_name}),s.jsxs("div",{className:`bot-flow-status ${_.is_active?"active":"inactive"}`,children:[" ",_.is_active?"ACTIVO":"INACTIVO"]})]})]}),s.jsx("div",{className:"bot-flow-actions",children:s.jsxs("label",{className:"bot-toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:_.is_active,onChange:()=>m(_.id,!_.is_active)}),s.jsx("span",{className:"bot-toggle-slider"})]})}),s.jsx("div",{className:"bot-flow-meta",children:N(_.updated_at)}),_.flow_description&&s.jsx("div",{className:"bot-flow-desc",children:_.flow_description})]},_.id))})]}),s.jsxs("div",{className:"bot-metrics-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MTRICAS DE EFICACIA DETALLADAS"})}),s.jsxs("div",{className:"bot-metrics-grid",children:[s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:`bot-metric-badge ${((L=n==null?void 0:n.interactions)==null?void 0:L.change)>=0?"positive":"neutral"}`,children:[((R=n==null?void 0:n.interactions)==null?void 0:R.change)>0?"+":"",(g=n==null?void 0:n.interactions)==null?void 0:g.change,"% ",(h=n==null?void 0:n.interactions)==null?void 0:h.label]}),s.jsx("div",{className:"bot-metric-label",children:"INTERACCIONES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.interactions.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"Total de sesiones iniciadas hoy"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge neutral",children:["Objetivo: ",(p=n==null?void 0:n.resolution)==null?void 0:p.target,"%"]}),s.jsx("div",{className:"bot-metric-label",children:"RESOLUCIN FINAL"}),s.jsxs("div",{className:"bot-metric-value",children:[n?n.resolution.value:"--","%"]}),s.jsx("div",{className:"bot-metric-progress",children:s.jsx("div",{className:"bot-metric-progress-fill",style:{width:`${n?n.resolution.value:0}%`}})})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge sla",children:[" ",(y=n==null?void 0:n.uptime)==null?void 0:y.status]}),s.jsx("div",{className:"bot-metric-label",children:"VIDA DEL PROCESO"}),s.jsx("div",{className:"bot-metric-value",children:n?n.uptime.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"UPTIME SISTEMA"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:`bot-metric-icon ${((S=n==null?void 0:n.errors)==null?void 0:S.value)>0?"error":""}`,children:""}),s.jsx("div",{className:`bot-metric-badge ${((D=n==null?void 0:n.errors)==null?void 0:D.value)===0?"stable":"neutral"}`,children:($=n==null?void 0:n.errors)==null?void 0:$.status}),s.jsx("div",{className:"bot-metric-label",children:"ERRORES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.errors.value:"--"}),s.jsxs("div",{className:`bot-metric-sub ${((I=n==null?void 0:n.errors)==null?void 0:I.critical)>0?"error-sub":""}`,children:["CRTICOS: ",n?n.errors.critical:0]})]})]})]})]})]})}const ch={DRAFT:{bg:"#e3e8ef",text:"#475569",label:"BORRADOR"},PENDING:{bg:"#fef3c7",text:"#d97706",label:"PENDIENTE"},APPROVED:{bg:"#d1fae5",text:"#059669",label:"APROBADA"},REJECTED:{bg:"#fee2e2",text:"#dc2626",label:"RECHAZADA"},PAUSED:{bg:"#fef3c7",text:"#d97706",label:"PAUSADA"},DISABLED:{bg:"#e5e7eb",text:"#6b7280",label:"DESHABILITADA"}},hy=[{value:"UTILITY",label:"Utility"},{value:"MARKETING",label:"Marketing"},{value:"AUTHENTICATION",label:"Authentication"}],fy=[{value:"es",label:"Espaol (ES)"},{value:"en",label:"English (EN)"}];function py({templates:e=[],templateForm:t,setTemplateForm:n,handleTemplateSubmit:r,handleTemplateSubmitToMeta:a,handleTemplateDelete:i,handleSyncTemplates:l,onLoadTemplates:c,brandName:u=""}){var H;const m=(u||"PODOPIE").trim(),[N,v]=f.useState("list"),[x,C]=f.useState(null),[L,R]=f.useState(""),[g,h]=f.useState(!1),[p,y]=f.useState(""),[S,D]=f.useState(!1),[$,I]=f.useState(!1),[_,O]=f.useState(null),[P,X]=f.useState({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),[de,pe]=f.useState([]);f.useEffect(()=>{c&&c()},[]);const Fe=async()=>{h(!0);try{await l()}finally{h(!1)}},ke=()=>{C(null),X({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),pe([]),v("editor")},Te=b=>{C(b),X({name:b.name||"",category:b.category||"UTILITY",language:b.language||"es",body_text:b.body_text||b.body_preview||"",header_type:b.header_type||"",header_content:b.header_content||"",footer_text:b.footer_text||"",buttons:b.buttons_json||[]}),pe(b.variable_mappings||[]),v("editor")},rt=async b=>{!(b!=null&&b.id)||!i||!window.confirm(`Eliminar la plantilla "${b.name}"? Esta accin la ocultar localmente y la eliminar de Meta si aplica.`)||await i(b.id)},F=async b=>{b.preventDefault();const U={...P,id:x==null?void 0:x.id,variable_mappings:de};if(n&&n(U),r){const q=await r(null,U);q&&C(q)}},G=async()=>{if(a){D(!0);try{let b=x==null?void 0:x.id;if(!b){const U={...P,variable_mappings:de},q=await r(null,U);b=q==null?void 0:q.id,q&&C(q)}b&&(await a(b),v("list"),C(null))}finally{D(!1)}}},ne=()=>{v("list"),C(null)},ie=b=>{const U=(b==null?void 0:b.buttons_json)??(b==null?void 0:b.buttons)??[];if(Array.isArray(U))return U;if(typeof U=="string")try{const q=JSON.parse(U);return Array.isArray(q)?q:[]}catch{return[]}return[]},Ce=(b=>{const U=b.match(/\{\{(\d+)\}\}/g)||[];return[...new Set(U)].map(q=>parseInt(q.replace(/[{}]/g,"")))})(P.body_text),A=e.filter(b=>{var le;const U=!L||((le=b.name)==null?void 0:le.toLowerCase().includes(L.toLowerCase()))||(b.body_text||b.body_preview||"").toLowerCase().includes(L.toLowerCase()),q=!p||b.status===p;return U&&q});return N==="list"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"templates-section",children:[s.jsxs("div",{className:"templates-header",children:[s.jsxs("div",{className:"templates-title-row",children:[s.jsx("h1",{children:"Plantillas de Meta"}),s.jsxs("span",{className:"meta-connected-badge",children:[s.jsx("span",{className:"status-dot"}),"CONECTADO A META API"]})]}),s.jsxs("div",{className:"templates-actions",children:[s.jsx("div",{className:"search-input-wrap",children:s.jsx("input",{type:"text",placeholder:"Buscar plantillas...",value:L,onChange:b=>R(b.target.value)})}),s.jsxs("select",{value:p,onChange:b=>y(b.target.value),className:"status-filter-select",children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"APPROVED",children:"Aprobadas"}),s.jsx("option",{value:"PENDING",children:"Pendientes"}),s.jsx("option",{value:"REJECTED",children:"Rechazadas"}),s.jsx("option",{value:"DRAFT",children:"Borradores"})]}),s.jsx("button",{className:"btn-sync",onClick:Fe,disabled:g,children:g?" Sincronizando...":" Sincronizar"}),s.jsxs("button",{className:"btn-create-template",onClick:ke,children:[s.jsx("span",{children:"+"})," Crear Nueva Plantilla"]})]})]}),s.jsxs("div",{className:"templates-grid",children:[A.map(b=>{var q;const U=ch[b.status]||ch.DRAFT;return s.jsxs("div",{className:"template-card",onClick:()=>Te(b),children:[s.jsxs("div",{className:"template-card-head",children:[s.jsx("div",{className:"template-category-icon",children:b.category==="MARKETING"?"":b.category==="UTILITY"?"":""}),s.jsx("span",{className:"template-status-badge",style:{backgroundColor:U.bg,color:U.text},children:U.label})]}),s.jsx("h3",{className:"template-card-name",children:b.name}),s.jsxs("div",{className:"template-card-meta",children:[s.jsx("span",{className:"tag-category",children:b.category}),s.jsx("span",{className:"tag-language",children:b.language==="es"?"ESPAOL (ES)":(q=b.language)==null?void 0:q.toUpperCase()})]}),(b.body_text||b.body_preview)&&s.jsxs("p",{className:"template-card-preview",children:[(b.body_text||b.body_preview).slice(0,80),"..."]}),s.jsxs("div",{className:"template-card-actions",children:[s.jsx("button",{className:"btn-preview",onClick:le=>{le.stopPropagation(),O(b),I(!0)},children:"Vista previa"}),s.jsx("button",{className:"btn-preview danger",onClick:le=>{le.stopPropagation(),rt(b)},children:"Eliminar"})]})]},b.id)}),s.jsxs("div",{className:"template-card template-card-create",onClick:ke,children:[s.jsx("div",{className:"create-icon",children:"+"}),s.jsx("h3",{children:"Crear nueva plantilla"}),s.jsx("p",{children:"Empieza a disear tu flujo de WhatsApp"})]})]}),A.length===0&&!L&&s.jsx("div",{className:"templates-empty",children:s.jsx("p",{children:"No hay plantillas. Crea una nueva o sincroniza desde Meta."})})]}),$&&s.jsx("div",{className:"modal-overlay",onClick:()=>I(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:b=>b.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Vista previa"}),s.jsx("button",{className:"modal-close",onClick:()=>I(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:m}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(_==null?void 0:_.body_preview)||(_==null?void 0:_.body_text)||"Sin previsualizacin disponible."}),ie(_).length>0&&s.jsx("div",{className:"preview-actions",children:ie(_).map((b,U)=>s.jsx("button",{type:"button",children:b.text||b.label||b.title||`Botn ${U+1}`},`prev-${U}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})})]}):s.jsxs("div",{className:"template-editor",children:[s.jsxs("div",{className:"editor-header",children:[s.jsxs("div",{className:"editor-breadcrumb",children:[s.jsx("button",{className:"btn-back",onClick:ne,children:" Volver"}),s.jsx("span",{className:"breadcrumb-sep",children:"/"}),s.jsx("span",{children:x?"Editar Plantilla":"Nueva Plantilla"})]}),s.jsxs("div",{className:"editor-actions",children:[s.jsx("button",{className:"btn-save-draft",onClick:F,children:" Guardar Borrador"}),((x==null?void 0:x.status)==="DRAFT"||(x==null?void 0:x.status)==="REJECTED"||!x)&&s.jsx("button",{className:"btn-primary",onClick:G,disabled:S||!P.name||!P.body_text,children:S?"Enviando...":"Enviar a Meta"}),s.jsx("button",{className:"btn-discard",onClick:ne,children:" Descartar"})]})]}),s.jsxs("div",{className:"editor-layout",children:[s.jsxs("div",{className:"editor-form-panel",children:[s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" General Settings"}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Template Name"}),s.jsx("input",{type:"text",placeholder:"patient_appointment_reminder",value:P.name,onChange:b=>X({...P,name:b.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")})})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Category"}),s.jsx("select",{value:P.category,onChange:b=>X({...P,category:b.target.value}),children:hy.map(b=>s.jsx("option",{value:b.value,children:b.label},b.value))})]}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Language"}),s.jsx("select",{value:P.language,onChange:b=>X({...P,language:b.target.value}),children:fy.map(b=>s.jsx("option",{value:b.value,children:b.label},b.value))})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("div",{className:"form-section-header",children:[s.jsx("h3",{children:" Message Body"}),s.jsx("button",{className:"btn-insert-var",type:"button",onClick:()=>{const b=Ce.length+1;X({...P,body_text:P.body_text+`{{${b}}}`})},children:"+ Insert Variable"})]}),s.jsx("textarea",{rows:"6",placeholder:`Hola {{1}}, te recordamos tu cita en ${m} para el da {{2}} a las {{3}}. Por favor, confirma tu asistencia.`,value:P.body_text,onChange:b=>X({...P,body_text:b.target.value})}),s.jsxs("div",{className:"char-count",children:[P.body_text.length," / 1024"]})]})]}),s.jsxs("div",{className:"editor-preview-panel",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:m}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:P.body_text||"Tu mensaje aparecer aqu..."}),P.buttons&&P.buttons.length>0&&s.jsx("div",{className:"preview-actions",children:P.buttons.map((b,U)=>s.jsx("button",{type:"button",children:b.text||b.title||`Botn ${U+1}`},`btn-${U}`))}),s.jsx("div",{className:"preview-time",children:"10:42 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:P.name||"Sin nombre"})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Idioma"}),s.jsx("strong",{children:((H=P.language)==null?void 0:H.toUpperCase())||"ES"})]})]})]}),s.jsxs("div",{className:"editor-mapping-panel",children:[s.jsxs("div",{className:"mapping-tabs",children:[s.jsx("button",{className:"tab active",children:"VARIABLES"}),s.jsx("button",{className:"tab",children:"BUTTONS"})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsx("h4",{children:"ODOO FIELD MAPPING"}),Ce.length===0?s.jsxs("p",{className:"mapping-empty",children:["Agrega variables ","{{1}}",", ","{{2}}","... en tu mensaje"]}):Ce.map(b=>{const U=de.find(q=>q.var_index===b)||{};return s.jsxs("div",{className:"mapping-item",children:[s.jsxs("div",{className:"mapping-var-badge",children:[`{{${b}}}`," Variable"]}),s.jsxs("select",{value:U.source_path||"",onChange:q=>{const le=de.filter(ce=>ce.var_index!==b);le.push({var_index:b,source_type:"odoo",source_path:q.target.value}),pe(le)},children:[s.jsx("option",{value:"",children:"Select Odoo Field..."}),s.jsx("option",{value:"partner_id.name",children:"patient_id.name"}),s.jsx("option",{value:"start_date",children:"start_date (Formatted)"}),s.jsx("option",{value:"start_time",children:"start_time"}),s.jsx("option",{value:"partner_id.phone",children:"patient_phone"})]}),s.jsx("span",{className:`mapping-status ${U.source_path?"linked":"needs"}`,children:U.source_path?" Linked":" Needs mapping"})]},b)})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsxs("div",{className:"mapping-section-header",children:[s.jsx("h4",{children:"ACTION BUTTONS"}),s.jsx("button",{className:"btn-add-button",onClick:()=>{X({...P,buttons:[...P.buttons||[],{type:"QUICK_REPLY",text:""}]})},children:"+ Add Button"})]}),(P.buttons||[]).map((b,U)=>s.jsxs("div",{className:"button-item",children:[s.jsx("span",{className:"button-icon",children:""}),s.jsx("input",{type:"text",placeholder:"Button text",value:b.text||"",onChange:q=>{const le=[...P.buttons];le[U]={...le[U],text:q.target.value},X({...P,buttons:le})}}),s.jsx("button",{className:"btn-remove",onClick:()=>{const q=P.buttons.filter((le,ce)=>ce!==U);X({...P,buttons:q})},children:""})]},U))]}),s.jsxs("div",{className:"mapping-tip",children:[s.jsx("span",{className:"tip-icon",children:""}),s.jsx("span",{children:"Tip: Asegrate de que tus variables estn correctamente mapeadas a campos de Odoo antes de enviar."})]})]})]})]})}const uh={campaigns:"",users:"",bot:"",chat:"",templates:"",audience:"",system:""},my={"user.created":"USUARIO CREADO","user.updated":"USUARIO EDITADO","user.disabled":"USUARIO ELIMINADO",template_draft_created:"PLANTILLA CREADA",template_draft_updated:"PLANTILLA EDITADA",template_submitted:"PLANTILLA ENVIADA",template_deleted:"PLANTILLA ELIMINADA",template_restored:"PLANTILLA RESTAURADA",audience_created:"SEGMENTO CREADO",audience_updated:"SEGMENTO EDITADO",audience_deleted:"SEGMENTO ELIMINADO","campaign.created":"CAMPAA CREADA","campaign.queued":"CAMPAA EN COLA","campaign.sending":"CAMPAA LANZADA","settings.updated":"CONFIG ACTUALIZADA","role_permissions.updated":"PERMISOS CAMBIADOS","role_permissions.deleted":"ROL ELIMINADO","conversation.status_changed":"CHAT ACTUALIZADO","conversation.tag_added":"TAG AGREGADO","conversation.tag_removed":"TAG ELIMINADO"};function Yp(e){var r;const t=((r=e==null?void 0:e.data_json)==null?void 0:r.entity)||"";if(t==="template")return"templates";if(t==="audience")return"audience";if(t==="campaign")return"campaigns";if(t==="conversation")return"chat";const n=(e==null?void 0:e.action)||"";return n.includes("user")?"users":n.includes("campaign")?"campaigns":n.includes("template")?"templates":n.includes("audience")?"audience":n.includes("bot")?"bot":n.includes("conversation")?"chat":"system"}function Mo(e){if(!e)return{date:"--",time:"--"};const t=new Date(e);return Number.isNaN(t.getTime())?{date:"--",time:"--"}:{date:t.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}),time:t.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}}function gy(e,t="csv"){const r=[["timestamp","usuario","email","accion","modulo","data"].join(",")];e.forEach(m=>{var L,R;const N=((L=m.user)==null?void 0:L.name)||"Sistema",v=((R=m.user)==null?void 0:R.email)||"",x=Yp(m),C=[new Date(m.created_at).toISOString(),N,v,m.action,x,JSON.stringify(m.data_json||{})];r.push(C.map(g=>`"${String(g).replace(/"/g,'""')}"`).join(","))});const a=r.join(`
`),i=t==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv;charset=utf-8;",l=t==="excel"?"audit_logs.xlsx":"audit_logs.csv",c=new Blob([a],{type:i}),u=document.createElement("a");u.href=URL.createObjectURL(c),u.download=l,document.body.appendChild(u),u.click(),document.body.removeChild(u)}function vy(){var $,I;const[e,t]=f.useState(""),[n,r]=f.useState(""),[a,i]=f.useState(""),[l,c]=f.useState(1),[u]=f.useState(6),[m,N]=f.useState(0),[v,x]=f.useState([]),[C,L]=f.useState(!1),[R,g]=f.useState(null),h=Math.max(1,Math.ceil(m/u)),p=async({pageOverride:_}={})=>{L(!0);try{const O=new URLSearchParams;O.set("page",String(_||l)),O.set("page_size",String(u)),e.trim()&&O.set("q",e.trim()),n&&O.set("from",n),a&&O.set("to",a);const P=await me(`/api/admin/audit?${O.toString()}`);x(P.logs||[]),N(P.total||0)}finally{L(!1)}};f.useEffect(()=>{p()},[l]);const y=()=>{c(1),p({pageOverride:1})},S=async(_="csv")=>{const O=new URLSearchParams;O.set("page","1"),O.set("page_size","1000"),e.trim()&&O.set("q",e.trim()),n&&O.set("from",n),a&&O.set("to",a);const P=await me(`/api/admin/audit?${O.toString()}`);gy(P.logs||[],_)},D=f.useMemo(()=>{const _=[],O=Math.max(1,l-1),P=Math.min(h,O+2);for(let X=O;X<=P;X+=1)_.push(X);return _},[l,h]);return s.jsxs("div",{className:"audit-module",children:[s.jsxs("div",{className:"audit-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-title",children:"Registros / Auditoria"}),s.jsx("div",{className:"audit-subtitle",children:"Monitorea acciones de usuarios y eventos del sistema"})]}),s.jsxs("div",{className:"audit-export-group",children:[s.jsx("button",{className:"audit-export",type:"button",onClick:()=>S("excel"),children:" Exportar Excel"}),s.jsx("button",{className:"audit-export outline",type:"button",onClick:()=>S("csv"),children:" Exportar CSV"})]})]}),s.jsxs("div",{className:"audit-filters",children:[s.jsxs("div",{className:"audit-search",children:[s.jsx("span",{className:"audit-search-icon"}),s.jsx("input",{type:"text",placeholder:"Filtrar por usuario o accion..",value:e,onChange:_=>t(_.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Desde"}),s.jsx("input",{type:"date",value:n,onChange:_=>r(_.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Hasta"}),s.jsx("input",{type:"date",value:a,onChange:_=>i(_.target.value)})]}),s.jsx("button",{className:"audit-filter-btn",type:"button",onClick:y,children:"Filtrar"})]}),s.jsxs("div",{className:"audit-card",children:[s.jsxs("div",{className:"audit-table-head",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("span",{children:"Usuario"}),s.jsx("span",{children:"Accion"}),s.jsx("span",{children:"Modulo"})]}),C&&s.jsx("div",{className:"audit-empty",children:"Cargando registros..."}),!C&&!v.length&&s.jsx("div",{className:"audit-empty",children:"Sin registros para mostrar"}),!C&&v.map(_=>{var Fe,ke;const O=Mo(_.created_at),P=Yp(_),X=my[_.action]||_.action,de=((Fe=_.user)==null?void 0:Fe.name)||"System Bot",pe=((ke=_.user)==null?void 0:ke.email)||"automated@service";return s.jsxs("button",{type:"button",className:"audit-row",onClick:()=>g(_),children:[s.jsxs("div",{className:"audit-cell time",children:[s.jsx("div",{children:O.date}),s.jsx("div",{className:"audit-time",children:O.time})]}),s.jsxs("div",{className:"audit-cell user",children:[s.jsx("div",{className:"audit-avatar",children:(de==null?void 0:de[0])||"S"}),s.jsxs("div",{children:[s.jsx("div",{className:"audit-user-name",children:de}),s.jsx("div",{className:"audit-user-email",children:pe})]})]}),s.jsx("div",{className:"audit-cell action",children:s.jsx("span",{className:"audit-action-pill",children:X})}),s.jsxs("div",{className:"audit-cell module",children:[s.jsx("span",{className:"audit-module-icon",children:uh[P]||uh.system}),P.charAt(0).toUpperCase()+P.slice(1)]})]},_.id)})]}),s.jsxs("div",{className:"audit-footer",children:[s.jsxs("div",{children:["Mostrando ",v.length," de ",m," registros"]}),s.jsxs("div",{className:"audit-pagination",children:[s.jsx("button",{type:"button",disabled:l<=1,onClick:()=>c(_=>Math.max(1,_-1)),children:""}),D.map(_=>s.jsx("button",{type:"button",className:_===l?"active":"",onClick:()=>c(_),children:_},_)),s.jsx("button",{type:"button",disabled:l>=h,onClick:()=>c(_=>Math.min(h,_+1)),children:""})]})]}),R&&s.jsx("div",{className:"audit-modal",children:s.jsxs("div",{className:"audit-modal-card",children:[s.jsxs("div",{className:"audit-modal-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-modal-title",children:"Detalle del registro"}),s.jsx("div",{className:"audit-modal-subtitle",children:R.action})]}),s.jsx("button",{type:"button",onClick:()=>g(null),children:""})]}),s.jsxs("div",{className:"audit-modal-body",children:[s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Usuario"}),s.jsx("strong",{children:(($=R.user)==null?void 0:$.name)||"System Bot"}),s.jsx("small",{children:((I=R.user)==null?void 0:I.email)||"automated@service"})]}),s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("strong",{children:Mo(R.created_at).date}),s.jsx("small",{children:Mo(R.created_at).time})]}),s.jsxs("div",{className:"audit-detail full",children:[s.jsx("span",{children:"Data"}),s.jsx("pre",{children:JSON.stringify(R.data_json||{},null,2)})]})]})]})})]})}function xy(){return s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Integracion Odoo"}),s.jsx("div",{className:"empty-state",children:"Seccion en construccion"})]})}function yy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("line",{x1:"4",y1:"6",x2:"20",y2:"6",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"6",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"18",x2:"20",y2:"18",strokeWidth:"2"}),s.jsx("circle",{cx:"11",cy:"18",r:"2",strokeWidth:"2"})]})}function jy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"9",cy:"8",r:"3",strokeWidth:"2"}),s.jsx("path",{d:"M4 20c0-3 2.7-5.5 6-5.5s6 2.5 6 5.5",strokeWidth:"2"}),s.jsx("circle",{cx:"17",cy:"9",r:"2",strokeWidth:"2"}),s.jsx("path",{d:"M14 20c0-1.8 1.4-3.4 3.2-4",strokeWidth:"2"})]})}function Ny(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"2"})]})}function wy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"4",width:"12",height:"16",rx:"2",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"9",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"13",x2:"15",y2:"13",strokeWidth:"2"})]})}function _y(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"5",width:"12",height:"15",rx:"2",strokeWidth:"2"}),s.jsx("path",{d:"M9 5h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 10h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 14h6",strokeWidth:"2"})]})}function Sy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M8 4h4a2 2 0 1 1 0 4h-1v2h2a2 2 0 1 1 0 4h-2v2H8a2 2 0 1 1-4 0V8a2 2 0 1 1 4 0z",strokeWidth:"2"})})}function ky({settingsSection:e,setSettingsSection:t,settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,currentRole:l,isAdmin:c,adminUsers:u,userForm:m,setUserForm:N,roleOptions:v,handleUserSubmit:x,settings:C,setSettings:L,handleSaveSettings:R,branches:g,services:h,branchForm:p,setBranchForm:y,handleBranchSubmit:S,handleBranchDisable:D,serviceForm:$,setServiceForm:I,handleServiceSubmit:_,handleServiceDisable:O,handleServiceBranchToggle:P,templates:X,templateForm:de,setTemplateForm:pe,handleTemplateSubmit:Fe,handleTemplateSubmitToMeta:ke,handleTemplateDelete:Te,handleSyncTemplates:rt,auditLogs:F,formatDate:G,planName:ne,tenantChannels:ie,channelForm:he,setChannelForm:Ce,handleChannelSelect:A,handleChannelSubmit:H,handleUserDelete:b,defaultRolePermissions:U,handleRoleDelete:q,useShellLayout:le=!1,pageError:ce,isOffline:ve=!1,onDismissError:at,brandName:ot=""}){const ct=a==null?void 0:a[l],xe=[{title:"Principal",items:[{id:"general",label:"General",icon:yy},{id:"users",label:"Gestion de Usuarios",icon:jy},{id:"bot",label:"Configuracion de Bot",icon:Ny}]},{title:"Canales e Integraciones",items:[{id:"templates",label:"Plantillas de Meta",icon:wy},{id:"audit",label:"Registros / Auditoria",icon:_y},{id:"odoo",label:"Integracion Odoo",icon:Sy}]}];function Ze(Ee){var Oe,vt;return!!((vt=(Oe=ct==null?void 0:ct.settings)==null?void 0:Oe[Ee])!=null&&vt.read)}function rn(Ee){Ze(Ee)&&t(Ee)}const zt=s.jsxs(s.Fragment,{children:[s.jsxs("aside",{className:"settings-sidebar",children:[s.jsxs("div",{className:"settings-header",children:[s.jsx("div",{className:"settings-title",children:"CONFIGURACION"}),s.jsxs("div",{className:"settings-version",children:[(ot||"Empresa").toUpperCase()," OS V2.0"]})]}),xe.map(Ee=>s.jsxs("div",{className:"settings-group",children:[s.jsx("div",{className:"settings-group-title",children:Ee.title}),s.jsx("div",{className:"settings-group-list",children:Ee.items.map(Oe=>{const vt=!Ze(Oe.id),kt=Oe.icon;return s.jsxs("button",{className:`settings-item ${e===Oe.id?"active":""}`,type:"button",onClick:()=>rn(Oe.id),disabled:vt,children:[s.jsx("span",{className:"settings-icon","aria-hidden":"true",children:s.jsx(kt,{className:"settings-icon-svg"})}),Oe.label]},Oe.id)})})]},Ee.title)),s.jsxs("div",{className:"settings-plan",children:[s.jsx("div",{className:"settings-plan-label",children:"Plan actual"}),s.jsx("div",{className:"settings-plan-name",children:ne||"Sin plan"})]})]}),s.jsxs("div",{className:"settings-content",children:[e==="users"&&s.jsx(cy,{settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,isAdmin:c,adminUsers:u,userForm:m,setUserForm:N,roleOptions:v,handleUserSubmit:x,handleUserDelete:b,defaultRolePermissions:U,handleRoleDelete:q}),e==="general"&&s.jsx(uy,{branches:g,branchForm:p,setBranchForm:y,handleBranchSubmit:S,handleBranchDisable:D,services:h,serviceForm:$,setServiceForm:I,handleServiceSubmit:_,handleServiceDisable:O,handleServiceBranchToggle:P,tenantChannels:ie,channelForm:he,setChannelForm:Ce,handleChannelSelect:A,handleChannelSubmit:H}),e==="bot"&&s.jsx(dy,{settings:C,setSettings:L,handleSaveSettings:R}),e==="templates"&&s.jsx(py,{templates:X,templateForm:de,setTemplateForm:pe,handleTemplateSubmit:Fe,handleTemplateSubmitToMeta:ke,handleTemplateDelete:Te,handleSyncTemplates:rt,brandName:ot}),e==="audit"&&s.jsx(vy,{auditLogs:F,formatDate:G}),e==="odoo"&&s.jsx(xy,{}),ve?s.jsx(Sa,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):ce?s.jsx(Sa,{variant:"error",title:"Ocurri un problema",message:ce,dismissLabel:"Cerrar",onDismiss:at}):null]})]});return le?zt:s.jsx("section",{className:"settings-layout",children:zt})}function by(){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"1.8"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"1.8"})]})}function Cy({tenantId:e,tenantBots:t,availableFlows:n,loading:r,onAddBot:a,onRemoveBot:i}){const[l,c]=f.useState(""),u=new Set(t.map(v=>v.flow_id)),m=n.filter(v=>!u.has(v.id));function N(){l&&(a(l),c(""))}return s.jsxs("section",{className:"sa-bot-card","data-tenant":e||"",children:[s.jsxs("header",{className:"sa-bot-header",children:[s.jsx("div",{className:"sa-bot-icon-large","aria-hidden":"true",children:s.jsx(by,{})}),s.jsxs("div",{className:"sa-bot-title-group",children:[s.jsx("h3",{children:"Asignacion de Bots"}),s.jsx("p",{children:"Selecciona que flujos estaran disponibles para este cliente. Los flujos asignados apareceran inmediatamente en el panel del usuario."})]})]}),s.jsx("div",{className:"sa-bot-body",children:r?s.jsx("div",{className:"sa-bot-loading",children:"Cargando asignaciones..."}):t.length===0?s.jsxs("div",{className:"sa-bot-empty",children:[s.jsx("div",{className:"sa-bot-empty-icon",children:"+"}),s.jsx("div",{className:"sa-bot-empty-title",children:"Sin bots asignados"}),s.jsx("div",{className:"sa-bot-empty-sub",children:"Agrega un flujo desde el selector para activarlo en este tenant."})]}):s.jsx("div",{className:"sa-bot-grid",children:t.map(v=>s.jsxs("div",{className:"sa-assigned-bot",children:[s.jsx("div",{className:"sa-bot-item-icon",children:v.flow_icon||">"}),s.jsxs("div",{className:"sa-bot-item-info",children:[s.jsx("span",{className:"sa-bot-item-name",children:v.flow_name||v.flow_id}),s.jsx("span",{className:"sa-bot-item-desc",children:v.flow_description||"Sin descripcion"})]}),s.jsx("button",{type:"button",className:"sa-btn-remove",title:"Quitar bot del cliente",onClick:()=>i(v.id),children:"Quitar"})]},v.id))})}),s.jsxs("div",{className:"sa-bot-controls",children:[s.jsxs("div",{className:"sa-select-container",children:[s.jsx("label",{className:"sa-select-label",children:"Asignar bot"}),s.jsxs("select",{className:"sa-select-styled",value:l,onChange:v=>c(v.target.value),disabled:m.length===0,children:[s.jsx("option",{value:"",children:m.length===0?"No hay mas bots disponibles":"Selecciona un bot para asignar"}),m.map(v=>s.jsx("option",{value:v.id,children:v.name},v.id))]})]}),s.jsx("button",{type:"button",className:"sa-btn-assign",onClick:N,disabled:!l,children:"Asignar Bot"})]})]})}const Kt={name:"",slug:"",plan:"",db_url:"",phone_number_id:"",line_name:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",brand_name:"",logo_url:"",brand_primary:"#22d3ee",brand_accent:"#38bdf8",brand_bg:"#0b0f16",timezone:"",odoo_base_url:"",odoo_db_name:"",odoo_username:"",odoo_password:""},Ey=[{value:"starter",label:"Starter"},{value:"growth",label:"Growth"},{value:"scale",label:"Scale"},{value:"enterprise",label:"Enterprise"}];function Ay(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"4",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"4",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"})]})}function Bc(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ty(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"3.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M19 12a7 7 0 0 0-.1-1.2l2-1.5-2-3.5-2.4.7a7.2 7.2 0 0 0-2-1.2L12 2 9.5 4.3a7.2 7.2 0 0 0-2 1.2l-2.4-.7-2 3.5 2 1.5A7 7 0 0 0 5 12c0 .4 0 .8.1 1.2l-2 1.5 2 3.5 2.4-.7a7.2 7.2 0 0 0 2 1.2L12 22l2.5-2.3a7.2 7.2 0 0 0 2-1.2l2.4.7 2-3.5-2-1.5c.1-.4.1-.8.1-1.2Z",strokeWidth:"1.2",strokeLinejoin:"round"})]})}function Ly(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M16.5 16.5 20 20",strokeWidth:"1.6",strokeLinecap:"round"})]})}function Ry(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 12h12",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m13 6 6 6-6 6",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Oy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M18 6 6 18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m6 6 12 12",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Py(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56",strokeWidth:"1.8",strokeLinecap:"round"})})}function dh(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"1.8",strokeLinecap:"round"})]})}function hh(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m2 2 20 20",strokeWidth:"1.8",strokeLinecap:"round"})]})}function My(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 18h.01",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Dy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m15 5 4 4",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Iy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M3 6h18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",strokeWidth:"1.8",strokeLinecap:"round"})]})}const fh={display_name:"",phone_number_id:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",is_active:!0,is_default:!1};function By({isOpen:e,onClose:t,initialData:n,onSave:r,tenantId:a}){const[i,l]=f.useState(fh),[c,u]=f.useState(!1),[m,N]=f.useState(!1),[v,x]=f.useState(!1),[C,L]=f.useState(null);if(f.useEffect(()=>{e&&(l(n||{...fh}),L(null))},[e,n]),!e)return null;const R=async g=>{if(g.preventDefault(),x(!0),L(null),!i.phone_number_id||!i.verify_token||!n&&!i.wa_token){L("Los campos ID de Telfono, Verify Token y Access Token son obligatorios."),x(!1);return}try{await r({...i,tenant_id:a}),t()}catch(h){console.error("Error saving channel:",h),L(h.message||"Error al guardar la lnea.")}finally{x(!1)}};return s.jsx("div",{className:"sa-modal-overlay",onClick:t,children:s.jsxs("div",{className:"sa-modal-content",onClick:g=>g.stopPropagation(),children:[s.jsxs("div",{className:"sa-modal-header",children:[s.jsx("div",{className:"sa-modal-title",children:n?"Editar Lnea WhatsApp":"Nueva Lnea WhatsApp"}),s.jsx("button",{className:"sa-modal-close",onClick:t,children:s.jsx(Oy,{width:24,height:24})})]}),s.jsxs("div",{className:"sa-modal-body",children:[C&&s.jsx("div",{className:"sa-alert",style:{marginBottom:"1rem"},children:C}),s.jsxs("div",{className:"sa-form-grid",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre para mostrar (Opcional)"}),s.jsx("input",{value:i.display_name||"",onChange:g=>l({...i,display_name:g.target.value}),placeholder:"Ej: Ventas Principal"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Phone Number ID *"}),s.jsx("input",{value:i.phone_number_id||"",onChange:g=>l({...i,phone_number_id:g.target.value}),placeholder:"Identificador del nmero de telfono"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"WABA ID (WhatsApp Business Account ID)"}),s.jsx("input",{value:i.waba_id||"",onChange:g=>l({...i,waba_id:g.target.value}),placeholder:"Identificador de la cuenta de WhatsApp Business"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Verify Token (Webhook) *"}),s.jsx("input",{value:i.verify_token||"",onChange:g=>l({...i,verify_token:g.target.value}),placeholder:"Token de verificacin webhook"})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"Permanent Access Token *"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:c?"text":"password",value:i.wa_token||"",onChange:g=>l({...i,wa_token:g.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"Token de acceso permanente",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>u(!c),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:c?s.jsx(hh,{width:18,height:18}):s.jsx(dh,{width:18,height:18})})]})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"App Secret (Opcional)"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:m?"text":"password",value:i.app_secret||"",onChange:g=>l({...i,app_secret:g.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"App Secret de Meta",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>N(!m),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:m?s.jsx(hh,{width:18,height:18}):s.jsx(dh,{width:18,height:18})})]})]})]}),s.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"2rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_active,onChange:g=>l({...i,is_active:g.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Activa"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_default,onChange:g=>l({...i,is_default:g.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Principal (Por Defecto)"]})]})]}),s.jsxs("div",{className:"sa-modal-footer",children:[s.jsx("button",{className:"sa-btn ghost",onClick:t,disabled:v,children:"Cancelar"}),s.jsx("button",{className:"sa-btn primary",onClick:R,disabled:v,children:v?s.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(Py,{width:16,height:16,className:"animate-spin"})," Guardando..."]}):"Guardar Lnea"})]})]})})}function zy({channels:e=[],tenantId:t,onRefresh:n}){const[r,a]=f.useState(!1),[i,l]=f.useState(null),c=()=>{l(null),a(!0)},u=v=>{l(v),a(!0)},m=async v=>{i?await Ke(`/api/superadmin/channels/${i.id}`,v):await Se("/api/superadmin/channels",v),await n()},N=async v=>{if(confirm("Ests seguro de que deseas eliminar esta lnea? Esta accin no se puede deshacer."))try{await Cn(`/api/superadmin/channels/${v}`),await n()}catch(x){console.error("Error deleting channel:",x),alert("No se pudo eliminar la lnea.")}};return s.jsxs("section",{className:"sa-lines-card",children:[s.jsxs("header",{className:"sa-lines-header",children:[s.jsxs("div",{className:"sa-lines-title",children:[s.jsx("div",{className:"sa-lines-icon",children:s.jsx(My,{width:24,height:24})}),s.jsxs("div",{children:[s.jsx("h3",{children:"Lneas de WhatsApp Cloud"}),s.jsx("p",{children:"Gestiona las conexiones activas de WhatsApp para este tenant."})]})]}),s.jsxs("button",{className:"sa-btn primary",onClick:c,children:[s.jsx(Bc,{width:16,height:16,style:{marginRight:"0.5rem"}}),"Agregar Nueva Lnea"]})]}),s.jsx("div",{className:"sa-lines-body",children:s.jsxs("div",{className:"sa-lines-grid",children:[e.map(v=>s.jsxs("div",{className:`sa-line-card ${v.is_active?"":"opacity-75"}`,children:[s.jsxs("div",{className:"sa-line-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-line-name",children:v.display_name||"Sin nombre"}),s.jsxs("div",{className:"sa-line-meta",children:["ID: ",v.phone_number_id]})]}),s.jsx("div",{className:`sa-line-status ${v.is_active?"active":""}`,title:v.is_active?"Activo":"Inactivo"})]}),s.jsxs("div",{className:"sa-line-badges",children:[v.is_default&&s.jsx("span",{className:"sa-line-badge default",children:"DEFAULT"}),!v.is_active&&s.jsx("span",{className:"sa-status warn",children:"INACTIVO"})]}),s.jsxs("div",{className:"sa-line-details",children:[s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"WABA ID"}),s.jsx("span",{className:"sa-detail-value",children:v.waba_id||"-"})]}),s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"Verify Token"}),s.jsx("span",{className:"sa-detail-value",children:v.verify_token?`${v.verify_token.substring(0,16)}...`:"-"})]})]}),s.jsxs("div",{className:"sa-line-actions",children:[s.jsx("button",{className:"sa-btn ghost",onClick:()=>u(v),title:"Editar",children:s.jsx(Dy,{width:16,height:16})}),s.jsx("button",{className:"sa-btn ghost",onClick:()=>N(v.id),title:"Eliminar",style:{color:"#f87171"},children:s.jsx(Iy,{width:16,height:16})})]})]},v.id)),s.jsxs("button",{type:"button",className:"sa-line-add-card",onClick:c,children:[s.jsx("div",{className:"sa-add-icon-circle",children:s.jsx(Bc,{width:24,height:24})}),s.jsx("span",{children:"Nueva Conexin"})]})]})}),s.jsx(By,{isOpen:r,onClose:()=>a(!1),initialData:i,onSave:m,tenantId:t})]})}function ph({route:e="/superadmin",onNavigate:t,onImpersonateTenant:n,onLogout:r=()=>{}}){const[a,i]=f.useState([]),[l,c]=f.useState([]),[u,m]=f.useState([]),[N,v]=f.useState(""),[x,C]=f.useState(""),[L,R]=f.useState("Verificacion de red: sistema ok"),[g,h]=f.useState(Kt),[p,y]=f.useState(!1),[S,D]=f.useState(!1),[$,I]=f.useState(""),[_,O]=f.useState(""),[P,X]=f.useState(!0),[de,pe]=f.useState(Kt),[Fe,ke]=f.useState(!0),[Te,rt]=f.useState(!1),F=f.useRef(""),[G,ne]=f.useState([]),[ie,he]=f.useState([]),[Ce,A]=f.useState(!1),{pushToast:H}=Bu(),b=f.useMemo(()=>{if(!e)return"";const k=e.match(/^\/superadmin\/tenants\/([^/]+)\/?$/)||e.match(/^\/superadmin\/tenant\/([^/]+)\/?$/)||e.match(/^\/superadmin\/edit\/([^/]+)\/?$/);return k?k[1]:""},[e]),U=e.startsWith("/superadmin/new"),q=!!b,le=U||q,ce=f.useCallback(k=>{if(t){t(k,{replace:!1});return}typeof window>"u"||window.history.pushState({},"",k)},[t]);async function ve(){try{const k=await me("/api/superadmin/tenants");i(k.tenants||[]);const V=await me("/api/superadmin/channels");c(V.channels||[]),C("")}catch(k){C(k.message||"No se pudo cargar datos.")}}f.useEffect(()=>{ve(),ye()},[]),f.useMemo(()=>{const k=new Map;return l.forEach(V=>{const Q=k.get(V.tenant_id)||0;k.set(V.tenant_id,Q+1)}),k},[l]);const at=f.useMemo(()=>{const k=N.trim().toLowerCase();return k?a.filter(V=>{const Q=String(V.name||"").toLowerCase(),ae=String(V.slug||"").toLowerCase(),je=String(V.id||"").toLowerCase();return Q.includes(k)||ae.includes(k)||je.includes(k)}):a.slice()},[a,N]),ot=a.length,ct=a.filter(k=>k.is_active).length;a.filter(k=>k.has_database).length;const xe=a.filter(k=>k.has_odoo).length,Ze=ot?Math.round(xe/ot*100):0;function rn(k){if(!k)return"--";const V=new Date(k);return Number.isNaN(V.getTime())?"--":V.toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"2-digit"})}function zt(k){return 10+Math.abs(Array.from(k).reduce((ae,je)=>ae+je.charCodeAt(0),0))%70}function Ee(){h(Kt),pe(Kt),O(""),X(!0),ke(!0),he([]),m([]),R("Verificacion de red: sistema ok"),F.current=""}function Oe(){Ee(),C(""),ce("/superadmin/new")}function vt(){F.current="",ce("/superadmin")}async function kt(k){if(n)try{C(""),I(k),await n(k)}catch(V){C(V.message||"No se pudo entrar al tenant.")}finally{I("")}}function ut(k){const V={};return Object.keys(Kt).forEach(Q=>{const ae=k[Q];V[Q]=typeof ae=="string"?ae.trim():ae||""}),{...Kt,...V}}async function $t(k){if(k){F.current=k,O(k),h(Kt),pe(Kt),X(!0),ke(!0),he([]),m([]),rt(!0),C("");try{const V=await me(`/api/superadmin/tenants/${k}/details`);if(F.current!==k)return;const Q=V.tenant||{},ae=V.branding||null,je=V.odoo||null,Yt=V.database||null,xt=V.channel||null;m(V.channels||[]);const Ot=(ae==null?void 0:ae.colors)||{},dt=ut({...Kt,name:Q.name||"",slug:Q.slug||"",plan:Q.plan||"",db_url:(Yt==null?void 0:Yt.db_url)||"",brand_name:(ae==null?void 0:ae.brand_name)||"",logo_url:(ae==null?void 0:ae.logo_url)||"",brand_primary:(Ot==null?void 0:Ot.primary)||Kt.brand_primary,brand_accent:(Ot==null?void 0:Ot.accent)||Kt.brand_accent,brand_bg:(Ot==null?void 0:Ot.bg)||Kt.brand_bg,odoo_base_url:(je==null?void 0:je.base_url)||"",odoo_db_name:(je==null?void 0:je.db_name)||"",odoo_username:(je==null?void 0:je.username)||"",odoo_password:(je==null?void 0:je.password)||""});h(dt),pe(dt),O(Q.id||k),X(!!Q.is_active),ke(!!Q.is_active),R("Modo edicion: cambios pendientes"),await jn(k)}catch(V){C(V.message||"No se pudo cargar tenant.")}finally{rt(!1)}}}async function Rt(k){if(k)try{const V=await me(`/api/superadmin/tenants/${k}/details`);if(_&&_!==k)return;m(V.channels||[])}catch(V){console.error("Error loading tenant channels",V)}}async function ye(){try{const k=await me("/api/superadmin/flows");ne(k.flows||[])}catch(k){console.error("Error loading flows",k)}}async function jn(k){if(k){A(!0);try{const V=await me(`/api/superadmin/tenant-bots?tenant_id=${k}`);he(V.tenant_bots||[])}catch(V){console.error("Error loading tenant bots",V)}finally{A(!1)}}}async function We(k,V){try{await Ke(`/api/superadmin/tenant-bots/${k}`,{is_active:V}),he(Q=>Q.map(ae=>ae.id===k?{...ae,is_active:V}:ae))}catch(Q){C(Q.message||"Error al cambiar estado del bot.")}}async function W(k){if(_)try{const V=await Se("/api/superadmin/tenant-bots",{tenant_id:_,flow_id:k});V.tenant_bot&&(he(Q=>[V.tenant_bot,...Q]),H({message:"Bot agregado correctamente"}))}catch(V){C(V.message||"Error al agregar bot."),H({type:"error",message:V.message||"Error al agregar bot"})}}async function ue(k){const V=ie.find(Q=>Q.id===k);try{await Cn(`/api/superadmin/tenant-bots/${k}`),he(Q=>Q.filter(ae=>ae.id!==k)),H({message:"Bot eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{if(!V)return;const Q=await Se("/api/superadmin/tenant-bots",{tenant_id:V.tenant_id,flow_id:V.flow_id});Q!=null&&Q.tenant_bot&&V.is_active===!1&&await Ke(`/api/superadmin/tenant-bots/${Q.tenant_bot.id}`,{is_active:!1}),await jn(_),H({message:"Bot restaurado"})}catch(Q){H({type:"error",message:(Q==null?void 0:Q.message)||"No se pudo restaurar el bot"})}}})}catch(Q){C(Q.message||"Error al eliminar bot."),H({type:"error",message:Q.message||"Error al eliminar bot"})}}async function Pe(k){C(""),ce(`/superadmin/tenants/${k.id}`)}async function T(){await ve(),_&&await Rt(_)}function _e(){const k=g.name.trim(),V=g.slug.trim(),Q=g.db_url.trim();return!k||!V?{ok:!1,message:"Nombre y subdominio son requeridos."}:!_&&!Q?{ok:!1,message:"Tenant DB URL es requerido."}:(g.brand_name.trim()||g.logo_url.trim()||g.brand_primary||g.brand_accent||g.brand_bg)&&!g.brand_name.trim()?{ok:!1,message:"Brand name es requerido."}:(g.odoo_base_url||g.odoo_db_name||g.odoo_username||g.odoo_password)&&(!g.odoo_base_url||!g.odoo_db_name||!g.odoo_username||!_&&!g.odoo_password)?{ok:!1,message:"Odoo incompleto: base_url, db_name, username, password."}:{ok:!0}}function an(k){if(!k)return"Verificacion completada";const V=[];if(k.database){const Q=k.database.ok?"DB ok":"DB error",ae=typeof k.database.latency_ms=="number"?` (${k.database.latency_ms}ms)`:"";V.push(`${Q}${ae}`)}if(k.odoo){const Q=k.odoo.ok?"Odoo ok":"Odoo error",ae=typeof k.odoo.latency_ms=="number"?` (${k.odoo.latency_ms}ms)`:"";V.push(`${Q}${ae}`)}return V.length?`Verificacion completada: ${V.join(" | ")}`:"Verificacion completada"}function Kn(k){if(k!=null&&k.database&&!k.database.ok){const V=k.database.details||k.database.error;return Nn(V||"Error en DB")}if(k!=null&&k.odoo&&!k.odoo.ok){const V=k.odoo.details||k.odoo.error;return Nn(V||"Error en Odoo")}return"No se pudo validar conexion"}function Nn(k){const V=(k||"").toString(),Q=V.toLowerCase();return Q.includes("missing")?"Completa los campos de Odoo":Q.includes("db_connection_failed")?"No se pudo conectar a la base de datos":Q.includes("odoo")&&Q.includes("failed")?"No se pudo autenticar en Odoo":V||"No se pudo validar conexion"}async function On(){const k=_e();if(!k.ok){R(k.message);return}y(!0),R("Verificando conexion...");try{const V=await Se("/api/superadmin/tenants/validate",{db_url:g.db_url.trim(),odoo_base_url:g.odoo_base_url.trim(),odoo_db_name:g.odoo_db_name.trim(),odoo_username:g.odoo_username.trim(),odoo_password:g.odoo_password.trim()}),Q=an(V.checks);R(Q),V.ok?H({message:Q}):H({type:"error",message:Kn(V.checks)})}catch(V){R("Error validando conexion"),H({type:"error",message:V.message||"No se pudo validar conexion"})}finally{y(!1)}}async function Xn(k){var Q;if(k.preventDefault(),q&&!on)return;const V=_e();if(!V.ok){C(V.message);return}try{D(!0),C("");let ae=_;if(ae?await Ke(`/api/superadmin/tenants/${ae}`,{name:g.name.trim(),slug:g.slug.trim(),plan:g.plan.trim(),is_active:P}):ae=(Q=(await Se("/api/superadmin/tenants",{name:g.name.trim(),slug:g.slug.trim(),plan:g.plan.trim()})).tenant)==null?void 0:Q.id,!ae)throw new Error("tenant_not_ready");if(g.db_url.trim()&&await Se(`/api/superadmin/tenants/${ae}/database`,{db_url:g.db_url.trim()}),(g.brand_name.trim()||g.logo_url.trim())&&await Ke("/api/superadmin/branding",{tenant_id:ae,brand_name:g.brand_name.trim(),logo_url:g.logo_url.trim()||null,colors:null}),g.odoo_base_url||g.odoo_db_name||g.odoo_username||g.odoo_password){const xt={tenant_id:ae,base_url:g.odoo_base_url.trim(),db_name:g.odoo_db_name.trim(),username:g.odoo_username.trim()};g.odoo_password.trim()&&(xt.password=g.odoo_password.trim()),await Ke("/api/superadmin/odoo",xt)}if(await ve(),_){const xt=ut(g);h(xt),pe(xt),ke(P),R("Cambios guardados"),H({message:"Tenant actualizado correctamente"})}else Ee(),H({message:"Tenant creado correctamente"})}catch(ae){C(ae.message||"No se pudo guardar tenant."),H({type:"error",message:ae.message||"No se pudo guardar tenant"})}finally{D(!1)}}async function ln(){if(!_)return;const k=!P;try{D(!0),C(""),await Ke(`/api/superadmin/tenants/${_}`,{is_active:k}),X(k),ke(k),R(k?"Tenant reactivado":"Tenant bloqueado"),await ve()}catch(V){C(V.message||"No se pudo cambiar estado del tenant.")}finally{D(!1)}}const on=f.useMemo(()=>!_&&!q||P!==Fe?!0:Object.keys(de).some(k=>{const V=String(g[k]??""),Q=String(de[k]??"");return V!==Q}),[Fe,de,P,_,q,g]);return f.useEffect(()=>{if(q&&b&&b!==_){$t(b);return}U&&(_||Te)&&Ee()},[Te,_,U,q,b]),s.jsxs("div",{className:"sa-shell",children:[s.jsxs("aside",{className:"sa-rail",children:[s.jsx("div",{className:"sa-rail-logo",children:"PRZV"}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${le?"":"active"}`,onClick:vt,children:[s.jsx(Ay,{className:"sa-rail-icon"}),s.jsx("span",{children:"Dashboard"})]}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${U?"active":""}`,onClick:Oe,children:[s.jsx(Bc,{className:"sa-rail-icon"}),s.jsx("span",{children:"Nuevo"})]}),s.jsxs("button",{type:"button",className:"sa-rail-btn",children:[s.jsx(Ty,{className:"sa-rail-icon"}),s.jsx("span",{children:"Ajustes"})]}),s.jsxs("div",{className:"sa-rail-footer",children:[s.jsx("div",{className:"sa-avatar",children:"SA"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-role",children:"Superadmin"}),s.jsx("div",{className:"sa-meta",children:"Control plane"})]})]})]}),s.jsxs("main",{className:"sa-main",children:[!le&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-topbar",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-kicker",children:"Panel de control Perzivalh"}),s.jsxs("div",{className:"sa-title",children:["Sistema operativo ",s.jsx("span",{className:"sa-dot"})]}),s.jsx("div",{className:"sa-subtitle",children:"Estado general del entorno"})]}),s.jsxs("div",{className:"sa-top-actions",children:[s.jsx("span",{className:"sa-version",children:"v0.4 stable"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:ve,children:"Recargar"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"}),s.jsx("button",{className:"sa-btn primary",type:"button",onClick:Oe,children:"Nuevo tenant"})]})]}),s.jsxs("section",{className:"sa-kpi-grid",children:[s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Total de empresas (tenants)"}),s.jsx("div",{className:"sa-kpi-value",children:ot}),s.jsxs("div",{className:"sa-kpi-meta",children:["+",ct," activas"]})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Usuarios activos totales"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"En tiempo real"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Mensajes hoy"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"Canal API"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Conexiones Odoo activas"}),s.jsxs("div",{className:"sa-kpi-value",children:[Ze,"%"]}),s.jsxs("div",{className:"sa-kpi-meta",children:[xe," sincronizadas"]})]})]}),s.jsxs("section",{className:"sa-table-card",children:[s.jsxs("div",{className:"sa-table-header",children:[s.jsxs("div",{className:"sa-search",children:[s.jsx(Ly,{className:"sa-search-icon"}),s.jsx("input",{value:N,onChange:k=>v(k.target.value),placeholder:"Filtrar empresas..."})]}),s.jsxs("div",{className:"sa-table-actions",children:[s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Ordenar por salud"}),s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Exportar CSV"})]})]}),s.jsxs("div",{className:"sa-table",children:[s.jsxs("div",{className:"sa-table-head",children:[s.jsx("div",{children:"ID referencia"}),s.jsx("div",{children:"Nombre de la empresa"}),s.jsx("div",{children:"Estado"}),s.jsx("div",{children:"Uso de recursos"}),s.jsx("div",{children:"Tiempo de actividad"}),s.jsx("div",{children:"Acciones"})]}),at.length?at.map(k=>{var je;const V=zt(k.id||"tenant"),Q=k.has_database?"db":"no-db",ae=k.has_database;return s.jsxs("div",{className:"sa-table-row",children:[s.jsx("div",{className:"sa-ref",children:((je=k.slug)==null?void 0:je.toUpperCase())||"TENANT"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-tenant-name",children:k.name}),s.jsx("div",{className:"sa-tenant-meta",children:k.id.slice(0,8)})]}),s.jsx("div",{className:`sa-status ${k.is_active?"ok":"warn"}`,children:k.is_active?"activo":"inactivo"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-progress",children:s.jsx("span",{className:`sa-progress-fill ${Q}`,style:{width:`${V}%`}})}),s.jsxs("div",{className:"sa-tenant-meta",children:[V,"% carga"]})]}),s.jsx("div",{className:"sa-tenant-meta",children:rn(k.created_at)}),s.jsx("div",{children:s.jsxs("div",{className:"sa-action-group",children:[s.jsx("button",{className:"sa-action",type:"button",onClick:()=>kt(k.id),disabled:!ae||$===k.id,children:ae?$===k.id?"Entrando...":"Entrar":"Sin DB"}),s.jsx("button",{className:"sa-link",type:"button",onClick:()=>Pe(k),children:s.jsx(Ry,{className:"sa-link-icon"})})]})})]},k.id)}):s.jsx("div",{className:"sa-empty",children:"Sin tenants para mostrar."})]}),s.jsxs("div",{className:"sa-footer-note",children:["Mostrando ",at.length||0," empresas en produccion"]})]})]}),le&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-create-header",children:[s.jsx("button",{className:"sa-back",type:"button",onClick:vt,children:"Volver al dashboard"}),s.jsx("div",{className:"sa-create-title",children:q?"Editar tenant":"Registrar nuevo tenant"}),s.jsxs("div",{className:"sa-create-actions",children:[s.jsx("div",{className:"sa-create-meta",children:"Modo: superadmin"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"})]})]}),x?s.jsx("div",{className:"sa-alert",children:x}):null,s.jsxs("form",{className:"sa-form",onSubmit:Xn,children:[s.jsxs("div",{className:"sa-form-grid sa-form-grid-2",children:[s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Identidad del tenant"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre de la empresa"}),s.jsx("input",{value:g.name,onChange:k=>h({...g,name:k.target.value}),placeholder:"Ej. Empresa Alfa"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Subdominio reservado"}),s.jsx("input",{value:g.slug,onChange:k=>h({...g,slug:k.target.value}),placeholder:"alfa-salud"})]}),s.jsxs("div",{className:"sa-field sa-field-row",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Plan"}),s.jsxs("select",{value:g.plan,onChange:k=>h({...g,plan:k.target.value}),children:[s.jsx("option",{value:"",children:"Seleccionar"}),Ey.map(k=>s.jsx("option",{value:k.value,children:k.label},k.value))]})]}),q&&s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Estado del tenant"}),s.jsxs("select",{value:P?"active":"inactive",onChange:k=>X(k.target.value==="active"),children:[s.jsx("option",{value:"active",children:"Activo"}),s.jsx("option",{value:"inactive",children:"Bloqueado"})]})]})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Brand name"}),s.jsx("input",{value:g.brand_name,onChange:k=>h({...g,brand_name:k.target.value}),placeholder:"Perzivalh"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Logo URL"}),s.jsx("input",{value:g.logo_url,onChange:k=>h({...g,logo_url:k.target.value}),placeholder:"https://"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Paleta de colores"}),s.jsx("div",{className:"sa-note",children:"Personalizacin deshabilitada por ahora."})]}),!q&&s.jsx("div",{className:"sa-note",children:"Nota: al registrar un tenant se inicia el aprovisionamiento en el entorno de produccion."})]}),s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Variables de entorno (envs)"}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Base de datos"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Tenant DB URL"}),s.jsx("input",{value:g.db_url,onChange:k=>h({...g,db_url:k.target.value}),placeholder:"postgresql://..."})]})]}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Odoo (opcional)"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Base URL"}),s.jsx("input",{value:g.odoo_base_url,onChange:k=>h({...g,odoo_base_url:k.target.value}),placeholder:"https://odoo-instancia"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo DB Name"}),s.jsx("input",{value:g.odoo_db_name,onChange:k=>h({...g,odoo_db_name:k.target.value}),placeholder:"db_tenant_prod"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo User"}),s.jsx("input",{value:g.odoo_username,onChange:k=>h({...g,odoo_username:k.target.value}),placeholder:"usuario@empresa.com"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Password (opcional)"}),s.jsx("input",{type:"password",value:g.odoo_password,onChange:k=>h({...g,odoo_password:k.target.value}),placeholder:"********"})]})]})]})]}),s.jsxs("div",{className:"sa-form-actions",children:[s.jsx("div",{className:"sa-status-note",children:q?Te?"Cargando datos...":on?"Cambios pendientes":"Sin cambios":L}),s.jsx("div",{className:"sa-form-buttons",children:q?s.jsxs(s.Fragment,{children:[on&&s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:S,children:S?"Guardando...":"Guardar cambios"}),s.jsx("button",{className:"sa-btn danger",type:"button",onClick:ln,disabled:S||!_,children:P?"Bloquear tenant":"Reactivar tenant"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:On,disabled:p||S,children:p?"Validando...":"Validar conexion"}),s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:S,children:S?"Guardando...":"Desplegar instancia"})]})})]})]}),_?s.jsx(zy,{channels:u.length?u:l.filter(k=>k.tenant_id===_),tenantId:_,onRefresh:T}):s.jsx("div",{style:{marginTop:"2rem",padding:"1rem",border:"1px dashed rgba(255,255,255,0.2)",borderRadius:"12px",color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",textAlign:"center"},children:"Crea el tenant primero para configurar las lneas de WhatsApp."}),_&&s.jsx(Cy,{tenantId:_,tenantBots:ie,availableFlows:G,loading:Ce,onToggleBot:We,onAddBot:W,onRemoveBot:ue})]})]})]})}const mh=["open","pending","assigned"],gh=["admin","recepcion","caja","marketing","doctor"],Un={admin:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!0},campaigns:{read:!0,write:!0},settings:{read:!0,write:!0}},settings:{general:{read:!0,write:!0},users:{read:!0,write:!0},bot:{read:!0,write:!0},templates:{read:!0,write:!0},audit:{read:!0,write:!0},odoo:{read:!0,write:!0}}},recepcion:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},caja:{modules:{chat:{read:!0,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},marketing:{modules:{chat:{read:!1,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!0,write:!0},settings:{read:!0,write:!1}},settings:{general:{read:!0,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!0,write:!0},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},doctor:{modules:{chat:{read:!0,write:!1},dashboard:{read:!1,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}}};function Do(e){if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleString()}function $y(e){if(!e)return"-";const t=new Date(e);if(Number.isNaN(t.getTime()))return"-";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):i===1?"Ayer":["Dom","Lun","Mar","Mie","Jue","Vie","Sab"][t.getDay()]}function vh(e){if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?"Hoy":i===1?"Ayer":`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}function Z(e){if(!e)return"Error inesperado";if(typeof e=="string")return e==="offline"?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":e==="network_error"?"No se pudo conectar con el servidor. Intenta de nuevo.":e==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":e;const t=e.message||"Error inesperado";return t==="offline"||t.toLowerCase().includes("failed to fetch")?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":t==="network_error"||t.toLowerCase().includes("networkerror")?"No se pudo conectar con el servidor. Intenta de nuevo.":t==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":t}function Uy(e,t){return e?t.includes(e.role):!1}function Io(e){if(!e||typeof e!="object")return{...Un};const t={...Un};return Object.entries(e).forEach(([n,r])=>{var a,i;!r||typeof r!="object"||(t[n]={modules:{...(a=Un[n])==null?void 0:a.modules,...r.modules},settings:{...(i=Un[n])==null?void 0:i.settings,...r.settings}})}),t}function Ct(e,t,n,r="read"){var i;const a=(i=e==null?void 0:e[t])==null?void 0:i[n];return a?!!a[r]:!1}function Bo(e){const t=n=>n.status==="pending"&&!n.assigned_user_id?0:n.status==="pending"&&n.assigned_user_id?1:n.status==="assigned"?2:3;return[...e].sort((n,r)=>{const a=t(n),i=t(r);if(a!==i)return a-i;const l=new Date(n.last_message_at||n.created_at||0).getTime();return new Date(r.last_message_at||r.created_at||0).getTime()-l})}function Vy(e){const t=new URLSearchParams;Object.entries(e||{}).forEach(([r,a])=>{a==null||a===""||t.append(r,a)});const n=t.toString();return n?`?${n}`:""}function xh(e){if(!e)return"?";const t=e.trim();return t?t[0].toUpperCase():"?"}function yh(e){if(typeof document>"u")return;const t=document.documentElement.style;t.removeProperty("--accent"),t.removeProperty("--accent-strong"),t.removeProperty("--accent-soft"),t.removeProperty("--accent-soft-2"),t.removeProperty("--scroll-thumb"),t.removeProperty("--scroll-thumb-hover")}function Fy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M4.5 5.5h15v10H8l-3.5 3.5V5.5Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 9h8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 12.5h5",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Wy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"})]})}function Hy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 9a6 6 0 1 1 12 0c0 4.2 2 5.5 2 5.5H4S6 13.2 6 9Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M9.5 19a2.5 2.5 0 0 0 5 0",strokeWidth:"1.8"})]})}function qy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"2",strokeLinecap:"round"})]})}function Gy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"4",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 3v2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M12 18.5V21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M3 12h2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M18.5 12H21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 5.2l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 17l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 18.8 7 17",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 7l1.8-1.8",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Qy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M20 14.2A8.5 8.5 0 1 1 9.8 4 6.5 6.5 0 0 0 20 14.2Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function Yy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.8"}),s.jsx("path",{d:"M16.5 16.5 21 21",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ky(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Xy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3.5",y:"6",width:"11",height:"12",rx:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"m14.5 10 6-3v10l-6-3",strokeWidth:"1.8"})]})}function Jy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M6.5 4.5 9 3l2.5 4-2.5 1.5c1.2 2.3 3.2 4.3 5.5 5.5L16 11l4 2.5-1.5 2.5c-.7 1.2-2.2 1.7-3.6 1.3a15.9 15.9 0 0 1-7.7-7.7c-.4-1.4.1-2.9 1.3-3.6Z",strokeWidth:"1.6",strokeLinejoin:"round"})})}function Zy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"9",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 10v6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"7.5",r:"1",fill:"currentColor"})]})}function ej(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"m4 12 15-7-6 14-2.5-5.2L4 12Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function tj(){const[e,t]=f.useState(localStorage.getItem("token")||""),[n,r]=f.useState(()=>typeof window<"u"&&localStorage.getItem("superadmin_token")||""),[a,i]=f.useState(null),[l,c]=f.useState(null),[u,m]=f.useState(null),[N,v]=f.useState([]),[x,C]=f.useState({id:"",display_name:""}),[L,R]=f.useState(()=>{if(typeof window>"u")return{};try{return JSON.parse(localStorage.getItem("last_read_map")||"{}")}catch{return{}}}),[g,h]=f.useState({email:"",password:""}),[p,y]=f.useState(""),[S,D]=f.useState("chats"),[$,I]=f.useState(()=>typeof window<"u"?window.location.pathname:"/"),[_,O]=f.useState(()=>localStorage.getItem("theme")||"light"),[P,X]=f.useState(()=>typeof window<"u"&&window.navigator?!window.navigator.onLine:!1),[de,pe]=f.useState(!1),[Fe,ke]=f.useState(!1),[Te,rt]=f.useState(!1),[F,G]=f.useState(!0),[ne,ie]=f.useState(!1),[he,Ce]=f.useState(""),A=f.useRef(null),H=f.useRef(null),b=f.useRef(null),U=f.useRef({conversationId:null,lastId:null,length:0}),q=f.useRef(0),le=f.useRef(!1),ce=f.useRef(0),[ve,at]=f.useState("users"),[ot,ct]=f.useState("list"),[xe,Ze]=f.useState(()=>Io(null)),[rn,zt]=f.useState(!1),[Ee,Oe]=f.useState(!1),[vt,kt]=f.useState(!1),ut=f.useMemo(()=>{const d=Object.keys(xe||{}).filter(j=>!gh.includes(j));return[...gh,...d]},[xe]),[$t,Rt]=f.useState({status:"",assigned_user_id:"",tag:"",search:"",phone_number_id:""}),ye=$.startsWith("/superadmin"),[jn,We]=f.useState([]),[W,ue]=f.useState(null),[Pe,T]=f.useState([]),[_e,an]=f.useState(""),[Kn,Nn]=f.useState("text"),[On,Xn]=f.useState([]),[ln,on]=f.useState([]),[k,V]=f.useState(""),[Q,ae]=f.useState(""),[je,Yt]=f.useState(""),[xt,Ot]=f.useState(!1),[dt,$r]=f.useState({name:"",color:"#6b7280"}),[Qa,Js]=f.useState(!1),[et,se]=f.useState(""),{pushToast:ee}=Bu(),Jn=f.useRef(new Map),Ts=f.useRef(new Map),Zn=f.useRef(new Map),es=f.useRef(new Map),Ur=f.useRef(new Map),[Ls,Ya]=f.useState(null),[Pn,ts]=f.useState([]),[Ie,Ka]=f.useState([]),[Vr,Xa]=f.useState(0),[Mn,Fr]=f.useState([]),[Ja,ns]=f.useState(""),[Za,Wr]=f.useState(null),[ei,Vl]=f.useState([]),[Rs,zu]=f.useState(null),[He,ss]=f.useState({name:"",template_id:"",scheduled_for:"",send_now:!0}),[Qe,Ut]=f.useState({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),[ti,Os]=f.useState([]),[ht,Zs]=f.useState({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),[er,cn]=f.useState(null),[ni,Fl]=f.useState([]),[tr,si]=f.useState([]),[ft,ri]=f.useState({id:"",code:"",name:"",address:"",lat:"",lng:"",hours_text:"",phone:"",is_active:!0}),[tt,nr]=f.useState({id:"",code:"",name:"",subtitle:"",description:"",price_bob:"",duration_min:"",image_url:"",is_featured:!1,is_active:!0}),[Hr,Wl]=f.useState({id:"",name:"",language:"es",category:"",body_preview:"",is_active:!0}),[Hl,ql]=f.useState([]),wn=((l==null?void 0:l.brand_name)||(u==null?void 0:u.name)||"Perzivalh").trim(),[sr,Dn]=f.useState(!1),[ai,qr]=f.useState(!1),[Ps,Ms]=f.useState(null),bt=48,ii=80,rs=60,Gr=320,Qr=120,li=5,Ds=2*60*1e3,Yr=f.useRef(new Map);function Kr(){const d=Yr.current;for(;d.size>li;){const j=d.keys().next().value;d.delete(j)}}function Is(d){const j=Yr.current,E=j.get(d);return E?Date.now()-E.updatedAt>Ds?(j.delete(d),null):E:null}function rr(d,j){const E=Yr.current;E.delete(d),E.set(d,{...j,updatedAt:Date.now()}),Kr()}const Vt=f.useCallback((d,j={})=>{if(typeof window>"u")return;const E=d||"/";if(window.location.pathname===E){I(E);return}j.replace?window.history.replaceState({},"",E):window.history.pushState({},"",E),I(E)},[]),Gl=f.useMemo(()=>Pn.find(d=>d.id===He.template_id),[Pn,He.template_id]),oi=f.useMemo(()=>{const d=[...Pe].reverse().find(j=>j.type==="note");return(d==null?void 0:d.text)||""},[Pe]),ci=f.useMemo(()=>Pe.filter(d=>d.type==="note"),[Pe]);f.useEffect(()=>{if(typeof window>"u")return;const d=()=>{I(window.location.pathname||"/")};return window.addEventListener("popstate",d),()=>window.removeEventListener("popstate",d)},[]),f.useEffect(()=>{ur(e||null)},[e]),f.useEffect(()=>{document.body.dataset.theme=_,localStorage.setItem("theme",_)},[_]),f.useEffect(()=>{if(typeof window>"u")return;const d=()=>{X(!window.navigator.onLine)};return d(),window.addEventListener("online",d),window.addEventListener("offline",d),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",d)}},[]),f.useEffect(()=>{ie(!1),G(!0),requestAnimationFrame(()=>{as()}),W&&Zr(W)},[W==null?void 0:W.id]),f.useEffect(()=>{S==="chats"&&(ie(!1),G(!0),requestAnimationFrame(()=>{as()}))},[S,W==null?void 0:W.id]),f.useEffect(()=>{var Ae;if(!W){Ce("");return}const d=Pe[Pe.length-1],j=(d==null?void 0:d.id)||(d==null?void 0:d.created_at)||(Pe.length?`${Pe.length}`:null),E=U.current,re=E.conversationId===W.id&&d&&E.lastId&&j!==E.lastId;if(le.current&&Pe.length>0){le.current=!1,requestAnimationFrame(()=>{as()});return}if(re?F?as():ie(!0):F&&ie(!1),U.current={conversationId:W.id,lastId:j,length:Pe.length},lr(),F&&Pe.length>Gr){const J=Pe.slice(-Gr);T(J),Ms(((Ae=J[0])==null?void 0:Ae.created_at)||null),Dn(!0)}},[Pe,W==null?void 0:W.id,F]),f.useEffect(()=>{var j;if(!(W!=null&&W.id)||!Pe.length)return;const d={messages:Pe.slice(-Qr),cursor:Ps||((j=Pe[0])==null?void 0:j.created_at)||null,hasMore:sr};rr(W.id,d)},[Pe,Ps,sr,W==null?void 0:W.id]),f.useEffect(()=>{S!=="chats"&&G(!1)},[S]),f.useEffect(()=>{if(!e)return;let d=!0;return me("/api/me").then(j=>{d&&i(j.user)}).catch(()=>{d&&(t(""),i(null))}),()=>{d=!1}},[e]),f.useEffect(()=>{if(!a||a.role==="superadmin"){c(null),v([]),yh();return}let d=!0;return me("/api/branding").then(j=>{d&&c(j.branding||null)}).catch(()=>{d&&c(null)}),me("/api/tenant").then(j=>{d&&m(j.tenant||null)}).catch(()=>{d&&m(null)}),me("/api/channels").then(j=>{d&&v(j.channels||[])}).catch(()=>{d&&v([])}),()=>{d=!1}},[a]),f.useEffect(()=>{yh()},[l]),f.useEffect(()=>{if(a){if(a.role==="superadmin"){ye||Vt("/superadmin",{replace:!0});return}ye&&Vt("/",{replace:!0})}},[a,ye,Vt]),f.useEffect(()=>{a&&a.role!=="superadmin"&&(Xr(),ar())},[a]),f.useEffect(()=>{a&&a.role!=="superadmin"&&Ql()},[a]),f.useEffect(()=>{!a||S!=="chats"||a.role!=="superadmin"&&Yl()},[a,S,$t]),f.useEffect(()=>{a&&a.role!=="superadmin"&&(S==="dashboard"&&In(),S==="campaigns"&&(dn(),is(1,6)))},[a,S]),f.useEffect(()=>{if(!a||S!=="admin")return;const d=(xe==null?void 0:xe[a.role])||Un[a.role],j=Ct(d,"settings","users"),E=Ct(d,"settings","bot"),M=Ct(d,"settings","general"),re=Ct(d,"settings","templates"),Ae=Ct(d,"settings","audit");ve==="users"&&j&&yt(),ve==="bot"&&E&&Jp(),ve==="general"&&M&&os(),ve==="templates"&&re&&dn(),ve==="audit"&&Ae&&hm()},[a,S,ve,xe]),f.useEffect(()=>{if(!a||S!=="admin")return;const d=(xe==null?void 0:xe[a.role])||Un[a.role],E=["general","users","bot","templates","audit","odoo"].filter(M=>Ct(d,"settings",M));if(!E.length){D(result.user.role==="superadmin"?"superadmin":"chats");return}E.includes(ve)||at(E[0])},[a,S,ve,xe]),f.useEffect(()=>{if(!e||(a==null?void 0:a.role)==="superadmin")return;const d=Xx(e),j={current:null},E=["/sounds/new-notification-09-352705.wav","/sounds/new-notification-09-352705.mp3"],M=()=>{if(j.current)return j.current;const J=new Audio(E[0]);J.volume=1;let oe=0;return J.addEventListener("error",()=>{oe+=1,oe<E.length&&(J.src=E[oe],J.load())}),j.current=J,J},re=()=>{const J=M();J.play().then(()=>{J.pause(),J.currentTime=0}).catch(()=>{})};window.addEventListener("click",re,{once:!0}),window.addEventListener("touchstart",re,{once:!0});const Ae=()=>{if(!(typeof window>"u"))try{const J=M();J.currentTime=0,J.play().catch(()=>{})}catch{}};return d.on("conversation:update",({conversation:J})=>{const oe=Ur.current.get(J.id);Ur.current.set(J.id,J.status),J.status==="pending"&&!J.assigned_user_id&&oe!=="pending"&&(Ae(),ee({message:"Nueva conversacin pendiente"})),We(Be=>{const Le=Be.map(jt=>jt.id===J.id?{...jt,...J}:jt);return Le.find(jt=>jt.id===J.id)||Le.push(J),Bo(Le)}),ue(Be=>(Be==null?void 0:Be.id)===J.id?{...Be,...J}:Be)}),d.on("message:new",({conversation:J,message:oe})=>{J.status==="pending"&&!J.assigned_user_id&&Ae();const Be={...J,last_message_text:(oe==null?void 0:oe.text)||null,last_message_type:(oe==null?void 0:oe.type)||null,last_message_direction:(oe==null?void 0:oe.direction)||null,last_message_at:(oe==null?void 0:oe.created_at)||J.last_message_at};We(Le=>{const jt=Le.map(or=>or.id===J.id?{...or,...Be}:or);return jt.find(or=>or.id===J.id)||jt.push(Be),Bo(jt)}),ue(Le=>(Le==null?void 0:Le.id)===J.id?{...Le,...Be}:Le),T(Le=>!W||W.id!==J.id?Le:(Zr(Be),[...Le,oe]))}),()=>{d.disconnect()}},[e,W]),f.useEffect(()=>{if(!a)return;if(a.role==="superadmin"){S!=="superadmin"&&D("superadmin");return}const d=(xe==null?void 0:xe[a.role])||Un[a.role],j=Ct(d,"modules","chat"),E=Ct(d,"modules","dashboard"),M=Ct(d,"modules","campaigns"),re=Ct(d,"modules","settings");S==="chats"&&!j&&D(E?"dashboard":M?"campaigns":"admin"),S==="dashboard"&&!E&&D(j?"chats":M?"campaigns":"admin"),S==="campaigns"&&!M&&D(j?"chats":E?"dashboard":"admin"),S==="admin"&&!re&&D(j?"chats":E?"dashboard":"campaigns")},[a,S,xe]),f.useEffect(()=>{if(!a||a.role!=="admin"||!rn||!Ee||vt)return;const d=setTimeout(()=>{const j=ce.current;kt(!0),Ke("/api/admin/role-permissions",{permissions:xe}).then(()=>{ce.current===j&&Oe(!1)}).catch(E=>{se(Z(E))}).finally(()=>{kt(!1)})},350);return()=>clearTimeout(d)},[a,xe,Ee,rn,vt]);async function Xr(){try{const d=await me("/api/users");on(d.users||[])}catch(d){se(Z(d))}}async function Ql(){try{const d=await me("/api/role-permissions"),j=Io(d.permissions||null);ce.current=0,Ze(j),Oe(!1),zt(!0)}catch(d){se(Z(d)),zt(!0)}}async function ar(){try{const d=await me("/api/tags");Xn(d.tags||[])}catch(d){se(Z(d))}}async function Yl(){try{const d=Vy($t),j=await me(`/api/conversations${d}`);We(Bo(j.conversations||[]))}catch(d){se(Z(d))}}async function Kl(d){var re,Ae;le.current=!0;const j=Is(d),E=jn.find(J=>J.id===d);Js(!j),di(),E&&ue(E),j&&(T(j.messages||[]),Ms(j.cursor||null),Dn(!!j.hasMore),lr(),requestAnimationFrame(()=>{as()}));const M=q.current+1;q.current=M;try{const J=`?limit=${ii}&window_hours=${bt}`,oe=await me(`/api/conversations/${d}${J}`);if(q.current!==M)return;let Be=oe.conversation;const Le=oe.messages||[];if((Be==null?void 0:Be.status)==="pending"&&!Be.assigned_user_id&&(a!=null&&a.id))try{Be=(await Ke(`/api/conversations/${d}/assign`,{})).conversation}catch(jt){String(Z(jt)).includes("already_assigned")&&ee({type:"error",message:"Conversacin tomada por otro operador"})}ue(Be),T(Le),Dn(!!oe.has_more),Ms(oe.next_cursor||((re=Le[0])==null?void 0:re.created_at)||null),rr(d,{messages:Le.slice(-Qr),cursor:oe.next_cursor||((Ae=Le[0])==null?void 0:Ae.created_at)||null,hasMore:!!oe.has_more}),Zr(Be)}catch(J){se(Z(J))}finally{q.current===M&&Js(!1)}}async function Jr(d){var Ae;if(!sr||ai)return;const j=Ps;if(!j){Dn(!1);return}qr(!0);const E=H.current,M=E?E.scrollHeight:0,re=E?E.scrollTop:0;try{const J=`?limit=${rs}&before=${encodeURIComponent(j)}`,oe=await me(`/api/conversations/${d}${J}`);if((W==null?void 0:W.id)!==d)return;const Be=oe.messages||[];Be.length?(T(Le=>{const jt=new Set(Le.map(ro=>ro.id));return[...Be.filter(ro=>!jt.has(ro.id)),...Le]}),Ms(oe.next_cursor||((Ae=Be[0])==null?void 0:Ae.created_at)||j),Dn(!!oe.has_more),requestAnimationFrame(()=>{const Le=H.current;if(!Le)return;const jt=Le.scrollHeight;Le.scrollTop=jt-M+re})):Dn(!1)}catch(J){se(Z(J))}finally{qr(!1)}}async function Xl(d){d.preventDefault(),y("");try{const j=await Se("/api/auth/login",{email:g.email,password:g.password});t(j.token),ur(j.token),i(j.user),r(""),localStorage.removeItem("superadmin_token");const E=j.user.role==="superadmin";D(E?"superadmin":"chats"),E?Vt("/superadmin",{replace:!0}):ye&&Vt("/",{replace:!0})}catch{y("Credenciales invalidas")}}function ir(){t(""),ur(null),i(null),We([]),ue(null),T([]),D("chats"),rt(!1),Ze(Io(null)),zt(!1),Oe(!1),kt(!1),ce.current=0,r(""),localStorage.removeItem("superadmin_token"),Vt("/",{replace:!0})}async function ui(d){const j=await Se(`/api/superadmin/tenants/${d}/impersonate`);!n&&e&&(localStorage.setItem("superadmin_token",e),r(e)),t(j.token),ur(j.token),i(j.user),D("chats"),Vt("/",{replace:!0})}function Jl(){const d=n||(typeof window<"u"?localStorage.getItem("superadmin_token"):"");if(!d){ir();return}localStorage.removeItem("superadmin_token"),r(""),t(d),ur(d),i(null),D("chats"),Vt("/superadmin",{replace:!0})}function Zl(d){Ze(j=>typeof d=="function"?d(j):d),ce.current+=1,Oe(!0)}function eo(){O(d=>d==="light"?"dark":"light")}function as(){const d=H.current;d&&(d.scrollTop=d.scrollHeight,G(!0),ie(!1),lr())}function Zr(d){!(d!=null&&d.id)||!(d!=null&&d.last_message_at)||R(j=>{const E={...j,[d.id]:d.last_message_at};return localStorage.setItem("last_read_map",JSON.stringify(E)),E})}function to(){const d=H.current;if(!d)return;const E=d.scrollHeight-d.scrollTop-d.clientHeight<24;G(E),E&&ie(!1),d.scrollTop<120&&sr&&!ai&&W&&Jr(W.id),lr()}function di(){T([]),Ms(null),Dn(!1),qr(!1),U.current={conversationId:null,lastId:null,length:0}}function lr(){b.current||(b.current=requestAnimationFrame(()=>{b.current=null,no()}))}function no(){const d=H.current;if(!d)return;const j=d.querySelectorAll(".day-pill");if(!j.length){Ce("");return}const E=d.scrollTop,M=12;let re=j[0];for(const J of j)if(J.offsetTop-M<=E)re=J;else break;const Ae=re.dataset.dayLabel||re.textContent||"";Ce(Ae)}function hi(){ue(null),di()}function fi(d){var j;an(d),(j=A.current)==null||j.focus()}async function pi(d){if(d.preventDefault(),!W||!_e.trim())return;const j=_e.trim();an("");try{await Se(`/api/conversations/${W.id}/messages`,{text:j,type:Kn})}catch(E){se(Z(E))}}async function o(d){if(d.preventDefault(),!W||!Q.trim())return;const j=Q.trim();ae("");try{const E=await Se(`/api/conversations/${W.id}/messages`,{text:j,type:"note"});E!=null&&E.message&&T(M=>[...M,E.message]),E!=null&&E.conversation&&ue(E.conversation)}catch(E){se(Z(E))}}async function w(){if(W)try{const d=await Ke(`/api/conversations/${W.id}/assign`);ue(d.conversation)}catch(d){const j=Z(d)||"No se pudo tomar la conversacion";ee({type:"error",message:j})}}async function B(){if(!(!W||!je))try{const d=await Ke(`/api/conversations/${W.id}/assign`,{user_id:je});ue(d.conversation),Yt(""),ee({message:"Conversacin reasignada"})}catch(d){const j=Z(d)||"No se pudo reasignar";ee({type:"error",message:j})}}async function K(d){var j;if(W)try{let M=(await Ke(`/api/conversations/${W.id}/status`,{status:d})).conversation;if(d==="open"&&((j=M==null?void 0:M.tags)!=null&&j.length)){const re=M.tags.find(Ae=>(Ae.name||"").toLowerCase()==="pendiente");if(re)try{M=(await Se(`/api/conversations/${M.id}/tags`,{add:[],remove:[re.name]})).conversation||M}catch{M={...M,tags:M.tags.filter(J=>J.name!==re.name)}}}ue(M),We(re=>re.map(Ae=>Ae.id===M.id?{...Ae,...M}:Ae))}catch(E){se(Z(E))}}async function te(d){var E;if(!W)return;const j=((E=W.tags)==null?void 0:E.some(M=>M.name===d))||!1;if(j){const M=`${W.id}:${d}`;if(es.current.has(M))return;const re=W,Ae={...W,tags:(W.tags||[]).filter(oe=>oe.name!==d)};ue(Ae);const J=setTimeout(async()=>{try{const oe=await Se(`/api/conversations/${re.id}/tags`,{add:[],remove:[d]});(W==null?void 0:W.id)===re.id&&ue(oe.conversation)}catch(oe){(W==null?void 0:W.id)===re.id&&ue(re),ee({type:"error",message:Z(oe)||"No se pudo eliminar el tag"})}finally{es.current.delete(M)}},8e3);es.current.set(M,{timer:J,snapshot:re}),ee({message:"Tag eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const oe=es.current.get(M);oe!=null&&oe.timer&&clearTimeout(oe.timer),oe!=null&&oe.snapshot?ue(oe.snapshot):ue(re),es.current.delete(M),ee({message:"Eliminacin cancelada"})}});return}try{const M=await Se(`/api/conversations/${W.id}/tags`,{add:j?[]:[d],remove:j?[d]:[]});ue(M.conversation)}catch(M){se(Z(M))}}async function Ne(d){if(d.preventDefault(),!k.trim()||!W)return;const j=k.trim();V("");try{const E=await Se(`/api/conversations/${W.id}/tags`,{add:[j]});ue(E.conversation),await ar()}catch(E){se(Z(E))}}async function Ye(d){d.preventDefault();const j=dt.name.trim();if(!j){se("Completa el nombre de la etiqueta");return}try{await Se("/api/tags",{name:j,color:dt.color||null}),$r({name:"",color:"#6b7280"}),await ar(),ee({message:"Etiqueta creada"})}catch(E){se(Z(E))}}async function un(d,j){if(d)try{await Cn(`/api/tags/${d}`),ue(E=>E&&{...E,tags:(E.tags||[]).filter(M=>M.name!==j)}),await ar(),ee({message:"Etiqueta eliminada"})}catch(E){se(Z(E))}}async function In(){try{const d=await me("/api/dashboard/metrics");Ya(d)}catch(d){se(Z(d))}}async function dn(){try{const d=await me("/api/templates").catch(()=>me("/api/admin/templates"));ts(d.templates||[])}catch(d){se(Z(d))}}async function is(d=1,j=6,E=""){try{const M=new URLSearchParams({offset:String((d-1)*j),limit:String(j)});E&&M.set("q",E);const re=await me(`/api/campaigns?${M.toString()}`);Ka(re.campaigns||[]),Xa(Number.isFinite(re.total)?re.total:(re.campaigns||[]).length)}catch(M){se(Z(M))}}async function Bn(d){ns(d);try{const j=await me(`/api/admin/campaigns/${d}/messages`);Fr(j.messages||[])}catch(j){se(Z(j))}}async function _n(d){var j;if(d.preventDefault(),!He.name.trim()||!He.template_id){se("Completa el nombre y plantilla");return}Qe.status&&Qe.status,Qe.tag&&Qe.tag.trim(),Qe.assigned_user_id&&Qe.assigned_user_id,Qe.verified_only,Qe.segment_id&&(Qe.segment_id,Qe.segment_name&&Qe.segment_name);try{const E=await Se("/api/campaigns",{name:He.name.trim(),template_id:He.template_id,segment_id:Qe.segment_id||null,scheduled_at:He.scheduled_for||null});if(He.send_now&&!He.scheduled_for){const M=(j=E==null?void 0:E.campaign)==null?void 0:j.id;M&&await Se(`/api/campaigns/${M}/launch`,{})}ss({name:"",template_id:"",scheduled_for:"",send_now:!0}),Ut({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),await is(1,6),ee({message:"Campaa creada correctamente"})}catch(E){se(Z(E)),ee({type:"error",message:Z(E)||"Error al crear campaa"})}}async function Sn(d){try{await Se(`/api/campaigns/${d}/launch`,{}),await is(1,6)}catch(j){se(Z(j))}}async function ls(){try{await me("/api/templates/sync"),await dn()}catch(d){se(Z(d))}}async function yt(){try{const d=await me("/api/admin/users");Os(d.users||[])}catch(d){se(Z(d))}}async function Kp(d){if(d.preventDefault(),!ht.name.trim()||!ht.role){se("Completa los campos requeridos");return}try{ht.id?(await Ke(`/api/admin/users/${ht.id}`,{name:ht.name.trim(),role:ht.role,is_active:ht.is_active,password:ht.password||void 0}),ee({message:"Usuario actualizado correctamente"})):(await Se("/api/admin/users",{name:ht.name.trim(),email:ht.email.trim().toLowerCase(),role:ht.role,password:ht.password}),ee({message:"Usuario creado correctamente"})),Zs({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),await yt()}catch(j){se(Z(j)),ee({type:"error",message:Z(j)||"Error al guardar usuario"})}}async function Xp(d){if(!d||Jn.current.has(d))return;let j=null;try{j=ti.slice(),Os(M=>M.filter(re=>re.id!==d));const E=setTimeout(async()=>{try{await Cn(`/api/admin/users/${d}`),await yt(),ee({message:"Usuario eliminado definitivamente"})}catch(M){j?Os(j):await yt(),ee({type:"error",message:Z(M)||"No se pudo eliminar el usuario"})}finally{Jn.current.delete(d)}},8e3);Jn.current.set(d,{timer:E,snapshot:j}),ee({message:"Usuario eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const M=Jn.current.get(d);M!=null&&M.timer&&clearTimeout(M.timer),M!=null&&M.snapshot?Os(M.snapshot):j?Os(j):await yt(),Jn.current.delete(d),ee({message:"Eliminacin cancelada"})}})}catch(E){se(Z(E)),ee({type:"error",message:Z(E)||"Error al eliminar usuario"})}}async function Jp(){try{const d=await me("/api/admin/settings");cn(d.settings)}catch(d){se(Z(d))}}async function Zp(){if(er)try{const d=await Ke("/api/admin/settings",{bot_enabled:er.bot_enabled,auto_reply_enabled:er.auto_reply_enabled});cn(d.settings)}catch(d){se(Z(d))}}async function os(){try{const[d,j]=await Promise.all([me("/api/admin/branches"),me("/api/admin/services")]);Fl(d.branches||[]),si(j.services||[])}catch(d){se(Z(d))}}async function em(){try{const d=await me("/api/channels");v(d.channels||[])}catch{v([])}}function tm(d){C({id:d.id,display_name:d.display_name||""})}async function nm(d){if(d.preventDefault(),!!x.id)try{await Ke(`/api/channels/${x.id}`,{display_name:x.display_name.trim()}),C({id:"",display_name:""}),await em(),ee({message:"Canal actualizado correctamente"})}catch(j){se(Z(j)),ee({type:"error",message:Z(j)||"Error al guardar canal"})}}async function sm(d){const j=xe==null?void 0:xe[d];if(!(!d||Ts.current.has(d)))try{Ze(M=>{const re={...M};return delete re[d],re});const E=setTimeout(async()=>{try{await Cn(`/api/admin/role-permissions/${d}`),ee({message:"Rol eliminado definitivamente"})}catch(M){j&&Ze(re=>({...re,[d]:j})),ee({type:"error",message:Z(M)||"No se pudo eliminar el rol"})}finally{Ts.current.delete(d)}},8e3);Ts.current.set(d,{timer:E,currentPermissions:j}),ee({message:"Rol eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const M=Ts.current.get(d);M!=null&&M.timer&&clearTimeout(M.timer),M!=null&&M.currentPermissions&&Ze(re=>({...re,[d]:M.currentPermissions})),Ts.current.delete(d),ee({message:"Eliminacin cancelada"})}})}catch(E){se(Z(E)),ee({type:"error",message:Z(E)||"Error al eliminar rol"})}}async function rm(d){if(d.preventDefault(),!ft.code.trim()||!ft.name.trim()){se("Completa codigo y nombre");return}const j={code:ft.code.trim(),name:ft.name.trim(),address:ft.address.trim(),lat:ft.lat!==""?Number(ft.lat):0,lng:ft.lng!==""?Number(ft.lng):0,hours_text:ft.hours_text.trim(),phone:ft.phone.trim()||null,is_active:ft.is_active};try{ft.id?(await Ke(`/api/admin/branches/${ft.id}`,j),ee({message:"Sucursal actualizada correctamente"})):(await Se("/api/admin/branches",j),ee({message:"Sucursal creada correctamente"})),ri({id:"",code:"",name:"",address:"",lat:"",lng:"",hours_text:"",phone:"",is_active:!0}),await os()}catch(E){se(Z(E)),ee({type:"error",message:Z(E)||"Error al guardar sucursal"})}}async function am(d){try{await Cn(`/api/admin/branches/${d}`),await os(),ee({message:"Sucursal eliminada correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{await Ke(`/api/admin/branches/${d}`,{is_active:!0}),await os(),ee({message:"Sucursal restaurada"})}catch(j){ee({type:"error",message:Z(j)||"No se pudo restaurar la sucursal"})}}})}catch(j){se(Z(j)),ee({type:"error",message:Z(j)||"Error al eliminar sucursal"})}}async function im(d){if(d.preventDefault(),!tt.code.trim()||!tt.name.trim()){se("Completa codigo y nombre");return}const j={code:tt.code.trim(),name:tt.name.trim(),subtitle:tt.subtitle.trim()||null,description:tt.description.trim(),price_bob:tt.price_bob?Number(tt.price_bob):0,duration_min:tt.duration_min?Number(tt.duration_min):null,image_url:tt.image_url.trim()||null,is_featured:tt.is_featured,is_active:tt.is_active};try{tt.id?(await Ke(`/api/admin/services/${tt.id}`,j),ee({message:"Servicio actualizado correctamente"})):(await Se("/api/admin/services",j),ee({message:"Servicio creado correctamente"})),nr({id:"",code:"",name:"",subtitle:"",description:"",price_bob:"",duration_min:"",image_url:"",is_featured:!1,is_active:!0}),await os()}catch(E){se(Z(E)),ee({type:"error",message:Z(E)||"Error al guardar servicio"})}}async function lm(d){try{await Cn(`/api/admin/services/${d}`),await os(),ee({message:"Servicio eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{await Ke(`/api/admin/services/${d}`,{is_active:!0}),await os(),ee({message:"Servicio restaurado"})}catch(j){ee({type:"error",message:Z(j)||"No se pudo restaurar el servicio"})}}})}catch(j){se(Z(j)),ee({type:"error",message:Z(j)||"Error al eliminar servicio"})}}async function om(d,j,E){if(d)try{await Se(`/api/admin/services/${d.id}/branches`,{branch_id:j,is_available:E}),await os()}catch(M){se(Z(M))}}async function cm(d,j){d!=null&&d.preventDefault&&d.preventDefault();const E=j||Hr||{},M=typeof E.name=="string"?E.name.trim():"";if(!M)return se("Completa el nombre"),null;const re={name:M,category:E.category||"UTILITY",language:E.language||"es",body_text:E.body_text||E.body_preview||"",header_type:E.header_type||null,header_content:E.header_content||null,footer_text:E.footer_text||null,buttons:E.buttons||E.buttons_json||[]},Ae=E.variable_mappings||E.variableMappings||[];try{let J=null;return E.id?(J=await wl(`/api/templates/${E.id}`,re),await wl(`/api/templates/${E.id}/mappings`,{mappings:Ae}),ee({message:"Borrador actualizado correctamente"})):(J=await Se("/api/templates/draft",{...re,variable_mappings:Ae}),ee({message:"Borrador creado correctamente"})),await dn(),(J==null?void 0:J.template)||null}catch(J){return se(Z(J)),ee({type:"error",message:Z(J)||"Error al guardar plantilla"}),null}}async function um(d){if(d)try{await Se(`/api/templates/${d}/submit`,{}),await dn(),ee({message:"Plantilla enviada a revisin de Meta"})}catch(j){se(Z(j)),ee({type:"error",message:Z(j)||"Error al enviar a Meta"})}}async function dm(d){if(d&&!Zn.current.has(d))try{const j=Pn.slice();ts(M=>M.filter(re=>re.id!==d));const E=setTimeout(async()=>{try{await Cn(`/api/templates/${d}`),await dn(),ee({message:"Plantilla eliminada definitivamente"})}catch(M){ts(j),ee({type:"error",message:Z(M)||"No se pudo eliminar la plantilla"})}finally{Zn.current.delete(d)}},8e3);Zn.current.set(d,{timer:E,snapshot:j}),ee({message:"Plantilla eliminada. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const M=Zn.current.get(d);M!=null&&M.timer&&clearTimeout(M.timer),M!=null&&M.snapshot?ts(M.snapshot):ts(j),Zn.current.delete(d),ee({message:"Eliminacin cancelada"})}})}catch(j){se(Z(j)),ee({type:"error",message:Z(j)||"Error al eliminar plantilla"})}}async function hm(){try{const d=await me("/api/admin/audit?limit=200");ql(d.logs||[])}catch(d){se(Z(d))}}const $u={open:0,pending:0,closed:0};((Ls==null?void 0:Ls.status_counts)||[]).forEach(d=>{$u[d.status]=d._count.status});const fm=ye?"Acceso al control plane":"Acceso a bandeja multiusuario";if(!e||!a)return s.jsx("div",{className:"login-shell",children:s.jsxs("div",{className:"login-card",children:[s.jsx("div",{className:"login-title",children:"Perzivalh"}),s.jsx("div",{className:"login-subtitle",children:fm}),P?s.jsx(Sa,{variant:"offline",title:"Sin conexin",message:"No tienes internet en este momento. Conctate y vuelve a intentar iniciar sesin.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):null,s.jsxs("form",{className:"login-form",onSubmit:Xl,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:g.email,onChange:d=>h(j=>({...j,email:d.target.value})),required:!0})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:g.password,onChange:d=>h(j=>({...j,password:d.target.value})),required:!0})]}),p?s.jsx("div",{className:"error",children:p}):null,s.jsx("button",{className:"primary",type:"submit",children:"Entrar"})]})]})});if((a==null?void 0:a.role)==="superadmin"&&ye)return s.jsx("main",{className:"superadmin-page",children:s.jsx(ph,{route:$,onNavigate:Vt,onImpersonateTenant:ui,onLogout:ir})});const ea=(xe==null?void 0:xe[a.role])||Un[a.role],pm=Ct(ea,"modules","chat"),mm=Ct(ea,"modules","dashboard"),gm=Ct(ea,"modules","campaigns"),vm=Ct(ea,"modules","settings"),xm=Uy(a,["admin"]),ym=Ct(ea,"modules","chat","write"),jm=[],Uu={open:"Bot activo",pending:"Pendiente",assigned:"Tomada"},Nm=W?W.display_name||W.phone_e164||W.wa_id:"Selecciona un chat",wm=(W==null?void 0:W.phone_e164)||(W==null?void 0:W.wa_id)||"",_m=W?Uu[W.status]||"Sin estado":"",Sm=[{id:"chats",label:"Chats",icon:Fy,enabled:pm},{id:"dashboard",label:"Dashboard",icon:Wy,enabled:mm},{id:"campaigns",label:"Campaas",icon:Hy,enabled:gm},{id:"admin",label:"Configuraciones",icon:qy,enabled:vm}],so=[];let Vu="";Pe.forEach(d=>{const j=d.created_at,E=j?new Date(j):null,M=E&&!Number.isNaN(E.getTime())?`${E.getFullYear()}-${E.getMonth()}-${E.getDate()}`:"";if(M&&M!==Vu){const re=vh(j);so.push(s.jsx("div",{className:"day-pill","data-day-label":re,children:re},`day-${M}`)),Vu=M}so.push(s.jsxs("div",{className:`message ${d.direction} ${d.type==="note"?"note":""}`,"data-day-key":M,"data-day-label":M?vh(j):"",children:[s.jsx("div",{className:"message-text",children:d.text||`[${d.type}]`}),s.jsx("div",{className:"message-meta",children:Do(d.created_at)})]},d.id))});const km=!!n&&a.role!=="superadmin";return s.jsxs("div",{className:`app-shell ${S==="admin"?"admin-shell":""}`,children:[s.jsx(ey,{navItems:Sm,view:S,onSetView:D,theme:_,onToggleTheme:eo,user:a,logoUrl:(l==null?void 0:l.logo_url)||"",brandName:wn,isProfileOpen:Te,onToggleProfile:()=>rt(d=>!d),onLogout:ir,onReturnToSuperadmin:Jl,showReturnToSuperadmin:km,getInitial:xh,SunIcon:Gy,MoonIcon:Qy}),S==="admin"?s.jsx(ky,{settingsSection:ve,setSettingsSection:at,settingsTab:ot,setSettingsTab:ct,rolePermissions:xe,setRolePermissions:Zl,defaultRolePermissions:Un,currentRole:a.role,isAdmin:xm,adminUsers:ti,userForm:ht,setUserForm:Zs,roleOptions:ut,handleUserSubmit:Kp,handleUserDelete:Xp,settings:er,setSettings:cn,handleSaveSettings:Zp,planName:(u==null?void 0:u.plan)||"",branches:ni,services:tr,branchForm:ft,setBranchForm:ri,handleBranchSubmit:rm,handleBranchDisable:am,serviceForm:tt,setServiceForm:nr,handleServiceSubmit:im,handleServiceDisable:lm,handleServiceBranchToggle:om,tenantChannels:N,channelForm:x,setChannelForm:C,handleChannelSelect:tm,handleChannelSubmit:nm,handleRoleDelete:sm,templates:Pn,templateForm:Hr,setTemplateForm:Wl,handleTemplateSubmit:cm,handleTemplateSubmitToMeta:um,handleTemplateDelete:dm,handleSyncTemplates:ls,auditLogs:Hl,formatDate:Do,useShellLayout:!0,pageError:et,isOffline:P,onDismissError:()=>se(""),brandName:wn}):S==="superadmin"?s.jsx("main",{className:"content content-page",children:s.jsx(ph,{onImpersonateTenant:ui,onLogout:ir})}):s.jsxs("main",{className:`content ${S==="chats"?"content-chats":"content-page"}`,children:[S==="chats"&&s.jsx(ty,{activeConversation:W,conversations:jn,channels:N,brandName:wn,lastReadMap:L,filters:$t,showFilters:de,users:ln,tags:On,statusOptions:mh,statusLabels:Uu,formatListTime:$y,messageBlocks:so,messageDraft:_e,messageMode:Kn,quickActions:jm,tagInput:k,noteInput:Q,notesList:ci,latestNote:oi,loadingConversation:Qa,isInfoOpen:Fe,hasUnread:ne,scrollDayLabel:he,activeName:Nm,activePhone:wm,activeStatusLabel:_m,canManageStatus:ym,currentUser:a,messageInputRef:A,chatBodyRef:H,setShowFilters:pe,setFilters:Rt,loadConversation:Kl,handleBackToList:hi,setIsInfoOpen:ke,handleChatScroll:to,handleAssignSelf:w,handleStatusChange:K,handleToggleTag:te,handleAddTag:Ne,setNoteInput:ae,handleAddNote:o,reassignUserId:je,setReassignUserId:Yt,handleReassignConversation:B,handleOpenTagManager:()=>Ot(!0),handleCloseTagManager:()=>Ot(!1),showTagManager:xt,tagManagerForm:dt,setTagManagerForm:$r,handleCreateTag:Ye,handleDeleteTag:un,handleQuickAction:fi,handleSendMessage:pi,setMessageMode:Nn,setMessageDraft:an,scrollChatToBottom:as,getInitial:xh,PlusIcon:Ky,SearchIcon:Yy,VideoIcon:Xy,PhoneIcon:Jy,InfoIcon:Zy,SendIcon:ej}),S==="dashboard"&&s.jsx(ry,{statusCounts:$u,metrics:Ls,onRefresh:In,brandName:wn}),S==="campaigns"&&s.jsx(ly,{campaignForm:He,setCampaignForm:ss,campaignFilter:Qe,setCampaignFilter:Ut,templates:Pn,campaigns:Ie,selectedCampaignId:Ja,campaignMessages:Mn,users:ln,tags:On,selectedTemplate:Gl,statusOptions:mh,onCreateCampaign:_n,onLoadCampaigns:is,onLoadCampaignMessages:Bn,onSendCampaign:Sn,formatDate:Do,brandName:wn}),P?s.jsx(Sa,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):et?s.jsx(Sa,{variant:"error",title:"Ocurri un problema",message:et,dismissLabel:"Cerrar",onDismiss:()=>se("")}):null]})]})}const nj=Op(document.getElementById("root"));nj.render(s.jsx(Jx,{children:s.jsx(tj,{})}));
