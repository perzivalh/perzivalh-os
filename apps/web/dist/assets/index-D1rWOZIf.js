(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var Hh={exports:{}},Vl={},qh={exports:{}},we={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oi=Symbol.for("react.element"),Nm=Symbol.for("react.portal"),wm=Symbol.for("react.fragment"),_m=Symbol.for("react.strict_mode"),Sm=Symbol.for("react.profiler"),km=Symbol.for("react.provider"),bm=Symbol.for("react.context"),Cm=Symbol.for("react.forward_ref"),Em=Symbol.for("react.suspense"),Am=Symbol.for("react.memo"),Tm=Symbol.for("react.lazy"),fd=Symbol.iterator;function Lm(e){return e===null||typeof e!="object"?null:(e=fd&&e[fd]||e["@@iterator"],typeof e=="function"?e:null)}var Gh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Qh=Object.assign,Kh={};function Yr(e,t,n){this.props=e,this.context=t,this.refs=Kh,this.updater=n||Gh}Yr.prototype.isReactComponent={};Yr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Yr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Yh(){}Yh.prototype=Yr.prototype;function hu(e,t,n){this.props=e,this.context=t,this.refs=Kh,this.updater=n||Gh}var fu=hu.prototype=new Yh;fu.constructor=hu;Qh(fu,Yr.prototype);fu.isPureReactComponent=!0;var pd=Array.isArray,Xh=Object.prototype.hasOwnProperty,pu={current:null},Jh={key:!0,ref:!0,__self:!0,__source:!0};function Zh(e,t,n){var r,a={},i=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)Xh.call(t,r)&&!Jh.hasOwnProperty(r)&&(a[r]=t[r]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var u=Array(c),p=0;p<c;p++)u[p]=arguments[p+2];a.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)a[r]===void 0&&(a[r]=c[r]);return{$$typeof:oi,type:e,key:i,ref:l,props:a,_owner:pu.current}}function Rm(e,t){return{$$typeof:oi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function mu(e){return typeof e=="object"&&e!==null&&e.$$typeof===oi}function Om(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var md=/\/+/g;function Po(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Om(""+e.key):t.toString(36)}function tl(e,t,n,r,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case oi:case Nm:l=!0}}if(l)return l=e,a=a(l),e=r===""?"."+Po(l,0):r,pd(a)?(n="",e!=null&&(n=e.replace(md,"$&/")+"/"),tl(a,t,n,"",function(p){return p})):a!=null&&(mu(a)&&(a=Rm(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(md,"$&/")+"/")+e)),t.push(a)),1;if(l=0,r=r===""?".":r+":",pd(e))for(var c=0;c<e.length;c++){i=e[c];var u=r+Po(i,c);l+=tl(i,t,n,u,a)}else if(u=Lm(e),typeof u=="function")for(e=u.call(e),c=0;!(i=e.next()).done;)i=i.value,u=r+Po(i,c++),l+=tl(i,t,n,u,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Oi(e,t,n){if(e==null)return e;var r=[],a=0;return tl(e,r,"","",function(i){return t.call(n,i,a++)}),r}function Pm(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var At={current:null},nl={transition:null},Mm={ReactCurrentDispatcher:At,ReactCurrentBatchConfig:nl,ReactCurrentOwner:pu};function ef(){throw Error("act(...) is not supported in production builds of React.")}we.Children={map:Oi,forEach:function(e,t,n){Oi(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Oi(e,function(){t++}),t},toArray:function(e){return Oi(e,function(t){return t})||[]},only:function(e){if(!mu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};we.Component=Yr;we.Fragment=wm;we.Profiler=Sm;we.PureComponent=hu;we.StrictMode=_m;we.Suspense=Em;we.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mm;we.act=ef;we.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Qh({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=pu.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)Xh.call(t,u)&&!Jh.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&c!==void 0?c[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var p=0;p<u;p++)c[p]=arguments[p+2];r.children=c}return{$$typeof:oi,type:e.type,key:a,ref:i,props:r,_owner:l}};we.createContext=function(e){return e={$$typeof:bm,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:km,_context:e},e.Consumer=e};we.createElement=Zh;we.createFactory=function(e){var t=Zh.bind(null,e);return t.type=e,t};we.createRef=function(){return{current:null}};we.forwardRef=function(e){return{$$typeof:Cm,render:e}};we.isValidElement=mu;we.lazy=function(e){return{$$typeof:Tm,_payload:{_status:-1,_result:e},_init:Pm}};we.memo=function(e,t){return{$$typeof:Am,type:e,compare:t===void 0?null:t}};we.startTransition=function(e){var t=nl.transition;nl.transition={};try{e()}finally{nl.transition=t}};we.unstable_act=ef;we.useCallback=function(e,t){return At.current.useCallback(e,t)};we.useContext=function(e){return At.current.useContext(e)};we.useDebugValue=function(){};we.useDeferredValue=function(e){return At.current.useDeferredValue(e)};we.useEffect=function(e,t){return At.current.useEffect(e,t)};we.useId=function(){return At.current.useId()};we.useImperativeHandle=function(e,t,n){return At.current.useImperativeHandle(e,t,n)};we.useInsertionEffect=function(e,t){return At.current.useInsertionEffect(e,t)};we.useLayoutEffect=function(e,t){return At.current.useLayoutEffect(e,t)};we.useMemo=function(e,t){return At.current.useMemo(e,t)};we.useReducer=function(e,t,n){return At.current.useReducer(e,t,n)};we.useRef=function(e){return At.current.useRef(e)};we.useState=function(e){return At.current.useState(e)};we.useSyncExternalStore=function(e,t,n){return At.current.useSyncExternalStore(e,t,n)};we.useTransition=function(){return At.current.useTransition()};we.version="18.3.1";qh.exports=we;var h=qh.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Im=h,Dm=Symbol.for("react.element"),Bm=Symbol.for("react.fragment"),zm=Object.prototype.hasOwnProperty,$m=Im.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Um={key:!0,ref:!0,__self:!0,__source:!0};function tf(e,t,n){var r,a={},i=null,l=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)zm.call(t,r)&&!Um.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Dm,type:e,key:i,ref:l,props:a,_owner:$m.current}}Vl.Fragment=Bm;Vl.jsx=tf;Vl.jsxs=tf;Hh.exports=Vl;var s=Hh.exports,nf={exports:{}},Ht={},sf={exports:{}},rf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(V,te){var ee=V.length;V.push(te);e:for(;0<ee;){var he=ee-1>>>1,ce=V[he];if(0<a(ce,te))V[he]=te,V[ee]=ce,ee=he;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var te=V[0],ee=V.pop();if(ee!==te){V[0]=ee;e:for(var he=0,ce=V.length,be=ce>>>1;he<be;){var L=2*(he+1)-1,H=V[L],k=L+1,U=V[k];if(0>a(H,ee))k<ce&&0>a(U,H)?(V[he]=U,V[k]=ee,he=k):(V[he]=H,V[L]=ee,he=L);else if(k<ce&&0>a(U,ee))V[he]=U,V[k]=ee,he=k;else break e}}return te}function a(V,te){var ee=V.sortIndex-te.sortIndex;return ee!==0?ee:V.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var u=[],p=[],_=1,v=null,N=3,A=!1,O=!1,P=!1,C=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(V){for(var te=n(p);te!==null;){if(te.callback===null)r(p);else if(te.startTime<=V)r(p),te.sortIndex=te.expirationTime,t(u,te);else break;te=n(p)}}function b(V){if(P=!1,y(V),!O)if(n(u)!==null)O=!0,Ae(M);else{var te=n(p);te!==null&&Pe(b,te.startTime-V)}}function M(V,te){O=!1,P&&(P=!1,m(g),g=-1),A=!0;var ee=N;try{for(y(te),v=n(u);v!==null&&(!(v.expirationTime>te)||V&&!K());){var he=v.callback;if(typeof he=="function"){v.callback=null,N=v.priorityLevel;var ce=he(v.expirationTime<=te);te=e.unstable_now(),typeof ce=="function"?v.callback=ce:v===n(u)&&r(u),y(te)}else r(u);v=n(u)}if(v!==null)var be=!0;else{var L=n(p);L!==null&&Pe(b,L.startTime-te),be=!1}return be}finally{v=null,N=ee,A=!1}}var z=!1,j=null,g=-1,B=5,T=-1;function K(){return!(e.unstable_now()-T<B)}function oe(){if(j!==null){var V=e.unstable_now();T=V;var te=!0;try{te=j(!0,V)}finally{te?pe():(z=!1,j=null)}}else z=!1}var pe;if(typeof f=="function")pe=function(){f(oe)};else if(typeof MessageChannel<"u"){var ke=new MessageChannel,Ee=ke.port2;ke.port1.onmessage=oe,pe=function(){Ee.postMessage(null)}}else pe=function(){C(oe,0)};function Ae(V){j=V,z||(z=!0,pe())}function Pe(V,te){g=C(function(){V(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){O||A||(O=!0,Ae(M))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return N},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(V){switch(N){case 1:case 2:case 3:var te=3;break;default:te=N}var ee=N;N=te;try{return V()}finally{N=ee}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,te){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ee=N;N=V;try{return te()}finally{N=ee}},e.unstable_scheduleCallback=function(V,te,ee){var he=e.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?he+ee:he):ee=he,V){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=ee+ce,V={id:_++,callback:te,priorityLevel:V,startTime:ee,expirationTime:ce,sortIndex:-1},ee>he?(V.sortIndex=ee,t(p,V),n(u)===null&&V===n(p)&&(P?(m(g),g=-1):P=!0,Pe(b,ee-he))):(V.sortIndex=ce,t(u,V),O||A||(O=!0,Ae(M))),V},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(V){var te=N;return function(){var ee=N;N=te;try{return V.apply(this,arguments)}finally{N=ee}}}})(rf);sf.exports=rf;var Fm=sf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vm=h,Wt=Fm;function $(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var af=new Set,Ha={};function fr(e,t){Vr(e,t),Vr(e+"Capture",t)}function Vr(e,t){for(Ha[e]=t,e=0;e<t.length;e++)af.add(t[e])}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hc=Object.prototype.hasOwnProperty,Wm=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gd={},vd={};function Hm(e){return hc.call(vd,e)?!0:hc.call(gd,e)?!1:Wm.test(e)?vd[e]=!0:(gd[e]=!0,!1)}function qm(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Gm(e,t,n,r){if(t===null||typeof t>"u"||qm(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Tt(e,t,n,r,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){xt[e]=new Tt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];xt[t]=new Tt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){xt[e]=new Tt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){xt[e]=new Tt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){xt[e]=new Tt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){xt[e]=new Tt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){xt[e]=new Tt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){xt[e]=new Tt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){xt[e]=new Tt(e,5,!1,e.toLowerCase(),null,!1,!1)});var gu=/[\-:]([a-z])/g;function vu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(gu,vu);xt[t]=new Tt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(gu,vu);xt[t]=new Tt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(gu,vu);xt[t]=new Tt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){xt[e]=new Tt(e,1,!1,e.toLowerCase(),null,!1,!1)});xt.xlinkHref=new Tt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){xt[e]=new Tt(e,1,!1,e.toLowerCase(),null,!0,!0)});function xu(e,t,n,r){var a=xt.hasOwnProperty(t)?xt[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Gm(t,n,a,r)&&(n=null),r||a===null?Hm(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ts=Vm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pi=Symbol.for("react.element"),kr=Symbol.for("react.portal"),br=Symbol.for("react.fragment"),yu=Symbol.for("react.strict_mode"),fc=Symbol.for("react.profiler"),lf=Symbol.for("react.provider"),of=Symbol.for("react.context"),ju=Symbol.for("react.forward_ref"),pc=Symbol.for("react.suspense"),mc=Symbol.for("react.suspense_list"),Nu=Symbol.for("react.memo"),ys=Symbol.for("react.lazy"),cf=Symbol.for("react.offscreen"),xd=Symbol.iterator;function ja(e){return e===null||typeof e!="object"?null:(e=xd&&e[xd]||e["@@iterator"],typeof e=="function"?e:null)}var He=Object.assign,Mo;function Ta(e){if(Mo===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Mo=t&&t[1]||""}return`
`+Mo+e}var Io=!1;function Do(e,t){if(!e||Io)return"";Io=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(p){var r=p}Reflect.construct(e,[],t)}else{try{t.call()}catch(p){r=p}e.call(t.prototype)}else{try{throw Error()}catch(p){r=p}e()}}catch(p){if(p&&r&&typeof p.stack=="string"){for(var a=p.stack.split(`
`),i=r.stack.split(`
`),l=a.length-1,c=i.length-1;1<=l&&0<=c&&a[l]!==i[c];)c--;for(;1<=l&&0<=c;l--,c--)if(a[l]!==i[c]){if(l!==1||c!==1)do if(l--,c--,0>c||a[l]!==i[c]){var u=`
`+a[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=c);break}}}finally{Io=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ta(e):""}function Qm(e){switch(e.tag){case 5:return Ta(e.type);case 16:return Ta("Lazy");case 13:return Ta("Suspense");case 19:return Ta("SuspenseList");case 0:case 2:case 15:return e=Do(e.type,!1),e;case 11:return e=Do(e.type.render,!1),e;case 1:return e=Do(e.type,!0),e;default:return""}}function gc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case br:return"Fragment";case kr:return"Portal";case fc:return"Profiler";case yu:return"StrictMode";case pc:return"Suspense";case mc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case of:return(e.displayName||"Context")+".Consumer";case lf:return(e._context.displayName||"Context")+".Provider";case ju:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Nu:return t=e.displayName||null,t!==null?t:gc(e.type)||"Memo";case ys:t=e._payload,e=e._init;try{return gc(e(t))}catch{}}return null}function Km(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gc(t);case 8:return t===yu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ms(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function uf(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ym(e){var t=uf(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){r=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Mi(e){e._valueTracker||(e._valueTracker=Ym(e))}function df(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=uf(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function vl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function vc(e,t){var n=t.checked;return He({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function yd(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Ms(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function hf(e,t){t=t.checked,t!=null&&xu(e,"checked",t,!1)}function xc(e,t){hf(e,t);var n=Ms(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?yc(e,t.type,n):t.hasOwnProperty("defaultValue")&&yc(e,t.type,Ms(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function jd(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function yc(e,t,n){(t!=="number"||vl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var La=Array.isArray;function Dr(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ms(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function jc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error($(91));return He({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Nd(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error($(92));if(La(n)){if(1<n.length)throw Error($(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ms(n)}}function ff(e,t){var n=Ms(t.value),r=Ms(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function wd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function pf(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?pf(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ii,mf=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ii=Ii||document.createElement("div"),Ii.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ii.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function qa(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ma={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xm=["Webkit","ms","Moz","O"];Object.keys(Ma).forEach(function(e){Xm.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ma[t]=Ma[e]})});function gf(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ma.hasOwnProperty(e)&&Ma[e]?(""+t).trim():t+"px"}function vf(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=gf(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var Jm=He({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wc(e,t){if(t){if(Jm[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error($(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error($(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error($(61))}if(t.style!=null&&typeof t.style!="object")throw Error($(62))}}function _c(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sc=null;function wu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var kc=null,Br=null,zr=null;function _d(e){if(e=di(e)){if(typeof kc!="function")throw Error($(280));var t=e.stateNode;t&&(t=Ql(t),kc(e.stateNode,e.type,t))}}function xf(e){Br?zr?zr.push(e):zr=[e]:Br=e}function yf(){if(Br){var e=Br,t=zr;if(zr=Br=null,_d(e),t)for(e=0;e<t.length;e++)_d(t[e])}}function jf(e,t){return e(t)}function Nf(){}var Bo=!1;function wf(e,t,n){if(Bo)return e(t,n);Bo=!0;try{return jf(e,t,n)}finally{Bo=!1,(Br!==null||zr!==null)&&(Nf(),yf())}}function Ga(e,t){var n=e.stateNode;if(n===null)return null;var r=Ql(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error($(231,t,typeof n));return n}var bc=!1;if(Xn)try{var Na={};Object.defineProperty(Na,"passive",{get:function(){bc=!0}}),window.addEventListener("test",Na,Na),window.removeEventListener("test",Na,Na)}catch{bc=!1}function Zm(e,t,n,r,a,i,l,c,u){var p=Array.prototype.slice.call(arguments,3);try{t.apply(n,p)}catch(_){this.onError(_)}}var Ia=!1,xl=null,yl=!1,Cc=null,eg={onError:function(e){Ia=!0,xl=e}};function tg(e,t,n,r,a,i,l,c,u){Ia=!1,xl=null,Zm.apply(eg,arguments)}function ng(e,t,n,r,a,i,l,c,u){if(tg.apply(this,arguments),Ia){if(Ia){var p=xl;Ia=!1,xl=null}else throw Error($(198));yl||(yl=!0,Cc=p)}}function pr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function _f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Sd(e){if(pr(e)!==e)throw Error($(188))}function sg(e){var t=e.alternate;if(!t){if(t=pr(e),t===null)throw Error($(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return Sd(a),e;if(i===r)return Sd(a),t;i=i.sibling}throw Error($(188))}if(n.return!==r.return)n=a,r=i;else{for(var l=!1,c=a.child;c;){if(c===n){l=!0,n=a,r=i;break}if(c===r){l=!0,r=a,n=i;break}c=c.sibling}if(!l){for(c=i.child;c;){if(c===n){l=!0,n=i,r=a;break}if(c===r){l=!0,r=i,n=a;break}c=c.sibling}if(!l)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?e:t}function Sf(e){return e=sg(e),e!==null?kf(e):null}function kf(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=kf(e);if(t!==null)return t;e=e.sibling}return null}var bf=Wt.unstable_scheduleCallback,kd=Wt.unstable_cancelCallback,rg=Wt.unstable_shouldYield,ag=Wt.unstable_requestPaint,Qe=Wt.unstable_now,ig=Wt.unstable_getCurrentPriorityLevel,_u=Wt.unstable_ImmediatePriority,Cf=Wt.unstable_UserBlockingPriority,jl=Wt.unstable_NormalPriority,lg=Wt.unstable_LowPriority,Ef=Wt.unstable_IdlePriority,Wl=null,Pn=null;function og(e){if(Pn&&typeof Pn.onCommitFiberRoot=="function")try{Pn.onCommitFiberRoot(Wl,e,void 0,(e.current.flags&128)===128)}catch{}}var jn=Math.clz32?Math.clz32:dg,cg=Math.log,ug=Math.LN2;function dg(e){return e>>>=0,e===0?32:31-(cg(e)/ug|0)|0}var Di=64,Bi=4194304;function Ra(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Nl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,l=n&268435455;if(l!==0){var c=l&~a;c!==0?r=Ra(c):(i&=l,i!==0&&(r=Ra(i)))}else l=n&~a,l!==0?r=Ra(l):i!==0&&(r=Ra(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-jn(t),a=1<<n,r|=e[n],t&=~a;return r}function hg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fg(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-jn(i),c=1<<l,u=a[l];u===-1?(!(c&n)||c&r)&&(a[l]=hg(c,t)):u<=t&&(e.expiredLanes|=c),i&=~c}}function Ec(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Af(){var e=Di;return Di<<=1,!(Di&4194240)&&(Di=64),e}function zo(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ci(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-jn(t),e[t]=n}function pg(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-jn(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}function Su(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-jn(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var Re=0;function Tf(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Lf,ku,Rf,Of,Pf,Ac=!1,zi=[],bs=null,Cs=null,Es=null,Qa=new Map,Ka=new Map,Ns=[],mg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bd(e,t){switch(e){case"focusin":case"focusout":bs=null;break;case"dragenter":case"dragleave":Cs=null;break;case"mouseover":case"mouseout":Es=null;break;case"pointerover":case"pointerout":Qa.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ka.delete(t.pointerId)}}function wa(e,t,n,r,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},t!==null&&(t=di(t),t!==null&&ku(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function gg(e,t,n,r,a){switch(t){case"focusin":return bs=wa(bs,e,t,n,r,a),!0;case"dragenter":return Cs=wa(Cs,e,t,n,r,a),!0;case"mouseover":return Es=wa(Es,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Qa.set(i,wa(Qa.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Ka.set(i,wa(Ka.get(i)||null,e,t,n,r,a)),!0}return!1}function Mf(e){var t=sr(e.target);if(t!==null){var n=pr(t);if(n!==null){if(t=n.tag,t===13){if(t=_f(n),t!==null){e.blockedOn=t,Pf(e.priority,function(){Rf(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function sl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Tc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Sc=r,n.target.dispatchEvent(r),Sc=null}else return t=di(n),t!==null&&ku(t),e.blockedOn=n,!1;t.shift()}return!0}function Cd(e,t,n){sl(e)&&n.delete(t)}function vg(){Ac=!1,bs!==null&&sl(bs)&&(bs=null),Cs!==null&&sl(Cs)&&(Cs=null),Es!==null&&sl(Es)&&(Es=null),Qa.forEach(Cd),Ka.forEach(Cd)}function _a(e,t){e.blockedOn===t&&(e.blockedOn=null,Ac||(Ac=!0,Wt.unstable_scheduleCallback(Wt.unstable_NormalPriority,vg)))}function Ya(e){function t(a){return _a(a,e)}if(0<zi.length){_a(zi[0],e);for(var n=1;n<zi.length;n++){var r=zi[n];r.blockedOn===e&&(r.blockedOn=null)}}for(bs!==null&&_a(bs,e),Cs!==null&&_a(Cs,e),Es!==null&&_a(Es,e),Qa.forEach(t),Ka.forEach(t),n=0;n<Ns.length;n++)r=Ns[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Ns.length&&(n=Ns[0],n.blockedOn===null);)Mf(n),n.blockedOn===null&&Ns.shift()}var $r=ts.ReactCurrentBatchConfig,wl=!0;function xg(e,t,n,r){var a=Re,i=$r.transition;$r.transition=null;try{Re=1,bu(e,t,n,r)}finally{Re=a,$r.transition=i}}function yg(e,t,n,r){var a=Re,i=$r.transition;$r.transition=null;try{Re=4,bu(e,t,n,r)}finally{Re=a,$r.transition=i}}function bu(e,t,n,r){if(wl){var a=Tc(e,t,n,r);if(a===null)Ko(e,t,r,_l,n),bd(e,r);else if(gg(a,e,t,n,r))r.stopPropagation();else if(bd(e,r),t&4&&-1<mg.indexOf(e)){for(;a!==null;){var i=di(a);if(i!==null&&Lf(i),i=Tc(e,t,n,r),i===null&&Ko(e,t,r,_l,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else Ko(e,t,r,null,n)}}var _l=null;function Tc(e,t,n,r){if(_l=null,e=wu(r),e=sr(e),e!==null)if(t=pr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=_f(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return _l=e,null}function If(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ig()){case _u:return 1;case Cf:return 4;case jl:case lg:return 16;case Ef:return 536870912;default:return 16}default:return 16}}var _s=null,Cu=null,rl=null;function Df(){if(rl)return rl;var e,t=Cu,n=t.length,r,a="value"in _s?_s.value:_s.textContent,i=a.length;for(e=0;e<n&&t[e]===a[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===a[i-r];r++);return rl=a.slice(e,1<r?1-r:void 0)}function al(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function $i(){return!0}function Ed(){return!1}function qt(e){function t(n,r,a,i,l){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?$i:Ed,this.isPropagationStopped=Ed,this}return He(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=$i)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=$i)},persist:function(){},isPersistent:$i}),t}var Xr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eu=qt(Xr),ui=He({},Xr,{view:0,detail:0}),jg=qt(ui),$o,Uo,Sa,Hl=He({},ui,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Au,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Sa&&(Sa&&e.type==="mousemove"?($o=e.screenX-Sa.screenX,Uo=e.screenY-Sa.screenY):Uo=$o=0,Sa=e),$o)},movementY:function(e){return"movementY"in e?e.movementY:Uo}}),Ad=qt(Hl),Ng=He({},Hl,{dataTransfer:0}),wg=qt(Ng),_g=He({},ui,{relatedTarget:0}),Fo=qt(_g),Sg=He({},Xr,{animationName:0,elapsedTime:0,pseudoElement:0}),kg=qt(Sg),bg=He({},Xr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Cg=qt(bg),Eg=He({},Xr,{data:0}),Td=qt(Eg),Ag={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rg(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Lg[e])?!!t[e]:!1}function Au(){return Rg}var Og=He({},ui,{key:function(e){if(e.key){var t=Ag[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=al(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Tg[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Au,charCode:function(e){return e.type==="keypress"?al(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?al(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Pg=qt(Og),Mg=He({},Hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ld=qt(Mg),Ig=He({},ui,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Au}),Dg=qt(Ig),Bg=He({},Xr,{propertyName:0,elapsedTime:0,pseudoElement:0}),zg=qt(Bg),$g=He({},Hl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ug=qt($g),Fg=[9,13,27,32],Tu=Xn&&"CompositionEvent"in window,Da=null;Xn&&"documentMode"in document&&(Da=document.documentMode);var Vg=Xn&&"TextEvent"in window&&!Da,Bf=Xn&&(!Tu||Da&&8<Da&&11>=Da),Rd=" ",Od=!1;function zf(e,t){switch(e){case"keyup":return Fg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $f(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Cr=!1;function Wg(e,t){switch(e){case"compositionend":return $f(t);case"keypress":return t.which!==32?null:(Od=!0,Rd);case"textInput":return e=t.data,e===Rd&&Od?null:e;default:return null}}function Hg(e,t){if(Cr)return e==="compositionend"||!Tu&&zf(e,t)?(e=Df(),rl=Cu=_s=null,Cr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bf&&t.locale!=="ko"?null:t.data;default:return null}}var qg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qg[e.type]:t==="textarea"}function Uf(e,t,n,r){xf(r),t=Sl(t,"onChange"),0<t.length&&(n=new Eu("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ba=null,Xa=null;function Gg(e){Jf(e,0)}function ql(e){var t=Tr(e);if(df(t))return e}function Qg(e,t){if(e==="change")return t}var Ff=!1;if(Xn){var Vo;if(Xn){var Wo="oninput"in document;if(!Wo){var Md=document.createElement("div");Md.setAttribute("oninput","return;"),Wo=typeof Md.oninput=="function"}Vo=Wo}else Vo=!1;Ff=Vo&&(!document.documentMode||9<document.documentMode)}function Id(){Ba&&(Ba.detachEvent("onpropertychange",Vf),Xa=Ba=null)}function Vf(e){if(e.propertyName==="value"&&ql(Xa)){var t=[];Uf(t,Xa,e,wu(e)),wf(Gg,t)}}function Kg(e,t,n){e==="focusin"?(Id(),Ba=t,Xa=n,Ba.attachEvent("onpropertychange",Vf)):e==="focusout"&&Id()}function Yg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ql(Xa)}function Xg(e,t){if(e==="click")return ql(t)}function Jg(e,t){if(e==="input"||e==="change")return ql(t)}function Zg(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var wn=typeof Object.is=="function"?Object.is:Zg;function Ja(e,t){if(wn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!hc.call(t,a)||!wn(e[a],t[a]))return!1}return!0}function Dd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Bd(e,t){var n=Dd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Dd(n)}}function Wf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Wf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Hf(){for(var e=window,t=vl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=vl(e.document)}return t}function Lu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ev(e){var t=Hf(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Wf(n.ownerDocument.documentElement,n)){if(r!==null&&Lu(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=Bd(n,i);var l=Bd(n,r);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var tv=Xn&&"documentMode"in document&&11>=document.documentMode,Er=null,Lc=null,za=null,Rc=!1;function zd(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Rc||Er==null||Er!==vl(r)||(r=Er,"selectionStart"in r&&Lu(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),za&&Ja(za,r)||(za=r,r=Sl(Lc,"onSelect"),0<r.length&&(t=new Eu("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Er)))}function Ui(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ar={animationend:Ui("Animation","AnimationEnd"),animationiteration:Ui("Animation","AnimationIteration"),animationstart:Ui("Animation","AnimationStart"),transitionend:Ui("Transition","TransitionEnd")},Ho={},qf={};Xn&&(qf=document.createElement("div").style,"AnimationEvent"in window||(delete Ar.animationend.animation,delete Ar.animationiteration.animation,delete Ar.animationstart.animation),"TransitionEvent"in window||delete Ar.transitionend.transition);function Gl(e){if(Ho[e])return Ho[e];if(!Ar[e])return e;var t=Ar[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in qf)return Ho[e]=t[n];return e}var Gf=Gl("animationend"),Qf=Gl("animationiteration"),Kf=Gl("animationstart"),Yf=Gl("transitionend"),Xf=new Map,$d="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ds(e,t){Xf.set(e,t),fr(t,[e])}for(var qo=0;qo<$d.length;qo++){var Go=$d[qo],nv=Go.toLowerCase(),sv=Go[0].toUpperCase()+Go.slice(1);Ds(nv,"on"+sv)}Ds(Gf,"onAnimationEnd");Ds(Qf,"onAnimationIteration");Ds(Kf,"onAnimationStart");Ds("dblclick","onDoubleClick");Ds("focusin","onFocus");Ds("focusout","onBlur");Ds(Yf,"onTransitionEnd");Vr("onMouseEnter",["mouseout","mouseover"]);Vr("onMouseLeave",["mouseout","mouseover"]);Vr("onPointerEnter",["pointerout","pointerover"]);Vr("onPointerLeave",["pointerout","pointerover"]);fr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fr("onBeforeInput",["compositionend","keypress","textInput","paste"]);fr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oa));function Ud(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,ng(r,t,void 0,e),e.currentTarget=null}function Jf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var l=r.length-1;0<=l;l--){var c=r[l],u=c.instance,p=c.currentTarget;if(c=c.listener,u!==i&&a.isPropagationStopped())break e;Ud(a,c,p),i=u}else for(l=0;l<r.length;l++){if(c=r[l],u=c.instance,p=c.currentTarget,c=c.listener,u!==i&&a.isPropagationStopped())break e;Ud(a,c,p),i=u}}}if(yl)throw e=Cc,yl=!1,Cc=null,e}function $e(e,t){var n=t[Dc];n===void 0&&(n=t[Dc]=new Set);var r=e+"__bubble";n.has(r)||(Zf(t,e,2,!1),n.add(r))}function Qo(e,t,n){var r=0;t&&(r|=4),Zf(n,e,r,t)}var Fi="_reactListening"+Math.random().toString(36).slice(2);function Za(e){if(!e[Fi]){e[Fi]=!0,af.forEach(function(n){n!=="selectionchange"&&(rv.has(n)||Qo(n,!1,e),Qo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Fi]||(t[Fi]=!0,Qo("selectionchange",!1,t))}}function Zf(e,t,n,r){switch(If(t)){case 1:var a=xg;break;case 4:a=yg;break;default:a=bu}n=a.bind(null,t,n,e),a=void 0,!bc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Ko(e,t,n,r,a){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var c=r.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(l===4)for(l=r.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;l=l.return}for(;c!==null;){if(l=sr(c),l===null)return;if(u=l.tag,u===5||u===6){r=i=l;continue e}c=c.parentNode}}r=r.return}wf(function(){var p=i,_=wu(n),v=[];e:{var N=Xf.get(e);if(N!==void 0){var A=Eu,O=e;switch(e){case"keypress":if(al(n)===0)break e;case"keydown":case"keyup":A=Pg;break;case"focusin":O="focus",A=Fo;break;case"focusout":O="blur",A=Fo;break;case"beforeblur":case"afterblur":A=Fo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=Ad;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=wg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=Dg;break;case Gf:case Qf:case Kf:A=kg;break;case Yf:A=zg;break;case"scroll":A=jg;break;case"wheel":A=Ug;break;case"copy":case"cut":case"paste":A=Cg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=Ld}var P=(t&4)!==0,C=!P&&e==="scroll",m=P?N!==null?N+"Capture":null:N;P=[];for(var f=p,y;f!==null;){y=f;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,m!==null&&(b=Ga(f,m),b!=null&&P.push(ei(f,b,y)))),C)break;f=f.return}0<P.length&&(N=new A(N,O,null,n,_),v.push({event:N,listeners:P}))}}if(!(t&7)){e:{if(N=e==="mouseover"||e==="pointerover",A=e==="mouseout"||e==="pointerout",N&&n!==Sc&&(O=n.relatedTarget||n.fromElement)&&(sr(O)||O[Jn]))break e;if((A||N)&&(N=_.window===_?_:(N=_.ownerDocument)?N.defaultView||N.parentWindow:window,A?(O=n.relatedTarget||n.toElement,A=p,O=O?sr(O):null,O!==null&&(C=pr(O),O!==C||O.tag!==5&&O.tag!==6)&&(O=null)):(A=null,O=p),A!==O)){if(P=Ad,b="onMouseLeave",m="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(P=Ld,b="onPointerLeave",m="onPointerEnter",f="pointer"),C=A==null?N:Tr(A),y=O==null?N:Tr(O),N=new P(b,f+"leave",A,n,_),N.target=C,N.relatedTarget=y,b=null,sr(_)===p&&(P=new P(m,f+"enter",O,n,_),P.target=y,P.relatedTarget=C,b=P),C=b,A&&O)t:{for(P=A,m=O,f=0,y=P;y;y=wr(y))f++;for(y=0,b=m;b;b=wr(b))y++;for(;0<f-y;)P=wr(P),f--;for(;0<y-f;)m=wr(m),y--;for(;f--;){if(P===m||m!==null&&P===m.alternate)break t;P=wr(P),m=wr(m)}P=null}else P=null;A!==null&&Fd(v,N,A,P,!1),O!==null&&C!==null&&Fd(v,C,O,P,!0)}}e:{if(N=p?Tr(p):window,A=N.nodeName&&N.nodeName.toLowerCase(),A==="select"||A==="input"&&N.type==="file")var M=Qg;else if(Pd(N))if(Ff)M=Jg;else{M=Yg;var z=Kg}else(A=N.nodeName)&&A.toLowerCase()==="input"&&(N.type==="checkbox"||N.type==="radio")&&(M=Xg);if(M&&(M=M(e,p))){Uf(v,M,n,_);break e}z&&z(e,N,p),e==="focusout"&&(z=N._wrapperState)&&z.controlled&&N.type==="number"&&yc(N,"number",N.value)}switch(z=p?Tr(p):window,e){case"focusin":(Pd(z)||z.contentEditable==="true")&&(Er=z,Lc=p,za=null);break;case"focusout":za=Lc=Er=null;break;case"mousedown":Rc=!0;break;case"contextmenu":case"mouseup":case"dragend":Rc=!1,zd(v,n,_);break;case"selectionchange":if(tv)break;case"keydown":case"keyup":zd(v,n,_)}var j;if(Tu)e:{switch(e){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else Cr?zf(e,n)&&(g="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(g="onCompositionStart");g&&(Bf&&n.locale!=="ko"&&(Cr||g!=="onCompositionStart"?g==="onCompositionEnd"&&Cr&&(j=Df()):(_s=_,Cu="value"in _s?_s.value:_s.textContent,Cr=!0)),z=Sl(p,g),0<z.length&&(g=new Td(g,e,null,n,_),v.push({event:g,listeners:z}),j?g.data=j:(j=$f(n),j!==null&&(g.data=j)))),(j=Vg?Wg(e,n):Hg(e,n))&&(p=Sl(p,"onBeforeInput"),0<p.length&&(_=new Td("onBeforeInput","beforeinput",null,n,_),v.push({event:_,listeners:p}),_.data=j))}Jf(v,t)})}function ei(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Sl(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ga(e,n),i!=null&&r.unshift(ei(e,i,a)),i=Ga(e,t),i!=null&&r.push(ei(e,i,a))),e=e.return}return r}function wr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Fd(e,t,n,r,a){for(var i=t._reactName,l=[];n!==null&&n!==r;){var c=n,u=c.alternate,p=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&p!==null&&(c=p,a?(u=Ga(n,i),u!=null&&l.unshift(ei(n,u,c))):a||(u=Ga(n,i),u!=null&&l.push(ei(n,u,c)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var av=/\r\n?/g,iv=/\u0000|\uFFFD/g;function Vd(e){return(typeof e=="string"?e:""+e).replace(av,`
`).replace(iv,"")}function Vi(e,t,n){if(t=Vd(t),Vd(e)!==t&&n)throw Error($(425))}function kl(){}var Oc=null,Pc=null;function Mc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ic=typeof setTimeout=="function"?setTimeout:void 0,lv=typeof clearTimeout=="function"?clearTimeout:void 0,Wd=typeof Promise=="function"?Promise:void 0,ov=typeof queueMicrotask=="function"?queueMicrotask:typeof Wd<"u"?function(e){return Wd.resolve(null).then(e).catch(cv)}:Ic;function cv(e){setTimeout(function(){throw e})}function Yo(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),Ya(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Ya(t)}function As(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Hd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Jr=Math.random().toString(36).slice(2),On="__reactFiber$"+Jr,ti="__reactProps$"+Jr,Jn="__reactContainer$"+Jr,Dc="__reactEvents$"+Jr,uv="__reactListeners$"+Jr,dv="__reactHandles$"+Jr;function sr(e){var t=e[On];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Jn]||n[On]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Hd(e);e!==null;){if(n=e[On])return n;e=Hd(e)}return t}e=n,n=e.parentNode}return null}function di(e){return e=e[On]||e[Jn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Tr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error($(33))}function Ql(e){return e[ti]||null}var Bc=[],Lr=-1;function Bs(e){return{current:e}}function Ue(e){0>Lr||(e.current=Bc[Lr],Bc[Lr]=null,Lr--)}function Be(e,t){Lr++,Bc[Lr]=e.current,e.current=t}var Is={},_t=Bs(Is),Mt=Bs(!1),or=Is;function Wr(e,t){var n=e.type.contextTypes;if(!n)return Is;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function It(e){return e=e.childContextTypes,e!=null}function bl(){Ue(Mt),Ue(_t)}function qd(e,t,n){if(_t.current!==Is)throw Error($(168));Be(_t,t),Be(Mt,n)}function ep(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error($(108,Km(e)||"Unknown",a));return He({},n,r)}function Cl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Is,or=_t.current,Be(_t,e),Be(Mt,Mt.current),!0}function Gd(e,t,n){var r=e.stateNode;if(!r)throw Error($(169));n?(e=ep(e,t,or),r.__reactInternalMemoizedMergedChildContext=e,Ue(Mt),Ue(_t),Be(_t,e)):Ue(Mt),Be(Mt,n)}var qn=null,Kl=!1,Xo=!1;function tp(e){qn===null?qn=[e]:qn.push(e)}function hv(e){Kl=!0,tp(e)}function zs(){if(!Xo&&qn!==null){Xo=!0;var e=0,t=Re;try{var n=qn;for(Re=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}qn=null,Kl=!1}catch(a){throw qn!==null&&(qn=qn.slice(e+1)),bf(_u,zs),a}finally{Re=t,Xo=!1}}return null}var Rr=[],Or=0,El=null,Al=0,en=[],tn=0,cr=null,Qn=1,Kn="";function tr(e,t){Rr[Or++]=Al,Rr[Or++]=El,El=e,Al=t}function np(e,t,n){en[tn++]=Qn,en[tn++]=Kn,en[tn++]=cr,cr=e;var r=Qn;e=Kn;var a=32-jn(r)-1;r&=~(1<<a),n+=1;var i=32-jn(t)+a;if(30<i){var l=a-a%5;i=(r&(1<<l)-1).toString(32),r>>=l,a-=l,Qn=1<<32-jn(t)+a|n<<a|r,Kn=i+e}else Qn=1<<i|n<<a|r,Kn=e}function Ru(e){e.return!==null&&(tr(e,1),np(e,1,0))}function Ou(e){for(;e===El;)El=Rr[--Or],Rr[Or]=null,Al=Rr[--Or],Rr[Or]=null;for(;e===cr;)cr=en[--tn],en[tn]=null,Kn=en[--tn],en[tn]=null,Qn=en[--tn],en[tn]=null}var Vt=null,Ft=null,Fe=!1,yn=null;function sp(e,t){var n=sn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Qd(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Vt=e,Ft=As(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Vt=e,Ft=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=cr!==null?{id:Qn,overflow:Kn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=sn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Vt=e,Ft=null,!0):!1;default:return!1}}function zc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function $c(e){if(Fe){var t=Ft;if(t){var n=t;if(!Qd(e,t)){if(zc(e))throw Error($(418));t=As(n.nextSibling);var r=Vt;t&&Qd(e,t)?sp(r,n):(e.flags=e.flags&-4097|2,Fe=!1,Vt=e)}}else{if(zc(e))throw Error($(418));e.flags=e.flags&-4097|2,Fe=!1,Vt=e}}}function Kd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Vt=e}function Wi(e){if(e!==Vt)return!1;if(!Fe)return Kd(e),Fe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Mc(e.type,e.memoizedProps)),t&&(t=Ft)){if(zc(e))throw rp(),Error($(418));for(;t;)sp(e,t),t=As(t.nextSibling)}if(Kd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error($(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ft=As(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ft=null}}else Ft=Vt?As(e.stateNode.nextSibling):null;return!0}function rp(){for(var e=Ft;e;)e=As(e.nextSibling)}function Hr(){Ft=Vt=null,Fe=!1}function Pu(e){yn===null?yn=[e]:yn.push(e)}var fv=ts.ReactCurrentBatchConfig;function ka(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,e));var a=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var c=a.refs;l===null?delete c[i]:c[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error($(284));if(!n._owner)throw Error($(290,e))}return e}function Hi(e,t){throw e=Object.prototype.toString.call(t),Error($(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yd(e){var t=e._init;return t(e._payload)}function ap(e){function t(m,f){if(e){var y=m.deletions;y===null?(m.deletions=[f],m.flags|=16):y.push(f)}}function n(m,f){if(!e)return null;for(;f!==null;)t(m,f),f=f.sibling;return null}function r(m,f){for(m=new Map;f!==null;)f.key!==null?m.set(f.key,f):m.set(f.index,f),f=f.sibling;return m}function a(m,f){return m=Os(m,f),m.index=0,m.sibling=null,m}function i(m,f,y){return m.index=y,e?(y=m.alternate,y!==null?(y=y.index,y<f?(m.flags|=2,f):y):(m.flags|=2,f)):(m.flags|=1048576,f)}function l(m){return e&&m.alternate===null&&(m.flags|=2),m}function c(m,f,y,b){return f===null||f.tag!==6?(f=rc(y,m.mode,b),f.return=m,f):(f=a(f,y),f.return=m,f)}function u(m,f,y,b){var M=y.type;return M===br?_(m,f,y.props.children,b,y.key):f!==null&&(f.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===ys&&Yd(M)===f.type)?(b=a(f,y.props),b.ref=ka(m,f,y),b.return=m,b):(b=hl(y.type,y.key,y.props,null,m.mode,b),b.ref=ka(m,f,y),b.return=m,b)}function p(m,f,y,b){return f===null||f.tag!==4||f.stateNode.containerInfo!==y.containerInfo||f.stateNode.implementation!==y.implementation?(f=ac(y,m.mode,b),f.return=m,f):(f=a(f,y.children||[]),f.return=m,f)}function _(m,f,y,b,M){return f===null||f.tag!==7?(f=lr(y,m.mode,b,M),f.return=m,f):(f=a(f,y),f.return=m,f)}function v(m,f,y){if(typeof f=="string"&&f!==""||typeof f=="number")return f=rc(""+f,m.mode,y),f.return=m,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Pi:return y=hl(f.type,f.key,f.props,null,m.mode,y),y.ref=ka(m,null,f),y.return=m,y;case kr:return f=ac(f,m.mode,y),f.return=m,f;case ys:var b=f._init;return v(m,b(f._payload),y)}if(La(f)||ja(f))return f=lr(f,m.mode,y,null),f.return=m,f;Hi(m,f)}return null}function N(m,f,y,b){var M=f!==null?f.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return M!==null?null:c(m,f,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Pi:return y.key===M?u(m,f,y,b):null;case kr:return y.key===M?p(m,f,y,b):null;case ys:return M=y._init,N(m,f,M(y._payload),b)}if(La(y)||ja(y))return M!==null?null:_(m,f,y,b,null);Hi(m,y)}return null}function A(m,f,y,b,M){if(typeof b=="string"&&b!==""||typeof b=="number")return m=m.get(y)||null,c(f,m,""+b,M);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Pi:return m=m.get(b.key===null?y:b.key)||null,u(f,m,b,M);case kr:return m=m.get(b.key===null?y:b.key)||null,p(f,m,b,M);case ys:var z=b._init;return A(m,f,y,z(b._payload),M)}if(La(b)||ja(b))return m=m.get(y)||null,_(f,m,b,M,null);Hi(f,b)}return null}function O(m,f,y,b){for(var M=null,z=null,j=f,g=f=0,B=null;j!==null&&g<y.length;g++){j.index>g?(B=j,j=null):B=j.sibling;var T=N(m,j,y[g],b);if(T===null){j===null&&(j=B);break}e&&j&&T.alternate===null&&t(m,j),f=i(T,f,g),z===null?M=T:z.sibling=T,z=T,j=B}if(g===y.length)return n(m,j),Fe&&tr(m,g),M;if(j===null){for(;g<y.length;g++)j=v(m,y[g],b),j!==null&&(f=i(j,f,g),z===null?M=j:z.sibling=j,z=j);return Fe&&tr(m,g),M}for(j=r(m,j);g<y.length;g++)B=A(j,m,g,y[g],b),B!==null&&(e&&B.alternate!==null&&j.delete(B.key===null?g:B.key),f=i(B,f,g),z===null?M=B:z.sibling=B,z=B);return e&&j.forEach(function(K){return t(m,K)}),Fe&&tr(m,g),M}function P(m,f,y,b){var M=ja(y);if(typeof M!="function")throw Error($(150));if(y=M.call(y),y==null)throw Error($(151));for(var z=M=null,j=f,g=f=0,B=null,T=y.next();j!==null&&!T.done;g++,T=y.next()){j.index>g?(B=j,j=null):B=j.sibling;var K=N(m,j,T.value,b);if(K===null){j===null&&(j=B);break}e&&j&&K.alternate===null&&t(m,j),f=i(K,f,g),z===null?M=K:z.sibling=K,z=K,j=B}if(T.done)return n(m,j),Fe&&tr(m,g),M;if(j===null){for(;!T.done;g++,T=y.next())T=v(m,T.value,b),T!==null&&(f=i(T,f,g),z===null?M=T:z.sibling=T,z=T);return Fe&&tr(m,g),M}for(j=r(m,j);!T.done;g++,T=y.next())T=A(j,m,g,T.value,b),T!==null&&(e&&T.alternate!==null&&j.delete(T.key===null?g:T.key),f=i(T,f,g),z===null?M=T:z.sibling=T,z=T);return e&&j.forEach(function(oe){return t(m,oe)}),Fe&&tr(m,g),M}function C(m,f,y,b){if(typeof y=="object"&&y!==null&&y.type===br&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Pi:e:{for(var M=y.key,z=f;z!==null;){if(z.key===M){if(M=y.type,M===br){if(z.tag===7){n(m,z.sibling),f=a(z,y.props.children),f.return=m,m=f;break e}}else if(z.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===ys&&Yd(M)===z.type){n(m,z.sibling),f=a(z,y.props),f.ref=ka(m,z,y),f.return=m,m=f;break e}n(m,z);break}else t(m,z);z=z.sibling}y.type===br?(f=lr(y.props.children,m.mode,b,y.key),f.return=m,m=f):(b=hl(y.type,y.key,y.props,null,m.mode,b),b.ref=ka(m,f,y),b.return=m,m=b)}return l(m);case kr:e:{for(z=y.key;f!==null;){if(f.key===z)if(f.tag===4&&f.stateNode.containerInfo===y.containerInfo&&f.stateNode.implementation===y.implementation){n(m,f.sibling),f=a(f,y.children||[]),f.return=m,m=f;break e}else{n(m,f);break}else t(m,f);f=f.sibling}f=ac(y,m.mode,b),f.return=m,m=f}return l(m);case ys:return z=y._init,C(m,f,z(y._payload),b)}if(La(y))return O(m,f,y,b);if(ja(y))return P(m,f,y,b);Hi(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,f!==null&&f.tag===6?(n(m,f.sibling),f=a(f,y),f.return=m,m=f):(n(m,f),f=rc(y,m.mode,b),f.return=m,m=f),l(m)):n(m,f)}return C}var qr=ap(!0),ip=ap(!1),Tl=Bs(null),Ll=null,Pr=null,Mu=null;function Iu(){Mu=Pr=Ll=null}function Du(e){var t=Tl.current;Ue(Tl),e._currentValue=t}function Uc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ur(e,t){Ll=e,Mu=Pr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Pt=!0),e.firstContext=null)}function an(e){var t=e._currentValue;if(Mu!==e)if(e={context:e,memoizedValue:t,next:null},Pr===null){if(Ll===null)throw Error($(308));Pr=e,Ll.dependencies={lanes:0,firstContext:e}}else Pr=Pr.next=e;return t}var rr=null;function Bu(e){rr===null?rr=[e]:rr.push(e)}function lp(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,Bu(t)):(n.next=a.next,a.next=n),t.interleaved=n,Zn(e,r)}function Zn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var js=!1;function zu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function op(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Yn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ts(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Se&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Zn(e,n)}return a=r.interleaved,a===null?(t.next=t,Bu(r)):(t.next=a.next,a.next=t),r.interleaved=t,Zn(e,n)}function il(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Su(e,n)}}function Xd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=l:i=i.next=l,n=n.next}while(n!==null);i===null?a=i=t:i=i.next=t}else a=i=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Rl(e,t,n,r){var a=e.updateQueue;js=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var u=c,p=u.next;u.next=null,l===null?i=p:l.next=p,l=u;var _=e.alternate;_!==null&&(_=_.updateQueue,c=_.lastBaseUpdate,c!==l&&(c===null?_.firstBaseUpdate=p:c.next=p,_.lastBaseUpdate=u))}if(i!==null){var v=a.baseState;l=0,_=p=u=null,c=i;do{var N=c.lane,A=c.eventTime;if((r&N)===N){_!==null&&(_=_.next={eventTime:A,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var O=e,P=c;switch(N=t,A=n,P.tag){case 1:if(O=P.payload,typeof O=="function"){v=O.call(A,v,N);break e}v=O;break e;case 3:O.flags=O.flags&-65537|128;case 0:if(O=P.payload,N=typeof O=="function"?O.call(A,v,N):O,N==null)break e;v=He({},v,N);break e;case 2:js=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,N=a.effects,N===null?a.effects=[c]:N.push(c))}else A={eventTime:A,lane:N,tag:c.tag,payload:c.payload,callback:c.callback,next:null},_===null?(p=_=A,u=v):_=_.next=A,l|=N;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;N=c,c=N.next,N.next=null,a.lastBaseUpdate=N,a.shared.pending=null}}while(!0);if(_===null&&(u=v),a.baseState=u,a.firstBaseUpdate=p,a.lastBaseUpdate=_,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);dr|=l,e.lanes=l,e.memoizedState=v}}function Jd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error($(191,a));a.call(r)}}}var hi={},Mn=Bs(hi),ni=Bs(hi),si=Bs(hi);function ar(e){if(e===hi)throw Error($(174));return e}function $u(e,t){switch(Be(si,t),Be(ni,e),Be(Mn,hi),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Nc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Nc(t,e)}Ue(Mn),Be(Mn,t)}function Gr(){Ue(Mn),Ue(ni),Ue(si)}function cp(e){ar(si.current);var t=ar(Mn.current),n=Nc(t,e.type);t!==n&&(Be(ni,e),Be(Mn,n))}function Uu(e){ni.current===e&&(Ue(Mn),Ue(ni))}var Ve=Bs(0);function Ol(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Jo=[];function Fu(){for(var e=0;e<Jo.length;e++)Jo[e]._workInProgressVersionPrimary=null;Jo.length=0}var ll=ts.ReactCurrentDispatcher,Zo=ts.ReactCurrentBatchConfig,ur=0,We=null,at=null,dt=null,Pl=!1,$a=!1,ri=0,pv=0;function jt(){throw Error($(321))}function Vu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!wn(e[n],t[n]))return!1;return!0}function Wu(e,t,n,r,a,i){if(ur=i,We=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ll.current=e===null||e.memoizedState===null?xv:yv,e=n(r,a),$a){i=0;do{if($a=!1,ri=0,25<=i)throw Error($(301));i+=1,dt=at=null,t.updateQueue=null,ll.current=jv,e=n(r,a)}while($a)}if(ll.current=Ml,t=at!==null&&at.next!==null,ur=0,dt=at=We=null,Pl=!1,t)throw Error($(300));return e}function Hu(){var e=ri!==0;return ri=0,e}function Rn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?We.memoizedState=dt=e:dt=dt.next=e,dt}function ln(){if(at===null){var e=We.alternate;e=e!==null?e.memoizedState:null}else e=at.next;var t=dt===null?We.memoizedState:dt.next;if(t!==null)dt=t,at=e;else{if(e===null)throw Error($(310));at=e,e={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},dt===null?We.memoizedState=dt=e:dt=dt.next=e}return dt}function ai(e,t){return typeof t=="function"?t(e):t}function ec(e){var t=ln(),n=t.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=e;var r=at,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var c=l=null,u=null,p=i;do{var _=p.lane;if((ur&_)===_)u!==null&&(u=u.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),r=p.hasEagerState?p.eagerState:e(r,p.action);else{var v={lane:_,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};u===null?(c=u=v,l=r):u=u.next=v,We.lanes|=_,dr|=_}p=p.next}while(p!==null&&p!==i);u===null?l=r:u.next=c,wn(r,t.memoizedState)||(Pt=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do i=a.lane,We.lanes|=i,dr|=i,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function tc(e){var t=ln(),n=t.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(a!==null){n.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);wn(i,t.memoizedState)||(Pt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function up(){}function dp(e,t){var n=We,r=ln(),a=t(),i=!wn(r.memoizedState,a);if(i&&(r.memoizedState=a,Pt=!0),r=r.queue,qu(pp.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||dt!==null&&dt.memoizedState.tag&1){if(n.flags|=2048,ii(9,fp.bind(null,n,r,a,t),void 0,null),ht===null)throw Error($(349));ur&30||hp(n,t,a)}return a}function hp(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=We.updateQueue,t===null?(t={lastEffect:null,stores:null},We.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function fp(e,t,n,r){t.value=n,t.getSnapshot=r,mp(t)&&gp(e)}function pp(e,t,n){return n(function(){mp(t)&&gp(e)})}function mp(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!wn(e,n)}catch{return!0}}function gp(e){var t=Zn(e,1);t!==null&&Nn(t,e,1,-1)}function Zd(e){var t=Rn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:e},t.queue=e,e=e.dispatch=vv.bind(null,We,e),[t.memoizedState,e]}function ii(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=We.updateQueue,t===null?(t={lastEffect:null,stores:null},We.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function vp(){return ln().memoizedState}function ol(e,t,n,r){var a=Rn();We.flags|=e,a.memoizedState=ii(1|t,n,void 0,r===void 0?null:r)}function Yl(e,t,n,r){var a=ln();r=r===void 0?null:r;var i=void 0;if(at!==null){var l=at.memoizedState;if(i=l.destroy,r!==null&&Vu(r,l.deps)){a.memoizedState=ii(t,n,i,r);return}}We.flags|=e,a.memoizedState=ii(1|t,n,i,r)}function eh(e,t){return ol(8390656,8,e,t)}function qu(e,t){return Yl(2048,8,e,t)}function xp(e,t){return Yl(4,2,e,t)}function yp(e,t){return Yl(4,4,e,t)}function jp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Np(e,t,n){return n=n!=null?n.concat([e]):null,Yl(4,4,jp.bind(null,t,e),n)}function Gu(){}function wp(e,t){var n=ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Vu(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function _p(e,t){var n=ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Vu(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Sp(e,t,n){return ur&21?(wn(n,t)||(n=Af(),We.lanes|=n,dr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Pt=!0),e.memoizedState=n)}function mv(e,t){var n=Re;Re=n!==0&&4>n?n:4,e(!0);var r=Zo.transition;Zo.transition={};try{e(!1),t()}finally{Re=n,Zo.transition=r}}function kp(){return ln().memoizedState}function gv(e,t,n){var r=Rs(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},bp(e))Cp(t,n);else if(n=lp(e,t,n,r),n!==null){var a=Et();Nn(n,e,r,a),Ep(n,t,r)}}function vv(e,t,n){var r=Rs(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(bp(e))Cp(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,c=i(l,n);if(a.hasEagerState=!0,a.eagerState=c,wn(c,l)){var u=t.interleaved;u===null?(a.next=a,Bu(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}n=lp(e,t,a,r),n!==null&&(a=Et(),Nn(n,e,r,a),Ep(n,t,r))}}function bp(e){var t=e.alternate;return e===We||t!==null&&t===We}function Cp(e,t){$a=Pl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ep(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Su(e,n)}}var Ml={readContext:an,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useInsertionEffect:jt,useLayoutEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useMutableSource:jt,useSyncExternalStore:jt,useId:jt,unstable_isNewReconciler:!1},xv={readContext:an,useCallback:function(e,t){return Rn().memoizedState=[e,t===void 0?null:t],e},useContext:an,useEffect:eh,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ol(4194308,4,jp.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ol(4194308,4,e,t)},useInsertionEffect:function(e,t){return ol(4,2,e,t)},useMemo:function(e,t){var n=Rn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Rn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=gv.bind(null,We,e),[r.memoizedState,e]},useRef:function(e){var t=Rn();return e={current:e},t.memoizedState=e},useState:Zd,useDebugValue:Gu,useDeferredValue:function(e){return Rn().memoizedState=e},useTransition:function(){var e=Zd(!1),t=e[0];return e=mv.bind(null,e[1]),Rn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=We,a=Rn();if(Fe){if(n===void 0)throw Error($(407));n=n()}else{if(n=t(),ht===null)throw Error($(349));ur&30||hp(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,eh(pp.bind(null,r,i,e),[e]),r.flags|=2048,ii(9,fp.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Rn(),t=ht.identifierPrefix;if(Fe){var n=Kn,r=Qn;n=(r&~(1<<32-jn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ri++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=pv++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},yv={readContext:an,useCallback:wp,useContext:an,useEffect:qu,useImperativeHandle:Np,useInsertionEffect:xp,useLayoutEffect:yp,useMemo:_p,useReducer:ec,useRef:vp,useState:function(){return ec(ai)},useDebugValue:Gu,useDeferredValue:function(e){var t=ln();return Sp(t,at.memoizedState,e)},useTransition:function(){var e=ec(ai)[0],t=ln().memoizedState;return[e,t]},useMutableSource:up,useSyncExternalStore:dp,useId:kp,unstable_isNewReconciler:!1},jv={readContext:an,useCallback:wp,useContext:an,useEffect:qu,useImperativeHandle:Np,useInsertionEffect:xp,useLayoutEffect:yp,useMemo:_p,useReducer:tc,useRef:vp,useState:function(){return tc(ai)},useDebugValue:Gu,useDeferredValue:function(e){var t=ln();return at===null?t.memoizedState=e:Sp(t,at.memoizedState,e)},useTransition:function(){var e=tc(ai)[0],t=ln().memoizedState;return[e,t]},useMutableSource:up,useSyncExternalStore:dp,useId:kp,unstable_isNewReconciler:!1};function gn(e,t){if(e&&e.defaultProps){t=He({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Fc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:He({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Xl={isMounted:function(e){return(e=e._reactInternals)?pr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Et(),a=Rs(e),i=Yn(r,a);i.payload=t,n!=null&&(i.callback=n),t=Ts(e,i,a),t!==null&&(Nn(t,e,a,r),il(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Et(),a=Rs(e),i=Yn(r,a);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Ts(e,i,a),t!==null&&(Nn(t,e,a,r),il(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Et(),r=Rs(e),a=Yn(n,r);a.tag=2,t!=null&&(a.callback=t),t=Ts(e,a,r),t!==null&&(Nn(t,e,r,n),il(t,e,r))}};function th(e,t,n,r,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,l):t.prototype&&t.prototype.isPureReactComponent?!Ja(n,r)||!Ja(a,i):!0}function Ap(e,t,n){var r=!1,a=Is,i=t.contextType;return typeof i=="object"&&i!==null?i=an(i):(a=It(t)?or:_t.current,r=t.contextTypes,i=(r=r!=null)?Wr(e,a):Is),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Xl,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function nh(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Xl.enqueueReplaceState(t,t.state,null)}function Vc(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},zu(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=an(i):(i=It(t)?or:_t.current,a.context=Wr(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Fc(e,t,i,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Xl.enqueueReplaceState(a,a.state,null),Rl(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Qr(e,t){try{var n="",r=t;do n+=Qm(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function nc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Wc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Nv=typeof WeakMap=="function"?WeakMap:Map;function Tp(e,t,n){n=Yn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Dl||(Dl=!0,eu=r),Wc(e,t)},n}function Lp(e,t,n){n=Yn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){Wc(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Wc(e,t),typeof r!="function"&&(Ls===null?Ls=new Set([this]):Ls.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function sh(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Nv;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Mv.bind(null,e,t,n),t.then(e,e))}function rh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ah(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Yn(-1,1),t.tag=2,Ts(n,t,1))),n.lanes|=1),e)}var wv=ts.ReactCurrentOwner,Pt=!1;function Ct(e,t,n,r){t.child=e===null?ip(t,null,n,r):qr(t,e.child,n,r)}function ih(e,t,n,r,a){n=n.render;var i=t.ref;return Ur(t,a),r=Wu(e,t,n,r,i,a),n=Hu(),e!==null&&!Pt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,es(e,t,a)):(Fe&&n&&Ru(t),t.flags|=1,Ct(e,t,r,a),t.child)}function lh(e,t,n,r,a){if(e===null){var i=n.type;return typeof i=="function"&&!td(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Rp(e,t,i,r,a)):(e=hl(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ja,n(l,r)&&e.ref===t.ref)return es(e,t,a)}return t.flags|=1,e=Os(i,r),e.ref=t.ref,e.return=t,t.child=e}function Rp(e,t,n,r,a){if(e!==null){var i=e.memoizedProps;if(Ja(i,r)&&e.ref===t.ref)if(Pt=!1,t.pendingProps=r=i,(e.lanes&a)!==0)e.flags&131072&&(Pt=!0);else return t.lanes=e.lanes,es(e,t,a)}return Hc(e,t,n,r,a)}function Op(e,t,n){var r=t.pendingProps,a=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(Ir,Ut),Ut|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Be(Ir,Ut),Ut|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Be(Ir,Ut),Ut|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Be(Ir,Ut),Ut|=r;return Ct(e,t,a,n),t.child}function Pp(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Hc(e,t,n,r,a){var i=It(n)?or:_t.current;return i=Wr(t,i),Ur(t,a),n=Wu(e,t,n,r,i,a),r=Hu(),e!==null&&!Pt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,es(e,t,a)):(Fe&&r&&Ru(t),t.flags|=1,Ct(e,t,n,a),t.child)}function oh(e,t,n,r,a){if(It(n)){var i=!0;Cl(t)}else i=!1;if(Ur(t,a),t.stateNode===null)cl(e,t),Ap(t,n,r),Vc(t,n,r,a),r=!0;else if(e===null){var l=t.stateNode,c=t.memoizedProps;l.props=c;var u=l.context,p=n.contextType;typeof p=="object"&&p!==null?p=an(p):(p=It(n)?or:_t.current,p=Wr(t,p));var _=n.getDerivedStateFromProps,v=typeof _=="function"||typeof l.getSnapshotBeforeUpdate=="function";v||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==r||u!==p)&&nh(t,l,r,p),js=!1;var N=t.memoizedState;l.state=N,Rl(t,r,l,a),u=t.memoizedState,c!==r||N!==u||Mt.current||js?(typeof _=="function"&&(Fc(t,n,_,r),u=t.memoizedState),(c=js||th(t,n,c,r,N,u,p))?(v||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),l.props=r,l.state=u,l.context=p,r=c):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,op(e,t),c=t.memoizedProps,p=t.type===t.elementType?c:gn(t.type,c),l.props=p,v=t.pendingProps,N=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=an(u):(u=It(n)?or:_t.current,u=Wr(t,u));var A=n.getDerivedStateFromProps;(_=typeof A=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==v||N!==u)&&nh(t,l,r,u),js=!1,N=t.memoizedState,l.state=N,Rl(t,r,l,a);var O=t.memoizedState;c!==v||N!==O||Mt.current||js?(typeof A=="function"&&(Fc(t,n,A,r),O=t.memoizedState),(p=js||th(t,n,p,r,N,O,u)||!1)?(_||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,O,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,O,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&N===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&N===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=O),l.props=r,l.state=O,l.context=u,r=p):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&N===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&N===e.memoizedState||(t.flags|=1024),r=!1)}return qc(e,t,n,r,i,a)}function qc(e,t,n,r,a,i){Pp(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return a&&Gd(t,n,!1),es(e,t,i);r=t.stateNode,wv.current=t;var c=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=qr(t,e.child,null,i),t.child=qr(t,null,c,i)):Ct(e,t,c,i),t.memoizedState=r.state,a&&Gd(t,n,!0),t.child}function Mp(e){var t=e.stateNode;t.pendingContext?qd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&qd(e,t.context,!1),$u(e,t.containerInfo)}function ch(e,t,n,r,a){return Hr(),Pu(a),t.flags|=256,Ct(e,t,n,r),t.child}var Gc={dehydrated:null,treeContext:null,retryLane:0};function Qc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ip(e,t,n){var r=t.pendingProps,a=Ve.current,i=!1,l=(t.flags&128)!==0,c;if((c=l)||(c=e!==null&&e.memoizedState===null?!1:(a&2)!==0),c?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Be(Ve,a&1),e===null)return $c(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,i?(r=t.mode,i=t.child,l={mode:"hidden",children:l},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=eo(l,r,0,null),e=lr(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Qc(n),t.memoizedState=Gc,e):Qu(t,l));if(a=e.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return _v(e,t,l,r,c,a,n);if(i){i=r.fallback,l=t.mode,a=e.child,c=a.sibling;var u={mode:"hidden",children:r.children};return!(l&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Os(a,u),r.subtreeFlags=a.subtreeFlags&14680064),c!==null?i=Os(c,i):(i=lr(i,l,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,l=e.child.memoizedState,l=l===null?Qc(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=Gc,r}return i=e.child,e=i.sibling,r=Os(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Qu(e,t){return t=eo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function qi(e,t,n,r){return r!==null&&Pu(r),qr(t,e.child,null,n),e=Qu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function _v(e,t,n,r,a,i,l){if(n)return t.flags&256?(t.flags&=-257,r=nc(Error($(422))),qi(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=eo({mode:"visible",children:r.children},a,0,null),i=lr(i,a,l,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&qr(t,e.child,null,l),t.child.memoizedState=Qc(l),t.memoizedState=Gc,i);if(!(t.mode&1))return qi(e,t,l,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error($(419)),r=nc(i,r,void 0),qi(e,t,l,r)}if(c=(l&e.childLanes)!==0,Pt||c){if(r=ht,r!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Zn(e,a),Nn(r,e,a,-1))}return ed(),r=nc(Error($(421))),qi(e,t,l,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Iv.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Ft=As(a.nextSibling),Vt=t,Fe=!0,yn=null,e!==null&&(en[tn++]=Qn,en[tn++]=Kn,en[tn++]=cr,Qn=e.id,Kn=e.overflow,cr=t),t=Qu(t,r.children),t.flags|=4096,t)}function uh(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Uc(e.return,t,n)}function sc(e,t,n,r,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Dp(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Ct(e,t,r.children,n),r=Ve.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&uh(e,n,t);else if(e.tag===19)uh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Be(Ve,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&Ol(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),sc(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Ol(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}sc(t,!0,n,null,i);break;case"together":sc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function cl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function es(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),dr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error($(153));if(t.child!==null){for(e=t.child,n=Os(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Os(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Sv(e,t,n){switch(t.tag){case 3:Mp(t),Hr();break;case 5:cp(t);break;case 1:It(t.type)&&Cl(t);break;case 4:$u(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Be(Tl,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Be(Ve,Ve.current&1),t.flags|=128,null):n&t.child.childLanes?Ip(e,t,n):(Be(Ve,Ve.current&1),e=es(e,t,n),e!==null?e.sibling:null);Be(Ve,Ve.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Dp(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Be(Ve,Ve.current),r)break;return null;case 22:case 23:return t.lanes=0,Op(e,t,n)}return es(e,t,n)}var Bp,Kc,zp,$p;Bp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Kc=function(){};zp=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,ar(Mn.current);var i=null;switch(n){case"input":a=vc(e,a),r=vc(e,r),i=[];break;case"select":a=He({},a,{value:void 0}),r=He({},r,{value:void 0}),i=[];break;case"textarea":a=jc(e,a),r=jc(e,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=kl)}wc(n,r);var l;n=null;for(p in a)if(!r.hasOwnProperty(p)&&a.hasOwnProperty(p)&&a[p]!=null)if(p==="style"){var c=a[p];for(l in c)c.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(Ha.hasOwnProperty(p)?i||(i=[]):(i=i||[]).push(p,null));for(p in r){var u=r[p];if(c=a!=null?a[p]:void 0,r.hasOwnProperty(p)&&u!==c&&(u!=null||c!=null))if(p==="style")if(c){for(l in c)!c.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&c[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(i||(i=[]),i.push(p,n)),n=u;else p==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(p,u)):p==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(p,""+u):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(Ha.hasOwnProperty(p)?(u!=null&&p==="onScroll"&&$e("scroll",e),i||c===u||(i=[])):(i=i||[]).push(p,u))}n&&(i=i||[]).push("style",n);var p=i;(t.updateQueue=p)&&(t.flags|=4)}};$p=function(e,t,n,r){n!==r&&(t.flags|=4)};function ba(e,t){if(!Fe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Nt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function kv(e,t,n){var r=t.pendingProps;switch(Ou(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(t),null;case 1:return It(t.type)&&bl(),Nt(t),null;case 3:return r=t.stateNode,Gr(),Ue(Mt),Ue(_t),Fu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Wi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,yn!==null&&(su(yn),yn=null))),Kc(e,t),Nt(t),null;case 5:Uu(t);var a=ar(si.current);if(n=t.type,e!==null&&t.stateNode!=null)zp(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error($(166));return Nt(t),null}if(e=ar(Mn.current),Wi(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[On]=t,r[ti]=i,e=(t.mode&1)!==0,n){case"dialog":$e("cancel",r),$e("close",r);break;case"iframe":case"object":case"embed":$e("load",r);break;case"video":case"audio":for(a=0;a<Oa.length;a++)$e(Oa[a],r);break;case"source":$e("error",r);break;case"img":case"image":case"link":$e("error",r),$e("load",r);break;case"details":$e("toggle",r);break;case"input":yd(r,i),$e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},$e("invalid",r);break;case"textarea":Nd(r,i),$e("invalid",r)}wc(n,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&Vi(r.textContent,c,e),a=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&Vi(r.textContent,c,e),a=["children",""+c]):Ha.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&$e("scroll",r)}switch(n){case"input":Mi(r),jd(r,i,!0);break;case"textarea":Mi(r),wd(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=kl)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=pf(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[On]=t,e[ti]=r,Bp(e,t,!1,!1),t.stateNode=e;e:{switch(l=_c(n,r),n){case"dialog":$e("cancel",e),$e("close",e),a=r;break;case"iframe":case"object":case"embed":$e("load",e),a=r;break;case"video":case"audio":for(a=0;a<Oa.length;a++)$e(Oa[a],e);a=r;break;case"source":$e("error",e),a=r;break;case"img":case"image":case"link":$e("error",e),$e("load",e),a=r;break;case"details":$e("toggle",e),a=r;break;case"input":yd(e,r),a=vc(e,r),$e("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=He({},r,{value:void 0}),$e("invalid",e);break;case"textarea":Nd(e,r),a=jc(e,r),$e("invalid",e);break;default:a=r}wc(n,a),c=a;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?vf(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&mf(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&qa(e,u):typeof u=="number"&&qa(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ha.hasOwnProperty(i)?u!=null&&i==="onScroll"&&$e("scroll",e):u!=null&&xu(e,i,u,l))}switch(n){case"input":Mi(e),jd(e,r,!1);break;case"textarea":Mi(e),wd(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Ms(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Dr(e,!!r.multiple,i,!1):r.defaultValue!=null&&Dr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=kl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nt(t),null;case 6:if(e&&t.stateNode!=null)$p(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error($(166));if(n=ar(si.current),ar(Mn.current),Wi(t)){if(r=t.stateNode,n=t.memoizedProps,r[On]=t,(i=r.nodeValue!==n)&&(e=Vt,e!==null))switch(e.tag){case 3:Vi(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Vi(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[On]=t,t.stateNode=r}return Nt(t),null;case 13:if(Ue(Ve),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Fe&&Ft!==null&&t.mode&1&&!(t.flags&128))rp(),Hr(),t.flags|=98560,i=!1;else if(i=Wi(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error($(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[On]=t}else Hr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nt(t),i=!1}else yn!==null&&(su(yn),yn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ve.current&1?it===0&&(it=3):ed())),t.updateQueue!==null&&(t.flags|=4),Nt(t),null);case 4:return Gr(),Kc(e,t),e===null&&Za(t.stateNode.containerInfo),Nt(t),null;case 10:return Du(t.type._context),Nt(t),null;case 17:return It(t.type)&&bl(),Nt(t),null;case 19:if(Ue(Ve),i=t.memoizedState,i===null)return Nt(t),null;if(r=(t.flags&128)!==0,l=i.rendering,l===null)if(r)ba(i,!1);else{if(it!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Ol(e),l!==null){for(t.flags|=128,ba(i,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Be(Ve,Ve.current&1|2),t.child}e=e.sibling}i.tail!==null&&Qe()>Kr&&(t.flags|=128,r=!0,ba(i,!1),t.lanes=4194304)}else{if(!r)if(e=Ol(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ba(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!Fe)return Nt(t),null}else 2*Qe()-i.renderingStartTime>Kr&&n!==1073741824&&(t.flags|=128,r=!0,ba(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(n=i.last,n!==null?n.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Qe(),t.sibling=null,n=Ve.current,Be(Ve,r?n&1|2:n&1),t):(Nt(t),null);case 22:case 23:return Zu(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Ut&1073741824&&(Nt(t),t.subtreeFlags&6&&(t.flags|=8192)):Nt(t),null;case 24:return null;case 25:return null}throw Error($(156,t.tag))}function bv(e,t){switch(Ou(t),t.tag){case 1:return It(t.type)&&bl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Gr(),Ue(Mt),Ue(_t),Fu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Uu(t),null;case 13:if(Ue(Ve),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error($(340));Hr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ue(Ve),null;case 4:return Gr(),null;case 10:return Du(t.type._context),null;case 22:case 23:return Zu(),null;case 24:return null;default:return null}}var Gi=!1,wt=!1,Cv=typeof WeakSet=="function"?WeakSet:Set,J=null;function Mr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qe(e,t,r)}else n.current=null}function Yc(e,t,n){try{n()}catch(r){qe(e,t,r)}}var dh=!1;function Ev(e,t){if(Oc=wl,e=Hf(),Lu(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var l=0,c=-1,u=-1,p=0,_=0,v=e,N=null;t:for(;;){for(var A;v!==n||a!==0&&v.nodeType!==3||(c=l+a),v!==i||r!==0&&v.nodeType!==3||(u=l+r),v.nodeType===3&&(l+=v.nodeValue.length),(A=v.firstChild)!==null;)N=v,v=A;for(;;){if(v===e)break t;if(N===n&&++p===a&&(c=l),N===i&&++_===r&&(u=l),(A=v.nextSibling)!==null)break;v=N,N=v.parentNode}v=A}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Pc={focusedElem:e,selectionRange:n},wl=!1,J=t;J!==null;)if(t=J,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,J=e;else for(;J!==null;){t=J;try{var O=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var P=O.memoizedProps,C=O.memoizedState,m=t.stateNode,f=m.getSnapshotBeforeUpdate(t.elementType===t.type?P:gn(t.type,P),C);m.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(b){qe(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,J=e;break}J=t.return}return O=dh,dh=!1,O}function Ua(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Yc(t,n,i)}a=a.next}while(a!==r)}}function Jl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Xc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Up(e){var t=e.alternate;t!==null&&(e.alternate=null,Up(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[On],delete t[ti],delete t[Dc],delete t[uv],delete t[dv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Fp(e){return e.tag===5||e.tag===3||e.tag===4}function hh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Fp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Jc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=kl));else if(r!==4&&(e=e.child,e!==null))for(Jc(e,t,n),e=e.sibling;e!==null;)Jc(e,t,n),e=e.sibling}function Zc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Zc(e,t,n),e=e.sibling;e!==null;)Zc(e,t,n),e=e.sibling}var gt=null,vn=!1;function xs(e,t,n){for(n=n.child;n!==null;)Vp(e,t,n),n=n.sibling}function Vp(e,t,n){if(Pn&&typeof Pn.onCommitFiberUnmount=="function")try{Pn.onCommitFiberUnmount(Wl,n)}catch{}switch(n.tag){case 5:wt||Mr(n,t);case 6:var r=gt,a=vn;gt=null,xs(e,t,n),gt=r,vn=a,gt!==null&&(vn?(e=gt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):gt.removeChild(n.stateNode));break;case 18:gt!==null&&(vn?(e=gt,n=n.stateNode,e.nodeType===8?Yo(e.parentNode,n):e.nodeType===1&&Yo(e,n),Ya(e)):Yo(gt,n.stateNode));break;case 4:r=gt,a=vn,gt=n.stateNode.containerInfo,vn=!0,xs(e,t,n),gt=r,vn=a;break;case 0:case 11:case 14:case 15:if(!wt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Yc(n,t,l),a=a.next}while(a!==r)}xs(e,t,n);break;case 1:if(!wt&&(Mr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){qe(n,t,c)}xs(e,t,n);break;case 21:xs(e,t,n);break;case 22:n.mode&1?(wt=(r=wt)||n.memoizedState!==null,xs(e,t,n),wt=r):xs(e,t,n);break;default:xs(e,t,n)}}function fh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Cv),t.forEach(function(r){var a=Dv.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function mn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,l=t,c=l;e:for(;c!==null;){switch(c.tag){case 5:gt=c.stateNode,vn=!1;break e;case 3:gt=c.stateNode.containerInfo,vn=!0;break e;case 4:gt=c.stateNode.containerInfo,vn=!0;break e}c=c.return}if(gt===null)throw Error($(160));Vp(i,l,a),gt=null,vn=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(p){qe(a,t,p)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Wp(t,e),t=t.sibling}function Wp(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mn(t,e),Ln(e),r&4){try{Ua(3,e,e.return),Jl(3,e)}catch(P){qe(e,e.return,P)}try{Ua(5,e,e.return)}catch(P){qe(e,e.return,P)}}break;case 1:mn(t,e),Ln(e),r&512&&n!==null&&Mr(n,n.return);break;case 5:if(mn(t,e),Ln(e),r&512&&n!==null&&Mr(n,n.return),e.flags&32){var a=e.stateNode;try{qa(a,"")}catch(P){qe(e,e.return,P)}}if(r&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=n!==null?n.memoizedProps:i,c=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&hf(a,i),_c(c,l);var p=_c(c,i);for(l=0;l<u.length;l+=2){var _=u[l],v=u[l+1];_==="style"?vf(a,v):_==="dangerouslySetInnerHTML"?mf(a,v):_==="children"?qa(a,v):xu(a,_,v,p)}switch(c){case"input":xc(a,i);break;case"textarea":ff(a,i);break;case"select":var N=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var A=i.value;A!=null?Dr(a,!!i.multiple,A,!1):N!==!!i.multiple&&(i.defaultValue!=null?Dr(a,!!i.multiple,i.defaultValue,!0):Dr(a,!!i.multiple,i.multiple?[]:"",!1))}a[ti]=i}catch(P){qe(e,e.return,P)}}break;case 6:if(mn(t,e),Ln(e),r&4){if(e.stateNode===null)throw Error($(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(P){qe(e,e.return,P)}}break;case 3:if(mn(t,e),Ln(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ya(t.containerInfo)}catch(P){qe(e,e.return,P)}break;case 4:mn(t,e),Ln(e);break;case 13:mn(t,e),Ln(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Xu=Qe())),r&4&&fh(e);break;case 22:if(_=n!==null&&n.memoizedState!==null,e.mode&1?(wt=(p=wt)||_,mn(t,e),wt=p):mn(t,e),Ln(e),r&8192){if(p=e.memoizedState!==null,(e.stateNode.isHidden=p)&&!_&&e.mode&1)for(J=e,_=e.child;_!==null;){for(v=J=_;J!==null;){switch(N=J,A=N.child,N.tag){case 0:case 11:case 14:case 15:Ua(4,N,N.return);break;case 1:Mr(N,N.return);var O=N.stateNode;if(typeof O.componentWillUnmount=="function"){r=N,n=N.return;try{t=r,O.props=t.memoizedProps,O.state=t.memoizedState,O.componentWillUnmount()}catch(P){qe(r,n,P)}}break;case 5:Mr(N,N.return);break;case 22:if(N.memoizedState!==null){mh(v);continue}}A!==null?(A.return=N,J=A):mh(v)}_=_.sibling}e:for(_=null,v=e;;){if(v.tag===5){if(_===null){_=v;try{a=v.stateNode,p?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=v.stateNode,u=v.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=gf("display",l))}catch(P){qe(e,e.return,P)}}}else if(v.tag===6){if(_===null)try{v.stateNode.nodeValue=p?"":v.memoizedProps}catch(P){qe(e,e.return,P)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===e)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===e)break e;for(;v.sibling===null;){if(v.return===null||v.return===e)break e;_===v&&(_=null),v=v.return}_===v&&(_=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:mn(t,e),Ln(e),r&4&&fh(e);break;case 21:break;default:mn(t,e),Ln(e)}}function Ln(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Fp(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(qa(a,""),r.flags&=-33);var i=hh(e);Zc(e,i,a);break;case 3:case 4:var l=r.stateNode.containerInfo,c=hh(e);Jc(e,c,l);break;default:throw Error($(161))}}catch(u){qe(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Av(e,t,n){J=e,Hp(e)}function Hp(e,t,n){for(var r=(e.mode&1)!==0;J!==null;){var a=J,i=a.child;if(a.tag===22&&r){var l=a.memoizedState!==null||Gi;if(!l){var c=a.alternate,u=c!==null&&c.memoizedState!==null||wt;c=Gi;var p=wt;if(Gi=l,(wt=u)&&!p)for(J=a;J!==null;)l=J,u=l.child,l.tag===22&&l.memoizedState!==null?gh(a):u!==null?(u.return=l,J=u):gh(a);for(;i!==null;)J=i,Hp(i),i=i.sibling;J=a,Gi=c,wt=p}ph(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,J=i):ph(e)}}function ph(e){for(;J!==null;){var t=J;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:wt||Jl(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!wt)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:gn(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Jd(t,i,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Jd(t,l,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var p=t.alternate;if(p!==null){var _=p.memoizedState;if(_!==null){var v=_.dehydrated;v!==null&&Ya(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}wt||t.flags&512&&Xc(t)}catch(N){qe(t,t.return,N)}}if(t===e){J=null;break}if(n=t.sibling,n!==null){n.return=t.return,J=n;break}J=t.return}}function mh(e){for(;J!==null;){var t=J;if(t===e){J=null;break}var n=t.sibling;if(n!==null){n.return=t.return,J=n;break}J=t.return}}function gh(e){for(;J!==null;){var t=J;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Jl(4,t)}catch(u){qe(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(u){qe(t,a,u)}}var i=t.return;try{Xc(t)}catch(u){qe(t,i,u)}break;case 5:var l=t.return;try{Xc(t)}catch(u){qe(t,l,u)}}}catch(u){qe(t,t.return,u)}if(t===e){J=null;break}var c=t.sibling;if(c!==null){c.return=t.return,J=c;break}J=t.return}}var Tv=Math.ceil,Il=ts.ReactCurrentDispatcher,Ku=ts.ReactCurrentOwner,rn=ts.ReactCurrentBatchConfig,Se=0,ht=null,Je=null,vt=0,Ut=0,Ir=Bs(0),it=0,li=null,dr=0,Zl=0,Yu=0,Fa=null,Ot=null,Xu=0,Kr=1/0,Hn=null,Dl=!1,eu=null,Ls=null,Qi=!1,Ss=null,Bl=0,Va=0,tu=null,ul=-1,dl=0;function Et(){return Se&6?Qe():ul!==-1?ul:ul=Qe()}function Rs(e){return e.mode&1?Se&2&&vt!==0?vt&-vt:fv.transition!==null?(dl===0&&(dl=Af()),dl):(e=Re,e!==0||(e=window.event,e=e===void 0?16:If(e.type)),e):1}function Nn(e,t,n,r){if(50<Va)throw Va=0,tu=null,Error($(185));ci(e,n,r),(!(Se&2)||e!==ht)&&(e===ht&&(!(Se&2)&&(Zl|=n),it===4&&ws(e,vt)),Dt(e,r),n===1&&Se===0&&!(t.mode&1)&&(Kr=Qe()+500,Kl&&zs()))}function Dt(e,t){var n=e.callbackNode;fg(e,t);var r=Nl(e,e===ht?vt:0);if(r===0)n!==null&&kd(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&kd(n),t===1)e.tag===0?hv(vh.bind(null,e)):tp(vh.bind(null,e)),ov(function(){!(Se&6)&&zs()}),n=null;else{switch(Tf(r)){case 1:n=_u;break;case 4:n=Cf;break;case 16:n=jl;break;case 536870912:n=Ef;break;default:n=jl}n=Zp(n,qp.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function qp(e,t){if(ul=-1,dl=0,Se&6)throw Error($(327));var n=e.callbackNode;if(Fr()&&e.callbackNode!==n)return null;var r=Nl(e,e===ht?vt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=zl(e,r);else{t=r;var a=Se;Se|=2;var i=Qp();(ht!==e||vt!==t)&&(Hn=null,Kr=Qe()+500,ir(e,t));do try{Ov();break}catch(c){Gp(e,c)}while(!0);Iu(),Il.current=i,Se=a,Je!==null?t=0:(ht=null,vt=0,t=it)}if(t!==0){if(t===2&&(a=Ec(e),a!==0&&(r=a,t=nu(e,a))),t===1)throw n=li,ir(e,0),ws(e,r),Dt(e,Qe()),n;if(t===6)ws(e,r);else{if(a=e.current.alternate,!(r&30)&&!Lv(a)&&(t=zl(e,r),t===2&&(i=Ec(e),i!==0&&(r=i,t=nu(e,i))),t===1))throw n=li,ir(e,0),ws(e,r),Dt(e,Qe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error($(345));case 2:nr(e,Ot,Hn);break;case 3:if(ws(e,r),(r&130023424)===r&&(t=Xu+500-Qe(),10<t)){if(Nl(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){Et(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Ic(nr.bind(null,e,Ot,Hn),t);break}nr(e,Ot,Hn);break;case 4:if(ws(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var l=31-jn(r);i=1<<l,l=t[l],l>a&&(a=l),r&=~i}if(r=a,r=Qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tv(r/1960))-r,10<r){e.timeoutHandle=Ic(nr.bind(null,e,Ot,Hn),r);break}nr(e,Ot,Hn);break;case 5:nr(e,Ot,Hn);break;default:throw Error($(329))}}}return Dt(e,Qe()),e.callbackNode===n?qp.bind(null,e):null}function nu(e,t){var n=Fa;return e.current.memoizedState.isDehydrated&&(ir(e,t).flags|=256),e=zl(e,t),e!==2&&(t=Ot,Ot=n,t!==null&&su(t)),e}function su(e){Ot===null?Ot=e:Ot.push.apply(Ot,e)}function Lv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!wn(i(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ws(e,t){for(t&=~Yu,t&=~Zl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-jn(t),r=1<<n;e[n]=-1,t&=~r}}function vh(e){if(Se&6)throw Error($(327));Fr();var t=Nl(e,0);if(!(t&1))return Dt(e,Qe()),null;var n=zl(e,t);if(e.tag!==0&&n===2){var r=Ec(e);r!==0&&(t=r,n=nu(e,r))}if(n===1)throw n=li,ir(e,0),ws(e,t),Dt(e,Qe()),n;if(n===6)throw Error($(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,nr(e,Ot,Hn),Dt(e,Qe()),null}function Ju(e,t){var n=Se;Se|=1;try{return e(t)}finally{Se=n,Se===0&&(Kr=Qe()+500,Kl&&zs())}}function hr(e){Ss!==null&&Ss.tag===0&&!(Se&6)&&Fr();var t=Se;Se|=1;var n=rn.transition,r=Re;try{if(rn.transition=null,Re=1,e)return e()}finally{Re=r,rn.transition=n,Se=t,!(Se&6)&&zs()}}function Zu(){Ut=Ir.current,Ue(Ir)}function ir(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,lv(n)),Je!==null)for(n=Je.return;n!==null;){var r=n;switch(Ou(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&bl();break;case 3:Gr(),Ue(Mt),Ue(_t),Fu();break;case 5:Uu(r);break;case 4:Gr();break;case 13:Ue(Ve);break;case 19:Ue(Ve);break;case 10:Du(r.type._context);break;case 22:case 23:Zu()}n=n.return}if(ht=e,Je=e=Os(e.current,null),vt=Ut=t,it=0,li=null,Yu=Zl=dr=0,Ot=Fa=null,rr!==null){for(t=0;t<rr.length;t++)if(n=rr[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var l=i.next;i.next=a,r.next=l}n.pending=r}rr=null}return e}function Gp(e,t){do{var n=Je;try{if(Iu(),ll.current=Ml,Pl){for(var r=We.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Pl=!1}if(ur=0,dt=at=We=null,$a=!1,ri=0,Ku.current=null,n===null||n.return===null){it=1,li=t,Je=null;break}e:{var i=e,l=n.return,c=n,u=t;if(t=vt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var p=u,_=c,v=_.tag;if(!(_.mode&1)&&(v===0||v===11||v===15)){var N=_.alternate;N?(_.updateQueue=N.updateQueue,_.memoizedState=N.memoizedState,_.lanes=N.lanes):(_.updateQueue=null,_.memoizedState=null)}var A=rh(l);if(A!==null){A.flags&=-257,ah(A,l,c,i,t),A.mode&1&&sh(i,p,t),t=A,u=p;var O=t.updateQueue;if(O===null){var P=new Set;P.add(u),t.updateQueue=P}else O.add(u);break e}else{if(!(t&1)){sh(i,p,t),ed();break e}u=Error($(426))}}else if(Fe&&c.mode&1){var C=rh(l);if(C!==null){!(C.flags&65536)&&(C.flags|=256),ah(C,l,c,i,t),Pu(Qr(u,c));break e}}i=u=Qr(u,c),it!==4&&(it=2),Fa===null?Fa=[i]:Fa.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var m=Tp(i,u,t);Xd(i,m);break e;case 1:c=u;var f=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof f.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ls===null||!Ls.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var b=Lp(i,c,t);Xd(i,b);break e}}i=i.return}while(i!==null)}Yp(n)}catch(M){t=M,Je===n&&n!==null&&(Je=n=n.return);continue}break}while(!0)}function Qp(){var e=Il.current;return Il.current=Ml,e===null?Ml:e}function ed(){(it===0||it===3||it===2)&&(it=4),ht===null||!(dr&268435455)&&!(Zl&268435455)||ws(ht,vt)}function zl(e,t){var n=Se;Se|=2;var r=Qp();(ht!==e||vt!==t)&&(Hn=null,ir(e,t));do try{Rv();break}catch(a){Gp(e,a)}while(!0);if(Iu(),Se=n,Il.current=r,Je!==null)throw Error($(261));return ht=null,vt=0,it}function Rv(){for(;Je!==null;)Kp(Je)}function Ov(){for(;Je!==null&&!rg();)Kp(Je)}function Kp(e){var t=Jp(e.alternate,e,Ut);e.memoizedProps=e.pendingProps,t===null?Yp(e):Je=t,Ku.current=null}function Yp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=bv(n,t),n!==null){n.flags&=32767,Je=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{it=6,Je=null;return}}else if(n=kv(n,t,Ut),n!==null){Je=n;return}if(t=t.sibling,t!==null){Je=t;return}Je=t=e}while(t!==null);it===0&&(it=5)}function nr(e,t,n){var r=Re,a=rn.transition;try{rn.transition=null,Re=1,Pv(e,t,n,r)}finally{rn.transition=a,Re=r}return null}function Pv(e,t,n,r){do Fr();while(Ss!==null);if(Se&6)throw Error($(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error($(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(pg(e,i),e===ht&&(Je=ht=null,vt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Qi||(Qi=!0,Zp(jl,function(){return Fr(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=rn.transition,rn.transition=null;var l=Re;Re=1;var c=Se;Se|=4,Ku.current=null,Ev(e,n),Wp(n,e),ev(Pc),wl=!!Oc,Pc=Oc=null,e.current=n,Av(n),ag(),Se=c,Re=l,rn.transition=i}else e.current=n;if(Qi&&(Qi=!1,Ss=e,Bl=a),i=e.pendingLanes,i===0&&(Ls=null),og(n.stateNode),Dt(e,Qe()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Dl)throw Dl=!1,e=eu,eu=null,e;return Bl&1&&e.tag!==0&&Fr(),i=e.pendingLanes,i&1?e===tu?Va++:(Va=0,tu=e):Va=0,zs(),null}function Fr(){if(Ss!==null){var e=Tf(Bl),t=rn.transition,n=Re;try{if(rn.transition=null,Re=16>e?16:e,Ss===null)var r=!1;else{if(e=Ss,Ss=null,Bl=0,Se&6)throw Error($(331));var a=Se;for(Se|=4,J=e.current;J!==null;){var i=J,l=i.child;if(J.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var p=c[u];for(J=p;J!==null;){var _=J;switch(_.tag){case 0:case 11:case 15:Ua(8,_,i)}var v=_.child;if(v!==null)v.return=_,J=v;else for(;J!==null;){_=J;var N=_.sibling,A=_.return;if(Up(_),_===p){J=null;break}if(N!==null){N.return=A,J=N;break}J=A}}}var O=i.alternate;if(O!==null){var P=O.child;if(P!==null){O.child=null;do{var C=P.sibling;P.sibling=null,P=C}while(P!==null)}}J=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,J=l;else e:for(;J!==null;){if(i=J,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ua(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,J=m;break e}J=i.return}}var f=e.current;for(J=f;J!==null;){l=J;var y=l.child;if(l.subtreeFlags&2064&&y!==null)y.return=l,J=y;else e:for(l=f;J!==null;){if(c=J,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Jl(9,c)}}catch(M){qe(c,c.return,M)}if(c===l){J=null;break e}var b=c.sibling;if(b!==null){b.return=c.return,J=b;break e}J=c.return}}if(Se=a,zs(),Pn&&typeof Pn.onPostCommitFiberRoot=="function")try{Pn.onPostCommitFiberRoot(Wl,e)}catch{}r=!0}return r}finally{Re=n,rn.transition=t}}return!1}function xh(e,t,n){t=Qr(n,t),t=Tp(e,t,1),e=Ts(e,t,1),t=Et(),e!==null&&(ci(e,1,t),Dt(e,t))}function qe(e,t,n){if(e.tag===3)xh(e,e,n);else for(;t!==null;){if(t.tag===3){xh(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ls===null||!Ls.has(r))){e=Qr(n,e),e=Lp(t,e,1),t=Ts(t,e,1),e=Et(),t!==null&&(ci(t,1,e),Dt(t,e));break}}t=t.return}}function Mv(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Et(),e.pingedLanes|=e.suspendedLanes&n,ht===e&&(vt&n)===n&&(it===4||it===3&&(vt&130023424)===vt&&500>Qe()-Xu?ir(e,0):Yu|=n),Dt(e,t)}function Xp(e,t){t===0&&(e.mode&1?(t=Bi,Bi<<=1,!(Bi&130023424)&&(Bi=4194304)):t=1);var n=Et();e=Zn(e,t),e!==null&&(ci(e,t,n),Dt(e,n))}function Iv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Xp(e,n)}function Dv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(t),Xp(e,n)}var Jp;Jp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Mt.current)Pt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Pt=!1,Sv(e,t,n);Pt=!!(e.flags&131072)}else Pt=!1,Fe&&t.flags&1048576&&np(t,Al,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;cl(e,t),e=t.pendingProps;var a=Wr(t,_t.current);Ur(t,n),a=Wu(null,t,r,e,a,n);var i=Hu();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,It(r)?(i=!0,Cl(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,zu(t),a.updater=Xl,t.stateNode=a,a._reactInternals=t,Vc(t,r,e,n),t=qc(null,t,r,!0,i,n)):(t.tag=0,Fe&&i&&Ru(t),Ct(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(cl(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=zv(r),e=gn(r,e),a){case 0:t=Hc(null,t,r,e,n);break e;case 1:t=oh(null,t,r,e,n);break e;case 11:t=ih(null,t,r,e,n);break e;case 14:t=lh(null,t,r,gn(r.type,e),n);break e}throw Error($(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),Hc(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),oh(e,t,r,a,n);case 3:e:{if(Mp(t),e===null)throw Error($(387));r=t.pendingProps,i=t.memoizedState,a=i.element,op(e,t),Rl(t,r,null,n);var l=t.memoizedState;if(r=l.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Qr(Error($(423)),t),t=ch(e,t,r,n,a);break e}else if(r!==a){a=Qr(Error($(424)),t),t=ch(e,t,r,n,a);break e}else for(Ft=As(t.stateNode.containerInfo.firstChild),Vt=t,Fe=!0,yn=null,n=ip(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Hr(),r===a){t=es(e,t,n);break e}Ct(e,t,r,n)}t=t.child}return t;case 5:return cp(t),e===null&&$c(t),r=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,Mc(r,a)?l=null:i!==null&&Mc(r,i)&&(t.flags|=32),Pp(e,t),Ct(e,t,l,n),t.child;case 6:return e===null&&$c(t),null;case 13:return Ip(e,t,n);case 4:return $u(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=qr(t,null,r,n):Ct(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),ih(e,t,r,a,n);case 7:return Ct(e,t,t.pendingProps,n),t.child;case 8:return Ct(e,t,t.pendingProps.children,n),t.child;case 12:return Ct(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,Be(Tl,r._currentValue),r._currentValue=l,i!==null)if(wn(i.value,l)){if(i.children===a.children&&!Mt.current){t=es(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var c=i.dependencies;if(c!==null){l=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Yn(-1,n&-n),u.tag=2;var p=i.updateQueue;if(p!==null){p=p.shared;var _=p.pending;_===null?u.next=u:(u.next=_.next,_.next=u),p.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Uc(i.return,n,t),c.lanes|=n;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error($(341));l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),Uc(l,n,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}Ct(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ur(t,n),a=an(a),r=r(a),t.flags|=1,Ct(e,t,r,n),t.child;case 14:return r=t.type,a=gn(r,t.pendingProps),a=gn(r.type,a),lh(e,t,r,a,n);case 15:return Rp(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),cl(e,t),t.tag=1,It(r)?(e=!0,Cl(t)):e=!1,Ur(t,n),Ap(t,r,a),Vc(t,r,a,n),qc(null,t,r,!0,e,n);case 19:return Dp(e,t,n);case 22:return Op(e,t,n)}throw Error($(156,t.tag))};function Zp(e,t){return bf(e,t)}function Bv(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(e,t,n,r){return new Bv(e,t,n,r)}function td(e){return e=e.prototype,!(!e||!e.isReactComponent)}function zv(e){if(typeof e=="function")return td(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ju)return 11;if(e===Nu)return 14}return 2}function Os(e,t){var n=e.alternate;return n===null?(n=sn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function hl(e,t,n,r,a,i){var l=2;if(r=e,typeof e=="function")td(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case br:return lr(n.children,a,i,t);case yu:l=8,a|=8;break;case fc:return e=sn(12,n,t,a|2),e.elementType=fc,e.lanes=i,e;case pc:return e=sn(13,n,t,a),e.elementType=pc,e.lanes=i,e;case mc:return e=sn(19,n,t,a),e.elementType=mc,e.lanes=i,e;case cf:return eo(n,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case lf:l=10;break e;case of:l=9;break e;case ju:l=11;break e;case Nu:l=14;break e;case ys:l=16,r=null;break e}throw Error($(130,e==null?e:typeof e,""))}return t=sn(l,n,t,a),t.elementType=e,t.type=r,t.lanes=i,t}function lr(e,t,n,r){return e=sn(7,e,r,t),e.lanes=n,e}function eo(e,t,n,r){return e=sn(22,e,r,t),e.elementType=cf,e.lanes=n,e.stateNode={isHidden:!1},e}function rc(e,t,n){return e=sn(6,e,null,t),e.lanes=n,e}function ac(e,t,n){return t=sn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $v(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zo(0),this.expirationTimes=zo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zo(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function nd(e,t,n,r,a,i,l,c,u){return e=new $v(e,t,n,c,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=sn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zu(i),e}function Uv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:kr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function em(e){if(!e)return Is;e=e._reactInternals;e:{if(pr(e)!==e||e.tag!==1)throw Error($(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(It(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error($(171))}if(e.tag===1){var n=e.type;if(It(n))return ep(e,n,t)}return t}function tm(e,t,n,r,a,i,l,c,u){return e=nd(n,r,!0,e,a,i,l,c,u),e.context=em(null),n=e.current,r=Et(),a=Rs(n),i=Yn(r,a),i.callback=t??null,Ts(n,i,a),e.current.lanes=a,ci(e,a,r),Dt(e,r),e}function to(e,t,n,r){var a=t.current,i=Et(),l=Rs(a);return n=em(n),t.context===null?t.context=n:t.pendingContext=n,t=Yn(i,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ts(a,t,l),e!==null&&(Nn(e,a,l,i),il(e,a,l)),l}function $l(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function yh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function sd(e,t){yh(e,t),(e=e.alternate)&&yh(e,t)}function Fv(){return null}var nm=typeof reportError=="function"?reportError:function(e){console.error(e)};function rd(e){this._internalRoot=e}no.prototype.render=rd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error($(409));to(e,t,null,null)};no.prototype.unmount=rd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hr(function(){to(null,e,null,null)}),t[Jn]=null}};function no(e){this._internalRoot=e}no.prototype.unstable_scheduleHydration=function(e){if(e){var t=Of();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ns.length&&t!==0&&t<Ns[n].priority;n++);Ns.splice(n,0,e),n===0&&Mf(e)}};function ad(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function so(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function jh(){}function Vv(e,t,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var p=$l(l);i.call(p)}}var l=tm(t,r,e,0,null,!1,!1,"",jh);return e._reactRootContainer=l,e[Jn]=l.current,Za(e.nodeType===8?e.parentNode:e),hr(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var c=r;r=function(){var p=$l(u);c.call(p)}}var u=nd(e,0,!1,null,null,!1,!1,"",jh);return e._reactRootContainer=u,e[Jn]=u.current,Za(e.nodeType===8?e.parentNode:e),hr(function(){to(t,u,n,r)}),u}function ro(e,t,n,r,a){var i=n._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var c=a;a=function(){var u=$l(l);c.call(u)}}to(t,l,e,a)}else l=Vv(n,t,e,a,r);return $l(l)}Lf=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ra(t.pendingLanes);n!==0&&(Su(t,n|1),Dt(t,Qe()),!(Se&6)&&(Kr=Qe()+500,zs()))}break;case 13:hr(function(){var r=Zn(e,1);if(r!==null){var a=Et();Nn(r,e,1,a)}}),sd(e,1)}};ku=function(e){if(e.tag===13){var t=Zn(e,134217728);if(t!==null){var n=Et();Nn(t,e,134217728,n)}sd(e,134217728)}};Rf=function(e){if(e.tag===13){var t=Rs(e),n=Zn(e,t);if(n!==null){var r=Et();Nn(n,e,t,r)}sd(e,t)}};Of=function(){return Re};Pf=function(e,t){var n=Re;try{return Re=e,t()}finally{Re=n}};kc=function(e,t,n){switch(t){case"input":if(xc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Ql(r);if(!a)throw Error($(90));df(r),xc(r,a)}}}break;case"textarea":ff(e,n);break;case"select":t=n.value,t!=null&&Dr(e,!!n.multiple,t,!1)}};jf=Ju;Nf=hr;var Wv={usingClientEntryPoint:!1,Events:[di,Tr,Ql,xf,yf,Ju]},Ca={findFiberByHostInstance:sr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Hv={bundleType:Ca.bundleType,version:Ca.version,rendererPackageName:Ca.rendererPackageName,rendererConfig:Ca.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ts.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Sf(e),e===null?null:e.stateNode},findFiberByHostInstance:Ca.findFiberByHostInstance||Fv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ki=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ki.isDisabled&&Ki.supportsFiber)try{Wl=Ki.inject(Hv),Pn=Ki}catch{}}Ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wv;Ht.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ad(t))throw Error($(200));return Uv(e,t,null,n)};Ht.createRoot=function(e,t){if(!ad(e))throw Error($(299));var n=!1,r="",a=nm;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=nd(e,1,!1,null,null,n,!1,r,a),e[Jn]=t.current,Za(e.nodeType===8?e.parentNode:e),new rd(t)};Ht.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error($(188)):(e=Object.keys(e).join(","),Error($(268,e)));return e=Sf(t),e=e===null?null:e.stateNode,e};Ht.flushSync=function(e){return hr(e)};Ht.hydrate=function(e,t,n){if(!so(t))throw Error($(200));return ro(null,e,t,!0,n)};Ht.hydrateRoot=function(e,t,n){if(!ad(e))throw Error($(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",l=nm;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=tm(t,null,e,1,n??null,a,!1,i,l),e[Jn]=t.current,Za(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new no(t)};Ht.render=function(e,t,n){if(!so(t))throw Error($(200));return ro(null,e,t,!1,n)};Ht.unmountComponentAtNode=function(e){if(!so(e))throw Error($(40));return e._reactRootContainer?(hr(function(){ro(null,null,e,!1,function(){e._reactRootContainer=null,e[Jn]=null})}),!0):!1};Ht.unstable_batchedUpdates=Ju;Ht.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!so(n))throw Error($(200));if(e==null||e._reactInternals===void 0)throw Error($(38));return ro(e,t,n,!1,r)};Ht.version="18.3.1-next-f1338f8080-20240426";function sm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sm)}catch(e){console.error(e)}}sm(),nf.exports=Ht;var qv=nf.exports,rm,Nh=qv;rm=Nh.createRoot,Nh.hydrateRoot;const Gv="http://localhost:3000";let ru=localStorage.getItem("token");function _r(e){ru=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}async function fi(e,t={}){const n={"Content-Type":"application/json",...t.headers||{}};if(ru&&(n.Authorization=`Bearer ${ru}`),typeof window<"u"&&navigator&&navigator.onLine===!1)throw new Error("offline");let r;try{r=await fetch(`${Gv}${e}`,{...t,headers:n})}catch(a){throw typeof window<"u"&&navigator&&navigator.onLine===!1?new Error("offline"):a instanceof TypeError?new Error("network_error"):a}if(!r.ok){const i=(await r.json().catch(()=>({}))).error||"request_failed";throw new Error(i)}return r.json()}function Ne(e){return fi(e,{method:"GET"})}function Le(e,t){return fi(e,{method:"POST",body:JSON.stringify(t||{})})}function ut(e,t){return fi(e,{method:"PATCH",body:JSON.stringify(t||{})})}function Ul(e,t){return fi(e,{method:"PUT",body:JSON.stringify(t||{})})}function ks(e){return fi(e,{method:"DELETE"})}const Dn=Object.create(null);Dn.open="0";Dn.close="1";Dn.ping="2";Dn.pong="3";Dn.message="4";Dn.upgrade="5";Dn.noop="6";const fl=Object.create(null);Object.keys(Dn).forEach(e=>{fl[Dn[e]]=e});const au={type:"error",data:"parser error"},am=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",im=typeof ArrayBuffer=="function",lm=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,id=({type:e,data:t},n,r)=>am&&t instanceof Blob?n?r(t):wh(t,r):im&&(t instanceof ArrayBuffer||lm(t))?n?r(t):wh(new Blob([t]),r):r(Dn[e]+(t||"")),wh=(e,t)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];t("b"+(r||""))},n.readAsDataURL(e)};function _h(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let ic;function Qv(e,t){if(am&&e.data instanceof Blob)return e.data.arrayBuffer().then(_h).then(t);if(im&&(e.data instanceof ArrayBuffer||lm(e.data)))return t(_h(e.data));id(e,!1,n=>{ic||(ic=new TextEncoder),t(ic.encode(n))})}const Sh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pa=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<Sh.length;e++)Pa[Sh.charCodeAt(e)]=e;const Kv=e=>{let t=e.length*.75,n=e.length,r,a=0,i,l,c,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const p=new ArrayBuffer(t),_=new Uint8Array(p);for(r=0;r<n;r+=4)i=Pa[e.charCodeAt(r)],l=Pa[e.charCodeAt(r+1)],c=Pa[e.charCodeAt(r+2)],u=Pa[e.charCodeAt(r+3)],_[a++]=i<<2|l>>4,_[a++]=(l&15)<<4|c>>2,_[a++]=(c&3)<<6|u&63;return p},Yv=typeof ArrayBuffer=="function",ld=(e,t)=>{if(typeof e!="string")return{type:"message",data:om(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:Xv(e.substring(1),t)}:fl[n]?e.length>1?{type:fl[n],data:e.substring(1)}:{type:fl[n]}:au},Xv=(e,t)=>{if(Yv){const n=Kv(e);return om(n,t)}else return{base64:!0,data:e}},om=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},cm="",Jv=(e,t)=>{const n=e.length,r=new Array(n);let a=0;e.forEach((i,l)=>{id(i,!1,c=>{r[l]=c,++a===n&&t(r.join(cm))})})},Zv=(e,t)=>{const n=e.split(cm),r=[];for(let a=0;a<n.length;a++){const i=ld(n[a],t);if(r.push(i),i.type==="error")break}return r};function ex(){return new TransformStream({transform(e,t){Qv(e,n=>{const r=n.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const i=new DataView(a.buffer);i.setUint8(0,126),i.setUint16(1,r)}else{a=new Uint8Array(9);const i=new DataView(a.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(a[0]|=128),t.enqueue(a),t.enqueue(n)})}})}let lc;function Yi(e){return e.reduce((t,n)=>t+n.length,0)}function Xi(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let a=0;a<t;a++)n[a]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function tx(e,t){lc||(lc=new TextDecoder);const n=[];let r=0,a=-1,i=!1;return new TransformStream({transform(l,c){for(n.push(l);;){if(r===0){if(Yi(n)<1)break;const u=Xi(n,1);i=(u[0]&128)===128,a=u[0]&127,a<126?r=3:a===126?r=1:r=2}else if(r===1){if(Yi(n)<2)break;const u=Xi(n,2);a=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),r=3}else if(r===2){if(Yi(n)<8)break;const u=Xi(n,8),p=new DataView(u.buffer,u.byteOffset,u.length),_=p.getUint32(0);if(_>Math.pow(2,21)-1){c.enqueue(au);break}a=_*Math.pow(2,32)+p.getUint32(4),r=3}else{if(Yi(n)<a)break;const u=Xi(n,a);c.enqueue(ld(i?u:lc.decode(u),t)),r=0}if(a===0||a>e){c.enqueue(au);break}}}})}const um=4;function Ze(e){if(e)return nx(e)}function nx(e){for(var t in Ze.prototype)e[t]=Ze.prototype[t];return e}Ze.prototype.on=Ze.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Ze.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};Ze.prototype.off=Ze.prototype.removeListener=Ze.prototype.removeAllListeners=Ze.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,a=0;a<n.length;a++)if(r=n[a],r===t||r.fn===t){n.splice(a,1);break}return n.length===0&&delete this._callbacks["$"+e],this};Ze.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,a=n.length;r<a;++r)n[r].apply(this,t)}return this};Ze.prototype.emitReserved=Ze.prototype.emit;Ze.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Ze.prototype.hasListeners=function(e){return!!this.listeners(e).length};const ao=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),nn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),sx="arraybuffer";function dm(e,...t){return t.reduce((n,r)=>(e.hasOwnProperty(r)&&(n[r]=e[r]),n),{})}const rx=nn.setTimeout,ax=nn.clearTimeout;function io(e,t){t.useNativeTimers?(e.setTimeoutFn=rx.bind(nn),e.clearTimeoutFn=ax.bind(nn)):(e.setTimeoutFn=nn.setTimeout.bind(nn),e.clearTimeoutFn=nn.clearTimeout.bind(nn))}const ix=1.33;function lx(e){return typeof e=="string"?ox(e):Math.ceil((e.byteLength||e.size)*ix)}function ox(e){let t=0,n=0;for(let r=0,a=e.length;r<a;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function hm(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function cx(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function ux(e){let t={},n=e.split("&");for(let r=0,a=n.length;r<a;r++){let i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class dx extends Error{constructor(t,n,r){super(t),this.description=n,this.context=r,this.type="TransportError"}}class od extends Ze{constructor(t){super(),this.writable=!1,io(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,r){return super.emitReserved("error",new dx(t,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=ld(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=cx(t);return n.length?"?"+n:""}}class hx extends od{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};Zv(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Jv(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=hm()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let fm=!1;try{fm=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const fx=fm;function px(){}class mx extends hx{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,n){const r=this.request({method:"POST",data:t});r.on("success",n),r.on("error",(a,i)=>{this.onError("xhr post error",a,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=t}}class In extends Ze{constructor(t,n,r){super(),this.createRequest=t,io(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const n=dm(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&r.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var a;r.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=In.requestsCount++,In.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=px,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete In.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}In.requestsCount=0;In.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",kh);else if(typeof addEventListener=="function"){const e="onpagehide"in nn?"pagehide":"unload";addEventListener(e,kh,!1)}}function kh(){for(let e in In.requests)In.requests.hasOwnProperty(e)&&In.requests[e].abort()}const gx=function(){const e=pm({xdomain:!1});return e&&e.responseType!==null}();class vx extends mx{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=gx&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new In(pm,this.uri(),t)}}function pm(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||fx))return new XMLHttpRequest}catch{}if(!t)try{return new nn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const mm=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class xx extends od{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,r=mm?{}:dm(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,r)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;id(r,this.supportsBinary,i=>{try{this.doWrite(r,i)}catch{}a&&ao(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=hm()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const oc=nn.WebSocket||nn.MozWebSocket;class yx extends xx{createSocket(t,n,r){return mm?new oc(t,n,r):n?new oc(t,n):new oc(t)}doWrite(t,n){this.ws.send(n)}}class jx extends od{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=tx(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),a=ex();a.readable.pipeTo(t.writable),this._writer=a.writable.getWriter();const i=()=>{r.read().then(({done:c,value:u})=>{c||(this.onPacket(u),i())}).catch(c=>{})};i();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;this._writer.write(r).then(()=>{a&&ao(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const Nx={websocket:yx,webtransport:jx,polling:vx},wx=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,_x=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function iu(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");n!=-1&&r!=-1&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let a=wx.exec(e||""),i={},l=14;for(;l--;)i[_x[l]]=a[l]||"";return n!=-1&&r!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=Sx(i,i.path),i.queryKey=kx(i,i.query),i}function Sx(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function kx(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,a,i){a&&(n[a]=i)}),n}const lu=typeof addEventListener=="function"&&typeof removeEventListener=="function",pl=[];lu&&addEventListener("offline",()=>{pl.forEach(e=>e())},!1);class Ps extends Ze{constructor(t,n){if(super(),this.binaryType=sx,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const r=iu(t);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=iu(n.host).host);io(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const a=r.prototype.name;this.transports.push(a),this._transportsByName[a]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ux(this.opts.query)),lu&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},pl.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=um,n.transport=t,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Ps.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Ps.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const a=this.writeBuffer[r].data;if(a&&(n+=lx(a)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,ao(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,r){return this._sendPacket("message",t,n,r),this}send(t,n,r){return this._sendPacket("message",t,n,r),this}_sendPacket(t,n,r,a){if(typeof n=="function"&&(a=n,n=void 0),typeof r=="function"&&(a=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:t,data:n,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(Ps.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),lu&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=pl.indexOf(this._offlineEventListener);r!==-1&&pl.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}Ps.protocol=um;class bx extends Ps{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),r=!1;Ps.priorWebsocketSuccess=!1;const a=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",v=>{if(!r)if(v.type==="pong"&&v.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Ps.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(_(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const N=new Error("probe error");N.transport=n.name,this.emitReserved("upgradeError",N)}}))};function i(){r||(r=!0,_(),n.close(),n=null)}const l=v=>{const N=new Error("probe error: "+v);N.transport=n.name,i(),this.emitReserved("upgradeError",N)};function c(){l("transport closed")}function u(){l("socket closed")}function p(v){n&&v.name!==n.name&&i()}const _=()=>{n.removeListener("open",a),n.removeListener("error",l),n.removeListener("close",c),this.off("close",u),this.off("upgrading",p)};n.once("open",a),n.once("error",l),n.once("close",c),this.once("close",u),this.once("upgrading",p),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}let Cx=class extends bx{constructor(t,n={}){const r=typeof t=="object"?t:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(a=>Nx[a]).filter(a=>!!a)),super(t,r)}};function Ex(e,t="",n){let r=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),r=iu(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}const Ax=typeof ArrayBuffer=="function",Tx=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,gm=Object.prototype.toString,Lx=typeof Blob=="function"||typeof Blob<"u"&&gm.call(Blob)==="[object BlobConstructor]",Rx=typeof File=="function"||typeof File<"u"&&gm.call(File)==="[object FileConstructor]";function cd(e){return Ax&&(e instanceof ArrayBuffer||Tx(e))||Lx&&e instanceof Blob||Rx&&e instanceof File}function ml(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(ml(e[n]))return!0;return!1}if(cd(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return ml(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&ml(e[n]))return!0;return!1}function Ox(e){const t=[],n=e.data,r=e;return r.data=ou(n,t),r.attachments=t.length,{packet:r,buffers:t}}function ou(e,t){if(!e)return e;if(cd(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=ou(e[r],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=ou(e[r],t));return n}return e}function Px(e,t){return e.data=cu(e.data,t),delete e.attachments,e}function cu(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=cu(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=cu(e[n],t));return e}const vm=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Mx=5;var ge;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(ge||(ge={}));class Ix{constructor(t){this.replacer=t}encode(t){return(t.type===ge.EVENT||t.type===ge.ACK)&&ml(t)?this.encodeAsBinary({type:t.type===ge.EVENT?ge.BINARY_EVENT:ge.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===ge.BINARY_EVENT||t.type===ge.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=Ox(t),r=this.encodeAsString(n.packet),a=n.buffers;return a.unshift(r),a}}class ud extends Ze{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const r=n.type===ge.BINARY_EVENT;r||n.type===ge.BINARY_ACK?(n.type=r?ge.EVENT:ge.ACK,this.reconstructor=new Dx(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(cd(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const r={type:Number(t.charAt(0))};if(ge[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===ge.BINARY_EVENT||r.type===ge.BINARY_ACK){const i=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const l=t.substring(i,n);if(l!=Number(l)||t.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(l)}if(t.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););r.nsp=t.substring(i,n)}else r.nsp="/";const a=t.charAt(n+1);if(a!==""&&Number(a)==a){const i=n+1;for(;++n;){const l=t.charAt(n);if(l==null||Number(l)!=l){--n;break}if(n===t.length)break}r.id=Number(t.substring(i,n+1))}if(t.charAt(++n)){const i=this.tryParse(t.substr(n));if(ud.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case ge.CONNECT:return Fl(n);case ge.DISCONNECT:return n===void 0;case ge.CONNECT_ERROR:return typeof n=="string"||Fl(n);case ge.EVENT:case ge.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&vm.indexOf(n[0])===-1);case ge.ACK:case ge.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Dx{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=Px(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Bx(e){return typeof e=="string"}const zx=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};function $x(e){return e===void 0||zx(e)}function Fl(e){return Object.prototype.toString.call(e)==="[object Object]"}function Ux(e,t){switch(e){case ge.CONNECT:return t===void 0||Fl(t);case ge.DISCONNECT:return t===void 0;case ge.EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&vm.indexOf(t[0])===-1);case ge.ACK:return Array.isArray(t);case ge.CONNECT_ERROR:return typeof t=="string"||Fl(t);default:return!1}}function Fx(e){return Bx(e.nsp)&&$x(e.id)&&Ux(e.type,e.data)}const Vx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ud,Encoder:Ix,get PacketType(){return ge},isPacketValid:Fx,protocol:Mx},Symbol.toStringTag,{value:"Module"}));function xn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Wx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class xm extends Ze{constructor(t,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[xn(t,"open",this.onopen.bind(this)),xn(t,"packet",this.onpacket.bind(this)),xn(t,"error",this.onerror.bind(this)),xn(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var r,a,i;if(Wx.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const l={type:ge.EVENT,data:n};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const _=this.ids++,v=n.pop();this._registerAckCallback(_,v),l.id=_}const c=(a=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||a===void 0?void 0:a.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!c||(u?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(t,n){var r;const a=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(a===void 0){this.acks[t]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===t&&this.sendBuffer.splice(c,1);n.call(this,new Error("operation has timed out"))},a),l=(...c)=>{this.io.clearTimeoutFn(i),n.apply(this,c)};l.withError=!0,this.acks[t]=l}emitWithAck(t,...n){return new Promise((r,a)=>{const i=(l,c)=>l?a(l):r(c);i.withError=!0,n.push(i),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((a,...i)=>(this._queue[0],a!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(a)):(this._queue.shift(),n&&n(null,...i)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:ge.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case ge.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ge.EVENT:case ge.BINARY_EVENT:this.onevent(t);break;case ge.ACK:case ge.BINARY_ACK:this.onack(t);break;case ge.DISCONNECT:this.ondisconnect();break;case ge.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let r=!1;return function(...a){r||(r=!0,n.packet({type:ge.ACK,id:t,data:a}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ge.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,t.data)}}}function Zr(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Zr.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};Zr.prototype.reset=function(){this.attempts=0};Zr.prototype.setMin=function(e){this.ms=e};Zr.prototype.setMax=function(e){this.max=e};Zr.prototype.setJitter=function(e){this.jitter=e};class uu extends Ze{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,io(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Zr({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const a=n.parser||Vx;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Cx(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const a=xn(n,"open",function(){r.onopen(),t&&t()}),i=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),t?t(c):this.maybeReconnectOnOpen()},l=xn(n,"error",i);if(this._timeout!==!1){const c=this._timeout,u=this.setTimeoutFn(()=>{a(),i(new Error("timeout")),n.close()},c);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(a),this.subs.push(l),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(xn(t,"ping",this.onping.bind(this)),xn(t,"data",this.ondata.bind(this)),xn(t,"error",this.onerror.bind(this)),xn(t,"close",this.onclose.bind(this)),xn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){ao(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new xm(this,t,n),this.nsps[t]=r),r}_destroy(t){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let r=0;r<n.length;r++)this.engine.write(n[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(a=>{a?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",a)):t.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Ea={};function gl(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=Ex(e,t.path||"/socket.io"),r=n.source,a=n.id,i=n.path,l=Ea[a]&&i in Ea[a].nsps,c=t.forceNew||t["force new connection"]||t.multiplex===!1||l;let u;return c?u=new uu(r,t):(Ea[a]||(Ea[a]=new uu(r,t)),u=Ea[a]),n.query&&!t.query&&(t.query=n.queryKey),u.socket(n.path,t)}Object.assign(gl,{Manager:uu,Socket:xm,io:gl,connect:gl});const Hx="http://localhost:3000";function qx(e){return gl(Hx,{auth:{token:e}})}const ym=h.createContext(null);function Gx({children:e}){const[t,n]=h.useState([]),r=h.useRef(new Map),a=c=>{n(p=>p.filter(_=>_.id!==c));const u=r.current.get(c);u&&(clearTimeout(u),r.current.delete(c))},i=({message:c,type:u="success",actionLabel:p,onAction:_,duration:v=6e3})=>{const N=`${Date.now()}-${Math.random().toString(36).slice(2,8)}`;if(n(A=>[...A,{id:N,message:c,type:u,actionLabel:p,onAction:_,duration:v}]),v>0){const A=setTimeout(()=>a(N),v);r.current.set(N,A)}return N},l=c=>c==="error"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 4.5c.5 0 .95.26 1.2.68l6.5 11.25a1.35 1.35 0 0 1-1.2 2.02H5.5a1.35 1.35 0 0 1-1.2-2.02L10.8 5.18c.25-.42.7-.68 1.2-.68Zm0 4.25a.9.9 0 0 0-.9.9v5.5a.9.9 0 1 0 1.8 0v-5.5a.9.9 0 0 0-.9-.9Zm0 8.3a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Z",fill:"currentColor"})}):c==="info"?s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M12 3.5a8.5 8.5 0 1 1 0 17 8.5 8.5 0 0 1 0-17Zm0 3.9a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Zm-1.2 4.2h2.4v6.1h-2.4v-6.1Z",fill:"currentColor"})}):s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M9.5 16.6 5.6 12.7a1 1 0 1 1 1.4-1.4l2.5 2.5 7.5-7.5a1 1 0 1 1 1.4 1.4l-8.9 8.9a1 1 0 0 1-1.4 0Z",fill:"currentColor"})});return s.jsxs(ym.Provider,{value:{pushToast:i,removeToast:a},children:[e,s.jsx("div",{className:"toast-container",children:t.map(c=>s.jsxs("div",{className:`toast toast-${c.type}`,style:{"--toast-duration":`${c.duration}ms`},children:[s.jsx("div",{className:"toast-icon",children:l(c.type)}),s.jsx("div",{className:"toast-message",children:c.message}),c.actionLabel&&s.jsx("button",{className:"toast-action",type:"button",onClick:()=>{c.onAction&&Promise.resolve(c.onAction()).catch(()=>{}),a(c.id)},children:c.actionLabel}),s.jsx("button",{className:"toast-close",type:"button",onClick:()=>a(c.id),children:"x"}),c.duration>0&&s.jsx("div",{className:`toast-progress toast-progress-${c.type}`})]},c.id))})]})}function dd(){const e=h.useContext(ym);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function Qx({user:e,isOpen:t,onToggle:n,onLogout:r,onReturnToSuperadmin:a,showReturnToSuperadmin:i,getInitial:l}){return s.jsxs("div",{className:"rail-profile",children:[s.jsx("button",{className:`profile-button ${t?"active":""}`,type:"button",onClick:n,title:"Perfil","aria-label":"Perfil",children:s.jsx("span",{children:l(e.name)})}),t&&s.jsxs("div",{className:"profile-card",children:[s.jsx("div",{className:"profile-title",children:e.name}),s.jsx("div",{className:"profile-meta",children:e.email||"Sin correo"}),s.jsx("div",{className:"profile-role",children:e.role}),i?s.jsx("button",{className:"ghost",type:"button",onClick:a,children:"Volver a superadmin"}):null,s.jsx("button",{className:"primary",type:"button",onClick:r,children:"Salir"})]})]})}function Kx({navItems:e,view:t,onSetView:n,theme:r,onToggleTheme:a,user:i,logoUrl:l,brandName:c,isProfileOpen:u,onToggleProfile:p,onLogout:_,onReturnToSuperadmin:v,showReturnToSuperadmin:N,getInitial:A,SunIcon:O,MoonIcon:P}){const C=(c||"P").trim().charAt(0)||"P";return s.jsxs("aside",{className:"nav-rail",children:[s.jsx("button",{className:"rail-logo",type:"button",title:c||"Logo",children:l?s.jsx("img",{src:l,alt:c||"Logo"}):s.jsx("span",{className:"logo-mark",children:C})}),s.jsx("nav",{className:"rail-nav",children:e.map(m=>{const f=m.icon;return s.jsx("button",{className:`rail-button ${t===m.id?"active":""}`,onClick:()=>m.enabled&&n(m.id),title:m.label,"aria-label":m.label,type:"button",disabled:!m.enabled,children:s.jsx(f,{className:"rail-icon"})},m.id)})}),s.jsx("div",{className:"rail-spacer"}),s.jsx("button",{className:"rail-button",type:"button",onClick:a,title:r==="dark"?"Tema claro":"Tema oscuro","aria-label":r==="dark"?"Tema claro":"Tema oscuro",children:r==="dark"?s.jsx(O,{className:"rail-icon"}):s.jsx(P,{className:"rail-icon"})}),s.jsx(Qx,{user:i,isOpen:u,onToggle:p,onLogout:_,onReturnToSuperadmin:v,showReturnToSuperadmin:N,getInitial:A})]})}function Yx({activeConversation:e,conversations:t,channels:n,brandName:r,lastReadMap:a,filters:i,showFilters:l,users:c,tags:u,statusOptions:p,statusLabels:_,formatListTime:v,messageBlocks:N,messageDraft:A,messageMode:O,quickActions:P,tagInput:C,setTagInput:m,noteInput:f,notesList:y,latestNote:b,loadingConversation:M,isInfoOpen:z,hasUnread:j,scrollDayLabel:g,activeName:B,activePhone:T,activeStatusLabel:K,canManageStatus:oe,currentUser:pe,messageInputRef:ke,chatBodyRef:Ee,setShowFilters:Ae,setFilters:Pe,loadConversation:V,handleBackToList:te,setIsInfoOpen:ee,handleChatScroll:he,handleAssignSelf:ce,handleStatusChange:be,handleToggleTag:L,handleAddTag:H,setNoteInput:k,handleAddNote:U,reassignUserId:G,setReassignUserId:ne,handleReassignConversation:le,handleOpenTagManager:fe,handleCloseTagManager:X,showTagManager:Me,tagManagerForm:Ge,setTagManagerForm:ve,handleCreateTag:Bt,handleDeleteTag:Gt,handleQuickAction:_n,handleSendMessage:on,setMessageMode:Ke,setMessageDraft:zt,scrollChatToBottom:cn,getInitial:Qt,PlusIcon:lt,SearchIcon:un,VideoIcon:et,PhoneIcon:xe,InfoIcon:St,SendIcon:W}){const Ie=new Map((n||[]).map(R=>[R.phone_number_id,R.display_name||(R.phone_number_id?`Linea ${String(R.phone_number_id).slice(-4)}`:"")])),ye=new Map((c||[]).map(R=>[R.id,R])),Ye=(e==null?void 0:e.assigned_user_id)&&e.assigned_user_id!==(pe==null?void 0:pe.id);function Sn(R){if(!R)return"Sin mensajes";const Te=R.last_message_preview||R.last_message_text||R.last_message||"";return Te||(R.last_message_type?`[${R.last_message_type}]`:"Sin mensajes")}return s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:`chat-shell ${e?"has-active":""}`,children:[s.jsxs("aside",{className:"chat-list-panel",children:[s.jsxs("div",{className:"chat-list-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"list-title",children:(r||"Perzivalh").toUpperCase()}),s.jsx("div",{className:"list-subtitle",children:"Chats"})]}),s.jsx("button",{className:"icon-button add-chat",type:"button",title:"Nuevo chat",children:s.jsx(lt,{className:"icon"})})]}),s.jsxs("div",{className:"chat-search ui-search",children:[s.jsx(un,{className:"search-icon ui-search-icon"}),s.jsx("input",{type:"text",placeholder:"Buscar pacientes o mensajes",value:i.search,onFocus:()=>Ae(!0),onClick:()=>Ae(!0),onChange:R=>Pe(Te=>({...Te,search:R.target.value}))}),l&&s.jsx("button",{className:"search-close",type:"button",onClick:()=>Ae(!1),"aria-label":"Cerrar filtros",children:"x"})]}),l&&s.jsxs("div",{className:"chat-filters",children:[s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Status"}),s.jsxs("select",{value:i.status,onChange:R=>Pe(Te=>({...Te,status:R.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),p.map(R=>s.jsx("option",{value:R,children:_[R]||R},R))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Asignado"}),s.jsxs("select",{value:i.assigned_user_id,onChange:R=>Pe(Te=>({...Te,assigned_user_id:R.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"unassigned",children:"Sin asignar"}),c.map(R=>s.jsx("option",{value:R.id,children:R.name},R.id))]})]}),s.jsxs("label",{className:"filter-field",children:[s.jsx("span",{children:"Tags"}),s.jsxs("select",{value:i.tag,onChange:R=>Pe(Te=>({...Te,tag:R.target.value})),children:[s.jsx("option",{value:"",children:"Todos"}),u.map(R=>s.jsx("option",{value:R.name,children:R.name},R.id))]})]})]}),s.jsxs("div",{className:"list-header",children:[s.jsxs("select",{className:"line-filter",value:i.phone_number_id,onChange:R=>Pe(Te=>({...Te,phone_number_id:R.target.value})),children:[s.jsx("option",{value:"",children:"Todas las lineas"}),(n||[]).map(R=>s.jsx("option",{value:R.phone_number_id,children:R.display_name||`Linea ${String(R.phone_number_id).slice(-4)}`},R.id))]}),s.jsx("span",{children:t.length})]}),s.jsx("div",{className:"conversation-list",children:t.map((R,Te)=>{var ft,tt,nt,ss;const $s=(e==null?void 0:e.id)===R.id,kn=R.status==="pending"&&!R.assigned_user_id,Bn=R.display_name||R.phone_e164||R.wa_id||"Sin nombre",ns=Sn(R),bn=Number(R.unread_count||R.unread_messages||R.unread||0),$t=((tt=(ft=R.tags)==null?void 0:ft[0])==null?void 0:tt.name)||"",S=((nt=R.assigned_user)==null?void 0:nt.name)||((ss=ye.get(R.assigned_user_id||""))==null?void 0:ss.name)||"",F=S?`Tomada por ${S}`:"",q=R.phone_number_id?Ie.get(R.phone_number_id)||`Linea ${String(R.phone_number_id).slice(-4)}`:"",se=(a==null?void 0:a[R.id])||null,_e=R.last_message_at,dn=_e&&(!se||new Date(_e).getTime()>new Date(se).getTime())&&R.last_message_direction==="in";return s.jsxs("button",{className:`conversation-item ${$s?"active":""}`,onClick:()=>V(R.id),style:{animationDelay:`${Math.min(Te,6)*60}ms`},children:[s.jsxs("div",{className:"avatar",children:[s.jsx("span",{children:Qt(Bn)}),kn&&s.jsx("span",{className:"presence-dot"})]}),s.jsxs("div",{className:"conversation-body",children:[s.jsxs("div",{className:"conversation-row",children:[s.jsx("span",{className:"conversation-name",children:Bn}),s.jsxs("div",{className:"conversation-right",children:[s.jsx("span",{className:"conversation-time",children:v(R.last_message_at)}),bn>0&&s.jsx("span",{className:"conversation-unread",children:bn})]})]}),s.jsx("div",{className:`conversation-preview ${dn?"unread":""}`,children:ns}),s.jsxs("div",{className:"conversation-meta",children:[q&&s.jsx("span",{className:"status-pill line-pill",children:q}),F&&s.jsx("span",{className:"status-pill assignee-pill",children:F}),$t&&s.jsx("span",{className:"status-pill tag-pill",children:$t})]})]})]},R.id)})})]}),s.jsxs("div",{className:`chat-view ${z?"info-open":"info-closed"}`,children:[s.jsx("div",{className:"chat-main",children:s.jsxs("div",{className:"chat-card",children:[s.jsxs("header",{className:"chat-topbar",children:[s.jsxs("div",{className:"chat-title",children:[e&&s.jsx("button",{className:"back-button",type:"button",onClick:te,children:"Chats"}),s.jsx("div",{className:"chat-avatar",children:s.jsx("span",{children:Qt(B)})}),s.jsxs("div",{children:[s.jsx("div",{className:"chat-name",children:B}),e?s.jsx("div",{className:"chat-status",children:K}):s.jsx("div",{className:"chat-status muted",children:"Elige una conversacion"})]})]}),s.jsxs("div",{className:"chat-actions",children:[s.jsx("button",{className:"icon-button",type:"button",title:"Video",children:s.jsx(et,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Llamar",children:s.jsx(xe,{className:"icon"})}),s.jsx("button",{className:"icon-button",type:"button",title:"Buscar",children:s.jsx(un,{className:"icon"})}),s.jsx("button",{className:`icon-button ${z?"active":""}`,type:"button",title:"Info",onClick:()=>ee(R=>!R),children:s.jsx(St,{className:"icon"})})]})]}),s.jsxs("div",{className:"chat-body",ref:Ee,onScroll:he,children:[g&&s.jsx("div",{className:"chat-day-sticky","aria-hidden":"true",children:g}),M&&s.jsx("div",{className:"empty",children:"Cargando..."}),!M&&!e&&s.jsx("div",{className:"empty",children:"Selecciona una conversacion"}),!M&&e&&s.jsx(s.Fragment,{children:N.length?N:s.jsx("div",{className:"empty-state",children:"Sin mensajes"})})]}),j&&s.jsx("button",{className:"new-message-banner",type:"button",onClick:cn,children:"Nuevos mensajes"}),s.jsxs("form",{className:"chat-composer",onSubmit:on,children:[Ye&&s.jsx("div",{className:"assign-warning",children:"Conversacion tomada por otro operador."}),P.length>0&&s.jsx("div",{className:"quick-actions",children:P.map(R=>s.jsx("button",{className:"quick-action",type:"button",onClick:()=>_n(R),disabled:Ye,children:R},R))}),s.jsxs("div",{className:"composer-row",children:[s.jsxs("select",{className:"message-mode",value:O,onChange:R=>Ke(R.target.value),disabled:Ye,children:[s.jsx("option",{value:"text",children:"WhatsApp"}),s.jsx("option",{value:"note",children:"Nota interna"})]}),s.jsx("input",{ref:ke,type:"text",placeholder:"Escribe un mensaje...",value:A,onChange:R=>zt(R.target.value),disabled:Ye}),s.jsx("button",{className:"send-button",type:"submit",disabled:Ye,children:s.jsx(W,{className:"icon"})})]})]})]})}),s.jsxs("aside",{className:"chat-info",children:[s.jsxs("div",{className:"info-card",children:[s.jsx("div",{className:"info-avatar",children:s.jsx("span",{children:Qt(B)})}),s.jsx("div",{className:"info-name",children:B}),s.jsx("div",{className:"info-phone",children:T||"Sin telefono"})]}),s.jsxs("div",{className:"info-section",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("div",{className:"section-title",children:"Etiquetas"}),s.jsx("button",{className:"link-button",type:"button",onClick:fe,children:"Gestionar"})]}),s.jsx("div",{className:"tag-list",children:((e==null?void 0:e.tags)||[]).length?e.tags.map(R=>s.jsxs("span",{className:"tag-chip",children:[s.jsx("span",{className:"tag-chip-label",children:R.name}),s.jsx("button",{className:"tag-remove",type:"button",title:"Quitar etiqueta",onClick:()=>L(R.name),children:"x"})]},R.name)):s.jsx("div",{className:"empty-state",children:"Sin etiquetas"})}),s.jsxs("form",{className:"tag-form",onSubmit:H,children:[s.jsxs("select",{value:C,onChange:R=>m(R.target.value),children:[s.jsx("option",{value:"",children:"Selecciona etiqueta..."}),u.filter(R=>!((e==null?void 0:e.tags)||[]).some(Te=>Te.name===R.name)).map(R=>s.jsx("option",{value:R.name,children:R.name},R.id))]}),s.jsx("button",{className:"icon-button",type:"submit",title:"Agregar",children:s.jsx(lt,{className:"icon"})})]})]}),s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Notas internas"}),y!=null&&y.length?s.jsx("div",{className:"notes-stack",children:y.slice(-5).map(R=>s.jsx("div",{className:"note-card",children:R.text},R.id))}):s.jsx("div",{className:"empty-state",children:"Sin notas internas"}),s.jsxs("form",{className:"note-form",onSubmit:U,children:[s.jsx("input",{type:"text",placeholder:"Agregar nota interna...",value:f,onChange:R=>k(R.target.value),disabled:!e}),s.jsx("button",{className:"icon-button",type:"submit",title:"Guardar nota",children:s.jsx(lt,{className:"icon"})})]})]}),e&&s.jsxs("div",{className:"info-section",children:[s.jsx("div",{className:"section-title",children:"Acciones"}),s.jsxs("div",{className:"action-stack",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:ce,disabled:Ye,children:"Tomar conversacion"}),oe&&s.jsxs("div",{className:"reassign-card",children:[s.jsxs("select",{value:G,onChange:R=>ne(R.target.value),children:[s.jsx("option",{value:"",children:"Reasignar a..."}),c.map(R=>s.jsx("option",{value:R.id,children:R.name},R.id))]}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:le,disabled:!G,children:"Reasignar"})]}),oe&&s.jsxs("div",{className:"action-row",children:[s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>be("open"),children:"Reactivar bot"}),s.jsx("button",{className:"ghost action-btn",type:"button",onClick:()=>be("pending"),children:"Liberar para otro operador"})]})]})]})]})]})]}),Me&&s.jsx("div",{className:"modal-overlay",onClick:X,children:s.jsxs("div",{className:"modal-card",onClick:R=>R.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Gestion de etiquetas"}),s.jsx("button",{className:"modal-close",type:"button",onClick:X,children:"x"})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("form",{className:"tag-manager-form",onSubmit:Bt,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:Ge.name,onChange:R=>ve(Te=>({...Te,name:R.target.value})),placeholder:"Nombre de etiqueta"})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Color"}),s.jsx("input",{type:"color",value:Ge.color,onChange:R=>ve(Te=>({...Te,color:R.target.value}))})]}),s.jsx("div",{className:"modal-actions",children:s.jsx("button",{className:"primary",type:"submit",children:"Crear etiqueta"})})]}),s.jsx("div",{className:"tag-manager-list",children:(u||[]).map(R=>s.jsxs("div",{className:"tag-manager-row",children:[s.jsx("span",{className:"tag-chip",style:{borderColor:R.color||"#cbd5f5"},children:s.jsx("span",{className:"tag-chip-label",children:R.name})}),s.jsx("div",{className:"tag-manager-actions",children:s.jsx("button",{className:"danger soft",type:"button",onClick:()=>Gt(R.id,R.name),children:"Eliminar"})})]},R.id))})]})]})})]})}const bh=[{value:"24h",label:"ltimas 24h"},{value:"7d",label:"ltima semana"},{value:"30d",label:"ltimo mes"}];function Xx(e){if(!e)return"--";const t=e.split("-");if(t.length!==3)return"--";const n=new Date(Number(t[0]),Number(t[1])-1,Number(t[2]));if(Number.isNaN(n.getTime()))return"--";const r=["ENE","FEB","MAR","ABR","MAY","JUN","JUL","AGO","SEP","OCT","NOV","DIC"];return`${String(n.getDate()).padStart(2,"0")} ${r[n.getMonth()]}`}function Jx(e){if(!e)return"--";const t=e.split("-");if(t.length!==3)return e;const n=new Date(Number(t[0]),Number(t[1])-1,Number(t[2]));if(Number.isNaN(n.getTime()))return e;const r=["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado"],a=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return`${r[n.getDay()]} ${n.getDate()} de ${a[n.getMonth()]}`}function Ji(e,t="%"){return e==null?null:e>0?`+${e}${t}`:`${e}${t}`}function Zx({metrics:e,channels:t,selectedPeriod:n,selectedChannel:r,onPeriodChange:a,onChannelChange:i,onRefresh:l,onGenerateReport:c}){var ce,be,L,H,k,U,G,ne,le,fe;const[u,p]=h.useState(null),[_,v]=h.useState({x:0,y:0}),N=((ce=e==null?void 0:e.active_conversations)==null?void 0:ce.value)??0,A=((be=e==null?void 0:e.active_conversations)==null?void 0:be.change)??null,O=(L=e==null?void 0:e.avg_response_time)==null?void 0:L.value,P=O!=null?`${O.toFixed(1)}m`:"-",C=(H=e==null?void 0:e.avg_response_time)==null?void 0:H.change,m=((k=e==null?void 0:e.unique_contacts)==null?void 0:k.value)??0,f=((U=e==null?void 0:e.unique_contacts)==null?void 0:U.change)??null,b=`${(((G=e==null?void 0:e.conversion_rate)==null?void 0:G.value)??0).toFixed(1)}%`,M=((ne=e==null?void 0:e.conversion_rate)==null?void 0:ne.change)??null,z=((le=e==null?void 0:e.message_volume)==null?void 0:le.length)>0?e.message_volume.slice(-14):[],j=Math.max(...z.map(X=>Math.max(X.in_count,X.out_count)),1),g=Math.max(z.length*50+40,200),B=220,T=140,K=175,oe=16,pe=4,ke=z.map((X,Me)=>{const Ge=X.in_count/j*T,ve=X.out_count/j*T;return{x:30+Me*50,inHeight:Ge,outHeight:ve,inCount:X.in_count,outCount:X.out_count,day:X.day}}),Ee=z.length>0?Array.from(new Set([0,Math.floor(z.length/2),z.length-1])):[],Ae=(e==null?void 0:e.operators)??[],Pe=Math.round((e==null?void 0:e.team_efficiency)??0),V=(e==null?void 0:e.daily_goal)??500,te=(e==null?void 0:e.resolved_today)??0,ee=(X,Me)=>{const Ge=Me.currentTarget.closest(".dash-chart").getBoundingClientRect();p(X),v({x:Me.clientX-Ge.left,y:Me.clientY-Ge.top-60})},he=()=>{p(null)};return s.jsxs("section",{className:"dashboard-layout",children:[s.jsxs("div",{className:"dashboard-main",children:[s.jsxs("header",{className:"dashboard-header",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"dashboard-title",children:"Dashboard"}),s.jsx("div",{className:"dashboard-subtitle",children:"Analitica de marketing y resumen del CRM de WhatsApp"})]}),s.jsxs("div",{className:"dashboard-actions",children:[s.jsxs("select",{className:"dash-filter",value:r||"",onChange:X=>i(X.target.value||null),children:[s.jsx("option",{value:"",children:"Todas las lneas"}),(t||[]).map(X=>s.jsx("option",{value:X.phone_number_id,children:X.display_name||X.phone_number_id},X.phone_number_id))]}),s.jsx("select",{className:"dash-filter",value:n||"30d",onChange:X=>a(X.target.value),children:bh.map(X=>s.jsx("option",{value:X.value,children:X.label},X.value))}),s.jsx("button",{className:"primary",type:"button",onClick:c,children:"Generar Reporte"})]})]}),s.jsxs("div",{className:"dashboard-kpis",children:[s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Conversaciones activas"}),s.jsx("div",{className:"dash-kpi-value",children:N.toLocaleString()})]}),s.jsx("div",{className:"dash-kpi-icon",children:""})]}),A!==null&&s.jsx("div",{className:`dash-kpi-change ${A>=0?"up":"down"}`,children:Ji(A)})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tiempo de respuesta"}),s.jsx("div",{className:"dash-kpi-value",children:P})]}),s.jsx("div",{className:"dash-kpi-icon",children:""})]}),C!==null&&s.jsx("div",{className:`dash-kpi-change ${C<=0?"up":"down"}`,children:Ji(C,"m")})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Contactos nicos"}),s.jsx("div",{className:"dash-kpi-value",children:m.toLocaleString()})]}),s.jsx("div",{className:"dash-kpi-icon",children:""})]}),f!==null&&s.jsx("div",{className:`dash-kpi-change ${f>=0?"up":"down"}`,children:Ji(f)})]}),s.jsxs("div",{className:"dash-kpi",children:[s.jsxs("div",{className:"dash-kpi-top",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-kpi-label",children:"Tasa de conversin"}),s.jsx("div",{className:"dash-kpi-value",children:b})]}),s.jsx("div",{className:"dash-kpi-icon",children:""})]}),M!==null&&s.jsx("div",{className:`dash-kpi-change ${M>=0?"up":"down"}`,children:Ji(M)})]})]}),s.jsxs("div",{className:"dash-card dash-chart-card",children:[s.jsxs("div",{className:"dash-card-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-card-title",children:"Flujo de Mensajes"}),s.jsx("div",{className:"dash-card-subtitle",children:"Volumen diario por direccin"})]}),s.jsxs("div",{className:"dash-legend",children:[s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot in"})," Recibidos (clientes)"]}),s.jsxs("span",{className:"dash-legend-item",children:[s.jsx("span",{className:"dash-legend-dot out"})," Enviados (operadores/bot)"]})]})]}),z.length>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"dash-chart",style:{position:"relative"},children:[u&&s.jsxs("div",{className:"dash-chart-tooltip",style:{left:Math.min(_.x,g-160),top:Math.max(_.y,10)},children:[s.jsx("div",{className:"tooltip-date",children:Jx(u.day)}),s.jsxs("div",{className:"tooltip-row",children:[s.jsx("span",{className:"tooltip-dot in"}),s.jsx("span",{children:"Recibidos:"}),s.jsx("strong",{children:u.inCount.toLocaleString()})]}),s.jsxs("div",{className:"tooltip-row",children:[s.jsx("span",{className:"tooltip-dot out"}),s.jsx("span",{children:"Enviados:"}),s.jsx("strong",{children:u.outCount.toLocaleString()})]}),s.jsxs("div",{className:"tooltip-total",children:["Total: ",(u.inCount+u.outCount).toLocaleString()]})]}),s.jsxs("svg",{className:"dash-chart-svg",viewBox:`0 0 ${g} ${B}`,preserveAspectRatio:"xMidYMid meet",children:[s.jsx("line",{className:"dash-chart-grid",x1:"20",y1:"45",x2:g-10,y2:"45"}),s.jsx("line",{className:"dash-chart-grid",x1:"20",y1:"110",x2:g-10,y2:"110"}),s.jsx("line",{className:"dash-chart-grid",x1:"20",y1:"175",x2:g-10,y2:"175"}),s.jsx("text",{className:"dash-chart-axis",x:"15",y:"48",textAnchor:"end",children:j}),s.jsx("text",{className:"dash-chart-axis",x:"15",y:"113",textAnchor:"end",children:Math.round(j/2)}),s.jsx("text",{className:"dash-chart-axis",x:"15",y:"178",textAnchor:"end",children:"0"}),ke.map((X,Me)=>s.jsxs("g",{onMouseEnter:Ge=>ee(X,Ge),onMouseLeave:he,style:{cursor:"pointer"},children:[s.jsx("rect",{x:X.x-5,y:K-Math.max(X.inHeight,X.outHeight)-10,width:oe*2+pe+10,height:Math.max(X.inHeight,X.outHeight)+20,fill:"transparent"}),s.jsx("rect",{className:"dash-bar in",x:X.x,y:K-X.inHeight,width:oe,height:Math.max(X.inHeight,2),rx:"4"}),s.jsx("rect",{className:"dash-bar out",x:X.x+oe+pe,y:K-X.outHeight,width:oe,height:Math.max(X.outHeight,2),rx:"4"})]},`bar-${Me}`))]})]}),s.jsx("div",{className:"dash-chart-labels",children:Ee.map(X=>{var Me;return s.jsx("span",{children:Xx((Me=z[X])==null?void 0:Me.day)},`label-${X}`)})})]}):s.jsx("div",{className:"empty-state",children:"Sin datos de mensajes para el periodo seleccionado"})]})]}),s.jsxs("aside",{className:"dashboard-side",children:[s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Performance de Operadores"}),s.jsxs("div",{className:"dash-card-subtitle",children:["Top 10 - ",((fe=bh.find(X=>X.value===n))==null?void 0:fe.label)||"ltimo mes"]}),s.jsx("div",{className:"dash-operator-help",children:s.jsxs("small",{children:[s.jsx("strong",{children:"Cerrados:"})," Conversaciones que el operador resolvi (status cerrado).",s.jsx("br",{}),s.jsx("strong",{children:"En curso:"})," Conversaciones asignadas que an estn activas."]})}),s.jsx("div",{className:"dash-operator-list",children:Ae.length>0?Ae.map((X,Me)=>{var Ge;return s.jsxs("div",{className:"dash-operator",children:[s.jsx("div",{className:"dash-operator-avatar",children:((Ge=X.name)==null?void 0:Ge[0])||"?"}),s.jsxs("div",{className:"dash-operator-meta",children:[s.jsx("div",{className:"dash-operator-name",children:X.name}),s.jsx("div",{className:"dash-operator-role",children:X.role}),s.jsxs("div",{className:"dash-operator-stats",children:[s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"Cerrados"}),s.jsx("div",{className:"dash-stat-value success",children:X.resolved})]}),s.jsxs("div",{children:[s.jsx("div",{className:"dash-stat-label",children:"En curso"}),s.jsx("div",{className:"dash-stat-value warning",children:X.pending})]})]})]})]},X.id||`op-${Me}`)}):s.jsx("div",{className:"empty-state",children:"Sin operadores activos"})})]}),s.jsxs("div",{className:"dash-card",children:[s.jsx("div",{className:"dash-card-title",children:"Eficiencia de Equipo"}),s.jsxs("div",{className:"dash-efficiency",children:[s.jsxs("div",{className:"dash-efficiency-value",children:[Pe,"%"]}),s.jsx("div",{className:"dash-progress",children:s.jsx("div",{className:"dash-progress-fill",style:{width:`${Pe}%`}})}),s.jsxs("div",{className:"dash-muted",children:[te.toLocaleString()," cerradas de ",V.toLocaleString()," objetivo"]})]})]})]})]})}const Ch={draft:"BORRADOR",scheduled:"PROGRAMADA",running:"ENVIANDO",sending:"ENVIANDO",completed:"FINALIZADA",sent:"FINALIZADA",paused:"PAUSADA",failed:"ERROR"},Zi={APPROVED:{label:"APROBADA",className:"approved"},PENDING:{label:"PENDIENTE",className:"pending"},REJECTED:{label:"RECHAZADA",className:"rejected"},DRAFT:{label:"BORRADOR",className:"draft"},PAUSED:{label:"PAUSADA",className:"pending"},DISABLED:{label:"DESHABILITADA",className:"draft"}},Eh={MARKETING:"MARKETING",UTILITY:"UTILIDAD",AUTHENTICATION:"AUTENTICACION"},el=[{id:"audiences",label:"Audiencias",title:"Audiencias",subtitle:"Modulo de gestion y campanas"},{id:"templates",label:"Biblioteca de Plantillas",title:"Biblioteca de Plantillas",subtitle:"Consulta y gestiona las plantillas de mensajes autorizadas por WhatsApp."},{id:"new",label:"Campaas",title:"Campaas",subtitle:"Historial de envos y difusin WhatsApp"}],ey={audiencias:"audiences",audiences:"audiences",templates:"templates",plantillas:"templates",biblioteca:"templates",nueva:"new",campaign:"new",campaigns:"new",nueva_campana:"new",history:"new",historial:"new"},Ah=[{id:"dynamic",label:"Audiencias Dinmicas",title:"Automatizacin de Audiencias y Tags",subtitle:"Unificacin de flujos de datos Perzivalh CRM",actionLabel:"Guardar Configuracin"},{id:"excel",label:"Importar Excel",title:"Importacin de Contactos Excel",subtitle:"Gestin de base de datos externa Perzivalh CRM",actionLabel:"Iniciar Importacin"},{id:"odoo",label:"Importar de Odoo",title:"Sincronizacin Inteligente Odoo",subtitle:"Automatizacin de audiencias Perzivalh OS",actionLabel:"Actualizar Lista Odoo"}],ty=[{value:"phone",label:"Telfono"},{value:"name",label:"Nombre Completo"},{value:"city",label:"Ciudad"},{value:"tags",label:"Etiquetas"},{value:"ignore",label:"Sin Mapear"}];function ny({campaignForm:e,setCampaignForm:t,campaignFilter:n,setCampaignFilter:r,templates:a,campaigns:i,selectedCampaignId:l,campaignMessages:c,users:u,tags:p,channels:_,selectedTemplate:v,statusOptions:N,onCreateCampaign:A,onLoadCampaigns:O,onLoadCampaignMessages:P,onSendCampaign:C,onUpdateCampaign:m,onDeleteCampaign:f,onResendCampaign:y,campaignsTotal:b,formatDate:M,brandName:z}){var Ti,Li,Ri;const j=(z||"Perzivalh").trim(),[g,B]=h.useState(""),[T,K]=h.useState("all"),[oe,pe]=h.useState(!1),[ke,Ee]=h.useState(null),[Ae,Pe]=h.useState(""),[V,te]=h.useState(!1),[ee,he]=h.useState(""),[ce,be]=h.useState("all"),[L,H]=h.useState(!1),[k,U]=h.useState(null),[G,ne]=h.useState(""),[le,fe]=h.useState(null),[X,Me]=h.useState("down"),[Ge,ve]=h.useState(null),[Bt,Gt]=h.useState(!1),[_n,on]=h.useState(!1),[Ke,zt]=h.useState({id:"",name:"",phone:"",email:"",vat:""}),[cn,Qt]=h.useState(e.send_now===!1||e.scheduled_for?"schedule":"now"),[lt,un]=h.useState(1),[et]=h.useState(6),{pushToast:xe}=dd(),St=h.useRef(null),[W,Ie]=h.useState(!1),[ye,Ye]=h.useState("dynamic"),Sn=h.useMemo(()=>Ah.map(o=>({...o,subtitle:o.subtitle.replace(/Perzivalh/g,j)})),[j]),[R,Te]=h.useState({enabled:!1,phone_number_id:null}),[$s,kn]=h.useState(!1),[Bn,ns]=h.useState([]),[bn,$t]=h.useState(!1),[S,F]=h.useState(!1),[q,se]=h.useState(""),[_e,dn]=h.useState(null),[ft,tt]=h.useState(""),[nt,ss]=h.useState(null),[ea,rs]=h.useState([]),[re,ue]=h.useState({targetMode:"new",listName:"",targetSegmentId:"",prefix:"",ignoreDuplicates:!0}),[hn,zn]=h.useState(null),[Us,as]=h.useState(!1),[ta,Fs]=h.useState({connected:!1}),[pi,$n]=h.useState(!1),[na,Cn]=h.useState(!1),[is,ls]=h.useState(null),[Oe,mi]=h.useState(()=>{if(typeof window>"u")return"templates";const x=new URLSearchParams(window.location.search).get("tab");return x?ey[x]||x:"templates"}),[mr,lo]=h.useState(null),[En,sa]=h.useState(null),[os,cs]=h.useState([]),[ra,aa]=h.useState(0),[gi,oo]=h.useState(!1),[us,hd]=h.useState(""),[Vs,pt]=h.useState(new Set),[ia,Xe]=h.useState(""),[Ws,la]=h.useState(!1),[ot,st]=h.useState(1),[Un]=h.useState(10),[kt,oa]=h.useState({tag:"Todas",date:"Cualquier fecha",status:"Activos"}),[vi,ca]=h.useState(null),ua=h.useRef(null),Kt=h.useMemo(()=>(_||[]).filter(o=>o==null?void 0:o.phone_number_id),[_]),[fn,Hs]=h.useState(""),je=h.useMemo(()=>Kt.find(o=>o.phone_number_id===fn)||Kt[0]||null,[Kt,fn]),ds=(je==null?void 0:je.display_name)||(je==null?void 0:je.phone_number_id)||"";h.useEffect(()=>{const o=e.send_now===!1||e.scheduled_for?"schedule":"now";Qt(o)},[e.send_now,e.scheduled_for]);const[qs,da]=h.useState([]);h.useEffect(()=>{Lt(),xi()},[]),h.useEffect(()=>{!fn&&Kt.length&&Hs(Kt[0].phone_number_id)},[Kt,fn]),h.useEffect(()=>{W&&(co(),gr(),Gs())},[W,fn]),h.useEffect(()=>{if(Oe!=="new"||L)return;const o=setTimeout(()=>{un(1),O(1,et,ee.trim())},350);return()=>clearTimeout(o)},[ee,et,L,Oe,O]),h.useEffect(()=>{!W||ye!=="odoo"||Gs()},[ye,W]),h.useEffect(()=>{el.find(o=>o.id===Oe)||mi("templates")},[Oe]),h.useEffect(()=>{if(typeof window>"u")return;const o=new URLSearchParams(window.location.search);o.set("tab",Oe);const x=`${window.location.pathname}?${o.toString()}`;window.history.replaceState({},"",x)},[Oe]);async function Lt(){try{const o=await Ne("/api/audiences?with_counts=true");o&&o.segments&&da(o.segments)}catch(o){console.error("Failed to load segments",o)}}async function xi(){try{const o=await Ne("/api/contacts/stats");lo(o||null)}catch(o){console.error("Failed to load Odoo stats",o),lo(null)}}async function co(){kn(!0);try{const o=je!=null&&je.phone_number_id?`?phone_number_id=${encodeURIComponent(je.phone_number_id)}`:"",x=await Ne(`/api/audiences/automation-settings${o}`);Te((x==null?void 0:x.settings)||{enabled:!1,phone_number_id:null})}catch(o){console.error("Failed to load automation settings",o)}finally{kn(!1)}}async function gr(){$t(!0);try{const o=new URLSearchParams;je!=null&&je.phone_number_id&&o.set("phone_number_id",je.phone_number_id),ds&&o.set("line_name",ds);const x=o.toString(),D=await Ne(`/api/audiences/dynamic-tags${x?`?${x}`:""}`);ns((D==null?void 0:D.items)||[])}catch(o){console.error("Failed to load dynamic audiences",o)}finally{$t(!1)}}async function ha(o=R.enabled){try{const x=await Le("/api/audiences/automation-settings",{enabled:o,phone_number_id:(je==null?void 0:je.phone_number_id)||null,line_name:ds||null});Te((x==null?void 0:x.settings)||{...R,enabled:o}),xe({message:"Configuracin guardada"})}catch(x){xe({type:"error",message:x.message||"No se pudo guardar"})}}async function yi(o){Te(x=>({...x,enabled:o})),await ha(o)}async function uo(){F(!0);try{await Le("/api/audiences/sync-historical",{phone_number_id:(je==null?void 0:je.phone_number_id)||null,line_name:ds||null}),await gr(),await Lt(),xe({message:"Sincronizacin completa"})}catch(o){xe({type:"error",message:o.message||"Error al sincronizar"})}finally{F(!1)}}async function ji(){const o=q.trim();if(o)try{await Le("/api/audiences/dynamic-tags",{name:o,phone_number_id:(je==null?void 0:je.phone_number_id)||null,line_name:ds||null}),se(""),await gr(),await Lt(),xe({message:"Etiqueta creada correctamente"})}catch(x){xe({type:"error",message:x.message||"No se pudo crear etiqueta"})}}async function Gs(){$n(!0);try{const o=await Ne("/api/contacts/odoo-status");Fs(o||{connected:!1})}catch(o){console.error("Failed to load Odoo status",o),Fs({connected:!1})}finally{$n(!1)}}async function Ni(){Cn(!0),ls(null);try{const o=await Le("/api/contacts/refresh-odoo",{});ls(o||null),await xi(),xe({message:"Lista Odoo actualizada"})}catch(o){xe({type:"error",message:o.message||"Error al actualizar Odoo"})}finally{Cn(!1)}}async function ho(o){return new Promise((x,D)=>{const Q=new FileReader;Q.onload=()=>{const me=(Q.result||"").toString().split(",")[1]||"";x(me)},Q.onerror=()=>D(Q.error),Q.readAsDataURL(o)})}async function fa(o){var D;const x=(D=o.target.files)==null?void 0:D[0];if(x){dn(x),zn(null);try{const Q=await ho(x);tt(Q);const Z=await Le("/api/audiences/import-preview",{file_base64:Q,filename:x.name});ss(Z),rs((Z==null?void 0:Z.mapping)||[])}catch(Q){ss(null),rs([]),xe({type:"error",message:Q.message||"No se pudo leer el archivo"})}}}function pn(){dn(null),tt(""),ss(null),rs([]),zn(null)}async function fo(){if(!_e||!ft){xe({type:"error",message:"Selecciona un archivo vlido"});return}as(!0);try{const o={file_base64:ft,filename:_e.name,mapping:ea,options:{baseTagName:re.listName,targetSegmentId:re.targetMode==="existing"?re.targetSegmentId:"",prefix:re.prefix,ignoreDuplicates:re.ignoreDuplicates,phoneNumberId:(je==null?void 0:je.phone_number_id)||null}},x=await Le("/api/audiences/import-excel",o);zn(x),await Lt(),await gr(),xe({message:"Importacin completada"})}catch(o){xe({type:"error",message:o.message||"Error al importar"})}finally{as(!1)}}async function Qs(o,x={}){if(!o){cs([]),aa(0);return}const D=x.page||1,Q=x.search||"";oo(!0);try{if(o.type==="odoo"){const Vn=(D-1)*Un,Tn=await Ne(`/api/contacts?search=${encodeURIComponent(Q)}&offset=${Vn}&limit=${Un}`);let Xt=(Tn==null?void 0:Tn.contacts)||[];kt.tag!=="Todas"&&(Xt=Xt.filter(Wn=>{const Jt=Wn.tags_json||[];return kt.tag==="Con etiquetas"?Array.isArray(Jt)&&Jt.length>0:kt.tag==="Sin etiquetas"?!Array.isArray(Jt)||Jt.length===0:!0})),kt.status!=="Activos"&&(Xt=Xt.filter(Wn=>{const Jt=(Wn.status||"ACTIVO").toUpperCase();return kt.status==="Activos"?Jt==="ACTIVO":Jt!=="ACTIVO"})),cs(Xt),aa((Tn==null?void 0:Tn.total)||Xt.length);return}const Z=Q?1e3:200,me=await Ne(`/api/audiences/${o.id}/preview?limit=${Z}`),rt=(me==null?void 0:me.recipients)||[],Rt=Q.trim().toLowerCase();let Yt=Rt?rt.filter(Vn=>{var Wn,Jt;const Tn=((Wn=Vn.name)==null?void 0:Wn.toLowerCase())||"",Xt=((Jt=Vn.phone_e164)==null?void 0:Jt.toLowerCase())||"";return Tn.includes(Rt)||Xt.includes(Rt)}):rt;kt.tag==="Sin etiquetas"&&(Yt=Yt.filter(Vn=>!Vn.tags||Vn.tags.length===0));const jr=Rt?Yt.length:(me==null?void 0:me.total)||Yt.length,Nr=(D-1)*Un,Oo=Yt.slice(Nr,Nr+Un);cs(Oo),aa(jr)}catch(Z){console.error("Failed to load audience contacts",Z),cs([]),aa(0)}finally{oo(!1)}}function po(o){sa((o==null?void 0:o.id)||null),st(1),pt(new Set),Xe("")}async function mo(){try{await Le("/api/audiences/refresh-counts",{}),await Lt(),ct&&await Qs(ct,{page:ot,search:us}),xe({message:"Conteos actualizados"})}catch(o){xe({type:"error",message:o.message||"No se pudo actualizar"})}}async function go(o){if(!(!o||o.type==="odoo"||o.isDefault||!window.confirm(`Eliminar la audiencia "${o.name}"? Esta accin la desactiva y no borra contactos.`)))try{await ks(`/api/audiences/${o.id}`),await Lt(),En===o.id&&sa(null),ca(null),xe({message:"Audiencia eliminada"})}catch(D){xe({type:"error",message:D.message||"No se pudo eliminar"})}}async function vr(o){if(!o||o.type==="odoo"||o.isDefault)return;const x=window.prompt("Nuevo nombre de la audiencia:",o.name);if(!(!x||!x.trim()))try{await Ul(`/api/audiences/${o.id}`,{name:x.trim()}),await Lt(),ca(null),xe({message:"Audiencia renombrada"})}catch(D){xe({type:"error",message:D.message||"No se pudo renombrar"})}}function pa(o,x){oa(D=>{const Q=D[o],Z=x.indexOf(Q),me=x[(Z+1)%x.length];return{...D,[o]:me}})}function vo(){if(ye==="dynamic"){ha();return}if(ye==="excel"){fo();return}ye==="odoo"&&Ni()}const mt=h.useMemo(()=>{const o={id:"odoo",name:"odoo",subtitle:"Origen: Odoo",count:(mr==null?void 0:mr.total)||0,type:"odoo"},x=qs.map(D=>{var Q;return{id:D.id,name:D.name,subtitle:D.description||"Segmento personalizado",count:D.estimated_count||0,type:"segment",isDefault:(D.name||"").toUpperCase().startsWith("DEFAULT"),rules:D.rules_json,tagName:Array.isArray(D.rules_json)&&((Q=D.rules_json.find(Z=>(Z.type||Z.field)==="tag"&&Z.value))==null?void 0:Q.value)||""}});return[o,...x]},[qs,mr]),wi=h.useMemo(()=>{const o=Ae.trim().toLowerCase();return o?mt.filter(x=>{var Z,me;const D=((Z=x.name)==null?void 0:Z.toLowerCase())||"",Q=((me=x.subtitle)==null?void 0:me.toLowerCase())||"";return D.includes(o)||Q.includes(o)}):mt},[mt,Ae]),ct=h.useMemo(()=>mt.find(o=>o.id===En),[mt,En]),ma=o=>{const x=(o==null?void 0:o.buttons_json)??(o==null?void 0:o.buttons)??[];if(Array.isArray(x))return x;if(typeof x=="string")try{const D=JSON.parse(x);return Array.isArray(D)?D:[]}catch{return[]}return[]},_i=h.useMemo(()=>ma(v),[v]),Si=h.useMemo(()=>ma(ke),[ke]),Ks=h.useMemo(()=>Math.max(1,Math.ceil(ra/Un)),[ra,Un]),hs=h.useMemo(()=>{const o=[],x=Math.max(1,ot-1),D=Math.min(Ks,x+2);for(let Q=x;Q<=D;Q+=1)o.push(Q);return o},[ot,Ks]),Ys=o=>o==="sent"?"completed":o==="sending"?"running":o||"",Xs=h.useMemo(()=>{const o={all:i.length,completed:0,scheduled:0,draft:0,failed:0,running:0};return i.forEach(x=>{const D=Ys(x.status);D==="completed"&&(o.completed+=1),D==="scheduled"&&(o.scheduled+=1),D==="draft"&&(o.draft+=1),D==="failed"&&(o.failed+=1),D==="running"&&(o.running+=1)}),o},[i]),xr=h.useMemo(()=>{const o=ee.trim().toLowerCase();return i.filter(x=>{const D=!o||(x.name||"").toLowerCase().includes(o),Q=Ys(x.status);return D&&(ce==="all"||Q===ce)})},[i,ee,ce]),fs=h.useMemo(()=>{const o=[],x=b||i.length,D=Math.max(1,Math.ceil(x/et)),Q=Math.max(1,lt-1),Z=Math.min(D,Q+2);for(let me=Q;me<=Z;me+=1)o.push(me);return{pages:o,totalPages:D}},[b,i.length,lt,et]);h.useEffect(()=>{Oe==="audiences"&&!En&&mt.length&&sa(mt[0].id)},[mt,Oe,En]),h.useEffect(()=>{Oe!=="new"&&L&&(H(!1),U(null),xa())},[Oe,L]),h.useEffect(()=>{if(Oe!=="audiences")return;const o=setTimeout(()=>{Qs(ct,{page:ot,search:us})},300);return()=>clearTimeout(o)},[En,ot,us,Oe,ct,kt]),h.useEffect(()=>{pt(new Set),Xe("")},[En]);const Js=h.useMemo(()=>os.filter(o=>o.conversation_id||o.conversationId),[os]),Fn=h.useMemo(()=>{const o=new Map(os.map(x=>[x.conversation_id||x.conversationId||"",x]));return Array.from(Vs).map(x=>o.get(x)).filter(Boolean)},[os,Vs]),ps=(ct==null?void 0:ct.tagName)||"",ki=h.useMemo(()=>mt.filter(o=>o.tagName),[mt]),ga=ki.find(o=>o.id===ia),An=(ga==null?void 0:ga.tagName)||"";h.useEffect(()=>{if(!ua.current)return;const o=Js.length,x=Vs.size;ua.current.indeterminate=x>0&&x<o},[Js.length,Vs]);function xo(o){if(!o){pt(new Set);return}const x=new Set(Js.map(D=>D.conversation_id||D.conversationId||""));pt(x)}function yo(o){const x=o.conversation_id||o.conversationId||"";x&&pt(D=>{const Q=new Set(D);return Q.has(x)?Q.delete(x):Q.add(x),Q})}async function va(o){if(!Fn.length||Ws)return;if((o==="add"||o==="move")&&!An){xe({type:"error",message:"Selecciona una audiencia destino vlida."});return}if((o==="remove"||o==="move")&&!ps){xe({type:"error",message:"La audiencia actual no permite quitar contactos."});return}if(An&&An===ps&&o!=="remove"){xe({type:"error",message:"La audiencia destino debe ser diferente a la actual."});return}const D=Fn.map(Z=>({contact:Z,conversationId:Z.conversation_id||Z.conversationId||""})).filter(Z=>Z.conversationId),Q=Fn.length-D.length;if(!D.length){xe({type:"error",message:"No hay contactos compatibles para esta accin."});return}la(!0);try{await Promise.all(D.map(({conversationId:Z})=>Le(`/api/conversations/${Z}/tags`,{add:o==="add"||o==="move"?[An]:[],remove:o==="remove"||o==="move"?[ps]:[]}))),Q&&xe({type:"error",message:`${Q} contacto(s) no se pudieron actualizar.`}),pt(new Set),Xe(""),await Lt(),await Qs(ct,{page:ot,search:us}),xe({message:"Cambios aplicados correctamente."})}catch(Z){xe({type:"error",message:Z.message||"No se pudo actualizar."})}finally{la(!1)}}const jo=h.useMemo(()=>{const o=new Set;return(a||[]).forEach(x=>{x.category&&o.add(x.category)}),Array.from(o)},[a]),bi=h.useMemo(()=>{const o=g.trim().toLowerCase(),x=T==="all"?"":T.toLowerCase();return(a||[]).filter(D=>{var Rt,Yt;const Q=((Rt=D.name)==null?void 0:Rt.toLowerCase())||"",Z=((Yt=D.category)==null?void 0:Yt.toLowerCase())||"";return(!o||Q.includes(o)||Z.includes(o))&&(!x||Z===x)})},[g,T,a]),Ci=h.useMemo(()=>{const o=G.trim().toLowerCase();return(a||[]).filter(x=>{var Q;const D=((Q=x.name)==null?void 0:Q.toLowerCase())||"";return!o||D.includes(o)})},[G,a]),ms=h.useMemo(()=>n.segment_id?mt.find(o=>o.id===n.segment_id)||null:n.tag&&mt.find(o=>o.name===n.tag)||null,[mt,n.segment_id,n.tag]),No=h.useMemo(()=>n.segment_id?`segment:${n.segment_id}`:n.tag?`tag:${n.tag}`:n.assigned_user_id?`assigned:${n.assigned_user_id}`:n.status?`status:${n.status}`:n.verified_only?"verified":"",[n.segment_id,n.tag,n.assigned_user_id,n.status,n.verified_only]);function gs(o){r(x=>{const D={...x,status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""};if(o.startsWith("segment:")){const Q=o.slice(8),Z=mt.find(me=>me.id===Q);D.segment_id=Q,D.segment_name=(Z==null?void 0:Z.name)||""}else o.startsWith("tag:")?D.tag=o.slice(4):o.startsWith("status:")?D.status=o.slice(7):o.startsWith("assigned:")?D.assigned_user_id=o.slice(9):o==="verified"&&(D.verified_only=!0);return D})}function yr(o){if(!o)return"";const x=new Date(o);if(Number.isNaN(x.getTime()))return"";const D=Q=>String(Q).padStart(2,"0");return`${x.getFullYear()}-${D(x.getMonth()+1)}-${D(x.getDate())}T${D(x.getHours())}:${D(x.getMinutes())}`}function wo(o){t(x=>({...x,template_id:o}))}function xa(){t({name:"",template_id:"",scheduled_for:"",send_now:!0}),r({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),ne("")}function _o(o){var Z;if(!o)return;U(o),H(!0),ne(""),t(me=>{var rt;return{...me,name:o.name||"",template_id:o.template_id||((rt=o.template)==null?void 0:rt.id)||"",scheduled_for:yr(o.scheduled_for||o.scheduled_at),send_now:!(o.scheduled_for||o.scheduled_at)}});const x=o.audience_filter||{},D=x.segment_id||o.segment_id||"",Q=x.segment_name||((Z=o.segment)==null?void 0:Z.name)||"";r(me=>({...me,status:x.status||"",tag:x.tag||"",assigned_user_id:x.assigned_user_id||"",verified_only:!!x.verified_only,segment_id:D,segment_name:Q}))}function So(o){!(o!=null&&o.id)||!f||!window.confirm(`Eliminar la campaa "${o.name}"?`)||f(o.id)}function Zs(o){!(o!=null&&o.id)||!y||!window.confirm(`Reenviar la campaa "${o.name}"?`)||y(o.id)}function ko(o,x){if(fe(D=>D===o?null:o),x!=null&&x.currentTarget&&typeof window<"u"){const D=x.currentTarget.getBoundingClientRect(),Q=window.innerHeight-D.bottom,Z=D.top,me=Q<180&&Z>Q;Me(me?"up":"down")}}function bo(o){ve(x=>x===o?null:o)}function Co(o){o!=null&&o.id&&(zt({id:o.id,name:o.name||"",phone:o.phone_e164||o.phone||"",email:o.email||"",vat:o.vat||""}),Gt(!0),ve(null))}async function Eo(o){if(o.preventDefault(),!!Ke.id){on(!0);try{const x=await Ul(`/api/contacts/${Ke.id}`,{name:Ke.name,phone:Ke.phone,email:Ke.email,vat:Ke.vat});x!=null&&x.contact&&cs(D=>D.map(Q=>Q.id===x.contact.id?x.contact:Q)),Gt(!1),xe({message:"Contacto actualizado"}),await Qs(ct,{page:ot,search:us})}catch(x){xe({type:"error",message:x.message||"No se pudo actualizar"})}finally{on(!1)}}}async function ya(o){if(!(!(o!=null&&o.id)||!window.confirm(`Eliminar el contacto "${o.name||o.phone_e164||"Sin nombre"}"?`)))try{await ks(`/api/contacts/${o.id}`),cs(D=>D.filter(Q=>Q.id!==o.id)),ve(null),xe({message:"Contacto eliminado"}),await Qs(ct,{page:ot,search:us})}catch(D){xe({type:"error",message:D.message||"No se pudo eliminar"})}}function Ao(o){if(o.preventDefault(),!e.name.trim()||!e.template_id)return;const x={};if(n.status&&(x.status=n.status),n.tag&&(x.tag=n.tag.trim()),n.assigned_user_id&&(x.assigned_user_id=n.assigned_user_id),n.verified_only&&(x.verified_only=!0),n.segment_id&&(x.segment_id=n.segment_id,n.segment_name&&(x.segment_name=n.segment_name)),k&&m){m(k.id,{name:e.name.trim(),template_id:e.template_id,segment_id:n.segment_id||null,audience_filter:x,scheduled_for:e.scheduled_for||null}),H(!1),U(null),xa();return}A(o)}function To(o){Ee(o),pe(!0)}const Lo=el.find(o=>o.id===Oe)||el[1],Ro={title:"Campaas",subtitle:"CONFIGURACIN DE NUEVO ENVO MASIVO"},Ei=Sn.find(o=>o.id===ye)||Sn[0],Ai=W?Ei:Oe==="new"&&L?Ro:Lo;return s.jsxs("section",{className:"campaigns-page",children:[s.jsxs("div",{className:"campaigns-shell",children:[s.jsxs("header",{className:"campaigns-header",children:[s.jsxs("div",{className:"campaigns-title-block",children:[s.jsxs("div",{className:"campaigns-title-row",children:[W&&s.jsx("button",{className:"campaigns-back",type:"button",onClick:()=>Ie(!1),"aria-label":"Volver",children:"<"}),s.jsx("span",{className:"campaigns-heading",children:Ai.title})]}),s.jsx("div",{className:`campaigns-subtitle ${W?"campaigns-subtitle--upper":""}`,children:Ai.subtitle})]}),s.jsxs("div",{className:"campaigns-actions",children:[W&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>Ie(!1),children:ye==="excel"?"Cancelar":"Descartar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:vo,disabled:ye==="excel"&&(Us||!ft||re.targetMode==="new"&&!re.listName.trim()||re.targetMode==="existing"&&!re.targetSegmentId)||ye==="odoo"&&na,children:Ei.actionLabel})]}),!W&&Oe==="audiences"&&s.jsxs("button",{className:"campaigns-primary campaigns-primary--dropdown",type:"button",onClick:()=>{Ie(!0),Ye("dynamic")},children:[s.jsx("span",{className:"campaigns-primary-icon",children:"+"}),"Nueva Audiencia"]}),!W&&Oe==="new"&&s.jsx(s.Fragment,{children:L?s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:()=>{H(!1),U(null),xa()},children:"Cancelar"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>{var o,x;return(x=(o=St.current)==null?void 0:o.requestSubmit)==null?void 0:x.call(o)},children:k?"Guardar cambios":"Lanzar Campaa"})]}):s.jsx("button",{className:"campaigns-primary",type:"button",onClick:()=>H(!0),children:"+ Lanzar Campaa"})})]})]}),!W&&s.jsx("nav",{className:"campaigns-tabs",role:"tablist","aria-label":"Secciones de Campaas",children:el.map(o=>s.jsx("button",{type:"button",role:"tab","aria-selected":Oe===o.id,className:`campaigns-tab ${Oe===o.id?"active":""}`,onClick:()=>mi(o.id),children:o.label},o.id))}),s.jsx("div",{className:"campaigns-tab-panel",children:W?s.jsxs("section",{className:"audience-flow",children:[s.jsx("nav",{className:"audience-flow-tabs",role:"tablist","aria-label":"Flujo de nueva audiencia",children:Ah.map(o=>s.jsx("button",{type:"button",role:"tab","aria-selected":ye===o.id,className:`audience-flow-tab ${ye===o.id?"active":""}`,onClick:()=>Ye(o.id),children:o.label},o.id))}),s.jsxs("div",{className:"audience-flow-panel",children:[ye==="dynamic"&&s.jsxs("div",{className:"audience-flow-content",children:[s.jsxs("div",{className:"audience-hero",children:[s.jsxs("div",{className:"audience-hero-main",children:[s.jsx("div",{className:"audience-hero-title",children:"Sincronizacin Automtica Total"}),s.jsx("div",{className:"audience-hero-subtitle",children:"Vincula tus etiquetas directamente con Audiencias Dinmicas. La lgica del sistema es 1 Tag = 1 Audiencia."}),s.jsxs("div",{className:"audience-line-picker",children:[s.jsx("span",{children:"Lnea activa"}),s.jsxs("select",{value:(je==null?void 0:je.phone_number_id)||"",onChange:o=>Hs(o.target.value),disabled:!Kt.length,children:[!Kt.length&&s.jsx("option",{value:"",children:"Sin lneas registradas"}),Kt.map(o=>s.jsx("option",{value:o.phone_number_id,children:o.display_name||o.phone_number_id},o.id))]})]})]}),s.jsxs("label",{className:"audience-switch",children:[s.jsx("span",{children:"Estado"}),s.jsx("input",{type:"checkbox",checked:R.enabled,onChange:o=>yi(o.target.checked),disabled:$s||!Kt.length}),s.jsx("span",{children:R.enabled?"ACTIVO":"INACTIVO"})]})]}),s.jsxs("div",{className:"audience-rule-card",children:[s.jsx("div",{className:"audience-rule-title",children:"Regla de Automatizacin unificada"}),s.jsx("p",{children:"Cuando un operador o bot etiqueta a un contacto en el CRM, este se aade instantneamente a la lista de audiencia correspondiente. No requiere intervencin manual adicional."})]}),s.jsxs("div",{className:"audience-section-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audience-section-title",children:"Gestin de Etiquetas dinmicas"}),s.jsx("div",{className:"audience-section-subtitle",children:"Administra las etiquetas vinculadas que alimentan tus listas de envo en tiempo real."})]}),s.jsxs("div",{className:"audience-section-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:uo,disabled:S,children:S?"Sincronizando...":"Sincronizar Datos Histricos"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:ji,disabled:!q.trim(),children:"Nueva Etiqueta / Audiencia"})]})]}),s.jsxs("div",{className:"audience-tags-grid",children:[bn&&s.jsx("div",{className:"empty-state",children:"Cargando etiquetas..."}),!bn&&Bn.length===0&&s.jsx("div",{className:"empty-state",children:"No hay etiquetas dinmicas an."}),!bn&&Bn.map(o=>{var x,D,Q,Z,me;return s.jsxs("div",{className:`audience-tag-card ${o.is_default?"default":""}`,children:[s.jsxs("div",{className:"audience-tag-head",children:[s.jsx("div",{className:"audience-tag-name",children:o.is_default?((x=o.segment)==null?void 0:x.name)||"DEFAULT":((D=o.tag)==null?void 0:D.name)||((Q=o.segment)==null?void 0:Q.name)}),s.jsx("div",{className:"audience-tag-count",children:((Z=o.segment)==null?void 0:Z.estimated_count)||0})]}),s.jsxs("div",{className:"audience-tag-meta",children:["Audiencia: ",((me=o.segment)==null?void 0:me.estimated_count)||0," contactos"]}),s.jsxs("div",{className:"audience-tag-status",children:[s.jsx("span",{className:"dot"}),"Sincronizado",s.jsx("span",{className:"audience-tag-time",children:o.last_synced_at?`  ${M(o.last_synced_at)}`:""})]})]},o.id)}),s.jsx("div",{className:"audience-tag-card add",children:s.jsxs("div",{className:"audience-tag-add",children:[s.jsx("div",{className:"audience-tag-add-icon",children:"+"}),s.jsx("input",{type:"text",placeholder:"Crear nueva etiqueta",value:q,onChange:o=>se(o.target.value)}),s.jsx("button",{type:"button",className:"campaigns-primary",onClick:ji,disabled:!q.trim(),children:"Crear"})]})})]})]}),ye==="excel"&&s.jsxs("div",{className:"audience-flow-content",children:[_e?s.jsxs("div",{className:"excel-file-panel",children:[s.jsxs("div",{children:[s.jsx("div",{className:"excel-file-title",children:"Archivo cargado"}),s.jsx("div",{className:"excel-file-name",children:_e.name})]}),s.jsxs("div",{className:"excel-file-actions",children:[s.jsxs("label",{className:"excel-link",children:["Cambiar archivo",s.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:fa})]}),s.jsx("button",{className:"campaigns-danger",type:"button",onClick:pn,children:"Eliminar archivo"})]})]}):s.jsx("div",{className:"excel-dropzone",children:s.jsxs("div",{className:"excel-dropzone-inner",children:[s.jsx("div",{className:"excel-dropzone-icon",children:"?"}),s.jsx("div",{className:"excel-dropzone-title",children:"Sube tu archivo de Excel"}),s.jsxs("div",{className:"excel-dropzone-subtitle",children:["Arrastra y suelta tu archivo .xlsx o .csv aqu o"," ",s.jsxs("label",{className:"excel-link",children:["explora tus archivos",s.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:fa})]})]}),s.jsxs("div",{className:"excel-dropzone-tags",children:[s.jsx("span",{children:"Mximo 50MB"}),s.jsx("span",{children:"Hasta 50,000 filas"})]})]})}),_e?s.jsxs("div",{className:"excel-grid",children:[s.jsxs("div",{className:"excel-card",children:[s.jsx("div",{className:"excel-card-title",children:"Configuracin de Importacin"}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista de destino"}),s.jsxs("select",{value:re.targetMode,onChange:o=>ue(x=>({...x,targetMode:o.target.value})),children:[s.jsx("option",{value:"new",children:"Crear Nueva Lista"}),s.jsx("option",{value:"existing",children:"Elegir Lista Existente"})]})]}),re.targetMode==="new"?s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Nombre de la nueva lista"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO",value:re.listName,onChange:o=>ue(x=>({...x,listName:o.target.value}))})]}):s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Lista existente"}),s.jsxs("select",{value:re.targetSegmentId,onChange:o=>ue(x=>({...x,targetSegmentId:o.target.value})),children:[s.jsx("option",{value:"",children:"Selecciona una lista"}),qs.map(o=>s.jsx("option",{value:o.id,children:o.name},o.id))]})]}),s.jsxs("label",{className:"excel-field",children:[s.jsx("span",{children:"Prefijo de etiqueta (opcional)"}),s.jsx("input",{type:"text",placeholder:"Ej: IMPORT_JULIO_",value:re.prefix,onChange:o=>ue(x=>({...x,prefix:o.target.value}))})]}),s.jsxs("label",{className:"excel-checkbox",children:[s.jsx("input",{type:"checkbox",checked:re.ignoreDuplicates,onChange:o=>ue(x=>({...x,ignoreDuplicates:o.target.checked}))}),"Ignorar contactos duplicados"]}),hn&&s.jsxs("div",{className:"excel-summary",children:["Procesadas: ",hn.processed,"  Nuevos:"," ",hn.created,"  Duplicados:"," ",hn.skipped,"  Errores: ",hn.errors]})]}),s.jsxs("div",{className:"excel-card",children:[s.jsxs("div",{className:"excel-card-title",children:["Vista previa de mapeo",s.jsxs("span",{className:"excel-pill",children:["Columnas detectadas: ",((Ti=nt==null?void 0:nt.columns)==null?void 0:Ti.length)||0]})]}),s.jsxs("div",{className:"excel-map-table",children:[s.jsxs("div",{className:"excel-map-head",children:[s.jsx("span",{children:"Columna Excel"}),s.jsx("span",{children:"Mapeo CRM"}),s.jsx("span",{children:"Ejemplo"})]}),((nt==null?void 0:nt.columns)||[]).map((o,x)=>{var D,Q;return s.jsxs("div",{className:"excel-map-row",children:[s.jsx("span",{children:o}),s.jsx("select",{value:ea[x]||"ignore",onChange:Z=>rs(me=>{const rt=[...me];return rt[x]=Z.target.value,rt}),children:ty.map(Z=>s.jsx("option",{value:Z.value,children:Z.label},Z.value))}),s.jsx("span",{children:((Q=(D=nt==null?void 0:nt.previewRows)==null?void 0:D[0])==null?void 0:Q[x])||"--"})]},`${o}-${x}`)}),!nt&&s.jsx("div",{className:"empty-state",children:"Sube un archivo para ver el mapeo."})]})]})]}):s.jsxs("div",{className:"excel-placeholder",children:[s.jsx("div",{className:"excel-placeholder-title",children:"Agrega un archivo para continuar"}),s.jsx("div",{className:"excel-placeholder-subtitle",children:"Luego podrs mapear todas las columnas a los campos del CRM."})]})]}),ye==="odoo"&&s.jsxs("div",{className:"audience-flow-content odoo-flow",children:[s.jsxs("div",{className:"odoo-status",children:[s.jsx("span",{className:`odoo-indicator ${ta.connected?"on":"off"}`}),"Estado: ",ta.connected?"Odoo conectado":"Odoo no conectado"]}),s.jsxs("div",{className:"odoo-actions",children:[s.jsx("button",{className:"campaigns-ghost",type:"button",onClick:Gs,disabled:pi,children:pi?"Validando...":"Validar Conexin"}),s.jsx("button",{className:"campaigns-primary",type:"button",onClick:Ni,disabled:na,children:na?"Actualizando...":"Actualizar Lista Odoo"})]}),s.jsx("div",{className:"odoo-note",children:"Se importarn contactos y se crearn audiencias por etiqueta Automticamente."}),is&&s.jsxs("div",{className:"odoo-summary",children:[s.jsx("div",{className:"odoo-summary-title",children:"Resultado de sincronizacin"}),s.jsxs("div",{className:"odoo-summary-metrics",children:[s.jsxs("span",{children:["Aadidos: ",is.created||0]}),s.jsxs("span",{children:["Actualizados: ",is.updated||0]}),s.jsxs("span",{children:["Omitidos: ",is.skipped||0]})]}),(Ri=(Li=is.preview)==null?void 0:Li.created)!=null&&Ri.length?s.jsxs("div",{className:"odoo-preview",children:[s.jsx("div",{className:"odoo-preview-title",children:"Contactos aadidos"}),s.jsx("ul",{children:is.preview.created.map(o=>s.jsxs("li",{children:[s.jsx("strong",{children:o.name||"Sin nombre"})," ",s.jsx("span",{children:o.phone_e164||""})]},`${o.phone_e164||o.name}-${o.id||""}`))})]}):null]})]})]})]}):s.jsxs(s.Fragment,{children:[Oe==="templates"&&s.jsxs("section",{className:"campaigns-panel templates-panel",children:[s.jsxs("div",{className:"templates-toolbar",children:[s.jsxs("label",{className:"templates-search ui-search",children:[s.jsx("span",{className:"template-search-icon ui-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar por nombre de plantilla...",value:g,onChange:o=>B(o.target.value)})]}),s.jsxs("select",{className:"templates-select",value:T,onChange:o=>K(o.target.value),children:[s.jsx("option",{value:"all",children:"Todas las categorias"}),jo.map(o=>s.jsx("option",{value:o.toLowerCase(),children:Eh[o]||o},o))]})]}),s.jsxs("div",{className:"template-grid template-grid--library",children:[bi.map(o=>{const x=(o.status||(o.is_active?"APPROVED":"PENDING")).toUpperCase(),D=Zi[x]||Zi.PENDING,Q=Eh[o.category]||o.category||"GENERAL",Z=o.id===e.template_id,me=o.rejection_reason||o.rejectionReason||o.rejection_message||"",rt=x==="REJECTED"?"Ver detalles":"Previsualizar";return s.jsxs("div",{className:`template-card ${Z?"selected":""}`,children:[s.jsxs("div",{className:"template-head",children:[s.jsx("div",{className:"template-name",title:o.name,children:o.name}),s.jsx("span",{className:`template-status ${D.className}`,children:D.label})]}),s.jsx("div",{className:"template-category",children:Q}),s.jsx("div",{className:`template-preview ${x==="REJECTED"?"rejected":""}`,children:o.body_preview||o.body_text||"Sin preview"}),x==="REJECTED"&&me&&s.jsxs("div",{className:"template-rejection",children:["Rechazada por Meta: ",me]}),s.jsx("div",{className:"template-footer",children:s.jsx("button",{className:"template-action",type:"button",onClick:()=>To(o),children:rt})})]},o.id)}),!bi.length&&s.jsx("div",{className:"empty-state",children:"Sin plantillas disponibles"})]})]}),Oe==="audiences"&&s.jsx("section",{className:"campaigns-panel audiences-panel",children:s.jsxs("div",{className:"audiences-layout",children:[s.jsxs("div",{className:"audiences-list",children:[s.jsxs("label",{className:"audiences-search ui-search",children:[s.jsx("span",{className:"template-search-icon ui-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar lista...",value:Ae,onChange:o=>Pe(o.target.value)})]}),s.jsxs("div",{className:"audience-list",children:[wi.map(o=>{var x;return s.jsxs("button",{type:"button",className:`audience-card ${En===o.id?"active":""}`,onClick:()=>po(o),children:[s.jsxs("div",{className:"audience-title",children:[s.jsx("span",{children:o.name}),s.jsxs("div",{className:"audience-title-actions",children:[s.jsx("span",{className:"audience-count",children:((x=o.count)==null?void 0:x.toLocaleString("es-PE"))||0}),!o.isDefault&&o.type!=="odoo"&&s.jsxs("div",{className:"audience-menu-wrapper",children:[s.jsx("button",{className:"audience-menu",type:"button","aria-label":"Opciones de audiencia",onClick:D=>{D.stopPropagation(),ca(Q=>Q===o.id?null:o.id)},children:"..."}),vi===o.id&&s.jsxs("div",{className:"audience-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>vr(o),children:"Renombrar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>go(o),children:"Eliminar"})]})]})]})]}),s.jsx("div",{className:"audience-subtitle",children:o.subtitle})]},o.id)}),!wi.length&&s.jsx("div",{className:"empty-state",children:"Sin audiencias disponibles"})]})]}),s.jsxs("div",{className:"audiences-table-panel",children:[s.jsxs("div",{className:"audiences-filters",children:[s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ETIQUETA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>pa("tag",["Todas","Con etiquetas","Sin etiquetas"]),children:kt.tag})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"FECHA:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>pa("date",["Cualquier fecha","ltimos 30 das"]),children:kt.date})]}),s.jsxs("div",{className:"audiences-filter",children:[s.jsx("span",{children:"ESTADO:"}),s.jsx("button",{className:"audiences-filter-chip",type:"button",onClick:()=>pa("status",["Activos","Inactivos"]),children:kt.status})]}),s.jsxs("div",{className:"audiences-filter-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Descargar",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button","aria-label":"Actualizar",onClick:mo,children:""})]})]}),s.jsxs("div",{className:"audiences-search-row",children:[s.jsxs("label",{className:"audiences-search-field ui-search",children:[s.jsx("span",{className:"template-search-icon ui-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar contacto en esta lista...",value:us,onChange:o=>{hd(o.target.value),st(1)}})]}),s.jsxs("div",{className:"audiences-total",children:[ra.toLocaleString("es-PE")," contactos en total"]})]}),s.jsxs("div",{className:"audiences-bulk",children:[s.jsxs("div",{className:"audiences-bulk-info",children:[Fn.length," seleccionados"]}),s.jsxs("select",{className:"audiences-bulk-select",value:ia,onChange:o=>Xe(o.target.value),children:[s.jsx("option",{value:"",children:"Selecciona audiencia destino..."}),ki.map(o=>s.jsx("option",{value:o.id,children:o.name},`bulk-${o.id}`))]}),s.jsx("button",{className:"audiences-bulk-btn",type:"button",disabled:Ws||!Fn.length||!An||An===ps,onClick:()=>va("add"),children:"Aadir"}),s.jsx("button",{className:"audiences-bulk-btn",type:"button",disabled:Ws||!Fn.length||!An||An===ps,onClick:()=>va("move"),children:"Mover"}),s.jsx("button",{className:"audiences-bulk-btn danger",type:"button",disabled:Ws||!Fn.length||!ps,onClick:()=>va("remove"),children:"Eliminar"})]}),(ct==null?void 0:ct.type)==="odoo"&&s.jsx("div",{className:"audiences-bulk-note",children:"Las acciones masivas solo aplican a contactos con conversacin de WhatsApp."}),s.jsxs("div",{className:"audiences-table",children:[s.jsxs("div",{className:"audiences-table-head",children:[s.jsx("span",{children:s.jsx("input",{ref:ua,type:"checkbox","aria-label":"Seleccionar todos",checked:Js.length>0&&Vs.size===Js.length,onChange:o=>xo(o.target.checked)})}),s.jsx("span",{children:"CONTACTO"}),s.jsx("span",{children:"WHATSAPP"}),s.jsx("span",{children:"ETIQUETAS"}),s.jsx("span",{children:"FECHA REGISTRO"}),s.jsx("span",{children:"ESTADO"}),s.jsx("span",{})]}),gi&&s.jsx("div",{className:"loading",children:"Cargando contactos..."}),!gi&&os.length===0&&s.jsx("div",{className:"empty-state",children:"No hay contactos en esta audiencia."}),!gi&&os.map(o=>{const x=o.name||"Sin nombre",D=o.email||"",Q=o.phone_e164||o.phone||"-",Z=Array.isArray(o.tags)?o.tags:o.tags?[o.tags]:[],me=x.trim().slice(0,1).toUpperCase(),rt=o.conversation_id||o.conversationId||"";return s.jsxs("div",{className:"audiences-table-row",children:[s.jsx("input",{type:"checkbox","aria-label":"Seleccionar contacto",checked:Vs.has(rt),onChange:()=>yo(o),disabled:!rt}),s.jsxs("div",{className:"audiences-contact",children:[s.jsx("div",{className:"audiences-avatar",children:me}),s.jsxs("div",{className:"audiences-contact-info",children:[s.jsx("div",{className:"audiences-contact-name",children:x}),D&&s.jsx("div",{className:"audiences-contact-email",children:D})]})]}),s.jsx("div",{children:Q}),s.jsx("div",{className:"audiences-tags",children:Z.length?Z.map(Rt=>s.jsx("span",{className:"audiences-tag",children:Rt},`${o.id}-${Rt}`)):s.jsx("span",{className:"audiences-tag empty",children:""})}),s.jsx("div",{children:o.created_at?M(o.created_at):""}),s.jsx("div",{className:"audiences-status",children:(o.status||"ACTIVO").toUpperCase()}),s.jsxs("div",{className:"audiences-menu-wrapper",children:[s.jsx("button",{className:"audiences-menu",type:"button","aria-label":"Opciones",onClick:()=>bo(o.id),disabled:!o.id,children:"..."}),Ge===o.id&&s.jsxs("div",{className:"audiences-menu-dropdown",children:[s.jsx("button",{type:"button",onClick:()=>Co(o),children:"Editar"}),s.jsx("button",{type:"button",className:"danger",onClick:()=>ya(o),children:"Eliminar"})]})]})]},o.id||Q)})]}),s.jsxs("div",{className:"audiences-pagination",children:[s.jsxs("div",{className:"audiences-page-info",children:["Pgina ",ot," de ",Ks]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:ot<=1,onClick:()=>st(o=>Math.max(1,o-1)),children:"<"}),hs.map(o=>s.jsx("button",{className:`audiences-page-btn ${o===ot?"active":""}`,type:"button",onClick:()=>st(o),children:o},`aud-page-${o}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:ot>=Ks,onClick:()=>st(o=>Math.min(Ks,o+1)),children:">"})]})]})]})]})}),Oe==="new"&&s.jsx("section",{className:"campaigns-panel campaigns-module",children:L?s.jsxs("div",{className:"campaigns-launch",children:[s.jsxs("form",{className:"campaigns-launch-form",ref:St,onSubmit:Ao,children:[s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"1"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Nombre de la Campaa"}),s.jsx("input",{type:"text",placeholder:"Ej: Promocin Black Friday 2024",value:e.name,onChange:o=>t(x=>({...x,name:o.target.value}))})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"2"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Seleccionar Audiencia"}),s.jsxs("select",{value:No,onChange:o=>gs(o.target.value),children:[s.jsx("option",{value:"",children:"Selecciona un segmento..."}),mt.filter(o=>o.type!=="odoo").map(o=>s.jsx("option",{value:`segment:${o.id}`,children:o.name},`seg-${o.id}`)),s.jsx("option",{value:"verified",children:"Solo verificados"}),s.jsx("option",{value:"assigned:unassigned",children:"Sin asignar"})]})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"3"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Elegir Plantilla de Meta"}),s.jsxs("div",{className:"launch-template-search ui-search",children:[s.jsx("span",{className:"template-search-icon ui-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar plantilla...",value:G,onChange:o=>ne(o.target.value)}),s.jsx("button",{type:"button",onClick:()=>ne(""),children:"Limpiar"})]}),s.jsx("div",{className:"launch-templates-scroll",children:s.jsxs("div",{className:"launch-templates",children:[Ci.map(o=>{const x=o.status||"APPROVED",D=Zi[x]||Zi.APPROVED,Q=e.template_id===o.id;return s.jsxs("button",{className:`launch-template ${Q?"selected":""}`,type:"button",onClick:()=>wo(o.id),children:[s.jsx("div",{className:"launch-template-icon"}),s.jsx("div",{className:"launch-template-title",children:o.name}),s.jsx("div",{className:"launch-template-preview",children:o.body_preview||o.body_text||"Sin preview"}),s.jsx("span",{className:`launch-template-status ${D.className}`,children:D.label})]},o.id)}),Ci.length===0&&s.jsx("div",{className:"launch-empty",children:"Sin plantillas"})]})})]})]}),s.jsxs("div",{className:"launch-step",children:[s.jsx("span",{className:"launch-step-number",children:"4"}),s.jsxs("div",{className:"launch-card",children:[s.jsx("div",{className:"launch-step-title",children:"Programacin"}),s.jsxs("div",{className:"launch-schedule",children:[s.jsx("button",{className:`launch-schedule-option ${cn==="now"?"active":""}`,type:"button",onClick:()=>{Qt("now"),t(o=>({...o,scheduled_for:"",send_now:!0}))},children:"Enviar Ahora"}),s.jsx("button",{className:`launch-schedule-option ${cn==="schedule"?"active":""}`,type:"button",onClick:()=>{Qt("schedule"),t(o=>({...o,send_now:!1}))},children:"Programar Envo"})]}),cn==="schedule"&&s.jsx("input",{type:"datetime-local",value:e.scheduled_for,onChange:o=>t(x=>({...x,scheduled_for:o.target.value,send_now:!1}))})]})]})]}),s.jsxs("aside",{className:"campaigns-launch-preview",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:"Nombre del Cliente"}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(v==null?void 0:v.body_preview)||(v==null?void 0:v.body_text)||"Selecciona una plantilla para ver el contenido."}),_i.length>0&&s.jsx("div",{className:"preview-actions",children:_i.map((o,x)=>s.jsx("button",{type:"button",children:o.text||o.label||o.title||`Botn ${x+1}`},`preview-btn-${x}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Destinatarios"}),s.jsx("strong",{children:(ms==null?void 0:ms.count)||0})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:(v==null?void 0:v.name)||"Sin plantilla"})]})]})]})]}):s.jsxs("div",{className:"campaigns-dashboard",children:[s.jsxs("aside",{className:"campaigns-sidebar",children:[s.jsxs("label",{className:"campaigns-search ui-search",children:[s.jsx("span",{className:"template-search-icon ui-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar campaa...",value:ee,onChange:o=>he(o.target.value)})]}),s.jsxs("div",{className:"campaigns-filters-list",children:[s.jsxs("button",{className:`campaigns-filter-item ${ce==="all"?"active":""}`,type:"button",onClick:()=>be("all"),children:[s.jsx("span",{children:"Todas las Campaas"}),s.jsx("span",{className:"campaigns-filter-count",children:Xs.all})]}),s.jsxs("button",{className:`campaigns-filter-item ${ce==="completed"?"active":""}`,type:"button",onClick:()=>be("completed"),children:[s.jsx("span",{children:"Enviadas"}),s.jsx("span",{className:"campaigns-filter-count",children:Xs.completed})]}),s.jsxs("button",{className:`campaigns-filter-item ${ce==="scheduled"?"active":""}`,type:"button",onClick:()=>be("scheduled"),children:[s.jsx("span",{children:"Programadas"}),s.jsx("span",{className:"campaigns-filter-count",children:Xs.scheduled})]}),s.jsxs("button",{className:`campaigns-filter-item ${ce==="draft"?"active":""}`,type:"button",onClick:()=>be("draft"),children:[s.jsx("span",{children:"Borradores"}),s.jsx("span",{className:"campaigns-filter-count",children:Xs.draft})]}),s.jsxs("button",{className:`campaigns-filter-item ${ce==="failed"?"active":""}`,type:"button",onClick:()=>be("failed"),children:[s.jsx("span",{children:"Fallidas"}),s.jsx("span",{className:"campaigns-filter-count",children:Xs.failed})]})]}),s.jsxs("div",{className:"campaigns-quota",children:[s.jsx("div",{className:"campaigns-quota-title",children:"Cuota de mensajes"}),s.jsx("div",{className:"campaigns-quota-bar",children:s.jsx("div",{className:"campaigns-quota-fill",style:{width:"65%"}})}),s.jsx("div",{className:"campaigns-quota-meta",children:"65% usado"})]})]}),s.jsxs("div",{className:"campaigns-table-panel",children:[s.jsxs("div",{className:"campaigns-table-filters",children:[s.jsx("div",{className:"campaigns-filter-chip",children:"Canal: WhatsApp Business"}),s.jsx("div",{className:"campaigns-filter-chip",children:"Periodo: ltimos 30 das"}),s.jsxs("div",{className:"campaigns-table-actions",children:[s.jsx("button",{className:"audiences-icon-btn",type:"button",children:""}),s.jsx("button",{className:"audiences-icon-btn",type:"button",onClick:()=>O(lt,et,ee.trim()),children:""})]})]}),s.jsxs("div",{className:"campaigns-table",children:[s.jsxs("div",{className:"campaigns-table-head",children:[s.jsx("span",{children:"Campaa"}),s.jsx("span",{children:"Fecha"}),s.jsx("span",{children:"Audiencia"}),s.jsx("span",{children:"Enviados"}),s.jsx("span",{children:"Ledos"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{})]}),xr.map(o=>{const x=o.messages_count||o.audience_count||"--",D=o.read_count||"--",Q=o.reply_count||"--",Z=Ys(o.status),me=Ch[Z]||Z,rt=["running","sending"].includes(Z),Rt=["completed","failed"].includes(Z),Yt=!rt,jr=!rt;return s.jsxs("div",{className:"campaigns-table-row",children:[s.jsxs("div",{className:"campaigns-table-title",children:[s.jsx("div",{className:"campaigns-table-name",children:o.name}),s.jsxs("div",{className:"campaigns-table-ref",children:["Ref: ",o.id.slice(0,10)]})]}),s.jsx("div",{className:"campaigns-table-date",children:M(o.created_at)}),s.jsx("div",{className:"campaigns-table-tags",children:s.jsx("span",{className:"campaigns-pill",children:o.audience_label||"Base General"})}),s.jsx("div",{className:"campaigns-metric",children:x}),s.jsx("div",{className:"campaigns-metric",children:D}),s.jsx("div",{className:"campaigns-metric",children:Q}),s.jsx("div",{className:`campaigns-status ${Z}`,children:me}),s.jsx("div",{className:"campaigns-row-actions",children:s.jsxs("div",{className:"campaigns-row-menu",children:[s.jsx("button",{className:"campaigns-row-menu-btn",type:"button","aria-label":"Opciones",onClick:Nr=>ko(o.id,Nr),children:"..."}),le===o.id&&s.jsxs("div",{className:`campaigns-row-dropdown ${X==="up"?"drop-up":""}`,children:[Yt&&s.jsx("button",{type:"button",onClick:()=>{_o(o),fe(null)},children:"Editar"}),Rt&&s.jsx("button",{type:"button",onClick:()=>{Zs(o),fe(null)},children:"Reenviar"}),jr&&s.jsx("button",{type:"button",className:"danger",onClick:()=>{So(o),fe(null)},children:"Eliminar"})]})]})})]},o.id)}),!xr.length&&s.jsx("div",{className:"empty-state",children:"Sin campaas registradas"})]}),s.jsxs("div",{className:"campaigns-table-footer",children:[s.jsxs("span",{children:["Mostrando ",xr.length," de"," ",b||i.length," campaas"]}),s.jsxs("div",{className:"audiences-page-actions",children:[s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:lt<=1,onClick:()=>{const o=Math.max(1,lt-1);un(o),O(o,et,ee.trim())},children:"<"}),fs.pages.map(o=>s.jsx("button",{className:`audiences-page-btn ${o===lt?"active":""}`,type:"button",onClick:()=>{un(o),O(o,et,ee.trim())},children:o},`camp-page-${o}`)),s.jsx("button",{className:"audiences-page-btn",type:"button",disabled:lt>=fs.totalPages,onClick:()=>{const o=Math.min(fs.totalPages,lt+1);un(o),O(o,et,ee.trim())},children:">"})]})]})]})]})}),Oe==="history"&&s.jsxs("section",{className:"campaigns-panel campaigns-history",children:[s.jsxs("div",{className:"campaigns-history-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"campaigns-history-title",children:"Historial de Envos"}),s.jsx("div",{className:"campaigns-history-subtitle",children:"ltimos 30 das"})]}),s.jsx("button",{className:"campaigns-link",type:"button",onClick:O,children:"Ver todo el historial"})]}),s.jsxs("div",{className:"history-table history-table--main",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"Campaa / Fecha"}),s.jsx("span",{children:"Alcance"}),s.jsx("span",{children:"Tasa de lectura"}),s.jsx("span",{children:"Respuestas"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),i.map(o=>{const x=Ch[o.status]||o.status,D=o.audience_count||o.messages_count||o.total||"--";return s.jsxs("div",{className:"history-row",children:[s.jsxs("div",{className:"history-title",children:[s.jsx("div",{className:"history-name",children:o.name}),s.jsx("div",{className:"history-date",children:M(o.created_at)})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:D}),s.jsx("div",{className:"history-label",children:"contactos"})]}),s.jsxs("div",{className:"history-meter",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-bar",children:s.jsx("div",{className:"history-bar-fill",style:{width:"0%"}})})]}),s.jsxs("div",{className:"history-metric",children:[s.jsx("div",{className:"history-value",children:"--"}),s.jsx("div",{className:"history-label",children:"mensajes"})]}),s.jsx("div",{className:`history-status ${o.status}`,children:x}),s.jsxs("div",{className:"history-actions",children:[s.jsx("button",{className:"campaigns-ghost small",type:"button",onClick:()=>P(o.id),children:"Ver mensajes"}),s.jsx("button",{className:"campaigns-danger small",type:"button",onClick:()=>C(o.id),disabled:o.status==="sending",children:"Enviar"})]})]},o.id)}),!i.length&&s.jsx("div",{className:"empty-state",children:"Sin Campaas registradas"})]}),l&&s.jsxs("div",{className:"campaigns-messages",children:[s.jsx("div",{className:"campaigns-history-title",children:"Mensajes"}),s.jsxs("div",{className:"history-table history-table--messages",children:[s.jsxs("div",{className:"history-head",children:[s.jsx("span",{children:"WA"}),s.jsx("span",{children:"Status"}),s.jsx("span",{children:"Enviado"})]}),c.map(o=>s.jsxs("div",{className:"history-row",children:[s.jsx("span",{children:o.wa_id}),s.jsx("span",{children:o.status}),s.jsx("span",{children:M(o.sent_at)})]},o.id))]})]})]})]})})]}),oe&&s.jsx("div",{className:"modal-overlay",onClick:()=>pe(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Previsualizar plantilla"}),s.jsx("button",{className:"modal-close",onClick:()=>pe(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:j}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(ke==null?void 0:ke.body_preview)||(ke==null?void 0:ke.body_text)||"Sin previsualizacin disponible."}),Si.length>0&&s.jsx("div",{className:"preview-actions",children:Si.map((o,x)=>s.jsx("button",{type:"button",children:o.text||o.label||o.title||`Botn ${x+1}`},`preview-modal-btn-${x}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})}),Bt&&s.jsx("div",{className:"modal-overlay",onClick:()=>Gt(!1),children:s.jsxs("div",{className:"modal-content",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Editar contacto"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>Gt(!1),children:"x"})]}),s.jsxs("form",{className:"modal-body",onSubmit:Eo,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:Ke.name,onChange:o=>zt(x=>({...x,name:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Telfono"}),s.jsx("input",{type:"text",value:Ke.phone,onChange:o=>zt(x=>({...x,phone:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:Ke.email,onChange:o=>zt(x=>({...x,email:o.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"CI / NIT"}),s.jsx("input",{type:"text",value:Ke.vat,onChange:o=>zt(x=>({...x,vat:o.target.value}))})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{className:"btn-secondary",type:"button",onClick:()=>Gt(!1),children:"Cancelar"}),s.jsx("button",{className:"btn-primary",type:"submit",disabled:_n,children:_n?"Guardando...":"Guardar"})]})]})]})})]})}function Wa({variant:e="error",title:t,message:n,actionLabel:r,onAction:a,dismissLabel:i="Cerrar",onDismiss:l}){const c=e==="offline"?"x":"!";return s.jsxs("div",{className:`notice-banner notice-banner-${e}`,children:[s.jsx("div",{className:"notice-icon","aria-hidden":"true",children:c}),s.jsxs("div",{className:"notice-content",children:[t?s.jsx("div",{className:"notice-title",children:t}):null,s.jsx("div",{className:"notice-text",children:n})]}),s.jsxs("div",{className:"notice-actions",children:[r&&s.jsx("button",{className:"notice-action",type:"button",onClick:a,children:r}),l&&s.jsx("button",{className:"notice-close",type:"button",onClick:l,children:i})]})]})}const sy={admin:{title:"Administrador",subtitle:"Acceso total",tone:"alert"},recepcion:{title:"Operador",subtitle:"Atencion al cliente",tone:"info"},caja:{title:"Supervisor",subtitle:"Auditoria y gestion",tone:"dark"},marketing:{title:"Marketing",subtitle:"Crecimiento y campanas",tone:"info"},doctor:{title:"Doctor",subtitle:"Atencion al cliente",tone:"dark"}},Th=[{id:"chat",label:"Chat"},{id:"dashboard",label:"Dashboard"},{id:"campaigns",label:"Campanas"}],Lh=[{id:"general",label:"Lineas"},{id:"users",label:"Gestion de Usuarios"},{id:"bot",label:"Configuracion de Bot"},{id:"templates",label:"Plantillas de Meta"},{id:"audit",label:"Registros / Auditoria"},{id:"odoo",label:"Integracion Odoo"}];function Rh(e){return sy[e]||{title:e,subtitle:"Acceso personalizado",tone:"info"}}function ry({settingsTab:e,setSettingsTab:t,rolePermissions:n,setRolePermissions:r,isAdmin:a,adminUsers:i,userForm:l,setUserForm:c,roleOptions:u,handleUserSubmit:p,handleUserDelete:_,defaultRolePermissions:v,handleRoleDelete:N}){const[A,O]=h.useState(""),[P,C]=h.useState(!1),[m,f]=h.useState(""),[y,b]=h.useState(null),[M,z]=h.useState(!1),[j,g]=h.useState("create"),[B,T]=h.useState("recepcion"),[K,oe]=h.useState({modules:{},settings:{}}),pe=h.useMemo(()=>{const L=A.trim().toLowerCase(),H=i||[];return L?H.filter(k=>{var ne,le;const U=((ne=k.name)==null?void 0:ne.toLowerCase())||"",G=((le=k.email)==null?void 0:le.toLowerCase())||"";return U.includes(L)||G.includes(L)}):H},[i,A]);function ke(L){const H=(n==null?void 0:n[L])||(v==null?void 0:v[L])||{modules:{},settings:{}};return{modules:{...H.modules||{}},settings:{...H.settings||{}}}}function Ee(L,H="edit"){g(H),T(L),oe(ke(L)),z(!0)}function Ae(L,H,k){oe(U=>{const G={...U},ne={...G[L]||{}},le={...ne[H]||{}},fe=!le[k];return le[k]=fe,k==="write"&&fe&&(le.read=!0),k==="read"&&!fe&&(le.write=!1),ne[H]=le,G[L]=ne,G})}function Pe(){B&&(r(L=>({...L,[B]:K})),z(!1))}function V(){B&&N&&N(B),z(!1)}function te(L,H,k,U){a&&r(G=>{var Ge,ve;const ne={...G},le={modules:{...(Ge=ne[L])==null?void 0:Ge.modules},settings:{...(ve=ne[L])==null?void 0:ve.settings}},fe={...le[H]},X={...fe[k]},Me=!X[U];return X[U]=Me,U==="write"&&Me&&(X.read=!0),U==="read"&&!Me&&(X.write=!1),fe[k]=X,le[H]=fe,ne[L]=le,ne})}function ee(L){return Rh(L).title.toUpperCase()}function he(L,H){return L!=null&&L.id?`OP-${L.id.slice(-4).toUpperCase()}`:`OP-${String(H+1).padStart(4,"0")}`}function ce(L){c({id:L.id,name:L.name,email:L.email,role:L.role,password:"",is_active:L.is_active}),C(!0)}function be(){c({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),C(!0)}return s.jsxs("div",{className:"users-page",children:[s.jsxs("header",{className:"users-header",children:[s.jsxs("div",{className:"users-title-row",children:[s.jsx("span",{className:"users-kicker"}),s.jsxs("div",{children:[s.jsx("div",{className:"users-title",children:"Gestion de Usuarios"}),s.jsx("div",{className:"users-subtitle",children:"Administra los accesos y roles de los operadores de tu empresa."})]})]}),s.jsxs("div",{className:"users-actions",children:[e==="list"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"users-search",children:[s.jsx("span",{className:"users-search-icon","aria-hidden":"true"}),s.jsx("input",{type:"text",placeholder:"Buscar usuario...",value:A,onChange:L=>O(L.target.value)})]}),s.jsx("button",{className:"settings-primary",type:"button",onClick:be,children:"Nuevo Usuario"})]}),e==="roles"&&s.jsx("button",{className:"settings-primary",type:"button",onClick:()=>Ee("recepcion","create"),children:"+ Nuevo Rol"})]})]}),s.jsxs("div",{className:"users-tabs",children:[s.jsx("button",{className:`users-tab ${e==="list"?"active":""}`,type:"button",onClick:()=>t("list"),children:"Lista de Usuarios"}),s.jsx("button",{className:`users-tab ${e==="roles"?"active":""}`,type:"button",onClick:()=>t("roles"),children:"Roles y Permisos"})]}),e==="list"&&s.jsxs("div",{className:"users-table",children:[s.jsxs("div",{className:"users-table-head",children:[s.jsx("span",{children:"Nombre / Usuario"}),s.jsx("span",{children:"Email"}),s.jsx("span",{children:"Rol"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),pe.map((L,H)=>{var k;return s.jsxs("div",{className:"users-row",children:[s.jsxs("div",{className:"users-cell user-name",children:[s.jsx("div",{className:"user-avatar",children:((k=L.name)==null?void 0:k[0])||"?"}),s.jsxs("div",{children:[s.jsx("div",{className:"user-title",children:L.name}),s.jsx("div",{className:"user-id",children:he(L,H)})]})]}),s.jsx("div",{className:"users-cell",children:L.email}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`role-pill ${L.role}`,children:ee(L.role)})}),s.jsx("div",{className:"users-cell",children:s.jsx("span",{className:`status-pill ${L.is_active?"active":"inactive"}`,children:L.is_active?"Activo":"Inactivo"})}),s.jsx("div",{className:"users-cell",children:s.jsxs("div",{className:"users-actions-menu",children:[s.jsx("button",{className:"users-action",type:"button",onClick:()=>f(U=>U===L.id?"":L.id),children:"..."}),m===L.id&&s.jsxs("div",{className:"users-menu",children:[s.jsx("button",{type:"button",onClick:()=>{f(""),ce(L)},children:"Editar"}),s.jsx("button",{type:"button",onClick:()=>{f(""),b(L)},children:"Eliminar"})]})]})})]},L.id)}),!pe.length&&s.jsx("div",{className:"empty-state",children:"Sin usuarios para mostrar"})]}),e==="roles"&&s.jsx("div",{className:"roles-grid",children:u.map(L=>{const H=Rh(L),k=n==null?void 0:n[L];return s.jsxs("div",{className:"role-card",children:[s.jsxs("div",{className:"role-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"role-title",children:H.title}),s.jsx("div",{className:`role-subtitle ${H.tone}`,children:H.subtitle})]}),s.jsx("button",{className:"role-edit",type:"button",onClick:()=>Ee(L,"edit"),children:"edit"})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),Th.map(U=>{var G,ne,le,fe;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ne=(G=k==null?void 0:k.modules)==null?void 0:G[U.id])==null?void 0:ne.read)||!1,disabled:!a,onChange:()=>te(L,"modules",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((fe=(le=k==null?void 0:k.modules)==null?void 0:le[U.id])==null?void 0:fe.write)||!1,disabled:!a,onChange:()=>te(L,"modules",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsx("div",{className:"role-settings-title",children:"Configuracion"}),Lh.map(U=>{var G,ne,le,fe;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:U.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((ne=(G=k==null?void 0:k.settings)==null?void 0:G[U.id])==null?void 0:ne.read)||!1,disabled:!a,onChange:()=>te(L,"settings",U.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((fe=(le=k==null?void 0:k.settings)==null?void 0:le[U.id])==null?void 0:fe.write)||!1,disabled:!a,onChange:()=>te(L,"settings",U.id,"write")}),s.jsx("span",{})]})]},U.id)})]})]},L)})}),P&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:l.id?"Editar usuario":"Crear usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>C(!1),children:"x"})]}),s.jsxs("form",{className:"form-grid",onSubmit:async L=>{await p(L),C(!1)},children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre"}),s.jsx("input",{type:"text",value:l.name,onChange:L=>c(H=>({...H,name:L.target.value}))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:l.email,onChange:L=>c(H=>({...H,email:L.target.value})),disabled:!!l.id})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),s.jsx("select",{value:l.role,onChange:L=>c(H=>({...H,role:L.target.value})),children:u.map(L=>s.jsx("option",{value:L,children:L},L))})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:l.password,onChange:L=>c(H=>({...H,password:L.target.value}))})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:l.is_active,onChange:L=>c(H=>({...H,is_active:L.target.checked}))}),"Activo"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"primary",type:"submit",children:l.id?"Guardar cambios":"Crear"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>C(!1),children:"Cancelar"})]})]})]})}),y&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:"Eliminar usuario"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>b(null),children:"x"})]}),s.jsxs("p",{className:"modal-text",children:["Vas a desactivar a ",s.jsx("strong",{children:y.email}),". Continuar?"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"danger",type:"button",onClick:()=>{_==null||_(y.id),b(null)},children:"Eliminar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>b(null),children:"Cancelar"})]})]})}),M&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-card modal-lg",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("div",{className:"modal-title",children:j==="create"?"Nuevo rol":"Editar rol"}),s.jsx("button",{className:"modal-close",type:"button",onClick:()=>z(!1),children:"x"})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Rol"}),j==="edit"?s.jsx("select",{value:B,disabled:!0,children:u.map(L=>s.jsx("option",{value:L,children:L},L))}):s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"text",list:"role-options",placeholder:"nuevo-rol",value:B,onChange:L=>T(L.target.value)}),s.jsx("datalist",{id:"role-options",children:u.map(L=>s.jsx("option",{value:L},L))})]})]}),s.jsxs("div",{className:"role-permissions",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Modulos"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),Th.map(L=>{var H,k,U,G;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:L.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((k=(H=K==null?void 0:K.modules)==null?void 0:H[L.id])==null?void 0:k.read)||!1,onChange:()=>Ae("modules",L.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((G=(U=K==null?void 0:K.modules)==null?void 0:U[L.id])==null?void 0:G.write)||!1,onChange:()=>Ae("modules",L.id,"write")}),s.jsx("span",{})]})]},L.id)})]}),s.jsxs("div",{className:"role-settings",children:[s.jsxs("div",{className:"perm-head",children:[s.jsx("span",{children:"Configuracion"}),s.jsx("span",{children:"Lectura"}),s.jsx("span",{children:"Escritura"})]}),Lh.map(L=>{var H,k,U,G;return s.jsxs("div",{className:"perm-row",children:[s.jsx("span",{children:L.label}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((k=(H=K==null?void 0:K.settings)==null?void 0:H[L.id])==null?void 0:k.read)||!1,onChange:()=>Ae("settings",L.id,"read")}),s.jsx("span",{})]}),s.jsxs("label",{className:"perm-toggle",children:[s.jsx("input",{type:"checkbox",checked:((G=(U=K==null?void 0:K.settings)==null?void 0:U[L.id])==null?void 0:G.write)||!1,onChange:()=>Ae("settings",L.id,"write")}),s.jsx("span",{})]})]},L.id)})]})]}),s.jsxs("div",{className:"form-actions",children:[j==="edit"&&s.jsx("button",{className:"danger",type:"button",onClick:V,children:"Eliminar rol"}),s.jsx("button",{className:"primary",type:"button",onClick:Pe,disabled:!B,children:"Guardar"}),s.jsx("button",{className:"ghost",type:"button",onClick:()=>z(!1),children:"Cancelar"})]})]})})]})}const Oh={id:"",display_name:"",is_default:!1,is_active:!0};function ay(e){if(!e)return"Sin fecha";const t=new Date(e);return Number.isNaN(t.getTime())?"Sin fecha":t.toLocaleDateString("es-BO",{day:"2-digit",month:"short",year:"numeric"})}function Aa(e){return e!=null&&e.display_name?e.display_name:`Linea ${e!=null&&e.phone_number_id?String(e.phone_number_id).slice(-4):"----"}`}function iy({tenantChannels:e=[],channelForm:t=Oh,setChannelForm:n,handleChannelSelect:r,handleChannelSubmit:a,handleChannelQuickUpdate:i}){const[l,c]=h.useState(""),[u,p]=h.useState("all"),[_,v]=h.useState(""),[N,A]=h.useState("");h.useEffect(()=>{function j(B){B.target.closest(".line-actions-menu-wrap")||A("")}function g(B){B.key==="Escape"&&A("")}return document.addEventListener("mousedown",j),document.addEventListener("keydown",g),()=>{document.removeEventListener("mousedown",j),document.removeEventListener("keydown",g)}},[]);const O=h.useMemo(()=>e.find(j=>j.id===t.id)||null,[e,t.id]),P=h.useMemo(()=>{const j=e.length,g=e.filter(T=>T.is_active).length,B=e.find(T=>T.is_default);return{total:j,active:g,inactive:j-g,primaryName:B?Aa(B):"Sin principal"}},[e]),C=h.useMemo(()=>{const j=l.trim().toLowerCase();return[...e].filter(g=>u==="active"&&!g.is_active||u==="inactive"&&g.is_active?!1:j?[g.display_name||"",g.phone_number_id||"",g.waba_id||""].join(" ").toLowerCase().includes(j):!0).sort((g,B)=>{const T=+!!B.is_default-+!!g.is_default;if(T!==0)return T;const K=+!!B.is_active-+!!g.is_active;return K!==0?K:Aa(g).localeCompare(Aa(B),"es")})},[e,l,u]);async function m(j){var B;if(!j)return;const g=String(j);try{if(typeof navigator<"u"&&((B=navigator.clipboard)!=null&&B.writeText))await navigator.clipboard.writeText(g);else if(typeof document<"u"){const T=document.createElement("textarea");T.value=g,T.setAttribute("readonly",""),T.style.position="absolute",T.style.left="-9999px",document.body.appendChild(T),T.select(),document.execCommand("copy"),document.body.removeChild(T)}v(g),setTimeout(()=>{v(T=>T===g?"":T)},1600)}catch{v("")}}function f(j){r(j),A("")}async function y(j){await m(j.phone_number_id),A("")}async function b(j){await i(j.id,{is_default:!0}),A("")}async function M(j){await i(j.id,{is_active:!j.is_active}),A("")}function z(){n(Oh)}return s.jsxs("section",{className:"general-lines-shell",children:[s.jsxs("div",{className:"general-lines-header",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"general-lines-title",children:"Lineas de WhatsApp"}),s.jsx("p",{className:"general-lines-description",children:"Gestiona nombres visibles, estado operativo y linea principal para tus conversaciones."})]}),s.jsxs("div",{className:"general-lines-stats",children:[s.jsxs("div",{className:"line-stat",children:[s.jsx("span",{children:"Total"}),s.jsx("strong",{children:P.total})]}),s.jsxs("div",{className:"line-stat",children:[s.jsx("span",{children:"Activas"}),s.jsx("strong",{children:P.active})]}),s.jsxs("div",{className:"line-stat",children:[s.jsx("span",{children:"Inactivas"}),s.jsx("strong",{children:P.inactive})]}),s.jsxs("div",{className:"line-stat line-stat-wide",children:[s.jsx("span",{children:"Principal"}),s.jsx("strong",{children:P.primaryName})]})]})]}),s.jsxs("div",{className:"page-grid general-lines-grid",children:[s.jsxs("div",{className:"panel general-lines-panel",children:[s.jsx("div",{className:"panel-title",children:"Listado de lineas"}),s.jsxs("div",{className:"general-lines-filters",children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Buscar linea"}),s.jsx("input",{type:"text",placeholder:"Nombre, Phone ID o WABA ID",value:l,onChange:j=>c(j.target.value)})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Estado"}),s.jsxs("select",{value:u,onChange:j=>p(j.target.value),children:[s.jsx("option",{value:"all",children:"Todas"}),s.jsx("option",{value:"active",children:"Activas"}),s.jsx("option",{value:"inactive",children:"Inactivas"})]})]})]}),s.jsx("div",{className:"general-lines-table-wrap",children:s.jsxs("div",{className:"table",children:[s.jsxs("div",{className:"table-head general-lines-table-head",children:[s.jsx("span",{children:"Linea"}),s.jsx("span",{children:"Phone ID"}),s.jsx("span",{children:"Estado"}),s.jsx("span",{children:"Acciones"})]}),C.map(j=>s.jsxs("div",{className:"table-row general-lines-row",children:[s.jsxs("div",{className:"line-cell",children:[s.jsx("div",{className:"line-main-name",children:Aa(j)}),s.jsxs("div",{className:"line-meta",children:[j.is_default?s.jsx("span",{className:"line-pill default",children:"Principal"}):null,j.waba_id?s.jsxs("span",{className:"line-pill",children:["WABA ",j.waba_id]}):null,s.jsxs("span",{className:"line-pill",children:["Creada ",ay(j.created_at)]})]})]}),s.jsx("span",{className:"line-phone-id",children:j.phone_number_id}),s.jsx("span",{children:s.jsx("span",{className:`line-pill ${j.is_active?"active":"inactive"}`,children:j.is_active?"Activa":"Inactiva"})}),s.jsxs("div",{className:"line-actions-menu-wrap",children:[s.jsx("button",{type:"button",className:"line-more-btn","aria-label":`Abrir acciones de ${Aa(j)}`,onClick:()=>A(g=>g===j.id?"":j.id),children:s.jsx("span",{"aria-hidden":"true",children:"..."})}),N===j.id?s.jsxs("div",{className:"line-actions-menu",role:"menu",children:[s.jsx("button",{type:"button",className:"line-actions-menu-item",onClick:()=>f(j),children:"Editar"}),s.jsx("button",{type:"button",className:"line-actions-menu-item",onClick:()=>y(j),children:_===j.phone_number_id?"Copiado":"Copiar ID"}),s.jsx("button",{type:"button",className:"line-actions-menu-item",onClick:()=>b(j),disabled:j.is_default,children:"Marcar principal"}),s.jsx("button",{type:"button",className:"line-actions-menu-item danger",onClick:()=>M(j),children:j.is_active?"Desactivar":"Activar"})]}):null]})]},j.id)),!C.length&&s.jsx("div",{className:"empty-state",children:"No hay lineas que coincidan con los filtros."})]})})]}),s.jsxs("div",{className:"panel general-lines-panel",children:[s.jsx("div",{className:"panel-title",children:t.id?"Editar linea seleccionada":"Selecciona una linea"}),s.jsxs("form",{className:"form-grid",onSubmit:a,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Nombre visible"}),s.jsx("input",{type:"text",value:t.display_name||"",onChange:j=>n(g=>({...g,display_name:j.target.value})),placeholder:"Ej: Linea principal",disabled:!t.id})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Phone ID"}),s.jsx("input",{type:"text",value:(O==null?void 0:O.phone_number_id)||"",readOnly:!0,disabled:!0})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:!!t.is_default,onChange:j=>n(g=>({...g,is_default:j.target.checked})),disabled:!t.id}),"Marcar como principal"]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:!!t.is_active,onChange:j=>n(g=>({...g,is_active:j.target.checked})),disabled:!t.id}),"Linea activa"]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"primary",type:"submit",disabled:!t.id,children:"Guardar cambios"}),s.jsx("button",{className:"ghost",type:"button",disabled:!t.id,onClick:z,children:"Cancelar"})]})]})]})]})]})}function ly(){var O,P,C,m,f,y,b,M,z,j;const[e,t]=h.useState([]),[n,r]=h.useState(null),[a,i]=h.useState(!0),[l,c]=h.useState("");h.useEffect(()=>{u()},[]);async function u(){i(!0);try{const[g,B]=await Promise.all([Ne("/api/admin/bots"),Ne("/api/admin/bots/metrics")]);t(g.bots||[]),r(B.metrics),c("")}catch(g){console.error(g),c(g.message||"Error al cargar datos")}finally{i(!1)}}async function p(g,B){try{await ut(`/api/admin/bots/${g}`,{is_active:B}),t(T=>T.map(K=>K.id===g?{...K,is_active:B}:K))}catch(T){c(T.message||"Error al cambiar estado")}}const _=g=>{if(!g)return"Sin actividad reciente";const B=new Date(g),K=new Date-B,oe=Math.floor(K/6e4);if(oe<1)return"Hace un momento";if(oe<60)return`ltima actividad: hace ${oe} min`;const pe=Math.floor(oe/60);return pe<24?`ltima actividad: hace ${pe}h`:`ltima actividad: ${B.toLocaleDateString()}`},v=e.filter(g=>g.is_active).length,N=v>0?"ACTIVO":"INACTIVO",A=v>0?"active":"inactive";return s.jsxs("div",{className:"bot-section",children:[s.jsxs("div",{className:"bot-section-header",children:[s.jsxs("div",{className:"bot-section-title-area",children:[s.jsx("div",{className:"bot-section-icon",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"bot-section-title",children:"Gestin de Bots"}),s.jsx("p",{className:"bot-section-subtitle",children:"Administra los flujos automatizados y el rendimiento tcnico."})]})]}),s.jsxs("div",{className:"bot-section-global-toggle",children:[s.jsx("span",{className:"bot-toggle-label",children:"ESTADO DEL BOT:"}),s.jsxs("div",{className:`bot-toggle-pill ${A}`,children:[s.jsx("span",{className:"bot-toggle-dot"}),s.jsx("span",{children:N})]})]})]}),l&&s.jsx("div",{className:"bot-error",children:l}),s.jsxs("div",{className:"bot-section-content",children:[s.jsxs("div",{className:"bot-flows-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MONITOREO DE FLUJOS"})}),a?s.jsx("div",{className:"bot-loading",children:"Cargando bots..."}):e.length===0?s.jsxs("div",{className:"bot-empty",children:[s.jsx("p",{children:"No hay bots asignados a tu cuenta."}),s.jsx("p",{className:"bot-empty-hint",children:"Contacta con soporte si necesitas activar un bot."})]}):s.jsx("div",{className:"bot-flows-list",children:e.map(g=>s.jsxs("div",{className:"bot-flow-card",children:[s.jsxs("div",{className:"bot-flow-info",children:[s.jsx("span",{className:"bot-flow-icon",children:g.flow_icon||""}),s.jsxs("div",{children:[s.jsx("div",{className:"bot-flow-name",children:g.flow_name}),s.jsxs("div",{className:`bot-flow-status ${g.is_active?"active":"inactive"}`,children:[" ",g.is_active?"ACTIVO":"INACTIVO"]})]})]}),s.jsx("div",{className:"bot-flow-actions",children:s.jsxs("label",{className:"bot-toggle-switch",children:[s.jsx("input",{type:"checkbox",checked:g.is_active,onChange:()=>p(g.id,!g.is_active)}),s.jsx("span",{className:"bot-toggle-slider"})]})}),s.jsx("div",{className:"bot-flow-meta",children:_(g.updated_at)}),g.flow_description&&s.jsx("div",{className:"bot-flow-desc",children:g.flow_description})]},g.id))})]}),s.jsxs("div",{className:"bot-metrics-panel",children:[s.jsx("div",{className:"bot-panel-header",children:s.jsx("span",{className:"bot-panel-title",children:"MTRICAS DE EFICACIA DETALLADAS"})}),s.jsxs("div",{className:"bot-metrics-grid",children:[s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:`bot-metric-badge ${((O=n==null?void 0:n.interactions)==null?void 0:O.change)>=0?"positive":"neutral"}`,children:[((P=n==null?void 0:n.interactions)==null?void 0:P.change)>0?"+":"",(C=n==null?void 0:n.interactions)==null?void 0:C.change,"% ",(m=n==null?void 0:n.interactions)==null?void 0:m.label]}),s.jsx("div",{className:"bot-metric-label",children:"INTERACCIONES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.interactions.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"Total de sesiones iniciadas hoy"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge neutral",children:["Objetivo: ",(f=n==null?void 0:n.resolution)==null?void 0:f.target,"%"]}),s.jsx("div",{className:"bot-metric-label",children:"RESOLUCIN FINAL"}),s.jsxs("div",{className:"bot-metric-value",children:[n?n.resolution.value:"--","%"]}),s.jsx("div",{className:"bot-metric-progress",children:s.jsx("div",{className:"bot-metric-progress-fill",style:{width:`${n?n.resolution.value:0}%`}})})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:"bot-metric-icon",children:""}),s.jsxs("div",{className:"bot-metric-badge sla",children:[" ",(y=n==null?void 0:n.uptime)==null?void 0:y.status]}),s.jsx("div",{className:"bot-metric-label",children:"VIDA DEL PROCESO"}),s.jsx("div",{className:"bot-metric-value",children:n?n.uptime.value:"--"}),s.jsx("div",{className:"bot-metric-sub",children:"UPTIME SISTEMA"})]}),s.jsxs("div",{className:"bot-metric-card",children:[s.jsx("div",{className:`bot-metric-icon ${((b=n==null?void 0:n.errors)==null?void 0:b.value)>0?"error":""}`,children:""}),s.jsx("div",{className:`bot-metric-badge ${((M=n==null?void 0:n.errors)==null?void 0:M.value)===0?"stable":"neutral"}`,children:(z=n==null?void 0:n.errors)==null?void 0:z.status}),s.jsx("div",{className:"bot-metric-label",children:"ERRORES"}),s.jsx("div",{className:"bot-metric-value",children:n?n.errors.value:"--"}),s.jsxs("div",{className:`bot-metric-sub ${((j=n==null?void 0:n.errors)==null?void 0:j.critical)>0?"error-sub":""}`,children:["CRTICOS: ",n?n.errors.critical:0]})]})]})]})]})]})}const Ph={DRAFT:{bg:"#e3e8ef",text:"#475569",label:"BORRADOR"},PENDING:{bg:"#fef3c7",text:"#d97706",label:"PENDIENTE"},APPROVED:{bg:"#d1fae5",text:"#059669",label:"APROBADA"},REJECTED:{bg:"#fee2e2",text:"#dc2626",label:"RECHAZADA"},PAUSED:{bg:"#fef3c7",text:"#d97706",label:"PAUSADA"},DISABLED:{bg:"#e5e7eb",text:"#6b7280",label:"DESHABILITADA"}},oy=[{value:"UTILITY",label:"Utility"},{value:"MARKETING",label:"Marketing"},{value:"AUTHENTICATION",label:"Authentication"}],cy=[{value:"es",label:"Espaol (ES)"},{value:"en",label:"English (EN)"}];function uy({templates:e=[],templateForm:t,setTemplateForm:n,handleTemplateSubmit:r,handleTemplateSubmitToMeta:a,handleTemplateDelete:i,handleSyncTemplates:l,onLoadTemplates:c,brandName:u=""}){var H;const p=(u||"PODOPIE").trim(),[_,v]=h.useState("list"),[N,A]=h.useState(null),[O,P]=h.useState(""),[C,m]=h.useState(!1),[f,y]=h.useState(""),[b,M]=h.useState(!1),[z,j]=h.useState(!1),[g,B]=h.useState(null),[T,K]=h.useState({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),[oe,pe]=h.useState([]);h.useEffect(()=>{c&&c()},[]);const ke=async()=>{m(!0);try{await l()}finally{m(!1)}},Ee=()=>{A(null),K({name:"",category:"UTILITY",language:"es",body_text:"",header_type:"",header_content:"",footer_text:"",buttons:[]}),pe([]),v("editor")},Ae=k=>{A(k),K({name:k.name||"",category:k.category||"UTILITY",language:k.language||"es",body_text:k.body_text||k.body_preview||"",header_type:k.header_type||"",header_content:k.header_content||"",footer_text:k.footer_text||"",buttons:k.buttons_json||[]}),pe(k.variable_mappings||[]),v("editor")},Pe=async k=>{!(k!=null&&k.id)||!i||!window.confirm(`Eliminar la plantilla "${k.name}"? Esta accin la ocultar localmente y la eliminar de Meta si aplica.`)||await i(k.id)},V=async k=>{k.preventDefault();const U={...T,id:N==null?void 0:N.id,variable_mappings:oe};if(n&&n(U),r){const G=await r(null,U);G&&A(G)}},te=async()=>{if(a){M(!0);try{let k=N==null?void 0:N.id;if(!k){const U={...T,variable_mappings:oe},G=await r(null,U);k=G==null?void 0:G.id,G&&A(G)}k&&(await a(k),v("list"),A(null))}finally{M(!1)}}},ee=()=>{v("list"),A(null)},he=k=>{const U=(k==null?void 0:k.buttons_json)??(k==null?void 0:k.buttons)??[];if(Array.isArray(U))return U;if(typeof U=="string")try{const G=JSON.parse(U);return Array.isArray(G)?G:[]}catch{return[]}return[]},be=(k=>{const U=k.match(/\{\{(\d+)\}\}/g)||[];return[...new Set(U)].map(G=>parseInt(G.replace(/[{}]/g,"")))})(T.body_text),L=e.filter(k=>{var ne;const U=!O||((ne=k.name)==null?void 0:ne.toLowerCase().includes(O.toLowerCase()))||(k.body_text||k.body_preview||"").toLowerCase().includes(O.toLowerCase()),G=!f||k.status===f;return U&&G});return _==="list"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"templates-section",children:[s.jsxs("div",{className:"templates-header",children:[s.jsxs("div",{className:"templates-title-row",children:[s.jsx("h1",{children:"Plantillas de Meta"}),s.jsxs("span",{className:"meta-connected-badge",children:[s.jsx("span",{className:"status-dot"}),"CONECTADO A META API"]})]}),s.jsxs("div",{className:"templates-actions",children:[s.jsx("div",{className:"search-input-wrap",children:s.jsx("input",{type:"text",placeholder:"Buscar plantillas...",value:O,onChange:k=>P(k.target.value)})}),s.jsxs("select",{value:f,onChange:k=>y(k.target.value),className:"status-filter-select",children:[s.jsx("option",{value:"",children:"Todos"}),s.jsx("option",{value:"APPROVED",children:"Aprobadas"}),s.jsx("option",{value:"PENDING",children:"Pendientes"}),s.jsx("option",{value:"REJECTED",children:"Rechazadas"}),s.jsx("option",{value:"DRAFT",children:"Borradores"})]}),s.jsx("button",{className:"btn-sync",onClick:ke,disabled:C,children:C?" Sincronizando...":" Sincronizar"}),s.jsxs("button",{className:"btn-create-template",onClick:Ee,children:[s.jsx("span",{children:"+"})," Crear Nueva Plantilla"]})]})]}),s.jsxs("div",{className:"templates-grid",children:[L.map(k=>{var G;const U=Ph[k.status]||Ph.DRAFT;return s.jsxs("div",{className:"template-card",onClick:()=>Ae(k),children:[s.jsxs("div",{className:"template-card-head",children:[s.jsx("div",{className:"template-category-icon",children:k.category==="MARKETING"?"":k.category==="UTILITY"?"":""}),s.jsx("span",{className:"template-status-badge",style:{backgroundColor:U.bg,color:U.text},children:U.label})]}),s.jsx("h3",{className:"template-card-name",children:k.name}),s.jsxs("div",{className:"template-card-meta",children:[s.jsx("span",{className:"tag-category",children:k.category}),s.jsx("span",{className:"tag-language",children:k.language==="es"?"ESPAOL (ES)":(G=k.language)==null?void 0:G.toUpperCase()})]}),(k.body_text||k.body_preview)&&s.jsxs("p",{className:"template-card-preview",children:[(k.body_text||k.body_preview).slice(0,80),"..."]}),s.jsxs("div",{className:"template-card-actions",children:[s.jsx("button",{className:"btn-preview",onClick:ne=>{ne.stopPropagation(),B(k),j(!0)},children:"Vista previa"}),s.jsx("button",{className:"btn-preview danger",onClick:ne=>{ne.stopPropagation(),Pe(k)},children:"Eliminar"})]})]},k.id)}),s.jsxs("div",{className:"template-card template-card-create",onClick:Ee,children:[s.jsx("div",{className:"create-icon",children:"+"}),s.jsx("h3",{children:"Crear nueva plantilla"}),s.jsx("p",{children:"Empieza a disear tu flujo de WhatsApp"})]})]}),L.length===0&&!O&&s.jsx("div",{className:"templates-empty",children:s.jsx("p",{children:"No hay plantillas. Crea una nueva o sincroniza desde Meta."})})]}),z&&s.jsx("div",{className:"modal-overlay",onClick:()=>j(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:k=>k.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Vista previa"}),s.jsx("button",{className:"modal-close",onClick:()=>j(!1),children:"x"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:p}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:(g==null?void 0:g.body_preview)||(g==null?void 0:g.body_text)||"Sin previsualizacin disponible."}),he(g).length>0&&s.jsx("div",{className:"preview-actions",children:he(g).map((k,U)=>s.jsx("button",{type:"button",children:k.text||k.label||k.title||`Botn ${U+1}`},`prev-${U}`))}),s.jsx("div",{className:"preview-time",children:"10:45 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]})})]})})]}):s.jsxs("div",{className:"template-editor",children:[s.jsxs("div",{className:"editor-header",children:[s.jsxs("div",{className:"editor-breadcrumb",children:[s.jsx("button",{className:"btn-back",onClick:ee,children:" Volver"}),s.jsx("span",{className:"breadcrumb-sep",children:"/"}),s.jsx("span",{children:N?"Editar Plantilla":"Nueva Plantilla"})]}),s.jsxs("div",{className:"editor-actions",children:[s.jsx("button",{className:"btn-save-draft",onClick:V,children:" Guardar Borrador"}),((N==null?void 0:N.status)==="DRAFT"||(N==null?void 0:N.status)==="REJECTED"||!N)&&s.jsx("button",{className:"btn-primary",onClick:te,disabled:b||!T.name||!T.body_text,children:b?"Enviando...":"Enviar a Meta"}),s.jsx("button",{className:"btn-discard",onClick:ee,children:" Descartar"})]})]}),s.jsxs("div",{className:"editor-layout",children:[s.jsxs("div",{className:"editor-form-panel",children:[s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" General Settings"}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Template Name"}),s.jsx("input",{type:"text",placeholder:"patient_appointment_reminder",value:T.name,onChange:k=>K({...T,name:k.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")})})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Category"}),s.jsx("select",{value:T.category,onChange:k=>K({...T,category:k.target.value}),children:oy.map(k=>s.jsx("option",{value:k.value,children:k.label},k.value))})]}),s.jsxs("label",{className:"form-field",children:[s.jsx("span",{children:"Language"}),s.jsx("select",{value:T.language,onChange:k=>K({...T,language:k.target.value}),children:cy.map(k=>s.jsx("option",{value:k.value,children:k.label},k.value))})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("div",{className:"form-section-header",children:[s.jsx("h3",{children:" Message Body"}),s.jsx("button",{className:"btn-insert-var",type:"button",onClick:()=>{const k=be.length+1;K({...T,body_text:T.body_text+`{{${k}}}`})},children:"+ Insert Variable"})]}),s.jsx("textarea",{rows:"6",placeholder:`Hola {{1}}, te recordamos tu cita en ${p} para el da {{2}} a las {{3}}. Por favor, confirma tu asistencia.`,value:T.body_text,onChange:k=>K({...T,body_text:k.target.value})}),s.jsxs("div",{className:"char-count",children:[T.body_text.length," / 1024"]})]})]}),s.jsxs("div",{className:"editor-preview-panel",children:[s.jsx("div",{className:"preview-title",children:"Vista previa en tiempo real"}),s.jsxs("div",{className:"preview-phone",children:[s.jsxs("div",{className:"preview-phone-header",children:[s.jsx("div",{className:"preview-phone-notch"}),s.jsxs("div",{className:"preview-phone-title",children:[s.jsx("div",{className:"preview-phone-avatar"}),s.jsxs("div",{children:[s.jsx("div",{className:"preview-phone-name",children:p}),s.jsx("div",{className:"preview-phone-status",children:"en lnea"})]})]})]}),s.jsxs("div",{className:"preview-phone-body",children:[s.jsx("div",{className:"preview-day-pill",children:"HOY"}),s.jsx("div",{className:"preview-bubble",children:T.body_text||"Tu mensaje aparecer aqu..."}),T.buttons&&T.buttons.length>0&&s.jsx("div",{className:"preview-actions",children:T.buttons.map((k,U)=>s.jsx("button",{type:"button",children:k.text||k.title||`Botn ${U+1}`},`btn-${U}`))}),s.jsx("div",{className:"preview-time",children:"10:42 AM"})]}),s.jsxs("div",{className:"preview-phone-input",children:[s.jsx("span",{children:"Escribir mensaje..."}),s.jsx("div",{className:"preview-mic"})]})]}),s.jsxs("div",{className:"preview-summary",children:[s.jsx("div",{className:"preview-summary-title",children:"Resumen"}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Plantilla"}),s.jsx("strong",{children:T.name||"Sin nombre"})]}),s.jsxs("div",{className:"preview-summary-row",children:[s.jsx("span",{children:"Idioma"}),s.jsx("strong",{children:((H=T.language)==null?void 0:H.toUpperCase())||"ES"})]})]})]}),s.jsxs("div",{className:"editor-mapping-panel",children:[s.jsxs("div",{className:"mapping-tabs",children:[s.jsx("button",{className:"tab active",children:"VARIABLES"}),s.jsx("button",{className:"tab",children:"BUTTONS"})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsx("h4",{children:"ODOO FIELD MAPPING"}),be.length===0?s.jsxs("p",{className:"mapping-empty",children:["Agrega variables ","{{1}}",", ","{{2}}","... en tu mensaje"]}):be.map(k=>{const U=oe.find(G=>G.var_index===k)||{};return s.jsxs("div",{className:"mapping-item",children:[s.jsxs("div",{className:"mapping-var-badge",children:[`{{${k}}}`," Variable"]}),s.jsxs("select",{value:U.source_path||"",onChange:G=>{const ne=oe.filter(le=>le.var_index!==k);ne.push({var_index:k,source_type:"odoo",source_path:G.target.value}),pe(ne)},children:[s.jsx("option",{value:"",children:"Select Odoo Field..."}),s.jsx("option",{value:"partner_id.name",children:"patient_id.name"}),s.jsx("option",{value:"start_date",children:"start_date (Formatted)"}),s.jsx("option",{value:"start_time",children:"start_time"}),s.jsx("option",{value:"partner_id.phone",children:"patient_phone"})]}),s.jsx("span",{className:`mapping-status ${U.source_path?"linked":"needs"}`,children:U.source_path?" Linked":" Needs mapping"})]},k)})]}),s.jsxs("div",{className:"mapping-section",children:[s.jsxs("div",{className:"mapping-section-header",children:[s.jsx("h4",{children:"ACTION BUTTONS"}),s.jsx("button",{className:"btn-add-button",onClick:()=>{K({...T,buttons:[...T.buttons||[],{type:"QUICK_REPLY",text:""}]})},children:"+ Add Button"})]}),(T.buttons||[]).map((k,U)=>s.jsxs("div",{className:"button-item",children:[s.jsx("span",{className:"button-icon",children:""}),s.jsx("input",{type:"text",placeholder:"Button text",value:k.text||"",onChange:G=>{const ne=[...T.buttons];ne[U]={...ne[U],text:G.target.value},K({...T,buttons:ne})}}),s.jsx("button",{className:"btn-remove",onClick:()=>{const G=T.buttons.filter((ne,le)=>le!==U);K({...T,buttons:G})},children:""})]},U))]}),s.jsxs("div",{className:"mapping-tip",children:[s.jsx("span",{className:"tip-icon",children:""}),s.jsx("span",{children:"Tip: Asegrate de que tus variables estn correctamente mapeadas a campos de Odoo antes de enviar."})]})]})]})]})}const Mh={campaigns:"",users:"",bot:"",chat:"",templates:"",audience:"",system:""},dy={"user.created":"USUARIO CREADO","user.updated":"USUARIO EDITADO","user.disabled":"USUARIO ELIMINADO",template_draft_created:"PLANTILLA CREADA",template_draft_updated:"PLANTILLA EDITADA",template_submitted:"PLANTILLA ENVIADA",template_deleted:"PLANTILLA ELIMINADA",template_restored:"PLANTILLA RESTAURADA",audience_created:"SEGMENTO CREADO",audience_updated:"SEGMENTO EDITADO",audience_deleted:"SEGMENTO ELIMINADO","campaign.created":"CAMPAA CREADA","campaign.queued":"CAMPAA EN COLA","campaign.sending":"CAMPAA LANZADA","settings.updated":"CONFIG ACTUALIZADA","role_permissions.updated":"PERMISOS CAMBIADOS","role_permissions.deleted":"ROL ELIMINADO","conversation.status_changed":"CHAT ACTUALIZADO","conversation.tag_added":"TAG AGREGADO","conversation.tag_removed":"TAG ELIMINADO"};function jm(e){var r;const t=((r=e==null?void 0:e.data_json)==null?void 0:r.entity)||"";if(t==="template")return"templates";if(t==="audience")return"audience";if(t==="campaign")return"campaigns";if(t==="conversation")return"chat";const n=(e==null?void 0:e.action)||"";return n.includes("user")?"users":n.includes("campaign")?"campaigns":n.includes("template")?"templates":n.includes("audience")?"audience":n.includes("bot")?"bot":n.includes("conversation")?"chat":"system"}function cc(e){if(!e)return{date:"--",time:"--"};const t=new Date(e);return Number.isNaN(t.getTime())?{date:"--",time:"--"}:{date:t.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}),time:t.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}}function hy(e,t="csv"){const r=[["timestamp","usuario","email","accion","modulo","data"].join(",")];e.forEach(p=>{var O,P;const _=((O=p.user)==null?void 0:O.name)||"Sistema",v=((P=p.user)==null?void 0:P.email)||"",N=jm(p),A=[new Date(p.created_at).toISOString(),_,v,p.action,N,JSON.stringify(p.data_json||{})];r.push(A.map(C=>`"${String(C).replace(/"/g,'""')}"`).join(","))});const a=r.join(`
`),i=t==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv;charset=utf-8;",l=t==="excel"?"audit_logs.xlsx":"audit_logs.csv",c=new Blob([a],{type:i}),u=document.createElement("a");u.href=URL.createObjectURL(c),u.download=l,document.body.appendChild(u),u.click(),document.body.removeChild(u)}function fy(){var z,j;const[e,t]=h.useState(""),[n,r]=h.useState(""),[a,i]=h.useState(""),[l,c]=h.useState(1),[u]=h.useState(6),[p,_]=h.useState(0),[v,N]=h.useState([]),[A,O]=h.useState(!1),[P,C]=h.useState(null),m=Math.max(1,Math.ceil(p/u)),f=async({pageOverride:g}={})=>{O(!0);try{const B=new URLSearchParams;B.set("page",String(g||l)),B.set("page_size",String(u)),e.trim()&&B.set("q",e.trim()),n&&B.set("from",n),a&&B.set("to",a);const T=await Ne(`/api/admin/audit?${B.toString()}`);N(T.logs||[]),_(T.total||0)}finally{O(!1)}};h.useEffect(()=>{f()},[l]);const y=()=>{c(1),f({pageOverride:1})},b=async(g="csv")=>{const B=new URLSearchParams;B.set("page","1"),B.set("page_size","1000"),e.trim()&&B.set("q",e.trim()),n&&B.set("from",n),a&&B.set("to",a);const T=await Ne(`/api/admin/audit?${B.toString()}`);hy(T.logs||[],g)},M=h.useMemo(()=>{const g=[],B=Math.max(1,l-1),T=Math.min(m,B+2);for(let K=B;K<=T;K+=1)g.push(K);return g},[l,m]);return s.jsxs("div",{className:"audit-module",children:[s.jsxs("div",{className:"audit-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-title",children:"Registros / Auditoria"}),s.jsx("div",{className:"audit-subtitle",children:"Monitorea acciones de usuarios y eventos del sistema"})]}),s.jsxs("div",{className:"audit-export-group",children:[s.jsx("button",{className:"audit-export",type:"button",onClick:()=>b("excel"),children:" Exportar Excel"}),s.jsx("button",{className:"audit-export outline",type:"button",onClick:()=>b("csv"),children:" Exportar CSV"})]})]}),s.jsxs("div",{className:"audit-filters",children:[s.jsxs("div",{className:"audit-search",children:[s.jsx("span",{className:"audit-search-icon"}),s.jsx("input",{type:"text",placeholder:"Filtrar por usuario o accion..",value:e,onChange:g=>t(g.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Desde"}),s.jsx("input",{type:"date",value:n,onChange:g=>r(g.target.value)})]}),s.jsxs("div",{className:"audit-date",children:[s.jsx("span",{children:"Hasta"}),s.jsx("input",{type:"date",value:a,onChange:g=>i(g.target.value)})]}),s.jsx("button",{className:"audit-filter-btn",type:"button",onClick:y,children:"Filtrar"})]}),s.jsxs("div",{className:"audit-card",children:[s.jsxs("div",{className:"audit-table-head",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("span",{children:"Usuario"}),s.jsx("span",{children:"Accion"}),s.jsx("span",{children:"Modulo"})]}),A&&s.jsx("div",{className:"audit-empty",children:"Cargando registros..."}),!A&&!v.length&&s.jsx("div",{className:"audit-empty",children:"Sin registros para mostrar"}),!A&&v.map(g=>{var ke,Ee;const B=cc(g.created_at),T=jm(g),K=dy[g.action]||g.action,oe=((ke=g.user)==null?void 0:ke.name)||"System Bot",pe=((Ee=g.user)==null?void 0:Ee.email)||"automated@service";return s.jsxs("button",{type:"button",className:"audit-row",onClick:()=>C(g),children:[s.jsxs("div",{className:"audit-cell time",children:[s.jsx("div",{children:B.date}),s.jsx("div",{className:"audit-time",children:B.time})]}),s.jsxs("div",{className:"audit-cell user",children:[s.jsx("div",{className:"audit-avatar",children:(oe==null?void 0:oe[0])||"S"}),s.jsxs("div",{children:[s.jsx("div",{className:"audit-user-name",children:oe}),s.jsx("div",{className:"audit-user-email",children:pe})]})]}),s.jsx("div",{className:"audit-cell action",children:s.jsx("span",{className:"audit-action-pill",children:K})}),s.jsxs("div",{className:"audit-cell module",children:[s.jsx("span",{className:"audit-module-icon",children:Mh[T]||Mh.system}),T.charAt(0).toUpperCase()+T.slice(1)]})]},g.id)})]}),s.jsxs("div",{className:"audit-footer",children:[s.jsxs("div",{children:["Mostrando ",v.length," de ",p," registros"]}),s.jsxs("div",{className:"audit-pagination",children:[s.jsx("button",{type:"button",disabled:l<=1,onClick:()=>c(g=>Math.max(1,g-1)),children:""}),M.map(g=>s.jsx("button",{type:"button",className:g===l?"active":"",onClick:()=>c(g),children:g},g)),s.jsx("button",{type:"button",disabled:l>=m,onClick:()=>c(g=>Math.min(m,g+1)),children:""})]})]}),P&&s.jsx("div",{className:"audit-modal",children:s.jsxs("div",{className:"audit-modal-card",children:[s.jsxs("div",{className:"audit-modal-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"audit-modal-title",children:"Detalle del registro"}),s.jsx("div",{className:"audit-modal-subtitle",children:P.action})]}),s.jsx("button",{type:"button",onClick:()=>C(null),children:""})]}),s.jsxs("div",{className:"audit-modal-body",children:[s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Usuario"}),s.jsx("strong",{children:((z=P.user)==null?void 0:z.name)||"System Bot"}),s.jsx("small",{children:((j=P.user)==null?void 0:j.email)||"automated@service"})]}),s.jsxs("div",{className:"audit-detail",children:[s.jsx("span",{children:"Timestamp"}),s.jsx("strong",{children:cc(P.created_at).date}),s.jsx("small",{children:cc(P.created_at).time})]}),s.jsxs("div",{className:"audit-detail full",children:[s.jsx("span",{children:"Data"}),s.jsx("pre",{children:JSON.stringify(P.data_json||{},null,2)})]})]})]})})]})}function py(){return s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"panel-title",children:"Integracion Odoo"}),s.jsx("div",{className:"empty-state",children:"Seccion en construccion"})]})}function my(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("line",{x1:"4",y1:"6",x2:"20",y2:"6",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"6",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"2",strokeWidth:"2"}),s.jsx("line",{x1:"4",y1:"18",x2:"20",y2:"18",strokeWidth:"2"}),s.jsx("circle",{cx:"11",cy:"18",r:"2",strokeWidth:"2"})]})}function gy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"9",cy:"8",r:"3",strokeWidth:"2"}),s.jsx("path",{d:"M4 20c0-3 2.7-5.5 6-5.5s6 2.5 6 5.5",strokeWidth:"2"}),s.jsx("circle",{cx:"17",cy:"9",r:"2",strokeWidth:"2"}),s.jsx("path",{d:"M14 20c0-1.8 1.4-3.4 3.2-4",strokeWidth:"2"})]})}function vy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"2"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"2"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"2"})]})}function xy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"4",width:"12",height:"16",rx:"2",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"9",strokeWidth:"2"}),s.jsx("line",{x1:"9",y1:"13",x2:"15",y2:"13",strokeWidth:"2"})]})}function yy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"6",y:"5",width:"12",height:"15",rx:"2",strokeWidth:"2"}),s.jsx("path",{d:"M9 5h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 10h6",strokeWidth:"2"}),s.jsx("path",{d:"M9 14h6",strokeWidth:"2"})]})}function jy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M8 4h4a2 2 0 1 1 0 4h-1v2h2a2 2 0 1 1 0 4h-2v2H8a2 2 0 1 1-4 0V8a2 2 0 1 1 4 0z",strokeWidth:"2"})})}function Ny({settingsSection:e,setSettingsSection:t,settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,currentRole:l,isAdmin:c,adminUsers:u,userForm:p,setUserForm:_,roleOptions:v,handleUserSubmit:N,settings:A,setSettings:O,handleSaveSettings:P,templates:C,templateForm:m,setTemplateForm:f,handleTemplateSubmit:y,handleTemplateSubmitToMeta:b,handleTemplateDelete:M,handleSyncTemplates:z,auditLogs:j,formatDate:g,planName:B,tenantChannels:T,channelForm:K,setChannelForm:oe,handleChannelSelect:pe,handleChannelSubmit:ke,handleChannelQuickUpdate:Ee,handleUserDelete:Ae,defaultRolePermissions:Pe,handleRoleDelete:V,useShellLayout:te=!1,pageError:ee,isOffline:he=!1,onDismissError:ce,brandName:be=""}){const L=a==null?void 0:a[l],H=[{title:"Principal",items:[{id:"general",label:"Lineas",icon:my},{id:"users",label:"Gestion de Usuarios",icon:gy},{id:"bot",label:"Configuracion de Bot",icon:vy}]},{title:"Canales e Integraciones",items:[{id:"templates",label:"Plantillas de Meta",icon:xy},{id:"audit",label:"Registros / Auditoria",icon:yy},{id:"odoo",label:"Integracion Odoo",icon:jy}]}];function k(ne){var le,fe;return!!((fe=(le=L==null?void 0:L.settings)==null?void 0:le[ne])!=null&&fe.read)}function U(ne){k(ne)&&t(ne)}const G=s.jsxs(s.Fragment,{children:[s.jsxs("aside",{className:"settings-sidebar",children:[s.jsxs("div",{className:"settings-header",children:[s.jsx("div",{className:"settings-title",children:"CONFIGURACION"}),s.jsxs("div",{className:"settings-version",children:[(be||"Empresa").toUpperCase()," OS V2.0"]})]}),H.map(ne=>s.jsxs("div",{className:"settings-group",children:[s.jsx("div",{className:"settings-group-title",children:ne.title}),s.jsx("div",{className:"settings-group-list",children:ne.items.map(le=>{const fe=!k(le.id),X=le.icon;return s.jsxs("button",{className:`settings-item ${e===le.id?"active":""}`,type:"button",onClick:()=>U(le.id),disabled:fe,children:[s.jsx("span",{className:"settings-icon","aria-hidden":"true",children:s.jsx(X,{className:"settings-icon-svg"})}),le.label]},le.id)})})]},ne.title)),s.jsxs("div",{className:"settings-plan",children:[s.jsx("div",{className:"settings-plan-label",children:"Plan actual"}),s.jsx("div",{className:"settings-plan-name",children:B||"Sin plan"})]})]}),s.jsxs("div",{className:"settings-content",children:[e==="users"&&s.jsx(ry,{settingsTab:n,setSettingsTab:r,rolePermissions:a,setRolePermissions:i,isAdmin:c,adminUsers:u,userForm:p,setUserForm:_,roleOptions:v,handleUserSubmit:N,handleUserDelete:Ae,defaultRolePermissions:Pe,handleRoleDelete:V}),e==="general"&&s.jsx(iy,{tenantChannels:T,channelForm:K,setChannelForm:oe,handleChannelSelect:pe,handleChannelSubmit:ke,handleChannelQuickUpdate:Ee}),e==="bot"&&s.jsx(ly,{settings:A,setSettings:O,handleSaveSettings:P}),e==="templates"&&s.jsx(uy,{templates:C,templateForm:m,setTemplateForm:f,handleTemplateSubmit:y,handleTemplateSubmitToMeta:b,handleTemplateDelete:M,handleSyncTemplates:z,brandName:be}),e==="audit"&&s.jsx(fy,{auditLogs:j,formatDate:g}),e==="odoo"&&s.jsx(py,{}),he?s.jsx(Wa,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):ee?s.jsx(Wa,{variant:"error",title:"Ocurri un problema",message:ee,dismissLabel:"Cerrar",onDismiss:ce}):null]})]});return te?G:s.jsx("section",{className:"settings-layout",children:G})}function wy(){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[s.jsx("rect",{x:"5",y:"7",width:"14",height:"10",rx:"2",strokeWidth:"1.8"}),s.jsx("circle",{cx:"9",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",strokeWidth:"1.8"}),s.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"7",strokeWidth:"1.8"})]})}function _y({tenantId:e,tenantBots:t,availableFlows:n,loading:r,onAddBot:a,onRemoveBot:i,onUpdateBotConfig:l}){const[c,u]=h.useState(""),[p,_]=h.useState("openai"),[v,N]=h.useState(""),[A,O]=h.useState({}),P=new Set(t.map(j=>j.flow_id)),C=n.filter(j=>!P.has(j.id)),m=h.useMemo(()=>new Map(n.map(j=>[j.id,j])),[n]),f=C.find(j=>j.id===c),y=!!(f!=null&&f.requires_ai);function b(){if(!c)return;a(c,y?{ai:{provider:p,key:v||void 0}}:null),u(""),N("")}function M(j,g){O(B=>({...B,[j]:{...B[j]||{},...g}}))}function z(j){var oe,pe;if(!l)return;const g=A[j.id]||{},B=g.provider||((pe=(oe=j.config)==null?void 0:oe.ai)==null?void 0:pe.provider)||"openai",T=g.key||"",K={ai:{provider:B,...T?{key:T}:{}}};l(j.id,K),M(j.id,{key:""})}return s.jsxs("section",{className:"sa-bot-card","data-tenant":e||"",children:[s.jsxs("header",{className:"sa-bot-header",children:[s.jsx("div",{className:"sa-bot-icon-large","aria-hidden":"true",children:s.jsx(wy,{})}),s.jsxs("div",{className:"sa-bot-title-group",children:[s.jsx("h3",{children:"Asignacion de Bots"}),s.jsx("p",{children:"Selecciona que flujos estaran disponibles para este cliente. Los flujos asignados apareceran inmediatamente en el panel del usuario."})]})]}),s.jsx("div",{className:"sa-bot-body",children:r?s.jsx("div",{className:"sa-bot-loading",children:"Cargando asignaciones..."}):t.length===0?s.jsxs("div",{className:"sa-bot-empty",children:[s.jsx("div",{className:"sa-bot-empty-icon",children:"+"}),s.jsx("div",{className:"sa-bot-empty-title",children:"Sin bots asignados"}),s.jsx("div",{className:"sa-bot-empty-sub",children:"Agrega un flujo desde el selector para activarlo en este tenant."})]}):s.jsx("div",{className:"sa-bot-grid",children:t.map(j=>{var g,B,T,K,oe,pe,ke;return s.jsxs("div",{className:"sa-assigned-bot",children:[s.jsx("div",{className:"sa-bot-item-icon",children:j.flow_icon||">"}),s.jsxs("div",{className:"sa-bot-item-info",children:[s.jsx("span",{className:"sa-bot-item-name",children:j.flow_name||j.flow_id}),s.jsx("span",{className:"sa-bot-item-desc",children:j.flow_description||"Sin descripcion"}),((g=m.get(j.flow_id))==null?void 0:g.requires_ai)&&s.jsxs("div",{className:"sa-bot-ai-config",children:[s.jsxs("div",{className:"sa-ai-field",children:[s.jsx("label",{className:"sa-select-label",children:"Proveedor IA"}),s.jsxs("select",{className:"sa-select-styled",value:((B=A[j.id])==null?void 0:B.provider)||((K=(T=j.config)==null?void 0:T.ai)==null?void 0:K.provider)||"openai",onChange:Ee=>M(j.id,{provider:Ee.target.value}),children:[s.jsx("option",{value:"openai",children:"OpenAI"}),s.jsx("option",{value:"gemini",children:"Gemini"})]})]}),s.jsxs("div",{className:"sa-ai-field",children:[s.jsx("label",{className:"sa-select-label",children:"API Key"}),s.jsx("input",{type:"password",className:"sa-input",placeholder:(pe=(oe=j.config)==null?void 0:oe.ai)!=null&&pe.key_present?"******** (configurada)":"Pegue la API key",value:((ke=A[j.id])==null?void 0:ke.key)||"",onChange:Ee=>M(j.id,{key:Ee.target.value})})]}),s.jsx("button",{type:"button",className:"sa-btn-assign sa-btn-save",onClick:()=>z(j),children:"Guardar IA"})]})]}),s.jsx("button",{type:"button",className:"sa-btn-remove",title:"Quitar bot del cliente",onClick:()=>i(j.id),children:"Quitar"})]},j.id)})})}),s.jsxs("div",{className:"sa-bot-controls",children:[s.jsxs("div",{className:"sa-select-container",children:[s.jsx("label",{className:"sa-select-label",children:"Asignar bot"}),s.jsxs("select",{className:"sa-select-styled",value:c,onChange:j=>u(j.target.value),disabled:C.length===0,children:[s.jsx("option",{value:"",children:C.length===0?"No hay mas bots disponibles":"Selecciona un bot para asignar"}),C.map(j=>s.jsx("option",{value:j.id,children:j.name},j.id))]})]}),y&&s.jsxs("div",{className:"sa-ai-assign",children:[s.jsxs("div",{className:"sa-ai-field",children:[s.jsx("label",{className:"sa-select-label",children:"Proveedor IA"}),s.jsxs("select",{className:"sa-select-styled",value:p,onChange:j=>_(j.target.value),children:[s.jsx("option",{value:"openai",children:"OpenAI"}),s.jsx("option",{value:"gemini",children:"Gemini"})]})]}),s.jsxs("div",{className:"sa-ai-field",children:[s.jsx("label",{className:"sa-select-label",children:"API Key"}),s.jsx("input",{type:"password",className:"sa-input",placeholder:"Pegue la API key",value:v,onChange:j=>N(j.target.value)})]})]}),s.jsx("button",{type:"button",className:"sa-btn-assign",onClick:b,disabled:!c,children:"Asignar Bot"})]})]})}const Zt={name:"",slug:"",plan:"",db_url:"",phone_number_id:"",line_name:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",brand_name:"",logo_url:"",brand_primary:"#22d3ee",brand_accent:"#38bdf8",brand_bg:"#0b0f16",timezone:"",odoo_base_url:"",odoo_db_name:"",odoo_username:"",odoo_password:""},Sy=[{value:"starter",label:"Starter"},{value:"growth",label:"Growth"},{value:"scale",label:"Scale"},{value:"enterprise",label:"Enterprise"}];function ky(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"4",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"4",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"4",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"}),s.jsx("rect",{x:"14",y:"14",width:"6",height:"6",rx:"1.5",strokeWidth:"1.6"})]})}function du(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function by(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"3.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M19 12a7 7 0 0 0-.1-1.2l2-1.5-2-3.5-2.4.7a7.2 7.2 0 0 0-2-1.2L12 2 9.5 4.3a7.2 7.2 0 0 0-2 1.2l-2.4-.7-2 3.5 2 1.5A7 7 0 0 0 5 12c0 .4 0 .8.1 1.2l-2 1.5 2 3.5 2.4-.7a7.2 7.2 0 0 0 2 1.2L12 22l2.5-2.3a7.2 7.2 0 0 0 2-1.2l2.4.7 2-3.5-2-1.5c.1-.4.1-.8.1-1.2Z",strokeWidth:"1.2",strokeLinejoin:"round"})]})}function Cy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.6"}),s.jsx("path",{d:"M16.5 16.5 20 20",strokeWidth:"1.6",strokeLinecap:"round"})]})}function Ey(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 12h12",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m13 6 6 6-6 6",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ay(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M18 6 6 18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"m6 6 12 12",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ty(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56",strokeWidth:"1.8",strokeLinecap:"round"})})}function Ih(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Dh(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m2 2 20 20",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ly(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 18h.01",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Ry(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"m15 5 4 4",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Oy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M3 6h18",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",strokeWidth:"1.8",strokeLinecap:"round"})]})}const Bh={display_name:"",phone_number_id:"",waba_id:"",verify_token:"",wa_token:"",app_secret:"",is_active:!0,is_default:!1};function Py({isOpen:e,onClose:t,initialData:n,onSave:r,tenantId:a}){const[i,l]=h.useState(Bh),[c,u]=h.useState(!1),[p,_]=h.useState(!1),[v,N]=h.useState(!1),[A,O]=h.useState(null);if(h.useEffect(()=>{e&&(l(n||{...Bh}),O(null))},[e,n]),!e)return null;const P=async C=>{if(C.preventDefault(),N(!0),O(null),!i.phone_number_id||!i.verify_token||!n&&!i.wa_token){O("Los campos ID de Telfono, Verify Token y Access Token son obligatorios."),N(!1);return}try{await r({...i,tenant_id:a}),t()}catch(m){console.error("Error saving channel:",m),O(m.message||"Error al guardar la lnea.")}finally{N(!1)}};return s.jsx("div",{className:"sa-modal-overlay",onClick:t,children:s.jsxs("div",{className:"sa-modal-content",onClick:C=>C.stopPropagation(),children:[s.jsxs("div",{className:"sa-modal-header",children:[s.jsx("div",{className:"sa-modal-title",children:n?"Editar Lnea WhatsApp":"Nueva Lnea WhatsApp"}),s.jsx("button",{className:"sa-modal-close",onClick:t,children:s.jsx(Ay,{width:24,height:24})})]}),s.jsxs("div",{className:"sa-modal-body",children:[A&&s.jsx("div",{className:"sa-alert",style:{marginBottom:"1rem"},children:A}),s.jsxs("div",{className:"sa-form-grid",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre para mostrar (Opcional)"}),s.jsx("input",{value:i.display_name||"",onChange:C=>l({...i,display_name:C.target.value}),placeholder:"Ej: Ventas Principal"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Phone Number ID *"}),s.jsx("input",{value:i.phone_number_id||"",onChange:C=>l({...i,phone_number_id:C.target.value}),placeholder:"Identificador del nmero de telfono"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"WABA ID (WhatsApp Business Account ID)"}),s.jsx("input",{value:i.waba_id||"",onChange:C=>l({...i,waba_id:C.target.value}),placeholder:"Identificador de la cuenta de WhatsApp Business"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Verify Token (Webhook) *"}),s.jsx("input",{value:i.verify_token||"",onChange:C=>l({...i,verify_token:C.target.value}),placeholder:"Token de verificacin webhook"})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"Permanent Access Token *"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:c?"text":"password",value:i.wa_token||"",onChange:C=>l({...i,wa_token:C.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"Token de acceso permanente",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>u(!c),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:c?s.jsx(Dh,{width:18,height:18}):s.jsx(Ih,{width:18,height:18})})]})]}),s.jsxs("div",{className:"sa-field",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{children:"App Secret (Opcional)"}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:p?"text":"password",value:i.app_secret||"",onChange:C=>l({...i,app_secret:C.target.value}),placeholder:n?"(Dejar vaco para no cambiar)":"App Secret de Meta",style:{width:"100%",paddingRight:"40px"}}),s.jsx("button",{type:"button",onClick:()=>_(!p),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:p?s.jsx(Dh,{width:18,height:18}):s.jsx(Ih,{width:18,height:18})})]})]})]}),s.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"2rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_active,onChange:C=>l({...i,is_active:C.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Activa"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",color:"#e5e7eb",fontSize:"0.8rem"},children:[s.jsx("input",{type:"checkbox",checked:!!i.is_default,onChange:C=>l({...i,is_default:C.target.checked}),style:{width:"16px",height:"16px"}}),"Lnea Principal (Por Defecto)"]})]})]}),s.jsxs("div",{className:"sa-modal-footer",children:[s.jsx("button",{className:"sa-btn ghost",onClick:t,disabled:v,children:"Cancelar"}),s.jsx("button",{className:"sa-btn primary",onClick:P,disabled:v,children:v?s.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(Ty,{width:16,height:16,className:"animate-spin"})," Guardando..."]}):"Guardar Lnea"})]})]})})}function My({channels:e=[],tenantId:t,onRefresh:n}){const[r,a]=h.useState(!1),[i,l]=h.useState(null),c=()=>{l(null),a(!0)},u=v=>{l(v),a(!0)},p=async v=>{i?await ut(`/api/superadmin/channels/${i.id}`,v):await Le("/api/superadmin/channels",v),await n()},_=async v=>{if(confirm("Ests seguro de que deseas eliminar esta lnea? Esta accin no se puede deshacer."))try{await ks(`/api/superadmin/channels/${v}`),await n()}catch(N){console.error("Error deleting channel:",N),alert("No se pudo eliminar la lnea.")}};return s.jsxs("section",{className:"sa-lines-card",children:[s.jsxs("header",{className:"sa-lines-header",children:[s.jsxs("div",{className:"sa-lines-title",children:[s.jsx("div",{className:"sa-lines-icon",children:s.jsx(Ly,{width:24,height:24})}),s.jsxs("div",{children:[s.jsx("h3",{children:"Lneas de WhatsApp Cloud"}),s.jsx("p",{children:"Gestiona las conexiones activas de WhatsApp para este tenant."})]})]}),s.jsxs("button",{className:"sa-btn primary",onClick:c,children:[s.jsx(du,{width:16,height:16,style:{marginRight:"0.5rem"}}),"Agregar Nueva Lnea"]})]}),s.jsx("div",{className:"sa-lines-body",children:s.jsxs("div",{className:"sa-lines-grid",children:[e.map(v=>s.jsxs("div",{className:`sa-line-card ${v.is_active?"":"opacity-75"}`,children:[s.jsxs("div",{className:"sa-line-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-line-name",children:v.display_name||"Sin nombre"}),s.jsxs("div",{className:"sa-line-meta",children:["ID: ",v.phone_number_id]})]}),s.jsx("div",{className:`sa-line-status ${v.is_active?"active":""}`,title:v.is_active?"Activo":"Inactivo"})]}),s.jsxs("div",{className:"sa-line-badges",children:[v.is_default&&s.jsx("span",{className:"sa-line-badge default",children:"DEFAULT"}),!v.is_active&&s.jsx("span",{className:"sa-status warn",children:"INACTIVO"})]}),s.jsxs("div",{className:"sa-line-details",children:[s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"WABA ID"}),s.jsx("span",{className:"sa-detail-value",children:v.waba_id||"-"})]}),s.jsxs("div",{className:"sa-line-detail",children:[s.jsx("span",{className:"sa-detail-label",children:"Verify Token"}),s.jsx("span",{className:"sa-detail-value",children:v.verify_token?`${v.verify_token.substring(0,16)}...`:"-"})]})]}),s.jsxs("div",{className:"sa-line-actions",children:[s.jsx("button",{className:"sa-btn ghost",onClick:()=>u(v),title:"Editar",children:s.jsx(Ry,{width:16,height:16})}),s.jsx("button",{className:"sa-btn ghost",onClick:()=>_(v.id),title:"Eliminar",style:{color:"#f87171"},children:s.jsx(Oy,{width:16,height:16})})]})]},v.id)),s.jsxs("button",{type:"button",className:"sa-line-add-card",onClick:c,children:[s.jsx("div",{className:"sa-add-icon-circle",children:s.jsx(du,{width:24,height:24})}),s.jsx("span",{children:"Nueva Conexin"})]})]})}),s.jsx(Py,{isOpen:r,onClose:()=>a(!1),initialData:i,onSave:p,tenantId:t})]})}function zh({route:e="/superadmin",onNavigate:t,onImpersonateTenant:n,onLogout:r=()=>{}}){const[a,i]=h.useState([]),[l,c]=h.useState([]),[u,p]=h.useState([]),[_,v]=h.useState(""),[N,A]=h.useState(""),[O,P]=h.useState("Verificacion de red: sistema ok"),[C,m]=h.useState(Zt),[f,y]=h.useState(!1),[b,M]=h.useState(!1),[z,j]=h.useState(""),[g,B]=h.useState(""),[T,K]=h.useState(!0),[oe,pe]=h.useState(Zt),[ke,Ee]=h.useState(!0),[Ae,Pe]=h.useState(!1),V=h.useRef(""),[te,ee]=h.useState([]),[he,ce]=h.useState([]),[be,L]=h.useState(!1),{pushToast:H}=dd(),k=h.useMemo(()=>{if(!e)return"";const S=e.match(/^\/superadmin\/tenants\/([^/]+)\/?$/)||e.match(/^\/superadmin\/tenant\/([^/]+)\/?$/)||e.match(/^\/superadmin\/edit\/([^/]+)\/?$/);return S?S[1]:""},[e]),U=e.startsWith("/superadmin/new"),G=!!k,ne=U||G,le=h.useCallback(S=>{if(t){t(S,{replace:!1});return}typeof window>"u"||window.history.pushState({},"",S)},[t]);async function fe(){try{const S=await Ne("/api/superadmin/tenants");i(S.tenants||[]);const F=await Ne("/api/superadmin/channels");c(F.channels||[]),A("")}catch(S){A(S.message||"No se pudo cargar datos.")}}h.useEffect(()=>{fe(),et()},[]),h.useMemo(()=>{const S=new Map;return l.forEach(F=>{const q=S.get(F.tenant_id)||0;S.set(F.tenant_id,q+1)}),S},[l]);const X=h.useMemo(()=>{const S=_.trim().toLowerCase();return S?a.filter(F=>{const q=String(F.name||"").toLowerCase(),se=String(F.slug||"").toLowerCase(),_e=String(F.id||"").toLowerCase();return q.includes(S)||se.includes(S)||_e.includes(S)}):a.slice()},[a,_]),Me=a.length,Ge=a.filter(S=>S.is_active).length;a.filter(S=>S.has_database).length;const ve=a.filter(S=>S.has_odoo).length,Bt=Me?Math.round(ve/Me*100):0;function Gt(S){if(!S)return"--";const F=new Date(S);return Number.isNaN(F.getTime())?"--":F.toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"2-digit"})}function _n(S){return 10+Math.abs(Array.from(S).reduce((se,_e)=>se+_e.charCodeAt(0),0))%70}function on(){m(Zt),pe(Zt),B(""),K(!0),Ee(!0),ce([]),p([]),P("Verificacion de red: sistema ok"),V.current=""}function Ke(){on(),A(""),le("/superadmin/new")}function zt(){V.current="",le("/superadmin")}async function cn(S){if(n)try{A(""),j(S),await n(S)}catch(F){A(F.message||"No se pudo entrar al tenant.")}finally{j("")}}function Qt(S){const F={};return Object.keys(Zt).forEach(q=>{const se=S[q];F[q]=typeof se=="string"?se.trim():se||""}),{...Zt,...F}}async function lt(S){if(S){V.current=S,B(S),m(Zt),pe(Zt),K(!0),Ee(!0),ce([]),p([]),Pe(!0),A("");try{const F=await Ne(`/api/superadmin/tenants/${S}/details`);if(V.current!==S)return;const q=F.tenant||{},se=F.branding||null,_e=F.odoo||null,dn=F.database||null,ft=F.channel||null;p(F.channels||[]);const tt=(se==null?void 0:se.colors)||{},nt=Qt({...Zt,name:q.name||"",slug:q.slug||"",plan:q.plan||"",db_url:(dn==null?void 0:dn.db_url)||"",brand_name:(se==null?void 0:se.brand_name)||"",logo_url:(se==null?void 0:se.logo_url)||"",brand_primary:(tt==null?void 0:tt.primary)||Zt.brand_primary,brand_accent:(tt==null?void 0:tt.accent)||Zt.brand_accent,brand_bg:(tt==null?void 0:tt.bg)||Zt.brand_bg,odoo_base_url:(_e==null?void 0:_e.base_url)||"",odoo_db_name:(_e==null?void 0:_e.db_name)||"",odoo_username:(_e==null?void 0:_e.username)||"",odoo_password:(_e==null?void 0:_e.password)||""});m(nt),pe(nt),B(q.id||S),K(!!q.is_active),Ee(!!q.is_active),P("Modo edicion: cambios pendientes"),await xe(S)}catch(F){A(F.message||"No se pudo cargar tenant.")}finally{Pe(!1)}}}async function un(S){if(S)try{const F=await Ne(`/api/superadmin/tenants/${S}/details`);if(g&&g!==S)return;p(F.channels||[])}catch(F){console.error("Error loading tenant channels",F)}}async function et(){try{const S=await Ne("/api/superadmin/flows");ee(S.flows||[])}catch(S){console.error("Error loading flows",S)}}async function xe(S){if(S){L(!0);try{const F=await Ne(`/api/superadmin/tenant-bots?tenant_id=${S}`);ce(F.tenant_bots||[])}catch(F){console.error("Error loading tenant bots",F)}finally{L(!1)}}}async function St(S,F){try{await ut(`/api/superadmin/tenant-bots/${S}`,{is_active:F}),ce(q=>q.map(se=>se.id===S?{...se,is_active:F}:se))}catch(q){A(q.message||"Error al cambiar estado del bot.")}}async function W(S,F=null){if(g)try{const q=await Le("/api/superadmin/tenant-bots",{tenant_id:g,flow_id:S,config:F});q.tenant_bot&&(ce(se=>[q.tenant_bot,...se]),H({message:"Bot agregado correctamente"}))}catch(q){A(q.message||"Error al agregar bot."),H({type:"error",message:q.message||"Error al agregar bot"})}}async function Ie(S){const F=he.find(q=>q.id===S);try{await ks(`/api/superadmin/tenant-bots/${S}`),ce(q=>q.filter(se=>se.id!==S)),H({message:"Bot eliminado correctamente",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{try{if(!F)return;const q=await Le("/api/superadmin/tenant-bots",{tenant_id:F.tenant_id,flow_id:F.flow_id,config:F.config||null});q!=null&&q.tenant_bot&&F.is_active===!1&&await ut(`/api/superadmin/tenant-bots/${q.tenant_bot.id}`,{is_active:!1}),await xe(g),H({message:"Bot restaurado"})}catch(q){H({type:"error",message:(q==null?void 0:q.message)||"No se pudo restaurar el bot"})}}})}catch(q){A(q.message||"Error al eliminar bot."),H({type:"error",message:q.message||"Error al eliminar bot"})}}async function ye(S,F){try{const q=await ut(`/api/superadmin/tenant-bots/${S}`,{config:F});q!=null&&q.tenant_bot&&ce(se=>se.map(_e=>_e.id===S?q.tenant_bot:_e)),H({message:"Configuracion IA actualizada"})}catch(q){A(q.message||"Error al actualizar configuracion del bot."),H({type:"error",message:q.message||"Error al actualizar configuracion del bot"})}}async function Ye(S){A(""),le(`/superadmin/tenants/${S.id}`)}async function Sn(){await fe(),g&&await un(g)}function R(){const S=C.name.trim(),F=C.slug.trim(),q=C.db_url.trim();return!S||!F?{ok:!1,message:"Nombre y subdominio son requeridos."}:!g&&!q?{ok:!1,message:"Tenant DB URL es requerido."}:(C.brand_name.trim()||C.logo_url.trim()||C.brand_primary||C.brand_accent||C.brand_bg)&&!C.brand_name.trim()?{ok:!1,message:"Brand name es requerido."}:(C.odoo_base_url||C.odoo_db_name||C.odoo_username||C.odoo_password)&&(!C.odoo_base_url||!C.odoo_db_name||!C.odoo_username||!g&&!C.odoo_password)?{ok:!1,message:"Odoo incompleto: base_url, db_name, username, password."}:{ok:!0}}function Te(S){if(!S)return"Verificacion completada";const F=[];if(S.database){const q=S.database.ok?"DB ok":"DB error",se=typeof S.database.latency_ms=="number"?` (${S.database.latency_ms}ms)`:"";F.push(`${q}${se}`)}if(S.odoo){const q=S.odoo.ok?"Odoo ok":"Odoo error",se=typeof S.odoo.latency_ms=="number"?` (${S.odoo.latency_ms}ms)`:"";F.push(`${q}${se}`)}return F.length?`Verificacion completada: ${F.join(" | ")}`:"Verificacion completada"}function $s(S){if(S!=null&&S.database&&!S.database.ok){const F=S.database.details||S.database.error;return kn(F||"Error en DB")}if(S!=null&&S.odoo&&!S.odoo.ok){const F=S.odoo.details||S.odoo.error;return kn(F||"Error en Odoo")}return"No se pudo validar conexion"}function kn(S){const F=(S||"").toString(),q=F.toLowerCase();return q.includes("missing")?"Completa los campos de Odoo":q.includes("db_connection_failed")?"No se pudo conectar a la base de datos":q.includes("odoo")&&q.includes("failed")?"No se pudo autenticar en Odoo":F||"No se pudo validar conexion"}async function Bn(){const S=R();if(!S.ok){P(S.message);return}y(!0),P("Verificando conexion...");try{const F=await Le("/api/superadmin/tenants/validate",{db_url:C.db_url.trim(),odoo_base_url:C.odoo_base_url.trim(),odoo_db_name:C.odoo_db_name.trim(),odoo_username:C.odoo_username.trim(),odoo_password:C.odoo_password.trim()}),q=Te(F.checks);P(q),F.ok?H({message:q}):H({type:"error",message:$s(F.checks)})}catch(F){P("Error validando conexion"),H({type:"error",message:F.message||"No se pudo validar conexion"})}finally{y(!1)}}async function ns(S){var q;if(S.preventDefault(),G&&!$t)return;const F=R();if(!F.ok){A(F.message);return}try{M(!0),A("");let se=g;if(se?await ut(`/api/superadmin/tenants/${se}`,{name:C.name.trim(),slug:C.slug.trim(),plan:C.plan.trim(),is_active:T}):se=(q=(await Le("/api/superadmin/tenants",{name:C.name.trim(),slug:C.slug.trim(),plan:C.plan.trim()})).tenant)==null?void 0:q.id,!se)throw new Error("tenant_not_ready");if(C.db_url.trim()&&await Le(`/api/superadmin/tenants/${se}/database`,{db_url:C.db_url.trim()}),(C.brand_name.trim()||C.logo_url.trim())&&await ut("/api/superadmin/branding",{tenant_id:se,brand_name:C.brand_name.trim(),logo_url:C.logo_url.trim()||null,colors:null}),C.odoo_base_url||C.odoo_db_name||C.odoo_username||C.odoo_password){const ft={tenant_id:se,base_url:C.odoo_base_url.trim(),db_name:C.odoo_db_name.trim(),username:C.odoo_username.trim()};C.odoo_password.trim()&&(ft.password=C.odoo_password.trim()),await ut("/api/superadmin/odoo",ft)}if(await fe(),g){const ft=Qt(C);m(ft),pe(ft),Ee(T),P("Cambios guardados"),H({message:"Tenant actualizado correctamente"})}else on(),H({message:"Tenant creado correctamente"})}catch(se){A(se.message||"No se pudo guardar tenant."),H({type:"error",message:se.message||"No se pudo guardar tenant"})}finally{M(!1)}}async function bn(){if(!g)return;const S=!T;try{M(!0),A(""),await ut(`/api/superadmin/tenants/${g}`,{is_active:S}),K(S),Ee(S),P(S?"Tenant reactivado":"Tenant bloqueado"),await fe()}catch(F){A(F.message||"No se pudo cambiar estado del tenant.")}finally{M(!1)}}const $t=h.useMemo(()=>!g&&!G||T!==ke?!0:Object.keys(oe).some(S=>{const F=String(C[S]??""),q=String(oe[S]??"");return F!==q}),[ke,oe,T,g,G,C]);return h.useEffect(()=>{if(G&&k&&k!==g){lt(k);return}U&&(g||Ae)&&on()},[Ae,g,U,G,k]),s.jsxs("div",{className:"sa-shell",children:[s.jsxs("aside",{className:"sa-rail",children:[s.jsx("div",{className:"sa-rail-logo",children:"PRZV"}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${ne?"":"active"}`,onClick:zt,children:[s.jsx(ky,{className:"sa-rail-icon"}),s.jsx("span",{children:"Dashboard"})]}),s.jsxs("button",{type:"button",className:`sa-rail-btn ${U?"active":""}`,onClick:Ke,children:[s.jsx(du,{className:"sa-rail-icon"}),s.jsx("span",{children:"Nuevo"})]}),s.jsxs("button",{type:"button",className:"sa-rail-btn",children:[s.jsx(by,{className:"sa-rail-icon"}),s.jsx("span",{children:"Ajustes"})]}),s.jsxs("div",{className:"sa-rail-footer",children:[s.jsx("div",{className:"sa-avatar",children:"SA"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-role",children:"Superadmin"}),s.jsx("div",{className:"sa-meta",children:"Control plane"})]})]})]}),s.jsxs("main",{className:"sa-main",children:[!ne&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-topbar",children:[s.jsxs("div",{children:[s.jsx("div",{className:"sa-kicker",children:"Panel de control Perzivalh"}),s.jsxs("div",{className:"sa-title",children:["Sistema operativo ",s.jsx("span",{className:"sa-dot"})]}),s.jsx("div",{className:"sa-subtitle",children:"Estado general del entorno"})]}),s.jsxs("div",{className:"sa-top-actions",children:[s.jsx("span",{className:"sa-version",children:"v0.4 stable"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:fe,children:"Recargar"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"}),s.jsx("button",{className:"sa-btn primary",type:"button",onClick:Ke,children:"Nuevo tenant"})]})]}),s.jsxs("section",{className:"sa-kpi-grid",children:[s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Total de empresas (tenants)"}),s.jsx("div",{className:"sa-kpi-value",children:Me}),s.jsxs("div",{className:"sa-kpi-meta",children:["+",Ge," activas"]})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Usuarios activos totales"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"En tiempo real"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Mensajes hoy"}),s.jsx("div",{className:"sa-kpi-value",children:"--"}),s.jsx("div",{className:"sa-kpi-meta",children:"Canal API"})]}),s.jsxs("div",{className:"sa-kpi-card",children:[s.jsx("div",{className:"sa-kpi-label",children:"Conexiones Odoo activas"}),s.jsxs("div",{className:"sa-kpi-value",children:[Bt,"%"]}),s.jsxs("div",{className:"sa-kpi-meta",children:[ve," sincronizadas"]})]})]}),s.jsxs("section",{className:"sa-table-card",children:[s.jsxs("div",{className:"sa-table-header",children:[s.jsxs("div",{className:"sa-search",children:[s.jsx(Cy,{className:"sa-search-icon"}),s.jsx("input",{value:_,onChange:S=>v(S.target.value),placeholder:"Filtrar empresas..."})]}),s.jsxs("div",{className:"sa-table-actions",children:[s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Ordenar por salud"}),s.jsx("button",{className:"sa-btn ghost",type:"button",children:"Exportar CSV"})]})]}),s.jsxs("div",{className:"sa-table",children:[s.jsxs("div",{className:"sa-table-head",children:[s.jsx("div",{children:"ID referencia"}),s.jsx("div",{children:"Nombre de la empresa"}),s.jsx("div",{children:"Estado"}),s.jsx("div",{children:"Uso de recursos"}),s.jsx("div",{children:"Tiempo de actividad"}),s.jsx("div",{children:"Acciones"})]}),X.length?X.map(S=>{var _e;const F=_n(S.id||"tenant"),q=S.has_database?"db":"no-db",se=S.has_database;return s.jsxs("div",{className:"sa-table-row",children:[s.jsx("div",{className:"sa-ref",children:((_e=S.slug)==null?void 0:_e.toUpperCase())||"TENANT"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-tenant-name",children:S.name}),s.jsx("div",{className:"sa-tenant-meta",children:S.id.slice(0,8)})]}),s.jsx("div",{className:`sa-status ${S.is_active?"ok":"warn"}`,children:S.is_active?"activo":"inactivo"}),s.jsxs("div",{children:[s.jsx("div",{className:"sa-progress",children:s.jsx("span",{className:`sa-progress-fill ${q}`,style:{width:`${F}%`}})}),s.jsxs("div",{className:"sa-tenant-meta",children:[F,"% carga"]})]}),s.jsx("div",{className:"sa-tenant-meta",children:Gt(S.created_at)}),s.jsx("div",{children:s.jsxs("div",{className:"sa-action-group",children:[s.jsx("button",{className:"sa-action",type:"button",onClick:()=>cn(S.id),disabled:!se||z===S.id,children:se?z===S.id?"Entrando...":"Entrar":"Sin DB"}),s.jsx("button",{className:"sa-link",type:"button",onClick:()=>Ye(S),children:s.jsx(Ey,{className:"sa-link-icon"})})]})})]},S.id)}):s.jsx("div",{className:"sa-empty",children:"Sin tenants para mostrar."})]}),s.jsxs("div",{className:"sa-footer-note",children:["Mostrando ",X.length||0," empresas en produccion"]})]})]}),ne&&s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"sa-create-header",children:[s.jsx("button",{className:"sa-back",type:"button",onClick:zt,children:"Volver al dashboard"}),s.jsx("div",{className:"sa-create-title",children:G?"Editar tenant":"Registrar nuevo tenant"}),s.jsxs("div",{className:"sa-create-actions",children:[s.jsx("div",{className:"sa-create-meta",children:"Modo: superadmin"}),s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:r,children:"Cerrar sesion"})]})]}),N?s.jsx("div",{className:"sa-alert",children:N}):null,s.jsxs("form",{className:"sa-form",onSubmit:ns,children:[s.jsxs("div",{className:"sa-form-grid sa-form-grid-2",children:[s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Identidad del tenant"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Nombre de la empresa"}),s.jsx("input",{value:C.name,onChange:S=>m({...C,name:S.target.value}),placeholder:"Ej. Empresa Alfa"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Subdominio reservado"}),s.jsx("input",{value:C.slug,onChange:S=>m({...C,slug:S.target.value}),placeholder:"alfa-salud"})]}),s.jsxs("div",{className:"sa-field sa-field-row",children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Plan"}),s.jsxs("select",{value:C.plan,onChange:S=>m({...C,plan:S.target.value}),children:[s.jsx("option",{value:"",children:"Seleccionar"}),Sy.map(S=>s.jsx("option",{value:S.value,children:S.label},S.value))]})]}),G&&s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Estado del tenant"}),s.jsxs("select",{value:T?"active":"inactive",onChange:S=>K(S.target.value==="active"),children:[s.jsx("option",{value:"active",children:"Activo"}),s.jsx("option",{value:"inactive",children:"Bloqueado"})]})]})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Brand name"}),s.jsx("input",{value:C.brand_name,onChange:S=>m({...C,brand_name:S.target.value}),placeholder:"Perzivalh"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Logo URL"}),s.jsx("input",{value:C.logo_url,onChange:S=>m({...C,logo_url:S.target.value}),placeholder:"https://"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Paleta de colores"}),s.jsx("div",{className:"sa-note",children:"Personalizacin deshabilitada por ahora."})]}),!G&&s.jsx("div",{className:"sa-note",children:"Nota: al registrar un tenant se inicia el aprovisionamiento en el entorno de produccion."})]}),s.jsxs("div",{className:"sa-form-section",children:[s.jsx("div",{className:"sa-section-title",children:"Variables de entorno (envs)"}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Base de datos"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Tenant DB URL"}),s.jsx("input",{value:C.db_url,onChange:S=>m({...C,db_url:S.target.value}),placeholder:"postgresql://..."})]})]}),s.jsxs("div",{className:"sa-subsection",children:[s.jsx("div",{className:"sa-subsection-title",children:"Odoo (opcional)"}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Base URL"}),s.jsx("input",{value:C.odoo_base_url,onChange:S=>m({...C,odoo_base_url:S.target.value}),placeholder:"https://odoo-instancia"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo DB Name"}),s.jsx("input",{value:C.odoo_db_name,onChange:S=>m({...C,odoo_db_name:S.target.value}),placeholder:"db_tenant_prod"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo User"}),s.jsx("input",{value:C.odoo_username,onChange:S=>m({...C,odoo_username:S.target.value}),placeholder:"usuario@empresa.com"})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{children:"Odoo Password (opcional)"}),s.jsx("input",{type:"password",value:C.odoo_password,onChange:S=>m({...C,odoo_password:S.target.value}),placeholder:"********"})]})]})]})]}),s.jsxs("div",{className:"sa-form-actions",children:[s.jsx("div",{className:"sa-status-note",children:G?Ae?"Cargando datos...":$t?"Cambios pendientes":"Sin cambios":O}),s.jsx("div",{className:"sa-form-buttons",children:G?s.jsxs(s.Fragment,{children:[$t&&s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:b,children:b?"Guardando...":"Guardar cambios"}),s.jsx("button",{className:"sa-btn danger",type:"button",onClick:bn,disabled:b||!g,children:T?"Bloquear tenant":"Reactivar tenant"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"sa-btn ghost",type:"button",onClick:Bn,disabled:f||b,children:f?"Validando...":"Validar conexion"}),s.jsx("button",{className:"sa-btn primary",type:"submit",disabled:b,children:b?"Guardando...":"Desplegar instancia"})]})})]})]}),g?s.jsx(My,{channels:u.length?u:l.filter(S=>S.tenant_id===g),tenantId:g,onRefresh:Sn}):s.jsx("div",{style:{marginTop:"2rem",padding:"1rem",border:"1px dashed rgba(255,255,255,0.2)",borderRadius:"12px",color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",textAlign:"center"},children:"Crea el tenant primero para configurar las lneas de WhatsApp."}),g&&s.jsx(_y,{tenantId:g,tenantBots:he,availableFlows:te,loading:be,onToggleBot:St,onAddBot:W,onRemoveBot:Ie,onUpdateBotConfig:ye})]})]})]})}const $h=["open","pending","assigned"],Uh=["admin","recepcion","caja","marketing","doctor"],Gn={admin:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!0},campaigns:{read:!0,write:!0},settings:{read:!0,write:!0}},settings:{general:{read:!0,write:!0},users:{read:!0,write:!0},bot:{read:!0,write:!0},templates:{read:!0,write:!0},audit:{read:!0,write:!0},odoo:{read:!0,write:!0}}},recepcion:{modules:{chat:{read:!0,write:!0},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},caja:{modules:{chat:{read:!0,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},marketing:{modules:{chat:{read:!1,write:!1},dashboard:{read:!0,write:!1},campaigns:{read:!0,write:!0},settings:{read:!0,write:!1}},settings:{general:{read:!0,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!0,write:!0},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}},doctor:{modules:{chat:{read:!0,write:!1},dashboard:{read:!1,write:!1},campaigns:{read:!1,write:!1},settings:{read:!1,write:!1}},settings:{general:{read:!1,write:!1},users:{read:!1,write:!1},bot:{read:!1,write:!1},templates:{read:!1,write:!1},audit:{read:!1,write:!1},odoo:{read:!1,write:!1}}}};function uc(e){if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleString()}function Iy(e){if(!e)return"-";const t=new Date(e);if(Number.isNaN(t.getTime()))return"-";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):i===1?"Ayer":["Dom","Lun","Mar","Mie","Jue","Vie","Sab"][t.getDay()]}function Fh(e){if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((r-a)/864e5);return i===0?"Hoy":i===1?"Ayer":`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}function ie(e){if(!e)return"Error inesperado";if(typeof e=="string")return e==="offline"?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":e==="network_error"?"No se pudo conectar con el servidor. Intenta de nuevo.":e==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":e;const t=e.message||"Error inesperado";return t==="offline"||t.toLowerCase().includes("failed to fetch")?"Sin conexin a internet. Revisa tu red y vuelve a intentar.":t==="network_error"||t.toLowerCase().includes("networkerror")?"No se pudo conectar con el servidor. Intenta de nuevo.":t==="request_failed"?"No se pudo completar la solicitud. Intenta nuevamente.":t}function Dy(e,t){return e?t.includes(e.role):!1}function dc(e){if(!e||typeof e!="object")return{...Gn};const t={...Gn};return Object.entries(e).forEach(([n,r])=>{var a,i;!r||typeof r!="object"||(t[n]={modules:{...(a=Gn[n])==null?void 0:a.modules,...r.modules},settings:{...(i=Gn[n])==null?void 0:i.settings,...r.settings}})}),t}function bt(e,t,n,r="read"){var i;const a=(i=e==null?void 0:e[t])==null?void 0:i[n];return a?!!a[r]:!1}function Sr(e){const t=n=>n.status==="pending"&&!n.assigned_user_id?0:n.status==="pending"&&n.assigned_user_id?1:n.status==="assigned"?2:3;return[...e].sort((n,r)=>{const a=t(n),i=t(r);if(a!==i)return a-i;const l=new Date(n.last_message_at||n.created_at||0).getTime();return new Date(r.last_message_at||r.created_at||0).getTime()-l})}function By(e){const t=new URLSearchParams;Object.entries(e||{}).forEach(([r,a])=>{a==null||a===""||t.append(r,a)});const n=t.toString();return n?`?${n}`:""}function Vh(e){if(!e)return"?";const t=e.trim();return t?t[0].toUpperCase():"?"}function Wh(e){if(typeof document>"u")return;const t=document.documentElement.style;t.removeProperty("--accent"),t.removeProperty("--accent-strong"),t.removeProperty("--accent-soft"),t.removeProperty("--accent-soft-2"),t.removeProperty("--scroll-thumb"),t.removeProperty("--scroll-thumb-hover")}function zy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M4.5 5.5h15v10H8l-3.5 3.5V5.5Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 9h8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M8 12.5h5",strokeWidth:"1.8",strokeLinecap:"round"})]})}function $y(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"}),s.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1.6",strokeWidth:"1.8"})]})}function Uy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M6 9a6 6 0 1 1 12 0c0 4.2 2 5.5 2 5.5H4S6 13.2 6 9Z",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M9.5 19a2.5 2.5 0 0 0 5 0",strokeWidth:"1.8"})]})}function Fy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:"2",strokeLinecap:"round"})]})}function Vy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"4",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 3v2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M12 18.5V21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M3 12h2.5",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M18.5 12H21",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 5.2l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 17l1.8 1.8",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 18.8 7 17",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M17 7l1.8-1.8",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Wy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M20 14.2A8.5 8.5 0 1 1 9.8 4 6.5 6.5 0 0 0 20 14.2Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function Hy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"11",cy:"11",r:"6.5",strokeWidth:"1.8"}),s.jsx("path",{d:"M16.5 16.5 21 21",strokeWidth:"1.8",strokeLinecap:"round"})]})}function qy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("path",{d:"M12 5v14",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("path",{d:"M5 12h14",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Gy(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("rect",{x:"3.5",y:"6",width:"11",height:"12",rx:"2",strokeWidth:"1.8"}),s.jsx("path",{d:"m14.5 10 6-3v10l-6-3",strokeWidth:"1.8"})]})}function Qy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"M6.5 4.5 9 3l2.5 4-2.5 1.5c1.2 2.3 3.2 4.3 5.5 5.5L16 11l4 2.5-1.5 2.5c-.7 1.2-2.2 1.7-3.6 1.3a15.9 15.9 0 0 1-7.7-7.7c-.4-1.4.1-2.9 1.3-3.6Z",strokeWidth:"1.6",strokeLinejoin:"round"})})}function Ky(e){return s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"9",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 10v6",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"7.5",r:"1",fill:"currentColor"})]})}function Yy(e){return s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...e,children:s.jsx("path",{d:"m4 12 15-7-6 14-2.5-5.2L4 12Z",strokeWidth:"1.8",strokeLinejoin:"round"})})}function Xy(){const[e,t]=h.useState(localStorage.getItem("token")||""),[n,r]=h.useState(()=>typeof window<"u"&&localStorage.getItem("superadmin_token")||""),[a,i]=h.useState(null),[l,c]=h.useState(null),[u,p]=h.useState(null),[_,v]=h.useState([]),[N,A]=h.useState({id:"",display_name:"",is_default:!1,is_active:!0}),[O,P]=h.useState(()=>{if(typeof window>"u")return{};try{return JSON.parse(localStorage.getItem("last_read_map")||"{}")}catch{return{}}}),[C,m]=h.useState({email:"",password:""}),[f,y]=h.useState(""),[b,M]=h.useState("chats"),[z,j]=h.useState(()=>typeof window<"u"?window.location.pathname:"/"),[g,B]=h.useState(()=>localStorage.getItem("theme")||"light"),[T,K]=h.useState(()=>typeof window<"u"&&window.navigator?!window.navigator.onLine:!1),[oe,pe]=h.useState(!1),[ke,Ee]=h.useState(!1),[Ae,Pe]=h.useState(!1),[V,te]=h.useState(!0),[ee,he]=h.useState(!1),[ce,be]=h.useState(""),L=h.useRef(null),H=h.useRef(null),k=h.useRef(null),U=h.useRef({conversationId:null,lastId:null,length:0}),G=h.useRef(0),ne=h.useRef(!1),le=h.useRef(0),[fe,X]=h.useState("users"),[Me,Ge]=h.useState("list"),[ve,Bt]=h.useState(()=>dc(null)),[Gt,_n]=h.useState(!1),[on,Ke]=h.useState(!1),[zt,cn]=h.useState(!1),Qt=h.useMemo(()=>{const d=Object.keys(ve||{}).filter(w=>!Uh.includes(w));return[...Uh,...d]},[ve]),[lt,un]=h.useState({status:"",assigned_user_id:"",tag:"",search:"",phone_number_id:""}),et=z.startsWith("/superadmin"),[xe,St]=h.useState([]),[W,Ie]=h.useState(null),[ye,Ye]=h.useState([]),[Sn,R]=h.useState(""),[Te,$s]=h.useState("text"),[kn,Bn]=h.useState([]),[ns,bn]=h.useState([]),[$t,S]=h.useState(""),[F,q]=h.useState(""),[se,_e]=h.useState(""),[dn,ft]=h.useState(!1),[tt,nt]=h.useState({name:"",color:"#6b7280"}),[ss,ea]=h.useState(!1),[rs,re]=h.useState(""),{pushToast:ue}=dd(),hn=h.useRef(new Map),zn=h.useRef(new Map),Us=h.useRef(new Map),as=h.useRef(new Map),ta=h.useRef(new Map),[Fs,pi]=h.useState(null),[$n,na]=h.useState("30d"),[Cn,is]=h.useState(null),[ls,Oe]=h.useState([]),[mi,mr]=h.useState([]),[lo,En]=h.useState(0),[sa,os]=h.useState([]),[cs,ra]=h.useState(""),[aa,gi]=h.useState(null),[oo,us]=h.useState([]),[hd,Vs]=h.useState(null),[pt,ia]=h.useState({name:"",template_id:"",scheduled_for:"",send_now:!0}),[Xe,Ws]=h.useState({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),[la,ot]=h.useState([]),[st,Un]=h.useState({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),[kt,oa]=h.useState(null),[vi,ca]=h.useState({id:"",name:"",language:"es",category:"",body_preview:"",is_active:!0}),[ua,Kt]=h.useState([]),fn=((l==null?void 0:l.brand_name)||(u==null?void 0:u.name)||"Perzivalh").trim(),[Hs,je]=h.useState(!1),[ds,qs]=h.useState(!1),[da,Lt]=h.useState(null),xi=48,co=80,gr=60,ha=320,yi=120,uo=5,ji=2*60*1e3,Gs=h.useRef(new Map);function Ni(){const d=Gs.current;for(;d.size>uo;){const w=d.keys().next().value;d.delete(w)}}function ho(d){const w=Gs.current,E=w.get(d);return E?Date.now()-E.updatedAt>ji?(w.delete(d),null):E:null}function fa(d,w){const E=Gs.current;E.delete(d),E.set(d,{...w,updatedAt:Date.now()}),Ni()}const pn=h.useCallback((d,w={})=>{if(typeof window>"u")return;const E=d||"/";if(window.location.pathname===E){j(E);return}w.replace?window.history.replaceState({},"",E):window.history.pushState({},"",E),j(E)},[]),fo=h.useMemo(()=>ls.find(d=>d.id===pt.template_id),[ls,pt.template_id]),Qs=h.useMemo(()=>{const d=[...ye].reverse().find(w=>w.type==="note");return(d==null?void 0:d.text)||""},[ye]),po=h.useMemo(()=>ye.filter(d=>d.type==="note"),[ye]);h.useEffect(()=>{if(typeof window>"u")return;const d=()=>{j(window.location.pathname||"/")};return window.addEventListener("popstate",d),()=>window.removeEventListener("popstate",d)},[]),h.useEffect(()=>{_r(e||null)},[e]),h.useEffect(()=>{document.body.dataset.theme=g,localStorage.setItem("theme",g)},[g]),h.useEffect(()=>{if(typeof window>"u")return;const d=()=>{K(!window.navigator.onLine)};return d(),window.addEventListener("online",d),window.addEventListener("offline",d),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",d)}},[]),h.useEffect(()=>{he(!1),te(!0),requestAnimationFrame(()=>{hs()}),W&&Ys(W)},[W==null?void 0:W.id]),h.useEffect(()=>{b==="chats"&&(he(!1),te(!0),requestAnimationFrame(()=>{hs()}))},[b,W==null?void 0:W.id]),h.useEffect(()=>{var Ce;if(!W){be("");return}const d=ye[ye.length-1],w=(d==null?void 0:d.id)||(d==null?void 0:d.created_at)||(ye.length?`${ye.length}`:null),E=U.current,ae=E.conversationId===W.id&&d&&E.lastId&&w!==E.lastId;if(ne.current&&ye.length>0){ne.current=!1,requestAnimationFrame(()=>{hs()});return}if(ae?V?hs():he(!0):V&&he(!1),U.current={conversationId:W.id,lastId:w,length:ye.length},fs(),V&&ye.length>ha){const Y=ye.slice(-ha);Ye(Y),Lt(((Ce=Y[0])==null?void 0:Ce.created_at)||null),je(!0)}},[ye,W==null?void 0:W.id,V]),h.useEffect(()=>{var w;if(!(W!=null&&W.id)||!ye.length)return;const d={messages:ye.slice(-yi),cursor:da||((w=ye[0])==null?void 0:w.created_at)||null,hasMore:Hs};fa(W.id,d)},[ye,da,Hs,W==null?void 0:W.id]),h.useEffect(()=>{b!=="chats"&&te(!1)},[b]),h.useEffect(()=>{if(!e)return;let d=!0;return Ne("/api/me").then(w=>{d&&i(w.user)}).catch(()=>{d&&(t(""),i(null))}),()=>{d=!1}},[e]),h.useEffect(()=>{if(!a||a.role==="superadmin"){c(null),v([]),Wh();return}let d=!0;return Ne("/api/branding").then(w=>{d&&c(w.branding||null)}).catch(()=>{d&&c(null)}),Ne("/api/tenant").then(w=>{d&&p(w.tenant||null)}).catch(()=>{d&&p(null)}),Ne("/api/channels").then(w=>{d&&v(w.channels||[])}).catch(()=>{d&&v([])}),()=>{d=!1}},[a]),h.useEffect(()=>{Wh()},[l]),h.useEffect(()=>{if(a){if(a.role==="superadmin"){et||pn("/superadmin",{replace:!0});return}et&&pn("/",{replace:!0})}},[a,et,pn]),h.useEffect(()=>{a&&a.role!=="superadmin"&&(mo(),vr())},[a]),h.useEffect(()=>{a&&a.role!=="superadmin"&&go()},[a]),h.useEffect(()=>{!a||b!=="chats"||a.role!=="superadmin"&&pa()},[a,b,lt]),h.useEffect(()=>{a&&a.role!=="superadmin"&&(b==="dashboard"&&ms($n,Cn),b==="campaigns"&&(gs(),yr(1,6)))},[a,b,$n,Cn]),h.useEffect(()=>{if(!a||b!=="admin")return;const d=(ve==null?void 0:ve[a.role])||Gn[a.role],w=bt(d,"settings","users"),E=bt(d,"settings","bot"),I=bt(d,"settings","general"),ae=bt(d,"settings","templates"),Ce=bt(d,"settings","audit");fe==="users"&&w&&Zs(),fe==="bot"&&E&&Co(),fe==="general"&&I&&ya(),fe==="templates"&&ae&&gs(),fe==="audit"&&Ce&&Li()},[a,b,fe,ve]),h.useEffect(()=>{if(!a||b!=="admin")return;const d=(ve==null?void 0:ve[a.role])||Gn[a.role],E=["general","users","bot","templates","audit","odoo"].filter(I=>bt(d,"settings",I));if(!E.length){M(result.user.role==="superadmin"?"superadmin":"chats");return}E.includes(fe)||X(E[0])},[a,b,fe,ve]),h.useEffect(()=>{if(!e||(a==null?void 0:a.role)==="superadmin")return;const d=qx(e),w={current:null},E=["/sounds/new-notification-09-352705.wav","/sounds/new-notification-09-352705.mp3"],I=()=>{if(w.current)return w.current;const Y=new Audio(E[0]);Y.volume=1;let de=0;return Y.addEventListener("error",()=>{de+=1,de<E.length&&(Y.src=E[de],Y.load())}),w.current=Y,Y},ae=()=>{const Y=I();Y.play().then(()=>{Y.pause(),Y.currentTime=0}).catch(()=>{})};window.addEventListener("click",ae,{once:!0}),window.addEventListener("touchstart",ae,{once:!0});const Ce=()=>{if(!(typeof window>"u"))try{const Y=I();Y.currentTime=0,Y.play().catch(()=>{})}catch{}};return d.on("conversation:update",({conversation:Y})=>{const de=ta.current.get(Y.id);ta.current.set(Y.id,Y.status),Y.status==="pending"&&!Y.assigned_user_id&&de!=="pending"&&(Ce(),ue({message:"Nueva conversacin pendiente"})),St(ze=>{const De=ze.map(yt=>yt.id===Y.id?{...yt,...Y}:yt);return De.find(yt=>yt.id===Y.id)||De.push(Y),Sr(De)}),Ie(ze=>(ze==null?void 0:ze.id)===Y.id?{...ze,...Y}:ze)}),d.on("message:new",({conversation:Y,message:de})=>{Y.status==="pending"&&!Y.assigned_user_id&&Ce();const ze={...Y,last_message_text:(de==null?void 0:de.text)||null,last_message_type:(de==null?void 0:de.type)||null,last_message_direction:(de==null?void 0:de.direction)||null,last_message_at:(de==null?void 0:de.created_at)||Y.last_message_at};St(De=>{const yt=De.map(vs=>vs.id===Y.id?{...vs,...ze}:vs);return yt.find(vs=>vs.id===Y.id)||yt.push(ze),Sr(yt)}),Ie(De=>(De==null?void 0:De.id)===Y.id?{...De,...ze}:De),Ye(De=>!W||W.id!==Y.id?De:(Ys(ze),[...De,de]))}),()=>{d.disconnect()}},[e,W]),h.useEffect(()=>{if(!a)return;if(a.role==="superadmin"){b!=="superadmin"&&M("superadmin");return}const d=(ve==null?void 0:ve[a.role])||Gn[a.role],w=bt(d,"modules","chat"),E=bt(d,"modules","dashboard"),I=bt(d,"modules","campaigns"),ae=bt(d,"modules","settings");b==="chats"&&!w&&M(E?"dashboard":I?"campaigns":"admin"),b==="dashboard"&&!E&&M(w?"chats":I?"campaigns":"admin"),b==="campaigns"&&!I&&M(w?"chats":E?"dashboard":"admin"),b==="admin"&&!ae&&M(w?"chats":E?"dashboard":"campaigns")},[a,b,ve]),h.useEffect(()=>{if(!a||a.role!=="admin"||!Gt||!on||zt)return;const d=setTimeout(()=>{const w=le.current;cn(!0),ut("/api/admin/role-permissions",{permissions:ve}).then(()=>{le.current===w&&Ke(!1)}).catch(E=>{re(ie(E))}).finally(()=>{cn(!1)})},350);return()=>clearTimeout(d)},[a,ve,on,Gt,zt]);async function mo(){try{const d=await Ne("/api/users");bn(d.users||[])}catch(d){re(ie(d))}}async function go(){try{const d=await Ne("/api/role-permissions"),w=dc(d.permissions||null);le.current=0,Bt(w),Ke(!1),_n(!0)}catch(d){re(ie(d)),_n(!0)}}async function vr(){try{const d=await Ne("/api/tags");Bn(d.tags||[])}catch(d){re(ie(d))}}async function pa(){try{const d=By(lt),w=await Ne(`/api/conversations${d}`);St(Sr(w.conversations||[]))}catch(d){re(ie(d))}}async function vo(d){var ae,Ce;ne.current=!0;const w=ho(d),E=xe.find(Y=>Y.id===d);ea(!w),xr(),E&&Ie(E),w&&(Ye(w.messages||[]),Lt(w.cursor||null),je(!!w.hasMore),fs(),requestAnimationFrame(()=>{hs()}));const I=G.current+1;G.current=I;try{const Y=`?limit=${co}&window_hours=${xi}`,de=await Ne(`/api/conversations/${d}${Y}`);if(G.current!==I)return;let ze=de.conversation;const De=de.messages||[];if((ze==null?void 0:ze.status)==="pending"&&!ze.assigned_user_id&&(a!=null&&a.id))try{ze=(await ut(`/api/conversations/${d}/assign`,{})).conversation,St(vs=>Sr(vs.map(er=>er.id===d?{...er,...ze}:er)))}catch(yt){String(ie(yt)).includes("already_assigned")&&ue({type:"error",message:"Conversacin tomada por otro operador"})}Ie(ze),Ye(De),je(!!de.has_more),Lt(de.next_cursor||((ae=De[0])==null?void 0:ae.created_at)||null),fa(d,{messages:De.slice(-yi),cursor:de.next_cursor||((Ce=De[0])==null?void 0:Ce.created_at)||null,hasMore:!!de.has_more}),Ys(ze)}catch(Y){re(ie(Y))}finally{G.current===I&&ea(!1)}}async function mt(d){var Ce;if(!Hs||ds)return;const w=da;if(!w){je(!1);return}qs(!0);const E=H.current,I=E?E.scrollHeight:0,ae=E?E.scrollTop:0;try{const Y=`?limit=${gr}&before=${encodeURIComponent(w)}`,de=await Ne(`/api/conversations/${d}${Y}`);if((W==null?void 0:W.id)!==d)return;const ze=de.messages||[];ze.length?(Ye(De=>{const yt=new Set(De.map(er=>er.id));return[...ze.filter(er=>!yt.has(er.id)),...De]}),Lt(de.next_cursor||((Ce=ze[0])==null?void 0:Ce.created_at)||w),je(!!de.has_more),requestAnimationFrame(()=>{const De=H.current;if(!De)return;const yt=De.scrollHeight;De.scrollTop=yt-I+ae})):je(!1)}catch(Y){re(ie(Y))}finally{qs(!1)}}async function wi(d){d.preventDefault(),y("");try{const w=await Le("/api/auth/login",{email:C.email,password:C.password});t(w.token),_r(w.token),i(w.user),r(""),localStorage.removeItem("superadmin_token");const E=w.user.role==="superadmin";M(E?"superadmin":"chats"),E?pn("/superadmin",{replace:!0}):et&&pn("/",{replace:!0})}catch{y("Credenciales invalidas")}}function ct(){t(""),_r(null),i(null),St([]),Ie(null),Ye([]),M("chats"),Pe(!1),Bt(dc(null)),_n(!1),Ke(!1),cn(!1),le.current=0,r(""),localStorage.removeItem("superadmin_token"),pn("/",{replace:!0})}async function ma(d){const w=await Le(`/api/superadmin/tenants/${d}/impersonate`);!n&&e&&(localStorage.setItem("superadmin_token",e),r(e)),t(w.token),_r(w.token),i(w.user),M("chats"),pn("/",{replace:!0})}function _i(){const d=n||(typeof window<"u"?localStorage.getItem("superadmin_token"):"");if(!d){ct();return}localStorage.removeItem("superadmin_token"),r(""),t(d),_r(d),i(null),M("chats"),pn("/superadmin",{replace:!0})}function Si(d){Bt(w=>typeof d=="function"?d(w):d),le.current+=1,Ke(!0)}function Ks(){B(d=>d==="light"?"dark":"light")}function hs(){const d=H.current;d&&(d.scrollTop=d.scrollHeight,te(!0),he(!1),fs())}function Ys(d){!(d!=null&&d.id)||!(d!=null&&d.last_message_at)||P(w=>{const E={...w,[d.id]:d.last_message_at};return localStorage.setItem("last_read_map",JSON.stringify(E)),E})}function Xs(){const d=H.current;if(!d)return;const E=d.scrollHeight-d.scrollTop-d.clientHeight<24;te(E),E&&he(!1),d.scrollTop<120&&Hs&&!ds&&W&&mt(W.id),fs()}function xr(){Ye([]),Lt(null),je(!1),qs(!1),U.current={conversationId:null,lastId:null,length:0}}function fs(){k.current||(k.current=requestAnimationFrame(()=>{k.current=null,Js()}))}function Js(){const d=H.current;if(!d)return;const w=d.querySelectorAll(".day-pill");if(!w.length){be("");return}const E=d.scrollTop,I=12;let ae=w[0];for(const Y of w)if(Y.offsetTop-I<=E)ae=Y;else break;const Ce=ae.dataset.dayLabel||ae.textContent||"";be(Ce)}function Fn(){Ie(null),xr()}function ps(d){var w;R(d),(w=L.current)==null||w.focus()}async function ki(d){if(d.preventDefault(),!W||!Sn.trim())return;const w=Sn.trim();R("");try{await Le(`/api/conversations/${W.id}/messages`,{text:w,type:Te})}catch(E){re(ie(E))}}async function ga(d){if(d.preventDefault(),!W||!F.trim())return;const w=F.trim();q("");try{const E=await Le(`/api/conversations/${W.id}/messages`,{text:w,type:"note"});E!=null&&E.message&&Ye(I=>[...I,E.message]),E!=null&&E.conversation&&Ie(E.conversation)}catch(E){re(ie(E))}}async function An(){if(W)try{const d=await ut(`/api/conversations/${W.id}/assign`);Ie(d.conversation),St(w=>Sr(w.map(E=>E.id===d.conversation.id?{...E,...d.conversation}:E)))}catch(d){const w=ie(d)||"No se pudo tomar la conversacion";ue({type:"error",message:w})}}async function xo(){if(!(!W||!se))try{const d=await ut(`/api/conversations/${W.id}/assign`,{user_id:se});Ie(d.conversation),St(w=>Sr(w.map(E=>E.id===d.conversation.id?{...E,...d.conversation}:E))),_e(""),ue({message:"Conversacin reasignada"})}catch(d){const w=ie(d)||"No se pudo reasignar";ue({type:"error",message:w})}}async function yo(d){var w;if(W)try{let I=(await ut(`/api/conversations/${W.id}/status`,{status:d})).conversation;if(d==="open"&&((w=I==null?void 0:I.tags)!=null&&w.length)){const ae=I.tags.find(Ce=>(Ce.name||"").toLowerCase()==="pendiente");if(ae)try{I=(await Le(`/api/conversations/${I.id}/tags`,{add:[],remove:[ae.name]})).conversation||I}catch{I={...I,tags:I.tags.filter(Y=>Y.name!==ae.name)}}}Ie(I),St(ae=>ae.map(Ce=>Ce.id===I.id?{...Ce,...I}:Ce))}catch(E){re(ie(E))}}async function va(d){var E;if(!W)return;const w=((E=W.tags)==null?void 0:E.some(I=>I.name===d))||!1;if(w){const I=`${W.id}:${d}`;if(as.current.has(I))return;const ae=W,Ce={...W,tags:(W.tags||[]).filter(de=>de.name!==d)};Ie(Ce);const Y=setTimeout(async()=>{try{const de=await Le(`/api/conversations/${ae.id}/tags`,{add:[],remove:[d]});(W==null?void 0:W.id)===ae.id&&Ie(de.conversation)}catch(de){(W==null?void 0:W.id)===ae.id&&Ie(ae),ue({type:"error",message:ie(de)||"No se pudo eliminar el tag"})}finally{as.current.delete(I)}},8e3);as.current.set(I,{timer:Y,snapshot:ae}),ue({message:"Tag eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const de=as.current.get(I);de!=null&&de.timer&&clearTimeout(de.timer),de!=null&&de.snapshot?Ie(de.snapshot):Ie(ae),as.current.delete(I),ue({message:"Eliminacin cancelada"})}});return}try{const I=await Le(`/api/conversations/${W.id}/tags`,{add:w?[]:[d],remove:w?[d]:[]});Ie(I.conversation)}catch(I){re(ie(I))}}async function jo(d){if(d.preventDefault(),!$t.trim()||!W)return;const w=$t.trim();S("");try{const E=await Le(`/api/conversations/${W.id}/tags`,{add:[w]});Ie(E.conversation),await vr()}catch(E){re(ie(E))}}async function bi(d){d.preventDefault();const w=tt.name.trim();if(!w){re("Completa el nombre de la etiqueta");return}try{await Le("/api/tags",{name:w,color:tt.color||null}),nt({name:"",color:"#6b7280"}),await vr(),ue({message:"Etiqueta creada"})}catch(E){re(ie(E))}}async function Ci(d,w){if(d)try{await ks(`/api/tags/${d}`),Ie(E=>E&&{...E,tags:(E.tags||[]).filter(I=>I.name!==w)}),await vr(),ue({message:"Etiqueta eliminada"})}catch(E){re(ie(E))}}async function ms(d="30d",w=null){try{const E=new URLSearchParams;E.set("period",d),w&&E.set("channel",w);const I=await Ne(`/api/dashboard/metrics?${E.toString()}`);pi(I)}catch(E){re(ie(E))}}async function No(){try{const d=new URLSearchParams;d.set("period",$n),Cn&&d.set("channel",Cn);const w="http://localhost:3000",E=localStorage.getItem("token"),I=await fetch(`${w}/api/dashboard/report?${d.toString()}`,{headers:{Authorization:`Bearer ${E}`}});if(!I.ok)throw new Error("report_failed");const ae=await I.blob(),Ce=URL.createObjectURL(ae),Y=document.createElement("a");Y.href=Ce,Y.download=`reporte-dashboard-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y),URL.revokeObjectURL(Ce),ue({message:"Reporte descargado"})}catch(d){re(ie(d))}}async function gs(){try{const d=await Ne("/api/templates").catch(()=>Ne("/api/admin/templates"));Oe(d.templates||[])}catch(d){re(ie(d))}}async function yr(d=1,w=6,E=""){try{const I=new URLSearchParams({page:String(d),page_size:String(w)});E&&I.set("q",E);const ae=await Ne(`/api/admin/campaigns?${I.toString()}`);mr(ae.campaigns||[]),En(Number.isFinite(ae.total)?ae.total:(ae.campaigns||[]).length)}catch(I){re(ie(I))}}async function wo(d){ra(d);try{const w=await Ne(`/api/admin/campaigns/${d}/messages`);os(w.messages||[])}catch(w){re(ie(w))}}async function xa(d){var w;if(d.preventDefault(),!pt.name.trim()||!pt.template_id){re("Completa el nombre y plantilla");return}Xe.status&&Xe.status,Xe.tag&&Xe.tag.trim(),Xe.assigned_user_id&&Xe.assigned_user_id,Xe.verified_only,Xe.segment_id&&(Xe.segment_id,Xe.segment_name&&Xe.segment_name);try{const E=await Le("/api/admin/campaigns",{name:pt.name.trim(),template_id:pt.template_id,audience_filter:Xe.segment_id?{segment_id:Xe.segment_id}:Xe,scheduled_for:pt.scheduled_for||null});if(pt.send_now&&!pt.scheduled_for){const I=(w=E==null?void 0:E.campaign)==null?void 0:w.id;I&&await Le(`/api/admin/campaigns/${I}/send`,{})}ia({name:"",template_id:"",scheduled_for:"",send_now:!0}),Ws({status:"",tag:"",assigned_user_id:"",verified_only:!1,segment_id:"",segment_name:""}),await yr(1,6),ue({message:"Campaa creada correctamente"})}catch(E){re(ie(E)),ue({type:"error",message:ie(E)||"Error al crear campaa"})}}async function _o(d){try{await Le(`/api/admin/campaigns/${d}/send`,{}),await yr(1,6)}catch(w){re(ie(w))}}async function So(){try{await Ne("/api/templates/sync"),await gs()}catch(d){re(ie(d))}}async function Zs(){try{const d=await Ne("/api/admin/users");ot(d.users||[])}catch(d){re(ie(d))}}async function ko(d){if(d.preventDefault(),!st.name.trim()||!st.role){re("Completa los campos requeridos");return}try{st.id?(await ut(`/api/admin/users/${st.id}`,{name:st.name.trim(),role:st.role,is_active:st.is_active,password:st.password||void 0}),ue({message:"Usuario actualizado correctamente"})):(await Le("/api/admin/users",{name:st.name.trim(),email:st.email.trim().toLowerCase(),role:st.role,password:st.password}),ue({message:"Usuario creado correctamente"})),Un({id:"",name:"",email:"",role:"recepcion",password:"",is_active:!0}),await Zs()}catch(w){re(ie(w)),ue({type:"error",message:ie(w)||"Error al guardar usuario"})}}async function bo(d){if(!d||hn.current.has(d))return;let w=null;try{w=la.slice(),ot(I=>I.filter(ae=>ae.id!==d));const E=setTimeout(async()=>{try{await ks(`/api/admin/users/${d}`),await Zs(),ue({message:"Usuario eliminado definitivamente"})}catch(I){w?ot(w):await Zs(),ue({type:"error",message:ie(I)||"No se pudo eliminar el usuario"})}finally{hn.current.delete(d)}},8e3);hn.current.set(d,{timer:E,snapshot:w}),ue({message:"Usuario eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const I=hn.current.get(d);I!=null&&I.timer&&clearTimeout(I.timer),I!=null&&I.snapshot?ot(I.snapshot):w?ot(w):await Zs(),hn.current.delete(d),ue({message:"Eliminacin cancelada"})}})}catch(E){re(ie(E)),ue({type:"error",message:ie(E)||"Error al eliminar usuario"})}}async function Co(){try{const d=await Ne("/api/admin/settings");oa(d.settings)}catch(d){re(ie(d))}}async function Eo(){if(kt)try{const d=await ut("/api/admin/settings",{bot_enabled:kt.bot_enabled,auto_reply_enabled:kt.auto_reply_enabled});oa(d.settings)}catch(d){re(ie(d))}}async function ya(){try{const d=await Ne("/api/channels");v(d.channels||[])}catch{v([])}}function Ao(d){A({id:d.id,display_name:d.display_name||"",is_default:!!d.is_default,is_active:d.is_active!==!1})}async function To(d){if(d.preventDefault(),!!N.id)try{await ut(`/api/channels/${N.id}`,{display_name:N.display_name.trim(),is_default:!!N.is_default,is_active:!!N.is_active}),A({id:"",display_name:"",is_default:!1,is_active:!0}),await ya(),ue({message:"Canal actualizado correctamente"})}catch(w){re(ie(w)),ue({type:"error",message:ie(w)||"Error al guardar canal"})}}async function Lo(d,w){if(!(!d||!w||typeof w!="object"))try{if(await ut(`/api/channels/${d}`,w),await ya(),w.is_default===!0){ue({message:"Linea principal actualizada"});return}w.is_active!==void 0&&ue({message:w.is_active?"Linea activada":"Linea desactivada"})}catch(E){re(ie(E)),ue({type:"error",message:ie(E)||"Error al actualizar linea"})}}async function Ro(d){const w=ve==null?void 0:ve[d];if(!(!d||zn.current.has(d)))try{Bt(I=>{const ae={...I};return delete ae[d],ae});const E=setTimeout(async()=>{try{await ks(`/api/admin/role-permissions/${d}`),ue({message:"Rol eliminado definitivamente"})}catch(I){w&&Bt(ae=>({...ae,[d]:w})),ue({type:"error",message:ie(I)||"No se pudo eliminar el rol"})}finally{zn.current.delete(d)}},8e3);zn.current.set(d,{timer:E,currentPermissions:w}),ue({message:"Rol eliminado. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const I=zn.current.get(d);I!=null&&I.timer&&clearTimeout(I.timer),I!=null&&I.currentPermissions&&Bt(ae=>({...ae,[d]:I.currentPermissions})),zn.current.delete(d),ue({message:"Eliminacin cancelada"})}})}catch(E){re(ie(E)),ue({type:"error",message:ie(E)||"Error al eliminar rol"})}}async function Ei(d,w){d!=null&&d.preventDefault&&d.preventDefault();const E=w||vi||{},I=typeof E.name=="string"?E.name.trim():"";if(!I)return re("Completa el nombre"),null;const ae={name:I,category:E.category||"UTILITY",language:E.language||"es",body_text:E.body_text||E.body_preview||"",header_type:E.header_type||null,header_content:E.header_content||null,footer_text:E.footer_text||null,buttons:E.buttons||E.buttons_json||[]},Ce=E.variable_mappings||E.variableMappings||[];try{let Y=null;return E.id?(Y=await Ul(`/api/templates/${E.id}`,ae),await Ul(`/api/templates/${E.id}/mappings`,{mappings:Ce}),ue({message:"Borrador actualizado correctamente"})):(Y=await Le("/api/templates/draft",{...ae,variable_mappings:Ce}),ue({message:"Borrador creado correctamente"})),await gs(),(Y==null?void 0:Y.template)||null}catch(Y){return re(ie(Y)),ue({type:"error",message:ie(Y)||"Error al guardar plantilla"}),null}}async function Ai(d){if(d)try{await Le(`/api/templates/${d}/submit`,{}),await gs(),ue({message:"Plantilla enviada a revisin de Meta"})}catch(w){re(ie(w)),ue({type:"error",message:ie(w)||"Error al enviar a Meta"})}}async function Ti(d){if(d&&!Us.current.has(d))try{const w=ls.slice();Oe(I=>I.filter(ae=>ae.id!==d));const E=setTimeout(async()=>{try{await ks(`/api/templates/${d}`),await gs(),ue({message:"Plantilla eliminada definitivamente"})}catch(I){Oe(w),ue({type:"error",message:ie(I)||"No se pudo eliminar la plantilla"})}finally{Us.current.delete(d)}},8e3);Us.current.set(d,{timer:E,snapshot:w}),ue({message:"Plantilla eliminada. Deshacer disponible",actionLabel:"DESHACER",duration:8e3,onAction:async()=>{const I=Us.current.get(d);I!=null&&I.timer&&clearTimeout(I.timer),I!=null&&I.snapshot?Oe(I.snapshot):Oe(w),Us.current.delete(d),ue({message:"Eliminacin cancelada"})}})}catch(w){re(ie(w)),ue({type:"error",message:ie(w)||"Error al eliminar plantilla"})}}async function Li(){try{const d=await Ne("/api/admin/audit?limit=200");Kt(d.logs||[])}catch(d){re(ie(d))}}const Ri={open:0,pending:0,closed:0};((Fs==null?void 0:Fs.status_counts)||[]).forEach(d=>{Ri[d.status]=d._count.status});const o=et?"Acceso al control plane":"Acceso a bandeja multiusuario";if(!e||!a)return s.jsx("div",{className:"login-shell",children:s.jsxs("div",{className:"login-card",children:[s.jsx("div",{className:"login-title",children:"Perzivalh"}),s.jsx("div",{className:"login-subtitle",children:o}),T?s.jsx(Wa,{variant:"offline",title:"Sin conexin",message:"No tienes internet en este momento. Conctate y vuelve a intentar iniciar sesin.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):null,s.jsxs("form",{className:"login-form",onSubmit:wi,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Email"}),s.jsx("input",{type:"email",value:C.email,onChange:d=>m(w=>({...w,email:d.target.value})),required:!0})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Password"}),s.jsx("input",{type:"password",value:C.password,onChange:d=>m(w=>({...w,password:d.target.value})),required:!0})]}),f?s.jsx("div",{className:"error",children:f}):null,s.jsx("button",{className:"primary",type:"submit",children:"Entrar"})]})]})});if((a==null?void 0:a.role)==="superadmin"&&et)return s.jsx("main",{className:"superadmin-page",children:s.jsx(zh,{route:z,onNavigate:pn,onImpersonateTenant:ma,onLogout:ct})});const x=(ve==null?void 0:ve[a.role])||Gn[a.role],D=bt(x,"modules","chat"),Q=bt(x,"modules","dashboard"),Z=bt(x,"modules","campaigns"),me=bt(x,"modules","settings"),rt=Dy(a,["admin"]),Rt=bt(x,"modules","chat","write"),Yt=[],jr={open:"Bot activo",pending:"Pendiente",assigned:"Tomada"},Nr=W?W.display_name||W.phone_e164||W.wa_id:"Selecciona un chat",Oo=(W==null?void 0:W.phone_e164)||(W==null?void 0:W.wa_id)||"",Vn=W?jr[W.status]||"Sin estado":"",Tn=[{id:"chats",label:"Chats",icon:zy,enabled:D},{id:"dashboard",label:"Dashboard",icon:$y,enabled:Q},{id:"campaigns",label:"Campaas",icon:Uy,enabled:Z},{id:"admin",label:"Configuraciones",icon:Fy,enabled:me}],Xt=[];let Wn="";ye.forEach(d=>{const w=d.created_at,E=w?new Date(w):null,I=E&&!Number.isNaN(E.getTime())?`${E.getFullYear()}-${E.getMonth()}-${E.getDate()}`:"";if(I&&I!==Wn){const ae=Fh(w);Xt.push(s.jsx("div",{className:"day-pill","data-day-label":ae,children:ae},`day-${I}`)),Wn=I}Xt.push(s.jsxs("div",{className:`message ${d.direction} ${d.type==="note"?"note":""}`,"data-day-key":I,"data-day-label":I?Fh(w):"",children:[s.jsx("div",{className:"message-text",children:d.text||`[${d.type}]`}),s.jsx("div",{className:"message-meta",children:uc(d.created_at)})]},d.id))});const Jt=!!n&&a.role!=="superadmin";return s.jsxs("div",{className:`app-shell ${b==="admin"?"admin-shell":""}`,children:[s.jsx(Kx,{navItems:Tn,view:b,onSetView:M,theme:g,onToggleTheme:Ks,user:a,logoUrl:(l==null?void 0:l.logo_url)||"",brandName:fn,isProfileOpen:Ae,onToggleProfile:()=>Pe(d=>!d),onLogout:ct,onReturnToSuperadmin:_i,showReturnToSuperadmin:Jt,getInitial:Vh,SunIcon:Vy,MoonIcon:Wy}),b==="admin"?s.jsx(Ny,{settingsSection:fe,setSettingsSection:X,settingsTab:Me,setSettingsTab:Ge,rolePermissions:ve,setRolePermissions:Si,defaultRolePermissions:Gn,currentRole:a.role,isAdmin:rt,adminUsers:la,userForm:st,setUserForm:Un,roleOptions:Qt,handleUserSubmit:ko,handleUserDelete:bo,settings:kt,setSettings:oa,handleSaveSettings:Eo,planName:(u==null?void 0:u.plan)||"",tenantChannels:_,channelForm:N,setChannelForm:A,handleChannelSelect:Ao,handleChannelSubmit:To,handleChannelQuickUpdate:Lo,handleRoleDelete:Ro,templates:ls,templateForm:vi,setTemplateForm:ca,handleTemplateSubmit:Ei,handleTemplateSubmitToMeta:Ai,handleTemplateDelete:Ti,handleSyncTemplates:So,auditLogs:ua,formatDate:uc,useShellLayout:!0,pageError:rs,isOffline:T,onDismissError:()=>re(""),brandName:fn}):b==="superadmin"?s.jsx("main",{className:"content content-page",children:s.jsx(zh,{onImpersonateTenant:ma,onLogout:ct})}):s.jsxs("main",{className:`content ${b==="chats"?"content-chats":"content-page"}`,children:[b==="chats"&&s.jsx(Yx,{activeConversation:W,conversations:xe,channels:_,brandName:fn,lastReadMap:O,filters:lt,showFilters:oe,users:ns,tags:kn,statusOptions:$h,statusLabels:jr,formatListTime:Iy,messageBlocks:Xt,messageDraft:Sn,messageMode:Te,quickActions:Yt,tagInput:$t,setTagInput:S,noteInput:F,notesList:po,latestNote:Qs,loadingConversation:ss,isInfoOpen:ke,hasUnread:ee,scrollDayLabel:ce,activeName:Nr,activePhone:Oo,activeStatusLabel:Vn,canManageStatus:Rt,currentUser:a,messageInputRef:L,chatBodyRef:H,setShowFilters:pe,setFilters:un,loadConversation:vo,handleBackToList:Fn,setIsInfoOpen:Ee,handleChatScroll:Xs,handleAssignSelf:An,handleStatusChange:yo,handleToggleTag:va,handleAddTag:jo,setNoteInput:q,handleAddNote:ga,reassignUserId:se,setReassignUserId:_e,handleReassignConversation:xo,handleOpenTagManager:()=>ft(!0),handleCloseTagManager:()=>ft(!1),showTagManager:dn,tagManagerForm:tt,setTagManagerForm:nt,handleCreateTag:bi,handleDeleteTag:Ci,handleQuickAction:ps,handleSendMessage:ki,setMessageMode:$s,setMessageDraft:R,scrollChatToBottom:hs,getInitial:Vh,PlusIcon:qy,SearchIcon:Hy,VideoIcon:Gy,PhoneIcon:Qy,InfoIcon:Ky,SendIcon:Yy}),b==="dashboard"&&s.jsx(Zx,{metrics:Fs,channels:_,selectedPeriod:$n,selectedChannel:Cn,onPeriodChange:d=>{na(d),ms(d,Cn)},onChannelChange:d=>{is(d),ms($n,d)},onRefresh:()=>ms($n,Cn),onGenerateReport:No,brandName:fn}),b==="campaigns"&&s.jsx(ny,{campaignForm:pt,setCampaignForm:ia,campaignFilter:Xe,setCampaignFilter:Ws,templates:ls,campaigns:mi,selectedCampaignId:cs,campaignMessages:sa,users:ns,tags:kn,channels:_,selectedTemplate:fo,statusOptions:$h,onCreateCampaign:xa,onLoadCampaigns:yr,onLoadCampaignMessages:wo,onSendCampaign:_o,formatDate:uc,brandName:fn}),T?s.jsx(Wa,{variant:"offline",title:"Sin conexin",message:"No podemos actualizar la informacin en tiempo real. Te mostramos lo ltimo cargado.",actionLabel:"Reintentar",onAction:()=>window.location.reload()}):rs?s.jsx(Wa,{variant:"error",title:"Ocurri un problema",message:rs,dismissLabel:"Cerrar",onDismiss:()=>re("")}):null]})]})}const Jy=rm(document.getElementById("root"));Jy.render(s.jsx(Gx,{children:s.jsx(Xy,{})}));
